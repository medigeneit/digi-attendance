import{z as Y,N as $,b as z,u as J,s as P,r as S,e as H,A as K,m as T,n as Q,c as r,o as d,a as l,f as X,w as Z,h as n,v as a,B as u,F as p,y,t as v,g as b,k as f,l as C,p as j,j as A,a8 as h,x as c,i as ee}from"./index-C_SSaupO.js";import{L as oe}from"./LoaderView-BCx_LAKs.js";import{S as le}from"./WeekendAssignModal-CnHHCUeV.js";import{u as te}from"./company-CEtdvwmi.js";import{u as ne}from"./department-C8vS9jn4.js";import{u as se}from"./designation-BQeNdiGh.js";import{u as de}from"./leave-approval-B6zxfJN7.js";import{u as re}from"./shift-j4RCfACE.js";import{u as ie}from"./user-BtYUfs19.js";import{d as ae}from"./dayjs.min-CRo6SJLH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"my-container space-y-2"},pe={class:"card-bg md:p-8 p-4 mx-4"},me={class:"grid gap-4"},ve={class:"border p-4 rounded-md bg-gray-100"},ye={class:"grid md:grid-cols-2 gap-4"},be={class:"space-y-2"},fe=["value"],we={class:"border p-4 rounded-md bg-gray-100"},ge={class:"grid md:grid-cols-2 gap-4"},ke=["value"],xe=["value"],_e=["value"],Se={class:""},Ue={key:0,class:"flex flex-wrap gap-2 bg-white p-2 border rounded mt-1"},Ve=["value"],De=["value"],Pe={key:1,class:"col-span-full"},Ae=["required"],Ee={class:"border p-4 rounded-md bg-gray-100"},Le={class:"grid md:grid-cols-4 gap-4"},Ne={class:"relative"},Be=["type"],Me={class:"flex justify-center gap-4"},ze={__name:"UserEdit",setup(Te){const U=de(),t=Y({name:"",phone:"",email:"",password:"",role:"employee",type:"",address:"",note:"",device_user_id:null,is_active:!0,company_id:"",department_id:"",designation_id:"",shift_id:"",nid:"",date_of_birth:"",joining_date:"",employment_type:"Probationary",provisional_month:0,extended_provisional_month:0,employee_id:"",weekends:[],leave_approval_id:"",other_approval_id:"",blood:""}),V=ie(),w=te(),E=ne(),L=se(),N=re(),g=$(),k=z(),B=J(),{designations:q}=P(L),{error:M}=P(V),x=S(!1),_=S(!1),{shifts:I}=P(N),D=S(!1),G=["A+","A-","B+","B-","AB+","AB-","O+","O-"],m=S({weekends:[],start_month:"",end_month:""}),R=s=>{m.value=s};H(async()=>{_.value=!0,await w.fetchCompanies(),await U.fetchLeaveApprovals(),await O(),_.value=!1}),K(()=>t.company_id,async s=>{s&&(await E.fetchDepartments(s),await L.fetchDesignations(s),await N.fetchShifts(s),_.value=!1)});const O=async()=>{var s,e;try{const i=k.params.id,o=await V.fetchUser(i);o.assign_weekend?m.value={weekends:o.assign_weekend.weekends||[],start_month:ae(o.assign_weekend.start_month).format("YYYY-MM")||"",end_month:o.assign_weekend.end_month||""}:m.value={weekends:[],start_month:"",end_month:""},t.name=o.name,t.phone=o.phone||"",t.email=o.email||"",t.address=o.address||"",t.nid=o.nid||"",t.date_of_birth=o.date_of_birth,t.blood=o.blood||"",t.joining_date=o.joining_date,t.employment_type=o.employment_type,t.employee_id=o.employee_id||"",t.provisional_month=o.provisional_month,t.extended_provisional_month=o.extended_provisional_month,t.weekends=o.weekends||[],t.is_active=o.is_active,t.company_id=o.company_id,t.department_id=o.department_id||"",t.designation_id=o.designation_id||"",t.shift_id=o.shift_id,t.role=o.role||"",t.type=o.type||"",t.device_user_id=o.device_user_id||"",t.leave_approval_id=o.leave_approval_id||"",t.other_approval_id=o.other_approval_id||""}catch(i){const o=((e=(s=i.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to load user data";g.error(o),console.error(o),B.push({name:"UserList"})}},F=async()=>{var s,e;try{const i={...t,selected_weekend:m.value};await V.updateUser(k.params.id,i),M.value?g.error(M.value):(g.success("User updated successfully"),B.push({name:"UserShow",params:{id:k.params.id}}))}catch(i){const o=((e=(s=i.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to update user";g.error(o),console.error(o)}};T(()=>{var e;const s=(e=w.companies.find(i=>i.id===t.company_id))==null?void 0:e.name;return s?I.value[s]||[]:[]});const W=T(()=>{var e;const s=(e=w.companies.find(i=>i.id===t.company_id))==null?void 0:e.name;return s?q.value[s]||[]:[]});return(s,e)=>{const i=Q("RouterLink");return d(),r("div",ue,[l("div",pe,[e[69]||(e[69]=l("h2",{class:"title-lg text-center"},"Edit Employee",-1)),_.value?(d(),X(oe,{key:0,class:"bg-gray-100 border shadow-none"})):(d(),r("form",{key:1,onSubmit:Z(F,["prevent"]),class:"space-y-4"},[l("div",me,[l("div",ve,[e[34]||(e[34]=l("p",{class:"title-md"},"Personal Info",-1)),e[35]||(e[35]=l("hr",{class:"my-2"},null,-1)),l("div",ye,[l("div",null,[e[26]||(e[26]=l("label",null,"Name",-1)),n(l("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.name=o),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[a,t.name]])]),l("div",null,[e[27]||(e[27]=l("label",null,"Phone",-1)),n(l("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.phone=o),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[a,t.phone]])]),l("div",null,[e[28]||(e[28]=l("label",null,"Email",-1)),n(l("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.email=o),type:"email",class:"w-full p-2 border rounded"},null,512),[[a,t.email]])]),l("div",null,[e[29]||(e[29]=l("label",null,"Address",-1)),n(l("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>t.address=o),type:"text",class:"w-full p-2 border rounded",placeholder:"Enter your address"},null,512),[[a,t.address]])]),l("div",null,[e[30]||(e[30]=l("label",null,"NID",-1)),n(l("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>t.nid=o),type:"text",class:"w-full p-2 border rounded",placeholder:"Enter NID number"},null,512),[[a,t.nid]])]),l("div",null,[e[31]||(e[31]=l("label",null,"Date of Birth",-1)),n(l("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>t.date_of_birth=o),type:"date",class:"w-full p-2 border rounded"},null,512),[[a,t.date_of_birth]])]),l("div",be,[e[33]||(e[33]=l("label",{for:"bloodGroup",class:"text-gray-700 flex items-center gap-2"}," Blood Group ",-1)),n(l("select",{id:"bloodGroup","onUpdate:modelValue":e[6]||(e[6]=o=>t.blood=o),class:"py-2 px-4 border rounded w-full"},[e[32]||(e[32]=l("option",{disabled:"",value:""},"Select blood group",-1)),(d(),r(p,null,y(G,o=>l("option",{key:o,value:o},v(o),9,fe)),64))],512),[[u,t.blood]])])])]),l("div",we,[e[58]||(e[58]=l("p",{class:"title-md"},"Professional Info",-1)),e[59]||(e[59]=l("hr",{class:"my-2"},null,-1)),l("div",ge,[l("div",null,[e[37]||(e[37]=l("label",null,"Company",-1)),n(l("select",{id:"company_id","onUpdate:modelValue":e[7]||(e[7]=o=>t.company_id=o),class:"w-full border rounded px-3 py-2",required:""},[e[36]||(e[36]=l("option",{value:"",disabled:""},"Select a company",-1)),(d(!0),r(p,null,y(f(w).companies,o=>(d(),r("option",{key:o==null?void 0:o.id,value:o==null?void 0:o.id},v(o==null?void 0:o.name),9,ke))),128))],512),[[u,t.company_id]])]),l("div",null,[e[39]||(e[39]=l("label",null,"Department",-1)),n(l("select",{"onUpdate:modelValue":e[8]||(e[8]=o=>t.department_id=o),class:"w-full p-2 border rounded"},[e[38]||(e[38]=l("option",{value:"",disabled:""},"Select a department",-1)),(d(!0),r(p,null,y(f(E).departments,o=>(d(),r("option",{key:o==null?void 0:o.id,value:o==null?void 0:o.id},v(o==null?void 0:o.name),9,xe))),128))],512),[[u,t.department_id]])]),l("div",null,[e[41]||(e[41]=l("label",null,"Designation",-1)),n(l("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>t.designation_id=o),class:"w-full p-2 border rounded"},[e[40]||(e[40]=l("option",{value:"",disabled:""},"Select a designation",-1)),(d(!0),r(p,null,y(W.value,o=>(d(),r("option",{key:o==null?void 0:o.id,value:o==null?void 0:o.id},v(o==null?void 0:o.title),9,_e))),128))],512),[[u,t.designation_id]])]),l("div",null,[e[43]||(e[43]=l("label",null,"Employment Type",-1)),n(l("select",{"onUpdate:modelValue":e[10]||(e[10]=o=>t.employment_type=o),class:"w-full p-2 border rounded"},e[42]||(e[42]=[C('<option value="Probationary">Probationary</option><option value="Permanent">Permanent</option><option value="Part_Time">Part Time</option><option value="Remote">Remote</option><option value="Contract">Contract</option><option value="Freelance">Freelance</option><option value="Intern">Intern</option>',7)]),512),[[u,t.employment_type]])]),t.employment_type==="Probationary"?(d(),r(p,{key:0},[l("div",null,[e[44]||(e[44]=l("label",null,"Probationary Period (month)",-1)),n(l("input",{"onUpdate:modelValue":e[11]||(e[11]=o=>t.provisional_month=o),type:"number",placeholder:"Example: 3",class:"w-full p-2 border rounded"},null,512),[[a,t.provisional_month]])]),l("div",null,[e[45]||(e[45]=l("label",null,"Extended Probationary (month)",-1)),n(l("input",{"onUpdate:modelValue":e[12]||(e[12]=o=>t.extended_provisional_month=o),type:"number",placeholder:"Example: 3",class:"w-full p-2 border rounded"},null,512),[[a,t.extended_provisional_month]])])],64)):b("",!0),l("div",null,[e[47]||(e[47]=l("label",null,"Line Type",-1)),n(l("select",{"onUpdate:modelValue":e[13]||(e[13]=o=>t.type=o),class:"w-full p-2 border rounded",required:""},e[46]||(e[46]=[C('<option value="" disabled>Select Line Type</option><option value="executive">Executive</option><option value="support_staff">Support Staff</option><option value="doctor">Doctor</option><option value="academy_body">Academy Body</option>',5)]),512),[[u,t.type]])]),l("div",null,[e[48]||(e[48]=l("label",null,"Joining Date",-1)),n(l("input",{"onUpdate:modelValue":e[14]||(e[14]=o=>t.joining_date=o),type:"date",class:"w-full p-2 border rounded"},null,512),[[a,t.joining_date]])]),l("div",Se,[l("button",{type:"button",class:"btn-2",onClick:e[15]||(e[15]=o=>D.value=!0)}," Select Weekends "),m.value?(d(),r("div",Ue,[l("p",null,[e[49]||(e[49]=l("strong",null,"Weekends:",-1)),A(" "+v(m.value.weekends.join(", ")),1)]),l("p",null,[e[50]||(e[50]=l("strong",null,"Start Month:",-1)),A(" "+v(m.value.start_month),1)])])):b("",!0),j(le,{isOpen:D.value,assign_weekend:m.value,onClose:e[16]||(e[16]=o=>D.value=!1),onUpdate:R},null,8,["isOpen","assign_weekend"])]),l("div",null,[e[52]||(e[52]=l("label",null,"Leave Approval Group",-1)),n(l("select",{"onUpdate:modelValue":e[17]||(e[17]=o=>t.leave_approval_id=o),class:"w-full p-2 border rounded"},[e[51]||(e[51]=l("option",{value:"",disabled:""},"Select Leave Approval Group",-1)),(d(!0),r(p,null,y(f(U).leaveApprovals,o=>(d(),r(p,{key:o.id},[o.type==="leave"?(d(),r("option",{key:0,value:o.id},v(o.name),9,Ve)):b("",!0)],64))),128))],512),[[u,t.leave_approval_id]])]),l("div",null,[e[54]||(e[54]=l("label",null,"Other Approval Group",-1)),n(l("select",{"onUpdate:modelValue":e[18]||(e[18]=o=>t.other_approval_id=o),class:"w-full p-2 border rounded"},[e[53]||(e[53]=l("option",{value:"",disabled:""},"Select Other Approval Group",-1)),(d(!0),r(p,null,y(f(U).leaveApprovals,o=>(d(),r(p,{key:o.id},[o.type==="other"?(d(),r("option",{key:0,value:o.id},v(o.name),9,De)):b("",!0)],64))),128))],512),[[u,t.other_approval_id]])]),l("div",null,[e[56]||(e[56]=l("label",null,"Active Status",-1)),n(l("select",{"onUpdate:modelValue":e[19]||(e[19]=o=>t.is_active=o),class:"w-full p-2 border rounded"},e[55]||(e[55]=[l("option",{value:!0},"Active",-1),l("option",{value:!1},"Inactive",-1)]),512),[[u,t.is_active]])]),t.is_active?b("",!0):(d(),r("div",Pe,[e[57]||(e[57]=l("label",null,"InActive Note",-1)),n(l("input",{"onUpdate:modelValue":e[20]||(e[20]=o=>t.note=o),type:"text",class:"w-full p-2 border rounded",placeholder:"Note ...",required:!t.is_active},null,8,Ae),[[a,t.note]])]))])]),l("div",Ee,[e[65]||(e[65]=l("p",{class:"title-md"},"Technical Info",-1)),e[66]||(e[66]=l("hr",{class:"my-2"},null,-1)),l("div",Le,[l("div",null,[e[61]||(e[61]=l("label",null,"Role",-1)),n(l("select",{"onUpdate:modelValue":e[21]||(e[21]=o=>t.role=o),class:"w-full p-2 border rounded",required:""},e[60]||(e[60]=[l("option",{value:"employee"},"Employee",-1),l("option",{value:"admin"},"Admin",-1),l("option",{value:"super_admin"},"Super Admin",-1),l("option",{value:"developer"},"Developer",-1)]),512),[[u,t.role]])]),l("div",null,[e[62]||(e[62]=l("label",null,"Device User ID",-1)),n(l("input",{"onUpdate:modelValue":e[22]||(e[22]=o=>t.device_user_id=o),type:"number",placeholder:"3456",class:"w-full p-2 border rounded"},null,512),[[a,t.device_user_id]])]),l("div",null,[e[63]||(e[63]=l("label",null,"Employee ID",-1)),n(l("input",{"onUpdate:modelValue":e[23]||(e[23]=o=>t.employee_id=o),type:"text",class:"w-full p-2 border rounded",placeholder:"M123456"},null,512),[[a,t.employee_id]])]),l("div",null,[e[64]||(e[64]=l("label",null,"Password",-1)),l("div",Ne,[n(l("input",{"onUpdate:modelValue":e[24]||(e[24]=o=>t.password=o),type:x.value?"text":"password",class:"w-full p-2 border rounded"},null,8,Be),[[h,t.password]]),l("span",{class:"absolute inset-y-0 right-3 flex items-center cursor-pointer",onClick:e[25]||(e[25]=o=>x.value=!x.value)},[l("i",{class:c(x.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])])])])]),l("div",Me,[j(i,{to:{name:"UserList",query:{company:f(k).query.company}},type:"button",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:ee(()=>e[67]||(e[67]=[A(" Cancel ")])),_:1,__:[67]},8,["to"]),e[68]||(e[68]=l("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"}," Save ",-1))])],32))])])}}};export{ze as default};
