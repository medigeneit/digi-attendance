import{u as Ee,r as g,n as We,b as Pe,c as n,a as t,j as o,p as ze,t as l,h as _,e as d,s as He,d as Ue,v as qe,F as Ge,f as Je,o as a,g as Ke}from"./index-C6a1UUq-.js";import{u as Oe}from"./short-leave-D8PTLeim.js";import{L as Qe}from"./LoaderView-Dxn9ZDtY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Xe={class:"my-container max-w-3xl space-y-6"},Ye={key:1,class:"card-bg p-4 md:p-8"},Ze={class:""},et={class:"grid md:grid-cols-2"},tt={class:"grid md:grid-cols-2 gap-4 pt-10"},st={class:""},lt={class:"font-medium"},ot={class:"text-sm"},at={key:0,class:"print:hidden"},nt={class:"text-xs"},rt={class:"flex gap-2"},dt={class:"font-bold"},ut={key:0,class:"text-green-600 print:text-black"},it={key:1,class:"pl-2 text-yellow-700"},vt={class:"title-md"},pt={key:0},ct={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},mt={class:"pt-10"},bt={key:0,class:"print:hidden"},_t={class:""},ft={class:"text-xs text-blue-600"},gt={class:"flex gap-4"},yt={class:"font-bold"},xt={key:0,class:"text-green-600"},ht={class:"pt-10"},kt={key:0,class:"print:hidden"},wt={class:""},jt={class:"text-xs text-blue-600"},At={class:"flex gap-4"},Ct={class:"font-bold"},St={key:0,class:"text-green-600"},Lt={class:"flex flex-col pt-10"},Rt={key:0,class:"print:hidden"},Bt={class:""},Nt={class:"text-xs text-blue-600"},$t={class:"flex gap-4"},Ft={class:"font-bold"},Dt={key:0,class:"text-green-600"},Mt={key:0,class:"modal-bg"},Tt={class:"modal-card"},Vt={class:"flex justify-end gap-2 mt-4"},Ht={__name:"ShortLeaveShow",setup(It){const Me=Ke(),v=Je(),u=Oe(),p=Ee(),y=g(!0),c=g(!1),m=g(""),s=We(()=>u.shortLeave);Pe(async()=>{const{id:r}=v.params;try{await u.fetchShortLeaveById(r)}catch(e){console.error("Failed to fetch short leave details:",e)}finally{y.value=!1}});const Te=async()=>{try{await u.rejectShortLeave(v.params.id,m.value),alert("Short leave rejected successfully!"),c.value=!1,m.value="",await u.fetchShortLeaveById(v.params.id)}catch(r){console.error("Failed to reject short leave:",r),alert("Failed to reject short leave.")}},f=()=>{c.value=!0},b=async r=>{try{const{id:e}=v.params;r==="handover"&&await u.handoverAccept(e),r==="inCharge"&&await u.inChargeAccept(e),r==="recommend"&&await u.recommendByAccept(e),r==="approve"&&await u.approvedByAccept(e),alert(`${r} accepted successfully!`),await u.fetchShortLeaveById(e)}catch(e){console.error(`Failed to accept ${r}:`,e),alert(`Failed to accept ${r}.`)}},Ve=()=>Me.go(-1);function Ie(){window.print()}return(r,e)=>{var x,h,k,w,j,A,C,S,L,R,B,N,$,F,D,M,T,V,I,E,W,P,z,H,U,q,G,J,K,O,Q,X,Y,Z,ee,te,se,le,oe,ae,ne,re,de,ue,ie,ve,pe,ce,me,be,_e,fe,ge,ye,xe,he,ke,we,je,Ae,Ce,Se,Le,Re,Be,Ne,$e,Fe,De;return a(),n(Ge,null,[t("div",Xe,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:Ve},e[6]||(e[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[8]||(e[8]=t("h1",{class:"title-lg flex-wrap text-center"},"Short Leave Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:Ie},e[7]||(e[7]=[t("i",{class:"far fa-print"},null,-1),o(" Print ")]))])]),y.value?(a(),ze(Qe,{key:0})):(a(),n("div",Ye,[t("div",null,l((x=s.value)==null?void 0:x.user.company.name),1),e[37]||(e[37]=t("h2",{class:"title-md"},"Short Leave Application",-1)),t("div",Ze,[t("div",et,[t("div",null,[e[9]||(e[9]=t("b",null,"Date:",-1)),o(" "+l((h=s.value)==null?void 0:h.date),1)]),t("div",null,[e[10]||(e[10]=t("b",null,"Start Time:",-1)),o(" "+l((k=s.value)==null?void 0:k.start_time),1)]),t("div",null,[e[11]||(e[11]=t("b",null,"End Time:",-1)),o(" "+l((w=s.value)==null?void 0:w.end_time),1)]),t("div",null,[e[12]||(e[12]=t("b",null,"Total Minutes:",-1)),o(" "+l((j=s.value)==null?void 0:j.total_minutes),1)]),t("div",null,[e[13]||(e[13]=t("b",null,"Reason:",-1)),o(" "+l(((A=s.value)==null?void 0:A.reason)||"N/A"),1)])]),t("div",tt,[t("div",st,[e[14]||(e[14]=t("hr",{class:"w-44 border-black"},null,-1)),e[15]||(e[15]=t("div",null,[t("b",null,"Applicant")],-1)),t("p",lt,l((C=s.value)==null?void 0:C.user.name),1),t("div",ot,[t("p",null,l((R=(L=(S=s.value)==null?void 0:S.user)==null?void 0:L.department)==null?void 0:R.name),1),t("p",null,l(($=(N=(B=s.value)==null?void 0:B.user)==null?void 0:N.designation)==null?void 0:$.title),1)])]),t("div",null,[t("p",null,l(((D=(F=s.value)==null?void 0:F.handover_user)==null?void 0:D.name)||"Not assigned"),1),!((M=s.value)!=null&&M.status)&&s.value.handover_user_id===_(p).user.id?(a(),n("div",at,[t("p",nt,[o(l((V=(T=s.value)==null?void 0:T.user)==null?void 0:V.name)+" has assigned you for his handover. ",1),e[16]||(e[16]=t("br",null,null,-1)),e[17]||(e[17]=o(" Do you agree? "))]),t("div",rt,[t("button",{class:"font-bold text-lg text-green-600 px-2",onClick:e[0]||(e[0]=i=>b("handover"))}," ✔ "),e[18]||(e[18]=t("button",{class:"px-2"},"❌",-1))])])):d("",!0),e[21]||(e[21]=t("hr",{class:"w-44 border-black"},null,-1)),t("h4",dt,[e[20]||(e[20]=o(" Handover ")),(I=s.value)!=null&&I.handover_user_id&&((E=s.value)!=null&&E.status)?(a(),n("span",ut," (✔) ")):d("",!0),(W=s.value)!=null&&W.handover_user_id&&!((P=s.value)!=null&&P.status)?(a(),n("span",it,e[19]||(e[19]=[t("i",{class:"fad fa-spinner"},null,-1)]))):d("",!0)])])])]),e[38]||(e[38]=t("hr",null,null,-1)),t("div",null,[t("h3",vt,[e[22]||(e[22]=o(" Approvals ")),t("span",{class:He({"text-yellow-500":((z=s.value)==null?void 0:z.status)==="Pending","text-green-500":((H=s.value)==null?void 0:H.status)==="Approved","text-red-500":((U=s.value)==null?void 0:U.status)==="Rejected"})}," ("+l(((q=s.value)==null?void 0:q.status)||"N/A")+") ",3)]),((G=s.value)==null?void 0:G.status)==="Rejected"?(a(),n("div",pt,[t("div",null,[e[23]||(e[23]=t("b",null,"Rejected By:",-1)),o(" "+l(((K=(J=s.value)==null?void 0:J.rejected_by_user)==null?void 0:K.name)||"N/A"),1)]),t("div",null,[e[24]||(e[24]=t("b",null,"Rejection Reason:",-1)),o(" "+l(((O=s.value)==null?void 0:O.rejection_reason)||"N/A"),1)])])):d("",!0)]),t("div",ct,[t("div",mt,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Q=s.value)!=null&&Q.in_charge_user_id)&&((Z=(Y=(X=s.value)==null?void 0:X.user)==null?void 0:Y.other_approval)==null?void 0:Z.in_charge_user_id)===_(p).user.id?(a(),n("div",bt,[t("p",_t,l(((le=(se=(te=(ee=s.value)==null?void 0:ee.user)==null?void 0:te.other_approval)==null?void 0:se.in_charge_user)==null?void 0:le.name)||"N/A"),1),t("p",ft,[o(l((ae=(oe=s.value)==null?void 0:oe.user)==null?void 0:ae.name)+" has submitted an application. ",1),e[25]||(e[25]=t("br",null,null,-1)),e[26]||(e[26]=o(" Will you forward it? "))]),t("div",gt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=i=>b("inCharge"))}," ✔ "),t("button",{class:"",onClick:f},"❌")])])):d("",!0),t("p",null,l(((re=(ne=s.value)==null?void 0:ne.in_charge_user)==null?void 0:re.name)||""),1),e[28]||(e[28]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",yt,[e[27]||(e[27]=o(" In-Charge ")),(de=s.value)!=null&&de.in_charge_user_id?(a(),n("span",xt,"(✔)")):d("",!0)])]),t("div",ht,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ue=s.value)!=null&&ue.recommend_by_user_id)&&((pe=(ve=(ie=s.value)==null?void 0:ie.user)==null?void 0:ve.other_approval)==null?void 0:pe.recommend_by_user_id)===_(p).user.id?(a(),n("div",kt,[t("p",wt,l(((_e=(be=(me=(ce=s.value)==null?void 0:ce.user)==null?void 0:me.other_approval)==null?void 0:be.recommend_by_user)==null?void 0:_e.name)||"N/A"),1),t("p",jt,[o(l((ge=(fe=s.value)==null?void 0:fe.user)==null?void 0:ge.name)+" has submitted an application.",1),e[29]||(e[29]=t("br",null,null,-1)),e[30]||(e[30]=o(" Will you recommend it? "))]),t("div",At,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=i=>b("recommend"))}," ✔ "),t("button",{class:"",onClick:f},"❌")])])):d("",!0),t("p",null,l(((xe=(ye=s.value)==null?void 0:ye.recommend_by_user)==null?void 0:xe.name)||""),1),e[32]||(e[32]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Ct,[e[31]||(e[31]=o(" Recommend By ")),(he=s.value)!=null&&he.recommend_by_user_id?(a(),n("span",St,"(✔)")):d("",!0)])])]),t("div",Lt,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ke=s.value)!=null&&ke.approved_by_user_id)&&((Ae=(je=(we=s.value)==null?void 0:we.user)==null?void 0:je.other_approval)==null?void 0:Ae.approved_by_user_id)===_(p).user.id?(a(),n("div",Rt,[t("p",Bt,l(((Re=(Le=(Se=(Ce=s.value)==null?void 0:Ce.user)==null?void 0:Se.other_approval)==null?void 0:Le.approved_by_user)==null?void 0:Re.name)||"N/A"),1),t("p",Nt,[o(l((Ne=(Be=s.value)==null?void 0:Be.user)==null?void 0:Ne.name)+" has submitted an application.",1),e[33]||(e[33]=t("br",null,null,-1)),e[34]||(e[34]=o(" Will you accept it? "))]),t("div",$t,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[3]||(e[3]=i=>b("approve"))}," ✔ "),t("button",{class:"",onClick:f},"❌")])])):d("",!0),t("p",null,l(((Fe=($e=s.value)==null?void 0:$e.approved_by_user)==null?void 0:Fe.name)||""),1),e[36]||(e[36]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Ft,[e[35]||(e[35]=o(" Approved By ")),(De=s.value)!=null&&De.approved_by_user_id?(a(),n("span",Dt,"(✔)")):d("",!0)])])]))]),c.value?(a(),n("div",Mt,[t("div",Tt,[e[39]||(e[39]=t("h3",{class:"title-lg"},"Reject Short Leave",-1)),Ue(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=i=>m.value=i),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[qe,m.value]]),t("div",Vt,[t("button",{class:"btn-3",onClick:e[5]||(e[5]=i=>c.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:Te},"Confirm")])])])):d("",!0)],64)}}};export{Ht as default};
