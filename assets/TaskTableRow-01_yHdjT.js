import{r as I,q as N,c as l,o as a,a as e,j as d,m as c,b as B,F as T,w as m,e as O,f as P,t as h,d as $,i as p,s as q}from"./index-C8b1SdSm.js";import{d as E,b as F}from"./datetime-BEfC2TVK.js";import{_ as L,T as A,a as M,b as S}from"./TaskUrgentBadge-8LmEVHzV.js";import{_ as R,a as V}from"./TaskAssignedUsers-Bs6UXT07.js";import{T as z}from"./TaskIsClosedBadge-BQN8f13_.js";function _(t){if(!t)return!1;const f=D(t);return["jpg","jpeg","png","gif","webp","bmp","svg","jfif"].includes(f)}function j(t){return D(t)==="pdf"}function D(t){return typeof t=="string"?t.split(".").pop().toLowerCase():""}function x(t){return t.startsWith("http")?t:`https://hrm-api.medi.academy/storage/${t}`}const U={class:"border-b flex items-center px-2 py-1"},W=["href"],G={class:"ml-auto flex items-center gap-2"},H={key:0,class:"p-2 min-h-[50vh] max-h-[70vh] overflow-y-auto"},J=["src"],K=["src"],Q={key:1},X={key:0,class:"grid grid-cols-4 p-4 gap-8 min-h-[50vh] max-h-[70vh] overflow-y-auto"},Y=["onClick"],Z=["src"],tt=["href"],et={key:2,class:"text-xs text-gray-500 text-center"},Bt={__name:"RequirementAttachmentShow",props:{attachments:{type:Array,default:()=>[]},selected:{type:String,default:""}},emits:["change","clickClose"],setup(t,{emit:f}){const u=t,n=I(""),k=f;function r(o){n.value=o,k("change",o)}function y(){var s,i;const o=(u.attachments||[]).indexOf(n.value);console.log({currentIndex:o,attachments:u.attachments}),(s=u.attachments)!=null&&s[o-1]&&(n.value=(i=u.attachments)==null?void 0:i[o-1],k("change",n.value))}function v(){var s,i;const o=(u.attachments||[]).indexOf(n.value);(s=u.attachments)!=null&&s[o+1]&&(n.value=(i=u.attachments)==null?void 0:i[o+1],k("change",n.value))}return N(()=>u.selected,o=>n.value=o,{immediate:!0}),(o,s)=>(a(),l("div",null,[e("div",U,[s[6]||(s[6]=e("h2",{class:"text-xl font-semibold"},"Attachments",-1)),n.value?(a(),l("a",{key:0,href:c(x)(n.value),target:"_blank",class:"text-sky-600 hover:text-sky-400 hover:underline ml-2"},s[2]||(s[2]=[e("i",{class:"fas fa-external-link"},null,-1),B(),e("span",{class:"hidden md:inline"},"Open In New tab",-1)]),8,W)):d("",!0),e("div",G,[n.value?(a(),l(T,{key:0},[e("button",{onClick:s[0]||(s[0]=m(i=>r(""),["prevent"])),class:"btn-icon"},s[3]||(s[3]=[e("i",{class:"fas fa-list"},null,-1)])),e("button",{onClick:m(y,["prevent"]),class:"btn-icon"},s[4]||(s[4]=[e("i",{class:"fas fa-angle-left"},null,-1)])),e("button",{onClick:m(v,["prevent"]),class:"btn-icon"},s[5]||(s[5]=[e("i",{class:"fas fa-angle-right"},null,-1)]))],64)):d("",!0),e("button",{onClick:s[1]||(s[1]=m(i=>k("clickClose"),["prevent"])),class:"btn-icon ml-6"},"Ã—")])]),e("div",null,[n.value?(a(),l("div",H,[c(_)(n.value)?(a(),l("img",{key:0,src:c(x)(n.value),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,J)):c(j)(n.value)?(a(),l("iframe",{key:1,src:c(x)(n.value),class:"w-full h-[60vh] border rounded-md"},null,8,K)):d("",!0)])):(a(),l("div",Q,[t.attachments&&t.attachments.length?(a(),l("div",X,[(a(!0),l(T,null,O(t.attachments,(i,b)=>(a(),l("div",{key:b,class:"border p-1 rounded aspect-square flex items-center justify-center bg-gray-50 relative cursor-pointer",tabindex:"0",onClick:m(w=>r(i),["prevent"])},[c(_)(i)?(a(),l("img",{key:0,src:c(x)(i),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,Z)):c(j)(i)?(a(),l("a",{key:1,href:c(x)(i),target:"_blank",class:"text-xs text-blue-600 text-center break-words hover:underline"},s[7]||(s[7]=[e("i",{class:"fas fa-file-pdf fa-2x mb-1 text-amber-700"},null,-1),e("div",{class:"whitespace-nowrap text-xs mt-1"},"Open PDF",-1)]),8,tt)):(a(),l("span",et,"Unknown"))],8,Y))),128))])):d("",!0)]))])]))}},st={class:"border text-center py-2 px-1 border-gray-200"},at={class:"font-semibold text-purple-400 text-sm"},nt={class:"border px-3 py-1 border-gray-200 relative"},lt={class:"flex items-center justify-between gap-2"},it={class:"flex items-center gap-3 mb-0.5"},rt={class:"flex items-center flex-none lg:w-full order-0 lg:order-1"},ot={class:"text-gray-600 text-xs mr-2 whitespace-nowrap font-bold"},ct={class:"text-gray-400 text-xs mr-4 whitespace-nowrap"},dt={class:"ml-1"},ut={class:"flex items-center gap-2 text-xs text-gray-500 opacity-80 text-left"},mt={class:"text-xs flex items-center gap-1 text-sky-400 ml-4"},ft=["href"],kt={class:"border px-3 py-1 border-gray-200"},gt={class:"flex gap-2 justify-between items-center relative w-full"},ht={key:0,class:"shrink-0"},xt=["href"],yt={class:"border px-3 py-1 border-gray-200 text-center"},vt={key:0,class:"ml-4 text-gray-500 text-sm"},bt={class:"text-blue-500 font-semibold whitespace-nowrap"},pt={class:"border px-3 border-gray-200 sticky right-0 border-l bg-gray-50"},wt={class:"flex justify-end flex-wrap gap-2 py-2"},Dt={__name:"TaskTableRow",props:{task:{type:Object},indexing:{type:[Number,String]},hideButtons:{type:Boolean,default:!1},taskLinkTo:{type:Function,default:null}},emits:["editClick","employeeAssignClick"],setup(t,{emit:f}){const u=f,n=P();return(k,r)=>{var y,v,o,s,i,b,w,C;return a(),l("tr",{class:q(["group/sub-task-row h-20",{" bg-green-400/20":t.task.status=="COMPLETED"," bg-white hover:bg-slate-50":t.task.status!=="COMPLETED"}])},[e("td",st,[e("div",at,h(t.indexing),1)]),e("td",nt,[e("div",lt,[e("div",null,[e("div",it,[$(L,{titleClass:"text-sm text-blue-400 font-semibold",task:t.task,"sub-tasks-open":!1,isMyTask:c(n).name=="RequirementList",to:g=>`/requirement-tasks/${g.id}`},null,8,["task","isMyTask","to"])]),e("div",rt,[e("div",ot,h(t.task.id),1),e("div",ct,[r[2]||(r[2]=e("i",{class:"fas fa-clock"},null,-1)),e("span",dt,h(c(E)(t.task.created_at)),1)]),e("div",ut,[(y=t.task)!=null&&y.is_important?(a(),p(A,{key:0})):d("",!0),(v=t.task)!=null&&v.is_urgent?(a(),p(M,{key:1})):d("",!0)]),e("div",mt,[r[3]||(r[3]=e("i",{class:"fas fa-tasks"},null,-1)),B(" "+h((o=t.task)==null?void 0:o.todos_count),1)])])]),!t.task.closed_at&&!t.hideButtons?(a(),l("a",{key:0,href:`/tasks/edit/${t.task.id}`,onClick:r[0]||(r[0]=m(g=>u("editClick",t.task.id),["stop","prevent"])),class:"btn-3 py-1.5 px-1.5 !border-0 size-7 text-sm opacity-40 group-hover/sub-task-row:opacity-100 duration-100"},r[4]||(r[4]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ft)):d("",!0)])]),e("td",kt,[e("div",gt,[$(R,{class:"flex items-center justify-center gap-x-3 gap-y-2",users:((s=t.task)==null?void 0:s.users)||[],isTargetTask:t.task.is_target,maxItem:1,"route-to":g=>`/requirement-tasks?status=not-completed&view=userwise&user-ids=${g.id}`},null,8,["users","isTargetTask","route-to"]),t.task.closed_at?d("",!0):(a(),l("div",ht,[t.hideButtons?d("",!0):(a(),l("a",{key:0,href:`/tasks/${t.task.id}/assign-users`,onClick:r[1]||(r[1]=m(g=>u("employeeAssignClick",t.task.id),["stop","prevent"])),class:"btn-3 py-1.5 px-1.5 !border-0 size-7 text-sm opacity-40 group-hover/sub-task-row:opacity-100 duration-100 flex-shrink-0"},r[5]||(r[5]=[e("i",{class:"fas fa-users-cog"},null,-1)]),8,xt))]))])]),e("td",yt,[t.task.deadline?(a(),l("span",vt,[e("span",bt,h(c(F)(t.task.deadline)),1)])):d("",!0)]),e("td",pt,[e("div",wt,[t.task.closed_at?(a(),p(z,{key:0})):d("",!0),$(V,{status:(i=t.task)==null?void 0:i.status,progressPercent:((b=t.task)==null?void 0:b.progress_percent)||0,class:"w-full"},null,8,["status","progressPercent"]),((C=(w=t.task)==null?void 0:w.children_tasks)==null?void 0:C.length)>0?(a(),p(S,{key:1,ref:"progress",task:t.task,class:"text-sm w-full"},null,8,["task"])):d("",!0)])])],2)}}};export{Bt as _,j as a,Dt as b,x as f,_ as i};
