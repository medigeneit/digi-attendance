import{L as X}from"./LoaderView-CQlnlSAE.js";import{r as L,x as j,e as K,A as Y,c as v,o as c,I as O,a as e,F as V,y as B,t as S,g as k,w as D,q as z,n as P,f as F,H as de,i as M,k as C,J as ae,j as U,h as J,v as Q,m as ue,S as G,T as H}from"./index-4LVguuel.js";import{f as ce,b as Z,g as le}from"./datetime-l2Vm98rT.js";import{u as W}from"./useTodoStore-3j9Lg_Uq.js";import{_ as me}from"./DraggableList.vue_vue_type_script_setup_true_lang-BevEsI3X.js";import{_ as ye}from"./UserChip-Bz53R-B4.js";import{O as te}from"./OverlyModal-BNypUO37.js";const ve={class:"grid grid-cols-7 *:text-center *:p-2 *:border-r *:border-b *:text-blue-800 *:text-sm"},pe={class:"flex flex-col"},fe={key:0,class:"p-2 border-r border-t"},ge={__name:"CalenderView",props:{month:{type:String,required:!0,validator:d=>/^\d{4}-(0[1-9]|1[0-2])$/.test(d)}},emits:["change"],setup(d,{emit:$}){const a=d,i=$,u=L(),t=L(),l=L(),m=L(),r=["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];function g(f,o,b,w){const h=[];for(let N=b-1;N>=0;N--){const p=w-N,_=new Date(f,o-1,p);h.push({date:_,day:_.getDate(),month:_.getMonth()+1,year:_.getFullYear(),isCurrentMonth:!1})}return h}function n(f,o,b){const w=[];for(let h=1;h<=b;h++){const p={date:new Date(f,o,h),day:h,month:o+1,year:f,isCurrentMonth:!0};w.push(p)}return w}function s(f,o,b){const w=[...f],h=Math.ceil(w.length/7)*7,N=1;for(let p=0;w.length<h;p++){const _=new Date(o,b+1,N+p);w.push({date:_,day:_.getDate(),month:_.getMonth()+1,year:_.getFullYear(),isCurrentMonth:!1})}return w}function y(f,o){const b=new Date(f,o,1),h=new Date(f,o+1,0).getDate(),p=(b.getDay()+1)%7,E=new Date(f,o,0).getDate();let I=[];I=[...g(f,o,p,E)];const A=n(f,o,h);return l.value=A[0],m.value=A[A.length-1],I=[...I,...A],I=[...s(I,f,o)],u.value=I[0],t.value=I[I.length-1],I}const T=j(()=>{const[f,o]=a.month.split("-"),b=parseInt(f),w=parseInt(o)-1;return console.log({yearStr:f,monthStr:o}),y(b,w)}),x=j(()=>{const f=T.value,o=[];for(let b=0;b<f.length;b+=7)o.push(f.slice(b,b+7));return o});function R(){i("change",{gridStartDate:u.value,gridEndDate:t.value,startOfMonth:l.value,endOfMonth:m.value})}return K(()=>R()),Y(()=>a.month,R),(f,o)=>(c(),v("div",null,[O(f.$slots,"calender-top"),e("div",ve,[(c(),v(V,null,B(r,b=>e("div",{key:b},S(b),1)),64))]),e("div",pe,[(c(!0),v(V,null,B(x.value,(b,w)=>(c(),v("div",{class:"week grid grid-cols-7 min-h-28 items-stretch",key:w},[(c(!0),v(V,null,B(b,(h,N)=>O(f.$slots,"date",{key:N,day:h.day,month:h.month,year:h.year,weekday:(h.date.getDay()+1)%7,isCurrentMonth:h.isCurrentMonth,yearMonthDate:`${h.year}-${String(h.month).padStart(2,"0")}-${String(h.day).padStart(2,"0")}`},()=>{var p;return[h!=null&&h.date?(c(),v("div",fe,S((p=h==null?void 0:h.date)==null?void 0:p.getDate()),1)):k("",!0)]})),128))]))),128))]),O(f.$slots,"calender-bottom")]))}},be={class:"px-4 py-2 flex items-center bg-gray-50 group gap-2"},he=["value"],ke=["value"],xe=["value"],we=["value"],Ce=["disabled"],De={key:4,class:"ml-4 md:ml-auto flex items-center gap-2"},$e={key:5,class:"ml-4 md:ml-auto flex items-center gap-2"},Se={__name:"TodoHeading",props:{selected:{type:Object,default:()=>({type:"month-view",month:"",day:"",year:"",week:""})},loading:{type:Boolean,default:!1}},emits:["reloadClick",,"change"],setup(d,{emit:$}){const a=d,i=[{value:"month-view",label:"Monthly"},{value:"day-view",label:"Daily"}],u=$,t=L();function l(o){t.value=o,u("change",{...a.selected,type:o})}Y(()=>{var o;return(o=a.selected)==null?void 0:o.type},o=>l(o),{immediate:!0});const m=j(()=>t.value=="month-view"&&a.selected.year&&a.selected.month?[a.selected.year,a.selected.month-1,1]:t.value=="day-view"&&a.selected.year&&a.selected.month&&a.selected.day?[a.selected.year,a.selected.month-1,a.selected.day]:[new Date().getFullYear(),new Date().getMonth(),new Date().getDate()]);function r(){t.value=="month-view"&&x(new Date)}function g(){if(t.value=="month-view"){const o=new Date(...m.value);o.setMonth(o.getMonth()+1),x(o)}}function n(){if(t.value=="month-view"){const o=new Date(...m.value);o.setMonth(o.getMonth()-1),x(o)}}function s(){t.value=="day-view"&&x(new Date)}function y(){if(t.value=="day-view"){const o=new Date(...m.value);o.setDate(o.getDate()+1),x(o)}}function T(){if(t.value=="day-view"){const o=new Date(...m.value);o.setDate(o.getDate()-1),x(o)}}function x(o){u("change",{type:t.value,month:o.getMonth()+1,day:o.getDate(),year:o.getFullYear(),week:o.getDay()})}const R=j(()=>t.value=="month-view"?`${a.selected.year}-${a.selected.month.toString().padStart(2,"0")}`:t.value=="day-view"?`${a.selected.year}-${a.selected.month.toString().padStart(2,"0")}-${a.selected.day.toString().padStart(2,"0")}`:a.selected),f=o=>{var b,w;if(t.value=="month-view"){const[h,N]=(b=o.target.value)==null?void 0:b.split("-").map(Number),p=new Date(h,N-1,1);x(p)}if(t.value=="day-view"){const h=new Date((w=o.target)==null?void 0:w.value);x(h)}};return(o,b)=>(c(),v("div",null,[e("div",be,[O(o.$slots,"before",{selected:d.selected}),O(o.$slots,"typeSelection",{selected:d.selected,types:i,changeType:l},()=>[e("select",{class:"px-2 h-7 border rounded",value:t.value,onChange:b[0]||(b[0]=w=>l(w.target.value))},[(c(),v(V,null,B(i,w=>e("option",{value:w.value,key:w.id},S(w.label),9,ke)),64))],40,he)]),t.value=="month-view"?(c(),v("input",{key:0,type:"month",value:R.value,onInput:f,class:"border px-2 rounded"},null,40,xe)):k("",!0),t.value=="day-view"?(c(),v("input",{key:1,type:"date",value:R.value,onInput:f,class:"border px-2 rounded"},null,40,we)):k("",!0),t.value=="month-view"?(c(),v("button",{key:2,class:"btn-3 mx-4 h-7",onClick:D(r,["prevent"])}," Current Month ")):k("",!0),t.value=="day-view"?(c(),v("button",{key:3,class:"btn-3 mx-4 h-7",onClick:D(s,["prevent"])}," Today ")):k("",!0),e("button",{class:z(["btn-3 px-2 py-2 mx-4 size-7 disabled:text-gray-300 disabled:border-gray-300",{"animate-spin text-gray-300 border-gray-300 !bg-opacity-0":d.loading}]),onClick:b[1]||(b[1]=D(w=>u("reloadClick"),["prevent"])),disabled:d.loading},b[2]||(b[2]=[e("i",{class:"fas fa-redo-alt"},null,-1)]),10,Ce),t.value=="month-view"?(c(),v("div",De,[e("button",{class:"btn-2 h-7",onClick:D(n,["prevent"])}," Previous Month "),e("button",{class:"btn-2 h-7",onClick:D(g,["prevent"])},"Next Month")])):k("",!0),t.value=="day-view"?(c(),v("div",$e,[e("button",{class:"btn-2 h-7",onClick:D(T,["prevent"])},"Previous Day"),e("button",{class:"btn-2 h-7",onClick:D(y,["prevent"])},"Next Day")])):k("",!0),O(o.$slots,"after",{selected:d.selected})]),O(o.$slots,"bottom",{selected:d.selected})]))}},Te={key:0,class:"fa fa-exclamation-circle",title:"Pending"},_e={key:1,class:"fa fa-exclamation-square",title:"Wording"},Me={key:2,class:"fa fa-check-square",title:"Completed"},ne={__name:"TodoStatusIcon",props:{todo:{type:Object,required:!0}},setup(d){const $=d,a=j(()=>{switch($.todo.status){case"PENDING":return"text-red-400";case"WORKING":return"text-yellow-400";case"COMPLETED":return"text-green-400"}return""});return(i,u)=>(c(),v("span",{class:z(a.value)},[d.todo.status=="PENDING"?(c(),v("i",Te)):k("",!0),d.todo.status=="WORKING"?(c(),v("i",_e)):k("",!0),d.todo.status=="COMPLETED"?(c(),v("i",Me)):k("",!0)],2))}},Ie=["title","onClick"],Ee={class:"line-clamp-1"},Oe={key:0,class:"text-purple-600 text-center"},ie={__name:"TodosInDate",props:{date:{type:String,required:!0},maxItems:{type:[Number,String],default:3}},emits:["clickTodo"],setup(d,{emit:$}){const a=d,i=$,{getTodosByDate:u}=W(),t=j(()=>{let l=[],m=!1,r=[];if(typeof u=="function"){const g=u(a.date);if(r=Array.isArray(g)?g:[],a.maxItems==="all")return{all:r,items:r,moreItemsCount:0};l=r.slice(0,a.maxItems),m=r.length-l.length}return{all:r,items:l,moreItemsCount:m}});return(l,m)=>(c(),v("div",null,[t.value.items.length===0?O(l.$slots,"noTodos",{key:0},()=>[m[0]||(m[0]=e("div",{class:"text-gray-400 text-center"},"No todos",-1))]):(c(),v(V,{key:1},[O(l.$slots,"todoItems",{todos:t.value.items,allTodos:t.value.items,moreItemsCount:t.value.moreItemsCount},()=>[(c(!0),v(V,null,B(t.value.items,r=>O(l.$slots,"todoItem",{key:r.id,todo:r,moreItemsCount:t.value.moreItemsCount},()=>{var g,n,s,y;return[e("div",{title:`${r==null?void 0:r.title} ${r!=null&&r.user?`
by:`:""} ${(g=r==null?void 0:r.user)==null?void 0:g.name} ${(n=r==null?void 0:r.user)!=null&&n.department?`
DEPT:`:""} ${(y=(s=r.user)==null?void 0:s.department)==null?void 0:y.name}`,class:z(["px-1 mb-2 text-sm rounded cursor-pointer flex items-center gap-2",{"bg-sky-50 text-sky-900 hover:bg-sky-700 hover:text-white border border-sky-300":r.status!=="COMPLETED","bg-green-500 text-white":r.status==="COMPLETED"}]),onClick:D(T=>i("clickTodo",r),["prevent","stop"])},[P(ne,{todo:r,class:z(["text-sm",[r.status=="COMPLETED"?"!text-white":""]])},null,8,["todo","class"]),e("div",Ee,S(r.title),1),r.user?(c(),F(de,{key:0,user:r.user,size:"xsmall",class:"ml-auto"},null,8,["user"])):k("",!0)],10,Ie)]})),128))]),t.value.moreItemsCount>0?(c(),v("div",Oe," + "+S(t.value.moreItemsCount)+" more todo"+S(t.value.moreItemsCount>1?"s":""),1)):k("",!0)],64))]))}},Re={class:"relative"},Ne=["onClick","onKeypress"],Le={class:"flex items-center justify-center"},Pe=["onClick"],Fe={__name:"TodosInCalenderView",props:{month:{type:String,required:!0,validator:d=>/^\d{4}-(0[1-9]|1[0-2])$/.test(d)}},emits:["dateClick","clickTodo","clickDateCell"],setup(d,{emit:$}){const a=$;function i(t,l){t.isTrusted&&t.ctrlKey&&t.which==10&&a("dateClick",l)}function u(t){const[l,m,r]=String(t).split("-").map(Number),g=new Date(l,m-1,r);return ce(g)}return(t,l)=>(c(),v("div",Re,[d.month?(c(),F(ge,{key:0,month:d.month,class:"border-t border-blue-200/50 relative"},{date:M(({day:m,yearMonthDate:r,isCurrentMonth:g})=>[e("div",{tabindex:"0",class:z(["border p-4 cursor-pointer group/date relative focus:outline-slate-400",{"bg-sky-50   border-sky-300 focus:bg-sky-50 focus:outline-sky-400":u(r),"hover:bg-slate-50  hover:border-slate-300 focus:bg-slate-50 ":!u(r)}]),onClick:D(n=>a("dateClick",r),["prevent","stop"]),onKeypress:D(n=>i(n,r),["prevent"])},[e("button",{tabindex:"1",class:z([{"text-gray-300":!g,"text-sky-400":g},"text-center mb-2 font-semibold hover:bg-sky-200 w-full rounded"])},S(m),3),e("div",null,[P(ie,{date:r,onClickTodo:l[0]||(l[0]=n=>a("clickTodo",n))},{noTodos:M(()=>l[1]||(l[1]=[e("span",null,null,-1)])),_:2},1032,["date"])]),e("div",Le,[e("button",{onClick:D(n=>a("clickDateCell",r),["prevent","stop"]),class:"btn-3 !py-1 invisible group-hover/date:visible text-sm text-red-800/40"},l[2]||(l[2]=[e("i",{class:"fas fa-plus"},null,-1),e("span",{class:"hidden lg:inline whitespace-nowrap"}," Add todo ",-1)]),8,Pe)])],42,Ne)]),_:1},8,["month"])):k("",!0)]))}},je={class:"relative bg-white p-4"},Ae={key:0,class:"text-red-500 text-sm border border-red-300 max-w-6xl mx-auto py-2 gap-2 shadow-sm rounded flex items-center px-3"},Ue={class:"max-w-6xl mx-auto border rounded my-5"},Ve={class:"mb-4 text-gray-700 border-b py-2 px-4 flex items-center"},qe={class:"text-lg font-semibold"},ze={class:"ml-auto flex items-center gap-2"},We={key:0,class:"flex items-center gap-3 mr-6"},Be=["disabled"],Ke=["disabled"],Ge=["onClick"],He={class:"ml-4"},Ye={class:"line-clamp-2"},Je={key:0,class:"mt-1 flex items-center gap-2"},Qe={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},Xe={key:0,class:"line-clamp-2 ml-4 text-gray-500"},Ze={class:"ml-auto flex items-center gap-2"},et=["onClick"],tt=["onClick"],nt=["onClick"],ot={__name:"TodosInDailyView",props:{date:{type:String,required:!0}},emits:["clickTodo","clickAdd","clickEdit","clickDelete","clickChangeStatus","backClick","update"],setup(d,{emit:$}){const a=d,i=L(null),u=$,t=j(()=>new Date(a.date)),l=W();async function m(n){confirm(`Are your sure want to delete todo
'${n==null?void 0:n.title}'`)&&(await l.deleteTodo(n.id),u("update"))}async function r(n){confirm(`Are your sure want to compete todo
'${n==null?void 0:n.title}'`)&&(await l.updateTodoStatus(n.id,"COMPLETED"),u("update"))}async function g(){var s;const n=(s=i==null?void 0:i.value.items)==null?void 0:s.map(y=>y.id);await l.rearrangeMyTodos(n,{date:a.date}),u("update")}return(n,s)=>{var y;return c(),v("div",je,[C(l).error?(c(),v("div",Ae,[s[4]||(s[4]=e("i",{class:"fad fa-exclamation-circle"},null,-1)),e("div",null,S(C(l).error),1)])):k("",!0),e("div",Ue,[e("div",Ve,[e("button",{class:"fa fa-arrow-left btn-icon mr-2",onClick:s[0]||(s[0]=D(T=>u("backClick"),["prevent"]))}),e("div",qe,S(C(Z)(t.value,{weekDay:"long"})),1),e("div",ze,[(y=i.value)!=null&&y.isItemsChanged?(c(),v("div",We,[e("button",{onClick:s[1]||(s[1]=D(()=>g(),["prevent"])),class:"btn-2 disabled:opacity-40 disabled:pointer-events-none",disabled:C(l).updatingPriority}," Save Rearranged ",8,Be),e("button",{onClick:s[2]||(s[2]=D(()=>i.value.resetItems(),["prevent"])),class:"btn-3 disabled:opacity-40 disabled:pointer-events-none",disabled:C(l).updatingPriority}," Discard ",8,Ke)])):k("",!0),e("button",{class:"btn btn-icon",onClick:s[3]||(s[3]=D(T=>u("clickAdd",a.date),["prevent"]))},s[5]||(s[5]=[e("i",{class:"fas fa-plus"},null,-1)]))])]),P(ie,{date:d.date,"max-items":"all",class:"my-8 w-full px-4"},{todoItems:M(({allTodos:T})=>[P(me,{items:T,ref_key:"draggableTodos",ref:i},{item:M(({item:x})=>{var R,f;return[e("div",{class:"border rounded px-4 py-3 my-4 hover:bg-sky-50 cursor-pointer flex items-center",onClick:D(o=>u("clickTodo",x),["prevent"])},[P(ne,{todo:x},null,8,["todo"]),e("div",He,[e("div",Ye,S(x.id)+" - "+S(x.title),1),x.user?(c(),v("div",Je,[P(ye,{user:x.user,"avatar-size":"xsmall"},null,8,["user"]),e("div",Qe,S((f=(R=x.user)==null?void 0:R.department)==null?void 0:f.name),1)])):k("",!0)]),x.todo_type&&x.todo_type_id?(c(),v("div",Xe,S(x.todo_type)+" id: "+S(x.todo_type_id),1)):k("",!0),e("div",Ze,[x.status==="WORKING"?(c(),v("button",{key:0,class:"btn-icon bg-green-400 text-white hover:bg-green-600 hover:text-white",onClick:D(()=>r(x),["prevent","stop"])},s[6]||(s[6]=[e("i",{class:"fas fa-check"},null,-1)]),8,et)):k("",!0),s[9]||(s[9]=e("button",{class:"btn-icon bg-gray-400 text-white hover:bg-gray-600 hover:text-white handle"},[e("i",{class:"fas fa-arrows-alt-v"})],-1)),e("button",{class:"btn-icon bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:D(o=>u("clickEdit",x),["prevent","stop"])},s[7]||(s[7]=[e("i",{class:"fas fa-pen"},null,-1)]),8,tt),e("button",{class:"btn-icon bg-red-400 text-white hover:bg-red-600 hover:text-white",onClick:D(()=>m(x),["prevent","stop"])},s[8]||(s[8]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,nt)])],8,Ge)]}),_:2},1032,["items"])]),noTodos:M(()=>s[10]||(s[10]=[e("div",{class:"flex min-h-[38vh] items-center justify-center text-gray-400 text-center rounded-md"}," No Todos ",-1)])),_:1},8,["date"])])])}}},st={class:"bg-white border-t px-4 py-4 sticky bottom-0 rounded-b-md"},at={key:0,class:"mb-4 text-red-500 font-medium"},lt={key:1,class:"mb-4 text-blue-500 font-medium"},it={class:"flex justify-between items-center gap-4"},rt=["disabled"],re={__name:"FormHandler",props:{isSubmitting:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["submit","clickCancel"],setup(d,{emit:$}){const a=$;return(i,u)=>(c(),v("form",{onSubmit:u[1]||(u[1]=D(t=>a("submit"),["prevent"]))},[O(i.$slots,"default"),e("div",st,[d.error?(c(),v("div",at,S(d.error),1)):k("",!0),d.isSubmitting?(c(),v("div",lt,"Saving changes...")):k("",!0),O(i.$slots,"footer",{},()=>[e("div",it,[e("button",{type:"button",onClick:u[0]||(u[0]=t=>a("clickCancel")),class:"btn-3"},"Cancel"),e("button",{disabled:d.isSubmitting||d.isLoading,type:"submit",class:"btn-2"},S(d.isSubmitting?"Saving...":"Save"),9,rt)])])])],32))}},dt={class:""},ut={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},ct={class:"mb-2"},mt={class:"mb-4"},yt={class:"mb-4"},vt={__name:"TodoAddForm",props:{date:{type:String,default:le(new Date)},userRole:{type:String,default:"employee"}},emits:["update","cancelClick"],setup(d,{emit:$}){const a=d,i=L(),u=L(),t=W(),l=$,m=L({title:"",date:a.date||"",task_id:""});async function r(){try{i.value="submitting",await t.createTodo(m.value,{returnWith:a.userRole!=="employee"?"user,department,company":""}),l("update")}finally{i.value=""}}const g=j(()=>new Date(a.date));return K(async()=>{var n;await ae(),(n=u.value)==null||n.focus()}),(n,s)=>(c(),v("div",dt,[C(t).loading?(c(),F(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:M(()=>s[3]||(s[3]=[U(" Loading... ")])),_:1,__:[3]})):k("",!0),P(re,{onSubmit:r,onClickCancel:s[2]||(s[2]=y=>l("cancelClick")),isSubmitting:i.value=="submitting",error:C(t).error,class:"rounded-md relative"},{default:M(()=>[s[7]||(s[7]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Add Todo")],-1)),e("div",ut,[e("div",ct,[s[4]||(s[4]=e("span",{class:"font-semibold"}," Date ",-1)),e("span",null,S(C(Z)(g.value,{weekDay:"long"})),1)]),e("div",mt,[s[5]||(s[5]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),J(e("input",{ref_key:"titleRef",ref:u,"onUpdate:modelValue":s[0]||(s[0]=y=>m.value.title=y),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.title]])]),e("div",yt,[s[6]||(s[6]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),J(e("input",{"onUpdate:modelValue":s[1]||(s[1]=y=>m.value.task_id=y),placeholder:"Enter a task id",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.task_id]])])])]),_:1,__:[7]},8,["isSubmitting","error"])]))}},pt={class:"relative"},ft={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},gt={class:"mb-2"},bt={class:"mb-4"},ht={class:"mb-4"},kt={__name:"TodoEditForm",props:{date:{type:String,default:le(new Date)},todo:{type:Object,default:()=>{}}},emits:["update","cancelClick"],setup(d,{emit:$}){const a=d,i=L(),u=L(),t=W(),l=$,m=L({title:"",todo_type:"task",todo_type_id:""});async function r(){var s,y,T;await t.fetchTodo((s=a.todo)==null?void 0:s.id),m.value.title=(y=t.todo)==null?void 0:y.title,m.value.todo_type_id=(T=t.todo)==null?void 0:T.todoable_id}async function g(){i.value="submitting";try{await t.updateTodo(a.todo.id,m.value),l("update")}finally{i.value=""}}const n=j(()=>new Date(a.todo.date));return K(async()=>{var s;await r(),await ae(),(s=u.value)==null||s.focus()}),(s,y)=>(c(),v("div",pt,[C(t).loading?(c(),F(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:M(()=>y[3]||(y[3]=[U(" Loading... ")])),_:1,__:[3]})):k("",!0),P(re,{onSubmit:g,onClickCancel:y[2]||(y[2]=T=>l("cancelClick")),isSubmitting:i.value=="submitting",isLoading:C(t).loading,error:C(t).error},{default:M(()=>[y[7]||(y[7]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Edit Todo")],-1)),e("div",ft,[e("div",gt,[y[4]||(y[4]=e("span",{class:"font-semibold"}," Date ",-1)),e("span",null,S(C(Z)(n.value,{weekDay:"long"})),1)]),e("div",bt,[y[5]||(y[5]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),J(e("input",{ref_key:"titleRef",ref:u,"onUpdate:modelValue":y[0]||(y[0]=T=>m.value.title=T),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.title]])]),e("div",ht,[y[6]||(y[6]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),J(e("input",{"onUpdate:modelValue":y[1]||(y[1]=T=>m.value.todo_type_id=T),placeholder:"Enter a task id",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.todo_type_id]])])])]),_:1,__:[7]},8,["isSubmitting","isLoading","error"])]))}},xt={class:"relative"},wt={class:"min-h-[10vh] max-h-[50vh] overflow-y-auto p-4"},Ct={class:"mb-4"},Dt={class:"mb-4"},$t={key:0,class:"mt-1 flex items-center gap-2"},St={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},Tt={class:"flex items-center gap-4"},_t={key:0,class:"flex items-center gap-2"},Mt={class:"flex justify-between items-center gap-4 py-4 px-4 border-t"},It={class:"ml-auto flex items-center gap-2"},Et={__name:"TodoShow",props:{todo:{type:Object,default:()=>{}}},emits:["cancelClick","clickEdit","update"],setup(d,{emit:$}){const a=d,i=W(),u=$;async function t(){var g;await i.fetchTodo((g=a.todo)==null?void 0:g.id)}const l=j(()=>{var g,n;return(g=i.todo)!=null&&g.date?new Date((n=i.todo)==null?void 0:n.date):null});async function m(g){var n;confirm(`Are your sure want to delete todo
'${(n=i.todo)==null?void 0:n.title}'`)&&(await i.deleteTodo(g.id),u("update"))}async function r(g,n){var s;confirm(`Are your sure want to compete todo
'${(s=i.todo)==null?void 0:s.title}'`)&&(await i.updateTodoStatus(g.id,n),u("update"))}return K(async()=>{await t()}),(g,n)=>{var y,T,x,R,f,o,b,w;const s=ue("UserChip");return c(),v("div",xt,[C(i).loading?(c(),F(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:M(()=>n[5]||(n[5]=[U(" Loading... ")])),_:1,__:[5]})):k("",!0),e("div",null,[n[11]||(n[11]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Show Todo")],-1)),e("div",wt,[e("div",Ct,[n[6]||(n[6]=e("div",{class:"font-semibold text-xs text-gray-500"},"Date",-1)),e("span",null,S(C(Z)(l.value,{weekDay:"long"})),1)]),e("div",Dt,[n[7]||(n[7]=e("div",{class:"text-xs text-gray-500"},"Todo",-1)),U(" "+S((y=C(i).todo)==null?void 0:y.title),1)]),d.todo.user?(c(),v("div",$t,[P(s,{user:d.todo.user,"avatar-size":"xsmall"},null,8,["user"]),e("div",St,S((x=(T=d.todo.user)==null?void 0:T.department)==null?void 0:x.name),1)])):k("",!0),e("div",null,[n[10]||(n[10]=e("div",{class:"text-xs text-gray-500"},"Status",-1)),e("div",Tt,[e("div",null,[(R=C(i))!=null&&R.todo?(c(),F(ne,{key:0,todo:(f=C(i))==null?void 0:f.todo},null,8,["todo"])):k("",!0),U(" "+S((o=C(i).todo)==null?void 0:o.status),1)]),C(i).loading?k("",!0):(c(),v("div",_t,[((b=C(i).todo)==null?void 0:b.status)==="PENDING"?(c(),v("button",{key:0,class:"btn-2 from-yellow-700 to-yellow-500 text-white hover:bg-green-600 hover:text-white",onClick:n[0]||(n[0]=D(()=>r(C(i).todo,"WORKING"),["prevent","stop"]))},n[8]||(n[8]=[e("i",{class:"fas fa-exclamation-circle"},null,-1),U(" Change to Working ")]))):k("",!0),((w=C(i).todo)==null?void 0:w.status)==="WORKING"?(c(),v("button",{key:1,class:"btn-2 from-green-700 to-green-300 text-white hover:bg-green-600 hover:text-white",onClick:n[1]||(n[1]=D(()=>r(C(i).todo,"COMPLETED"),["prevent","stop"]))},n[9]||(n[9]=[e("i",{class:"fas fa-check"},null,-1),U(" Make Complete ")]))):k("",!0)]))])])])]),e("div",Mt,[e("button",{type:"button",onClick:n[2]||(n[2]=h=>u("cancelClick")),class:"btn-3"},"Cancel"),e("div",It,[e("button",{class:"btn-2 bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:n[3]||(n[3]=D(h=>u("clickEdit",C(i).todo),["prevent","stop"]))},n[12]||(n[12]=[e("i",{class:"fas fa-pen"},null,-1),U(" Edit ")])),e("button",{class:"btn-2-red",onClick:n[4]||(n[4]=D(()=>m(C(i).todo),["prevent","stop"]))},n[13]||(n[13]=[e("i",{class:"fas fa-trash-alt"},null,-1),U(" Delete ")]))])])])}}},Ot={__name:"TodoCreateEditShow",props:{todoModal:{type:Object,required:!0},userRole:{type:String,required:"employee"}},emits:["cancelClick","update","clickEdit","clickDelete","clickChangeStatus"],setup(d,{emit:$}){const a=$;function i(){a("update")}return(u,t)=>(c(),v(V,null,[d.todoModal.action=="add"?(c(),F(te,{key:0},{default:M(()=>{var l;return[P(vt,{onCancelClick:t[0]||(t[0]=m=>a("cancelClick")),onUpdate:i,date:(l=d.todoModal)==null?void 0:l.date,userRole:d.userRole},null,8,["date","userRole"])]}),_:1})):k("",!0),d.todoModal.action=="edit"?(c(),F(te,{key:1},{default:M(()=>{var l;return[P(kt,{onCancelClick:t[1]||(t[1]=m=>a("cancelClick")),onUpdate:i,todo:(l=d.todoModal)==null?void 0:l.todo,userRole:d.userRole},null,8,["todo","userRole"])]}),_:1})):k("",!0),d.todoModal.action=="show"?(c(),F(te,{key:2},{default:M(()=>{var l;return[P(Et,{onCancelClick:t[2]||(t[2]=m=>a("cancelClick")),onUpdate:i,onClickEdit:t[3]||(t[3]=m=>a("clickEdit",m)),onClickDelete:t[4]||(t[4]=m=>a("clickDelete",m)),onClickChangeStatus:t[5]||(t[5]=(m,r)=>a("clickChangeStatus",m,r)),todo:(l=d.todoModal)==null?void 0:l.todo,userRole:d.userRole},null,8,["todo","userRole"])]}),_:1})):k("",!0)],64))}},Rt={class:"border bg-white relative"},Vt={__name:"TodoSection",props:{year:{type:Number,default:()=>new Date().getFullYear()},month:{type:Number,default:()=>new Date().getMonth()+1},day:{type:Number,default:()=>new Date().getDate()},week:{type:Number,default:()=>new Date().getDay()},type:{type:String,default:"month-view"},userRole:{type:String,default:"employee"}},emits:["changeInput"],setup(d,{emit:$}){const a=new Date,i=d,u=L({type:"month-view",month:a.getMonth()+1,day:a.getDate(),year:a.getFullYear(),week:a.getDay()}),t=$;Y(()=>({...u.value}),p=>{t("changeInput",p)}),Y(()=>({year:i.year,month:i.month,day:i.day,week:i.week,type:i.type}),p=>{u.value={...p}},{immediate:!0});const l=L({action:null}),m=W();async function r(){await N()}function g(){l.value={...l.value,action:""}}async function n(p,_){await m.updateTodoStatus(p,_)}async function s(p){await m.deleteTodo(p)}function y(){u.value={...u.value,type:"month-view"}}function T(p){u.value={...u.value,...p}}function x(p){const[_,E,I]=p.split("-").map(Number);u.value={...u.value,type:"day-view",year:_,month:E,day:I}}function R(p){l.value={...l.value,action:"show",todo:p}}function f(p){l.value={...l.value,action:"edit",todo:p}}function o(p){l.value={...l.value,action:"add",date:p}}function b(){l.value={action:null,todo:null}}const w=j(()=>{var I,q,A,ee,oe,se;const p=(q=(I=u.value)==null?void 0:I.year)==null?void 0:q.toString(),_=(ee=(A=u.value)==null?void 0:A.month)==null?void 0:ee.toString().padStart(2,"0"),E=(se=(oe=u.value)==null?void 0:oe.day)==null?void 0:se.toString().padStart(2,"0");return`${p}-${_}-${E}`}),h=j(()=>{var E,I,q,A;const p=(I=(E=u.value)==null?void 0:E.year)==null?void 0:I.toString(),_=(A=(q=u.value)==null?void 0:q.month)==null?void 0:A.toString().padStart(2,"0");return`${p}-${_}`});async function N(){i.userRole=="employee"?await m.fetchMyTodos():await m.fetchTodos()}return K(async()=>{await N()}),(p,_)=>(c(),v("div",null,[e("div",Rt,[C(m).loading?(c(),F(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:M(()=>_[0]||(_[0]=[U(" Loading... ")])),_:1,__:[0]})):k("",!0),P(Se,{selected:u.value,class:"border-b shadow z-20",onChange:T,onReloadClick:r},{before:M(E=>[O(p.$slots,"beforeHeader",G(H(E)))]),after:M(E=>[O(p.$slots,"afterHeader",G(H(E)))]),bottom:M(E=>[O(p.$slots,"bottomHeader",G(H(E)))]),typeSelection:M(E=>[O(p.$slots,"typeSelection",G(H(E)))]),_:3},8,["selected"]),u.value.type=="month-view"?(c(),F(Fe,{key:1,month:h.value,class:"bg-white",onDateClick:x,onClickTodo:R,onClickDateCell:o},null,8,["month"])):k("",!0),u.value.type=="day-view"?(c(),F(ot,{key:2,date:w.value,onClickTodo:R,onClickEdit:f,onClickAdd:o,onClickDelete:s,onClickChangeStatus:n,onBackClick:y,onUpdate:g},null,8,["date"])):k("",!0)]),P(Ot,{todoModal:l.value,userRole:d.userRole,onCancelClick:b,onUpdate:g,onClickEdit:f},null,8,["todoModal","userRole"])]))}};export{ge as _,Vt as a};
