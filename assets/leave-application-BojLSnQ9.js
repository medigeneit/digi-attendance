import{J as M,r as v,K as o,a1 as O}from"./index-xdpH0sCq.js";const H=M("leaveApplication",()=>{const u=v([]),d=v(null),c=v(!1),i=v(null),w=v(new Date().toISOString().substring(0,7)),m=v(new Date().getFullYear()),p=v(null),f=v([]),g=v("");async function h(e={}){var n,l;c.value=!0,i.value=null;try{const t=await o.get("/leave-applications",{params:e});t.data?u.value=t.data:u.value=[]}catch(t){i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch leave applications"}finally{c.value=!1}}async function y(e={}){var n,l,t,a,r;c.value=!0,i.value=null;try{const s=await o.get("/yearly-user-leave-applications",{params:e});s.data?(u.value=(n=s==null?void 0:s.data)==null?void 0:n.leave_applications,p.value=(l=s==null?void 0:s.data)==null?void 0:l.user,f.value=(t=s==null?void 0:s.data)==null?void 0:t.leave_balances):(u.value=[],p.value=[])}catch(s){i.value=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to fetch leave applications"}finally{c.value=!1}}async function x(e={}){var n,l;c.value=!0,i.value=null;try{const t=await o.get("/my-leave-applications",{params:e});u.value=t.data.data}catch(t){i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch leave applications"}finally{c.value=!1}}async function A(e){var n,l,t,a;c.value=!0,i.value=null;try{const r=await o.post("/leave-applications/store",e);return u.value.push((n=r==null?void 0:r.data)==null?void 0:n.data),(l=r==null?void 0:r.data)==null?void 0:l.data}catch(r){throw i.value=((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to store leave application",new Error(i.value)}finally{c.value=!1}}async function F(e){var n,l,t;c.value=!0,i.value=null;try{console.log(111);const a=await o.post("/admin-leave-applications/store",e);return console.log(a),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to store leave application",new Error(i.value)}finally{c.value=!1}}async function E(e){var n,l;c.value=!0,i.value=null;try{await o.delete(`/my-leave-application/destroy/${e}`),await h()}catch(t){throw i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to store leave application",new Error(i.value)}finally{c.value=!1}}const I=async e=>{var n,l;try{return c.value=!0,(await o.post("cental-attachment-upload",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Something went wrong"}finally{c.value=!1}};async function $(e,n){var l,t;c.value=!0,i.value=null;try{const a=await o.post(`/leave-applications/${e}/update`,n),r=u.value.findIndex(s=>s.id===e);return r!==-1&&(u.value[r]=a.data.data),a.data.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to update leave application",new Error(i.value)}finally{c.value=!1}}const L=async(e,n)=>{var l,t;c.value=!0,i.value=null;try{const a=await o.put(`/leave-attachment/${e}`,n),r=u.value.findIndex(s=>s.id===e);return r!==-1&&(u.value[r]=a.data.data),a.data.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||`Failed to update application leave (ID: ${e})`,console.error(`Error updating application leave with id ${e}:`,a),new Error(i.value)}finally{c.value=!1}};async function S(e){var n,l;c.value=!0,i.value=null;try{const t=await o.get(`/leave-applications/${e}`);d.value=t==null?void 0:t.data,await O().fetchApprovalPermissions("leave_applications",d.value.id)}catch(t){i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch leave application"}finally{c.value=!1}}async function b(e){var n,l;c.value=!0,i.value=null;try{const t=await o.post(`/leave-applications/${e.id}/handover-accept`,e),a=u.value.findIndex(r=>r.id===(e==null?void 0:e.id));return a!==-1&&(u.value[a]=t.data.data),t.data.data}catch(t){throw i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to accept handover",new Error(i.value)}finally{c.value=!1}}async function C(e){var n,l,t;c.value=!0,i.value=null;try{const a=await o.post(`/leave-applications/${e.id}/incharge-accept`,e),r=u.value.findIndex(s=>s.id===(e==null?void 0:e.id));return r!==-1&&(u.value[r]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept in-charge approval",new Error(i.value)}finally{c.value=!1}}async function _(e){var n,l,t;c.value=!0,i.value=null;try{const a=await o.post(`/leave-applications/${e.id}/coordinator-accept`,e),r=u.value.findIndex(s=>s.id===(e==null?void 0:e.id));return r!==-1&&(u.value[r]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept coordinator approval",new Error(i.value)}finally{c.value=!1}}async function j(e){var n,l,t;c.value=!0,i.value=null;try{const a=await o.post(`/leave-applications/${e.id}/operational-admin-accept`,e),r=u.value.findIndex(s=>s.id===(e==null?void 0:e.id));return r!==-1&&(u.value[r]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept operational admin approval",new Error(i.value)}finally{c.value=!1}}async function B(e){var n,l,t;c.value=!0,i.value=null;try{const a=await o.post(`/leave-applications/${e.id}/recommend-by-accept`,e),r=u.value.findIndex(s=>s.id===(e==null?void 0:e.id));return r!==-1&&(u.value[r]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept recommend by approval",new Error(i.value)}finally{c.value=!1}}async function D(e){var n,l,t;c.value=!0,i.value=null;try{const a=await o.post(`/leave-applications/${e==null?void 0:e.id}/approved-by-accept`,e),r=u.value.findIndex(s=>s.id===(e==null?void 0:e.id));return r!==-1&&(u.value[r]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept approval by admin",new Error(i.value)}finally{c.value=!1}}async function Y(e,n){var l,t;c.value=!0,i.value=null;try{const a=await o.post(`/leave-applications/${e}/reject`,n),r=u.value.findIndex(s=>s.id===e);return r!==-1&&(u.value[r]=a.data.data),a.data.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to reject leave application",new Error(i.value)}finally{c.value=!1}}return{leaveApplications:u,leaveApplication:d,loading:c,error:i,selectedMonth:w,selectedYear:m,user:p,selectedStatus:g,fetchLeaveApplications:h,storeLeaveApplication:A,updateLeaveApplication:$,fetchLeaveApplicationById:S,acceptHandover:b,acceptInCharge:C,acceptCoordinator:_,acceptOperationalAdmin:j,acceptRecommendBy:B,acceptApprovedBy:D,rejectLeaveApplication:Y,fetchMyLeaveApplications:x,deleteLeaveApplication:E,fetchFileUpload:I,uploadLeaveApplicationAttachment:L,fetchYearlyUserLeaveApplications:y,storeAdminLeaveApplication:F,leave_balances:f}});export{H as u};
