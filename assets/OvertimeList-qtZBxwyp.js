import{u as U,b as B,a3 as C,r as m,e as O,m as V,x as w,c as v,o as u,a as l,f as x,g as y,q as b,k as h,h as L,v as M,p as N}from"./index-CIo6-YZh.js";import{_ as D}from"./EmployeeFilter-Cg9Qrp8h.js";import{L as A}from"./LoaderView-B13L9bx9.js";import{_ as F}from"./OvertimeDataList-DUz0DiEI.js";import{u as I}from"./overtime-DwPBonq3.js";import{u as R}from"./user-DDpLyoOg.js";import"./MultiselectDropdown-DqpveQZc.js";import"./company-BlUP4J_3.js";import"./department-CQczfM-m.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AcceptAndRejectHandler-CXEn1nDa.js";import"./DisplayFormattedWorkingHours-DrLE5FJU.js";import"./TimePickerAsFloatHour-DKD7lpLG.js";const $={class:"px-4 space-y-4"},j={key:0,class:"absolute inset-0 w-full h-full"},z={key:2},ae={__name:"OvertimeList",setup(E){const p=U(),o=B(),q=C(),d=I(),f=R(),s=m(!1),i=m(null),r=m(o.query.date||new Date().toISOString().slice(0,7)),a=m({company_id:o.query.company_id||"",department_id:o.query.department_id||"all",type:o.query.type||"all",employee_id:o.query.employee_id||"",category:""});O(async()=>{if(a.value.employee_id){s.value=!0;try{await _(a.value.employee_id),await n()}catch(e){console.log(e)}s.value=!1}});const _=async e=>{e?(await f.fetchUser(e),i.value=f.user):i.value=null},g=V(()=>{var e;return((e=d.overtimes)==null?void 0:e.map(t=>t.id))||[]}),n=async()=>{var e;a.value.employee_id&&r.value&&(await d.fetchUserMonthlyOvertimes(a.value.employee_id,r.value),(e=g.value)!=null&&e.length&&await q.fetchApprovalPermissionsByUserApplicationIds("overtime_applications",g.value))};w(r,e=>{p.replace({query:{...o.query,date:e}}),n()}),w(()=>a.value.employee_id,async(e,t)=>{e&&e!==t&&(await _(e),await n())});const k=()=>p.go(-1),S=()=>{p.replace({query:{...o.query,company_id:a.value.company_id,department_id:a.value.department_id,type:a.value.type,employee_id:a.value.employee_id||o.query.employee_id}})};return(e,t)=>(u(),v("div",$,[l("div",{class:"flex items-center justify-between gap-2"},[l("button",{class:"btn-3",onClick:k},t[2]||(t[2]=[l("i",{class:"far fa-arrow-left"},null,-1),l("span",{class:"hidden md:flex"},"Back",-1)])),t[3]||(t[3]=l("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Overtime",-1)),t[4]||(t[4]=l("div",null,null,-1))]),l("div",{class:N(["w-full flex flex-wrap gap-4 items-center md:w-auto relative",{"opacity-50":s.value}])},[b(D,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=c=>a.value=c),"initial-value":h(o).query,onFilterChange:S},null,8,["modelValue","initial-value"]),l("div",null,[L(l("input",{id:"monthSelect",type:"month","onUpdate:modelValue":t[1]||(t[1]=c=>r.value=c),onChange:n,class:"input-1"},null,544),[[M,r.value]])]),s.value?(u(),v("div",j)):y("",!0)],2),h(d).isLoading||s.value?(u(),x(A,{key:0})):i.value?(u(),x(F,{key:1,user:i.value,onUpdate:n},null,8,["user"])):y("",!0),i.value?y("",!0):(u(),v("div",z,t[5]||(t[5]=[l("p",{class:"text-gray-400 text-center text-2xl italic"},"Select an employee, please.",-1)])))]))}};export{ae as default};
