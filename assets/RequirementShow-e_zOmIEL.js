import{r as h,e as G,c as u,o as r,a as e,f as D,g as f,w as k,F as R,h as E,j as T,y as C,v as F,i as S,A as ne,t as x,p as ve,C as ae,x as M,n as H,q as fe,k as de,b as xe,u as ye,z as j}from"./index-BTFXQ7uo.js";import{L as W}from"./LoaderView-BDksR18W.js";import{O as z}from"./OverlyModal-CJj2zt9E.js";import{R as ue}from"./RequiredIcon-BTynVmyj.js";import{f as J}from"./requirement-BHIOCGvD.js";import{a as ge,f as me,d as we,u as ke,_ as _e}from"./TaskAddForm-CZtY15Wo.js";import{u as pe}from"./department-DteIH2n8.js";import{S as be}from"./SelectDropdown-4JxVOkBj.js";import{_ as B}from"./UserChip-g11Rn8O1.js";import{u as ce}from"./user-Cbfb-9l_.js";import{_ as he}from"./TaskUserChip-DbPzhuXl.js";import{u as $e}from"./useTaskStore-B7nECnXC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./company-DVHF_TmP.js";import"./url-CePbr-gY.js";import"./CompanyDepartmentSelectInput-CzYqp5b0.js";import"./SectionLoading-BQDi-BqX.js";import"./TextWithHr-Bgc4Roez.js";import"./TaskUrgencyInput-_pLE-U54.js";const qe={class:"sticky top-0 pt-4 bg-white z-10"},Ce={class:"mb-4"},De={class:"block text-gray-600 text-sm mb-1 font-medium"},Ie={class:"mb-4"},Se={class:"mb-4"},Re={class:"mb-4"},Te={class:"mb-4"},Ee={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},Ve={key:0,class:"mb-4 text-red-500 font-medium"},Ne={key:1,class:"mb-4"},Ue={class:"flex items-center justify-between gap-4"},Fe=["disabled"],Le={__name:"RequirementDetailAddForm",props:{requirementId:{type:[Number,String],required:!0}},emits:["create","closeClick","error"],setup(y,{emit:I}){const _=y,v=I,a=pe(),w=h(),m=h(""),o=h(),s=h({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),g=h([]);async function d(){var l,b;m.value="submitting";const c={...s.value};console.log({payload:c});try{const p=await ge(_.requirementId,c);v("create",p),m.value="create"}catch(p){m.value="error",o.value=((b=(l=p.response)==null?void 0:l.data)==null?void 0:b.message)||"Failed to create requirement detail",v("error",o.value)}}return G(async()=>{var l;const c=((l=(await J(_.requirementId)).data)==null?void 0:l.requirement)||{};g.value=await a.fetchDepartmentEmployee([c.from_department_id])}),(c,l)=>(r(),u("div",{class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative",ref_key:"formContainerRef",ref:w},[e("div",qe,[l[7]||(l[7]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add Requirement",-1)),l[8]||(l[8]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:l[0]||(l[0]=k(b=>v("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:k(d,["prevent"]),class:"z-0"},[m.value!=="loading"?(r(),u(R,{key:0},[e("div",Ce,[e("label",De,[l[9]||(l[9]=T("Title ")),C(ue)]),E(e("input",{"onUpdate:modelValue":l[1]||(l[1]=b=>s.value.title=b),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,s.value.title]])]),e("div",Ie,[l[10]||(l[10]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Details",-1)),E(e("textarea",{rows:"10","onUpdate:modelValue":l[2]||(l[2]=b=>s.value.description=b),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,s.value.description]])]),e("div",Se,[l[12]||(l[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),C(be,{modelValue:s.value.supervisor_id,"onUpdate:modelValue":l[3]||(l[3]=b=>s.value.supervisor_id=b),options:g.value,placeholder:"--NO SUPERVISOR--",containment:w.value,clearable:"",class:"h-10"},{"list-header":S(()=>l[11]||(l[11]=[e("div",{class:"px-3 pt-2 pb-1 shadow-md text-xs uppercase bg-gray-50 text-gray-500"}," Employees ",-1)])),option:S(({option:b})=>[C(B,{user:b||{},class:"pr-5 -mx-1"},null,8,["user"])]),"selected-option":S(({option:b})=>[b?(r(),D(B,{key:0,user:b||{},class:"pr-4"},null,8,["user"])):f("",!0)]),_:1},8,["modelValue","options","containment"])]),e("div",Re,[l[14]||(l[14]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),E(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":l[4]||(l[4]=b=>s.value.priority=b)},l[13]||(l[13]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[ne,s.value.priority]])]),e("div",Te,[l[15]||(l[15]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),E(e("input",{type:"date","onUpdate:modelValue":l[5]||(l[5]=b=>s.value.better_to_complete_on=b),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,s.value.better_to_complete_on]])])],64)):f("",!0),e("div",Ee,[o.value?(r(),u("div",Ve,x(o.value),1)):f("",!0),o.value?(r(),u("hr",Ne)):f("",!0),e("div",Ue,[e("button",{type:"button",onClick:l[6]||(l[6]=k(b=>v("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:m.value=="loading"||m.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},x(m.value=="submitting"?"Saving...":"Add Requirement"),9,Fe)])])],32),m.value==="loading"||m.value==="submitting"?(r(),D(W,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)],512))}},Ae={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},Me={class:"mb-4"},Oe={class:"font-semibold"},Pe={class:"mb-4"},je={class:"line-clamp-2"},ze={key:1,class:"min-h-40"},Be={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},Ge={key:0,class:"mb-4 text-red-500 font-medium"},We={key:1,class:"mb-4"},He={class:"flex items-center justify-between gap-4"},Je=["disabled"],Ke={__name:"RequirementDetailDeleteForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["delete","closeClick","error"],setup(y,{emit:I}){const _=y,v=I,a=ce(),w=h(null),m=h(""),o=h(),s=h([]);async function g(){var d,c;m.value="submitting";try{const l=await we(_.requirementId,_.detailId);v("delete",l),m.value="create"}catch(l){m.value="error",o.value=((c=(d=l.response)==null?void 0:d.data)==null?void 0:c.message)||"Failed to update requirement detail: "+l,v("error",o.value)}}return G(async()=>{var d,c,l;m.value="loading";try{s.value=await a.fetchDepartmentWiseEmployees(),w.value=(d=(await me(_.requirementId,_.detailId)).data)==null?void 0:d.detail}catch(b){o.value=((l=(c=b.response)==null?void 0:c.data)==null?void 0:l.message)||"Failed to fetch requirement detail"}finally{m.value=""}}),(d,c)=>{var l,b;return r(),u("div",Ae,[c[4]||(c[4]=e("div",{class:"sticky top-0 -mx-6 px-6 z-10 bg-gray-50"},[e("h2",{class:"text-xl font-semibold text-gray-800 py-2"},"Delete Requirement Details"),e("hr",{class:"mb-4 -mx-6"})],-1)),e("form",{onSubmit:k(g,["prevent"]),class:"z-0"},[m.value!=="loading"?(r(),u(R,{key:0},[e("div",Me,[c[1]||(c[1]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Title",-1)),e("div",Oe,x((l=w.value)==null?void 0:l.title),1)]),e("div",Pe,[c[2]||(c[2]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),e("div",je,x((b=w.value)==null?void 0:b.description),1)]),c[3]||(c[3]=e("div",{class:"my-8 text-center text-xl text-red-600"},"Are you sure want to delete?",-1))],64)):(r(),u("div",ze)),e("div",Be,[o.value?(r(),u("div",Ge,x(o.value),1)):f("",!0),o.value?(r(),u("hr",We)):f("",!0),e("div",He,[e("button",{type:"button",onClick:c[0]||(c[0]=k(p=>v("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:m.value=="loading"||m.value=="submitting",type:"submit",class:"bg-red-700 hover:bg-red-500 text-white font-semibold px-5 py-2 rounded transition"},x(m.value=="submitting"?"Deleting...":"Delete"),9,Je)])])],32),m.value==="loading"||m.value==="submitting"?(r(),D(W,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)])}}},Qe={class:"sticky top-0 pt-4 bg-white z-10"},Xe={class:"mb-4"},Ye={class:"block text-gray-600 text-sm mb-1 font-medium"},Ze={class:"mb-4"},et={class:"mb-4"},tt={key:0,class:"relative w-full"},st={key:0,class:"absolute right-1 text-xl top-0 bottom-0 flex items-center"},lt={class:"mb-4"},rt={class:"mb-4"},ot={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},it={key:0,class:"mb-4 text-red-500 font-medium"},nt={key:1,class:"mb-4"},at={class:"flex items-center justify-between gap-4"},dt=["disabled"],ut={__name:"RequirementDetailEditForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(y,{emit:I}){const _=y,v=I,a=h(),w=ce(),m=pe(),o=h(null),s=h(""),g=h(),d=h({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),c=h([]),l=h([]);async function b(){var i,q;s.value="submitting";const p={...d.value};try{const n=await ke(_.requirementId,_.detailId,p);v("update",n),s.value="create"}catch(n){s.value="error",g.value=((q=(i=n.response)==null?void 0:i.data)==null?void 0:q.message)||"Failed to update requirement detail",v("error",g.value)}}return G(async()=>{var p,i,q,n,t,V,L,A;s.value="loading";try{c.value=await w.fetchDepartmentWiseEmployees();const N=((p=(await J(_.requirementId)).data)==null?void 0:p.requirement)||{};l.value=await m.fetchDepartmentEmployee([N.from_department_id]),o.value=(i=(await me(_.requirementId,_.detailId)).data)==null?void 0:i.detail,d.value={title:(q=o.value)==null?void 0:q.title,description:(n=o.value)==null?void 0:n.description,priority:(t=o.value)==null?void 0:t.priority,supervisor_id:(V=o.value)==null?void 0:V.supervisor_id};const O=new Date(o.value.better_to_complete_on);d.value.better_to_complete_on=O.toISOString().split("T")[0]}catch(N){g.value=((A=(L=N.response)==null?void 0:L.data)==null?void 0:A.message)||"Failed to fetch requirement detail"}finally{s.value=""}}),(p,i)=>{var q;return r(),u("div",{ref_key:"formContainerRef",ref:a,class:"max-h-[90vh] w-full mx-auto overflow-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},[e("div",Qe,[i[8]||(i[8]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Edit Requirement",-1)),i[9]||(i[9]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:i[0]||(i[0]=k(n=>v("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:k(b,["prevent"]),class:"z-0"},[s.value!=="loading"?(r(),u(R,{key:0},[e("div",Xe,[e("label",Ye,[i[10]||(i[10]=T("Title ")),C(ue)]),E(e("input",{"onUpdate:modelValue":i[1]||(i[1]=n=>d.value.title=n),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,d.value.title]])]),e("div",Ze,[i[11]||(i[11]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),E(e("textarea",{rows:"10","onUpdate:modelValue":i[2]||(i[2]=n=>d.value.description=n),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,d.value.description]])]),e("div",et,[i[12]||(i[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),C(be,{modelValue:d.value.supervisor_id,"onUpdate:modelValue":i[4]||(i[4]=n=>d.value.supervisor_id=n),options:[...l.value,...l.value.find(n=>{var t,V;return n.id==((V=(t=o.value)==null?void 0:t.supervisor)==null?void 0:V.id)})?[]:[(q=o.value)==null?void 0:q.supervisor]],containment:a.value,placeholder:"--NO SUPERVISOR--",class:"h-10"},{option:S(({option:n})=>[C(B,{user:n||{}},null,8,["user"])]),"selected-option":S(({option:n})=>[n?(r(),u("div",tt,[C(B,{user:n||{}},null,8,["user"]),d.value.supervisor_id?(r(),u("div",st,[e("button",{onClick:i[3]||(i[3]=k(t=>d.value.supervisor_id=null,["prevent"])),class:"text-gray-6 font-semibold 00 hover:text-red-700"}," × ")])):f("",!0)])):f("",!0)]),_:1},8,["modelValue","options","containment"])]),e("div",lt,[i[14]||(i[14]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),E(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":i[5]||(i[5]=n=>d.value.priority=n)},i[13]||(i[13]=[e("option",{value:null},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[ne,d.value.priority]])]),e("div",rt,[i[15]||(i[15]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),E(e("input",{type:"date","onUpdate:modelValue":i[6]||(i[6]=n=>d.value.better_to_complete_on=n),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,d.value.better_to_complete_on]])])],64)):f("",!0),e("div",ot,[g.value?(r(),u("div",it,x(g.value),1)):f("",!0),g.value?(r(),u("hr",nt)):f("",!0),e("div",at,[e("button",{type:"button",onClick:i[7]||(i[7]=k(n=>v("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:s.value=="loading"||s.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},x(s.value=="submitting"?"Saving...":"Edit Detail"),9,dt)])])],32),s.value==="loading"||s.value==="submitting"?(r(),D(W,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)],512)}}},mt=["rowspan"],pt={class:"text-2xl font-medium"},bt=["rowspan"],ct={class:"text-lg font-semibold mb-2"},vt={class:"mb-5"},ft={class:"text-justify"},xt=["innerHTML"],yt={class:"flex items-end"},gt={class:"flex items-center gap-1 mb-3"},wt={class:"text-blue-400 font-semibold"},kt={class:"ml-auto flex gap-6 items-center"},_t=["rowspan"],ht={class:"border-2 border-gray-700 p-3 text-center"},$t=["title"],qt={class:"border-2 border-gray-700 p-3"},Ct={class:"whitespace-nowrap text-center print:whitespace-break-spaces"},Dt={key:0},It={key:1,class:"text-gray-500"},St={key:2,colspan:"2",class:"border-2 border-gray-700 p-3 text-center"},Rt={__name:"RequirementDetailTableRow",props:{detail:{type:Object},serial:{type:Number}},emits:["editClick","deleteClick","taskCreateClick"],setup(y,{emit:I}){const _=y,v=I,a=h("line-clamp-2");function w(){a.value=a.value?"":"line-clamp-2"}const m=ve(()=>{var o,s,g;return((s=(o=_.detail)==null?void 0:o.tasks)==null?void 0:s.length)>0?(g=_.detail)==null?void 0:g.tasks:[{id:0}]});return(o,s)=>{const g=ae("RouterLink");return r(!0),u(R,null,M(m.value,(d,c)=>{var l,b,p,i,q,n;return r(),u("tr",{key:d.id,class:"group/item border text-gray-800 py-4 shadow-sm mb-4 px-4 rounded-md hover:bg-blue-50"},[c===0?(r(),u(R,{key:0},[e("td",{class:"border-2 border-gray-700 p-3 align-top",rowspan:((b=(l=y.detail)==null?void 0:l.tasks)==null?void 0:b.length)||1},[e("span",pt,x(y.serial),1)],8,mt),e("td",{class:"border-2 border-gray-700 p-3",rowspan:((i=(p=y.detail)==null?void 0:p.tasks)==null?void 0:i.length)||1},[e("div",null,[e("div",ct,[e("span",null,x(y.detail.title),1)]),s[4]||(s[4]=e("hr",{class:"mb-4 -mx-4"},null,-1)),e("div",vt,[s[3]||(s[3]=e("div",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Description",-1)),e("div",ft,[e("p",{class:H(["print:line-clamp-none",a.value]),innerHTML:y.detail.description},null,10,xt),e("button",{class:"text-blue-500 group-hover/item:underline hover:text-sky-400 ml-auto text-sm print:hidden",onClick:k(w,["prevent"])},x(a.value?"Show More":"Show Less"),1)])])]),e("div",yt,[e("div",null,[e("div",gt,[s[5]||(s[5]=e("span",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Supervisor:",-1)),y.detail.supervisor?(r(),D(he,{key:0,user:y.detail.supervisor},null,8,["user"])):f("",!0)]),e("div",null,[s[6]||(s[6]=e("span",{class:"text-gray-500 mr-2 text-xs uppercase font-semibold"},"Priority:",-1)),e("span",wt,x(y.detail.priority),1)])]),e("div",kt,[e("button",{class:"btn-2",onClick:s[0]||(s[0]=k(t=>v("editClick",y.detail),["prevent"]))},s[7]||(s[7]=[e("i",{class:"fas fa-edit"},null,-1),T("Edit ")])),e("button",{class:"btn-2-red",onClick:s[1]||(s[1]=k(t=>v("deleteClick",y.detail),["prevent"]))},s[8]||(s[8]=[e("i",{class:"fas fa-trash-alt"},null,-1),T("Delete ")]))])])],8,bt),e("td",{class:"border-2 border-gray-700 p-3 whitespace-nowrap print:whitespace-break-spaces print:px-0 text-center",rowspan:((n=(q=y.detail)==null?void 0:q.tasks)==null?void 0:n.length)||1},[e("div",null,x(new Date(y.detail.better_to_complete_on).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",weekday:"short"})),1)],8,_t)],64)):f("",!0),d.id?(r(),u(R,{key:1},[e("td",ht,[C(g,{to:{name:"TaskShow",params:{id:d.id}},class:"hover:underline text-gray-900 hover:text-blue-600 whitespace-nowrap block",target:"_blank"},{default:S(()=>[T(x(d.id)+" ",1),e("i",{title:d.status,class:H(["ml-1",{"fad fa-exclamation-circle text-red-600":d.status=="PENDING","fad fa-exclamation-square text-yellow-600":d.status=="IN_PROGRESS","fad fa-check-circle text-green-600":d.status=="COMPLETED"}])},null,10,$t)]),_:2},1032,["to"])]),e("td",qt,[e("div",Ct,[d.deadline?(r(),u("div",Dt,x(new Date(d.deadline).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",weekday:"short"})),1)):(r(),u("div",It,"-"))])])],64)):(r(),u("td",St,[e("button",{onClick:s[2]||(s[2]=k(t=>v("taskCreateClick",y.detail),["prevent"])),class:"print:hidden hover:border-2 group-hover/item:bg-blue-200 hover:border-blue-700 text-blue-500 hover:text-white hover:!bg-blue-500 rounded-md px-4 py-1"}," Create Task ")]))])}),128)}}},Tt={class:"text-left p-4"},Et={class:"flex items-center gap-6 justify-center my-10"},Vt={key:0,class:"border rounded-md"},Nt={class:"flex flex-col justify-start items-start min-h-28 max-h-[70vh] overflow-y-auto"},Ut=["onClick"],Ft={class:"mt-[1px]"},Lt=["onClick"],At={__name:"TaskParentIdSelector",props:{fromDepartmentId:{type:Number}},emits:["parentIdSelect"],setup(y,{emit:I}){const _=y,v=I,a=$e(),w=h(!1);return fe(()=>w.value,m=>{m&&a.fetchTasks({"to-department-id":_.fromDepartmentId})},{immediate:!0}),(m,o)=>(r(),u("div",Tt,[e("div",Et,[e("button",{onClick:o[0]||(o[0]=k(s=>v("parentIdSelect",0),["prevent"])),class:"btn-3"},"Add as Main Task"),o[2]||(o[2]=e("span",null,"or",-1)),e("button",{class:H({"btn-3":!w.value,"btn-2":w.value}),onClick:o[1]||(o[1]=k(s=>w.value=!0,["prevent"]))}," Add as Sub Task ",2)]),w.value?(r(),u("div",Vt,[o[4]||(o[4]=e("div",{class:"py-2 px-4 font-bold text-center border-b shadow"}," Click to select task or sub task ",-1)),e("div",Nt,[(r(!0),u(R,null,M(de(a).tasks,s=>(r(),u("div",{key:s.id,class:"w-full mb-2"},[e("button",{type:"button",class:"text-left text-base w-full bg-blue-50 px-2 hover:bg-blue-500 hover:text-white py-4 text-blue-500 font-semibold",onClick:k(g=>v("parentIdSelect",s.id),["prevent"])},x(s.title),9,Ut),e("div",Ft,[(r(!0),u(R,null,M(s.children_tasks||[],g=>(r(),u("div",{key:g.id,class:"border-b"},[e("button",{type:"button",class:"text-left text-sm w-full hover:bg-blue-500 hover:text-white py-2",onClick:k(d=>v("parentIdSelect",g.id),["prevent"])},[o[3]||(o[3]=e("span",{class:"text-gray-400"},"—",-1)),T(x(g.title),1)],8,Lt)]))),128))])]))),128))])])):f("",!0)]))}},Mt={class:"container mx-auto p-6 print:p-0 w-full print:max-w-full"},Ot={class:"bg-white rounded shadow print:shadow-none p-4 print:p-0 relative"},Pt={class:"flex items-start"},jt={class:"mb-4 text-lg print:black print:font-bold"},zt={class:"ml-auto print:hidden flex gap-2 items-center"},Bt={class:"mb-4 flex items-center gap-1 print:mb-1"},Gt={class:"font-bold print:text-gray-900"},Wt={class:"mb-3 flex items-center gap-3 print:mb-1"},Ht={class:"print:text-gray-900"},Jt={key:0,class:"mb-3 flex items-center gap-3 print:mb-1"},Kt={class:"flex items-center gap-2 print:text-gray-900 flex-wrap"},Qt={class:"mb-3 flex items-center gap-3 print:mb-1"},Xt={class:"print:text-gray-900"},Yt={key:0,class:"overflow-x-auto print:overflow-visible"},Zt={class:"w-full table-auto print:table-fixed"},es={colspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap px-3 py-1 print:whitespace-normal w-[25%]"},ts={class:"whitespace-nowrap print:whitespace-break-spaces print:px-0 p-3 text-center border-2 border-gray-800"},ss={class:"text-gray-900 text-base"},ls={class:"mt-8 border rounded-md p-8 flex items-center justify-center bg-gray-50"},hs={__name:"RequirementShow",setup(y){const I=xe(),_=ye(),v=h(""),a=h(null),w=j({open:!1}),m=j({detail:null,open:!1}),o=j({detail:null,open:!1});G(async()=>{await s()});async function s(){var n;v.value="loading",a.value=(n=(await J(I.params.id)).data)==null?void 0:n.requirement,v.value=""}function g(n){console.log({detail:n}),p.modalShown=!0,p.from_department_id=a.value.from_department_id,p.to_department_id=a.value.to_department_id,p.taskDefaultValues={title:n.title,description:n.description,from_department_id:a.value.from_department_id,to_department_id:a.value.to_department_id},p.requirementDetail=n}function d(){w.open=!0}function c(n){m.open=!0,m.detail=n}function l(n){o.open=!0,o.detail=n}function b(){window.print()}const p=j({parentId:null,modalShown:!1,requirementId:0,taskDefaultValues:{},requirementDetail:null});async function i(){p.parentId=0,p.parentId=null,p.modalShown=!1,p.requirementDetail=null,v.value="loading",await s()}async function q(){p.parentId=null,p.modalShown=!1,p.requirementDetail=null}return(n,t)=>{var L,A,N,O,K,Q,X,Y,Z,ee,te,se,le,re,oe;const V=ae("RouterLink");return r(),u("div",Mt,[w.open?(r(),D(z,{key:0,class:"*:max-w-4xl"},{default:S(()=>[C(Le,{requirementId:a.value.id,onCloseClick:t[0]||(t[0]=$=>w.open=!1),onCreate:t[1]||(t[1]=async()=>{w.open=!1,await s()})},null,8,["requirementId"])]),_:1})):f("",!0),m.open?(r(),D(z,{key:1},{default:S(()=>{var $;return[C(ut,{requirementId:a.value.id,detailId:($=m.detail)==null?void 0:$.id,onCloseClick:t[2]||(t[2]=U=>m.open=!1),onUpdate:t[3]||(t[3]=async()=>{m.open=!1,await s()})},null,8,["requirementId","detailId"])]}),_:1})):f("",!0),o.open?(r(),D(z,{key:2},{default:S(()=>{var $;return[C(Ke,{requirementId:a.value.id,detailId:($=o.detail)==null?void 0:$.id,onCloseClick:t[4]||(t[4]=U=>o.open=!1),onDelete:t[5]||(t[5]=async()=>{o.open=!1,await s()})},null,8,["requirementId","detailId"])]}),_:1})):f("",!0),p.modalShown?(r(),D(z,{key:3,class:"*:relative"},{default:S(()=>{var $,U;return[e("button",{onClick:k(q,["prevent"]),class:"absolute right-3 top-2 text-xl text-red-500 hover:text-red-400"},t[8]||(t[8]=[e("i",{class:"fas fa-times-circle"},null,-1)])),p.parentId===null?(r(),D(At,{key:0,"from-department-id":($=a.value)==null?void 0:$.from_department_id,onParentIdSelect:t[6]||(t[6]=P=>p.parentId=P)},null,8,["from-department-id"])):(r(),D(_e,{key:1,parentTaskId:p.parentId,requirementDetailId:(U=p==null?void 0:p.requirementDetail)==null?void 0:U.id,requirementId:a.value.id,onClose:q,onTaskCreated:i,defaultValues:p.taskDefaultValues,readonlyFields:{from_department_id:!0,to_department_id:!0}},null,8,["parentTaskId","requirementDetailId","requirementId","defaultValues"]))]}),_:1})):f("",!0),e("div",Ot,[e("div",Pt,[e("div",jt,[t[9]||(t[9]=e("div",{class:"text-gray-800 leading-none"},"To",-1)),e("div",null,x((A=(L=a.value)==null?void 0:L.to_department)==null?void 0:A.name),1)]),e("div",zt,[(((N=a.value)==null?void 0:N.details)||[]).length>0?(r(),u("button",{key:0,class:"btn-3 font-semibold !pl-2 !pr-4",onClick:k(b,["prevent"])},t[10]||(t[10]=[e("i",{class:"fad fa-print text-xl"},null,-1),T("Print ")]))):f("",!0),e("button",{class:"btn-3",onClick:t[7]||(t[7]=k(()=>de(_).back(),["prevent"]))},"Back"),C(V,{class:"btn-2",to:`/requirements/edit/${(O=a.value)==null?void 0:O.id}`},{default:S(()=>t[11]||(t[11]=[T("Edit")])),_:1,__:[11]},8,["to"])])]),t[24]||(t[24]=e("div",{class:"text-center text-xl font-bold mb-2 underline"},"Requirement Form",-1)),e("div",Bt,[t[12]||(t[12]=e("div",{class:"text-gray-500 text-sm"},"Requirement ID:",-1)),e("div",Gt,x((K=a.value)==null?void 0:K.id),1)]),e("div",Wt,[t[13]||(t[13]=e("div",{class:"text-gray-500 text-sm"},"From",-1)),e("div",Ht,x((X=(Q=a.value)==null?void 0:Q.from_department)==null?void 0:X.name),1)]),((Z=(Y=a.value)==null?void 0:Y.website_tags)==null?void 0:Z.length)>0?(r(),u("div",Jt,[t[14]||(t[14]=e("div",{class:"text-gray-500 text-sm"},"Website",-1)),e("div",Kt,[(r(!0),u(R,null,M(((ee=a.value)==null?void 0:ee.website_tags)||[],$=>(r(),u("div",{key:$.id,class:"border px-2 rounded-md bg-gray-50 shadow-sm whitespace-nowrap"},x($.name),1))),128))])])):f("",!0),e("div",Qt,[t[15]||(t[15]=e("div",{class:"text-gray-500 text-sm"},"Submission Date",-1)),e("div",Xt,x(new Date((te=a.value)==null?void 0:te.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),1)]),t[25]||(t[25]=e("hr",{class:"mb-4"},null,-1)),e("div",null,[t[23]||(t[23]=e("div",{class:"flex items-end mb-3"},[e("h2",{class:"text-xl font-semibold"},"Requirements"),e("div",{class:"ml-auto print:hidden flex gap-2 text-sm"})],-1)),(((se=a.value)==null?void 0:se.details)||[]).length>0?(r(),u("div",Yt,[e("table",Zt,[e("thead",null,[e("tr",null,[t[16]||(t[16]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-left px-4 text-gray-800 print:text-black text-xl font-semibold whitespace-nowrap w-[15%]"}," SL ",-1)),t[17]||(t[17]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap w-[65%]"}," Requirement Details ",-1)),t[18]||(t[18]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base px-3 font-semibold whitespace-nowrap print:whitespace-normal print:p-0 w-[15%]"}," Better To Complete ",-1)),e("th",es," For '"+x(((le=a.value.to_department)==null?void 0:le.short_name)||((re=a.value.to_department)==null?void 0:re.name))+"' Use ",1)]),t[19]||(t[19]=e("tr",null,[e("td",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-sm font-semibold whitespace-nowrap p-3 print:whitespace-normal"}," Issue No "),e("td",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-sm font-semibold whitespace-nowrap p-3 print:whitespace-normal print:p-0"}," Expected Date ")],-1))]),e("tbody",null,[(r(!0),u(R,null,M(((oe=a.value)==null?void 0:oe.details)||[],($,U)=>{var P,ie;return r(),u(R,{key:$.id},[C(Rt,{detail:$,serial:U+1,onEditClick:c,onDeleteClick:l,onTaskCreateClick:g},null,8,["detail","serial"]),e("tr",null,[e("td",ts,[e("div",ss," For '"+x(((P=a.value.to_department)==null?void 0:P.short_name)||((ie=a.value.to_department)==null?void 0:ie.name))+"' Use ",1),t[20]||(t[20]=e("div",{class:"text-gray-800 text-xs"},"(Feedback)",-1))]),t[21]||(t[21]=e("td",{class:"whitespace-nowrap p-3 text-center border-2 border-gray-800",colspan:"4"},null,-1))])],64)}),128))])])])):f("",!0),e("div",ls,[e("button",{class:"btn-2 pl-2 text-base",onClick:k(d,["prevent"])},t[22]||(t[22]=[e("i",{class:"fad fa-plus-circle text-2xl mr-2"},null,-1),T("Add Requirement ")]))])]),v.value==="loading"?(r(),D(W,{key:1,class:"absolute inset-0 bg-opacity-90"})):f("",!0)])])}}};export{hs as default};
