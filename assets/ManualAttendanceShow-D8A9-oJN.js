import{u as ot,r as Ze,x as et,b as rt,c as a,a as t,k as o,j as ut,t as n,e as r,p as dt,h as b,l as it,d as ct,v as pt,F as vt,f as _t,o as l,g as mt}from"./index-qYpg0mVE.js";import{L as yt}from"./LoaderView-BmvcK0j0.js";import{_ as bt}from"./ShareComponent-6JtcJapn.js";import{u as gt}from"./manual-attendance-lkzKBVra.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const kt={class:"my-container max-w-3xl space-y-6"},ft={key:1,class:"card-bg p-4 md:p-8"},xt={class:"grid md:grid-cols-2"},ht={key:0},At={key:1},wt={key:2},jt={key:3},Ct={class:"pt-10"},Bt={class:"font-medium"},Mt={class:"text-sm"},Rt={class:"title-md"},Nt={key:0},Dt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},St={class:"pt-10"},$t={key:0},Ft={key:1},Lt={key:2,class:"print:hidden"},Vt={class:"text-xs text-blue-600"},It={class:"flex gap-4"},Tt={class:"font-bold"},qt={key:0,class:"text-green-600"},Wt={key:1,class:"pl-2 text-yellow-700"},Et={class:"pt-10"},Gt={key:0},Pt={key:1},zt={key:2,class:"print:hidden"},Ot={class:"text-xs text-blue-600"},Ut={class:"flex gap-4"},Ht={class:"font-bold"},Jt={key:0,class:"text-green-600"},Kt={key:1,class:"pl-2 text-yellow-700"},Qt={class:"flex flex-col pt-10"},Xt={key:0},Yt={key:1},Zt={key:2,class:"print:hidden"},es={class:"text-xs text-blue-600"},ts={class:"flex gap-4"},ss={class:"font-bold"},ls={key:0,class:"text-green-600"},as={key:1,class:"pl-2 text-yellow-700"},ns={key:0,class:"modal-bg"},os={class:"modal-card"},rs={class:"flex justify-end gap-2 mt-4"},_s={__name:"ManualAttendanceShow",setup(us){const tt=mt(),c=_t(),d=gt(),_=ot(),p=Ze(!1),v=Ze(""),st=et(()=>d.loading),s=et(()=>d.manualAttendance);rt(async()=>{const{id:u}=c.params;try{await d.fetchManualAttendanceById(u)}catch(e){console.error("Failed to fetch manual attendance details:",e)}});const lt=async()=>{try{await d.rejectManualAttendance(c.params.id,v.value),alert("Manual attendance rejected successfully!"),p.value=!1,v.value="",await d.fetchManualAttendanceById(c.params.id)}catch(u){console.error("Failed to reject manual attendance:",u),alert("Failed to reject manual attendance.")}},m=()=>{p.value=!0},y=async u=>{try{const{id:e}=c.params;u==="inCharge"&&await d.inChargeAccept(e),u==="recommend"&&await d.recommendByAccept(e),u==="approve"&&await d.approvedByAccept(e),alert(`${u} accepted successfully!`),await d.fetchManualAttendanceById(e)}catch(e){console.error(`Failed to accept ${u}:`,e),alert(`Failed to accept ${u}.`)}},at=()=>tt.go(-1);function nt(){window.print()}return(u,e)=>{var g,k,f,x,h,A,w,j,C,B,M,R,N,D,S,$,F,L,V,I,T,q,W,E,G,P,z,O,U,H,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ue,de,ie,ce,pe,ve,_e,me,ye,be,ge,ke,fe,xe,he,Ae,we,je,Ce,Be,Me,Re,Ne,De,Se,$e,Fe,Le,Ve,Ie,Te,qe,We,Ee,Ge,Pe,ze,Oe,Ue,He,Je,Ke,Qe,Xe,Ye;return l(),a(vt,null,[t("div",kt,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:at},e[5]||(e[5]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[7]||(e[7]=t("h1",{class:"title-lg text-center"},"Manual Attendance Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:nt},e[6]||(e[6]=[t("i",{class:"far fa-print"},null,-1),o(" Print ")]))])]),st.value?(l(),ut(yt,{key:0})):(l(),a("div",ft,[e[34]||(e[34]=t("h2",{class:"title-md"},"Manual Attendance Request",-1)),t("div",null,[t("div",xt,[(g=s.value)!=null&&g.check_in?(l(),a("div",ht,[e[8]||(e[8]=t("b",null,"Date:",-1)),o(" "+n(new Date((k=s.value)==null?void 0:k.check_in).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})),1)])):r("",!0),(f=s.value)!=null&&f.check_out?(l(),a("div",At,[e[9]||(e[9]=t("b",null,"Date:",-1)),o(" "+n(new Date((x=s.value)==null?void 0:x.check_out).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})),1)])):r("",!0),(h=s.value)!=null&&h.check_in?(l(),a("div",wt,[e[10]||(e[10]=t("b",null,"Check-In:",-1)),o(" "+n((A=s.value)!=null&&A.check_in?new Date(s.value.check_in).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"),1)])):r("",!0),(w=s.value)!=null&&w.check_out?(l(),a("div",jt,[e[11]||(e[11]=t("b",null,"Check-Out:",-1)),o(" "+n((j=s.value)!=null&&j.check_out?new Date(s.value.check_out).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"),1)])):r("",!0),t("div",null,[e[12]||(e[12]=t("b",null,"Type:",-1)),o(" "+n((C=s.value)==null?void 0:C.type),1)]),t("div",null,[e[13]||(e[13]=t("b",null,"Reason:",-1)),o(" "+n(((B=s.value)==null?void 0:B.description)||"N/A"),1)])]),t("div",Ct,[t("div",null,[e[14]||(e[14]=t("hr",{class:"w-44 border-black"},null,-1)),e[15]||(e[15]=t("div",null,[t("b",null,"Applicant")],-1)),t("p",Bt,n((M=s.value)==null?void 0:M.user.name),1),t("div",Mt,[t("p",null,n((D=(N=(R=s.value)==null?void 0:R.user)==null?void 0:N.department)==null?void 0:D.name),1),t("p",null,n((F=($=(S=s.value)==null?void 0:S.user)==null?void 0:$.designation)==null?void 0:F.title),1)])])])]),e[35]||(e[35]=t("hr",null,null,-1)),t("div",null,[t("h3",Rt,[e[16]||(e[16]=o(" Approvals ")),t("span",{class:dt({"text-yellow-500":((L=s.value)==null?void 0:L.status)==="Pending","text-green-500":((V=s.value)==null?void 0:V.status)==="Approved","text-red-500":((I=s.value)==null?void 0:I.status)==="Rejected"})}," ("+n(((T=s.value)==null?void 0:T.status)||"N/A")+") ",3)]),((q=s.value)==null?void 0:q.status)==="Rejected"?(l(),a("div",Nt,[t("div",null,[e[17]||(e[17]=t("b",null,"Rejected By:",-1)),o(" "+n(((E=(W=s.value)==null?void 0:W.rejected_by_user)==null?void 0:E.name)||"N/A"),1)]),t("div",null,[e[18]||(e[18]=t("b",null,"Rejection Reason:",-1)),o(" "+n(((G=s.value)==null?void 0:G.rejection_reason)||"N/A"),1)])])):r("",!0)]),t("div",Dt,[t("div",St,[(P=s.value)!=null&&P.in_charge_user?(l(),a("p",$t,n(((O=(z=s.value)==null?void 0:z.in_charge_user)==null?void 0:O.name)||""),1)):(l(),a("p",Ft,n(((K=(J=(H=(U=s.value)==null?void 0:U.user)==null?void 0:H.other_approval)==null?void 0:J.in_charge_user)==null?void 0:K.name)||"N/A"),1)),((Q=s.value)==null?void 0:Q.status)!=="Rejected"&&((X=s.value)==null?void 0:X.status)!=="Approved"&&!((Y=s.value)!=null&&Y.in_charge_user_id)&&((te=(ee=(Z=s.value)==null?void 0:Z.user)==null?void 0:ee.other_approval)==null?void 0:te.in_charge_user_id)===((le=(se=b(_))==null?void 0:se.user)==null?void 0:le.id)?(l(),a("div",Lt,[t("p",Vt,[o(n((ne=(ae=s.value)==null?void 0:ae.user)==null?void 0:ne.name)+' has submitted an "attendance request". ',1),e[19]||(e[19]=t("br",null,null,-1)),e[20]||(e[20]=o(" Will you forward it? "))]),t("div",It,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[0]||(e[0]=i=>y("inCharge"))}," ✔ "),t("button",{class:"",onClick:m},"❌")])])):r("",!0),e[23]||(e[23]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Tt,[e[22]||(e[22]=o(" In-Charge ")),(oe=s.value)!=null&&oe.in_charge_user_id?(l(),a("span",qt,"(✔)")):r("",!0),(de=(ue=(re=s.value)==null?void 0:re.user)==null?void 0:ue.other_approval)!=null&&de.in_charge_user&&!((ie=s.value)!=null&&ie.in_charge_user_id)?(l(),a("span",Wt,e[21]||(e[21]=[t("i",{class:"fad fa-spinner"},null,-1)]))):r("",!0)])]),t("div",Et,[(ce=s.value)!=null&&ce.recommend_by_user?(l(),a("p",Gt,n(((ve=(pe=s.value)==null?void 0:pe.recommend_by_user)==null?void 0:ve.name)||""),1)):(l(),a("p",Pt,n(((be=(ye=(me=(_e=s.value)==null?void 0:_e.user)==null?void 0:me.other_approval)==null?void 0:ye.recommend_by_user)==null?void 0:be.name)||"N/A"),1)),((ge=s.value)==null?void 0:ge.status)!=="Rejected"&&((ke=s.value)==null?void 0:ke.status)!=="Approved"&&!((fe=s.value)!=null&&fe.recommend_by_user_id)&&((Ae=(he=(xe=s.value)==null?void 0:xe.user)==null?void 0:he.other_approval)==null?void 0:Ae.recommend_by_user_id)===((we=b(_).user)==null?void 0:we.id)?(l(),a("div",zt,[t("p",Ot,[o(n((Ce=(je=s.value)==null?void 0:je.user)==null?void 0:Ce.name)+' has submitted an "attendance request".',1),e[24]||(e[24]=t("br",null,null,-1)),e[25]||(e[25]=o(" Will you recommend it? "))]),t("div",Ut,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=i=>y("recommend"))}," ✔ "),t("button",{class:"",onClick:m},"❌")])])):r("",!0),e[28]||(e[28]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Ht,[e[27]||(e[27]=o(" Recommend By ")),(Be=s.value)!=null&&Be.recommend_by_user_id?(l(),a("span",Jt,"(✔)")):r("",!0),(Ne=(Re=(Me=s.value)==null?void 0:Me.user)==null?void 0:Re.other_approval)!=null&&Ne.recommend_by_user&&!((De=s.value)!=null&&De.recommend_by_user_id)?(l(),a("span",Kt,e[26]||(e[26]=[t("i",{class:"fad fa-spinner"},null,-1)]))):r("",!0)])])]),t("div",Qt,[(Se=s.value)!=null&&Se.approved_by_user?(l(),a("p",Xt,n(((Fe=($e=s.value)==null?void 0:$e.approved_by_user)==null?void 0:Fe.name)||""),1)):(l(),a("p",Yt,n(((Te=(Ie=(Ve=(Le=s.value)==null?void 0:Le.user)==null?void 0:Ve.other_approval)==null?void 0:Ie.approved_by_user)==null?void 0:Te.name)||"N/A"),1)),((qe=s.value)==null?void 0:qe.status)!=="Rejected"&&((We=s.value)==null?void 0:We.status)!=="Approved"&&!((Ee=s.value)!=null&&Ee.approved_by_user_id)&&((ze=(Pe=(Ge=s.value)==null?void 0:Ge.user)==null?void 0:Pe.other_approval)==null?void 0:ze.approved_by_user_id)===((Oe=b(_).user)==null?void 0:Oe.id)?(l(),a("div",Zt,[t("p",es,[o(n((He=(Ue=s.value)==null?void 0:Ue.user)==null?void 0:He.name)+' has submitted an "attendance request".',1),e[29]||(e[29]=t("br",null,null,-1)),e[30]||(e[30]=o(" Will you accept it? "))]),t("div",ts,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=i=>y("approve"))}," ✔ "),t("button",{class:"",onClick:m},"❌")])])):r("",!0),e[33]||(e[33]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",ss,[e[32]||(e[32]=o(" Approved By ")),(Je=s.value)!=null&&Je.approved_by_user_id?(l(),a("span",ls,"(✔)")):r("",!0),(Xe=(Qe=(Ke=s.value)==null?void 0:Ke.user)==null?void 0:Qe.other_approval)!=null&&Xe.approved_by_user&&!((Ye=s.value)!=null&&Ye.approved_by_user_id)?(l(),a("span",as,e[31]||(e[31]=[t("i",{class:"fad fa-spinner"},null,-1)]))):r("",!0)])])])),it(bt)]),p.value?(l(),a("div",ns,[t("div",os,[e[36]||(e[36]=t("h3",{class:"title-lg"},"Reject Manual Attendance",-1)),ct(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=i=>v.value=i),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[pt,v.value]]),t("div",rs,[t("button",{class:"btn-3",onClick:e[4]||(e[4]=i=>p.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:lt},"Confirm")])])])):r("",!0)],64)}}};export{_s as default};
