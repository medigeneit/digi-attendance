import{q as f,s as R,A as H,e as j,c as u,o as p,a as t,f as U,w as _,g as y,C as M,F as V,x as h,t as B,h as I,l as T,p as D,E as A,v as z,n as F}from"./index-BUDGAavx.js";import{_ as G}from"./MultiselectDropdown-BgYTf_d2.js";import{u as q}from"./company-DYWboLb9.js";import{_ as N}from"./UserChip-CjsK7O_R.js";import{_ as O}from"./TaskTreeView-BsKjzE-h.js";import{g as W}from"./task-priority-DjN6EaGu.js";const J={class:"mb-3 task-header"},K={class:"flex justify-between items-center"},Q={class:"ml-auto flex gap-6 items-center"},X={key:0,class:"flex gap-2 items-center"},Y={class:"flex flex-wrap items-center gap-2 mt-3"},Z={class:"flex flex-wrap gap-4 w-full"},ee={class:"text-gray-600 w-full md:w-64 relative"},te=["value"],se={class:"relative w-full md:w-72"},le={key:0,class:"absolute right-8 text-xl top-0 bottom-0 flex items-center"},oe={class:"text-gray-600 w-40 relative"},ae={class:"flex gap-4 items-center flex-shrink-0"},ne={class:"flex gap-2"},ie={class:"flex gap-2"},re={class:"flex gap-2"},de={class:"text-gray-600 w-full md:w-40 md:ml-auto relative"},be={__name:"TaskHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(g,{emit:S}){const v=g,x=f(i("company-id")),b=f(i("user-ids")),w=f(i("month")),C=f(i("status")),a=f(i("is-important")),l=f(i("is-urgent")),d=f(i("is-target")),r=S,m=q(),{companies:c,employees:n}=R(m);function i(o){return{get:()=>v.modelValue[o]||"",set:e=>{console.log("---SETTING modelValue: ",{key:o,value:e}),r("update:modelValue",{...v.modelValue,[o]:e||void 0})}}}const k=f(()=>P(b.value));async function E(o){o&&await m.fetchEmployee(o)}H(()=>x.value,E),j(async()=>{var o,e;await m.fetchCompanies(),(o=v.modelValue)!=null&&o["company-id"]&&await E((e=v.modelValue)==null?void 0:e["company-id"])});function P(o){return Array.isArray(n.value)&&n.value.find(e=>e.id==o)||null}function L(o){b.value=(o==null?void 0:o.id)||""}function $(){b.value=""}return(o,e)=>(p(),u("div",J,[t("div",K,[e[10]||(e[10]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Task List",-1)),t("div",Q,[g.listHasRearranged?(p(),u("div",X,[e[9]||(e[9]=t("span",{class:"text-red-500"},"Priority Changed",-1)),t("button",{class:"btn-3",onClick:e[0]||(e[0]=_(s=>r("clickPrioritySave"),["prevent"]))},"Save"),t("button",{class:"btn-3",onClick:e[1]||(e[1]=_(s=>r("clickPriorityDiscard"),["prevent"]))},"Discard")])):U("",!0),t("button",{onClick:e[2]||(e[2]=s=>r("clickAddTask")),class:"btn-1"},"Add Task")])]),t("div",Y,[t("div",Z,[t("div",ee,[e[12]||(e[12]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Company",-1)),y(t("select",{id:"company-filter","onUpdate:modelValue":e[3]||(e[3]=s=>x.value=s),class:"input-1"},[e[11]||(e[11]=t("option",{value:""},"All Company",-1)),(p(!0),u(V,null,h(I(c),s=>(p(),u("option",{key:s.id,value:s.id},B(s.name),9,te))),128))],512),[[M,x.value]])]),t("div",se,[T(G,{modelValue:k.value,onSelect:L,onRemove:$,options:I(n),multiple:!1,label:"name","label-prefix":"id",placeholder:"All Employees",class:"text-gray-600 w-full"},{option:D(({option:s})=>[T(N,{user:s,class:"w-full line-clamp-1"},null,8,["user"])]),_:1},8,["modelValue","options"]),k.value?(p(),u("div",le,[t("button",{onClick:_($,["prevent"]),class:"mt-0.5 text-gray-500 hover:text-red-700"}," Ã— ")])):U("",!0),e[13]||(e[13]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"},"Employee",-1))]),t("div",oe,[e[15]||(e[15]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),y(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>C.value=s),class:"input-1"},e[14]||(e[14]=[t("option",{value:""},"All Tasks",-1),t("option",{value:"not-completed"},"Not Completed",-1),t("option",{value:"only-completed"},"Completed",-1)]),512),[[M,C.value]])]),t("div",ae,[t("label",ne,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>a.value=s)},null,512),[[A,a.value]]),e[16]||(e[16]=t("span",null,"Important",-1))]),t("label",ie,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>l.value=s)},null,512),[[A,l.value]]),e[17]||(e[17]=t("span",null,"Urgent",-1))]),t("label",re,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=s=>d.value=s)},null,512),[[A,d.value]]),e[18]||(e[18]=t("span",null,"Is Target",-1))])]),t("div",de,[e[19]||(e[19]=t("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),y(t("input",{id:"month-filter","onUpdate:modelValue":e[8]||(e[8]=s=>w.value=s),type:"month",class:"input-1",placeholder:"All month"},null,512),[[z,w.value]])])])])]))}},ue={class:"w-full bg-white rounded"},pe=["rowspan"],me={class:""},ge={__name:"UserWiseList",props:{tasks:Array,selectedUserId:{type:String,default:null}},emits:["commentButtonClick","editClick","addClick","updatePriority"],setup(g,{emit:S}){const v=g,x=S,b=f(()=>v.tasks.reduce((a,l)=>(a.push(...l.users.filter(d=>!a.find(r=>r.id==d.id&&d.id))),a),[]).filter(a=>v.selectedUserId?a.id==v.selectedUserId:!0)),w=a=>{const l=v.tasks,d=new Map(l.map(n=>[n.id,n])),r=new Set,m=[],c=l.filter(n=>n.users.some(i=>i.id===a));for(const n of c){r.has(n.id)||(r.add(n.id),m.push(n));let i=n.parent_id;for(;i&&d.has(i)&&!r.has(i);){const k=d.get(i);r.add(k.id),m.push(k),i=k.parent_id}}return m},C=f(()=>b.value.map(a=>{const l=W(w(a.id),0);return{...a,tasks:l}}));return(a,l)=>(p(),u("div",null,[t("table",ue,[t("tbody",null,[(p(!0),u(V,null,h(C.value,d=>(p(),u(V,{key:d.id},[(p(!0),u(V,null,h(d.tasks,(r,m)=>(p(),u("tr",{key:r.id},[m==0?(p(),u("td",{key:0,class:"border p-4 align-top",rowspan:Math.max(d.tasks.length,1)},[T(N,{user:d,class:"sticky top-[80px]"},null,8,["user"])],8,pe)):U("",!0),t("td",me,[T(O,{task:r,class:"!border-0",index:m,onCommentButtonClick:l[0]||(l[0]=c=>x("commentButtonClick",a.item.id)),onEditClick:l[1]||(l[1]=c=>x("editClick",c)),onAddClick:l[2]||(l[2]=c=>x("addClick",c))},{"item-override":D(({task:c,level:n})=>[F(B({task:c,level:n}),1)]),_:2},1032,["task","index"])])]))),128))],64))),128))])])]))}};export{be as _,ge as a};
