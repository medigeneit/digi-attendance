import{_ as Xe,r as R,G as Oe,x as k,q as K,c as d,o,a as e,O as $e,w as J,s as w,d as q,l as Ce,v as Re,f as Ze,u as qe,D as Ee,h as oe,y as Ae,k as v,j as Ge,m as Z,n as j,t as p,F as $,e as U,b as B,N as et}from"./index-rscWEtDR.js";import{L as tt}from"./LoaderView-DVnz5q4q.js";import{_ as st}from"./EmployeeFilter-BxIs1UMq.js";import{U as nt}from"./UserChip-6WI2zXUg.js";import{g as Le,b as W}from"./datetime-Du_mcDA9.js";import{j as at}from"./url-Buz9GlSr.js";import{u as rt}from"./attendance-D4uhNVuD.js";import{u as ot}from"./company-DgdC7d3H.js";import{u as dt}from"./department-DJnlaGz8.js";import{u as lt}from"./useTodoDateStore-BNQLsOrU.js";import"./EmployeeDropdownInput-CqYTa6n7.js";import"./SelectDropdown-DY5-Wrcl.js";import"./user-DVvZTJ7c.js";const it={class:"px-4 py-4 md:py-3 bg-white rounded-md border"},pt={class:"flex flex-wrap items-center gap-3"},ut=["disabled"],mt={class:"print-hide"},yt={class:"flex flex-col md:flex-row flex-wrap items-end md:ml-auto w-full md:w-auto gap-x-3 gap-y-4 print-hide"},ct={class:"flex items-center justify-between w-full md:w-auto gap-3"},gt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},xt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},ft={__name:"TodoReportHeading",props:{loading:{type:Boolean,default:!1},companyId:{type:[String,Number],default:""},departmentId:{type:[String,Number],default:""},employeeId:{type:[String,Number],default:""},lineType:{type:String,default:"all"},startDate:{type:String,default:""},endDate:{type:String,default:""}},emits:["reloadClick","change"],setup(P,{expose:C,emit:G}){const u=P,A=R(null),z=G,i=Oe({companyId:String(u.companyId||""),departmentId:u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",employeeId:String(u.employeeId||""),lineType:u.lineType||"all",startDate:u.startDate||"",endDate:u.endDate||""}),M=k(()=>({companyId:i.companyId,departmentId:i.departmentId,employeeId:i.employeeId,lineType:i.lineType,startDate:i.startDate,endDate:i.endDate}));function Q(){z("change",{...M.value})}K(()=>[u.companyId,u.departmentId,u.employeeId,u.lineType,u.startDate,u.endDate],()=>{i.companyId=String(u.companyId||""),i.departmentId=u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",i.employeeId=String(u.employeeId||""),i.lineType=u.lineType||"all",i.startDate=u.startDate||"",i.endDate=u.endDate||""});function V(t){const l=new Date(i.startDate);l.setDate(l.getDate()+t),i.startDate=l.toISOString().split("T")[0];const g=new Date(i.endDate);g.setDate(g.getDate()+t),i.endDate=g.toISOString().split("T")[0]}return K(M,Q,{deep:!0}),C({employees:k(()=>{var t;return((t=A.value)==null?void 0:t.employees)||[]})}),(t,l)=>(o(),d("div",it,[e("div",pt,[$e(t.$slots,"before",{},void 0,!0),e("button",{class:w(["btn-icon print-hide",{"animate-spin !bg-opacity-0":P.loading}]),onClick:l[0]||(l[0]=J(g=>z("reloadClick"),["prevent"])),disabled:P.loading,title:"Reload"},[e("i",{class:w(["fas fa-redo",[P.loading?"text-gray-400":"text-gray-500"]])},null,2)],10,ut),e("span",mt,[$e(t.$slots,"after",{},void 0,!0)]),e("div",yt,[q(st,{ref_key:"employeeFilterRef",ref:A,company_id:i.companyId,"onUpdate:company_id":l[1]||(l[1]=g=>i.companyId=g),department_id:i.departmentId,"onUpdate:department_id":l[2]||(l[2]=g=>i.departmentId=g),employee_id:i.employeeId,"onUpdate:employee_id":l[3]||(l[3]=g=>i.employeeId=g),line_type:i.lineType,"onUpdate:line_type":l[4]||(l[4]=g=>i.lineType=g),"with-type":!0,class:"flex-1 gap-y-4 md:flex items-center justify-between w-full md:w-auto"},null,8,["company_id","department_id","employee_id","line_type"]),e("div",ct,[e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:l[5]||(l[5]=J(()=>V(-1),["prevent"]))},l[9]||(l[9]=[e("span",{class:"fas fa-arrow-left"},null,-1)])),e("div",gt,[l[10]||(l[10]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Start Date",-1)),Ce(e("input",{type:"date","onUpdate:modelValue":l[6]||(l[6]=g=>i.startDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Re,i.startDate]])]),e("div",xt,[l[11]||(l[11]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"End Date",-1)),Ce(e("input",{type:"date","onUpdate:modelValue":l[7]||(l[7]=g=>i.endDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Re,i.endDate]])]),e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:l[8]||(l[8]=J(()=>V(1),["prevent"]))},l[12]||(l[12]=[e("span",{class:"fas fa-arrow-right"},null,-1)]))])])])]))}},bt=Xe(ft,[["__scopeId","data-v-c25b1fcb"]]),vt={class:"container print:flex-grow mx-auto print:w-full print:px-0 print:py-0"},wt=["disabled"],ht={key:0,class:"bg-white border rounded-md mb-2 p-4 text-sm print:border-0 print:mb-2 print:px-0 print:w-full relative overflow-visible z-40"},_t={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-y-2 gap-x-6"},Dt={class:"font-medium text-gray-800"},kt={class:"col-span-2"},Tt={class:"font-medium text-gray-800"},It={class:"inline-flex items-center gap-5 font-bold"},St={class:"text-gray-700"},Nt={key:0,class:"mt-2 w-[280px] sm:w-[320px] lg:w-[280px] xl:w-[320px] bg-white border border-gray-200 rounded-md p-3 shadow-lg text-left absolute right-0"},$t={class:"flex items-center justify-between mb-2"},Ct={class:"text-[11px] text-gray-500"},Rt={class:"space-y-3 max-h-56 overflow-auto pr-1 z-50"},Et={class:"pt-2 border-t border-dashed border-gray-200"},At={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1 flex items-center justify-between"},Lt={class:"flex items-center gap-2"},Ot={key:0,class:"bg-red-500 rounded-md px-1.5 text-white text-center"},jt={key:0,class:"flex flex-wrap gap-2"},Ut={key:0,class:"text-xs text-gray-400"},Bt=["title"],Pt={class:"block max-w-[160px] truncate"},zt={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1"},Mt={key:0,class:"bg-green-500 rounded-md px-1.5 text-white text-center"},Vt={class:"flex flex-wrap gap-2"},Ft={key:0,class:"text-xs text-gray-400"},Ht=["title"],Wt={class:"block max-w-[160px] truncate"},Kt={key:1,class:"text-center text-gray-500 py-12 border bg-gray-50 rounded-md min-h-[70vh] flex flex-col items-center justify-center space-y-4"},Jt={key:3,class:"overflow-x-auto md:overflow-clip bg-white border border-t-0 rounded-md shadow-sm print:shadow-none print:rounded-none print:border-gray-400"},Qt={class:"min-w-full text-left text-sm border-separate border-spacing-0"},Yt={class:"bg-gray-50 text-gray-600 uppercase tracking-wide text-xs"},Xt={class:"border-y print:border-gray-400 sticky md:top-[123px] z-30 rounded-t-md"},Zt={class:"px-4 py-3 border md:w-[100px] print:w-auto print:border-l print:border-l-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center whitespace-nowrap"},qt={class:"flex items-center justify-between gap-2"},Gt={class:"ml-1 text-[10px] text-gray-500"},es={key:0,class:"px-4 py-3 border bg-white bg-opacity-70 backdrop-blur-sm text-center"},ts={class:"divide-y divide-gray-200"},ss={key:0},ns=["colspan"],as=["rowspan"],rs={class:"sticky top-[180px] bg-white text-center"},os=["rowspan"],ds=["user"],ls={key:0,class:"flex items-center gap-3"},is={class:"font-semibold text-gray-800"},ps=["href"],us={class:"text-xs text-gray-500"},ms=["rowspan"],ys={class:"sticky top-[180px] bg-white"},cs={key:0,class:"text-[11px] text-gray-500 mt-2"},gs={key:0,class:"grid grid-cols-2 gap-4"},xs={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},fs={class:"flex gap-1 items-center justify-between"},bs={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},vs={class:"flex gap-1 items-center justify-between"},ws={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},hs={class:"flex gap-1 items-center justify-between"},_s={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},Ds={class:"flex gap-1 items-center justify-between"},ks={key:1,class:"mt-1 text-gray-500 text-center"},Ts=["rowspan"],Is={class:"sticky top-[180px] bg-white"},Ss={class:"font-medium"},Ns={class:"text-gray-400 mr-2"},$s={class:"text-xs text-gray-500 mt-1 flex flex-wrap gap-2"},Cs={key:0,class:"font-semibold text-blue-600"},Rs={key:1},de="border-b-2 border-b-blue-200",Ws={__name:"TodoReportView",setup(P){var ye,ce,ge,xe,fe,be;const C=Ze(),G=qe(),u=lt(),A=ot(),z=dt(),{companies:i}=Ee(A),{departments:M}=Ee(z),Q=R(null),V=Le(new Date),t=Oe({companyId:((ye=C.query)==null?void 0:ye.company_id)||"",departmentId:((ce=C.query)==null?void 0:ce.department_id)||"",employeeId:((ge=C.query)==null?void 0:ge.employee_id)||"",lineType:((xe=C.query)==null?void 0:xe.line_type)||"all",startDate:((fe=C.query)==null?void 0:fe.start_date)||V,endDate:((be=C.query)==null?void 0:be.end_date)||V}),l=k(()=>{if(!t.startDate||!t.endDate)return[];const n=new Date(t.startDate),s=new Date(t.endDate);if(Number.isNaN(n.getTime())||Number.isNaN(s.getTime()))return[];const r=n<=s?1:-1,y=new Date(n),c=[];for(;c.push(Le(y)),y.getTime()!==s.getTime();)y.setDate(y.getDate()+r);return c}),g=k(()=>{var s;return[...((s=Q.value)==null?void 0:s.employees)||[]].filter(r=>t.employeeId?String(r.id)===String(t.employeeId):!0).sort((r,y)=>{var c,f;return(((c=r.user)==null?void 0:c.name)||"").localeCompare(((f=y.user)==null?void 0:f.name)||"")}).map(r=>{const y=u.todo_dates.filter(a=>{var b;return String((b=a.user)==null?void 0:b.id)===String(r.id)});let c=l.value.map(a=>{const b={WORKING:1,PENDING:2,DEPENDANT:3,COMPLETED:4,BACK_LOG:5},T=y.filter(D=>D.date===a).sort((D,S)=>{const m=b[D.status]||999,x=b[S.status]||999;return m!==x?m-x:(D.priority||0)-(S.priority||0)});return T.length?{date:a,rowSpan:T.length,todos:T}:{date:a,rowSpan:1,todos:[{id:`empty-${r.id}-${a}`,isPlaceholder:!0,title:"",date:a}]}});c.length||(c=[{date:null,rowSpan:1,todos:[{id:`empty-${r.id}`,isPlaceholder:!0,title:""}]}]);const f=c.reduce((a,b)=>a+b.rowSpan,0);return{user:r,dates:c,rowSpan:Math.max(1,f)}})}),je=k(()=>{if(!t.startDate||!t.endDate)return"";const n=W(t.startDate,{weekDay:"long"}),s=W(t.endDate,{weekDay:"long"});return`${n} ~ ${s}`}),Ue=k(()=>A.employees||[]),Be={all:"All Types",executive:"Executive",support_staff:"Support Staff",doctor:"Doctor",academy_body:"Academy Body"},E=k(()=>{var c,f,a,b,T,D,S,m;const n=t.companyId&&((c=i.value)!=null&&c.length)?(f=i.value.find(x=>String(x.id)===String(t.companyId)))==null?void 0:f.name:null,s=t.departmentId&&((a=M.value)!=null&&a.length)?(b=M.value.find(x=>String(x.id)===String(t.departmentId)))==null?void 0:b.name:null;let r=null;t.employeeId&&(r=((D=(T=Ue.value)==null?void 0:T.find(x=>String(x.id)===String(t.employeeId)))==null?void 0:D.name)||((m=(S=g.value.find(x=>{var L;return String(((L=x.user)==null?void 0:L.id)||"")===String(t.employeeId)}))==null?void 0:S.user)==null?void 0:m.name)||null);const y=t.startDate===t.endDate&&t.startDate?W(t.startDate,{weekDay:"long"}):je.value||"-";return{company:n||(t.companyId?`#${t.companyId}`:"All Companies"),department:s||(t.departmentId?`#${t.departmentId}`:"All Departments"),employee:r||(t.employeeId?`#${t.employeeId}`:"All Employees"),lineType:Be[t.lineType]||t.lineType||"All Types",dateRange:y}}),O=R(!1),ee=R(null),te=k(()=>{var n;return((n=g.value)==null?void 0:n.length)||0}),le=k(()=>{var n,s;return Math.max(0,te.value-(((s=(n=I.value)==null?void 0:n.withoutTodos)==null?void 0:s.length)||0))}),Y=R(!0),se=R(!1),F=R(!1),ne=R(null),ie=n=>{O.value&&ee.value&&(ee.value.contains(n.target)||(O.value=!1))},I=k(()=>{var n;return(n=g.value)!=null&&n.length?g.value.reduce((s,r,y)=>{var a,b,T,D,S,m;const c=r.dates.reduce((x,L)=>x+L.todos.filter(h=>!h.isPlaceholder).length,0),f={id:((a=r.user)==null?void 0:a.id)??((b=r.user)==null?void 0:b.user_id)??((T=r.user)==null?void 0:T.uid)??((D=r.user)==null?void 0:D.email)??`${((S=r.user)==null?void 0:S.name)||"unknown"}-${y}`,name:((m=r.user)==null?void 0:m.name)||"Unknown user"};return c>0?s.withTodos.push(f):s.withoutTodos.push(f),s},{withTodos:[],withoutTodos:[]}):{withTodos:[],withoutTodos:[]}}),pe=k(()=>{if(!F.value)return g.value;const n=new Set((I.value.withoutTodos||[]).map(s=>String(s.id??s.name??"")));return g.value.filter(s=>{var y,c,f,a,b;const r=((y=s.user)==null?void 0:y.id)??((c=s.user)==null?void 0:c.user_id)??((f=s.user)==null?void 0:f.uid)??((a=s.user)==null?void 0:a.email)??((b=s.user)==null?void 0:b.name)??"";return!n.has(String(r))})});function Pe(){F.value=!F.value,se.value=F.value}const ue=n=>{se.value&&ne.value&&(ne.value.contains(n.target)||(se.value=!1))},ze=n=>n==="COMPLETED"?"bg-green-100 text-green-700 border border-green-200":n==="WORKING"?"bg-blue-100 text-blue-700 border border-blue-200":n==="PENDING"?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-gray-100 text-gray-700 border border-gray-200";function Me(){G.replace({query:{...C.query,company_id:t.companyId||void 0,department_id:t.departmentId||void 0,employee_id:t.employeeId||void 0,line_type:t.lineType||void 0,start_date:t.startDate||void 0,end_date:t.endDate||void 0}})}async function ae(){!t.companyId||!t.startDate||!t.endDate||(await u.fetchTodoDates({"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate}),Ke())}function Ve(n){t.companyId=n.companyId||"",t.departmentId=n.departmentId||"",t.employeeId=n.employeeId||"",t.lineType=n.lineType||"all",t.startDate=n.startDate||"",t.endDate=n.endDate||""}function Fe(){window.print()}const X=k(()=>t.startDate===t.endDate);K(()=>t.companyId,n=>{n&&(z.fetchDepartments(n),A.fetchEmployee(n))},{immediate:!0}),K(()=>({...t}),(n,s)=>{JSON.stringify(n)!==JSON.stringify(s)&&(Me(),ae())},{deep:!0}),K(()=>C.query,n=>{t.companyId=(n==null?void 0:n.company_id)||t.companyId,t.departmentId=(n==null?void 0:n.department_id)||t.departmentId,t.employeeId=(n==null?void 0:n.employee_id)||t.employeeId,t.lineType=(n==null?void 0:n.line_type)||t.lineType,t.startDate=(n==null?void 0:n.start_date)||t.startDate,t.endDate=(n==null?void 0:n.end_date)||t.endDate}),oe(()=>{A.fetchCompanies({ignore_permission:!0}),ae()}),oe(()=>{document.addEventListener("click",ie,!0)}),Ae(()=>{document.removeEventListener("click",ie,!0)}),oe(()=>{document.addEventListener("click",ue,!0)}),Ae(()=>{document.removeEventListener("click",ue,!0)});const He=rt(),me=R([]),re=R(!1),We=k(()=>t.startDate===t.endDate),Ke=async()=>{if(!(!t.companyId||!t.startDate||!t.endDate)){re.value=!0;try{const n=await He.getDateRangeAttendanceSummary(t.startDate,t.endDate,t.companyId,t.lineType,t.employeeId,!0);n&&(me.value=n)}finally{re.value=!1}}};function Je(n,s){var y;const r=((y=me.value)==null?void 0:y.find(c=>String(c.employee_id)===String(n)))||null;return r?!s&&We.value?(r==null?void 0:r.attendance[t.startDate])||null:(r==null?void 0:r.attendance[s])||null:null}function Qe(n,s){const r=Je(n,s);return r?{hasData:!0,in:r.in||"-",out:r.out||"-",late:r.late||"-",early:r.early||"-",comment:r.comment||"-"}:{hasData:!1,in:"-",out:"-",late:"-",early:"-",comment:"-"}}function Ye(n,s,r,y){const c=r===n.dates.length-1,f=y===s.todos.length-1;return c&&f}function H(n,s,r,y){return Ye(n,s,r,y)?de:""}return(n,s)=>{var r,y,c,f;return o(),d("div",vt,[q(bt,{ref_key:"headingRef",ref:Q,"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate,loading:j(u).loading,class:"mb-4 print:px-0 print:py-0 print:mb-2 print:border-0 print:border-b print:border-gray-400 print:rounded-none print:w-full sticky top-[58px] z-50",onChange:Ve,onReloadClick:ae},{before:Z(()=>s[3]||(s[3]=[e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-800"},"Todo Report")],-1)])),after:Z(()=>[e("button",{type:"button",class:"btn-icon print-hide disabled:opacity-35 cursor-pointer disabled:cursor-not-allowed",onClick:J(Fe,["prevent"]),disabled:j(u).loading},s[4]||(s[4]=[e("i",{class:"fas fa-print"},null,-1)]),8,wt)]),_:1},8,["company-id","department-id","employee-id","line-type","start-date","end-date","loading"]),t.companyId&&t.startDate&&t.endDate?(o(),d("div",ht,[e("div",_t,[e("div",null,[s[5]||(s[5]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Company",-1)),e("div",Dt,p(E.value.company),1)]),e("div",null,[s[6]||(s[6]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Department",-1)),e("div",{class:w(["font-medium",[E.value.department=="All Departments"?"text-gray-400":"text-gray-800"]])},p(E.value.department),3)]),e("div",null,[s[7]||(s[7]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Line Type",-1)),e("div",{class:w(["font-medium",[E.value.lineType=="All Types"?"text-gray-400":"text-gray-800"]])},p(E.value.lineType),3)]),e("div",null,[s[8]||(s[8]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Employee",-1)),e("div",{class:w(["font-medium",[E.value.employee=="All Employees"?"text-gray-400":"text-gray-800"]])},p(E.value.employee),3)]),e("div",kt,[s[9]||(s[9]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Date",-1)),e("div",Tt,p(E.value.dateRange),1)]),e("div",{ref_key:"assignmentSummaryRef",ref:ee,class:"print-hide relative"},[e("button",{type:"button",class:"px-3 bg-white text-gray-700 hover:bg-gray-50 w-full text-bg text-right",onClick:s[0]||(s[0]=a=>O.value=!O.value)},[s[10]||(s[10]=e("div",{class:"uppercase"},"Todo given",-1)),e("div",It,[e("div",St,p(le.value)+" / "+p(te.value),1),e("i",{class:w(["fas",[O.value?"fa-chevron-up":"fa-chevron-down"]])},null,2)])]),O.value?(o(),d("div",Nt,[e("div",$t,[s[11]||(s[11]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Todo Status",-1)),e("div",Ct,p(le.value)+" given / "+p(te.value)+" selected ",1)]),e("div",Rt,[e("div",Et,[e("div",At,[e("div",Lt,[s[12]||(s[12]=e("span",null,"Not given todos",-1)),(r=I.value.withoutTodos)!=null&&r.length?(o(),d("span",Ot,p((y=I.value.withoutTodos)==null?void 0:y.length),1)):v("",!0)]),e("button",{type:"button",class:"text-[10px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:s[1]||(s[1]=a=>Y.value=!Y.value)},p(Y.value?"Hide":"Show"),1)]),Y.value?(o(),d("div",jt,[I.value.withoutTodos.length?v("",!0):(o(),d("span",Ut," Everyone has todos ")),(o(!0),d($,null,U(I.value.withoutTodos,a=>(o(),d("span",{key:`without-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-red-50 text-red-700 border border-red-100 text-xs max-w-full",title:a.name},[s[13]||(s[13]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",Pt,p(a.name),1)],8,Bt))),128))])):v("",!0)]),e("div",null,[e("div",zt,[s[14]||(s[14]=B(" Given todos ")),(c=I.value.withTodos)!=null&&c.length?(o(),d("span",Mt,p((f=I.value.withTodos)==null?void 0:f.length),1)):v("",!0)]),e("div",Vt,[I.value.withTodos.length?v("",!0):(o(),d("span",Ft," No todos assigned ")),(o(!0),d($,null,U(I.value.withTodos,a=>(o(),d("span",{key:`with-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-50 text-green-700 border border-green-100 text-xs max-w-full",title:a.name},[s[15]||(s[15]=e("i",{class:"fas fa-check-circle"},null,-1)),e("span",Wt,p(a.name),1)],8,Ht))),128))])])])])):v("",!0)],512)])])):v("",!0),!t.companyId||!t.startDate||!t.endDate?(o(),d("div",Kt,s[16]||(s[16]=[e("i",{class:"fad fa-tasks text-4xl"},null,-1),e("div",{class:"empty-state glass-panel"},[e("p",{class:"text-base font-semibold text-rose-500"}," Select company and date range to view the report. "),e("p",{class:"text-sm text-gray-500"},"Use the filter set above to load records.")],-1)]))):j(u).loading?(o(),Ge(tt,{key:2},{default:Z(()=>s[17]||(s[17]=[B("Loading report...")])),_:1,__:[17]})):(o(),d("div",Jt,[e("table",Qt,[e("thead",Yt,[e("tr",Xt,[s[19]||(s[19]=e("th",{class:"px-4 py-3 border w-[10px] bg-white bg-opacity-70 backdrop-blur-sm rounded-tl-md print:rounded-tl-none text-center"}," sl ",-1)),e("th",Zt,[e("div",qt,[s[18]||(s[18]=e("span",null,"Employee Name",-1)),t.employeeId?v("",!0):(o(),d("div",{key:0,class:"relative hidden md:block print:hidden",ref_key:"tableNoTodosRef",ref:ne},[e("button",{type:"button",class:"text-[11px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:s[2]||(s[2]=J(a=>Pe(),["stop"]))},[B(" No Todos ("+p(I.value.withoutTodos.length)+") ",1),e("span",Gt,p(F.value?"Hidden":"Showing"),1)])],512))])]),X.value?v("",!0):(o(),d("th",es," Date ")),s[20]||(s[20]=e("th",{class:"px-4 py-3 border bg-white text-center"},"Todo",-1)),s[21]||(s[21]=e("th",{class:"px-4 py-3 border print:border-r print:border-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center rounded-tr-md print:rounded-tr-none"}," Status ",-1))])]),e("tbody",ts,[pe.value.length===0?(o(),d("tr",ss,[e("td",{colspan:X.value?4:5,class:"px-4 py-6 text-center text-gray-500"},s[22]||(s[22]=[e("div",null,[e("i",{class:"fas fa-tasks fa-2x text-gray-300 mb-2"})],-1),e("div",null,"No todos.",-1)]),8,ns)])):v("",!0),(o(!0),d($,null,U(pe.value,(a,b)=>{var T,D,S;return o(),d($,{key:((T=a.user)==null?void 0:T.id)||(((S=(D=a.dates[0])==null?void 0:D.todos[0])==null?void 0:S.id)??Math.random())},[(o(!0),d($,null,U(a.dates,(m,x)=>{var L;return o(),d($,{key:`${((L=a.user)==null?void 0:L.id)||"u"}-${m.date}`},[(o(!0),d($,null,U(m.todos,(h,N)=>{var ve,we,he,_e,De,ke,Te,Ie,Se,Ne;return o(),d("tr",{key:h.id||`${((ve=a.user)==null?void 0:ve.id)||"u"}-${m.date||"empty"}-${N}`,class:"border odd:bg-white even:bg-gray-50 hover:bg-gray-100"},[x===0&&N===0?(o(),d("td",{key:0,rowspan:a.rowSpan||1,class:w(["px-4 py-3 align-top font-bold text-xl text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",de])},[e("div",rs,p(b+1),1)],8,as)):v("",!0),x===0&&N===0?(o(),d("td",{key:1,rowspan:a.rowSpan||1,class:w(["px-4 py-3 align-top font-medium text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",de])},[e("div",{user:a.user,class:"sticky top-[180px] bg-white"},[n.selfOnly?v("",!0):(o(),d("div",ls,[q(nt,{user:a.user},{trigger:Z(({user:_})=>[q(et,{user:_,size:"medium"},null,8,["user"])]),_:2},1032,["user"]),e("div",null,[e("div",is,[e("a",{href:j(at)(a.user),target:"_blank",rel:"noopener",class:"inline-flex hover:underline"},[e("div",null,[B(p(((we=a.user)==null?void 0:we.name)||"Unknown user")+" ",1),s[23]||(s[23]=e("i",{class:"far fa-external-link-alt print:hidden"},null,-1))])],8,ps)]),e("div",us,p(((_e=(he=a.user)==null?void 0:he.department)==null?void 0:_e.name)||"-"),1)])]))],8,ds)],8,os)):v("",!0),h.isPlaceholder?(o(),d($,{key:2},[N===0&&!X.value?(o(),d("td",{key:0,rowspan:m.rowSpan||1,class:w(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",H(a,m,x,N)])},[e("div",ys,p(j(W)(m.date)||m.date||"-"),1)],10,ms)):v("",!0),e("td",{class:w(["border-l border-t border-r bg-white px-3 py-3 text-center",H(a,m,x,N)]),colspan:"2"},[s[28]||(s[28]=e("div",{class:"flex items-center justify-center gap-2 text-red-600 text-sm font-medium opacity-70"},[e("i",{class:"far fa-clipboard-list text-red-400"}),e("span",null,"No todos was provided.")],-1)),re.value?(o(),d("div",cs," Loading attendanceâ€¦ ")):(o(!0),d($,{key:1},U([Qe((De=a==null?void 0:a.user)==null?void 0:De.id,m==null?void 0:m.date)],_=>(o(),d("div",{key:_.comment,class:"min-w-[180px] mt-3 text-[11px] text-red-600 text-left inline-block align-top"},[_.hasData?(o(),d("div",gs,[_.in==="-"&&_.out==="-"?(o(),d("div",{key:0,class:w(["text-center flex items-center justify-center rounded-md bg-slate-50 border text-xs border-dashed px-2 py-1.5 col-span-2",[{"text-red-500 border-red-300":_.comment==="Absent","text-blue-500 border-blue-300":_.comment!=="Absent"}]])},p(_.comment),3)):(o(),d($,{key:1},[e("div",xs,[e("div",fs,[s[24]||(s[24]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," In ",-1)),e("span",bs,p(_.in),1)]),e("div",vs,[s[25]||(s[25]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Late ",-1)),e("div",null,p(_.late),1)])]),e("div",ws,[e("div",hs,[s[26]||(s[26]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Out ",-1)),e("span",_s,p(_.out),1)]),e("div",Ds,[s[27]||(s[27]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Early ",-1)),e("div",null,p(_.out!=="-"?_.early:"-"),1)])])],64))])):(o(),d("div",ks," Attendance data unavailable. "))]))),128))],2)],64)):(o(),d($,{key:3},[N===0&&!X.value?(o(),d("td",{key:0,rowspan:m.rowSpan||1,class:w(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",H(a,m,x,N)])},[e("div",Is,p(j(W)(m.date)||m.date||"-"),1)],10,Ts)):v("",!0),e("td",{class:w(["px-4 py-3 text-gray-800 border-l border-t",H(a,m,x,N)])},[e("div",Ss,[e("span",Ns,p(N+1)+".",1),B(" "+p(h.title),1)]),e("div",$s,[(Te=(ke=h.todo)==null?void 0:ke.todo_project)!=null&&Te.title?(o(),d("span",Cs,[s[29]||(s[29]=e("i",{class:"fas fa-project-diagram mr-1"},null,-1)),B(" "+p(h.todo.todo_project.title),1)])):v("",!0),(Ie=h.todoable)!=null&&Ie.title||h.todoable_type?(o(),d("span",Rs,p(((Se=h.todoable)==null?void 0:Se.title)||((Ne=h.todoable_type)==null?void 0:Ne.split("\\").pop())||""),1)):v("",!0)])],2),e("td",{class:w(["px-4 py-3 border-l border-t border-r text-center",H(a,m,x,N)])},[e("div",{class:w(["inline-block text-xs font-semibold px-2.5 py-1 rounded-full whitespace-nowrap",ze(h.status)])},p(h.status==="WORKING"?"IN PROGRESS":h.status||"N/A"),3)],2)],64))])}),128))],64)}),128))],64)}),128))])])]))])}}};export{Ws as default};
