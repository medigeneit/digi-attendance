import{u as O,N as U,s as B,r as y,b as V,x as T,o as l,c as _,a as n,d as L,v as q,e as d,t as j,h as x,F as G,q as Z,p as K,k as Q,j as $,m as I,g as W,f as X,n as Y}from"./index-DelzKn00.js";import{u as P}from"./leave-application-DUd_MAGJ.js";import{u as M}from"./exchange-NsPwosuX.js";import{u as ee}from"./manual-attendance-CVL88YqI.js";import{u as ae}from"./short-leave-CtxobXY6.js";const te={key:0,class:"text-center space-y-2 print:hidden"},oe={key:0,class:"modal-bg"},ne={class:"modal-card"},re={class:"flex justify-end gap-2 mt-4"},le={key:1,class:"mt-2"},se={class:"flex justify-end gap-2 pt-2"},ie={__name:"ExchangeApplicationApprovalSection",props:{application:Object,notificationId:{type:String,required:!0}},setup(R){const h=O(),f=U(),b=M(),{user:m}=B(h),A=R,r=y(null);V(()=>{r.value=JSON.parse(JSON.stringify(A.application))});const i=y(!1),p=y(""),c=y(!1),o=y("");function u(){c.value=!0,i.value=!1}const g=[{key:"handover",approved_field:"handover_user_id",approved_by_field:null,label:"Handover",action:async a=>{await b.handoverAccept({id:a,note:o.value}),await v(),c.value=!1},condition:()=>{var a,t;return!((a=r.value)!=null&&a.status)&&((t=r.value)==null?void 0:t.handover_user_id)===m.value.id}},{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await b.inChargeAccept({id:a,note:o.value}),await v(),c.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await b.recommendByAccept({id:a,note:o.value}),await v(),c.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await b.approvedByAccept({id:a,note:o.value}),await v(),c.value=!1}}],e=T(()=>g.find(a=>{var t,s,w,k;return r.value?a.key==="handover"?a.condition():((t=r.value)==null?void 0:t.status)!=="Rejected"&&((s=r.value)==null?void 0:s.status)!=="Approved"&&!((w=r.value)!=null&&w[a.approved_field])&&((k=r.value)==null?void 0:k[a.approved_by_field])===m.value.id:!1})),C=()=>{i.value&&p.value?(S(),i.value=!1):i.value=!0};async function S(){try{await b.rejectExchange(r.value.id,p.value),alert("Exchange application rejected!"),p.value="",await v(r.value.id)}catch(a){alert(a.message||"Something went wrong!")}}async function v(){await f.markAsRead(A.notificationId)}return(a,t)=>e.value&&r.value?(l(),_("div",te,[c.value?(l(),_("div",oe,[n("div",ne,[t[4]||(t[4]=n("h3",{class:"title-lg"},"Accept Application",-1)),L(n("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value=s),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,o.value]]),n("div",re,[n("button",{class:"btn-3",onClick:t[1]||(t[1]=s=>c.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:t[2]||(t[2]=s=>e.value.action(r.value.id))}," Confirm ")])])])):d("",!0),i.value?(l(),_("div",le,[L(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>p.value=s),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter rejection note"},null,512),[[q,p.value]])])):d("",!0),n("div",se,[i.value?d("",!0):(l(),_("button",{key:0,class:"btn-2",onClick:u},"Approve")),n("button",{class:"btn-4 bg-red-500 text-white",onClick:C},"Reject")])])):d("",!0)}},ce={key:0,class:"text-center space-y-2 print:hidden"},de={key:0,class:"modal-bg"},ue={class:"modal-card"},pe={class:"flex justify-end gap-2 mt-4"},ve={key:1,class:"mt-2"},_e={class:"flex justify-end gap-2 pt-2"},fe={__name:"LeaveApplicationApprovalSection",props:{application:{type:Object,required:!0},notificationId:{type:String,required:!0}},setup(R){const h=O(),f=P(),b=U(),{user:m}=B(h),A=R,r=y(null);V(()=>{r.value=JSON.parse(JSON.stringify(A.application))});const i=y(!1),p=y(""),c=y(!1),o=y("");function u(){i.value=!0,c.value=!1}const g=[{key:"handover",approved_field:"handover_user_id",approved_by_field:null,label:"Handover",action:async a=>{confirm("Are you sure you want to approve?")&&(await f.acceptHandover({id:a,note:p.value}),await v(),i.value=!1)},condition:()=>{var a,t;return!((a=r.value)!=null&&a.status)&&((t=r.value)==null?void 0:t.handover_user_id)===m.value.id}},{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{confirm("Are you sure you want to approve?")&&(await f.acceptInCharge({id:a,note:p.value}),await v(),i.value=!1)}},{key:"coordinator",approved_field:"coordinator_user_id",approved_by_field:"approval_coordinator_user_id",label:"Coordinator",action:async a=>{confirm("Are you sure you want to approve?")&&(await f.acceptCoordinator({id:a,note:p.value}),await v(),i.value=!1)}},{key:"operational_admin",approved_field:"operational_admin_user_id",approved_by_field:"approval_operational_admin_user_id",label:"Operational Admin",action:async a=>{confirm("Are you sure you want to approve?")&&(await f.acceptOperationalAdmin({id:a,note:p.value}),await v(),i.value=!1)}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{confirm("Are you sure you want to approve?")&&(await f.acceptRecommendBy({id:a,note:p.value}),await v(),i.value=!1)}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{confirm("Are you sure you want to approve?")&&(await f.acceptApprovedBy({id:a,note:p.value}),await v(),i.value=!1)}}],e=T(()=>g.find(a=>{var w,k,N,E;if(!r.value)return!1;if(a.key==="handover")return a.condition();const t=!!((w=r.value)!=null&&w[a.approved_field]),s=((k=r.value)==null?void 0:k[a.approved_by_field])===m.value.id;return((N=r.value)==null?void 0:N.status)!=="Rejected"&&((E=r.value)==null?void 0:E.status)!=="Approved"&&!t&&s})),C=()=>{c.value&&o.value?(S(),c.value=!1):c.value=!0};async function S(){try{await f.rejectLeaveApplication(r.value.id,{rejection_reason:o.value}),alert("Application rejected!"),o.value="",await v()}catch(a){alert(a.message||"Something went wrong!")}}async function v(){await b.markAsRead(A.notificationId)}return(a,t)=>e.value&&r.value?(l(),_("div",ce,[i.value?(l(),_("div",de,[n("div",ue,[t[4]||(t[4]=n("h3",{class:"title-lg"},"Accept Application",-1)),L(n("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>p.value=s),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,p.value]]),n("div",pe,[n("button",{class:"btn-3",onClick:t[1]||(t[1]=s=>i.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:t[2]||(t[2]=s=>e.value.action(r.value.id))}," Confirm ")])])])):d("",!0),c.value?(l(),_("div",ve,[L(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value=s),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter rejection note"},null,512),[[q,o.value]])])):d("",!0),n("div",_e,[c.value?d("",!0):(l(),_("button",{key:0,class:"btn-2",onClick:u},"Approve")),n("button",{class:"btn-1",onClick:C},"Reject")])])):d("",!0)}},ye={key:0,class:"text-center space-y-2 print:hidden"},he={key:0,class:"modal-bg"},ge={class:"modal-card"},be={class:"flex justify-end gap-2 mt-4"},we={key:1,class:"mt-2"},ke={class:"flex justify-end gap-2 pt-2"},Ae={__name:"ManualAttendanceApprovalSection",props:{application:{type:Object,required:!0},notificationId:{type:String,required:!0}},setup(R){const h=O(),f=ee(),b=U(),{user:m}=B(h),A=R,r=y(null);V(()=>{r.value=JSON.parse(JSON.stringify(A.application))});const i=y(!1),p=y(""),c=y(!1),o=y("");function u(){c.value=!0,i.value=!1}const g=[{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await f.inChargeAccept({id:a,note:o.value}),await v(),c.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await f.recommendByAccept({id:a,note:o.value}),await v(),c.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await f.approvedByAccept({id:a,note:o.value}),await v(),c.value=!1}}],e=T(()=>g.find(a=>{var w,k,N,E;if(!r.value)return!1;if(a.key==="handover")return a.condition();const t=!!((w=r.value)!=null&&w[a.approved_field]),s=((k=r.value)==null?void 0:k[a.approved_by_field])===m.value.id;return((N=r.value)==null?void 0:N.status)!=="Rejected"&&((E=r.value)==null?void 0:E.status)!=="Approved"&&!t&&s})),C=()=>{i.value&&p.value?(S(),i.value=!1):i.value=!0};async function S(){try{await f.rejectLeaveApplication(r.value.id,{rejection_reason:p.value}),alert("Application rejected!"),p.value="",await v(r.value.id)}catch(a){alert(a.message||"Something went wrong!")}}async function v(a){await b.markAsRead(A.notificationId)}return(a,t)=>e.value&&r.value?(l(),_("div",ye,[c.value?(l(),_("div",he,[n("div",ge,[t[4]||(t[4]=n("h3",{class:"title-lg"},"Accept Application",-1)),L(n("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value=s),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,o.value]]),n("div",be,[n("button",{class:"btn-3",onClick:t[1]||(t[1]=s=>c.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:t[2]||(t[2]=s=>e.value.action(r.value.id))}," Confirm ")])])])):d("",!0),i.value?(l(),_("div",we,[L(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>p.value=s),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter rejection note"},null,512),[[q,p.value]])])):d("",!0),n("div",ke,[i.value?d("",!0):(l(),_("button",{key:0,class:"btn-2",onClick:u},"Approve")),n("button",{class:"btn-1",onClick:C},"Reject")])])):d("",!0)}},xe={key:0,class:"text-center space-y-2 print:hidden"},me={key:0,class:"modal-bg"},Se={class:"modal-card"},$e={class:"flex justify-end gap-2 mt-4"},je={key:1,class:"mt-2"},Re={class:"flex justify-end gap-2 pt-2"},Ce={__name:"ShortLeaveApplicationApprovalSection",props:{application:{type:Object,required:!0},notificationId:{type:String,required:!0}},setup(R){const h=O(),f=ae(),b=U(),{user:m}=B(h),A=R,r=y(null);V(()=>{r.value=JSON.parse(JSON.stringify(A.application))});const i=y(!1),p=y(""),c=y(!1),o=y("");function u(){c.value=!0,i.value=!1}const g=[{key:"handover",approved_field:"handover_user_id",approved_by_field:null,label:"Handover",action:async a=>{await f.handoverAccept({id:a,note:o.value}),await v(),c.value=!1},condition:()=>{var a,t;return!((a=r.value)!=null&&a.status)&&((t=r.value)==null?void 0:t.handover_user_id)===m.value.id}},{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await f.inChargeAccept({id:a,note:o.value}),await v(),c.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await f.recommendByAccept({id:a,note:o.value}),await v(),c.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await f.approvedByAccept({id:a,note:o.value}),await v(),c.value=!1}}],e=T(()=>g.find(a=>{var t,s,w,k;return r.value?a.key==="handover"?a.condition():((t=r.value)==null?void 0:t.status)!=="Rejected"&&((s=r.value)==null?void 0:s.status)!=="Approved"&&!((w=r.value)!=null&&w[a.approved_field])&&((k=r.value)==null?void 0:k[a.approved_by_field])===m.value.id:!1})),C=()=>{i.value&&p.value?(S(),i.value=!1):i.value=!0};async function S(){try{await f.rejectShortLeave(r.value.id,p.value),alert("Application rejected!"),p.value="",await v(r.value.id)}catch(a){alert(a.message||"Something went wrong!")}}async function v(){await b.markAsRead(A.notificationId)}return(a,t)=>e.value&&r.value?(l(),_("div",xe,[c.value?(l(),_("div",me,[n("div",Se,[t[4]||(t[4]=n("h3",{class:"title-lg"},"Accept Application Note",-1)),L(n("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value=s),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,o.value]]),n("div",$e,[n("button",{class:"btn-3",onClick:t[1]||(t[1]=s=>c.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:t[2]||(t[2]=s=>e.value.action(r.value.id))}," Confirm ")])])])):d("",!0),i.value?(l(),_("div",je,[L(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>p.value=s),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter rejection note"},null,512),[[q,p.value]])])):d("",!0),n("div",Re,[i.value?d("",!0):(l(),_("button",{key:0,class:"btn-2",onClick:u},"Approve")),n("button",{class:"btn-1",onClick:C},j(i.value?"Submit":"Reject"),1)])])):d("",!0)}},Ne={class:"space-y-6 px-4 py-4"},Ee={class:"text-2xl font-semibold capitalize text-gray-700"},Le={key:0,class:"space-y-4"},qe={class:"flex items-start gap-4"},Ie={class:"text-2xl text-blue-500"},Be={class:"flex-1"},Oe={class:"flex items-center gap-8"},Ue={class:"text-gray-800 font-medium"},Ve={key:0,class:"flex gap-2 text-sm btn-4"},Te={key:0,class:"text-gray-800 font-medium"},Je={class:"text-red-600 text-sm font-semibold"},De={key:1,class:"text-xs text-gray-400"},He={key:0,class:"grid gap-1"},ze={class:"flex items-center gap-4"},Fe=["href"],Pe={class:"grow-0 w-full"},Ge={key:0,class:"text-xs font-semibold"},Ze={class:"text-xs text-gray-400"},Ke={key:1,class:"text-center text-red-500 py-10 text-xl italic"},ea={__name:"NotificationList",setup(R){W();const h=X(),f=U(),{notifications:b}=B(f);P();const m=O();B(m),y(!1),y({}),y({}),V(()=>{f.fetchNotifications()});const A=(o,u)=>{if(!o)return"application not found";switch(u){case"leaveApplication":return`Last Office ( ${o.last_working_date} ) → Join Date ( ${o.resumption_date} )`;case"shortLeave":return`Short Leave on ${o.date} form ${c(o.start_time)??"N/A"} to ${o.end_time?c(o.end_time):"N/A"}`;case"shift":return o.exchange_type==="shift"?`Exchange (${o.exchange_type}) on ${o.current_date} (${(o==null?void 0:o.shift_name)??"No Shift"})`:`Exchange (${o.exchange_type})`;case"exchange":return`Exchange (${o.exchange_type}) on ${o.current_date} (${(o==null?void 0:o.shift_name)??"No Shift"})`;case"offday":return o.exchange_type==="offday"?`Exchange (Offday): ${o.exchange_date} → ${o.current_date}`:`Exchange (${o.exchange_type})`;case"manualAttendance":const g=o.check_in?p(o.check_in):"N/A",e=o.check_out?p(o.check_out):"N/A";return`Checked in (${g}) → Checked out (${e})`;default:return"Unknown Event"}},r=o=>{switch(o){case"leaveApplication":return"fas fa-calendar-alt";case"shortLeave":return"fas fa-clock";case"manualAttendance":return"fas fa-clock";case"exchange":return"fas fa-random";case"offday":return"fas fa-random";default:return"fas fa-bell"}},i=o=>new Date(o).toLocaleString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function p(o){const u={year:"numeric",month:"short",day:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0};return new Date(o).toLocaleString("en-US",u)}const c=o=>{const[u,g]=o.split(":").map(Number),e=new Date;return e.setHours(u,g),e.toLocaleString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};return(o,u)=>{const g=Y("RouterLink");return l(),_("div",Ne,[n("h2",Ee,j(x(h).query.type.replace(/([A-Z])/g," $1")),1),Array.isArray(x(b)[x(h).query.type])&&x(b)[x(h).query.type].length?(l(),_("div",Le,[(l(!0),_(G,null,Z(x(b)[x(h).query.type],(e,C)=>{var S,v,a,t,s,w,k,N,E,J,D,H,z,F;return l(),_("div",{key:e.id,class:"bg-white p-4 rounded-xl shadow border"},[n("div",qe,[n("div",Ie,[n("i",{class:K(r(e.event_type))},null,2)]),n("div",Be,[n("div",Oe,[n("p",Ue,j((S=e.event_model)==null?void 0:S.user_name),1),e!=null&&e.monthly_short_leave_count?(l(),_("p",Ve,[n("strong",null,"Pending: "+j((e==null?void 0:e.monthly_short_leave_count.Pending)||0),1),u[0]||(u[0]=Q("/ ")),n("strong",null,"Approved: "+j((e==null?void 0:e.monthly_short_leave_count.Approved)||0),1)])):d("",!0)]),(v=e.event_model)!=null&&v.reason?(l(),_("p",Te," Reason: "+j((a=e.event_model)==null?void 0:a.reason),1)):d("",!0),n("p",Je,j(A(e.event_model,e.event_type)),1),(t=e==null?void 0:e.event_model)!=null&&t.total_leave_days_without_week?(l(),_("p",De," Total Leave: "+j(e==null?void 0:e.event_model.total_leave_days_without_week)+" days ",1)):d("",!0)]),e!=null&&e.event_model?(l(),_("div",He,[n("div",ze,[e!=null&&e.event_model.attachment?(l(),_("a",{key:0,href:(s=e==null?void 0:e.event_model)==null?void 0:s.attachment,target:"_blank",class:"btn-1"},u[1]||(u[1]=[n("i",{class:"fad fa-link"},null,-1)]),8,Fe)):d("",!0),x(h).query.type==="leaveApplication"?(l(),$(g,{key:1,to:{name:"LeaveApplicationShow",params:{id:(w=e==null?void 0:e.event_model)==null?void 0:w.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[2]||(u[2]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),x(h).query.type==="shortLeave"?(l(),$(g,{key:2,to:{name:"ShortLeaveShow",params:{id:(k=e==null?void 0:e.event_model)==null?void 0:k.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[3]||(u[3]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),x(h).query.type==="exchange"?(l(),$(g,{key:3,to:{name:((N=e==null?void 0:e.event_model)==null?void 0:N.exchange_type)=="offday"?"ExchangeOffdayShow":"ExchangeShiftShow",params:{id:(E=e==null?void 0:e.event_model)==null?void 0:E.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[4]||(u[4]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),x(h).query.type==="offday"?(l(),$(g,{key:4,to:{name:"ExchangeOffdayShow",params:{id:(J=e==null?void 0:e.event_model)==null?void 0:J.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[5]||(u[5]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),x(h).query.type==="shift"?(l(),$(g,{key:5,to:{name:"ExchangeShiftShow",params:{id:(D=e==null?void 0:e.event_model)==null?void 0:D.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[6]||(u[6]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),x(h).query.type==="manualAttendance"?(l(),$(g,{key:6,to:{name:"ManualAttendanceShow",params:{id:(H=e==null?void 0:e.event_model)==null?void 0:H.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[7]||(u[7]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0)]),n("div",Pe,[(z=e==null?void 0:e.event_model)!=null&&z.type?(l(),_("p",Ge," Type : "+j((F=e==null?void 0:e.event_model)==null?void 0:F.type),1)):d("",!0),n("p",Ze,j(i(e.created_at)),1)])])):d("",!0)]),e!=null&&e.event_model&&e.event_type==="leaveApplication"?(l(),$(fe,{key:0,application:e.event_model,"notification-id":e.id},null,8,["application","notification-id"])):d("",!0),e!=null&&e.event_model&&e.event_type==="manualAttendance"?(l(),$(Ae,{key:1,application:e.event_model,"notification-id":e.id},null,8,["application","notification-id"])):d("",!0),e!=null&&e.event_model&&e.event_type==="shortLeave"?(l(),$(Ce,{key:2,application:e.event_model,"notification-id":e.id},null,8,["application","notification-id"])):d("",!0),e!=null&&e.event_model&&(e.event_type==="offday"||e.event_type==="shift"||e.event_type==="exchange")?(l(),$(ie,{key:3,application:e.event_model,notificationId:e.id},null,8,["application","notificationId"])):d("",!0)])}),128))])):(l(),_("div",Ke,"notifications not found."))])}}};export{ea as default};
