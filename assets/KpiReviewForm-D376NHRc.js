import{f as bt,g as ft,r as f,x as d,q as qe,c as n,o as r,a as e,j as y,t as a,m as K,b as $,F as g,e as k,k as O,v as z,s as yt,O as ye,n as ht}from"./index-B9ASKgxZ.js";import{u as gt}from"./kpi-C1w6L1Bm.js";const kt={class:"max-w-7xl mx-auto px-4 py-6 space-y-6"},wt={class:"border rounded-2xl bg-white/80 backdrop-blur px-4 py-3 shadow-sm"},Nt={class:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between"},Ct={class:"space-y-1"},Ft={class:"inline-flex items-center gap-2 rounded-full bg-indigo-50 px-3 py-1"},St={class:"text-xs text-indigo-900"},At={class:"text-sm text-slate-600"},Lt={class:"font-medium text-slate-800"},Mt={class:"flex flex-wrap gap-2 text-xs mt-0.5"},Rt={key:0,class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},jt={class:"ml-1 font-medium text-slate-800"},Ht={key:1,class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},$t={class:"ml-1 font-medium text-slate-800"},Gt={class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},Et={key:0,class:"ml-1 inline-flex items-center gap-1"},Tt={key:1,class:"ml-1 font-semibold text-slate-800"},Pt={class:"flex items-end gap-4"},Vt={class:"text-right"},Dt={class:"text-lg font-bold text-slate-900"},Ut={class:"text-slate-400"},Kt={class:"text-xs text-slate-500"},Ot={key:0,class:"border rounded-2xl bg-white shadow-sm overflow-hidden"},zt={class:"overflow-auto"},Bt={class:"min-w-[980px] w-full text-sm"},It={class:"bg-slate-50 sticky top-0 z-10"},Yt={class:"text-slate-700"},qt={class:"font-medium"},Qt={class:"text-[11px] text-slate-500 flex flex-col items-center"},Wt={key:0,class:"mt-0.5 inline-flex items-center rounded-full bg-blue-50 px-2 py-0.5 text-[10px] font-medium text-blue-700 border border-blue-200"},Jt={class:"bg-slate-100/80 border-t"},Xt=["colspan"],Zt={class:"px-3 py-2 text-center text-slate-500"},es={class:"px-3 py-2 align-top"},ts={class:"font-medium text-slate-800"},ss={class:"mt-1 flex gap-1 text-[11px] text-slate-500"},ls=["disabled","onClick"],as=["disabled","onClick"],os=["disabled","onClick"],ns={class:"px-3 py-2 text-center text-slate-700"},rs={key:0,class:"flex items-center justify-center"},is=["max","onUpdate:modelValue","onChange"],ds={key:1,class:"text-slate-700 text-sm"},us={key:2,class:"text-slate-300 text-sm"},cs={class:"bg-slate-50 border-t"},xs={class:"px-3 py-2 text-center font-semibold text-slate-800"},ms=["colspan"],ps={class:"font-semibold text-slate-900"},vs={class:"text-slate-500"},_s={key:1,class:"mt-2"},bs={class:"grid gap-4 lg:grid-cols-5"},fs={class:"space-y-4 lg:col-span-3"},ys={class:"flex items-center justify-between border-b bg-slate-50 px-4 py-2.5"},hs={class:"text-sm font-semibold text-slate-800"},gs={class:"flex items-center gap-2 text-[11px] text-slate-500"},ks=["onClick","disabled"],ws=["onClick","disabled"],Ns=["onClick","disabled"],Cs={class:"overflow-auto"},Fs={class:"w-full text-sm"},Ss={class:"px-3 py-2 text-center text-slate-500"},As={class:"px-3 py-2"},Ls={class:"font-medium text-slate-800"},Ms={class:"px-3 py-2 text-center text-slate-700"},Rs={class:"px-3 py-2 text-center"},js=["max","onUpdate:modelValue","onChange"],Hs={key:1,class:"text-slate-700 text-sm"},$s={class:"bg-slate-50 border-t"},Gs={class:"px-3 py-2 text-center font-semibold text-slate-800"},Es={class:"px-3 py-2 text-center text-sm"},Ts={class:"lg:col-span-2 space-y-4"},Ps={key:0,class:"border rounded-2xl bg-white shadow-sm"},Vs={class:"flex flex-wrap items-center justify-between border-b px-4 py-3 text-sm font-semibold text-slate-800"},Ds={class:"flex flex-wrap items-center gap-2 text-[11px] text-slate-500"},Us={class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},Ks={key:0,class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},Os={class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},zs={class:"p-4 space-y-4 max-h-[360px] overflow-y-auto"},Bs={class:"flex flex-wrap gap-2 border-b border-slate-100 pb-3"},Is=["onClick"],Ys={class:"space-y-4"},qs={class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},Qs={class:"rounded-xl border bg-slate-50 p-3"},Ws={class:"flex items-center justify-between"},Js={class:"text-[11px] px-1.5 py-0.5 rounded bg-blue-50 text-blue-700 border border-blue-200"},Xs={class:"mt-1 text-sm font-semibold text-slate-900"},Zs={class:"text-xs text-slate-500"},el={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},tl={class:"rounded-xl border bg-slate-50 p-3"},sl={class:"flex items-center justify-between"},ll={class:"text-[11px] px-1.5 py-0.5 rounded bg-violet-50 text-violet-700 border border-violet-200"},al={class:"mt-1 text-sm font-semibold text-slate-900"},ol={class:"text-xs text-slate-500"},nl={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},rl={class:"rounded-xl border bg-slate-50 p-3 sm:col-span-2"},il={class:"flex items-center justify-between"},dl={class:"text-[11px] px-1.5 py-0.5 rounded bg-emerald-50 text-emerald-700 border border-emerald-200"},ul={class:"mt-1 text-sm font-semibold text-slate-900"},cl={class:"text-xs text-slate-500"},xl={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},ml={class:"border-t pt-2 text-xs"},pl={key:0,class:"mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3 text-xs space-y-2"},vl={class:"grid grid-cols-2 gap-2"},_l={class:"font-medium text-slate-800"},bl={class:"font-medium text-slate-800"},fl={class:"font-medium text-slate-800"},yl={class:"font-medium text-slate-800"},hl={class:"font-medium text-slate-800"},gl={class:"font-medium text-slate-800"},kl={class:"font-medium text-slate-800"},wl={class:"font-medium text-slate-800"},Nl={class:"font-medium text-slate-800"},Cl={key:1,class:"border rounded-2xl bg-white shadow-sm"},Fl={class:"flex items-center justify-between border-b px-4 py-3 text-sm font-semibold text-slate-800"},Sl={class:"text-[11px] text-slate-500"},Al={class:"p-4 space-y-3"},Ll={class:"max-h-96 overflow-auto border rounded-xl"},Ml={class:"min-w-full text-xs text-left"},Rl={class:"px-2 py-2"},jl={class:"font-semibold text-slate-700"},Hl={key:0,class:"mt-0.5 text-[11px] text-slate-400"},$l={class:"px-2 py-2"},Gl={key:0,class:"flex flex-wrap gap-1"},El={key:1,class:"text-slate-400"},Tl={class:"px-2 py-2"},Pl={key:0,class:"flex flex-wrap gap-1"},Vl={key:1,class:"text-slate-400"},Dl={class:"px-2 py-2"},Ul={key:0,class:"flex flex-wrap gap-1"},Kl={key:1,class:"text-slate-400"},Ol={key:2,class:"rounded-2xl bg-white border shadow-sm px-4 py-4 space-y-4"},zl={class:"grid gap-4 md:grid-cols-3"},Bl={class:"space-y-3"},Il={class:"flex items-center justify-between text-xs font-semibold text-slate-600"},Yl={key:0,class:"text-[11px] text-emerald-600"},ql={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 max-h-32 overflow-y-auto"},Ql={class:"flex flex-wrap gap-1.5"},Wl=["onClick","disabled"],Jl={key:1,class:"text-[11px] text-slate-400"},Xl={class:"space-y-1"},Zl={class:"space-y-3"},ea={class:"flex items-center justify-between text-xs font-semibold text-slate-600"},ta={key:0,class:"text-[11px] text-amber-600"},sa={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 max-h-32 overflow-y-auto"},la={class:"flex flex-wrap gap-1.5"},aa=["onClick","disabled"],oa={key:1,class:"text-[11px] text-slate-400"},na={class:"space-y-1"},ra={class:"space-y-3"},ia={class:"flex items-center justify-between text-xs font-semibold text-slate-600"},da={key:0,class:"text-[11px] text-sky-600"},ua={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 max-h-32 overflow-y-auto"},ca={class:"flex flex-wrap gap-1.5"},xa=["onClick","disabled"],ma={class:"space-y-1"},pa={class:"mt-2 flex flex-col gap-3 border-t pt-3 md:flex-row md:items-center md:justify-between"},va={class:"text-sm text-slate-600"},_a={class:"text-slate-900"},ba={class:"text-slate-400"},fa=["disabled"],ka={__name:"KpiReviewForm",setup(ya){const oe=bt(),w=gt(),ne=ft(),_=f({}),G=f({}),B=f(""),I=f(""),Y=f(""),E=f(null),q=f(null),V=f(!1),he=f([]),Q=f({}),S=f(null),re=f(!1),ie=d(()=>{var s;return((s=w.cycle)==null?void 0:s.groups_json)||[]}),ge=s=>(s==null?void 0:s.id)==="personal"||/personal/i.test((s==null?void 0:s.label)||""),L=d(()=>ie.value.find(ge)||null),W=d(()=>ie.value.filter(s=>!ge(s))),Qe=(s,t)=>(s==null?void 0:s.label)||`Group ${t+1}`,We=s=>/^hr\d*$/i.test(s)||s==="hr",ke=s=>We((s==null?void 0:s.key)||"")||(s==null?void 0:s.is_hr_lane)===!0,we=d(()=>[...he.value||[]].sort((s,t)=>(s.rank??999)-(t.rank??999))),de=d(()=>we.value.filter(ke)),M=d(()=>we.value.filter(s=>!ke(s))),Je=d(()=>M.value.find(s=>s.key===S.value)||null),Xe=d(()=>{var s;return((s=Je.value)==null?void 0:s.rank)??null}),Ze=d(()=>{var s;return Number(((s=ne==null?void 0:ne.user)==null?void 0:s.id)||0)}),ue=d(()=>{const s=Ze.value;if(!s)return null;const t=de.value.find(o=>Number(o.assigned_user_id)===s);return t||de.value.find(o=>o.can_current_user_review)||null}),A=d(()=>{var s;return((s=ue.value)==null?void 0:s.key)||null}),et=d(()=>!!(ue.value&&ue.value.can_current_user_review)),C=d(()=>!!(re.value||et.value)),R=d(()=>!!S.value&&M.value.some(s=>s.key===S.value&&s.can_current_user_review)),J=d(()=>C.value&&A.value?A.value:S.value),Ne=d(()=>!!(J.value&&A.value&&J.value===A.value));function ce(s){var o;return(((o=Q.value)==null?void 0:o[s])||[])[0]||null}function Ce(s,t){var i;const o=ce(s);return((i=o==null?void 0:o.marks)==null?void 0:i[t])??""}function Fe(s){var o,i,m,u;if(A.value){const b=ce(A.value),h=(o=b==null?void 0:b.marks)==null?void 0:o[s];if(h!=null)return h}let t=null;for(const b of de.value){const p=(((i=Q.value)==null?void 0:i[b.key])||[])[0];if(!(!p||((m=p==null?void 0:p.marks)==null?void 0:m[s])==null)){if(!t){t=p;continue}p.submitted_at&&t.submitted_at&&p.submitted_at>t.submitted_at&&(t=p)}}return((u=t==null?void 0:t.marks)==null?void 0:u[s])??""}function xe(s,t){const o=Number(_.value[s]??0);o<0&&(_.value[s]=0),o>Number(t)&&(_.value[s]=Number(t))}function X(s,t,o){o==="zero"?_.value[s]=0:o==="half"?_.value[s]=Number(t)/2:o==="threeQuarter"?_.value[s]=Number((Number(t)*.75).toFixed(1)):o==="full"&&(_.value[s]=Number(t)),xe(s,t)}function me(s,t){s.items.forEach(o=>X(o.id,o.max,t))}const D=d(()=>{let s=0,t=0;const o=L.value;o&&o.items.forEach(m=>{s+=Number(m.max||0);const u=Number(_.value[m.id]||0);t+=Math.min(Math.max(u,0),Number(m.max||0))});const i=s>0?t/s*100:0;return{max:Number(s.toFixed(2)),got:Number(t.toFixed(2)),percent:Number(i.toFixed(2))}}),tt=d(()=>!!E.value&&typeof E.value=="object"),st=d(()=>{var s;return((s=E.value)==null?void 0:s.avg)||{per_scored_month:{},per_form_yearly:{},percent_simple:0,percent_weighted:0}}),lt=d(()=>{var s;return((s=E.value)==null?void 0:s.year)??null}),at=d(()=>{var s;return((s=q.value)==null?void 0:s.avg)||{per_scored_month:{},per_form_yearly:{},percent_simple:0,percent_weighted:0}}),ot=d(()=>{var s;return((s=q.value)==null?void 0:s.year)??null}),j=f("target"),pe=[{key:"target",label:"Annual Target"},{key:"performance",label:"Annual Performance"}],Se=d(()=>{var s;return((s=E.value)==null?void 0:s.months_total_form)??0}),nt=d(()=>{var s;return((s=q.value)==null?void 0:s.months_total_form)??Se.value}),v=d(()=>j.value==="target"?st.value:at.value),ve=d(()=>j.value==="target"?lt.value:ot.value),Ae=d(()=>j.value==="target"?Se.value:nt.value),_e=d(()=>{var s;return((s=pe.find(t=>t.key===j.value))==null?void 0:s.label)||"Annual Target"}),rt={target:"target",performance:"regular_activities_of_the_department"},it=d(()=>{const s=rt[j.value];return s&&W.value.find(t=>t.id===s)||null}),dt=d(()=>{var s;return((s=it.value)==null?void 0:s.label)||_e.value}),ut=s=>{pe.some(t=>t.key===s)&&(j.value=s)};qe(j,()=>{V.value=!1});const Z=d(()=>{const s=Q.value||{},t=M.value||[],o=[],i=Ne.value||C.value?1/0:Xe.value??null,m=u=>{if(!u)return[];const b=[];if(Array.isArray(u))b.push(...u);else if(typeof u=="string"&&u.trim())b.push(u.trim());else return[];const h=new Set;return b.reduce((p,H)=>{const F=typeof H=="string"?H.trim():"";return!F||h.has(F)||(h.add(F),p.push(F)),p},[])};return t.forEach(u=>{const b=u.key;if(!b||i!=null&&(u.rank??999)>i)return;const h=s[b]||[];if(!Array.isArray(h)||!h.length)return;const p=h[0],H=m(p.strengths),F=m(p.gaps),U=m(p.suggestions);!H.length&&!F.length&&!U.length||o.push({key:b,lane:b,label:u.label||(p==null?void 0:p.lane_label)||b,reviewer_id:p.reviewer_id,reviewer_name:p.reviewer_name,strengths:H,gaps:F,suggestions:U,submitted_at:p.submitted_at??null})}),o}),ct=s=>{const t=new Set;return Z.value.forEach(o=>{(Array.isArray(o[s])?o[s]:[]).forEach(m=>{const u=typeof m=="string"?m.trim():"";u&&t.add(u)})}),Array.from(t)},Le=s=>{if(!Array.isArray(s))return[];const t=new Set;return s.forEach(o=>{const i=typeof o=="string"?o.trim():"";i&&t.add(i)}),Array.from(t)},ee=d(()=>Le(w.strengths)),te=d(()=>Le(w.gaps)),se=d(()=>ct("suggestions"));f([]),f([]),f([]);const Me={strengths:B,gaps:I,suggestions:Y};function xt(s,t){const o=(t||"").trim();return o?s!=null&&s.trim()?`${s.trim()}
${o}`:o:s}const mt=d(()=>{const s={};let t=1;const o=L.value;return o&&o.items.forEach(i=>{s[i.id]=t++}),s}),pt=d(()=>Number(oe.params.employeeId)),vt=s=>{var t,o;if(G.value=s.employee,E.value=(s==null?void 0:s.annual_target_avg_marks)||null,q.value=(s==null?void 0:s.annual_performance_avg_marks)||null,he.value=s.lanes||[],Q.value=s.reviews_by_lane||{},re.value=!!(((t=s==null?void 0:s.meta)==null?void 0:t.is_hr)??(s==null?void 0:s.hr)??!1),S.value=((o=M.value.find(i=>i.can_current_user_review))==null?void 0:o.key)||null,ie.value.forEach(i=>i.items.forEach(m=>{_.value[m.id]==null&&(_.value[m.id]=0)})),S.value){const i=ce(S.value);i!=null&&i.marks&&Object.assign(_.value,i.marks)}C.value&&W.value.forEach(i=>{i.items.forEach(m=>{let u=A.value?Ce(A.value,m.id):"";(u===""||u==null)&&(u=Fe(m.id)),u!==""&&u!=null&&(_.value[m.id]=Number(u))})})};qe(pt,async(s,t)=>{if(!s||t&&s===t)return;await w.fetchActiveCycle(s);const o=await w.fetchLanes(w.cycle.id,s);vt(o)},{immediate:!0});async function _t(){const s=J.value;if(!s){alert("Unable to determine reviewer lane.");return}A.value,await w.submitReview({cycle_id:w.cycle.id,employee_id:Number(oe.params.employeeId),reviewer_lane:s,marks:_.value,strengths:B.value,gaps:I.value,suggestions:Y.value}),alert("Submitted")}function N(s){const t=Number(s??0);return isNaN(t)?"0.00":t.toFixed(2)}function T(s,t){const o=Number(s??0),i=Number(t??0);return i>0?Math.round(o/i*100):0}function le(s,t){const o=Me[s];if(!o)return!1;const i=(o.value||"").split(`
`).map(u=>u.trim()).filter(Boolean),m=(t||"").trim();return m?i.includes(m):!1}function be(s,t){const o=Me[s];if(!o)return;const i=typeof t=="string"?t.trim():"";i&&(le(s,i)||(o.value=xt(o.value,i)))}return(s,t)=>{var o,i,m,u,b,h,p,H,F,U,fe,Re,je,He,$e,Ge,Ee,Te,Pe,Ve,De,Ue,Ke,Oe,ze,Be,Ie,Ye;return r(),n("div",kt,[e("header",wt,[e("div",Nt,[e("div",Ct,[e("div",Ft,[t[5]||(t[5]=e("span",{class:"text-xs font-semibold text-indigo-700"},"KPI Cycle",-1)),e("span",St,a((o=K(w).cycle)==null?void 0:o.title),1)]),e("div",At,[e("div",Lt,a(((i=G.value)==null?void 0:i.name)||"Employee"),1),e("div",Mt,[(u=(m=G.value)==null?void 0:m.designation)!=null&&u.title?(r(),n("span",Rt,[t[6]||(t[6]=$(" Designation: ")),e("span",jt,a(G.value.designation.title),1)])):y("",!0),(h=(b=G.value)==null?void 0:b.department)!=null&&h.name?(r(),n("span",Ht,[t[7]||(t[7]=$(" Department: ")),e("span",$t,a(G.value.department.name),1)])):y("",!0),e("span",Gt,[t[9]||(t[9]=$(" Reviewing as: ")),Ne.value?(r(),n("span",Et,t[8]||(t[8]=[e("span",{class:"font-semibold text-emerald-700"},"HR",-1),e("span",{class:"text-[10px] rounded bg-emerald-50 border border-emerald-200 px-1.5 py-0.5 text-emerald-700"}," HR mode ",-1)]))):(r(),n("span",Tt,a(J.value||"No lane"),1))])])])]),e("div",Pt,[e("div",Vt,[t[10]||(t[10]=e("div",{class:"text-[11px] uppercase tracking-wide text-slate-500"}," Personal group total ",-1)),e("div",Dt,[$(a(D.value.got.toFixed(2))+" ",1),e("span",Ut,"/ "+a(D.value.max.toFixed(2)),1)]),e("div",Kt,a(D.value.percent.toFixed(2))+"% achieved ",1)]),re.value?(r(),n("button",{key:0,onClick:t[0]||(t[0]=l=>K(w).submitFinalResult(K(w).cycle.id,K(oe).params.employeeId)),class:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-4 py-2.5 text-sm font-medium text-white shadow hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-300 focus:outline-none"},t[11]||(t[11]=[e("span",null,"Finalize & Lock",-1)]))):y("",!0)])])]),K(w).cycle&&L.value?(r(),n("section",Ot,[t[17]||(t[17]=e("div",{class:"flex items-center justify-between border-b bg-slate-50 px-4 py-2"},[e("div",{class:"text-sm font-semibold text-slate-800"}," Personal Evaluation "),e("div",{class:"text-xs text-slate-500"}," Fill only your lane; others appear as read-only. ")],-1)),e("div",zt,[e("table",Bt,[e("thead",It,[e("tr",Yt,[t[12]||(t[12]=e("th",{class:"px-3 py-2 w-[40px] text-center font-medium"},"#",-1)),t[13]||(t[13]=e("th",{class:"text-left px-3 py-2 w-[20%] font-medium"},"মূল্যায়নের বিষয় (Personal)",-1)),t[14]||(t[14]=e("th",{class:"px-3 py-2 text-center font-medium"},"Max",-1)),(r(!0),n(g,null,k(M.value,l=>(r(),n("th",{key:l.key,class:"px-3 py-2 text-center font-medium"},[e("div",qt,a(l.label||l.key),1),e("div",Qt,[e("span",null,a(l.assigned_user_name||"-"),1),l.key===S.value&&l.can_current_user_review?(r(),n("span",Wt," You can edit ")):y("",!0)])]))),128))])]),e("tbody",null,[e("tr",Jt,[e("td",{colspan:3+M.value.length,class:"px-3 py-2 font-medium text-slate-800"},a(L.value.label||"Personal"),9,Xt)]),(r(!0),n(g,null,k(L.value.items,l=>(r(),n("tr",{key:l.id,class:"border-t hover:bg-slate-50/60"},[e("td",Zt,a(mt.value[l.id]),1),e("td",es,[e("div",ts,a(l.label),1),e("div",ss,[e("button",{class:"border rounded px-1.5 py-0.5 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!R.value,onClick:c=>R.value&&X(l.id,l.max,"half")}," ½ ",8,ls),e("button",{class:"border rounded px-1.5 py-0.5 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!R.value,onClick:c=>R.value&&X(l.id,l.max,"threeQuarter")}," ¾ ",8,as),e("button",{class:"border rounded px-1.5 py-0.5 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!R.value,onClick:c=>R.value&&X(l.id,l.max,"full")}," Full ",8,os)])]),e("td",ns,a(l.max),1),(r(!0),n(g,null,k(M.value,c=>(r(),n("td",{key:c.key,class:"px-3 py-2 text-center"},[c.key===S.value&&c.can_current_user_review?(r(),n("div",rs,[O(e("input",{type:"number",step:"0.1",min:"0",max:l.max,"onUpdate:modelValue":x=>_.value[l.id]=x,onChange:x=>xe(l.id,l.max),inputmode:"decimal",class:"w-24 text-right rounded-lg border px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"},null,40,is),[[z,_.value[l.id],void 0,{number:!0}]])])):c.can_view_marks?(r(),n("div",ds,a(Ce(c.key,l.id)),1)):(r(),n("div",us," — "))]))),128))]))),128)),e("tr",cs,[t[15]||(t[15]=e("td",null,null,-1)),t[16]||(t[16]=e("td",{class:"px-3 py-2 text-right font-medium text-slate-700"}," Group Total ",-1)),e("td",xs,a(L.value.items.reduce((l,c)=>l+Number(c.max||0),0).toFixed(2)),1),e("td",{colspan:M.value.length,class:"px-3 py-2 text-center text-sm"},[e("span",ps,a(L.value.items.reduce((l,c)=>{const x=Number(_.value[c.id]||0);return l+Math.min(Math.max(x,0),Number(c.max||0))},0).toFixed(2)),1),e("span",vs," / "+a(L.value.items.reduce((l,c)=>l+Number(c.max||0),0).toFixed(2)),1)],8,ms)])])])])])):y("",!0),W.value.length?(r(),n("section",_s,[e("div",bs,[e("div",fs,[(r(!0),n(g,null,k(W.value,(l,c)=>(r(),n("div",{key:c,class:"overflow-hidden border rounded-2xl bg-white shadow-sm"},[e("div",ys,[e("div",hs," Group "+a(c+1)+" — "+a(Qe(l,c)),1),e("div",gs,[t[18]||(t[18]=e("span",null,"Quick fill:",-1)),e("button",{class:"rounded border px-1.5 py-0.5 hover:bg-slate-100 disabled:opacity-40",onClick:x=>me(l,"half"),disabled:!C.value}," All ½ ",8,ks),e("button",{class:"rounded border px-1.5 py-0.5 hover:bg-slate-100 disabled:opacity-40",onClick:x=>me(l,"threeQuarter"),disabled:!C.value}," All ¾ ",8,ws),e("button",{class:"rounded border px-1.5 py-0.5 hover:bg-slate-100 disabled:opacity-40",onClick:x=>me(l,"full"),disabled:!C.value}," All Full ",8,Ns)])]),e("div",Cs,[e("table",Fs,[t[21]||(t[21]=e("thead",{class:"sticky top-0 bg-white z-10"},[e("tr",{class:"bg-slate-100 text-slate-700"},[e("th",{class:"px-3 py-2 w-[40px] text-center font-medium"},"#"),e("th",{class:"text-left px-3 py-2 w-[30%] font-medium"},"Item"),e("th",{class:"px-3 py-2 text-center w-[40px] font-medium"},"Max"),e("th",{class:"px-3 py-2 text-center w-[80px] font-medium"}," HR Score ")])],-1)),e("tbody",null,[(r(!0),n(g,null,k(l.items,(x,P)=>(r(),n("tr",{key:x.id,class:"border-t hover:bg-slate-50/60"},[e("td",Ss,a(P+1),1),e("td",As,[e("div",Ls,a(x.label),1)]),e("td",Ms,a(x.max),1),e("td",Rs,[C.value?O((r(),n("input",{key:0,type:"number",step:"0.1",min:"0",max:x.max,"onUpdate:modelValue":ae=>_.value[x.id]=ae,onChange:ae=>xe(x.id,x.max),inputmode:"decimal",class:"w-24 text-right rounded-lg border px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"},null,40,js)),[[z,_.value[x.id],void 0,{number:!0}]]):(r(),n("p",Hs,a(Fe(x.id)||"—"),1))])]))),128)),e("tr",$s,[t[19]||(t[19]=e("td",null,null,-1)),t[20]||(t[20]=e("td",{class:"px-3 py-2 text-right font-medium text-slate-700"}," Group Total ",-1)),e("td",Gs,a(l.items.reduce((x,P)=>x+Number(P.max||0),0).toFixed(2)),1),e("td",Es,a(l.items.reduce((x,P)=>{const ae=Number(_.value[P.id]||0);return x+Math.min(Math.max(ae,0),Number(P.max||0))},0).toFixed(2)),1)])])])])]))),128))]),e("aside",Ts,[tt.value&&C.value?(r(),n("section",Ps,[e("header",Vs,[t[22]||(t[22]=e("span",null,"Annual Summary",-1)),e("div",Ds,[e("span",Us,a(_e.value),1),ve.value?(r(),n("span",Ks," Year "+a(ve.value),1)):y("",!0),e("span",Os,a(Ae.value)+" month(s) ",1)])]),e("div",zs,[e("div",Bs,[(r(),n(g,null,k(pe,l=>e("button",{key:l.key,type:"button",onClick:c=>ut(l.key),class:yt(["px-3 py-1 rounded-full text-xs font-semibold transition",j.value===l.key?"bg-slate-900 text-white shadow":"border border-slate-200 text-slate-700 bg-white hover:border-slate-400"])},a(l.label),11,Is)),64))]),e("div",Ys,[e("div",qs,[e("div",Qs,[e("div",Ws,[t[23]||(t[23]=e("span",{class:"text-xs font-medium text-slate-600"},"Incharge",-1)),e("span",Js,a(T((p=v.value.per_scored_month)==null?void 0:p.incharge,(H=v.value.per_scored_month)==null?void 0:H.max))+"% ",1)]),e("div",Xs,[$(a(N((F=v.value.per_scored_month)==null?void 0:F.incharge))+" ",1),e("span",Zs,"/ "+a(N((U=v.value.per_scored_month)==null?void 0:U.max)),1)]),e("div",el,[e("div",{class:"h-2 bg-blue-500",style:ye({width:T((fe=v.value.per_scored_month)==null?void 0:fe.incharge,(Re=v.value.per_scored_month)==null?void 0:Re.max)+"%"})},null,4)])]),e("div",tl,[e("div",sl,[t[24]||(t[24]=e("span",{class:"text-xs font-medium text-slate-600"},"Coordinator",-1)),e("span",ll,a(T((je=v.value.per_scored_month)==null?void 0:je.coordinator,(He=v.value.per_scored_month)==null?void 0:He.max))+"% ",1)]),e("div",al,[$(a(N(($e=v.value.per_scored_month)==null?void 0:$e.coordinator))+" ",1),e("span",ol,"/ "+a(N((Ge=v.value.per_scored_month)==null?void 0:Ge.max)),1)]),e("div",nl,[e("div",{class:"h-2 bg-violet-500",style:ye({width:T((Ee=v.value.per_scored_month)==null?void 0:Ee.coordinator,(Te=v.value.per_scored_month)==null?void 0:Te.max)+"%"})},null,4)])]),e("div",rl,[e("div",il,[t[25]||(t[25]=e("span",{class:"text-xs font-medium text-slate-600"},"Final",-1)),e("span",dl,a(T((Pe=v.value.per_form_yearly)==null?void 0:Pe.final,(Ve=v.value.per_scored_month)==null?void 0:Ve.max))+"% ",1)]),e("div",ul,[$(a(N((De=v.value.per_form_yearly)==null?void 0:De.final))+" ",1),e("span",cl,"/ "+a(N((Ue=v.value.per_scored_month)==null?void 0:Ue.max)),1)]),e("div",xl,[e("div",{class:"h-2 bg-emerald-500",style:ye({width:T((Ke=v.value.per_form_yearly)==null?void 0:Ke.final,(Oe=v.value.per_scored_month)==null?void 0:Oe.max)+"%"})},null,4)])])]),e("div",ml,[e("button",{class:"text-xs px-3 py-1.5 rounded-md border hover:bg-slate-50",onClick:t[1]||(t[1]=l=>V.value=!V.value)},a(V.value?"Hide details":"Show "+_e.value+" details"),1),V.value?(r(),n("div",pl,[e("div",vl,[t[26]||(t[26]=e("div",{class:"text-slate-500"},"Year",-1)),e("div",_l,a(ve.value||"-"),1),t[27]||(t[27]=e("div",{class:"text-slate-500"},"Months counted",-1)),e("div",bl,a(Ae.value),1),t[28]||(t[28]=e("div",{class:"text-slate-500"},"Group",-1)),e("div",fl,a(dt.value),1),t[29]||(t[29]=e("div",{class:"text-slate-500"},"Max (denominator)",-1)),e("div",yl,a(N((ze=v.value.per_scored_month)==null?void 0:ze.max)),1),t[30]||(t[30]=e("div",{class:"text-slate-500"},"Incharge avg",-1)),e("div",hl,a(N((Be=v.value.per_form_yearly)==null?void 0:Be.incharge)),1),t[31]||(t[31]=e("div",{class:"text-slate-500"},"Coordinator avg",-1)),e("div",gl,a(N((Ie=v.value.per_form_yearly)==null?void 0:Ie.coordinator)),1),t[32]||(t[32]=e("div",{class:"text-slate-500"},"Final avg",-1)),e("div",kl,a(N((Ye=v.value.per_form_yearly)==null?void 0:Ye.final)),1),t[33]||(t[33]=e("div",{class:"text-slate-500"},"Percent (simple)",-1)),e("div",wl,a(N(v.value.percent_simple))+"%",1),t[34]||(t[34]=e("div",{class:"text-slate-500"},"Percent (weighted)",-1)),e("div",Nl,a(N(v.value.percent_weighted))+"%",1)])])):y("",!0)])])])])):y("",!0),Z.value.length?(r(),n("section",Cl,[e("header",Fl,[t[35]||(t[35]=e("span",null,"Review Comments",-1)),e("span",Sl,a(Z.value.length)+" lane(s) ",1)]),e("div",Al,[e("div",Ll,[e("table",Ml,[t[36]||(t[36]=e("thead",{class:"text-[11px] text-slate-600 uppercase tracking-wide bg-slate-50"},[e("tr",null,[e("th",{class:"px-2 py-2 w-[90px]"},"Lane"),e("th",{class:"px-2 py-2"},"Strengths"),e("th",{class:"px-2 py-2"},"Gaps"),e("th",{class:"px-2 py-2"},"Suggestions")])],-1)),e("tbody",null,[(r(!0),n(g,null,k(Z.value,l=>(r(),n("tr",{key:l.key,class:"border-t hover:bg-slate-50/60 align-top"},[e("td",Rl,[e("div",jl,a(l.label),1),l.submitted_at?(r(),n("div",Hl,a(new Date(l.submitted_at).toLocaleDateString()),1)):y("",!0)]),e("td",$l,[l.strengths&&l.strengths.length?(r(),n("div",Gl,[(r(!0),n(g,null,k(l.strengths,(c,x)=>(r(),n("span",{key:"s-"+x,class:"inline-flex items-center rounded-full bg-emerald-50 border border-emerald-100 px-2 py-0.5 text-[11px] text-emerald-700"},a(c),1))),128))])):(r(),n("span",El,"—"))]),e("td",Tl,[l.gaps&&l.gaps.length?(r(),n("div",Pl,[(r(!0),n(g,null,k(l.gaps,(c,x)=>(r(),n("span",{key:"g-"+x,class:"inline-flex items-center rounded-full bg-amber-50 border border-amber-100 px-2 py-0.5 text-[11px] text-amber-800"},a(c),1))),128))])):(r(),n("span",Vl,"—"))]),e("td",Dl,[l.suggestions&&l.suggestions.length?(r(),n("div",Ul,[(r(!0),n(g,null,k(l.suggestions,(c,x)=>(r(),n("span",{key:"su-"+x,class:"inline-flex items-center rounded-full bg-sky-50 border border-sky-100 px-2 py-0.5 text-[11px] text-sky-800"},a(c),1))),128))])):(r(),n("span",Kl,"—"))])]))),128))])])])])])):y("",!0)])])])):y("",!0),R.value||C.value?(r(),n("section",Ol,[t[43]||(t[43]=ht('<header class="flex items-center justify-between mb-1"><div><h2 class="text-sm font-semibold text-slate-800"> Overall Review Notes </h2><p class="text-[11px] text-slate-500"> Use saved hints or write your own detailed comments. </p></div><div class="hidden md:flex items-center gap-2 text-[11px] text-slate-500"><span class="inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 border border-emerald-100"><span class="text-xs">●</span> Strengths </span><span class="inline-flex items-center gap-1 rounded-full bg-amber-50 px-2 py-0.5 border border-amber-100"><span class="text-xs">●</span> Gaps </span><span class="inline-flex items-center gap-1 rounded-full bg-sky-50 px-2 py-0.5 border border-sky-100"><span class="text-xs">●</span> Suggestions </span></div></header>',1)),e("div",zl,[e("div",Bl,[e("header",Il,[t[37]||(t[37]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-emerald-500 text-base leading-none"},"★"),e("span",null,"Strengths")],-1)),ee.value.length?(r(),n("span",Yl,a(ee.value.length)+" saved hint(s) ",1)):y("",!0)]),ee.value.length?(r(),n("div",ql,[e("div",Ql,[(r(!0),n(g,null,k(ee.value,l=>(r(),n("button",{key:l,type:"button",onClick:c=>be("strengths",l),disabled:le("strengths",l),class:"rounded-full border px-2.5 py-1 text-[11px] font-medium transition border-slate-200 bg-white text-slate-700 hover:border-emerald-300 hover:bg-emerald-50 hover:text-emerald-800 disabled:opacity-40 disabled:cursor-not-allowed"},a(l),9,Wl))),128))])])):(r(),n("p",Jl," No historical strengths yet. Write your own notes below. ")),e("div",Xl,[t[38]||(t[38]=e("label",{class:"text-[11px] font-medium text-slate-500"}," Key Strength(s) ",-1)),O(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>B.value=l),placeholder:"e.g. Strong ownership, proactive problem solving…",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[z,B.value]])])]),e("div",Zl,[e("header",ea,[t[39]||(t[39]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-amber-500 text-base leading-none"},"!"),e("span",null,"Gaps")],-1)),te.value.length?(r(),n("span",ta,a(te.value.length)+" saved hint(s) ",1)):y("",!0)]),te.value.length?(r(),n("div",sa,[e("div",la,[(r(!0),n(g,null,k(te.value,l=>(r(),n("button",{key:l,type:"button",onClick:c=>be("gaps",l),disabled:le("gaps",l),class:"rounded-full border px-2.5 py-1 text-[11px] font-medium transition border-slate-200 bg-white text-slate-700 hover:border-amber-300 hover:bg-amber-50 hover:text-amber-800 disabled:opacity-40 disabled:cursor-not-allowed"},a(l),9,aa))),128))])])):(r(),n("p",oa," No historical gaps yet. ")),e("div",na,[t[40]||(t[40]=e("label",{class:"text-[11px] font-medium text-slate-500"},"GAP(s)",-1)),O(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>I.value=l),placeholder:"e.g. Needs improvement in documentation, communication…",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-amber-200"},null,512),[[z,I.value]])])]),e("div",ra,[e("header",ia,[t[41]||(t[41]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-sky-500 text-base leading-none"},"✱"),e("span",null,"Suggestions / Training")],-1)),se.value.length?(r(),n("span",da,a(se.value.length)+" common suggestion(s) ",1)):y("",!0)]),se.value.length?(r(),n("div",ua,[e("div",ca,[(r(!0),n(g,null,k(se.value,l=>(r(),n("button",{key:l,type:"button",onClick:c=>be("suggestions",l),disabled:le("suggestions",l),class:"rounded-full border px-2.5 py-1 text-[11px] font-medium transition border-slate-200 bg-white text-slate-700 hover:border-sky-300 hover:bg-sky-50 hover:text-sky-800 disabled:opacity-40 disabled:cursor-not-allowed"},a(l),9,xa))),128))])])):y("",!0),e("div",ma,[t[42]||(t[42]=e("label",{class:"text-[11px] font-medium text-slate-500"}," Suggestions / Development plan ",-1)),O(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>Y.value=l),placeholder:"Specific actions, training plans, timeline and expectations…",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-sky-200"},null,512),[[z,Y.value]])])])])])):y("",!0),e("div",pa,[e("div",va,[t[44]||(t[44]=$(" My (Personal) Total: ")),e("b",_a,a(D.value.got.toFixed(2)),1),e("span",ba,"/ "+a(D.value.max.toFixed(2)),1)]),e("button",{onClick:_t,disabled:!(C.value||R.value),class:"inline-flex items-center justify-center rounded-xl bg-emerald-600 px-5 py-2.5 text-sm font-medium text-white shadow hover:bg-emerald-700 disabled:opacity-40 focus:outline-none focus:ring-2 focus:ring-emerald-300"}," Submit ",8,fa)])])}}};export{ka as default};
