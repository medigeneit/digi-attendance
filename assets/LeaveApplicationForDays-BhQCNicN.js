import{u as R,f as B,D as N,r as _,h as V,q as w,x as j,p as F,c as i,o as n,a as e,b as M,t as a,m,d as p,k,v as E,H,j as A,F as P,e as $,i as z,l as L}from"./index-BPqTUvjB.js";import{_ as I}from"./EmployeeFilter-Cdp5k4za.js";import{L as O}from"./LoaderView-D0KxWfec.js";import{u as W}from"./leave-application-C9qMVuhC.js";import{u as G}from"./user-CijRKizA.js";import"./company-DF7pVrzX.js";import"./department-BzHEojKg.js";import"./EmployeeDropdownInput-BZdHX9YY.js";import"./SelectDropdown-W20NyE2n.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-Di1hnRCk.js";const J={class:"space-y-2 px-4"},K={class:"flex items-center justify-between gap-2"},Q={class:"title-md md:title-lg flex-wrap text-center"},X={class:"capitalize"},Y={class:"flex flex-wrap gap-2"},Z={key:0,class:"text-center py-4"},ee={key:1,class:"space-y-4"},te={class:"overflow-x-auto"},se={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},re={class:"border border-gray-300 px-2"},oe={class:"border border-gray-300 px-2"},de={class:"border border-gray-300 px-2"},le={class:"border border-gray-300 px-2"},ae={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},ue=["innerHTML"],ie={class:"border border-gray-300 px-2"},ye={class:"border border-gray-300 px-2"},_e={class:"border border-gray-300 px-2"},me={class:"flex justify-center gap-2"},ve=["onClick"],pe={key:0},Te={__name:"LeaveApplicationForDays",setup(be){const v=R(),o=B(),d=W(),b=G(),{leaveApplications:q,loading:c}=N(d),S=_(null),y=_(o.query.date||d.selectedDate||new Date().toISOString().split("T")[0]),D=_(o.query.search||""),r=_({company_id:o.query.company_id||"",department_id:o.query.department_id||"all",line_type:o.query.line_type||"all",employee_id:o.query.employee_id||"",category:""}),u=async()=>{const l={company_id:r.value.company_id,department_id:r.value.department_id,line_type:r.value.line_type,selectedDate:y.value,selectedStatus:d.selectedStatus,query:D.value,applicationTypes:o.query.applicationType||""};r.value.employee_id&&(l.user_id=r.value.employee_id),c.value=!0,await d.fetchLeaveApplications(l),c.value=!1};V(async()=>{r.value.employee_id&&(await b.fetchUser(r.value.employee_id),S.value=b.user||null),await u()}),w(()=>[r.value.company_id,r.value.department_id,r.value.line_type,r.value.employee_id,y.value],async()=>{await u()}),w(()=>y.value,l=>{v.replace({query:{...o.query,date:l}}),u()});const f=j(()=>q.value||[]),T=async l=>{confirm("Are you sure to delete this application?")&&(await d.deleteLeaveApplication(l),await u())},U=()=>v.go(-1),C=()=>{v.replace({query:{...o.query,company_id:r.value.company_id,department_id:r.value.department_id,line_type:r.value.line_type,employee_id:r.value.employee_id}})};return(l,s)=>{const g=F("RouterLink");return n(),i("div",J,[e("div",K,[e("button",{class:"btn-3",onClick:U},s[6]||(s[6]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),e("h1",Q,[e("span",X,a(m(o).query.applicationType),1),s[7]||(s[7]=M(" Leave Applications"))]),s[8]||(s[8]=e("div",null,null,-1))]),e("div",Y,[p(I,{company_id:r.value.company_id,"onUpdate:company_id":s[0]||(s[0]=t=>r.value.company_id=t),department_id:r.value.department_id,"onUpdate:department_id":s[1]||(s[1]=t=>r.value.department_id=t),line_type:r.value.line_type,"onUpdate:line_type":s[2]||(s[2]=t=>r.value.line_type=t),employee_id:r.value.employee_id,"onUpdate:employee_id":s[3]||(s[3]=t=>r.value.employee_id=t),"with-type":!0,"initial-value":l.$route.query,onFilterChange:C},null,8,["company_id","department_id","line_type","employee_id","initial-value"]),e("div",null,[k(e("input",{id:"monthSelect",type:"date","onUpdate:modelValue":s[4]||(s[4]=t=>y.value=t),onChange:u,class:"input-1"},null,544),[[E,y.value]])]),e("div",null,[k(e("select",{"onUpdate:modelValue":s[5]||(s[5]=t=>m(d).selectedStatus=t),onChange:u,class:"input-1"},s[9]||(s[9]=[e("option",{value:"",selected:""},"All",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Approved"},"Approved",-1),e("option",{value:"Rejected"},"Rejected",-1)]),544),[[H,m(d).selectedStatus]])]),s[10]||(s[10]=e("div",null,null,-1))]),m(d).loading?(n(),i("div",Z,[p(O)])):(n(),i("div",ee,[e("div",te,[e("table",se,[s[15]||(s[15]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-300 px-2 text-left"},"#"),e("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),e("th",{class:"border border-gray-300 px-2 text-left"},"Last Working Day"),e("th",{class:"border border-gray-300 px-2 text-left"},"Resumption Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Leave Period"),e("th",{class:"border border-gray-300 px-2 text-left"},"Total Days"),e("th",{class:"border border-gray-300 px-2 text-left"},"Type"),e("th",{class:"border border-gray-300 px-2 text-left"},"Status"),e("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),e("tbody",null,[(n(!0),i(P,null,$(f.value,(t,x)=>{var h;return n(),i("tr",{key:x,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",re,a(x+1),1),e("td",oe,a(((h=t==null?void 0:t.user)==null?void 0:h.name)||"Unknown"),1),e("td",de,a(t==null?void 0:t.last_working_date),1),e("td",le,a(t==null?void 0:t.resumption_date),1),e("td",ae,a(t==null?void 0:t.leave_period),1),e("td",ne,[e("div",{innerHTML:t.duration||(t==null?void 0:t.total_leave_days)},null,8,ue)]),e("td",ie,a(t==null?void 0:t.application_types),1),e("td",ye,a((t==null?void 0:t.status)||"N/A"),1),e("td",_e,[e("div",me,[p(g,{to:{name:"LeaveApplicationShow",params:{id:t==null?void 0:t.id}},class:"btn-icon"},{default:L(()=>s[11]||(s[11]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[11]},1032,["to"]),(t==null?void 0:t.status)!=="Approved"?(n(),z(g,{key:0,to:{name:"LeaveApplicationEdit",params:{id:t==null?void 0:t.id}},class:"btn-icon"},{default:L(()=>s[12]||(s[12]=[e("i",{class:"far fa-edit text-orange-600"},null,-1)])),_:2,__:[12]},1032,["to"])):A("",!0),e("button",{onClick:ce=>T(t==null?void 0:t.id),class:"btn-icon text-red-500"},s[13]||(s[13]=[e("i",{class:"far fa-trash"},null,-1)]),8,ve)])])])}),128)),f.value.length?A("",!0):(n(),i("tr",pe,s[14]||(s[14]=[e("td",{colspan:"7",class:"p-1 text-center text-red-500"},"No application found",-1)])))])])])]))])}}};export{Te as default};
