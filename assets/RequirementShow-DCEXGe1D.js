import{x as M,r as _,c as l,j as u,o as n,i as j,a as e,F as U,e as K,w as I,l as C,b as D,t as v,d as q,p as Le,k as Oe,v as Be,s as E,C as Ee,h as ae,g as Ve,m as Y,Q as Fe,y as Ue,A as Me,f as Pe,u as ze,G as ne}from"./index-Bn8VUdIu.js";import{L as de}from"./LoaderView-B2QIsCRQ.js";import{O as H}from"./OverlyModal-Um6DQShP.js";import{_ as He}from"./ShareComponent-p3E20xju.js";import{_ as Ne}from"./DepartmentChip-90wdsvQ8.js";import{_ as J}from"./DescriptionView-DwYkieEl.js";import{_ as re}from"./UserChip-Ctr9xMKt.js";import{r as Ge,c as We,f as ue,b as Qe,s as Ke}from"./requirement-9PuPnGLI.js";import{o as Ye}from"./url-CePbr-gY.js";import{u as Je}from"./user-C88-N-Ir.js";import{_ as Gr,a as Xe}from"./TaskUserAssignForm-DFyqFOlE.js";import{_ as Ze}from"./TextEditor-NJy6ERXY.js";import{u as et}from"./useTaskStore-D5M8QlaT.js";import{_ as tt}from"./TaskSelectionInput-CqU0yEEp.js";import{_ as st}from"./TaskAddForm-C4OIgQNi.js";import{_ as rt}from"./TaskEditForm-CEFLMVfX.js";import{_ as nt}from"./TaskTableRow-C5ecRVfI.js";import{T as ie}from"./TextWithHr-U0mb7LBW.js";import{d as oe,b as at}from"./datetime-BEfC2TVK.js";import{c as lt}from"./dom-Bic1TNqD.js";import{_ as it}from"./ApproveAndReject-JtY_-qdz.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TaskUrgencyInput-b-9It5Db.js";import"./DraggableList.vue_vue_type_script_setup_true_lang-CkAbkHx4.js";import"./SelectDropdown-AIroYaNd.js";import"./TaskTitle-ZpekRA9q.js";import"./RequiredIcon-BCmGySpR.js";import"./company-Za1C5fpF.js";import"./CompanyDepartmentSelectInput-BgyPOoOB.js";import"./SectionLoading-gmDezzdw.js";import"./tags-dAQx8HGv.js";import"./MultiselectDropdown-88qMnZ7w.js";import"./MultiselectDropdown.vue_vue_type_style_index_0_lang-JlkJpiw2.js";import"./TaskUrgentBadge-DWLxQpzu.js";import"./TaskAssignedUsers-DKYABK4I.js";import"./TaskIsClosedBadge-C8phgn8N.js";const ot={key:0,class:"card-bg p-4"},ut={key:0},dt={class:"grid grid-cols-2 lg:grid-cols-4 gap-3 w-full"},mt=["onClick"],ct=["src"],pt=["href"],vt={key:2,class:"text-xs text-gray-500 text-center"},ft={class:"border-b flex items-center px-2 py-1"},bt=["href"],xt={class:"mt-4 p-2"},yt=["src"],gt=["src"],_t={__name:"RequirementAttachments",props:{requirement:{type:Array,default:()=>[]}},setup(g){const R=g,a=M(()=>{var t;return((t=R.requirement)==null?void 0:t.attachments)||[]}),d=_(null);function b(t){if(!t)return!1;const y=m(t);return["jpg","jpeg","png","gif","webp","bmp","svg"].includes(y)}function p(t){return m(t)==="pdf"}function m(t){return typeof t=="string"?t.split(".").pop().toLowerCase():""}function f(t){return t.startsWith("http")?t:`https://hrm-api.medi.academy/storage/${t}`}return(t,y)=>a.value&&a.value.length?(n(),l("div",ot,[a.value&&a.value.length?(n(),l("div",ut,[y[2]||(y[2]=e("h4",{class:"text-gray-700 font-medium mb-2"},"Attachments",-1)),e("div",dt,[(n(!0),l(U,null,K(a.value,(i,r)=>(n(),l("div",{key:r,class:"border rounded aspect-square flex items-center justify-center bg-gray-50 relative",tabindex:"0",onClick:I(o=>d.value=i,["prevent"])},[b(i)?(n(),l("img",{key:0,src:f(i),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,ct)):p(i)?(n(),l("a",{key:1,href:f(i),target:"_blank",class:"text-xs text-blue-600 text-center break-words hover:underline"},y[1]||(y[1]=[e("i",{class:"fas fa-file-pdf fa-2x mb-1 text-amber-700"},null,-1),e("div",{class:"whitespace-nowrap text-xs mt-1"},"Open PDF",-1)]),8,pt)):(n(),l("span",vt,"Unknown"))],8,mt))),128))])])):u("",!0),d.value?(n(),j(H,{key:1,class:"*:max-w-4xl *:min-h-[60vh]"},{default:C(()=>[e("div",ft,[y[4]||(y[4]=e("h2",{class:"text-xl font-semibold"},"Attachment preview",-1)),e("a",{href:f(d.value),target:"_blank",class:"text-sky-600 hover:text-sky-400 hover:underline ml-2"},y[3]||(y[3]=[e("i",{class:"fas fa-external-link"},null,-1),D(),e("span",{class:"hidden md:inline"},"Open In New tab",-1)]),8,bt),e("button",{onClick:y[0]||(y[0]=I(i=>d.value=null,["prevent"])),class:"btn-icon ml-auto"},"×")]),e("div",xt,[b(d.value)?(n(),l("img",{key:0,src:f(d.value),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,yt)):p(d.value)?(n(),l("iframe",{key:1,src:f(d.value),class:"w-full h-[60vh] border rounded-md"},null,8,gt)):u("",!0)])]),_:1})):u("",!0)])):u("",!0)}},kt={key:0,class:"mb-4 flex flex-col gap-2 items-center justify-center bg-gray-50 bg-opacity-70 hover:bg-opacity-90 p-6 border border-gray-100 rounded-md"},ht={class:"text-sm flex items-center gap-2 text-red-400 font-semibold"},wt={class:"mt-[2px]"},qt={key:0,class:"text-gray-800 flex items-center gap-2"},$t={key:1,class:"text-gray-800 w-full my-2 text-center"},Ct={class:"text-gray-800 border w-full rounded-md border-dashed py-2 px-3 border-gray-400 text-sm bg-white"},Tt=["innerHTML"],Rt={class:"flex gap-4 items-center justify-center mt-2"},St={__name:"RequirementCloseInfo",props:{requirement:{type:Object,default:()=>{}}},emits:["reOpenClick"],setup(g,{emit:R}){const a=R;return(d,b)=>{var p;return(p=g.requirement)!=null&&p.closed_at?(n(),l("div",kt,[b[5]||(b[5]=e("div",{class:"text-red-400 font-bold text-xl"},"Requirement Closed",-1)),e("div",ht,[b[1]||(b[1]=e("span",{class:"fad fa-lock"},null,-1)),b[2]||(b[2]=e("span",{class:"mt-[2px]"},"CLOSED AT",-1)),e("span",wt,v(new Date(g.requirement.closed_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),g.requirement.closed_by_user?(n(),l("div",qt,[b[3]||(b[3]=e("span",{class:"text-sm"},"Closed by",-1)),q(re,{user:g.requirement.closed_by_user,"avatar-size":"xsmall"},null,8,["user"])])):u("",!0),g.requirement.closing_note?(n(),l("div",$t,[b[4]||(b[4]=e("div",{class:"text-x"},"Closing Note",-1)),e("div",Ct,[e("p",{innerHTML:g.requirement.closing_note},null,8,Tt)])])):u("",!0),e("div",Rt,[e("button",{class:"btn-2 h-8",onClick:b[0]||(b[0]=I(m=>a("reOpenClick"),["prevent"]))},"Re Open")])])):u("",!0)}}},jt={class:"border-b -mx-4 px-4 -mt-4 py-2 text-xl bg-gray-50"},It={class:"my-6"},At={class:"text-center font-semibold text-blue-800 mb-4"},Nt={class:"text-center my-1"},Dt={class:"border px-2 rounded-md bg-gray-50 border-blue-300 text-blue-400 inline-flex items-center gap-1"},Lt={class:"mt-4"},Ot=["placeholder","required"],Bt={class:"flex"},Et={class:"text-red-600 text-center mt-2 text-sm"},Vt={class:"flex justify-between mt-3"},Ut={class:"btn-2"},Mt={__name:"RequirementClosingForm",props:{loading:{type:Boolean,default:!1},requirement:{type:Object,default:()=>{}}},emits:["clickCancel","updateStatus","error","update:loading"],setup(g,{emit:R}){const a=g,d=R,b=M({get:()=>a.loading,set:()=>d("update:loading")}),p=_(""),m=_(""),f=_(255),t=M(()=>f.value-p.value.length);async function y(){var i,r,o;b.value=!0;try{(i=a.requirement)!=null&&i.closed_at?await Ge(a.requirement.id,p.value):await We(a.requirement.id,p.value),d("updateStatus")}catch(c){m.value=(o=(r=c.response)==null?void 0:r.data)==null?void 0:o.message,d("error")}finally{b.value=!1}}return(i,r)=>{var c,k,T,$,A;const o=Le("LoaderView");return n(),l("form",{class:"p-4 rounded relative border",onSubmit:I(y,["prevent"])},[b.value?(n(),j(o,{key:0,class:"absolute inset-0 flex items-center justify-center bg-opacity-90"},{default:C(()=>r[3]||(r[3]=[D(" Submitting! ")])),_:1,__:[3]})):u("",!0),e("h3",jt,v((c=g.requirement)!=null&&c.closed_at?"Re Open Requirement":"Requirement Closing"),1),e("div",It,[e("div",At,v((k=g.requirement)==null?void 0:k.title),1),r[6]||(r[6]=e("div",{class:"text-center my-1 text-lg"},"Are you sure?",-1)),e("div",Nt,[r[4]||(r[4]=D(" Want to ")),e("span",Dt,v((T=g.requirement)!=null&&T.closed_at?"Re-Open":"Close"),1),r[5]||(r[5]=D(" the requirement? "))]),e("div",Lt,[Oe(e("textarea",{"onUpdate:modelValue":r[0]||(r[0]=h=>p.value=h),rows:"4",placeholder:`Write about why are you ${($=g.requirement)!=null&&$.closed_at?"Re-Opening":"Closing"} the requirement?`,class:"w-full border rounded-lg p-2 text-gray-700 border-gray-400 placeholder:text-gray-400",required:i.currentAction==="reject",onInput:r[1]||(r[1]=h=>p.value.length>f.value?p.value=p.value.slice(0,f.value):null)},null,40,Ot),[[Be,p.value]]),e("div",Bt,[e("div",{class:E(["ml-auto inline-block text-sm text-gray-500",p.value.length>=f.value?"text-red-500":""])}," left "+v(t.value)+"/"+v(f.value)+" words ",3)])])]),r[7]||(r[7]=e("hr",{class:"mt-3 -mx-4"},null,-1)),e("div",null,[e("div",Et,v(m.value),1),e("div",Vt,[e("button",{class:"btn-3",onClick:r[2]||(r[2]=I(h=>d("clickCancel"),["prevent"]))},"Cancel"),e("button",Ut,v((A=g.requirement)!=null&&A.closed_at?"Re-Open":"Close"),1)])])],32)}}};async function Ft(g,R,{params:a={}}={}){return Ee.get(`/requirements/${g}/details/${R}`,{params:a})}async function Pt(g,R,{params:a={}}={}){const d=Ye(a);return Ee.delete(`/requirements/${g}/details/${R}${d?"?"+d:""}`)}const zt={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},Ht={class:"mb-4"},Gt={class:"font-semibold"},Wt={class:"mb-4"},Qt={class:"line-clamp-2"},Kt={key:1,class:"min-h-40"},Yt={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},Jt={key:0,class:"mb-4 text-red-500 font-medium"},Xt={key:1,class:"mb-4"},Zt={class:"flex items-center justify-between gap-4"},es=["disabled"],ts={__name:"RequirementDetailDeleteForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["delete","closeClick","error"],setup(g,{emit:R}){const a=g,d=R,b=Je(),p=_(null),m=_(""),f=_(),t=_([]);async function y(){var i,r;m.value="submitting";try{const o=await Pt(a.requirementId,a.detailId);d("delete",o),m.value="create"}catch(o){m.value="error",f.value=((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update requirement detail: "+o,d("error",f.value)}}return ae(async()=>{var i,r,o;m.value="loading";try{t.value=await b.fetchDepartmentWiseEmployees(),p.value=(i=(await Ft(a.requirementId,a.detailId)).data)==null?void 0:i.detail}catch(c){f.value=((o=(r=c.response)==null?void 0:r.data)==null?void 0:o.message)||"Failed to fetch requirement detail"}finally{m.value=""}}),(i,r)=>{var o,c;return n(),l("div",zt,[r[4]||(r[4]=e("div",{class:"sticky top-0 -mx-6 px-6 z-10 bg-gray-50"},[e("h2",{class:"text-xl font-semibold text-gray-800 py-2"},"Delete Requirement Details"),e("hr",{class:"mb-4 -mx-6"})],-1)),e("form",{onSubmit:I(y,["prevent"]),class:"z-0"},[m.value!=="loading"?(n(),l(U,{key:0},[e("div",Ht,[r[1]||(r[1]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Title",-1)),e("div",Gt,v((o=p.value)==null?void 0:o.title),1)]),e("div",Wt,[r[2]||(r[2]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),e("div",Qt,v((c=p.value)==null?void 0:c.description),1)]),r[3]||(r[3]=e("div",{class:"my-8 text-center text-xl text-red-600"},"Are you sure want to delete?",-1))],64)):(n(),l("div",Kt)),e("div",Yt,[f.value?(n(),l("div",Jt,v(f.value),1)):u("",!0),f.value?(n(),l("hr",Xt)):u("",!0),e("div",Zt,[e("button",{type:"button",onClick:r[0]||(r[0]=I(k=>d("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:m.value=="loading"||m.value=="submitting",type:"submit",class:"bg-red-700 hover:bg-red-500 text-white font-semibold px-5 py-2 rounded transition"},v(m.value=="submitting"?"Deleting...":"Delete"),9,es)])])],32),m.value==="loading"||m.value==="submitting"?(n(),j(de,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):u("",!0)])}}};const ss={class:"sticky top-0 pt-4 bg-white z-10"},rs={class:"mb-4"},ns={class:"mb-4"},as={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},ls={key:0,class:"mb-4 text-red-500 font-medium"},is={key:1,class:"mb-4"},os={class:"flex items-center justify-between gap-4"},us=["disabled"],ds={__name:"RequirementFeedbackEditForm",props:{requirementId:{type:[Number,String],required:!0},requirementId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(g,{emit:R}){const a=g,d=R,b=_(),p=_(null),m=_(""),f=_(),t=_({feedback:""});async function y(){var i,r;m.value="submitting";try{const o=await Qe(a.requirementId,t.value.feedback);d("update",o),m.value="create"}catch(o){m.value="error",f.value=((r=(i=o.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update requirement requirement",d("error",f.value)}}return ae(async()=>{var i,r,o,c;m.value="loading";try{await ue(a.requirementId),p.value=(i=(await ue(a.requirementId)).data)==null?void 0:i.requirement,t.value={feedback:(r=p.value)==null?void 0:r.feedback}}catch(k){f.value=((c=(o=k.response)==null?void 0:o.data)==null?void 0:c.message)||"Failed to fetch requirement requirement"}finally{m.value=""}}),(i,r)=>{var o;return n(),l("div",{ref_key:"formContainerRef",ref:b,class:"max-h-[90vh] w-full mx-auto overflow-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},[e("div",ss,[r[3]||(r[3]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Requirement Feedback",-1)),r[4]||(r[4]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:r[0]||(r[0]=I(c=>d("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:I(y,["prevent"]),class:"z-0"},[m.value!=="loading"?(n(),l(U,{key:0},[e("div",rs,[r[5]||(r[5]=e("label",{class:"block text-gray-600 text-sm font-medium"},"Title ",-1)),q(J,{"line-clamp":"1",className:{paragraph:"whitespace-pre-wrap text-justify ",button:"mt-0"}},{default:C(()=>{var c;return[D(v((c=p.value)==null?void 0:c.title),1)]}),_:1})]),e("div",ns,[r[6]||(r[6]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Feedback",-1)),q(Ze,{modelValue:t.value.feedback,"onUpdate:modelValue":r[1]||(r[1]=c=>t.value.feedback=c)},null,8,["modelValue"])])],64)):u("",!0),e("div",as,[f.value?(n(),l("div",ls,v(f.value),1)):u("",!0),f.value?(n(),l("hr",is)):u("",!0),e("div",os,[e("button",{type:"button",onClick:r[2]||(r[2]=I(c=>d("closeClick"),["prevent"])),class:"btn-3"},"Cancel"),e("button",{disabled:m.value=="loading"||m.value=="submitting",type:"submit",class:"btn-2"},v(m.value=="submitting"?"Saving...":(o=p.value)!=null&&o.feedback?"Update Feedback":"Add Feedback"),9,us)])])],32),m.value==="loading"||m.value==="submitting"?(n(),j(de,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):u("",!0)],512)}}},ms={class:"flex justify-center items-center"},cs={class:"modal-card"},ps=["required"],vs={class:"flex"},fs={class:"flex justify-between gap-2 mt-4"},bs=["disabled"],xs=["disabled"],ys={__name:"RequirementSubmissionHandler",props:{requirementId:{type:[String,Number],required:!0}},emits:["loading","success","error"],setup(g,{emit:R}){const a=g,d=R,b=_(255),p=M(()=>b.value-i.value.length),m=Fe(),f=_(null),t=_(null),y=_(null),i=_(""),r=_(!1),o=M(()=>y.value!==null);function c(h){y.value=h,i.value="",A()}function k(){y.value=null,i.value=""}async function T(){var h,S;if(y.value==="reject"&&!i.value)return m.error("Rejection Reason is required!");if(typeof a.onSubmit=="function")return a.onSubmit({note:i.value,action:y.value});d("loading",!0),r.value=!0;try{await Ke(a.requirementId,{note:i.value}),d("success"),k()}catch(N){return d("error",N),m.error(((S=(h=N==null?void 0:N.response)==null?void 0:h.data)==null?void 0:S.message)||"Submission failed!")}finally{d("loading",!1),r.value=!1}}function $(h){var S,N;o.value&&(h.key==="ArrowLeft"?(S=t.value)==null||S.focus():h.key==="ArrowRight"&&((N=f.value)==null||N.focus()))}function A(){Me(()=>{var h;(h=f.value)==null||h.focus()})}return ae(()=>{window.addEventListener("keydown",$)}),Ue(()=>{window.removeEventListener("keydown",$)}),(h,S)=>(n(),l("div",null,[e("div",ms,[e("button",{onClick:S[0]||(S[0]=N=>c("accept"))},S[3]||(S[3]=[e("span",{class:"btn-2"},[e("span",{class:"fas fa-paper-plane"}),e("span",{class:"hidden md:inline"},"Submit Requirement")],-1)]))]),o.value?(n(),l("div",{key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50",onClick:I(k,["self"])},[e("div",cs,[S[4]||(S[4]=e("h3",{class:"title-lg"},"Requirement Submission",-1)),e("div",null,[Oe(e("textarea",{"onUpdate:modelValue":S[1]||(S[1]=N=>i.value=N),rows:"4",placeholder:"Note...",class:"w-full border rounded-lg p-2 text-gray-700",required:y.value==="reject",onInput:S[2]||(S[2]=N=>i.value.length>b.value?i.value=i.value.slice(0,b.value):null)},null,40,ps),[[Be,i.value]]),e("div",vs,[e("div",{class:E(["ml-auto inline-block text-sm text-gray-500",i.value.length>=b.value?"text-red-500":""])}," left "+v(p.value)+"/"+v(b.value)+" words ",3)])]),e("div",fs,[e("button",{ref_key:"cancelBtnRef",ref:t,class:"btn-3 focus:ring-2 ring-offset-2 disabled:opacity-30",onClick:k,disabled:r.value}," Cancel ",8,bs),e("button",{ref_key:"confirmBtnRef",ref:f,class:E(["focus:ring-2 ring-offset-2 disabled:opacity-30",y.value==="reject"?"btn-2-red":"btn-2-green"]),onClick:T,disabled:r.value}," Confirm Submission ",10,xs)])])])):u("",!0)]))}},gs={class:"flex items-center gap-6 justify-center my-16"},_s={key:0,class:"border rounded-md"},ks={__name:"RequirementTaskCreateOrAssign",props:{fromDepartmentId:{type:Number},requirement:{type:Object}},emits:["addNewTaskClick","cancelClick","assignTask"],setup(g,{emit:R}){const a=g,d=R,b=et(),p=_(""),m=_(null),f=_(""),t=_(!1);async function y(){await b.setTaskRequirement(f.value,a.requirement.id),d("assignTask")}return(i,r)=>(n(),l("div",{class:E(["text-left p-4",[p.value&&!m.value?"min-h-[400px]":""]])},[e("div",gs,[e("button",{onClick:r[0]||(r[0]=I(o=>d("addNewTaskClick"),["prevent"])),class:"btn-3"},"Add New Task"),r[5]||(r[5]=e("span",null,"or",-1)),e("button",{class:E({"btn-3":p.value!=="direct-assign","btn-2":p.value=="direct-assign"}),onClick:r[1]||(r[1]=I(()=>p.value="direct-assign",["prevent"]))}," Assign Task ",2)]),p.value&&!m.value?(n(),l("div",_s,[e("form",{onSubmit:I(y,["prevent"]),class:"p-4 flex items-end"},[q(tt,{class:"flex-grow mr-4 h-12",taskId:f.value,"onUpdate:taskId":r[2]||(r[2]=o=>f.value=o),show:t.value,"onUpdate:show":r[3]||(r[3]=o=>t.value=o),isOnlyMyTask:!1,taskQueryParams:{"from-department-id":g.fromDepartmentId},filterTasks:o=>!o.requirement_id,onAddNewTaskClick:r[4]||(r[4]=o=>d("addNewTaskClick")),showAddBtnIfNotFound:!0},null,8,["taskId","show","taskQueryParams","filterTasks"]),r[6]||(r[6]=e("div",{class:"flex justify-center"},[e("button",{class:"btn-2 h-12 rounded-md"},"Save")],-1))],32)])):u("",!0)],2))}},hs={class:"flex flex-col items-center gax-x-1 justify-end"},ws={key:0},qs={key:1},$s={class:"text-sm text-gray-600 whitespace-normal w-64"},Cs={class:"text-gray-900 font-semibold text-sm md:text-base"},Ts={class:"ml-2"},Rs={key:0,class:"text-red-700 text-sm"},Ss={key:1,class:"text-green-600 ml-2"},js={key:2,class:"ml-2 text-yellow-700"},De={__name:"RequirementApprovalItem",props:{requirement:{type:Object,required:!0},approvalType:{type:String,required:!0}},emits:["updateApproval"],setup(g,{emit:R}){const a=g,d=R,b=Ve(),p=M(()=>{var i,r,o,c,k;return{from_in_charge:!!((i=a.requirement)!=null&&i.status&&((r=a.requirement)!=null&&r.submission_date)),from_coordinator:!!((o=a.requirement)!=null&&o.from_coordinator),to_in_charge:!!((c=a.requirement)!=null&&c.to_incharge),to_coordinator:!!((k=a.requirement)!=null&&k.to_coordinator)}}),m=M(()=>{var i,r,o,c,k,T,$,A;return{from_in_charge:(r=(i=a.requirement)==null?void 0:i.from_department)==null?void 0:r.in_charge,from_coordinator:(c=(o=a.requirement)==null?void 0:o.from_department)==null?void 0:c.coordinator,to_in_charge:(T=(k=a.requirement)==null?void 0:k.to_department)==null?void 0:T.in_charge,to_coordinator:(A=($=a.requirement)==null?void 0:$.to_department)==null?void 0:A.coordinator}}),f=M(()=>{var c;const i=Object.keys(p.value),r=i.indexOf(a.approvalType);let o=!0;for(let k=r-1;k>=0;k--){const T=i[k];o=o&&(m.value[T]?(c=p.value)==null?void 0:c[T]:!0)}return o}),t=M(()=>{var T,$,A,h,S,N,le,w,W,Q,F,L,s,G,P,z;let i=null,r=null,o="",c="";a.approvalType==="from_in_charge"&&(i=(T=a.requirement)==null?void 0:T.from_department,r=(A=($=a.requirement)==null?void 0:$.from_department)==null?void 0:A.in_charge,o="In Charge",c=(h=a.requirement)==null?void 0:h.from_incharge_note),a.approvalType==="from_coordinator"&&(i=(S=a.requirement)==null?void 0:S.from_department,r=(N=a.requirement)==null?void 0:N.from_coordinator,o="Coordinator",c=(le=a.requirement)==null?void 0:le.from_coordinator_note),a.approvalType==="to_in_charge"&&(i=(w=a.requirement)==null?void 0:w.to_department,r=(W=a.requirement)==null?void 0:W.to_in_charge,o="In Charge",c=(Q=a.requirement)==null?void 0:Q.to_incharge_note),a.approvalType==="to_coordinator"&&(i=(F=a.requirement)==null?void 0:F.to_department,r=(L=a.requirement)==null?void 0:L.to_coordinator,o="Coordinator",c=(s=a.requirement)==null?void 0:s.to_coordinator_note);const k=(G=m.value)==null?void 0:G[a.approvalType];return{department:i,department_user:k,approved:(P=p.value)==null?void 0:P[a.approvalType],approval_user:r,is_rejected:((z=a.requirement)==null?void 0:z.rejected_by_user_id)==(k==null?void 0:k.id),userType:o,approval_note:c}});function y(){d("updateApproval")}return(i,r)=>{var o,c,k,T,$,A;return n(),l("div",hs,[t.value.department_user?(n(),l("div",ws,[q(re,{user:t.value.department_user,"avatar-size":"xsmall"},null,8,["user"])])):(n(),l("div",qs,r[0]||(r[0]=[e("span",{class:"italic text-xs text-gray-400"},"N/A",-1)]))),e("div",$s,[t.value.is_rejected?(n(),j(J,{key:0,"line-clamp":1,class:"text-center mt-2 text-red-600"},{default:C(()=>[D(v(g.requirement.rejection_reason),1)]),_:1})):(n(),j(J,{key:1,"line-clamp":1,class:"text-center mt-2"},{default:C(()=>[D(v(t.value.approval_note),1)]),_:1}))]),e("div",null,[!t.value.is_rejected&&!t.value.approved&&f.value&&((o=Y(b).user)==null?void 0:o.id)==((k=(c=t.value)==null?void 0:c.department_user)==null?void 0:k.id)?(n(),j(it,{key:0,class:"ml-auto z-[5000000]",notificationType:"pending-requirements",applicationId:(T=a.requirement)==null?void 0:T.id,onSuccess:y,variant:1},null,8,["applicationId"])):u("",!0)]),r[2]||(r[2]=e("hr",{class:"my-2 border-gray-600 w-40 md:w-48 lg:w-64"},null,-1)),e("div",Cs,[e("span",null,v((($=t.value.department)==null?void 0:$.short_name)||((A=t.value.department)==null?void 0:A.name)),1),e("span",Ts,v(t.value.userType),1),t.value.department_user?(n(),l(U,{key:0},[t.value.is_rejected?(n(),l("span",Rs," (Rejected)")):t.value.approved?(n(),l("span",Ss,"(✔)")):(n(),l("span",js,r[1]||(r[1]=[e("i",{class:"fad fa-spinner"},null,-1)])))],64)):u("",!0)])])}}},Is={class:"container mx-auto print:p-0 w-full print:max-w-full"},As={class:"border-b px-4 py-2 bg-gray-50 flex items-center justify-between rounded-t-md"},Ns={key:0},Ds={class:"border table-auto w-full"},Ls={class:"border-y px-4 py-1"},Os={class:"border-y px-4 py-1"},Bs={class:"border-y px-4 py-1 text-center"},Es={class:"border-y px-4 py-1 text-center"},Vs={class:"print:shadow-none print:p-0 relative min-h-[50vh] mx-4"},Us={key:0,class:"grid grid-cols-12 gap-x-4 gap-y-3"},Ms={class:"col-span-full md:col-span-8 xl:col-span-8 2xl:col-span-9 row-span-10 bg-white shadow rounded-lg p-6"},Fs={class:"text-center text-xl font-bold mb-2 flex items-center"},Ps={class:"mb-8"},zs={class:"text-lg font-semibold mb-2"},Hs={class:"flex gap-4 items-center text-gray-500"},Gs={class:"text-sm"},Ws={key:0,class:"flex items-center gap-1"},Qs={key:0,class:"mb-5"},Ks=["innerHTML"],Ys={class:"mb-8"},Js={class:"font-semibold text-lg px-2"},Xs={class:"w-full border rounded-lg border-gray-300 overflow-y-auto"},Zs={class:"w-full border-collapse"},er={key:0},tr={class:"mb-8"},sr={class:"font-semibold text-lg px-2"},rr={key:0},nr=["innerHTML"],ar={key:1,class:"text-center my-2 text-gray-400"};const lr={key:1,class:"mt-8 border rounded-md p-8 flex items-start justify-between bg-gray-50 print:hidden"},ir={class:"flex flex-col items-end"},or={key:2,class:"mt-6 mb-8 break-before-avoid-page"},ur={class:"whitespace-nowrap border-gray-200 grid grid-cols-1 lg:grid-cols-2 items-stretch"},dr={key:0,class:"whitespace-nowrap border-gray-200 grid grid-cols-1 lg:grid-cols-2 gap-2 items-stretch"},mr={class:"bg-white shadow rounded-lg space-y-4 p-4"},cr={class:"border col-span-3 p-3 rounded-md"},pr={class:"flex items-center gap-2 mb-4"},vr={class:"flex items-center gap-x-3 gap-y-2 flex-wrap"},fr={class:"flex items-center gap-2 mb-4"},br={class:"mb-4 flex items-center justify-between gap-1 print:mb-1"},xr={class:"font-bold print:text-gray-900"},yr={key:0,class:"mb-3 flex items-start gap-3 print:mb-1"},gr={class:"flex items-center gap-2 print:text-gray-900 flex-wrap"},_r={key:1,class:"mb-3 flex items-center justify-between gap-3 print:mb-1"},kr={class:"print:text-gray-900 text-sm text-right"},hr={key:2,class:"mb-3 flex items-center justify-between gap-3 print:mb-1"},wr={class:"print:text-gray-900 text-sm text-right"},qr={class:"flex justify-between items-center mb-4"},$r={class:"mb-6"},Cr={class:"flex justify-between items-center"},Tr={key:1,class:"text-red-600"},Rr={key:0,class:"mb-2"},Sr={class:"flex justify-end text-sky-500"},jr={key:1,class:"text-right w-full mb-4"},Ir={key:2,class:"mb-6"},Ar={class:"flex justify-between items-center"},Nr={key:3,class:"text-center mb-4 text-red-700 mt-8 text-sm"},Dr={key:5,class:"print:hidden flex gap-2 items-center justify-between w-full text-sm"},gn={__name:"RequirementShow",setup(g){const R=Pe(),a=ze(),d=_(""),b=Ve(),p=_(),m=_(!1),f=_(),t=_(null),y=ne({detail:null,open:!1}),i=ne({detail:null,open:!1}),r=ne({detail:null,open:!1}),o=_(!1),c=()=>o.value=!0,k=()=>o.value=!1,T=_(),$=_({isOpen:!1,taskId:null});ae(async()=>{await h(),window.addEventListener("beforeprint",c),window.addEventListener("afterprint",k),window.addEventListener("resize",A),await Me(),lt(p.value,()=>{})});function A(){}Ue(()=>{window.removeEventListener("beforeprint",c),window.removeEventListener("afterprint",k),window.removeEventListener("resize",A)});async function h(){var L;d.value="loading",t.value=(L=(await ue(R.params.id)).data)==null?void 0:L.requirement,d.value=""}function S(){var L,s,G,P,z,X,Z,ee,te;if(b.user.role!=="super_admin"&&((L=b.user)==null?void 0:L.id)!==((G=(s=t.value)==null?void 0:s.to_department)==null?void 0:G.incharge_id))return alert(`You can't create or assign task for this requirement. 
Only ${(z=(P=t.value)==null?void 0:P.to_department)==null?void 0:z.name}'s In charge can create or assign.`);console.log({requirement:t}),w.modalShown=!0,w.from_department_id=t.value.from_department_id,w.to_department_id=t.value.to_department_id,w.taskDefaultValues={title:"",description:"",from_department_id:t.value.from_department_id,to_department_id:t.value.to_department_id,is_important:((X=t.value)==null?void 0:X.priority)=="IMPORTANT",is_urgent:((Z=t.value)==null?void 0:Z.priority)=="URGENT",supervisor_ids:(ee=t.value)!=null&&ee.supervisor_id?[(te=t.value)==null?void 0:te.supervisor_id]:[]},w.requirement=t.value}function N(L){y.open=!0,y.detail=L}function le(L){r.open=!0,r.detail=L}const w=ne({modalShown:!1,requirementId:0,taskDefaultValues:{},requirement:null,creating:!1});async function W(){T.value=null,w.modalShown=!1,await h()}async function Q(){w.modalShown=!1,w.requirement=null,w.creating=!1}const F=_({open:!1});return(L,s)=>{var P,z,X,Z,ee,te,me,ce,pe,ve,fe,be,xe,ye,ge,_e,ke,he,we,qe,$e,Ce,Te,Re,Se,je,Ie,Ae;const G=Le("RouterLink");return n(),l("div",Is,[i.open?(n(),j(H,{key:0},{default:C(()=>{var x;return[q(ds,{requirementId:t.value.id,detailId:(x=i.requirement.value)==null?void 0:x.id,onCloseClick:s[0]||(s[0]=B=>i.open=!1),onUpdate:s[1]||(s[1]=async()=>{i.open=!1,await h()})},null,8,["requirementId","detailId"])]}),_:1})):u("",!0),r.open?(n(),j(H,{key:1},{default:C(()=>{var x;return[q(ts,{requirementId:t.value.id,detailId:(x=r.requirement.value)==null?void 0:x.id,onCloseClick:s[2]||(s[2]=B=>r.open=!1),onDelete:s[3]||(s[3]=async()=>{r.open=!1,await h()})},null,8,["requirementId","detailId"])]}),_:1})):u("",!0),w.modalShown?(n(),j(H,{key:2,class:"*:relative"},{default:C(()=>{var x,B;return[e("button",{onClick:I(Q,["prevent"]),class:"absolute right-3 top-2 text-xl text-red-500 hover:text-red-400"},s[20]||(s[20]=[e("i",{class:"fas fa-times-circle"},null,-1)])),w!=null&&w.creating?u("",!0):(n(),j(ks,{key:0,"from-department-id":(x=t.value)==null?void 0:x.from_department_id,requirement:w==null?void 0:w.requirement,onCancelClick:Q,onAddNewTaskClick:s[4]||(s[4]=()=>{w.modalShown=!0,w.creating=!0}),onAssignTask:W},null,8,["from-department-id","requirement"])),w!=null&&w.creating?(n(),j(st,{key:1,requirementDetailId:(B=w==null?void 0:w.requirement.value)==null?void 0:B.id,requirementId:t.value.id,onClose:Q,onTaskCreated:W,defaultValues:w.taskDefaultValues,readonlyFields:{from_department_id:!0,to_department_id:!0}},null,8,["requirementDetailId","requirementId","defaultValues"])):u("",!0)]}),_:1})):u("",!0),T.value?(n(),j(H,{key:3},{default:C(()=>[q(rt,{taskId:T.value,onClose:s[5]||(s[5]=x=>T.value=null),onUpdated:W},null,8,["taskId"])]),_:1})):u("",!0),$.value.isOpen?(n(),j(H,{key:4,class:"*:max-w-4xl"},{default:C(()=>[q(Xe,{taskId:$.value.taskId,onCancelClick:s[6]||(s[6]=()=>{$.value.isOpen=!1,$.value.taskId=0}),onSuccess:s[7]||(s[7]=()=>{$.value.isOpen=!1,$.value.taskId=0,d.value="loading",h()})},null,8,["taskId"])]),_:1})):u("",!0),F.value.open?(n(),j(H,{key:5},{default:C(()=>[q(Mt,{requirement:t.value,onClickCancel:s[8]||(s[8]=x=>F.value.open=!1),onUpdateStatus:s[9]||(s[9]=()=>{h(),F.value.open=!1})},null,8,["requirement"])]),_:1})):u("",!0),m.value?(n(),j(H,{key:6},{default:C(()=>{var x,B,V,se;return[e("div",As,[s[22]||(s[22]=e("h3",{class:"text-xl font-semibold"},"Closing History",-1)),e("button",{class:"btn-icon",onClick:s[10]||(s[10]=I(O=>m.value=!1,["prevent"]))},s[21]||(s[21]=[e("i",{class:"fas fa-times"},null,-1)]))]),(x=t.value)!=null&&x.closing_history&&((V=(B=t.value)==null?void 0:B.closing_history)!=null&&V.length)?(n(),l("div",Ns,[e("table",Ds,[s[23]||(s[23]=e("thead",null,[e("tr",null,[e("th",{class:"border-y py-1 text-sm px-4 text-left"},"Closed AT"),e("th",{class:"border-y py-1 text-sm px-4 text-left"},"Note"),e("th",{class:"border-y py-1 text-sm px-4 text-center"},"Status"),e("th",{class:"border-y py-1 text-sm px-4 text-center"},"Close/Open")])],-1)),e("tbody",null,[(n(!0),l(U,null,K(((se=t.value)==null?void 0:se.closing_history)||[],O=>(n(),l("tr",{key:O.at},[e("td",Ls,v(O.at?Y(oe)(O.at):""),1),e("td",Os,v(O==null?void 0:O.closing_note),1),e("td",Bs,v(O==null?void 0:O.status),1),e("td",Es,v(O==null?void 0:O.type),1)]))),128))])])])):u("",!0)]}),_:1})):u("",!0),e("div",Vs,[t.value?(n(),l("div",Us,[e("div",Ms,[e("div",Fs,[e("button",{class:"btn-3 h-8 px-4",onClick:s[11]||(s[11]=I(()=>Y(a).back(),["prevent"]))},"Back"),s[24]||(s[24]=e("div",{class:"text-2xl ml-4"},"Requirement Form",-1))]),s[38]||(s[38]=e("hr",{class:"mb-4"},null,-1)),e("div",null,[e("div",Ps,[e("div",null,[e("div",zs,[q(J,{"line-clamp":"3",class:"mb-2"},{default:C(()=>[D(v(t.value.title),1)]),btnText:C(({lineClampClass:x})=>[D(v(x?"More":"Less"),1)]),_:1}),e("div",Hs,[e("div",Gs,[s[25]||(s[25]=e("span",{class:"fas fa-calendar text-sm text-gray-400"},null,-1)),D(" "+v(Y(oe)(t.value.created_at)),1)]),t.value.created_by?(n(),l("div",Ws,[s[26]||(s[26]=e("span",{class:"text-gray-400 text-sm"},"By",-1)),q(re,{"avatar-size":"xsmall",user:t.value.created_by,class:"border-sky-300"},null,8,["user"])])):u("",!0)])]),t.value.description?(n(),l("div",Qs,[s[27]||(s[27]=e("div",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Description",-1)),q(J,{"line-clamp":4,"class-name":{button:"group-hover/item:underline"},class:"text-sm"},{default:C(()=>[e("p",{innerHTML:t.value.description,class:"text-justify"},null,8,Ks)]),_:1})])):u("",!0)])]),e("div",Ys,[q(ie,{class:"mb-4"},{default:C(()=>[e("h2",Js,[s[28]||(s[28]=e("span",null,"Task List ",-1)),t.value.status=="approved"?(n(),l("span",{key:0,class:E(["whitespace-nowrap mt-4",[{"text-green-700 font-semibold":t.value.tasks_count>0&&t.value.completed_tasks_count==t.value.tasks_count,"text-red-700 font-semibold":t.value.tasks_count==0||t.value.completed_tasks_count!=t.value.tasks_count}]])}," ("+v(t.value.completed_tasks_count)+"/"+v(t.value.tasks_count)+" task(s) done) ",3)):u("",!0)])]),_:1}),e("div",Xs,[e("table",Zs,[s[30]||(s[30]=e("thead",null,[e("tr",null,[e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"SL"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Task"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Assigns"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Deadline"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400 sticky right-0 bg-gray-50"}," Status ")])],-1)),e("tbody",null,[d.value!="loading"&&((z=(P=t.value)==null?void 0:P.tasks)==null?void 0:z.length)===0?(n(),l("tr",er,s[29]||(s[29]=[e("td",{class:"py-4 px-3 border-t text-center text-gray-400 text-sm",colspan:"10"}," No Task ",-1)]))):(n(!0),l(U,{key:1},K(((X=t.value)==null?void 0:X.tasks)||[],(x,B)=>(n(),j(nt,{key:x.id,task:x,indexing:B+1,class:"*:py-3 *:border-b-0",onEditClick:s[12]||(s[12]=V=>T.value=V),onEmployeeAssignClick:s[13]||(s[13]=V=>{$.value.isOpen=!0,$.value.taskId=V})},null,8,["task","indexing"]))),128))])])])]),e("div",tr,[q(ie,{class:"mb-4"},{default:C(()=>{var x,B,V,se;return[e("h2",sr," '"+v(((B=(x=t.value)==null?void 0:x.to_department)==null?void 0:B.short_name)||((se=(V=t.value)==null?void 0:V.to_department)==null?void 0:se.name))+"' Feedback ",1)]}),_:1}),e("div",{class:E(["px-3 border border-dashed rounded-lg border-sky-600",[(Z=t.value)!=null&&Z.feedback?"py-3":"py-8"]]),colspan:"5"},[d.value!="loading"&&((ee=t.value)!=null&&ee.status)?(n(),l("div",rr,[String(((te=t.value)==null?void 0:te.feedback)||"").trim().length>0?(n(),j(J,{key:0,lineClamp:"2",className:{button:"  underline"},class:"mb-4 print:mb-0"},{default:C(()=>{var x;return[e("p",{class:"text-sm text-justify",innerHTML:(x=t.value)==null?void 0:x.feedback},null,8,nr)]}),_:1})):(n(),l("div",ar,"No Feedback")),e("div",{class:E([((me=t.value)!=null&&me.feedback,"w-full flex justify-center")])},[t.value.closed_at?u("",!0):(n(),l("button",{key:0,class:"btn-3 print:hidden",onClick:s[14]||(s[14]=I(()=>{i.open=!0,i.requirement=t.value},["prevent"]))},v(t.value.feedback?"Update Feedback":"Add feedback"),1))],2)])):u("",!0)],2)]),(t.value,u("",!0)),d.value!="loading"&&!((ce=t.value)!=null&&ce.status)?(n(),l("div",lr,[e("div",ir,[q(ys,{"requirement-id":(pe=t.value)==null?void 0:pe.id,onSuccess:h},{heading:C(()=>s[34]||(s[34]=[D(" Requirement Submission ")])),acceptButtonLabel:C(()=>s[35]||(s[35]=[e("span",{class:"btn-2 pl-2 text-base"},[e("i",{class:"fad fa-paper-plane text-lg mr-2"}),D("Submit Requirement ")],-1)])),submitButtonLabel:C(()=>s[36]||(s[36]=[D(" Submit Requirement ")])),_:1},8,["requirement-id"])])])):u("",!0),(ve=t.value)!=null&&ve.status?(n(),l("div",or,[q(ie,null,{default:C(()=>s[37]||(s[37]=[e("h2",{class:"font-semibold text-lg px-2"},"Approvals",-1)])),_:1,__:[37]}),e("div",ur,[(n(),l(U,null,K(["from_in_charge","from_coordinator"],x=>q(De,{class:"pt-12",key:x,requirement:t.value,"approval-type":x,onUpdateApproval:s[15]||(s[15]=()=>h())},null,8,["requirement","approval-type"])),64))]),((fe=t.value)==null?void 0:fe.from_department_id)!==((be=t.value)==null?void 0:be.to_department_id)?(n(),l("div",dr,[(n(),l(U,null,K(["to_in_charge","to_coordinator"],x=>q(De,{class:"pt-12",key:x,requirement:t.value,"approval-type":x,onUpdateApproval:s[16]||(s[16]=()=>h())},null,8,["requirement","approval-type"])),64))])):u("",!0)])):u("",!0)])]),e("div",{class:"col-span-full md:col-span-4 xl:col-span-4 2xl:col-span-3 sticky top-[74px] break-before-avoid-page",ref_key:"sidebarTop",ref:p},[e("div",mr,[e("div",cr,[e("div",null,[e("div",pr,[s[39]||(s[39]=e("div",{class:"text-gray-500 text-sm"},"From",-1)),q(Ne,{department:(xe=t.value)==null?void 0:xe.from_department,"short-name":!0},null,8,["department"])]),s[40]||(s[40]=e("div",{class:"text-gray-600 text-sm mb-2 border-b border-dashed"},"Supervisor",-1)),e("div",vr,[(ye=t.value)!=null&&ye.supervisor?(n(),j(re,{key:0,user:(ge=t.value)==null?void 0:ge.supervisor},null,8,["user"])):u("",!0)])]),s[42]||(s[42]=e("hr",{class:"my-4"},null,-1)),e("div",null,[e("div",fr,[s[41]||(s[41]=e("div",{class:"text-gray-500 text-sm"},"To",-1)),q(Ne,{department:(_e=t.value)==null?void 0:_e.to_department,"short-name":!0},null,8,["department"])])])]),e("div",br,[s[43]||(s[43]=e("div",{class:"text-gray-500 text-sm"},"Requirement ID:",-1)),e("div",xr,v((ke=t.value)==null?void 0:ke.id),1)]),((we=(he=t.value)==null?void 0:he.website_tags)==null?void 0:we.length)>0?(n(),l("div",yr,[s[44]||(s[44]=e("div",{class:"text-gray-500 text-sm"},"Website",-1)),e("div",gr,[(n(!0),l(U,null,K(((qe=t.value)==null?void 0:qe.website_tags)||[],x=>(n(),l("div",{key:x.id,class:"border px-1 rounded-md bg-sky-100 border-sky-400 text-sky-700 whitespace-nowrap text-xs"},v(x.name),1))),128))])])):u("",!0),($e=t.value)!=null&&$e.submission_date?(n(),l("div",_r,[s[45]||(s[45]=e("div",{class:"text-gray-500 text-sm"},"Submission Date",-1)),e("div",kr,v(Y(oe)((Ce=t.value)==null?void 0:Ce.submission_date)),1)])):u("",!0),(Te=t.value)!=null&&Te.better_to_complete_on?(n(),l("div",hr,[s[46]||(s[46]=e("div",{class:"text-gray-500 text-sm"},"Better To Complete",-1)),e("div",wr,v(Y(at)((Re=t.value)==null?void 0:Re.better_to_complete_on,{weekDay:"long"})),1)])):u("",!0),e("div",null,[e("div",qr,[s[47]||(s[47]=e("span",{class:"text-gray-500 text-sm"},"Priority:",-1)),e("div",null,[e("span",{class:E(["font-semibold text-sm",{"text-yellow-600 ":t.value.priority=="IMPORTANT","text-red-700 ":t.value.priority=="URGENT"}])},v(t.value.priority||"NORMAL"),3)])]),e("div",$r,[e("div",Cr,[s[48]||(s[48]=e("span",{class:"text-gray-500 text-sm"},"Status:",-1)),t.value.status?(n(),l("span",{key:0,class:E(["border rounded-lg px-2 text-sm py-0.5",{"bg-red-300 text-red-700 border-red-400":t.value.status!="approved","bg-green-300 text-green-700 border-green-400":t.value.status=="approved"}])},v(String(t.value.status).toUpperCase()),3)):(n(),l("span",Tr,"..."))])]),t.value.closed_at?u("",!0):(n(),l("div",Rr,[e("div",Sr,[e("button",{class:"btn-1 border border-sky-800",onClick:s[17]||(s[17]=I(x=>F.value.open=!0,["prevent"]))}," Close Requirement ")])])),((je=(Se=t.value)==null?void 0:Se.closing_history)==null?void 0:je.length)>1?(n(),l("div",jr,[e("button",{onClick:s[18]||(s[18]=x=>m.value=!m.value),class:"text-sm text-sky-400 hover:underline"}," Show Closing History ")])):u("",!0),t.value.rejected_by?(n(),l("div",Ir,[e("div",Ar,[s[49]||(s[49]=e("span",{class:"text-gray-500 text-sm"},"Rejected By:",-1)),q(re,{user:t.value.rejected_by},null,8,["user"])])])):u("",!0),t.value.rejection_reason?(n(),l("div",Nr,[s[50]||(s[50]=e("p",{class:"text-gray-600 mb-1 italic"},"Reason",-1)),e("p",null,v(t.value.rejection_reason),1)])):u("",!0),s[53]||(s[53]=e("hr",{class:"mb-3"},null,-1)),(Ie=t.value)!=null&&Ie.closed_at?(n(),j(St,{key:4,requirement:t.value,onReOpenClick:s[19]||(s[19]=x=>F.value.open=!0)},null,8,["requirement"])):(n(),l("div",Dr,[t.value.status=="approved"?(n(),l("button",{key:0,class:"btn-3 font-semibold h-8 !pl-2 !pr-4",onClick:I(S,["prevent"])},s[51]||(s[51]=[e("i",{class:"fas fa-plus text-sm"},null,-1),D(" Add/Assign Task ")]))):u("",!0),q(G,{class:"btn-2 h-8",to:`/requirements/edit/${(Ae=t.value)==null?void 0:Ae.id}`},{default:C(()=>s[52]||(s[52]=[D(" Edit ")])),_:1,__:[52]},8,["to"])]))])]),q(_t,{requirement:t.value,class:"mt-4 md:col-span-4 xl:col-span-4 2xl:col-span-3"},null,8,["requirement"]),q(He,{class:"mt-4 md:col-span-4 xl:col-span-4 2xl:col-span-3",ref_key:"shareComponent",ref:f},null,512)],512)])):u("",!0),d.value==="loading"?(n(),j(de,{key:1,class:"absolute inset-0 bg-opacity-90"})):u("",!0)])])}}};export{gn as default};
