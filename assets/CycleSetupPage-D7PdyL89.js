import{u as y,h as m,x as _,c as n,o as i,a as t,j as v,F as h,e as b,t as r,s as f}from"./index-I6EODA-h.js";import{u as k}from"./kpiCycleAdmin-BdXCzmow.js";const C={class:"max-w-6xl mx-auto p-4 space-y-5"},w={class:"flex items-center justify-between"},g={class:"rounded-2xl border overflow-hidden bg-white"},$={class:"w-full text-sm"},A={class:"px-3 py-2"},N={class:"px-3 py-2 text-center"},D={class:"px-3 py-2 text-center capitalize"},T={class:"px-3 py-2 text-right"},B=["onClick"],R=["onClick"],S=["onClick"],j=["onClick"],z=["onClick"],E={key:0},P={__name:"CycleSetupPage",setup(F){const a=k();y(),m(()=>a.fetchAll());const c=_(()=>(a.list||[]).map(e=>({...e,statusText:typeof e.is_active=="boolean"?e.is_active?"Active":"Inactive":e.status??"draft"})));async function d(e){await a.activate(e.id)}async function p(e){a.deactivate&&await a.deactivate(e.id)}async function u(e){const o=Number(e.year)+1;await a.clone(e.id,o)}async function x(e){confirm("Delete this cycle? (Only if no reviews)")&&await a.remove(e.id)}return(e,o)=>(i(),n("div",C,[t("header",w,[o[1]||(o[1]=t("h1",{class:"text-xl font-semibold"},"KPI Cycles",-1)),t("button",{class:"px-4 py-2 rounded-xl bg-slate-900 text-white",onClick:o[0]||(o[0]=s=>e.$router.push({name:"kpi-cycle-new"}))}," + New Cycle ")]),t("div",g,[t("table",$,[o[3]||(o[3]=t("thead",{class:"bg-slate-50"},[t("tr",null,[t("th",{class:"text-left px-3 py-2"},"Title"),t("th",{class:"text-center px-3 py-2"},"Year"),t("th",{class:"text-center px-3 py-2"},"Status"),t("th",{class:"text-right px-3 py-2 w-64"},"Actions")])],-1)),t("tbody",null,[(i(!0),n(h,null,b(c.value,s=>(i(),n("tr",{key:s.id,class:"border-t"},[t("td",A,r(s.title),1),t("td",N,r(s.year),1),t("td",D,[t("span",{class:f(["px-2 py-0.5 text-xs rounded-full",s.statusText==="Active"?"bg-emerald-100 text-emerald-700":"bg-slate-100 text-slate-700"])},r(s.statusText),3)]),t("td",T,[t("button",{class:"px-2 py-1 text-xs border rounded mr-2",onClick:l=>e.$router.push({name:"kpi-cycle-edit",params:{id:s.id}})},"Edit",8,B),t("button",{class:"px-2 py-1 text-xs border rounded mr-2",onClick:l=>u(s)},"Clone",8,R),s.is_active||s.status==="active"?(i(),n("button",{key:0,class:"px-2 py-1 text-xs border rounded mr-2",onClick:l=>p(s)}," Deactivate ",8,S)):(i(),n("button",{key:1,class:"px-2 py-1 text-xs border rounded mr-2",onClick:l=>d(s)}," Activate ",8,j)),t("button",{class:"px-2 py-1 text-xs border rounded",onClick:l=>x(s)},"Delete",8,z)])]))),128)),c.value.length?v("",!0):(i(),n("tr",E,o[2]||(o[2]=[t("td",{colspan:"4",class:"px-3 py-10 text-center text-slate-500"}," No cycles yet. Create a new one. ",-1)])))])])])]))}};export{P as default};
