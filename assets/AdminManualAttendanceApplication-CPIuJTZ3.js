import{u as te,b as le,r as b,e as se,z as A,m as oe,c as d,o as i,a as t,p as G,k as u,h as m,v as f,g as V,j as p,t as c,F as re,q as ae,x as ne,K as I,w as g,B as de}from"./index-CCrG_n-q.js";import{_ as ie}from"./EmployeeFilter-BbNpVcwd.js";import{L as ue}from"./LoaderView-CX-aCsTc.js";import{u as pe}from"./manual-attendance-P2TlTdhY.js";import{u as ce}from"./user-BiLA73w9.js";import"./MultiselectDropdown-BOcwAGR_.js";import"./company-Ba-B11jo.js";import"./department-CN55QLN8.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ye={class:"space-y-2 px-4"},me={class:"flex items-center justify-between gap-2"},ve={class:"flex flex-wrap gap-2"},be={key:0,class:"text-center py-4"},ge={key:1,class:"space-y-4"},_e={key:0,class:"bg-sky-100/30 p-4 rounded-lg shadow mb-6 space-y-4"},ke={class:"grid gap-6"},he={class:"bg-white border rounded-lg p-4 shadow"},xe={class:"grid grid-cols-2 sm:grid-cols-4 gap-y-1 text-sm text-gray-600"},fe={class:"overflow-x-auto"},we={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Ce={class:"bg-gray-200"},Ve={class:"border border-gray-300 px-2 text-left py-2"},Ue={class:"flex items-center justify-center gap-2"},Ae=["onClick"],Me={class:"border border-gray-300 px-2 cursor-pointer text-center"},Se=["onUpdate:modelValue"],qe={class:"border border-gray-300 px-2"},Be=["onUpdate:modelValue"],Fe={class:"border border-gray-300 px-2"},De=["onUpdate:modelValue"],Pe={class:"border border-gray-300 px-2"},je=["onUpdate:modelValue"],Ne={class:"border border-gray-300 px-2"},$e=["onUpdate:modelValue"],Ee={class:"border border-gray-300 px-2"},Le=["onUpdate:modelValue","disabled"],Re={key:0},Te={key:1},Oe={class:"space-y-6"},ze={key:0,class:"text-red-500 text-sm text-left"},He={class:"flex items-center justify-center gap-2 cursor-pointer"},Ke={class:"flex justify-center"},We=["disabled"],Ge={key:0},Ie={key:1},rt={__name:"AdminManualAttendanceApplication",setup(Je){const J=te(),v=le(),o=pe(),M=ce(),Q=b(null),x=b(v.query.date||o.selectedMonth),_=b([]),y=b(!1),k=b(null),U=b(!0),a=b({company_id:v.query.company_id||"",department_id:v.query.department_id||"all",type:v.query.type||"all",employee_id:v.query.employee_id||"",category:""}),w=async()=>{const s={company_id:a.value.company_id,department_id:a.value.department_id,selectedMonth:x.value,selectedStatus:o.selectedStatus};a.value.employee_id?(s.user_id=a.value.employee_id,y.value=!0,await o.fetchAdminManualAttendances(s),y.value=!1):o.manualAttendances.value=[]};se(async()=>{await M.fetchUsers(),Q.value=M.users.find(s=>s.id==a.value.employee_id)||null,await w()}),A(()=>[a.value.company_id,a.value.department_id,a.value.employee_id,x.value],async()=>{await w()}),A(x,s=>{J.replace({query:{...v.query,date:s}})});const X=oe(()=>o.attendances||[]);A(()=>o.attendances,s=>{_.value=[],s==null||s.forEach(e=>{_.value.push({date:e==null?void 0:e.date,type:"Forget Punch",check_in:e==null?void 0:e.entry_time,check_out:e==null?void 0:e.exit_time,description:"",is_check:!1})})},{immediate:!0,deep:!0});const Y=()=>{const s=_.value.every(e=>e.is_check);_.value.forEach(e=>{e.is_check=!s})},Z=async()=>{var s;if(y.value=!0,k.value=null,!a.value.employee_id){k.value="Please select an employee.",y.value=!1;return}try{const e=_.value.filter(r=>r.is_check&&(r.check_in||r.check_out));if(e.length===0){k.value="Please select at least one row.",y.value=!1;return}const C=e.map(r=>({user_id:a.value.employee_id,type:r.type,check_in:r.check_in?`${r.date} ${r.check_in}:00`:null,check_out:r.check_out?`${r.date} ${r.check_out}:00`:null,description:r.description||""})),h=await o.createBulkManualAttendance({records:C,direct_approve:U.value});(s=h==null?void 0:h.data)!=null&&s.length&&await w()}catch(e){k.value=e.message||"Failed to submit manual attendance requests."}finally{y.value=!1}};return(s,e)=>{var C,h,r,S,q,B,F,D,P,j,N,$,E,L,R,T,O,z,H,K,W;return i(),d("div",ye,[t("div",me,[t("button",{class:"btn-3",onClick:e[0]||(e[0]=(...l)=>s.goBack&&s.goBack(...l))},e[11]||(e[11]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[12]||(e[12]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Leave Applications",-1)),e[13]||(e[13]=t("div",null,null,-1))]),t("div",ve,[G(ie,{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value=l),"initial-value":u(v).query,onFilterChange:s.handleFilterChange},null,8,["modelValue","initial-value","onFilterChange"]),t("div",null,[m(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":e[2]||(e[2]=l=>x.value=l),onChange:w,class:"input-1"},null,544),[[f,x.value]])])]),u(o).loading?(i(),d("div",be,[G(ue)])):(i(),d("div",ge,[(C=a.value)!=null&&C.employee_id?(i(),d("div",_e,[t("div",ke,[t("div",he,[t("div",xe,[t("p",null,[e[14]||(e[14]=t("strong",null,"Name:",-1)),p(" "+c((r=(h=u(o))==null?void 0:h.user)==null?void 0:r.name),1)]),t("p",null,[e[15]||(e[15]=t("strong",null,"Data:",-1)),p(" "+c((B=(q=(S=u(o))==null?void 0:S.user)==null?void 0:q.designation)==null?void 0:B.title),1)]),t("p",null,[e[16]||(e[16]=t("strong",null,"Department:",-1)),p(" "+c((P=(D=(F=u(o))==null?void 0:F.user)==null?void 0:D.department)==null?void 0:P.name),1)]),t("p",null,[e[17]||(e[17]=t("strong",null,"Company:",-1)),p(" "+c(($=(N=(j=u(o))==null?void 0:j.user)==null?void 0:N.company)==null?void 0:$.name),1)]),t("p",null,[e[18]||(e[18]=t("strong",null,"Phone:",-1)),p(" "+c((L=(E=u(o))==null?void 0:E.user)==null?void 0:L.phone),1)]),t("p",null,[e[19]||(e[19]=t("strong",null,"Email:",-1)),p(" "+c((T=(R=u(o))==null?void 0:R.user)==null?void 0:T.email),1)]),t("p",null,[e[20]||(e[20]=t("strong",null,"Joining Date:",-1)),p(" "+c((z=(O=u(o))==null?void 0:O.user)==null?void 0:z.joining_date),1)]),t("p",null,[e[21]||(e[21]=t("strong",null,"Blood Group:",-1)),p(" "+c(((K=(H=u(o))==null?void 0:H.user)==null?void 0:K.blood)||"N/A"),1)])])])])])):V("",!0),t("div",fe,[t("table",we,[t("thead",null,[t("tr",Ce,[t("th",Ve,[t("div",Ue,[t("input",{id:"allCheck",type:"checkbox",onChange:Y,class:"h-5 w-5 accent-blue-600 cursor-pointer"},null,32),e[22]||(e[22]=t("label",{for:"allCheck",class:"text-sm cursor-pointer"},"All Check",-1))])]),e[23]||(e[23]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Date",-1)),e[24]||(e[24]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Type",-1)),e[25]||(e[25]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Check-In",-1)),e[26]||(e[26]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Check-Out",-1)),e[27]||(e[27]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Description",-1))])]),t("tbody",null,[(i(!0),d(re,null,ae(_.value,(l,ee)=>(i(),d("tr",{key:ee,class:ne(["border-b border-gray-200 hover:bg-blue-200 cursor-pointer",l.is_check?"bg-yellow-100":""]),onClick:n=>l.is_check=!l.is_check},[t("td",Me,[m(t("input",{type:"checkbox","onUpdate:modelValue":n=>l.is_check=n,class:"h-5 w-5",onClick:e[3]||(e[3]=g(()=>{},["stop"]))},null,8,Se),[[I,l.is_check]])]),t("td",qe,[m(t("input",{type:"date","onUpdate:modelValue":n=>l.date=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[4]||(e[4]=g(()=>{},["stop"])),disabled:""},null,8,Be),[[f,l.date]])]),t("td",Fe,[m(t("select",{"onUpdate:modelValue":n=>l.type=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[5]||(e[5]=g(()=>{},["stop"]))},e[28]||(e[28]=[t("option",{value:""},"Select Type",-1),t("option",{value:"Home Office"},"Home Office",-1),t("option",{value:"Remote Work"},"Remote Work",-1),t("option",{value:"Forget Punch"},"Forget Punch",-1)]),8,De),[[de,l.type]])]),t("td",Pe,[m(t("input",{type:"time","onUpdate:modelValue":n=>l.check_in=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[6]||(e[6]=g(()=>{},["stop"]))},null,8,je),[[f,l.check_in]])]),t("td",Ne,[m(t("input",{type:"time","onUpdate:modelValue":n=>l.check_out=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[7]||(e[7]=g(()=>{},["stop"]))},null,8,$e),[[f,l.check_out]])]),t("td",Ee,[m(t("textarea",{"onUpdate:modelValue":n=>l.description=n,onKeyup:e[8]||(e[8]=g(()=>{},["stop"])),onClick:e[9]||(e[9]=g(()=>{},["stop"])),disabled:!l.check_in&&!l.check_out,class:"w-full border border-gray-600 py-1 px-2 rounded-sm disabled:bg-gray-300 disabled:cursor-not-allowed",cols:"1"},null,40,Le),[[f,l.description]])])],10,Ae))),128)),X.value.length===0?(i(),d("tr",Re,e[29]||(e[29]=[t("td",{colspan:"6",class:"p-2 text-center text-red-500"},"Please select any employee",-1)]))):V("",!0)])])]),(W=a.value)!=null&&W.employee_id?(i(),d("div",Te,[t("div",Oe,[k.value?(i(),d("div",ze,c(k.value),1)):V("",!0),t("div",He,[m(t("input",{id:"directApprove",type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=l=>U.value=l),class:"accent-blue-600 h-6 w-6 cursor-pointer"},null,512),[[I,U.value]]),e[30]||(e[30]=t("label",{for:"directApprove",class:"text-lg cursor-pointer"},"Direct Approve",-1))]),t("div",Ke,[t("button",{type:"button",class:"btn-2",disabled:y.value,onClick:Z},[y.value?(i(),d("span",Ge,e[31]||(e[31]=[t("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),p("Submitting... ")]))):(i(),d("span",Ie,"Submit All"))],8,We)])])])):V("",!0)]))])}}};export{rt as default};
