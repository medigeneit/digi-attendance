import{D as je,f as Ce,x as f,G as Re,r as R,q as Le,h as Ae,c as o,o as a,a as e,d as E,b,t as n,k as W,H as pe,m as U,F as h,e as w,v as Te,j as p,s as q,l as ce,z as _e,T as me}from"./index-Bvm-KyRW.js";import{L as De}from"./LoaderView-Db_02IVU.js";import{_ as Fe}from"./EmployeeFilter-CbGHWlSU.js";import{u as ze}from"./kpi-report-Dx2Af1iW.js";import{_ as Ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./company-Bu-K_KIO.js";import"./department-BfT135Jx.js";import"./EmployeeDropdownInput-DUDVXInx.js";import"./SelectDropdown-CWHybRZm.js";import"./UserChip-CxSVz229.js";const Pe={class:"space-y-4 px-4 print:px-0"},$e={class:"hidden print:block mx-auto text-center mb-3"},Ye={class:"text-sm text-gray-600"},Me={class:"font-medium"},Ve={class:"font-medium"},Ke={class:"flex flex-wrap items-end gap-3 sticky top-0 z-10 bg-white/80 backdrop-blur print:hidden p-2 -mx-2 rounded-xl border border-gray-100"},Ee={class:"w-full flex items-start gap-3"},Ue={class:"flex items-center gap-2"},qe=["disabled"],Ie=["value"],Oe={class:"flex flex-wrap items-center gap-2 w-full"},Be=["value"],Je={key:0,class:"py-10 text-center"},He={key:1,class:"rounded-xl border border-red-200 bg-red-50 p-3 text-red-700",role:"alert"},We={class:"rounded-2xl border border-gray-200 bg-white shadow-sm p-4 print:hidden"},Qe={class:"flex flex-wrap items-start justify-between gap-3"},Xe={class:"text-xs font-semibold uppercase tracking-[0.18em] text-indigo-500"},Ze={class:"mt-1 text-lg font-semibold text-slate-900"},et={class:"mt-1 flex flex-wrap gap-2 text-xs text-slate-600"},tt={class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5"},st={class:"text-slate-900"},lt={class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5"},nt={class:"text-slate-900"},ot={class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5"},at={class:"text-slate-900"},rt={class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5"},it={class:"text-slate-900"},dt={key:0,class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5"},ut={class:"text-slate-900"},pt={class:"text-xs text-slate-500"},ct={class:"space-y-3 md:hidden"},_t={class:"flex items-start justify-between gap-3"},mt={class:"min-w-0"},bt=["title"],yt={class:"mt-0.5 text-[11px] text-slate-500"},xt={key:0},gt={key:1},vt={key:2},ft={key:3},ht={class:"shrink-0"},wt={key:0,class:"mt-2 grid grid-cols-4 gap-2"},kt=["title"],Nt={class:"mt-1 flex flex-col items-center gap-1"},St={class:"mt-3 flex items-center justify-between gap-3"},jt=["onClick"],Ct={key:0,class:"px-3 py-8 text-center text-gray-600"},Rt={class:"hidden md:block overflow-x-auto rounded-2xl border bg-white shadow-sm"},Lt={class:"w-full text-sm"},At={class:"sticky top-0 z-[5] bg-gray-100/95 backdrop-blur"},Tt={class:"text-xs font-semibold text-slate-700"},Dt={class:"sticky left-0 z-[4] border-r bg-inherit px-3 py-2 text-center"},Ft={class:"sticky z-[4] border-r bg-inherit px-3 py-2",style:{left:"3rem"}},zt={class:"max-w-[17rem]"},Gt=["title"],Pt={class:"text-[11px] text-slate-500 truncate"},$t={key:0},Yt={key:1},Mt={key:2},Vt={key:3},Kt={class:"border-r px-3 py-2 text-center"},Et={class:"flex flex-col items-center gap-1"},Ut={class:"border-r px-3 py-2 text-center"},qt={class:"inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5 text-[12px] font-semibold text-slate-700"},It={class:"px-3 py-2"},Ot={class:"space-y-1 text-[11px] text-slate-600"},Bt={class:"mt-2 flex items-center justify-between gap-3"},Jt=["onClick"],Ht={key:0},Wt={class:"relative max-w-2xl w-full rounded-2xl border border-slate-200 bg-white p-5 shadow-xl",role:"dialog","aria-modal":"true","aria-label":"Latest review details"},Qt={class:"flex items-start justify-between gap-4"},Xt={class:"text-lg font-semibold text-slate-900"},Zt={class:"text-xs text-slate-500"},es={key:0},ts={key:1},ss={class:"text-xs text-slate-500"},ls={class:"mt-4 space-y-4 text-slate-700"},ns={class:"rounded-xl border border-slate-200 bg-slate-50 p-4"},os={class:"mt-3 space-y-2 text-xs text-slate-700"},as={key:0},rs={class:"mt-1 text-slate-600"},is={key:1},ds={class:"mt-1 text-slate-600"},us={key:2},ps={class:"mt-1 text-slate-600"},cs={key:3,class:"text-slate-500"},_s={class:"relative max-w-3xl w-full rounded-2xl border border-slate-200 bg-white shadow-xl overflow-hidden",role:"dialog","aria-modal":"true","aria-label":"All reviewer comments"},ms={class:"p-5 border-b border-slate-200 bg-white"},bs={class:"flex items-start justify-between gap-4"},ys={class:"min-w-0"},xs={class:"text-lg font-semibold text-slate-900 truncate"},gs={class:"mt-0.5 text-xs text-slate-500"},vs={key:0},fs={key:1},hs={class:"mt-2 flex flex-wrap gap-2 text-[11px] text-slate-600"},ws={class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5"},ks={class:"text-slate-900"},Ns={class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5"},Ss={class:"text-slate-900"},js={class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5"},Cs={class:"text-slate-900"},Rs={class:"max-h-[75vh] overflow-y-auto p-5 space-y-4"},Ls={key:0,class:"rounded-xl border border-slate-200 bg-slate-50 p-4 text-sm text-slate-600"},As={class:"px-4 py-3 bg-slate-50 border-b border-slate-200 flex flex-wrap items-center justify-between gap-2"},Ts={class:"flex items-center gap-2 min-w-0"},Ds=["title"],Fs={class:"text-[11px] text-slate-500 truncate"},zs={class:"flex flex-wrap gap-2 text-[11px] text-slate-600"},Gs={class:"rounded-full border border-slate-200 bg-white px-2 py-0.5"},Ps={class:"text-slate-900"},$s={class:"rounded-full border border-slate-200 bg-white px-2 py-0.5"},Ys={class:"text-slate-900"},Ms={class:"rounded-full border border-slate-200 bg-white px-2 py-0.5"},Vs={class:"text-slate-900"},Ks={class:"p-4 space-y-3"},Es={class:"flex flex-wrap items-start justify-between gap-2"},Us={class:"min-w-0"},qs={class:"text-sm font-semibold text-slate-900 truncate"},Is={class:"mt-0.5 text-[11px] text-slate-500"},Os={key:0},Bs={class:"flex flex-wrap gap-2"},Js={class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px] font-semibold text-slate-700"},Hs={key:0,class:"rounded-full border border-slate-200 bg-slate-50 px-2 py-0.5 text-[11px] font-semibold text-slate-700"},Ws={class:"mt-3 space-y-2 text-xs text-slate-700"},Qs={key:0},Xs={class:"mt-1 list-disc pl-5 text-slate-600 space-y-1"},Zs={key:1},el={class:"mt-1 list-disc pl-5 text-slate-600 space-y-1"},tl={key:2},sl={class:"mt-1 list-disc pl-5 text-slate-600 space-y-1"},ll={key:3,class:"text-slate-500"},nl={key:0,class:"text-sm text-slate-500"},ol={__name:"YearlyExecutiveKpiReport",setup(al){const Q=ze(),{reports:be,isLoading:X,error:Z}=je(Q),F=Ce(),L=f(()=>({company_id:F.query.company_id??"",department_id:F.query.department_id??"",employee_id:F.query.employee_id??"",line_type:F.query.line_type??"executive"})),m=Re({company_id:L.value.company_id,department_id:L.value.department_id,employee_id:L.value.employee_id,line_type:L.value.line_type}),ee=R(!1),te=new Date().getFullYear(),S=R(Number(F.query.year??te)),se=R([]);function ye(s=2020,t=te+1){const i=[];for(let r=t;r>=s;r--)i.push(r);se.value=i}const j=f(()=>be.value||{}),I=f(()=>{var s;return((s=j.value)==null?void 0:s.cycle)||{}}),le=f(()=>{var s;return((s=j.value)==null?void 0:s.filters)||{}}),k=f(()=>{var t;return[...Array.isArray((t=j.value)==null?void 0:t.lane_definitions)?j.value.lane_definitions:[]].sort((i,r)=>Number(i.rank||0)-Number(r.rank||0))}),$=f(()=>{var s;return((s=j.value)==null?void 0:s.summary)||{}}),xe=f(()=>{var s;return Array.isArray((s=j.value)==null?void 0:s.data)?j.value.data:[]}),Y=f(()=>{var t;if(k.value.length)return k.value.length;const s=Number(((t=I.value)==null?void 0:t.lane_count)??0);return Number.isFinite(s)&&s>0?s:0});function A(s){const t=Number(s);return Number.isFinite(t)?`${Math.round(t)}%`:"0%"}function T(s,t="-"){const i=(s??"").toString().trim();return i||t}function ne(s){if(!s)return null;const t=new Date(s);return Number.isNaN(t.getTime())?null:t.toLocaleDateString()}function ge(){return new Date().toLocaleString()}function ve(){window.print()}function D(s){return!Array.isArray(s)||s.length===0?null:s.join("; ")}function O(s){return Array.isArray(s)?s.map(t=>typeof t=="string"?t.trim():"").filter(t=>t!==""):typeof s=="string"?s.split(/[\r\n;]+/).map(t=>t.trim()).filter(t=>t!==""):[]}function oe(s){var r;const t=Number(((r=s==null?void 0:s.progress)==null?void 0:r.lanes_reviewed)??0),i=Number(Y.value??0);return i?t>=i?"bg-emerald-50 text-emerald-700 border-emerald-200":t>0?"bg-amber-50 text-amber-700 border-amber-200":"bg-rose-50 text-rose-700 border-rose-200":"bg-slate-50 text-slate-600 border-slate-200"}function B(s){var r;const t=Number(((r=s==null?void 0:s.progress)==null?void 0:r.lanes_reviewed)??0),i=Number(Y.value??0);return i?`${t}/${i}`:`${t}`}function fe(s){if(!s)return"No reviews submitted yet";const t=s.reviewer_name||"Latest reviewer",i=s.reviewer_lane?` (${s.reviewer_lane})`:"",r=s.obtained_total??null,c=s.max_total??null,y=Number.isFinite(Number(r))&&Number.isFinite(Number(c))?`${Number(r)}/${Number(c)}`:r!==null?`${r}`:null,v=ne(s.submitted_at),x=[`${t}${i}`];return y&&x.push(y),v&&x.push(v),x.join(" • ")}function M(s,t){var v;const r=(Array.isArray(s==null?void 0:s.lanes)?s.lanes:[]).find(x=>(x==null?void 0:x.key)===t)||null;if(!r)return{text:"-",cls:"bg-slate-50 text-slate-500 border border-slate-200",percentText:"--"};const c=r.submitted_at||r.submittedAt||((v=r.review)==null?void 0:v.submitted_at),g=!!(r.completed??r.is_completed??r.review_submitted??c),y=r.average_marks??0;return g?{text:y,cls:"bg-emerald-50 text-emerald-700 border-emerald-200"}:{text:y,cls:"bg-amber-50 text-amber-700 border-amber-200"}}const ae=f(()=>xe.value.map(s=>{var c,g,y;const t=s.employee||{},i=s.latest_review||null,r=s.comments||{};return{...s,_name:T(t.name),_company:T(t.company,""),_dept:T(t.department,""),_joining:ne(t.joining_date),_type:T(t.type,""),latestReviewSummary:fe(i),latestReviewStrengths:D(i==null?void 0:i.strengths)||null,latestReviewGaps:D(i==null?void 0:i.gaps)||null,latestReviewSuggestions:D(i==null?void 0:i.suggestions)||null,aggregatedStrengthsList:O(r==null?void 0:r.strengths),aggregatedGapsList:O(r==null?void 0:r.gaps),aggregatedSuggestionsList:O(r==null?void 0:r.suggestions),aggregatedStrengths:D(r==null?void 0:r.strengths),aggregatedGaps:D(r==null?void 0:r.gaps),aggregatedSuggestions:D(r==null?void 0:r.suggestions),finalPercent:((c=s==null?void 0:s.kpi_result)==null?void 0:c.final_percent)??((g=s==null?void 0:s.kpi_result)==null?void 0:g.final_percentage)??((y=s==null?void 0:s.kpi_result)==null?void 0:y.final)??null}})),J=R(""),H=R("all"),he=[{value:"all",label:"Any comment"},{value:"strengths",label:"Strengths"},{value:"gaps",label:"Gaps"},{value:"suggestions",label:"Suggestions"}],we=f(()=>J.value.trim().toLowerCase()),ke=f(()=>{const s=we.value;return s?ae.value.filter(t=>{const i=H.value,r=[];return(i==="all"||i==="strengths")&&r.push(t.aggregatedStrengthsList||[]),(i==="all"||i==="gaps")&&r.push(t.aggregatedGapsList||[]),(i==="all"||i==="suggestions")&&r.push(t.aggregatedSuggestionsList||[]),r.some(c=>c.some(g=>g.toLowerCase().includes(s)))}):ae.value}),V=f(()=>ke.value),u=R(null),K=R(!1);function re(s){u.value=s,K.value=!0}function C(){K.value=!1,u.value=null}async function ie(){try{m.company_id&&await Q.fetchYearlyExecutive({year:Number(S.value),company_id:m.company_id||void 0,department_id:m.department_id||void 0,employee_id:m.employee_id||void 0,line_type:m.line_type||void 0})}catch(s){console.error("fetchYearlyExecutive failed:",s)}}function Ne(s={}){m.company_id=s.company_id??"",m.department_id=s.department_id??"",m.employee_id=s.employee_id??"",m.line_type=s.line_type??L.value.line_type??"executive",ee.value=!0,ie()}Le(S,()=>{const s=Number(S.value);!Number.isInteger(s)||s<2e3||s>2100||ee.value&&ie()}),Ae(()=>{ye()});function de(s){if(!s)return null;const t=new Date(s);return Number.isNaN(t.getTime())?null:t.toLocaleString()}const ue=f(()=>{const s=u.value,t=Array.isArray(s==null?void 0:s.lanes)?s.lanes:[],i=new Map(k.value.map(c=>[c.key,Number(c.rank??0)]));return[...t].sort((c,g)=>{const y=i.get(c.key)??9999,v=i.get(g.key)??9999;return y-v}).map(c=>{var v;const y=[...Array.isArray(c.reviewers)?c.reviewers:[]].sort((x,z)=>{const l=new Date(x.submitted_at||x.updated_at||0).getTime();return new Date(z.submitted_at||z.updated_at||0).getTime()-l});return{...c,label:((v=k.value.find(x=>x.key===c.key))==null?void 0:v.label)||c.key,reviewers:y}})});return(s,t)=>{var i,r,c,g,y,v,x,z;return a(),o("div",Pe,[e("div",$e,[t[10]||(t[10]=e("h1",{class:"text-xl font-semibold text-gray-900"},"Yearly KPI Report",-1)),e("div",Ye,[t[7]||(t[7]=b(" Cycle: ")),e("span",Me,n(((i=I.value)==null?void 0:i.slug)||"-"),1),t[8]||(t[8]=b(" • Year: ")),e("span",Ve,n(S.value),1),t[9]||(t[9]=b(" • Generated: ")),e("span",null,n(ge()),1)])]),e("div",Ke,[e("div",Ee,[E(Fe,{company_id:m.company_id,"onUpdate:company_id":t[0]||(t[0]=l=>m.company_id=l),department_id:m.department_id,"onUpdate:department_id":t[1]||(t[1]=l=>m.department_id=l),employee_id:m.employee_id,"onUpdate:employee_id":t[2]||(t[2]=l=>m.employee_id=l),line_type:m.line_type,"onUpdate:line_type":t[3]||(t[3]=l=>m.line_type=l),"initial-value":L.value,class:"w-full",onFilterChange:Ne},null,8,["company_id","department_id","employee_id","line_type","initial-value"]),e("div",Ue,[W(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>S.value=l),class:"w-32 rounded-lg border border-gray-300 bg-white px-2 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-sky-400/50 disabled:opacity-60",disabled:U(X),"aria-label":"Select year"},[(a(!0),o(h,null,w(se.value,l=>(a(),o("option",{key:l,value:l},n(l),9,Ie))),128))],8,qe),[[pe,S.value,void 0,{number:!0}]])]),e("div",{class:"ml-auto flex gap-2"},[e("button",{class:"btn-3 !py-1.5 !px-3",onClick:ve},t[11]||(t[11]=[e("i",{class:"far fa-print mr-1"},null,-1),b(" Print ")]))])]),e("div",Oe,[W(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>J.value=l),type:"search",placeholder:"Search gaps/strengths/suggestions",class:"flex-1 rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-400/50"},null,512),[[Te,J.value]]),W(e("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>H.value=l),class:"rounded-lg border border-gray-300 bg-white px-2 py-1 text-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-400/50"},[(a(),o(h,null,w(he,l=>e("option",{key:l.value,value:l.value},n(l.label),9,Be)),64))],512),[[pe,H.value]])])]),U(X)?(a(),o("div",Je,[E(De)])):U(Z)?(a(),o("div",He,n(U(Z)),1)):(a(),o(h,{key:2},[e("div",We,[e("div",Qe,[e("div",null,[e("div",Xe," KPI Cycle • "+n(T((r=I.value)==null?void 0:r.slug)),1),e("h2",Ze," Year "+n(S.value)+" • "+n(T(m.line_type)),1),e("div",et,[e("span",tt,[t[12]||(t[12]=b(" Employees: ")),e("b",st,n(((c=$.value)==null?void 0:c.total_employees)??0),1)]),e("span",lt,[t[13]||(t[13]=b(" With results: ")),e("b",nt,n(((g=$.value)==null?void 0:g.with_results)??0),1)]),e("span",ot,[t[14]||(t[14]=b(" Avg final: ")),e("b",at,n(A(((y=$.value)==null?void 0:y.avg_final_percent)??0)),1)]),e("span",rt,[t[15]||(t[15]=b(" Completion: ")),e("b",it,n(A(((v=$.value)==null?void 0:v.review_completion_percent)??0)),1)]),Y.value?(a(),o("span",dt,[t[16]||(t[16]=b(" Lanes: ")),e("b",ut,n(Y.value),1)])):p("",!0)])]),e("div",pt,[t[17]||(t[17]=e("div",null,[e("b",{class:"text-slate-700"},"API Filters")],-1)),e("div",null,"line_type: "+n(((x=le.value)==null?void 0:x.line_type)??"-"),1),e("div",null,"submitted_only: "+n((z=le.value)!=null&&z.submitted_only?"true":"false"),1)])])]),e("div",ct,[(a(!0),o(h,null,w(V.value,(l,_)=>{var N;return a(),o("div",{key:"m-"+(((N=l.employee)==null?void 0:N.id)??_),class:"rounded-2xl border border-gray-200 bg-white shadow-sm p-3"},[e("div",_t,[e("div",mt,[e("div",{class:"text-sm font-semibold text-slate-900 truncate",title:l._name},n(_+1)+". "+n(l._name),9,bt),e("div",yt,[l._dept?(a(),o("span",xt,n(l._dept),1)):p("",!0),l._dept&&l._company?(a(),o("span",gt," • ")):p("",!0),l._company?(a(),o("span",vt,n(l._company),1)):p("",!0),l._joining?(a(),o("span",ft," • Joined "+n(l._joining),1)):p("",!0)])]),e("div",ht,[e("span",{class:q(["inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-semibold",oe(l)])},n(B(l)),3)])]),k.value.length?(a(),o("div",wt,[(a(!0),o(h,null,w(k.value,d=>(a(),o("div",{key:"m-lane-"+d.key,class:"rounded-xl border p-2 text-center"},[e("div",{class:"text-[10px] font-medium text-slate-600 truncate",title:d.label},n(d.label),9,kt),e("div",Nt,[e("span",{class:q(["inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-[11px] font-semibold",M(l,d.key).cls])},n(M(l,d.key).text),3)])]))),128))])):p("",!0),e("div",St,[e("button",{type:"button",class:"text-xs font-semibold text-sky-600 hover:text-sky-800",onClick:d=>re(l)}," Open review modal ",8,jt)])])}),128)),V.value.length===0?(a(),o("div",Ct,"No data")):p("",!0)]),e("div",Rt,[e("table",Lt,[e("thead",At,[e("tr",null,[t[18]||(t[18]=e("th",{class:"sticky left-0 z-[6] border-b border-r bg-gray-100/95 px-3 py-2 text-center",style:{"min-width":"3rem",width:"3rem"}}," SL ",-1)),t[19]||(t[19]=e("th",{class:"sticky z-[6] border-b border-r bg-gray-100/95 px-3 py-2 text-left",style:{left:"3rem",minWidth:"18rem",width:"18rem"}}," Employee ",-1)),t[20]||(t[20]=e("th",{class:"border-b border-r px-3 py-2 text-center",style:{"min-width":"7rem"}}," Progress ",-1)),(a(!0),o(h,null,w(k.value,l=>(a(),o("th",{key:"lane-head-"+l.key,class:"border-b border-r px-2 py-2 text-center",style:{"min-width":"6.5rem"}},[e("span",Tt,n(l.label),1)]))),128)),t[21]||(t[21]=e("th",{class:"border-b border-r px-3 py-2 text-center",style:{"min-width":"8rem"}}," Final ",-1)),t[22]||(t[22]=e("th",{class:"border-b px-3 py-2 text-left"}," All comments ",-1))])]),e("tbody",null,[(a(!0),o(h,null,w(V.value,(l,_)=>{var N;return a(),o("tr",{key:"d-"+(((N=l.employee)==null?void 0:N.id)??_),class:"border-t hover:bg-slate-50/80 transition-colors"},[e("td",Dt,n(_+1),1),e("td",Ft,[e("div",zt,[e("div",{class:"font-semibold text-slate-900 truncate",title:l._name},n(l._name),9,Gt),e("div",Pt,[l._dept?(a(),o("span",$t,n(l._dept),1)):p("",!0),l._dept&&l._company?(a(),o("span",Yt," • ")):p("",!0),l._company?(a(),o("span",Mt,n(l._company),1)):p("",!0),l._joining?(a(),o("span",Vt," • Joined "+n(l._joining),1)):p("",!0)])])]),e("td",Kt,[e("span",{class:q(["inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-[12px] font-semibold",oe(l)])},n(B(l)),3)]),(a(!0),o(h,null,w(k.value,d=>(a(),o("td",{key:"lane-"+d.key+"-"+_,class:"border-r px-2 py-2 text-center"},[e("div",Et,[e("span",{class:q(["inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-[11px] font-semibold",M(l,d.key).cls])},n(M(l,d.key).text),3)])]))),128)),e("td",Ut,[e("span",qt,n(l.finalPercent==null?"—":A(l.finalPercent)),1)]),e("td",It,[e("div",Ot,[e("div",Bt,[e("button",{type:"button",class:"text-[11px] font-semibold text-sky-600 hover:text-sky-800",onClick:d=>re(l)}," Open review modal ",8,Jt)])])])])}),128)),V.value.length===0?(a(),o("tr",Ht,t[23]||(t[23]=[e("td",{colspan:"100",class:"px-3 py-8 text-center text-gray-600"},"No data",-1)]))):p("",!0)])])]),E(me,{name:"fade-scale"},{default:ce(()=>[K.value&&u.value?(a(),o("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center px-4 py-6",onKeydown:_e(C,["escape","window"])},[e("div",{class:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm","aria-hidden":"true",onClick:C}),e("div",Wt,[e("div",Qt,[e("div",null,[e("p",Xt,n(u.value._name),1),e("p",Zt,[b(n(u.value._dept||"Department unknown")+" ",1),u.value._company?(a(),o("span",es," • "+n(u.value._company),1)):p("",!0),u.value._joining?(a(),o("span",ts," • Joined "+n(u.value._joining),1)):p("",!0)]),e("p",ss,"Line type: "+n(u.value._type),1)]),e("button",{type:"button",class:"rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm font-semibold text-slate-600 hover:bg-slate-50",onClick:C}," Close ")]),e("div",ls,[e("article",ns,[e("div",os,[u.value.latestReviewStrengths?(a(),o("div",as,[t[24]||(t[24]=e("span",{class:"font-semibold text-slate-800"},"Strengths:",-1)),e("div",rs,n(u.value.latestReviewStrengths),1)])):p("",!0),u.value.latestReviewGaps?(a(),o("div",is,[t[25]||(t[25]=e("span",{class:"font-semibold text-slate-800"},"Gaps:",-1)),e("div",ds,n(u.value.latestReviewGaps),1)])):p("",!0),u.value.latestReviewSuggestions?(a(),o("div",us,[t[26]||(t[26]=e("span",{class:"font-semibold text-slate-800"},"Suggestions:",-1)),e("div",ps,n(u.value.latestReviewSuggestions),1)])):p("",!0),!u.value.latestReviewStrengths&&!u.value.latestReviewGaps&&!u.value.latestReviewSuggestions?(a(),o("div",cs," No latest review comments ")):p("",!0)])])])])],32)):p("",!0)]),_:1})],64)),E(me,{name:"fade-scale"},{default:ce(()=>{var l;return[K.value&&u.value?(a(),o("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center px-4 py-6",onKeydown:_e(C,["escape","window"])},[e("div",{class:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm","aria-hidden":"true",onClick:C}),e("div",_s,[e("div",ms,[e("div",bs,[e("div",ys,[e("p",xs,n(u.value._name),1),e("p",gs,[b(n(u.value._dept||"Department unknown")+" ",1),u.value._company?(a(),o("span",vs," • "+n(u.value._company),1)):p("",!0),u.value._joining?(a(),o("span",fs," • Joined "+n(u.value._joining),1)):p("",!0)]),e("div",hs,[e("span",ws,[t[27]||(t[27]=b(" Progress: ")),e("b",ks,n(B(u.value)),1)]),e("span",Ns,[t[28]||(t[28]=b(" Final: ")),e("b",Ss,n(u.value.finalPercent==null?"—":A(u.value.finalPercent)),1)]),e("span",js,[t[29]||(t[29]=b(" Reviews: ")),e("b",Cs,n(((l=u.value.progress)==null?void 0:l.review_count)??0),1)])])]),e("button",{type:"button",class:"shrink-0 rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm font-semibold text-slate-600 hover:bg-slate-50",onClick:C}," Close ")])]),e("div",Rs,[ue.value.length?p("",!0):(a(),o("div",Ls," No reviews found for this employee. ")),(a(!0),o(h,null,w(ue.value,_=>{var N;return a(),o("div",{key:"lane-group-"+_.key,class:"rounded-2xl border border-slate-200 bg-white overflow-hidden"},[e("div",As,[e("div",Ts,[e("span",{class:"text-sm font-semibold text-slate-900 truncate",title:_.label},n(_.label),9,Ds),e("span",Fs," (key: "+n(_.key)+") ",1)]),e("div",zs,[e("span",Gs,[t[30]||(t[30]=b(" Count: ")),e("b",Ps,n(_.count??((N=_.reviewers)==null?void 0:N.length)??0),1)]),e("span",$s,[t[31]||(t[31]=b(" Avg: ")),e("b",Ys,n(_.average_percent==null?"—":A(_.average_percent)),1)]),e("span",Ms,[t[32]||(t[32]=b(" Latest: ")),e("b",Vs,n(de(_.latest_review_at)||"—"),1)])])]),e("div",Ks,[(a(!0),o(h,null,w(_.reviewers||[],(d,Se)=>(a(),o("div",{key:"rv-"+_.key+"-"+Se+"-"+(d.id??"x"),class:"rounded-xl border border-slate-200 bg-white p-3"},[e("div",Es,[e("div",Us,[e("div",qs,n(d.name||"Reviewer"),1),e("div",Is,[b(" Lane: "+n(d.lane||_.key)+" ",1),d.submitted_at||d.updated_at?(a(),o("span",Os," • "+n(de(d.submitted_at||d.updated_at)),1)):p("",!0)])]),e("div",Bs,[e("span",Js,n(d.percent==null?"—":A(d.percent)),1),d.obtained_total!=null&&d.max_total!=null?(a(),o("span",Hs,n(d.obtained_total)+"/"+n(d.max_total),1)):p("",!0)])]),e("div",Ws,[d.strengths&&d.strengths.length?(a(),o("div",Qs,[t[33]||(t[33]=e("div",{class:"font-semibold text-slate-900"},"Strengths",-1)),e("ul",Xs,[(a(!0),o(h,null,w(d.strengths,(G,P)=>(a(),o("li",{key:"s-"+P},n(G),1))),128))])])):p("",!0),d.gaps&&d.gaps.length?(a(),o("div",Zs,[t[34]||(t[34]=e("div",{class:"font-semibold text-slate-900"},"Gaps",-1)),e("ul",el,[(a(!0),o(h,null,w(d.gaps,(G,P)=>(a(),o("li",{key:"g-"+P},n(G),1))),128))])])):p("",!0),d.suggestions&&d.suggestions.length?(a(),o("div",tl,[t[35]||(t[35]=e("div",{class:"font-semibold text-slate-900"},"Suggestions",-1)),e("ul",sl,[(a(!0),o(h,null,w(d.suggestions,(G,P)=>(a(),o("li",{key:"u-"+P},n(G),1))),128))])])):p("",!0),(!d.strengths||!d.strengths.length)&&(!d.gaps||!d.gaps.length)&&(!d.suggestions||!d.suggestions.length)?(a(),o("div",ll," No comments in this review. ")):p("",!0)])]))),128)),!_.reviewers||_.reviewers.length===0?(a(),o("div",nl," No reviewers found in this lane. ")):p("",!0)])])}),128))]),e("div",{class:"p-4 border-t border-slate-200 bg-white flex items-center justify-end gap-2"},[e("button",{type:"button",class:"rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm font-semibold text-slate-600 hover:bg-slate-50",onClick:C}," Close ")])])],32)):p("",!0)]}),_:1})])}}},xl=Ge(ol,[["__scopeId","data-v-da12c434"]]);export{xl as default};
