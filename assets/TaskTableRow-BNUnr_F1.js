import{r as N,h as O,q as P,c as l,o as a,a as e,j as d,m as u,b as q,F as j,w as m,e as E,f as F,t as f,d as $,i as p,s as L}from"./index-Bffdaa73.js";import{d as M,b as A}from"./datetime-Du_mcDA9.js";import{_ as S,T as R,a as V,b as z}from"./TaskUrgentBadge-CDJZ4CiH.js";import{_ as U,a as W}from"./TaskAssignedUsers-BglG_Tlz.js";import{T as G}from"./TaskIsClosedBadge-BIsvNKb9.js";function B(t){if(!t)return!1;const k=I(t);return["jpg","jpeg","png","gif","webp","bmp","svg","jfif"].includes(k)}function D(t){return I(t)==="pdf"}function I(t){return typeof t=="string"?t.split(".").pop().toLowerCase():""}function x(t){return typeof t!="string"?"":t.startsWith("http")?t:`https://demo-api.edigitalbio.com/storage/${t}`}const H={class:"border-b flex items-center px-2 py-1"},J=["href"],K={class:"ml-auto flex items-center gap-2"},Q={key:0,class:"p-2 min-h-[50vh] max-h-[70vh] overflow-y-auto"},X=["src"],Y=["src"],Z={key:1},tt={key:0,class:"grid grid-cols-4 p-4 gap-8 min-h-[50vh] max-h-[70vh] overflow-y-auto"},et=["onClick"],st=["src"],at=["href"],nt={key:2,class:"text-xs text-gray-500 text-center"},Nt={__name:"RequirementAttachmentShow",props:{attachments:{type:Array,default:()=>[]},selected:{type:String,default:""}},emits:["change","clickClose"],setup(t,{emit:k}){const c=t,n=N(""),g=k;function o(i){n.value=i,g("change",i)}function y(){var s,r;const i=(c.attachments||[]).indexOf(n.value);console.log({currentIndex:i,attachments:c.attachments}),(s=c.attachments)!=null&&s[i-1]&&(n.value=(r=c.attachments)==null?void 0:r[i-1],g("change",n.value))}function v(){var s,r;const i=(c.attachments||[]).indexOf(n.value);(s=c.attachments)!=null&&s[i+1]&&(n.value=(r=c.attachments)==null?void 0:r[i+1],g("change",n.value))}return O(()=>{var i;n.value=((i=c.attachments)==null?void 0:i.length)==1?c.attachments[0]:n.value}),P(()=>c.selected,i=>n.value=i,{immediate:!0}),(i,s)=>(a(),l("div",null,[e("div",H,[s[6]||(s[6]=e("h2",{class:"text-xl font-semibold"},"Attachments",-1)),n.value?(a(),l("a",{key:0,href:u(x)(n.value),target:"_blank",class:"text-sky-600 hover:text-sky-400 hover:underline ml-2"},s[2]||(s[2]=[e("i",{class:"fas fa-external-link"},null,-1),q(),e("span",{class:"hidden md:inline"},"Open In New tab",-1)]),8,J)):d("",!0),e("div",K,[n.value&&t.attachments.length>1?(a(),l(j,{key:0},[e("button",{onClick:s[0]||(s[0]=m(r=>o(""),["prevent"])),class:"btn-icon"},s[3]||(s[3]=[e("i",{class:"fas fa-list"},null,-1)])),e("button",{onClick:m(y,["prevent"]),class:"btn-icon"},s[4]||(s[4]=[e("i",{class:"fas fa-angle-left"},null,-1)])),e("button",{onClick:m(v,["prevent"]),class:"btn-icon"},s[5]||(s[5]=[e("i",{class:"fas fa-angle-right"},null,-1)]))],64)):d("",!0),e("button",{onClick:s[1]||(s[1]=m(r=>g("clickClose"),["prevent"])),class:"btn-icon ml-6"},"Ã—")])]),e("div",null,[n.value?(a(),l("div",Q,[u(B)(n.value)?(a(),l("img",{key:0,src:u(x)(n.value),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,X)):u(D)(n.value)?(a(),l("iframe",{key:1,src:u(x)(n.value),class:"w-full h-[60vh] border rounded-md"},null,8,Y)):d("",!0)])):(a(),l("div",Z,[t.attachments&&t.attachments.length?(a(),l("div",tt,[(a(!0),l(j,null,E(t.attachments,(r,b)=>(a(),l("div",{key:b,class:"border p-1 rounded aspect-square flex items-center justify-center bg-gray-50 relative cursor-pointer",tabindex:"0",onClick:m(w=>o(r),["prevent"])},[u(B)(r)?(a(),l("img",{key:0,src:u(x)(r),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,st)):u(D)(r)?(a(),l("a",{key:1,href:u(x)(r),target:"_blank",class:"text-xs text-blue-600 text-center break-words hover:underline"},s[7]||(s[7]=[e("i",{class:"fas fa-file-pdf fa-2x mb-1 text-amber-700"},null,-1),e("div",{class:"whitespace-nowrap text-xs mt-1"},"Open PDF",-1)]),8,at)):(a(),l("span",nt,"Unknown"))],8,et))),128))])):d("",!0)]))])]))}},lt={class:"border text-center py-2 px-1 border-gray-200"},it={class:"font-semibold text-purple-400 text-sm"},ot={class:"border px-3 py-1 border-gray-200 relative"},rt={class:"flex items-center justify-between gap-2"},ct={class:"flex items-center gap-3 mb-0.5"},dt={class:"flex items-center flex-none lg:w-full order-0 lg:order-1"},ut={class:"text-pink-600 text-xs mr-2 whitespace-nowrap font-bold"},mt={class:"text-gray-400 text-xs mr-4 whitespace-nowrap"},ft={class:"ml-1"},kt={class:"flex items-center gap-2 text-xs text-gray-500 opacity-80 text-left"},gt={key:0,class:"text-xs flex items-center gap-1 text-sky-400 ml-4"},ht=["href"],xt={class:"border px-3 py-1 border-gray-200"},yt={class:"flex gap-2 justify-between items-center relative w-full"},vt={key:0,class:"shrink-0"},bt=["href"],pt={class:"border px-3 py-1 border-gray-200 text-center"},wt={key:0,class:"ml-4 text-gray-500 text-sm"},$t={class:"text-blue-500 font-semibold whitespace-nowrap"},Ct={class:"border px-3 border-gray-200 sticky right-0 border-l bg-gray-50"},Tt={class:"flex justify-end flex-wrap gap-2 py-2"},Ot={__name:"TaskTableRow",props:{task:{type:Object},indexing:{type:[Number,String]},hideButtons:{type:Boolean,default:!1},taskLinkTo:{type:Function,default:null}},emits:["editClick","employeeAssignClick"],setup(t,{emit:k}){const c=k,n=F();return(g,o)=>{var y,v,i,s,r,b,w,C,T,_;return a(),l("tr",{class:L(["group/sub-task-row h-20",[t.task.closed_at?"bg-orange-50 opacity-60 hover:opacity-90":{" bg-green-400/20":t.task.status=="COMPLETED"," bg-white hover:bg-slate-50":t.task.status!=="COMPLETED"}]])},[e("td",lt,[e("div",it,f(t.indexing),1)]),e("td",ot,[e("div",rt,[e("div",null,[e("div",ct,[$(S,{titleClass:"text-sm text-blue-400 font-semibold",task:t.task,"sub-tasks-open":!1,isMyTask:u(n).name=="RequirementList",to:h=>`/requirement-tasks/${h.id}`},null,8,["task","isMyTask","to"])]),e("div",dt,[e("div",ut,"#"+f(t.task.id),1),e("div",mt,[o[2]||(o[2]=e("i",{class:"fas fa-clock"},null,-1)),e("span",ft,f(u(M)(t.task.created_at)),1)]),e("div",kt,[(y=t.task)!=null&&y.is_important?(a(),p(R,{key:0})):d("",!0),(v=t.task)!=null&&v.is_urgent?(a(),p(V,{key:1})):d("",!0),t.task.closed_at?(a(),p(G,{key:2})):d("",!0)]),((i=t.task)==null?void 0:i.todo_dates_count)===null?(a(),l("div",gt,[o[3]||(o[3]=e("i",{class:"fas fa-tasks"},null,-1)),e("span",null,f((s=t.task)==null?void 0:s.completed_todo_dates_count),1),o[4]||(o[4]=e("span",null,"/",-1)),e("span",null,f((r=t.task)==null?void 0:r.todo_dates_count),1)])):d("",!0)])]),!t.task.closed_at&&!t.hideButtons?(a(),l("a",{key:0,href:`/tasks/edit/${t.task.id}`,onClick:o[0]||(o[0]=m(h=>c("editClick",t.task.id),["stop","prevent"])),class:"btn-3 py-1.5 px-1.5 !border-0 size-7 text-sm opacity-40 group-hover/sub-task-row:opacity-100 duration-100"},o[5]||(o[5]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ht)):d("",!0)])]),e("td",xt,[e("div",yt,[$(U,{class:"flex items-center justify-center gap-x-3 gap-y-2",users:((b=t.task)==null?void 0:b.users)||[],isTargetTask:t.task.is_target,maxItem:1,"route-to":h=>`/requirement-tasks?status=not-completed&view=userwise&user-ids=${h.id}`},null,8,["users","isTargetTask","route-to"]),t.task.closed_at?d("",!0):(a(),l("div",vt,[t.hideButtons?d("",!0):(a(),l("a",{key:0,href:`/tasks/${t.task.id}/assign-users`,onClick:o[1]||(o[1]=m(h=>c("employeeAssignClick",t.task.id),["stop","prevent"])),class:"btn-3 py-1.5 px-1.5 !border-0 size-7 text-sm opacity-40 group-hover/sub-task-row:opacity-100 duration-100 flex-shrink-0"},o[6]||(o[6]=[e("i",{class:"fas fa-users-cog"},null,-1)]),8,bt))]))])]),e("td",pt,[t.task.deadline?(a(),l("span",wt,[e("span",$t,f(u(A)(t.task.deadline)),1)])):d("",!0)]),e("td",Ct,[e("div",Tt,[$(W,{status:(w=t.task)==null?void 0:w.status,progressPercent:((C=t.task)==null?void 0:C.progress_percent)||0,class:"w-full"},null,8,["status","progressPercent"]),((_=(T=t.task)==null?void 0:T.children_tasks)==null?void 0:_.length)>0?(a(),p(z,{key:0,ref:"progress",task:t.task,class:"text-sm w-full"},null,8,["task"])):d("",!0)])])],2)}}};export{Nt as _,D as a,Ot as b,x as f,B as i};
