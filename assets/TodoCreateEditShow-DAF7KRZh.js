import{m as V,c as m,o as n,g as v,x as P,d as tt,n as nt,p as R,a as t,t as S,f as M,j as I,i as L,w as $,k as T,F as X,L as J,r as D,e as z,J as G,A as Y,K as et,M as it,h as W,v as F,y as rt,X as ut}from"./index-C7b6--cG.js";import{_ as ct}from"./DepartmentChip-DOahUhQH.js";import{_ as ot}from"./UserChip-CLPtiqFk.js";import{O as K}from"./OverlyModal-0UK1JCtv.js";import{g as q,b as mt}from"./datetime-DcVwRp76.js";import{u as Q,a as lt,f as yt,d as ft,b as vt}from"./useTodoStore-DjcyTQFM.js";import{L as H}from"./LoaderView-Z_ZNKjCH.js";import{u as st}from"./useTaskStore-BpFpvgVo.js";const pt={key:0,class:"fa fa-exclamation-square",title:"Pending"},bt={key:1,class:"fa fa-pause",title:"Working"},gt={key:2,class:"fa fa-check-square",title:"Completed"},at={__name:"TodoStatusIcon",props:{todoDate:{type:Object,required:!0}},setup(e){const C=e,r=V(()=>{switch(C.todoDate.status){case"PENDING":return"text-red-400";case"WORKING":return"text-yellow-600";case"COMPLETED":return"text-green-400"}return""});return(a,b)=>(n(),m("span",{class:P(r.value)},[e.todoDate.status=="PENDING"?(n(),m("i",pt)):v("",!0),e.todoDate.status=="WORKING"?(n(),m("i",bt)):v("",!0),e.todoDate.status=="COMPLETED"?(n(),m("i",gt)):v("",!0)],2))}},kt={class:""},xt={key:0,class:"mt-1 flex items-center gap-2"},wt={key:0,class:"line-clamp-2 text-gray-500 whitespace-nowrap mr-2"},Tt={class:"md:ml-auto w-full md:w-auto flex items-center justify-center gap-2"},Dt={key:0,class:"flex items-center gap-1 text-red-600"},Te={__name:"TodoItemCard",props:{todoDate:{type:Object,required:!0},hideDepartment:{type:Boolean,default:!1},hideUser:{type:Boolean,default:!1},hideSortingBtn:{type:Boolean,default:!1},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickEdit","clickDelete","clickChangeStatus","clickDelete"],setup(e,{emit:C}){const r=tt(),a=C;return(b,d)=>{var y,l,p,u,s,o,g;const i=nt("RouterLink");return n(),m("div",{class:P(["px-4 py-4 md:py-2 cursor-pointer flex flex-wrap items-center gap-y-2 gap-x-4 text-sm",{"bg-green-100":e.todoDate.status=="COMPLETED","hover:bg-gray-50":e.todoDate.status!="COMPLETED"}]),onClick:d[4]||(d[4]=$(x=>a("clickTodo",e.todoDate),["prevent"]))},[R(at,{todoDate:e.todoDate},null,8,["todoDate"]),t("div",kt,[t("div",{class:P(["line-clamp-1",{"text-green-800":e.todoDate.status=="COMPLETED","text-blue-800":e.todoDate.status!="COMPLETED"}])},S(e.todoDate.id)+" - "+S(e.todoDate.title),3),e.todoDate.user?(n(),m("div",xt,[e.hideUser?v("",!0):(n(),M(ot,{key:0,user:e.todoDate.user,"avatar-size":"xsmall"},null,8,["user"])),e.hideDepartment?v("",!0):(n(),M(ct,{key:1,department:(l=(y=e.todoDate)==null?void 0:y.user)==null?void 0:l.department},null,8,["department"]))])):v("",!0)]),(p=e.todoDate.todo)!=null&&p.todo_type&&((u=e.todoDate.todo)!=null&&u.todo_type_id)?(n(),m("div",wt,[I(S((s=e.todoDate.todo)==null?void 0:s.todo_type)+" ",1),R(i,{class:"text-blue-600 font-semibold underline hover:text-sky-400",onClick:$(x=>null,["stop"]),to:{name:"RequirementTaskShow",params:{id:(o=e.todoDate.todo)==null?void 0:o.todo_type_id}}},{default:L(()=>{var x;return[d[5]||(d[5]=t("i",{class:"fas fa-link"},null,-1)),I(" "+S((x=e.todoDate.todo)==null?void 0:x.todo_type_id),1)]}),_:1,__:[5]},8,["to"])])):v("",!0),t("div",Tt,[e.todoDate.status=="WORKING"?(n(),m("div",Dt,d[6]||(d[6]=[t("span",{class:"fas fa-circle animate-pulse text-xs"},null,-1),t("span",{class:"text-xs"},"Working",-1)]))):v("",!0),e.todoDate.user_id===((g=T(r).user)==null?void 0:g.id)?(n(),m(X,{key:1},[e.todoDate.status==="WORKING"?(n(),m("button",{key:0,title:"Mark as Completed",class:"btn-icon bg-transparent text-green-400 border-green-400 border hover:bg-green-400 hover:text-white",onClick:d[0]||(d[0]=$(()=>a("clickChangeStatus",e.todoDate,"COMPLETED"),["prevent","stop"]))},d[7]||(d[7]=[t("i",{class:"fas fa-check"},null,-1)]))):v("",!0),e.todoDate.status==="PENDING"?(n(),m("button",{key:1,title:"Start Working",class:"btn-icon bg-transparent text-red-400 border-red-400 border hover:bg-red-400 hover:text-white",onClick:d[1]||(d[1]=$(()=>a("clickChangeStatus",e.todoDate,"WORKING"),["prevent","stop"]))},d[8]||(d[8]=[t("i",{class:"fas fa-play ml-[4px]"},null,-1)]))):v("",!0),t("button",{class:"btn-icon bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:d[2]||(d[2]=$(x=>{var k;return a("clickEdit",(k=e.todoDate)==null?void 0:k.todo)},["prevent","stop"]))},d[9]||(d[9]=[t("i",{class:"fas fa-pen"},null,-1)])),t("button",{class:"btn-icon bg-red-400 text-white hover:bg-red-600 hover:text-white",onClick:d[3]||(d[3]=$(()=>a("clickDelete",e.todoDate),["prevent","stop"]))},d[10]||(d[10]=[t("i",{class:"fas fa-trash-alt"},null,-1)]))],64)):v("",!0),e.hideSortingBtn?v("",!0):(n(),m("button",{key:2,onClick:$(()=>null,["stop","prevent"]),class:"btn-icon bg-gray-400 text-white hover:bg-gray-600 hover:text-white handle"},d[11]||(d[11]=[t("i",{class:"fas fa-arrows-alt-v"},null,-1)])))])],2)}}},Ct={class:"bg-white border-t px-4 py-4 sticky bottom-0 rounded-b-md"},ht={key:0,class:"mb-4 text-red-500 font-medium"},St={key:0,class:"mb-4 text-blue-500 font-medium"},$t={class:"flex justify-between items-center gap-4"},It=["disabled"],Z={__name:"FormHandler",props:{isSubmitting:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["submit","clickCancel"],setup(e,{emit:C}){const r=C;return(a,b)=>(n(),m("form",{onSubmit:b[1]||(b[1]=$(d=>r("submit"),["prevent"]))},[J(a.$slots,"default"),t("div",Ct,[J(a.$slots,"error",{},()=>[e.error?(n(),m("div",ht,S(e.error),1)):v("",!0)]),e.isSubmitting?(n(),m("div",St,"Saving changes...")):v("",!0),J(a.$slots,"footer",{},()=>[t("div",$t,[t("button",{type:"button",onClick:b[0]||(b[0]=d=>r("clickCancel")),class:"btn-3"},"Cancel"),t("button",{disabled:e.isSubmitting||e.isLoading,type:"submit",class:"btn-2"},S(e.isSubmitting?"Saving...":"Save"),9,It)])])])],32))}},Et={class:"flex items-center py-1"},Rt={class:P(["line-clamp-2 mr-4 "])},Mt={__name:"TodoInputTaskItem",props:{task:Object,level:Number,selected:Number},emits:["select"],setup(e,{emit:C}){const r=C;return(a,b)=>(n(),m("div",{class:P(["px-2 border-b py-3 over text-sm relative",[e.task.id==e.selected?"text-red-50 bg-sky-500 px-2":"hover:text-blue-500"]])},[t("div",Et,[t("div",Rt,S(e.task.id)+" - "+S(e.task.title),1),e.task.id!=e.selected?(n(),m("button",{key:0,class:"border btn-2 ml-auto",onClick:b[0]||(b[0]=$(()=>r("select",e.task),["prevent"]))}," Select ")):v("",!0)])],2))}},Lt={key:0,class:"line-clamp-1"},Ot={key:1},Ut={class:"flex items-center mb-2"},Nt={class:"relative"},Vt={class:"border flex rounded-t-md sticky top-0 bg-white"},Bt={class:"h-[250px] overflow-y-auto"},jt={class:"border"},Pt={__name:"TaskSelectionInput",props:{todoType:{type:String,default:"task"},taskId:{type:[String,Number],default:null},show:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["update:todoType","update:taskId","update:show"],setup(e,{emit:C}){const r=e,a=C,b=D(""),d=V({get:()=>r.taskId,set:k=>a("update:taskId",k)}),i=V({get:()=>r.show,set:k=>a("update:show",k)}),y=D(null),l=D({});function p(){if(!(y!=null&&y.value))return;const k=y.value.getBoundingClientRect(),h=window.innerHeight,N=300,U=h-k.bottom<N;l.value={position:"fixed",top:U?k.top-N+"px":k.bottom+"px",left:k.left+"px",width:k.width+"px",zIndex:5e3}}z(async()=>{await G(),window.addEventListener("resize",p),document.addEventListener("scroll",p),await u.fetchAllMyTasks()});const u=st();Y(()=>i.value,async k=>{k&&await u.fetchAllMyTasks()}),et(()=>{window.removeEventListener("resize",p),document.removeEventListener("scroll",p)});function s(k){d.value=k.id,i.value=!1}function o(k){d.value="",i.value=!1}const g=V(()=>[...u.tasks||[]].find(k=>k.id==d.value)),x=V(()=>{const k=b.value.trim().toUpperCase();return k.length?[...u.tasks||[]].filter(h=>String(h.title||"").toUpperCase().includes(k)):u.tasks});return(k,h)=>{var N,B,U;return n(),m("div",{class:"relative",ref_key:"anchor",ref:y},[t("div",{class:P(["w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 cursor-pointer flex items-center shadow-sm",d.value?"":"text-gray-400"]),onClick:h[0]||(h[0]=$(()=>{e.readonly||(i.value=!0,p())},["stop"]))},[(N=g.value)!=null&&N.title?(n(),m("div",Lt,S((B=g.value)==null?void 0:B.id)+" - "+S((U=g.value)==null?void 0:U.title),1)):(n(),m("div",Ot,"Click to select todo")),d.value&&!e.readonly?(n(),m("button",{key:2,class:"btn-icon fas fa-times !size-8 text-sm ml-auto",onClick:$(o,["prevent","stop"])})):v("",!0)],2),(n(),M(ut,{to:"body"},[i.value?(n(),m("div",{key:0,style:it(l.value),class:"fixed bg-white rounded-b-md shadow-lg border z-[5000] p-4"},[t("div",Ut,[h[4]||(h[4]=t("h2",{class:"text-sky-800 text-sm uppercase"},"Task List",-1)),t("button",{onClick:h[1]||(h[1]=$(()=>i.value=!1,["prevent"])),class:"ml-auto"},h[3]||(h[3]=[t("i",{class:"fas fa-times-circle text-red-700 text-xl hover:text-red-500"},null,-1)]))]),t("div",Nt,[t("div",Vt,[W(t("input",{type:"text",placeholder:"Search task",class:"w-full py-2 px-4 rounded-t-md outline-sky-200","onUpdate:modelValue":h[2]||(h[2]=O=>b.value=O)},null,512),[[F,b.value]]),h[5]||(h[5]=t("label",{class:"ml-auto flex w-8 items-center justify-center absolute right-0 top-0 bottom-0"},[t("i",{class:"fas fa-search"})],-1))])]),t("div",Bt,[t("div",jt,[(n(!0),m(X,null,rt(x.value,O=>(n(),M(Mt,{key:O.id,task:O,onSelect:s,selected:d.value,class:"group/main"},null,8,["task","selected"]))),128))])])],4)):v("",!0)]))],512)}}},dt={__name:"TodoTypeInput",props:{todoType:{type:String,default:"task"},todoTypeId:{type:[String,Number],default:null},show:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["update:todoType","update:todoTypeId","update:show"],setup(e,{emit:C}){const r=e,a=C,b=V({get:()=>r.todoTypeId,set:u=>a("update:todoTypeId",u)}),d=V({get:()=>r.show,set:u=>a("update:show",u)}),i=D(null),y=D({});function l(){if(!(i!=null&&i.value))return;const u=i.value.getBoundingClientRect(),s=window.innerHeight,o=300,x=s-u.bottom<o;y.value={position:"fixed",top:x?u.top-o+"px":u.bottom+"px",left:u.left+"px",width:u.width+"px",zIndex:5e3}}z(async()=>{await G(),window.addEventListener("resize",l),document.addEventListener("scroll",l)});const p=st();return Y(()=>d.value,async u=>{u&&await p.fetchAllMyTasks()}),et(()=>{window.removeEventListener("resize",l),document.removeEventListener("scroll",l)}),(u,s)=>(n(),m("div",null,[R(Pt,{show:d.value,"onUpdate:show":s[0]||(s[0]=o=>d.value=o),taskId:b.value,"onUpdate:taskId":s[1]||(s[1]=o=>b.value=o)},null,8,["show","taskId"])]))}},zt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},At={class:"mb-4"},qt={class:"mb-4"},Wt=["readonly"],Ft={class:"mb-4"},Gt={__name:"TodoAddForm",props:{date:{type:String,default:q(new Date)},userRole:{type:String,default:"employee"},todoType:{type:String,default:"task"},todoTypeId:{type:String,default:null},readonlyValues:{type:Object,default:()=>({date:!1,todo_type_id:!1})}},emits:["update","cancelClick"],setup(e,{emit:C}){const r=e,a=D(),b=D(!1),d=D(),i=Q(),y=C,l=D({title:"",date:r.date||"",todo_type:"task",todo_type_id:""});async function p(){var u;try{a.value="submitting",(u=l.value)!=null&&u.todo_type_id||(l.value={title:l.value.title,date:l.value.date}),await i.createTodo(l.value,{returnWith:r.userRole!=="employee"?"user,department,company":""}),y("update")}finally{a.value=""}}return Y(()=>({date:r.date,todo_type:r.todoType,todo_type_id:r.todoTypeId}),u=>{l.value=u},{immediate:!0}),z(async()=>{var u;await G(),(u=d.value)==null||u.focus()}),(u,s)=>(n(),m("div",{onClick:s[6]||(s[6]=o=>b.value=!1)},[t("pre",null,S(l.value),1),T(i).loading?(n(),M(H,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:L(()=>s[7]||(s[7]=[I(" Loading... ")])),_:1,__:[7]})):v("",!0),R(Z,{onSubmit:p,onClickCancel:s[5]||(s[5]=o=>y("cancelClick")),isSubmitting:a.value=="submitting",error:T(i).error,class:"rounded-md relative"},{default:L(()=>{var o,g;return[s[11]||(s[11]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Add Todo")],-1)),t("div",zt,[t("div",At,[s[8]||(s[8]=t("label",{class:"block text-gray-700 font-medium mb-1 text-sm"},"Title",-1)),W(t("input",{ref_key:"titleRef",ref:d,"onUpdate:modelValue":s[0]||(s[0]=x=>l.value.title=x),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,l.value.title]])]),t("div",qt,[s[9]||(s[9]=t("label",{class:"block text-gray-700 font-medium mb-1 text-sm"},"Date",-1)),W(t("input",{readonly:(o=e.readonlyValues)==null?void 0:o.date,"onUpdate:modelValue":s[1]||(s[1]=x=>l.value.date=x),type:"date",required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,8,Wt),[[F,l.value.date]])]),t("div",Ft,[s[10]||(s[10]=t("label",{class:"block text-gray-700 font-medium mb-1 text-sm"},"Task ID (optional)",-1)),R(dt,{show:b.value,"onUpdate:show":s[2]||(s[2]=x=>b.value=x),todoType:l.value.todo_type,"onUpdate:todoType":s[3]||(s[3]=x=>l.value.todo_type=x),todoTypeId:l.value.todo_type_id,"onUpdate:todoTypeId":s[4]||(s[4]=x=>l.value.todo_type_id=x),readonly:(g=e.readonlyValues)==null?void 0:g.todo_type_id},null,8,["show","todoType","todoTypeId","readonly"])])])]}),_:1,__:[11]},8,["isSubmitting","error"])]))}},_t={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},Kt={class:"mb-4 text-md"},Ht={class:"font-semibold"},Jt={class:"mb-2"},Xt={__name:"TodoDateAddForm",props:{date:{type:[String,Number],default:q(new Date)},todoId:{type:[String,Number],required:!0},userRole:{type:String,default:"employee"}},emits:["update","cancelClick"],setup(e,{emit:C}){const r=e,a=D(),b=D(!1),d=D(),i=Q(),y=lt(),l=C,p=D({date:r.date||"",todo_id:r.todoId});async function u(){try{a.value="submitting",await y.createTodoDate(p.value),l("update")}finally{a.value=""}}return z(async()=>{var s;await G(),await i.fetchTodo(r.todoId),(s=d.value)==null||s.focus()}),(s,o)=>(n(),m("div",{onClick:o[2]||(o[2]=g=>b.value=!1)},[T(i).loading?(n(),M(H,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:L(()=>o[3]||(o[3]=[I(" Loading... ")])),_:1,__:[3]})):v("",!0),R(Z,{onSubmit:u,onClickCancel:o[1]||(o[1]=g=>l("cancelClick")),isSubmitting:a.value=="submitting",error:T(y).error,class:"rounded-md relative"},{default:L(()=>{var g;return[o[6]||(o[6]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Carry Todo To Date")],-1)),t("div",_t,[t("div",Kt,[o[4]||(o[4]=I(" TODO: ")),t("span",Ht,S((g=T(i).todo)==null?void 0:g.title),1)]),t("div",Jt,[o[5]||(o[5]=t("span",{class:"font-semibold"}," Date ",-1)),W(t("input",{"onUpdate:modelValue":o[0]||(o[0]=x=>p.value.date=x),type:"date",multiple:"",required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,p.value.date]])])])]}),_:1,__:[6]},8,["isSubmitting","error"])]))}},Yt={key:0,class:"mb-4 text-red-500 font-medium"},Qt={key:1,class:"mb-4 text-red-500 font-medium"},Zt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},te={class:"mb-4"},ee={class:"mb-4"},oe={__name:"TodoEditForm",props:{date:{type:String,default:q(new Date)},todo:{type:Object,default:()=>({})}},emits:["update","cancelClick"],setup(e,{emit:C}){var j;const r=e,a=D(),b=D(!1),d=D(),i=Q(),y=C,l=D({title:"",todo_type:"task",todo_type_id:""}),p=D({id:null,repeat_type:"daily",start_date:((j=r.todo)==null?void 0:j.date)||r.date||q(new Date),end_date:null,weekly_day:null,monthly_mode:null,monthly_value:null,monthly_week:null,yearly_month:null,yearly_day:null}),u=D(!1),s=D({});async function o(){var w,c,f;await i.fetchTodo((w=r.todo)==null?void 0:w.id),l.value.title=(c=i.todo)==null?void 0:c.title,l.value.todo_type_id=(f=i.todo)==null?void 0:f.todoable_id}const g=D(null);async function x(){var w,c;try{const{data:f}=await yt(r.todo.id),E=f==null?void 0:f.setting;E?(u.value=!0,g.value=E.id,p.value={repeat_type:E.repeat_type??"daily",start_date:E.start_date??p.value.start_date,end_date:E.end_date??null,weekly_day:E.weekly_day??null,monthly_mode:E.monthly_mode??null,monthly_value:E.monthly_value??null,monthly_week:E.monthly_week??null,yearly_month:E.yearly_month??null,yearly_day:E.yearly_day??null}):p.value.id=null}catch(f){O.value=(c=(w=f==null?void 0:f.response)==null?void 0:w.data)==null?void 0:c.message,console.error("Load setting failed:",(f==null?void 0:f.message)||f)}}async function k(){await i.updateTodo(r.todo.id,{title:l.value.title,todo_type:l.value.todo_type,todo_type_id:l.value.todo_type_id})}async function h(){var w,c;if(!u.value)g.value&&await ft(r.todo.id,g.value);else{const f=(w=s.value)!=null&&w.buildPayload?s.value.buildPayload():{...p.value};f.start_date||(f.start_date=((c=r.todo)==null?void 0:c.date)||r.date||q(new Date)),await vt(r.todo.id,f)}}const N=w=>{var c,f;return((f=(c=w==null?void 0:w.response)==null?void 0:c.data)==null?void 0:f.message)||(w==null?void 0:w.message)||"Something went wrong"};async function B(){const[w,c]=await Promise.allSettled([k(),h()]),f=w.status==="fulfilled",E=c.status==="fulfilled";E||(O.value=N(c.reason)),f&&E&&y("update")}const U=D(!1),O=D(!1);async function _(){var w;await o(),U.value=!0,await x(),U.value=!1,await G(),(w=d.value)==null||w.focus()}const A=V(()=>i.loading||U.value);return z(()=>{_()}),(w,c)=>(n(),m("div",{class:"relative",onClick:c[5]||(c[5]=f=>b.value=!1)},[A.value?(n(),M(H,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:L(()=>c[6]||(c[6]=[I(" Loading... ")])),_:1,__:[6]})):v("",!0),R(Z,{onSubmit:B,onClickCancel:c[4]||(c[4]=f=>y("cancelClick")),isSubmitting:a.value=="submitting",isLoading:A.value,id:"todoEditForm"},{error:L(()=>[t("div",null,[T(i).error?(n(),m("div",Yt,S(T(i).error),1)):v("",!0),O.value?(n(),m("div",Qt,S(O.value),1)):v("",!0)])]),default:L(()=>[c[10]||(c[10]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Edit Todo")],-1)),t("div",Zt,[c[9]||(c[9]=t("div",{class:"text-xs text-red-800 mb-6"},[t("strong",null,"Tips:"),I(" If you change the todo, it will change to all the concurrent dates ")],-1)),t("div",te,[c[7]||(c[7]=t("label",{class:"block text-gray-500 font-medium text-sm"},"Title",-1)),W(t("input",{ref_key:"titleRef",ref:d,"onUpdate:modelValue":c[0]||(c[0]=f=>l.value.title=f),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 shadow-sm"},null,512),[[F,l.value.title]])]),t("div",ee,[c[8]||(c[8]=t("label",{class:"block text-gray-500 font-medium text-sm"},"Task ID (optional)",-1)),R(dt,{show:b.value,"onUpdate:show":c[1]||(c[1]=f=>b.value=f),todoType:l.value.todo_type,"onUpdate:todoType":c[2]||(c[2]=f=>l.value.todo_type=f),todoTypeId:l.value.todo_type_id,"onUpdate:todoTypeId":c[3]||(c[3]=f=>l.value.todo_type_id=f)},null,8,["show","todoType","todoTypeId"])])])]),_:1,__:[10]},8,["isSubmitting","isLoading"])]))}},le={class:"relative"},se={class:"min-h-[10vh] max-h-[50vh] overflow-y-auto p-4"},ae={class:"mb-4"},de={class:"mb-4 flex justify-between items-end"},ne={key:0,class:"mt-1 flex items-center gap-2 mb-4"},ie={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},re={class:"flex items-center justify-between gap-4"},ue={key:0,class:"flex items-center gap-2"},ce={class:"flex justify-between items-center gap-4 py-4 px-4 border-t"},me={key:0,class:"ml-auto flex items-center gap-2"},ye={__name:"TodoShow",props:{todoDate:{type:Object,default:()=>{}}},emits:["cancelClick","clickEdit","update","clickAddTodoDate"],setup(e,{emit:C}){const r=e,a=lt(),b=tt(),d=C;async function i(){var s;console.log({todo_date:"dd"}),await a.fetchTodoDate((s=r.todoDate)==null?void 0:s.id)}const y=V(()=>{var s,o;return(s=a.todo_date)!=null&&s.date?new Date((o=a.todo_date)==null?void 0:o.date):null}),l=V(()=>{var s,o,g;return((o=(s=a.todo_date)==null?void 0:s.user)==null?void 0:o.id)===((g=b.user)==null?void 0:g.id)});async function p(s){var o;confirm(`Are your sure want to delete todo
'${(o=a.todo_date)==null?void 0:o.title}'`)&&(await a.deleteTodoDate(s.id),d("update"))}async function u(s,o){var g;confirm(`Are your sure want to compete todo
'${(g=a.todo_date)==null?void 0:g.title}'`)&&(await a.updateStatus(s.id,o),d("update"))}return z(async()=>{await i()}),(s,o)=>{var g,x,k,h,N,B,U,O,_;return n(),m("div",le,[T(a).loading?(n(),M(H,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:L(()=>o[6]||(o[6]=[I(" Loading... ")])),_:1,__:[6]})):v("",!0),t("div",null,[o[13]||(o[13]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Show Todo")],-1)),t("div",se,[t("div",ae,[o[7]||(o[7]=t("div",{class:"font-semibold text-xs text-gray-500"},"Date",-1)),t("span",null,S(T(mt)(y.value,{weekDay:"long"})),1)]),t("div",de,[t("div",null,[o[8]||(o[8]=t("div",{class:"text-xs text-gray-500"},"Todo",-1)),I(" "+S((g=T(a).todo_date)==null?void 0:g.title),1)]),t("button",{class:"btn-2 bg-sky-400 text-white hover:bg-sky-600 hover:text-white bg-none",onClick:o[0]||(o[0]=$(A=>{var j;return d("clickEdit",(j=T(a).todo_date)==null?void 0:j.todo)},["prevent","stop"]))},o[9]||(o[9]=[t("i",{class:"fas fa-pen"},null,-1),I(" Edit Todo ")]))]),(x=e.todoDate)!=null&&x.user?(n(),m("div",ne,[R(ot,{user:e.todoDate.user,"avatar-size":"xsmall"},null,8,["user"]),t("div",ie,S((h=(k=e.todoDate.user)==null?void 0:k.department)==null?void 0:h.name),1)])):v("",!0),t("div",null,[o[12]||(o[12]=t("div",{class:"text-xs text-gray-500"},"Status",-1)),t("div",re,[t("div",null,[(N=T(a))!=null&&N.todo_date?(n(),M(at,{key:0,todoDate:(B=T(a))==null?void 0:B.todo_date},null,8,["todoDate"])):v("",!0),I(" "+S((U=T(a).todo_date)==null?void 0:U.status),1)]),l.value&&!T(a).loading?(n(),m("div",ue,[((O=T(a).todo_date)==null?void 0:O.status)==="PENDING"?(n(),m("button",{key:0,class:"btn-2 from-yellow-700 to-yellow-500 text-white hover:bg-green-600 hover:text-white",onClick:o[1]||(o[1]=$(()=>u(T(a).todo_date,"WORKING"),["prevent","stop"]))},o[10]||(o[10]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),I(" Change to Working ")]))):v("",!0),((_=T(a).todo_date)==null?void 0:_.status)==="WORKING"?(n(),m("button",{key:1,class:"btn-2 from-green-700 to-green-300 text-white hover:bg-green-600 hover:text-white",onClick:o[2]||(o[2]=$(()=>u(T(a).todo_date,"COMPLETED"),["prevent","stop"]))},o[11]||(o[11]=[t("i",{class:"fas fa-check"},null,-1),I(" Make Complete ")]))):v("",!0)])):v("",!0)])])])]),t("div",ce,[t("button",{type:"button",onClick:o[3]||(o[3]=A=>d("cancelClick")),class:"btn-3"},"Cancel"),l.value&&!T(a).loading?(n(),m("div",me,[t("button",{class:"btn-2 bg-green-600 text-white hover:bg-green-700 hover:text-white bg-none",onClick:o[4]||(o[4]=$(A=>{var j,w;return d("clickAddTodoDate",(j=T(a).todo_date)==null?void 0:j.todo_id,(w=T(a).todo_date)==null?void 0:w.date)},["prevent","stop"]))},o[14]||(o[14]=[t("i",{class:"fas fa-plus"},null,-1),I(" Add To another date ")])),t("button",{class:"btn-2-red",onClick:o[5]||(o[5]=$(()=>p(T(a).todo_date),["prevent","stop"]))},o[15]||(o[15]=[t("i",{class:"fas fa-trash-alt"},null,-1),I(" Delete ")]))])):v("",!0)])])}}},De={__name:"TodoCreateEditShow",props:{todoModal:{type:Object,required:!0},userRole:{type:String,required:"employee"}},emits:["cancelClick","todoUpdate","todoDateUpdate","clickEdit","clickDelete","clickChangeStatus","clickAddTodoDate"],setup(e,{emit:C}){const r=C;function a(){r("todoUpdate")}function b(){r("todoDateUpdate")}return(d,i)=>(n(),m(X,null,[e.todoModal.action=="add"?(n(),M(K,{key:0},{default:L(()=>{var y,l,p,u;return[R(Gt,{onCancelClick:i[0]||(i[0]=s=>r("cancelClick")),onUpdate:a,date:(y=e.todoModal)==null?void 0:y.date,todoType:(l=e.todoModal)==null?void 0:l.todoType,todoTypeId:(p=e.todoModal)==null?void 0:p.todoTypeId,readonlyValues:((u=e.todoModal)==null?void 0:u.formReadonlyValues)||{},userRole:e.userRole},null,8,["date","todoType","todoTypeId","readonlyValues","userRole"])]}),_:1})):v("",!0),e.todoModal.action=="addDate"?(n(),M(K,{key:1},{default:L(()=>{var y,l,p;return[R(Xt,{onCancelClick:i[1]||(i[1]=u=>r("cancelClick")),onUpdate:b,date:(y=e.todoModal)==null?void 0:y.date,todoId:(l=e.todoModal)==null?void 0:l.todo_id,userRole:e.userRole,readonlyValues:((p=e.todoModal)==null?void 0:p.formReadonlyValues)||{}},null,8,["date","todoId","userRole","readonlyValues"])]}),_:1})):v("",!0),e.todoModal.action=="edit"?(n(),M(K,{key:2},{default:L(()=>{var y,l;return[R(oe,{onCancelClick:i[2]||(i[2]=p=>r("cancelClick")),onUpdate:a,todo:(y=e.todoModal)==null?void 0:y.todo,userRole:e.userRole,readonlyValues:((l=e.todoModal)==null?void 0:l.formReadonlyValues)||{}},null,8,["todo","userRole","readonlyValues"])]}),_:1})):v("",!0),e.todoModal.action=="show"?(n(),M(K,{key:3},{default:L(()=>{var y;return[R(ye,{onCancelClick:i[3]||(i[3]=l=>r("cancelClick")),onUpdate:b,onClickEdit:i[4]||(i[4]=l=>r("clickEdit",l)),onClickAddTodoDate:i[5]||(i[5]=(...l)=>r("clickAddTodoDate",...l)),onClickDelete:i[6]||(i[6]=l=>r("clickDelete",l)),onClickChangeStatus:i[7]||(i[7]=(l,p)=>r("clickChangeStatus",l,p)),todoDate:(y=e.todoModal)==null?void 0:y.todo,userRole:e.userRole},null,8,["todoDate","userRole"])]}),_:1})):v("",!0)],64))}};export{Te as _,De as a,at as b};
