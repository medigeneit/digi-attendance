import{u as gt,r as k,p as dt,b as kt,c as i,a as e,k as a,j as wt,t as l,F as m,x as w,h as v,e as p,y as it,l as At,d as ht,v as jt,f as Lt,o as d,g as Ct}from"./index-BlVvCVmu.js";import{L as Dt}from"./LoaderView-BjibRwIV.js";import{_ as Bt}from"./ShareComponent-CUKBnhcL.js";import{u as Rt}from"./leave-application-BXeciu7n.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Nt={class:"my-container max-w-3xl space-y-6"},Wt={key:1,class:"card-bg p-4 md:p-8"},It={class:"title-lg text-center"},Tt={class:"text-center text-sm"},St={class:"space-y-4"},$t={class:"grid md:grid-cols-2 print:grid-cols-2 gap-8"},Ht={class:""},Mt={class:"text-sm"},Vt={class:"flex justify-end gap-4"},Ot={class:"table-auto border border-black bg-white text-xs"},Ft={class:"border border-black px-2"},Pt={class:"border border-black px-2"},Et={class:"border border-black px-2"},Ut={class:"font-bold"},zt={class:"border border-black px-2"},Gt={class:"table-auto border border-black bg-white text-xs"},Jt={class:"border border-black"},qt={colspan:"2",class:"border border-black px-2 w-32"},Kt={class:"border border-black px-2"},Qt={class:"border border-black px-2"},Xt={class:"font-bold"},Yt={class:"border border-black px-2"},Zt={class:"py-2"},es={class:"gap-y-1"},ts={class:"gap-y-1"},ss={class:"gap-y-1"},ls={class:"grid print:grid-cols-2 md:grid-cols-2 text-sm"},as={class:"pt-8 grid grid-cols-2"},os={class:"text-sm"},ns={class:"flex flex-col justify-center items-center text-sm"},rs={key:0,class:"print:hidden"},ds={class:"text-xs text-center"},is={class:"flex justify-center gap-2"},us={class:"font-bold"},ps={key:0,class:"text-green-600 print:text-black"},cs={key:1,class:"pl-2 text-yellow-700"},vs={class:"overflow-x-auto"},bs={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},_s={class:"border border-gray-500 px-4 py-0.5 text-left"},ys={class:"border border-gray-500 px-4 py-0.5 text-center"},xs={class:"border border-gray-500 px-4 py-0.5 text-center"},ms={class:"space-y-14"},fs={class:"font-bold text-center text-lg"},gs={key:0},ks={class:"grid md:grid-cols-3 print:grid-cols-3 gap-4 text-sm items-end"},ws={class:"flex flex-col justify-center items-center"},As={key:0,class:"print:hidden"},hs={class:"text-center"},js={class:"text-xs text-center text-blue-600"},Ls={class:"flex justify-center gap-4"},Cs={class:"font-bold"},Ds={key:0,class:"text-green-600"},Bs={class:"flex flex-col justify-center items-center"},Rs={key:0,class:"print:hidden"},Ns={class:"text-center"},Ws={class:"text-xs text-center text-blue-600"},Is={class:"flex justify-center gap-4"},Ts={class:"font-bold"},Ss={key:0,class:"text-green-600"},$s={class:"flex flex-col justify-center items-center"},Hs={key:0,class:"print:hidden"},Ms={class:"text-center"},Vs={class:"text-xs text-center text-blue-600"},Os={class:"flex justify-center gap-4"},Fs={class:"font-bold"},Ps={key:0,class:"text-green-600"},Es={class:"flex justify-evenly text-sm items-end"},Us={class:"flex flex-col justify-center items-center"},zs={key:0,class:"print:hidden"},Gs={class:"text-center"},Js={class:"text-xs text-center text-blue-600"},qs={class:"flex justify-center gap-4"},Ks={class:"font-bold"},Qs={key:0,class:"text-green-600"},Xs={class:"flex flex-col justify-center items-center"},Ys={key:0,class:"print:hidden"},Zs={class:"text-center"},el={class:"text-xs text-center text-blue-600"},tl={class:"flex justify-center gap-4"},sl={class:"font-bold"},ll={key:0,class:"text-green-600"},al={key:0,class:"modal-bg"},ol={class:"modal-card"},nl={class:"flex justify-end gap-2 mt-4"},vl={__name:"LeaveApplicationShow",setup(rl){const c=gt(),u=Rt(),ut=Ct(),f=Lt(),A=k(!0),_=k(!1),y=k(""),s=dt(()=>u.leaveApplication);kt(async()=>{const{id:r}=f.params;try{await u.fetchLeaveApplicationById(r)}catch(t){console.error("Failed to load leave application:",t)}finally{A.value=!1}});async function pt(){try{await u.rejectLeaveApplication(f.params.id,{rejection_reason:y.value}),alert("Leave application rejected successfully!"),_.value=!1,y.value="",await u.fetchLeaveApplicationById(f.params.id)}catch(r){alert(r.message)}}function b(){_.value=!0}async function ct(r){try{await u.acceptHandover(r),alert("Handover accepted successfully!"),await u.fetchLeaveApplicationById(r)}catch(t){alert(t.message)}}async function vt(r){try{await u.acceptInCharge(r),alert("Leave Application Successfully Accepted!"),await u.fetchLeaveApplicationById(r)}catch(t){alert(t.message)}}async function bt(r){try{await u.acceptCoordinator(r),alert("Coordinator accepted successfully!"),await u.fetchLeaveApplicationById(r)}catch(t){alert(t.message)}}async function _t(r){try{await u.acceptOperationalAdmin(r),alert("Operational Admin accepted successfully!"),await u.fetchLeaveApplicationById(r)}catch(t){alert(t.message)}}async function yt(r){try{await u.acceptRecommendBy(r),alert("Recommendation accepted successfully!"),await u.fetchLeaveApplicationById(r)}catch(t){alert(t.message)}}async function xt(r){try{await u.acceptApprovedBy(r),alert("Leave Application approved successfully!"),await u.fetchLeaveApplicationById(r)}catch(t){alert(t.message)}}function mt(){window.print()}const ft=()=>ut.go(-1),h=dt(()=>{if(!s.value||!s.value.last_working_date||!s.value.resumption_date)return 0;const r=new Date(s==null?void 0:s.value.last_working_date),x=new Date(s==null?void 0:s.value.resumption_date)-r;return Math.ceil(x/(1e3*60*60*24))-1});return(r,t)=>{var x,g,j,L,C,D,B,R,N,W,I,T,S,$,H,M,V,O,F,P,E,U,z,G,J,q,K,Q,X,Y,Z,ee,te,se,le,ae,oe,ne,re,de,ie,ue,pe,ce,ve,be,_e,ye,xe,me,fe,ge,ke,we,Ae,he,je,Le,Ce,De,Be,Re,Ne,We,Ie,Te,Se,$e,He,Me,Ve,Oe,Fe,Pe,Ee,Ue,ze,Ge,Je,qe,Ke,Qe,Xe,Ye,Ze,et,tt,st,lt,at,ot,nt,rt;return d(),i(m,null,[e("div",Nt,[e("div",{class:"flex items-center justify-between gap-2 print:hidden"},[e("button",{class:"btn-3",onClick:ft},t[8]||(t[8]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[10]||(t[10]=e("h1",{class:"title-md md:title-xl flex-wrap text-center"},"Leave Application",-1)),e("div",null,[e("button",{class:"btn-2",onClick:mt},t[9]||(t[9]=[e("i",{class:"far fa-print"},null,-1),a(" Print ")]))])]),A.value?(d(),wt(Dt,{key:0})):(d(),i("div",Wt,[e("div",null,[e("h1",It,l((j=(g=(x=s.value)==null?void 0:x.user)==null?void 0:g.company)==null?void 0:j.name),1),e("p",Tt,l((C=(L=s.value)==null?void 0:L.user)==null?void 0:C.company.address),1)]),e("div",St,[e("div",$t,[e("div",null,[t[11]||(t[11]=e("p",null,"To",-1)),t[12]||(t[12]=e("p",{class:"font-bold"},"Managing Director",-1)),e("p",Ht,l((D=s.value)==null?void 0:D.company_name),1),e("p",Mt,l((B=s.value)==null?void 0:B.company_address),1),t[13]||(t[13]=e("div",null,[e("p",{class:"pt-6"},[e("b",null,"Subject:"),a(" Leave Application")])],-1))]),e("div",Vt,[e("div",null,[t[17]||(t[17]=e("h1",{class:"font-bold"},"Summary",-1)),e("table",Ot,[t[16]||(t[16]=e("thead",null,[e("tr",{class:"bg-gray-200 border border-black"},[e("th",{class:"border border-black px-2"},"Type"),e("th",{class:"border border-black px-2"},"Days")])],-1)),e("tbody",null,[(d(!0),i(m,null,w((R=s.value)==null?void 0:R.leave_types,(o,n)=>(d(),i("tr",{key:n,class:"border border-black"},[e("td",Ft,l(o.type),1),e("td",Pt,l(o.days),1)]))),128)),e("tr",null,[t[14]||(t[14]=e("td",{class:"border-black px-2"},"WL/GHD",-1)),e("td",Et,l(h.value-((N=s.value)==null?void 0:N.total_leave_days)),1)]),e("tr",Ut,[t[15]||(t[15]=e("td",{class:"border border-black px-2"},"Total",-1)),e("td",zt,l(h.value),1)])])])]),e("div",null,[t[21]||(t[21]=e("h1",{class:"font-bold"},"Last Leave",-1)),e("div",null,[e("table",Gt,[e("thead",null,[t[18]||(t[18]=e("tr",{class:"bg-gray-200 border border-black"},[e("th",{colspan:"2",class:"border border-black px-2"},"Date")],-1)),e("tr",Jt,[e("td",qt,l(((I=(W=s.value)==null?void 0:W.last_leave)==null?void 0:I.date)||"N/A"),1)]),t[19]||(t[19]=e("tr",{class:"bg-gray-200 border border-black"},[e("th",{class:"border border-black px-2"},"Type"),e("th",{class:"border border-black px-2"},"Days")],-1))]),e("tbody",null,[(d(!0),i(m,null,w((S=(T=s.value)==null?void 0:T.last_leave)==null?void 0:S.types,(o,n)=>(d(),i("tr",{key:n,class:"border border-black"},[e("td",Kt,l(o==null?void 0:o.type),1),e("td",Qt,l(o==null?void 0:o.days),1)]))),128)),e("tr",Xt,[t[20]||(t[20]=e("td",{class:"border border-black px-2"},"Total",-1)),e("td",Yt,l((H=($=s.value)==null?void 0:$.last_leave)!=null&&H.types?s.value.last_leave.types.reduce((o,n)=>o+n.days,0):0),1)])])])])])])]),e("div",Zt,[e("div",es,[e("p",null,[t[22]||(t[22]=a("Name: ")),e("b",null,l((M=s.value)==null?void 0:M.user_name),1)])]),e("div",ts,[e("p",null,[t[23]||(t[23]=a("Designation: ")),e("b",null,l((V=s.value)==null?void 0:V.designation_title),1)])]),e("div",ss,[e("p",null,[t[24]||(t[24]=a("Phone: ")),e("b",null,l((O=s.value)==null?void 0:O.user_phone),1)])])]),e("div",null,[t[31]||(t[31]=e("h3",{class:"font-bold"},"Leave Details:",-1)),e("div",ls,[e("li",null,[t[25]||(t[25]=e("strong",null,"Reason: ",-1)),a(l(((F=s.value)==null?void 0:F.reason)||"No reason provided"),1)]),e("li",null,[t[26]||(t[26]=e("strong",null,"Leave Days:",-1)),a(" "+l((P=s.value)==null?void 0:P.leave_period),1)]),e("li",null,[t[27]||(t[27]=e("strong",null,"Total Days:",-1)),a(" "+l((E=s.value)==null?void 0:E.total_leave_days),1)]),e("li",null,[t[28]||(t[28]=e("strong",null,"Weekends:",-1)),a(" "+l(JSON.parse(((U=s.value)==null?void 0:U.weekends)||"[]").join(", ")),1)]),e("li",null,[t[29]||(t[29]=e("strong",null,"Last Working Date:",-1)),a(" "+l((z=s.value)==null?void 0:z.last_working_date),1)]),e("li",null,[t[30]||(t[30]=e("strong",null,"Resumption Date:",-1)),a(" "+l((G=s.value)==null?void 0:G.resumption_date),1)])])]),e("div",as,[e("div",null,[e("div",os,[e("p",null,[t[32]||(t[32]=e("strong",null,"Works in Hand: ",-1)),a(l(((J=s.value)==null?void 0:J.works_in_hand)||"No details provided"),1)])])]),e("div",ns,[e("p",null,l(((q=s.value)==null?void 0:q.handover_user_name)||"Not assigned"),1),!((K=s.value)!=null&&K.status)&&((Q=s.value)==null?void 0:Q.handover_user_id)===((Y=(X=v(c))==null?void 0:X.user)==null?void 0:Y.id)?(d(),i("div",rs,[e("p",ds,[a(l((Z=s.value)==null?void 0:Z.user_name)+" has assigned you for his handover. ",1),t[33]||(t[33]=e("br",null,null,-1)),t[34]||(t[34]=a(" Do you agree? "))]),e("div",is,[e("button",{class:"font-bold text-lg text-green-600 px-2",onClick:t[0]||(t[0]=o=>{var n;return ct((n=s.value)==null?void 0:n.id)})}," ✔ "),t[35]||(t[35]=e("button",{class:"px-2"},"❌",-1))])])):p("",!0),t[38]||(t[38]=e("hr",{class:"w-44 border-black"},null,-1)),e("h4",us,[t[37]||(t[37]=a(" Handover ")),(ee=s.value)!=null&&ee.handover_user_id&&((te=s.value)!=null&&te.status)?(d(),i("span",ps," (✔) ")):p("",!0),(se=s.value)!=null&&se.handover_user_id&&!((le=s.value)!=null&&le.status)?(d(),i("span",cs,t[36]||(t[36]=[e("i",{class:"fad fa-spinner"},null,-1)]))):p("",!0)])])]),e("div",null,[t[40]||(t[40]=e("h1",{class:"font-bold"},"Leave Balance",-1)),e("div",vs,[e("table",bs,[t[39]||(t[39]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-500 px-4 py-0.5 text-left"},"Leave Type"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Total Days"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Used Days"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Remaining Days")])],-1)),e("tbody",null,[(d(!0),i(m,null,w((ae=s.value)==null?void 0:ae.leave_balance,(o,n)=>(d(),i("tr",{key:n,class:"hover:bg-blue-200"},[e("td",_s,l(o.leave_type),1),e("td",ys,l(o.total_leave_days),1),e("td",xs,l(o.used_days),1),e("td",{class:it(["border border-gray-500 px-4 py-0.5 text-center",{"text-green-600 font-bold":o.remaining_days>0,"text-red-600 font-bold":o.remaining_days===0}])},l(o.remaining_days),3)]))),128))])])])])]),e("div",ms,[e("p",fs,[t[41]||(t[41]=a(" Leave Approval: ")),e("b",{class:it({"text-yellow-600":((oe=s.value)==null?void 0:oe.status)==="Pending","text-green-600":((ne=s.value)==null?void 0:ne.status)==="Approved","text-red-600":((re=s.value)==null?void 0:re.status)==="Rejected"})},l(((de=s.value)==null?void 0:de.status)||"N/A"),3)]),((ie=s.value)==null?void 0:ie.status)==="Rejected"?(d(),i("div",gs,[e("p",null,[t[42]||(t[42]=e("b",null,"Rejected by: ",-1)),a(" "+l((pe=(ue=s.value)==null?void 0:ue.rejected_by_user)==null?void 0:pe.name),1)]),e("p",null,[t[43]||(t[43]=e("b",null,"rejection Reason: ",-1)),a(" "+l(s.value.rejection_reason),1)])])):p("",!0),e("div",ks,[e("div",ws,[((ce=s.value)==null?void 0:ce.status)!=="Rejected"&&((ve=s.value)==null?void 0:ve.status)!=="Approved"&&!((be=s.value)!=null&&be.in_charge_user_id)&&((_e=s.value)==null?void 0:_e.approval_in_charge_user_id)===((xe=(ye=v(c))==null?void 0:ye.user)==null?void 0:xe.id)?(d(),i("div",As,[e("p",hs,l(((me=s.value)==null?void 0:me.in_charge_user_name)||"N/A"),1),e("p",js,[a(l((fe=s.value)==null?void 0:fe.user_name)+" has submitted an application. ",1),t[44]||(t[44]=e("br",null,null,-1)),t[45]||(t[45]=a(" Will you forward it? "))]),e("div",Ls,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[1]||(t[1]=o=>{var n;return vt((n=s.value)==null?void 0:n.id)})}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):p("",!0),e("p",null,l(((ge=s.value)==null?void 0:ge.in_charge_user_name)||""),1),t[47]||(t[47]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Cs,[t[46]||(t[46]=a(" In-Charge ")),(ke=s.value)!=null&&ke.in_charge_user_id?(d(),i("span",Ds,"(✔)")):p("",!0)])]),e("div",Bs,[((we=s.value)==null?void 0:we.status)!=="Rejected"&&((Ae=s.value)==null?void 0:Ae.status)!=="Approved"&&!((he=s.value)!=null&&he.coordinator_user_id)&&((je=s.value)==null?void 0:je.approval_coordinator_user_id)===((Ce=(Le=v(c))==null?void 0:Le.user)==null?void 0:Ce.id)?(d(),i("div",Rs,[e("p",Ns,l(((De=s.value)==null?void 0:De.approval_coordinator_user_name)||"N/A"),1),e("p",Ws,[a(l((Be=s.value)==null?void 0:Be.user_name)+" has submitted an application. ",1),t[48]||(t[48]=e("br",null,null,-1)),t[49]||(t[49]=a(" Will you recommend it? "))]),e("div",Is,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[2]||(t[2]=o=>{var n;return bt((n=s.value)==null?void 0:n.id)})}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):p("",!0),e("p",null,l(((Re=s.value)==null?void 0:Re.approval_coordinator_user_name)||""),1),t[51]||(t[51]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Ts,[t[50]||(t[50]=a(" Coordinator ")),(Ne=s.value)!=null&&Ne.coordinator_user_id?(d(),i("span",Ss,"(✔)")):p("",!0)])]),e("div",$s,[((We=s.value)==null?void 0:We.status)!=="Rejected"&&((Ie=s.value)==null?void 0:Ie.status)!=="Approved"&&!((Te=s.value)!=null&&Te.operational_admin_user_id)&&((Se=s.value)==null?void 0:Se.approval_operational_admin_user_id)===((He=($e=v(c))==null?void 0:$e.user)==null?void 0:He.id)?(d(),i("div",Hs,[e("p",Ms,l(((Me=s.value)==null?void 0:Me.operational_admin_user_name)||"N/A"),1),e("p",Vs,[a(l((Ve=s.value)==null?void 0:Ve.user_name)+" has submitted an application.",1),t[52]||(t[52]=e("br",null,null,-1)),t[53]||(t[53]=a(" Will you recommend it? "))]),e("div",Os,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[3]||(t[3]=o=>{var n;return _t((n=s.value)==null?void 0:n.id)})}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):p("",!0),e("p",null,l(((Oe=s.value)==null?void 0:Oe.operational_admin_user_name)||""),1),t[55]||(t[55]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Fs,[t[54]||(t[54]=a(" Operational Admin ")),(Fe=s.value)!=null&&Fe.operational_admin_user_id?(d(),i("span",Ps,"(✔)")):p("",!0)])])]),e("div",Es,[e("div",Us,[((Pe=s.value)==null?void 0:Pe.status)!=="Rejected"&&((Ee=s.value)==null?void 0:Ee.status)!=="Approved"&&!((Ue=s.value)!=null&&Ue.recommend_by_user_id)&&((ze=s.value)==null?void 0:ze.approval_recommend_by_user_id)===((Je=(Ge=v(c))==null?void 0:Ge.user)==null?void 0:Je.id)?(d(),i("div",zs,[e("p",Gs,l(((qe=s.value)==null?void 0:qe.recommend_by_user_name)||"N/A"),1),e("p",Js,[a(l((Ke=s.value)==null?void 0:Ke.user_name)+" has submitted an application.",1),t[56]||(t[56]=e("br",null,null,-1)),t[57]||(t[57]=a(" Will you recommend it? "))]),e("div",qs,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[4]||(t[4]=o=>{var n;return yt((n=s.value)==null?void 0:n.id)})}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):p("",!0),e("p",null,l(((Qe=s.value)==null?void 0:Qe.recommend_by_user_name)||""),1),t[59]||(t[59]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Ks,[t[58]||(t[58]=a(" Recommend By ")),(Xe=s.value)!=null&&Xe.recommend_by_user_id?(d(),i("span",Qs,"(✔)")):p("",!0)])]),e("div",Xs,[((Ye=s.value)==null?void 0:Ye.status)!=="Rejected"&&((Ze=s.value)==null?void 0:Ze.status)!=="Approved"&&!((et=s.value)!=null&&et.approved_by_user_id)&&((tt=s.value)==null?void 0:tt.approval_approved_by_user_id)===((lt=(st=v(c))==null?void 0:st.user)==null?void 0:lt.id)?(d(),i("div",Ys,[e("p",Zs,l(((at=s.value)==null?void 0:at.approved_by_user_name)||"N/A"),1),e("p",el,[a(l((ot=s.value)==null?void 0:ot.user_name)+" has submitted an application.",1),t[60]||(t[60]=e("br",null,null,-1)),t[61]||(t[61]=a(" Will you accept it? "))]),e("div",tl,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[5]||(t[5]=o=>{var n;return xt((n=s.value)==null?void 0:n.id)})}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):p("",!0),e("p",null,l(((nt=s.value)==null?void 0:nt.approved_by_user_name)||""),1),t[63]||(t[63]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",sl,[t[62]||(t[62]=a(" Approved By ")),(rt=s.value)!=null&&rt.approved_by_user_id?(d(),i("span",ll,"(✔)")):p("",!0)])])])])])),At(Bt)]),_.value?(d(),i("div",al,[e("div",ol,[t[64]||(t[64]=e("h3",{class:"title-lg"},"Reject Application",-1)),ht(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=o=>y.value=o),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[jt,y.value]]),e("div",nl,[e("button",{class:"btn-3",onClick:t[7]||(t[7]=o=>_.value=!1)},"Cancel"),e("button",{class:"btn-2 bg-red-500 text-white",onClick:pt},"Confirm")])])])):p("",!0)],64)}}};export{vl as default};
