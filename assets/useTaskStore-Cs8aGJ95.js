import{D as E,r as v,y as c,E as i}from"./index-CrTPVCmM.js";const D=E("task",()=>{const o=v([]),f=v(null),l=v(!1),n=v(null),h=async(a,t)=>{var s,e;l.value=!0,n.value=null;try{await i.post(`/tasks/${a}/assign-users`,{user_ids:t}),await g(a)}catch(r){throw n.value=((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.message)||"Assign users failed",r}finally{l.value=!1}},p=async a=>{var t,s;l.value=!0,n.value=null;try{const e=await i.get("/tasks",{params:a});o.value=e.data}catch(e){n.value=((s=(t=e.response)==null?void 0:t.data)==null?void 0:s.message)||"টাস্ক লোড করতে ব্যর্থ হয়েছে।",console.error("Error fetching tasks:",e)}finally{l.value=!1}};function d(a,t=0){return Array.isArray(a)===!1||a.length===0?[]:a.filter(s=>s.parent_id===t).map(s=>({...s,children_tasks:d(a,s.id)}))}function k(){return d(o.value,0)}function y(){const a=[],t=(s,e=0,r="")=>{s.forEach(u=>{a.push({...u,depth:e,idPath:r+u.id}),u.children_tasks&&u.children_tasks.length&&t(u.children_tasks,e+1,r+u.id+"-")})};return t(k()),a}const g=async(a,t={})=>{var s,e;l.value=!0,n.value=null;try{const r=await i.get(`/tasks/${a}`,{params:t});f.value=r.data}catch(r){n.value=((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.message)||`টাস্ক (ID: ${a}) লোড করতে ব্যর্থ হয়েছে।`,console.error(`Error fetching task with id ${a}:`,r)}finally{l.value=!1}},T=async a=>{var t,s;l.value=!0,n.value=null;try{const e=await i.post("/tasks",a);return o.value.push(e.data.data),e.data.data}catch(e){n.value=((s=(t=e.response)==null?void 0:t.data)==null?void 0:s.message)||"টাস্ক তৈরি করতে ব্যর্থ হয়েছে।",console.error("Error creating task:",e)}finally{l.value=!1}},w=async(a,t)=>{var s,e;l.value=!0,n.value=null;try{const r=await i.put(`/tasks/${a}`,t),u=o.value.findIndex(m=>m.id===a);return u!==-1&&(o.value[u]=r.data.data),r.data.data}catch(r){n.value=((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.message)||`টাস্ক (ID: ${a}) আপডেট করতে ব্যর্থ হয়েছে।`,console.error(`Error updating task with id ${a}:`,r)}finally{l.value=!1}},$=async a=>{var t,s;l.value=!0,n.value=null;try{await i.delete(`/tasks/${a}`),o.value=o.value.filter(e=>e.id!==a)}catch(e){n.value=((s=(t=e.response)==null?void 0:t.data)==null?void 0:s.message)||`টাস্ক (ID: ${a}) মুছতে ব্যর্থ হয়েছে।`,console.error(`Error deleting task with id ${a}:`,e)}finally{l.value=!1}};return{tasks:c(()=>o.value),task:c(()=>f.value),loading:c(()=>l.value),error:c(()=>n.value),taskListTree:c(k),flattenedTasks:c(y),fetchTasks:p,fetchTask:g,createTask:T,updateTask:w,deleteTask:$,assignUsers:h}});export{D as u};
