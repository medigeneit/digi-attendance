import{z as k,i as L,r as F,b as M,q as U,c as r,a as s,j as C,w as T,d,A as g,F as w,x,h as N,v as m,l as S,m as B,f as E,g as R,n as j,o as a,t as _,k as q}from"./index-D0JB0D2q.js";import{L as I}from"./LoaderView-C4HG2KBN.js";import{u as P}from"./company-Bw3sT2gS.js";import{u as z}from"./department-CD3sThMW.js";import{u as A}from"./notice-BO0vnCOj.js";import{_ as $}from"./TextEditor-BpTiKEr4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"my-container space-y-2"},H={class:"card-bg md:p-8 p-4 mx-4"},J={class:"grid gap-4"},K={class:"border p-4 rounded-md bg-gray-100"},O={class:"grid md:grid-cols-2 gap-4"},Q=["value"],W=["value"],X={class:"col-span-full"},Y={class:"flex justify-center gap-4"},ae={__name:"NoticeEdit",setup(Z){const o=k({title:"",description:"",published_at:"",expired_at:"",company_id:"",department_id:"",file:""}),f=A(),b=P(),c=z(),u=L(),p=E(),v=R(),n=F(!1);M(async()=>{n.value=!0,await b.fetchCompanies(),await V(),n.value=!1}),U(()=>o.company_id,async l=>{l&&(await c.fetchDepartments(l),n.value=!1)});const y=l=>{if(!l)return;const e=l.split(" ")[0];if(!e.includes("-")){formattedDate.value="Invalid Date Format";return}return e},V=async()=>{var l,e;try{const i=p.params.id,t=await f.fetchNotice(i);o.title=t.title,o.file=t.file,o.published_at=y(t.published_at),o.expired_at=y(t.expired_at),o.description=t.description,o.company_id=t.company_id,o.department_id=t.department_id}catch(i){const t=((e=(l=i.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to load notice data";u.error(t),v.push({name:"NoticeList"})}},D=async()=>{var l,e;try{const i={...o};await f.updateNotice(p.params.id,i),u.success("Notice updated successfully"),v.push({name:"NoticeShow",params:{id:p.params.id}})}catch(i){const t=((e=(l=i.response)==null?void 0:l.data)==null?void 0:e.message)||"Failed to update notice";u.error(t)}};return(l,e)=>{const i=j("RouterLink");return a(),r("div",G,[s("div",H,[e[19]||(e[19]=s("h2",{class:"title-lg text-center"},"Edit Notice",-1)),n.value?(a(),C(I,{key:0,class:"bg-gray-100 border shadow-none"})):(a(),r("form",{key:1,onSubmit:T(D,["prevent"]),class:"space-y-4"},[s("div",J,[s("div",K,[e[15]||(e[15]=s("p",{class:"title-md"},"Notice Info",-1)),e[16]||(e[16]=s("hr",{class:"my-2"},null,-1)),s("div",O,[s("div",null,[e[7]||(e[7]=s("label",null,"Company",-1)),d(s("select",{id:"company_id","onUpdate:modelValue":e[0]||(e[0]=t=>o.company_id=t),class:"w-full border rounded px-3 py-2",required:""},[e[6]||(e[6]=s("option",{value:"",disabled:""},"Select a company",-1)),(a(!0),r(w,null,x(N(b).companies,t=>(a(),r("option",{key:t==null?void 0:t.id,value:t==null?void 0:t.id},_(t==null?void 0:t.name),9,Q))),128))],512),[[g,o.company_id]])]),s("div",null,[e[9]||(e[9]=s("label",null,"Department",-1)),d(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>o.department_id=t),class:"w-full p-2 border rounded"},[e[8]||(e[8]=s("option",{value:"",disabled:""},"Select a department",-1)),(a(!0),r(w,null,x(N(c).departments,t=>(a(),r("option",{key:t==null?void 0:t.id,value:t==null?void 0:t.id},_(t==null?void 0:t.name),9,W))),128))],512),[[g,o.department_id]])]),s("div",null,[e[10]||(e[10]=s("label",null,"Publish Date",-1)),d(s("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>o.published_at=t),type:"date",class:"w-full p-2 border rounded"},null,512),[[m,o.published_at]])]),s("div",null,[e[11]||(e[11]=s("label",null,"Expire Date",-1)),d(s("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>o.expired_at=t),type:"date",class:"w-full p-2 border rounded"},null,512),[[m,o.expired_at]])]),s("div",null,[e[12]||(e[12]=s("label",null,"Title*",-1)),d(s("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>o.title=t),type:"text",class:"w-full p-2 border rounded"},null,512),[[m,o.title]])]),e[14]||(e[14]=s("div",null,[s("label",null,"File"),s("input",{type:"file",class:"w-full p-2 border rounded"})],-1)),s("div",X,[e[13]||(e[13]=s("label",null,"Description",-1)),S($,{modelValue:o.description,"onUpdate:modelValue":e[5]||(e[5]=t=>o.description=t),cols:"30",rows:"10",class:"w-full px-4 py-2"},null,8,["modelValue"])])])])]),s("div",Y,[S(i,{to:{name:"NoticeList"},type:"button",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:B(()=>e[17]||(e[17]=[q(" Cancel ")])),_:1}),e[18]||(e[18]=s("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"}," Save ",-1))])],32))])])}}};export{ae as default};
