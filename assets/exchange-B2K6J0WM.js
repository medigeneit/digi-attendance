import{B as _,r as h,C as r,ac as j}from"./index-C3uoN6Yl.js";const U=_("exchange",()=>{const g=h([]),o=h([]),i=h(null),c=h(!1),s=h(null),f=h(new Date().toISOString().substring(0,7)),d=h("");async function p(e={}){var n,t;c.value=!0,s.value=null;try{const a=await r.get("/all-exchanges",{params:e});g.value=a==null?void 0:a.data}catch(a){s.value=((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to fetch exchanges"}finally{c.value=!1}}async function x({payload:e}){var n,t;c.value=!0,s.value=null;try{const a=await r.get(`/exchanges?type=${e.type}`,e);o.value=a.data.data}catch(a){s.value=((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to fetch exchanges"}finally{c.value=!1}}async function m(e){var n,t;c.value=!0,s.value=null;try{const a=await r.get(`/exchanges/${e}`);i.value=a.data,await j().fetchApprovalPermissions(`${i.value.exchange_type}_exchange_applications`,i.value.id)}catch(a){s.value=((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||`Failed to fetch exchange with ID ${e}`}finally{c.value=!1}}async function y(e){var n,t,a,l;c.value=!0,s.value=null;try{const u=await r.post("/exchanges",e);return o.value.push((n=u==null?void 0:u.data)==null?void 0:n.data),(t=u==null?void 0:u.data)==null?void 0:t.data}catch(u){s.value=((l=(a=u.response)==null?void 0:a.data)==null?void 0:l.message)||"Failed to create exchange"}finally{c.value=!1}}async function w(e,n){var t,a;c.value=!0,s.value=null;try{const l=await r.put(`/exchanges/${e}`,n),u=o.value.findIndex(v=>v.id===e);u!==-1&&(o.value[u]=l.data)}catch(l){s.value=((a=(t=l.response)==null?void 0:t.data)==null?void 0:a.message)||`Failed to update exchange with ID ${e}`}finally{c.value=!1}}async function $(e,n){var t,a;c.value=!0,s.value=null;try{const l=await r.put(`/attachment-upload/exchanges/${e}`,n),u=o.value.findIndex(v=>v.id===e);u!==-1&&(o.value[u]=l.data)}catch(l){s.value=((a=(t=l.response)==null?void 0:t.data)==null?void 0:a.message)||`Failed to update exchange with ID ${e}`}finally{c.value=!1}}async function F(e){var n,t;c.value=!0,s.value=null;try{await r.delete(`/exchanges/${e}`),o.value=o.value.filter(a=>a.id!==e)}catch(a){s.value=((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||`Failed to delete exchange with ID ${e}`}finally{c.value=!1}}async function I(e){var n,t;c.value=!0,s.value=null;try{const a=await r.post(`/exchanges/${e.id}/handover-accept`,e);i.value=a.data}catch(a){s.value=((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||`Failed to accept handover for exchange ID ${e.id}`}finally{c.value=!1}}async function D(e){var n,t;c.value=!0,s.value=null;try{const a=await r.post(`/exchanges/${e==null?void 0:e.id}/in-charge-accept`,e);i.value=a.data}catch(a){s.value=((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||`Failed to accept in-charge for exchange ID ${e.id}`}finally{c.value=!1}}async function E(e){var n,t;c.value=!0,s.value=null;try{const a=await r.post(`/exchanges/${e==null?void 0:e.id}/recommend-accept`,e);i.value=a.data}catch(a){s.value=((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||`Failed to recommend exchange ID ${e.id}`}finally{c.value=!1}}async function S(e){var n,t;c.value=!0,s.value=null;try{const a=await r.post(`/exchanges/${e==null?void 0:e.id}/approve`,e);i.value=a.data}catch(a){s.value=((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||`Failed to approve exchange ID ${e.id}`}finally{c.value=!1}}async function A(e,n){var t,a;c.value=!0,s.value=null;try{const l=await r.post(`/exchanges/${e}/reject`,{rejection_reason:n});i.value=l.data}catch(l){s.value=((a=(t=l.response)==null?void 0:t.data)==null?void 0:a.message)||`Failed to reject exchange ID ${e}`}finally{c.value=!1}}return{all_exchanges:g,exchanges:o,selectedMonth:f,selectedStatus:d,exchange:i,loading:c,error:s,fetchAllExchanges:p,fetchExchanges:x,fetchExchange:m,createExchange:y,updateExchange:w,deleteExchange:F,handoverAccept:I,inChargeAccept:D,recommendByAccept:E,approvedByAccept:S,rejectExchange:A,fetchFileUpload:async e=>{var n,t;try{return c.value=!0,(await r.post("attachment-upload",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(a){s.value=((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.message)||"Something went wrong"}finally{c.value=!1}},uploadAttachmentExchange:$}});export{U as u};
