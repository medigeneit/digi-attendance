import{N as B,r as N,y as w,o as r,c as i,a as t,w as kt,t as s,d as wt,v as At,q as R,l as n,e as L,h as $t,k as _t,u as ht,b as Dt,F as T,x as C,m as x,f as jt,g as St}from"./index-B7En1lXJ.js";import{L as Lt}from"./LoaderView-zFXZN7M5.js";import{_ as Tt}from"./ShareComponent-PEgGT2FG.js";import{u as Ct}from"./leave-application-kBqy_3xS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Nt={class:"flex justify-center items-center gap-4"},Rt={class:"modal-card"},Bt={class:"title-lg"},Mt=["placeholder"],It={class:"flex justify-between gap-2 mt-4"},Wt={class:"capitalize hidden md:inline"},Vt={__name:"AcceptAndRejectHandler",props:{notificationType:{type:String,required:!0},applicationId:{type:[String,Number],required:!0},onSuccess:{type:Function,default:()=>{}}},setup(o){const v=o,A=B(),d=N(null),u=N(""),l=w(()=>d.value!==null),f=w(()=>d.value==="accept"?"Accept Application":"Reject Application");w(()=>d.value==="accept"?"btn-2":"btn-2 bg-red-500 text-white");function c(p){(p==="accept"||p==="reject")&&(d.value=p,u.value="")}function y(){d.value=null,u.value=""}async function m(){await A.updateSpecificNotification(v.notificationType,v.applicationId,d.value,u.value),v.onSuccess(),y()}return(p,e)=>(r(),i("div",null,[t("div",Nt,[t("button",{onClick:e[0]||(e[0]=b=>c("accept")),class:"font-bold text-lg text-green-600"},"✔"),t("button",{onClick:e[1]||(e[1]=b=>c("reject")),class:""},"❌")]),l.value?(r(),i("div",{key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50",onClick:kt(y,["self"])},[t("div",Rt,[t("h3",Bt,s(f.value),1),wt(t("textarea",{"onUpdate:modelValue":e[2]||(e[2]=b=>u.value=b),rows:"7",placeholder:`Enter ${d.value==="accept"?"accept":"rejection"} note...`,class:"w-full border rounded-lg p-2 text-gray-700"},null,8,Mt),[[At,u.value]]),t("div",It,[t("button",{class:"btn-3",onClick:y},"Cancel"),t("button",{class:R(d.value==="reject"?"btn-2-red":"btn-2-green"),onClick:m},[e[3]||(e[3]=n(" Confirm ")),t("span",Wt,s(d.value),1)],2)])])])):L("",!0)]))}},Ft={class:"flex flex-col justify-center items-center"},Pt={key:0},qt={class:"text-xs text-gray-400 text-center"},zt={key:1,class:"text-center"},Ht={class:"font-bold"},Ut={key:0,class:"text-green-600"},Et={key:1,class:"pl-2 text-yellow-700"},k={__name:"ApprovalItem",props:{application:Object,type:String,item:String,onAction:{type:Function,default:()=>{}}},setup(o){const v=o,A=B(),d=w(()=>v.item?v.item.replace(/[_-]/g," ").replace(/([A-Z])/g," $1").replace(/\s+/g," ").trim().split(" ").map(u=>u.charAt(0).toUpperCase()+u.slice(1)).join(" "):"");return(u,l)=>{var f,c,y,m,p,e,b,_,$,h,D,j,S;return r(),i("div",Ft,[(f=o.application)!=null&&f[`${o.item}_user_id`]?(r(),i("div",Pt,[t("p",null,s(((y=(c=o.application)==null?void 0:c[`${o.item}_user`])==null?void 0:y.name)||""),1),t("p",qt,s((m=o.application)==null?void 0:m[`${o.item}_note`]),1)])):(r(),i("p",zt,s(((_=(b=(e=(p=o.application)==null?void 0:p.user)==null?void 0:e.leave_approval)==null?void 0:b[`${o.item}_user`])==null?void 0:_.name)||"N/A"),1)),($=$t(A).approvalPermissions)!=null&&$[`allow_${o.item}`]?(r(),_t(Vt,{key:2,notificationType:o.type,applicationId:o.application.id,onSuccess:o.onAction},null,8,["notificationType","applicationId","onSuccess"])):L("",!0),l[1]||(l[1]=t("hr",{class:"w-44 border-black my-1"},null,-1)),t("div",Ht,[n(s(d.value)+" ",1),(h=o.application)!=null&&h[`${o.item}_user_id`]?(r(),i("span",Ut,"(✔)")):(S=(j=(D=o.application)==null?void 0:D.user)==null?void 0:j.leave_approval)!=null&&S[`${o.item}_user_id`]?(r(),i("span",Et,l[0]||(l[0]=[t("i",{class:"fad fa-spinner"},null,-1)]))):L("",!0)])])}}},Ot={class:"my-container max-w-3xl space-y-6"},Gt={key:1,class:"card-bg p-4 md:p-8"},Zt={class:"title-lg text-center"},Jt={class:"text-center text-sm"},Kt={class:"space-y-4"},Qt={class:"grid md:grid-cols-2 print:grid-cols-2 gap-8"},Xt={class:""},Yt={class:"text-sm"},te={class:"flex justify-end gap-4"},ee={class:"table-auto border border-black bg-white text-xs"},le={class:"border border-black px-2"},se={class:"border border-black px-2"},oe={class:"border border-black px-2"},ae={class:"font-bold"},ne={class:"border border-black px-2"},re={class:"table-auto border border-black bg-white text-xs"},ie={class:"border border-black"},de={colspan:"2",class:"border border-black px-2 w-32"},ue={class:"border border-black px-2"},ce={class:"border border-black px-2"},pe={class:"font-bold"},be={class:"border border-black px-2"},ve={class:"grid print:grid-cols-2 md:grid-cols-2 text-sm"},ye={class:"text-sm"},me={class:"pt-8 grid grid-cols-2"},ge={class:"text-sm"},xe={class:"overflow-x-auto"},fe={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},_e={class:"border border-gray-500 px-4 py-0.5 text-left"},ke={class:"border border-gray-500 px-4 py-0.5 text-center"},we={class:"border border-gray-500 px-4 py-0.5 text-center"},Ae={class:"space-y-14"},$e={class:"font-bold text-center text-lg"},he={key:0},De={class:"grid md:grid-cols-3 print:grid-cols-3 gap-4 text-sm items-end"},je={class:"flex justify-evenly text-sm items-end"},Re={__name:"LeaveApplicationShow",setup(o){ht(),B();const v=Ct(),A=St(),d=jt(),u=N(!0),l=w(()=>v.leaveApplication);Dt(async()=>{try{await v.fetchLeaveApplicationById(d.params.id)}catch(p){console.error("Failed to load leave application:",p)}finally{u.value=!1}});function f(){window.print()}const c=async()=>{await v.fetchLeaveApplicationById(d.params.id)},y=()=>A.go(-1),m=w(()=>{if(!l.value||!l.value.last_working_date||!l.value.resumption_date)return 0;const p=new Date(l==null?void 0:l.value.last_working_date),b=new Date(l==null?void 0:l.value.resumption_date)-p;return Math.ceil(b/(1e3*60*60*24))-1});return(p,e)=>{var b,_,$,h,D,j,S,M,I,W,V,F,P,q,z,H,U,E,O,G,Z,J,K,Q,X,Y,tt,et,lt,st,ot,at,nt,rt,it,dt,ut,ct,pt,bt,vt,yt,mt,gt,xt,ft;return r(),i("div",Ot,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:y},e[0]||(e[0]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[2]||(e[2]=t("h1",{class:"title-md md:title-xl flex-wrap text-center"},"Leave Application",-1)),t("div",null,[t("button",{class:"btn-2",onClick:f},e[1]||(e[1]=[t("i",{class:"far fa-print"},null,-1),n(" Print ")]))])]),u.value?(r(),_t(Lt,{key:0})):(r(),i("div",Gt,[t("div",null,[t("h1",Zt,s(($=(_=(b=l.value)==null?void 0:b.user)==null?void 0:_.company)==null?void 0:$.name),1),t("p",Jt,s((D=(h=l.value)==null?void 0:h.user)==null?void 0:D.company.address),1)]),t("div",Kt,[t("div",Qt,[t("div",null,[e[3]||(e[3]=t("p",null,"To",-1)),e[4]||(e[4]=t("p",{class:"font-bold"},"Managing Director",-1)),t("p",Xt,s((M=(S=(j=l.value)==null?void 0:j.user)==null?void 0:S.company)==null?void 0:M.name),1),t("p",Yt,s((W=(I=l.value)==null?void 0:I.user)==null?void 0:W.company.address),1),e[5]||(e[5]=t("div",null,[t("p",{class:"pt-6"},[t("b",null,"Subject:"),n(" Leave Application")])],-1))]),t("div",te,[t("div",null,[e[9]||(e[9]=t("h1",{class:"font-bold"},"Summary",-1)),t("table",ee,[e[8]||(e[8]=t("thead",null,[t("tr",{class:"bg-gray-200 border border-black"},[t("th",{class:"border border-black px-2"},"Type"),t("th",{class:"border border-black px-2"},"Days")])],-1)),t("tbody",null,[(r(!0),i(T,null,C((V=l.value)==null?void 0:V.leave_types,(a,g)=>(r(),i("tr",{key:g,class:"border border-black"},[t("td",le,s(a.type),1),t("td",se,s(a.days),1)]))),128)),t("tr",null,[e[6]||(e[6]=t("td",{class:"border-black px-2"},"WL/GHD",-1)),t("td",oe,s(m.value-((P=(F=l.value)==null?void 0:F.leave_days)==null?void 0:P.length)),1)]),t("tr",ae,[e[7]||(e[7]=t("td",{class:"border border-black px-2"},"Total",-1)),t("td",ne,s(m.value),1)])])])]),t("div",null,[e[13]||(e[13]=t("h1",{class:"font-bold"},"Last Leave",-1)),t("div",null,[t("table",re,[t("thead",null,[e[10]||(e[10]=t("tr",{class:"bg-gray-200 border border-black"},[t("th",{colspan:"2",class:"border border-black px-2"},"Date")],-1)),t("tr",ie,[t("td",de,s(((z=(q=l.value)==null?void 0:q.last_leave)==null?void 0:z.date)||"N/A"),1)]),e[11]||(e[11]=t("tr",{class:"bg-gray-200 border border-black"},[t("th",{class:"border border-black px-2"},"Type"),t("th",{class:"border border-black px-2"},"Days")],-1))]),t("tbody",null,[(r(!0),i(T,null,C((U=(H=l.value)==null?void 0:H.last_leave)==null?void 0:U.types,(a,g)=>(r(),i("tr",{key:g,class:"border border-black"},[t("td",ue,s(a==null?void 0:a.type),1),t("td",ce,s(a==null?void 0:a.days),1)]))),128)),t("tr",pe,[e[12]||(e[12]=t("td",{class:"border border-black px-2"},"Total",-1)),t("td",be,s((O=(E=l.value)==null?void 0:E.last_leave)!=null&&O.types?l.value.last_leave.types.reduce((a,g)=>a+g.days,0):0),1)])])])])])])]),t("div",null,[e[20]||(e[20]=t("h3",{class:"font-bold"},"Leave Details:",-1)),t("div",ve,[t("li",null,[e[14]||(e[14]=t("strong",null,"Reason: ",-1)),n(s(((G=l.value)==null?void 0:G.reason)||"No reason provided"),1)]),t("li",null,[e[15]||(e[15]=t("strong",null,"Leave Days:",-1)),n(" "+s((Z=l.value)==null?void 0:Z.leave_period),1)]),t("li",null,[e[16]||(e[16]=t("strong",null,"Total Days:",-1)),n(" "+s((J=l.value)==null?void 0:J.total_leave_days),1)]),t("li",null,[e[17]||(e[17]=t("strong",null,"Weekends:",-1)),n(" "+s((X=(Q=(K=l.value)==null?void 0:K.user)==null?void 0:Q.weekends)==null?void 0:X.join(", ")),1)]),t("li",null,[e[18]||(e[18]=t("strong",null,"Last Working Date:",-1)),n(" "+s((Y=l.value)==null?void 0:Y.last_working_date),1)]),t("li",null,[e[19]||(e[19]=t("strong",null,"Resumption Date:",-1)),n(" "+s((tt=l.value)==null?void 0:tt.resumption_date),1)])])]),t("div",ye,[t("p",null,[e[21]||(e[21]=t("strong",null,"Works in Hand: ",-1)),n(s(((et=l.value)==null?void 0:et.works_in_hand)||"No details provided"),1)])]),t("div",me,[t("div",null,[t("div",ge,[e[26]||(e[26]=t("hr",{class:"w-44 border-black hidden print:block"},null,-1)),t("p",null,[e[22]||(e[22]=t("strong",null,"Applicant:",-1)),n(" "+s((st=(lt=l.value)==null?void 0:lt.user)==null?void 0:st.name),1)]),t("p",null,[e[23]||(e[23]=t("strong",null,"Designation:",-1)),n(" "+s((nt=(at=(ot=l.value)==null?void 0:ot.user)==null?void 0:at.designation)==null?void 0:nt.title),1)]),t("p",null,[e[24]||(e[24]=t("strong",null,"Department:",-1)),n(" "+s((dt=(it=(rt=l.value)==null?void 0:rt.user)==null?void 0:it.department)==null?void 0:dt.name),1)]),t("p",null,[e[25]||(e[25]=t("strong",null,"Phone:",-1)),n(" "+s((ct=(ut=l.value)==null?void 0:ut.user)==null?void 0:ct.phone),1)])])]),x(k,{application:l.value,type:"leave_applications",item:"handover",onAction:c},null,8,["application"])]),t("div",null,[e[28]||(e[28]=t("h1",{class:"font-bold"},"Leave Balance",-1)),t("div",xe,[t("table",fe,[e[27]||(e[27]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border border-gray-500 px-4 py-0.5 text-left"},"Leave Type"),t("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Total Days"),t("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Used Days"),t("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Remaining Days")])],-1)),t("tbody",null,[(r(!0),i(T,null,C((pt=l.value)==null?void 0:pt.leave_balance,(a,g)=>(r(),i("tr",{key:g,class:"hover:bg-blue-200"},[t("td",_e,s(a.leave_type),1),t("td",ke,s(a.total_leave_days),1),t("td",we,s(a.used_days),1),t("td",{class:R(["border border-gray-500 px-4 py-0.5 text-center",{"text-green-600 font-bold":a.remaining_days>0,"text-red-600 font-bold":a.remaining_days===0}])},s(a.remaining_days),3)]))),128))])])])])]),t("div",Ae,[t("p",$e,[e[29]||(e[29]=n(" Leave Approval: ")),t("b",{class:R({"text-yellow-600":((bt=l.value)==null?void 0:bt.status)==="Pending","text-green-600":((vt=l.value)==null?void 0:vt.status)==="Approved","text-red-600":((yt=l.value)==null?void 0:yt.status)==="Rejected"})},s(((mt=l.value)==null?void 0:mt.status)||"N/A"),3)]),((gt=l.value)==null?void 0:gt.status)==="Rejected"?(r(),i("div",he,[t("p",null,[e[30]||(e[30]=t("b",null,"Rejected by: ",-1)),n(" "+s((ft=(xt=l.value)==null?void 0:xt.rejected_by_user)==null?void 0:ft.name),1)]),t("p",null,[e[31]||(e[31]=t("b",null,"rejection Reason: ",-1)),n(" "+s(l.value.rejection_reason),1)])])):L("",!0),t("div",De,[x(k,{application:l.value,type:"leave_applications",item:"in_charge",onAction:c},null,8,["application"]),x(k,{application:l.value,type:"leave_applications",item:"coordinator",onAction:c},null,8,["application"]),x(k,{application:l.value,type:"leave_applications",item:"operational_admin",onAction:c},null,8,["application"])]),t("div",je,[x(k,{application:l.value,type:"leave_applications",item:"recommend_by",onAction:c},null,8,["application"]),x(k,{application:l.value,type:"leave_applications",item:"approved_by",onAction:c},null,8,["application"])])])])),x(Tt)])}}};export{Re as default};
