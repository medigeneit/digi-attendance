import{u as B,b as E,A as R,r as b,p as S,c as n,o as a,a as l,s as g,h as D,v as M,k as f,F,q as N,t as i,n as T}from"./index-CObpbYLP.js";import{_ as V}from"./EmployeeFilter-CsVXXfdy.js";import{L as P}from"./LoaderView-vk9-daeE.js";import{u as $}from"./attendance-C0MXErpW.js";import{S as j}from"./sweetalert2.esm.all-DGhwgajj.js";import"./company-DMDy8XtC.js";import"./department-DVXKq4Tz.js";import"./SelectDropdown-Bfmixia7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-Cg4XRsoq.js";const z={class:"space-y-2 px-4"},K={class:"flex flex-wrap items-center gap-2"},O={key:0,class:"text-center py-4"},W={key:1,class:"space-y-4"},G={key:0,class:"overflow-x-auto"},H={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},I={class:"border border-gray-300 px-2"},J={class:"border border-gray-300 px-2"},Q={class:"border border-gray-300 px-2"},X={class:"border border-gray-300 px-2"},Y={class:"border border-gray-300 px-2"},Z={class:"border border-gray-300 px-2"},ee={class:"border border-gray-300 px-2"},te={class:"border border-gray-300 px-2"},le={key:0},oe={key:1,class:"text-gray-500 italic text-xs"},de={class:"border border-gray-300 px-2"},ne={key:1,class:"text-center text-red-500 text-xl italic mt-10"},xe={__name:"LateAttendanceReport",setup(ae){const c=B(),s=E(),u=$(),{monthlyLateLogs:h,isLoading:w,selectedMonth:k}=R(u),r=b(s.query.date||k.value),q=()=>{var t,d,e,y;c.replace({query:{...s.query,date:r.value}}),(t=o.value)!=null&&t.company_id&&((d=o.value)!=null&&d.department_id)&&((e=o.value)!=null&&e.type)&&((y=o.value)!=null&&y.employee_id)&&_(o.value)},_=async t=>{t.company_id&&(t!=null&&t.department_id)&&(t!=null&&t.type)&&(t!=null&&t.type)&&(t!=null&&t.employee_id)&&r.value&&await u.getAttendanceLateReport(t==null?void 0:t.company_id,t==null?void 0:t.department_id,t==null?void 0:t.type,t==null?void 0:t.employee_id,r.value,"monthly")},C=async()=>{o.value.company_id&&o.value.employee_id&&r.value?await u.lateReportDownloadExcel(o.value.company_id,o.value.employee_id,r.value,"monthly"):j.fire({icon:"warning",title:"Missing Selection!",text:"Please select Company, Employee, and Month first!",confirmButtonText:"OK"})},L=()=>{c.go(-1)},A=t=>t==="Pending"?"text-yellow-700":t==="Approved"?"text-green-700":"text-red-500",o=b({company_id:"",department_id:"all",type:"all",employee_id:""}),U=async()=>{var t,d,e,y,p,m,v,x;c.replace({query:{...s.query,company_id:(t=o.value)==null?void 0:t.company_id,department_id:(d=o.value)==null?void 0:d.department_id,type:(e=o.value)==null?void 0:e.type,employee_id:(y=o.value)==null?void 0:y.employee_id}}),(p=o.value)!=null&&p.company_id&&((m=o.value)!=null&&m.department_id)&&((v=o.value)!=null&&v.type)&&((x=o.value)!=null&&x.employee_id)&&_(o.value)};return S(()=>({company_id:s.query.company_id||"",department_id:s.query.department_id||"all",type:s.query.type||"all",employee_id:s.query.employee_id||""})),(t,d)=>(a(),n("div",z,[l("div",{class:"flex items-center justify-between gap-2"},[l("button",{class:"btn-3",onClick:L},d[5]||(d[5]=[l("i",{class:"far fa-arrow-left"},null,-1),l("span",{class:"hidden md:flex"},"Back",-1)])),d[7]||(d[7]=l("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Late Reports",-1)),l("div",{class:"flex gap-4"},[l("button",{type:"button",onClick:C,class:"btn-3"},d[6]||(d[6]=[l("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)]))])]),l("div",K,[g(V,{company_id:o.value.company_id,"onUpdate:company_id":d[0]||(d[0]=e=>o.value.company_id=e),department_id:o.value.department_id,"onUpdate:department_id":d[1]||(d[1]=e=>o.value.department_id=e),employee_id:o.value.employee_id,"onUpdate:employee_id":d[2]||(d[2]=e=>o.value.employee_id=e),category:o.value.category,"onUpdate:category":d[3]||(d[3]=e=>o.value.category=e),"with-type":!0,"initial-value":t.$route.query,onFilterChange:U},null,8,["company_id","department_id","employee_id","category","initial-value"]),l("div",null,[D(l("input",{id:"user-filter","onUpdate:modelValue":d[4]||(d[4]=e=>r.value=e),onChange:q,type:"month",class:"input-1"},null,544),[[M,r.value]])])]),f(w)?(a(),n("div",O,[g(P)])):(a(),n("div",W,[o.value.company_id&&o.value.employee_id&&o.value.department_id?(a(),n("div",G,[l("table",H,[d[8]||(d[8]=l("thead",null,[l("tr",{class:"bg-gray-200"},[l("th",{class:"border border-gray-300 px-2 text-left"},"#"),l("th",{class:"border border-gray-300 px-2 text-left"},"Date"),l("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),l("th",{class:"border border-gray-300 px-2 text-left"},"Company"),l("th",{class:"border border-gray-300 px-2 text-left"},"Department"),l("th",{class:"border border-gray-300 px-2 text-left"},"Entry Time"),l("th",{class:"border border-gray-300 px-2 text-left"},"Late Duration"),l("th",{class:"border border-gray-300 px-2 text-left"},"Action"),l("th",{class:"border border-gray-300 px-2 text-left"},"Shift")])],-1)),l("tbody",null,[(a(!0),n(F,null,N(f(h),(e,y)=>(a(),n("tr",{key:e.id,class:"border-b border-gray-200 hover:bg-blue-200"},[l("td",I,i(y+1),1),l("td",J,i(e==null?void 0:e.date),1),l("td",Q,i((e==null?void 0:e.user_name)||"Unknown"),1),l("td",X,i((e==null?void 0:e.company_name)||"Unknown"),1),l("td",Y,i((e==null?void 0:e.department_name)||"Unknown"),1),l("td",Z,i(e.entry_time),1),l("td",ee,i(e.late_duration),1),l("td",te,[e!=null&&e.short_leave?(a(),n("div",le,[l("span",{class:T(A(e.short_leave.status))},i(e.short_leave.status||"Waiting"),3)])):(a(),n("div",oe,"No Application"))]),l("td",de,i(e.shift_name),1)]))),128))])])])):(a(),n("div",ne," Please select company, department and employee "))]))]))}};export{xe as default};
