import{r as _,c as i,o as a,a as e,d as q,j as m,w as $,t as f,x as M,G as re,i as j,F as U,e as K,l as R,b as D,p as Oe,k as Le,v as Be,s as E,C as Ee,h as ae,g as Fe,m as Y,Q as Me,y as Ve,A as Ue,f as Pe,u as ze}from"./index-DIq5m9p6.js";import{L as de}from"./LoaderView-CNU5kuXy.js";import{O as V}from"./OverlyModal-ijGulFSe.js";import{_ as He}from"./ShareComponent-D4pOault.js";import{_ as Ne}from"./DepartmentChip-kwXkzA7m.js";import{_ as J}from"./DescriptionView-CSUCxFLS.js";import{b as Ge,r as We,c as Qe,f as ue,d as Ke,s as Ye}from"./requirement-W9WnvU9l.js";import{_ as Je}from"./AttachmentPreview-CkcrzeEu.js";import{_ as ne}from"./UserChip-DotAyPGR.js";import{o as Xe}from"./url-CePbr-gY.js";import{u as Ze}from"./user-BeFJtvPB.js";import{_ as tn,a as et}from"./TaskUserAssignForm-B4HsvkyX.js";import{_ as tt}from"./TextEditor-DkWcChk8.js";import{u as st}from"./useTaskStore-DFcJAD52.js";import{_ as rt}from"./TaskSelectionInput-HlBjmn9z.js";import{_ as nt}from"./TaskAddForm-D5b3LlGX.js";import{_ as at}from"./TaskEditForm-zijriy5k.js";import{_ as lt}from"./TaskTableRow-BL8OcoLw.js";import{T as oe}from"./TextWithHr-Cveu-qqr.js";import{d as ie,b as ot}from"./datetime-BEfC2TVK.js";import{c as it}from"./dom-Bic1TNqD.js";import{_ as ut}from"./ApproveAndReject-CZjH0O7r.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TaskUrgencyInput-V3wTEavA.js";import"./DraggableList.vue_vue_type_script_setup_true_lang-Dp9uGBny.js";import"./SelectDropdown-Dl9Hjy9i.js";import"./TaskTitle-CDOOOggu.js";import"./RequiredIcon-bQieMjZ2.js";import"./company-DZp6dPED.js";import"./CompanyDepartmentSelectInput-BAH65Csm.js";import"./SectionLoading-y2ECxl7V.js";import"./tags-CXOVroM6.js";import"./MultiselectDropdown-anIAm-6M.js";import"./MultiselectDropdown.vue_vue_type_style_index_0_lang-D9rOOVIl.js";import"./TaskUrgentBadge-BV2aTWyE.js";import"./TaskAssignedUsers-DmfTwYYv.js";import"./TaskIsClosedBadge-d-eG04Yh.js";const dt={class:"flex items-center border-b w-full pb-2"},mt={class:""},ct={class:"mt-4 border h-40 flex items-center flex-col justify-center rounded border-dashed bg-red-50 text-center"},pt={key:0,class:"text-red-500 text-center mt-2"},vt={class:"flex items-center justify-between mt-4"},ft={__name:"RequirementAttachmentForm",props:{requirementId:[String,Number],default:()=>null},emits:["uploaded","error","clickBack"],setup(y,{emit:S}){const o=y,c=_({attachments:[]}),d=_(""),v=_(""),p=S;function b(l){c.value.attachments=[...c.value.attachments,...Array.from(l.target.files)]}function s(l){c.value.attachments.splice(l,1)}async function C(){var t,n,u,g;d.value="submitting";const l=new FormData;for(const k in c.value)k==="attachments"?c.value.attachments.forEach(T=>l.append("attachments[]",T)):l.append(k,c.value[k]);try{const k=await Ge(o.requirementId,l);p("uploaded",k),d.value="uploaded"}catch(k){p("error",(n=(t=k.response)==null?void 0:t.data)==null?void 0:n.message),v.value=(g=(u=k.response)==null?void 0:u.data)==null?void 0:g.message,d.value="error"}}return(l,t)=>{var n;return a(),i("form",{class:"p-4 flex flex-col",onSubmit:$(C,["prevent"])},[e("div",dt,[t[3]||(t[3]=e("h3",null,"Requirement Attachment",-1)),e("button",{class:"btn-icon ml-auto",onClick:t[0]||(t[0]=$(u=>p("clickBack"),["prevent"]))},t[2]||(t[2]=[e("span",{class:"fas fa-times"},null,-1)]))]),e("div",mt,[e("label",ct,[t[4]||(t[4]=e("div",{class:"block text-gray-600 font-medium text-sm md:text-xl mb-4"}," Click to Select files or Drop Here ",-1)),e("input",{type:"file",multiple:"",accept:"image/*,application/pdf",name:"attachments",class:"border rounded-r-md text-gray-600 bg-gray-50",onChange:b},null,32)])]),q(Je,{files:((n=c.value)==null?void 0:n.attachments)||[],onRemove:s,class:"border p-1 rounded overflow-y-auto flex-grow"},null,8,["files"]),t[6]||(t[6]=e("hr",{class:"mt-4"},null,-1)),v.value?(a(),i("div",pt,f(v.value),1)):m("",!0),e("div",vt,[e("button",{class:"btn-3",onClick:t[1]||(t[1]=$(u=>p("clickBack"),["prevent"]))},"Cancel"),t[5]||(t[5]=e("button",{class:"btn-2"},"Save",-1))])],32)}}},bt={class:"card-bg p-4 pt-2"},xt={class:"grid grid-cols-2 lg:grid-cols-4 gap-3 w-full"},yt=["onClick"],gt=["src"],_t=["href"],kt={key:2,class:"text-xs text-gray-500 text-center"},ht={class:"border-b flex items-center px-2 py-1"},wt=["href"],qt={class:"ml-auto flex items-center gap-2"},$t={class:"mt-4 p-2 min-h-[50vh] max-h-[70vh] overflow-y-auto"},Ct=["src"],Tt=["src"],Rt={__name:"RequirementAttachments",props:{requirement:{type:Array,default:()=>[]}},setup(y){const S=y,o=M(()=>{var t;return((t=S.requirement)==null?void 0:t.attachments)||[]}),c=re({show:!1}),d=_(null);function v(){var n;const t=o.value.indexOf(d.value);t>0&&(d.value=(n=o.value)==null?void 0:n[t-1])}function p(){var n,u;const t=o.value.indexOf(d.value);t<((n=o.value)==null?void 0:n.length)-1&&(d.value=(u=o.value)==null?void 0:u[t+1])}function b(t){if(!t)return!1;const n=C(t);return["jpg","jpeg","png","gif","webp","bmp","svg","jfif"].includes(n)}function s(t){return C(t)==="pdf"}function C(t){return typeof t=="string"?t.split(".").pop().toLowerCase():""}function l(t){return t.startsWith("http")?t:`https://hrm-api.medi.academy/storage/${t}`}return(t,n)=>(a(),i("div",bt,[e("div",null,[n[5]||(n[5]=e("h4",{class:"text-gray-900 font-semibold mb-3 border-b font-e"},"Attachments",-1)),e("div",xt,[o.value&&o.value.length?(a(!0),i(U,{key:0},K(o.value,(u,g)=>(a(),i("div",{key:g,class:"border p-1 rounded aspect-square flex items-center justify-center bg-gray-50 relative",tabindex:"0",onClick:$(k=>d.value=u,["prevent"])},[b(u)?(a(),i("img",{key:0,src:l(u),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,gt)):s(u)?(a(),i("a",{key:1,href:l(u),target:"_blank",class:"text-xs text-blue-600 text-center break-words hover:underline"},n[3]||(n[3]=[e("i",{class:"fas fa-file-pdf fa-2x mb-1 text-amber-700"},null,-1),e("div",{class:"whitespace-nowrap text-xs mt-1"},"Open PDF",-1)]),8,_t)):(a(),i("span",kt,"Unknown"))],8,yt))),128)):m("",!0),e("button",{title:"Add Attachments",onClick:n[0]||(n[0]=$(u=>c.show=!c.show,["prevent"])),class:"border rounded aspect-square flex items-center justify-center bg-gray-50 relative group/btn"},n[4]||(n[4]=[e("i",{class:"fas fa-plus-circle text-2xl text-blue-300 group-hover/btn:text-blue-500"},null,-1)]))])]),c.show?(a(),j(V,{key:0},{default:R(()=>[q(ft,{onClickBack:n[1]||(n[1]=u=>c.show=!1),requirementId:y.requirement.id,class:"max-h-[70vh]"},null,8,["requirementId"])]),_:1})):m("",!0),d.value?(a(),j(V,{key:1,class:"*:max-w-4xl *:min-h-[60vh]"},{default:R(()=>[e("div",ht,[n[9]||(n[9]=e("h2",{class:"text-xl font-semibold"},"Attachment view",-1)),e("a",{href:l(d.value),target:"_blank",class:"text-sky-600 hover:text-sky-400 hover:underline ml-2"},n[6]||(n[6]=[e("i",{class:"fas fa-external-link"},null,-1),D(),e("span",{class:"hidden md:inline"},"Open In New tab",-1)]),8,wt),e("div",qt,[e("button",{onClick:$(v,["prevent"]),class:"btn-icon"},n[7]||(n[7]=[e("i",{class:"fas fa-angle-left"},null,-1)])),e("button",{onClick:$(p,["prevent"]),class:"btn-icon"},n[8]||(n[8]=[e("i",{class:"fas fa-angle-right"},null,-1)])),e("button",{onClick:n[2]||(n[2]=$(u=>d.value=null,["prevent"])),class:"btn-icon ml-6"},"×")])]),e("div",$t,[b(d.value)?(a(),i("img",{key:0,src:l(d.value),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,Ct)):s(d.value)?(a(),i("iframe",{key:1,src:l(d.value),class:"w-full h-[60vh] border rounded-md"},null,8,Tt)):m("",!0)])]),_:1})):m("",!0)]))}},St={key:0,class:"mb-4 flex flex-col gap-2 items-center justify-center bg-gray-50 bg-opacity-70 hover:bg-opacity-90 p-6 border border-gray-100 rounded-md"},jt={class:"text-sm flex items-center gap-2 text-red-400 font-semibold"},It={class:"mt-[2px]"},At={key:0,class:"text-gray-800 flex items-center gap-2"},Nt={key:1,class:"text-gray-800 w-full my-2 text-center"},Dt={class:"text-gray-800 border w-full rounded-md border-dashed py-2 px-3 border-gray-400 text-sm bg-white"},Ot=["innerHTML"],Lt={class:"flex gap-4 items-center justify-center mt-2"},Bt={__name:"RequirementCloseInfo",props:{requirement:{type:Object,default:()=>{}}},emits:["reOpenClick"],setup(y,{emit:S}){const o=S;return(c,d)=>{var v;return(v=y.requirement)!=null&&v.closed_at?(a(),i("div",St,[d[5]||(d[5]=e("div",{class:"text-red-400 font-bold text-xl"},"Requirement Closed",-1)),e("div",jt,[d[1]||(d[1]=e("span",{class:"fad fa-lock"},null,-1)),d[2]||(d[2]=e("span",{class:"mt-[2px]"},"CLOSED AT",-1)),e("span",It,f(new Date(y.requirement.closed_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),y.requirement.closed_by_user?(a(),i("div",At,[d[3]||(d[3]=e("span",{class:"text-sm"},"Closed by",-1)),q(ne,{user:y.requirement.closed_by_user,"avatar-size":"xsmall"},null,8,["user"])])):m("",!0),y.requirement.closing_note?(a(),i("div",Nt,[d[4]||(d[4]=e("div",{class:"text-x"},"Closing Note",-1)),e("div",Dt,[e("p",{innerHTML:y.requirement.closing_note},null,8,Ot)])])):m("",!0),e("div",Lt,[e("button",{class:"btn-2 h-8",onClick:d[0]||(d[0]=$(p=>o("reOpenClick"),["prevent"]))},"Re Open")])])):m("",!0)}}},Et={class:"border-b -mx-4 px-4 -mt-4 py-2 text-xl bg-gray-50"},Ft={class:"my-6"},Vt={class:"text-center font-semibold text-blue-800 mb-4"},Ut={class:"text-center my-1"},Mt={class:"border px-2 rounded-md bg-gray-50 border-blue-300 text-blue-400 inline-flex items-center gap-1"},Pt={class:"mt-4"},zt=["placeholder","required"],Ht={class:"flex"},Gt={class:"text-red-600 text-center mt-2 text-sm"},Wt={class:"flex justify-between mt-3"},Qt={class:"btn-2"},Kt={__name:"RequirementClosingForm",props:{loading:{type:Boolean,default:!1},requirement:{type:Object,default:()=>{}}},emits:["clickCancel","updateStatus","error","update:loading"],setup(y,{emit:S}){const o=y,c=S,d=M({get:()=>o.loading,set:()=>c("update:loading")}),v=_(""),p=_(""),b=_(255),s=M(()=>b.value-v.value.length);async function C(){var l,t,n;d.value=!0;try{(l=o.requirement)!=null&&l.closed_at?await We(o.requirement.id,v.value):await Qe(o.requirement.id,v.value),c("updateStatus")}catch(u){p.value=(n=(t=u.response)==null?void 0:t.data)==null?void 0:n.message,c("error")}finally{d.value=!1}}return(l,t)=>{var u,g,k,T,A;const n=Oe("LoaderView");return a(),i("form",{class:"p-4 rounded relative border",onSubmit:$(C,["prevent"])},[d.value?(a(),j(n,{key:0,class:"absolute inset-0 flex items-center justify-center bg-opacity-90"},{default:R(()=>t[3]||(t[3]=[D(" Submitting! ")])),_:1,__:[3]})):m("",!0),e("h3",Et,f((u=y.requirement)!=null&&u.closed_at?"Re Open Requirement":"Requirement Closing"),1),e("div",Ft,[e("div",Vt,f((g=y.requirement)==null?void 0:g.title),1),t[6]||(t[6]=e("div",{class:"text-center my-1 text-lg"},"Are you sure?",-1)),e("div",Ut,[t[4]||(t[4]=D(" Want to ")),e("span",Mt,f((k=y.requirement)!=null&&k.closed_at?"Re-Open":"Close"),1),t[5]||(t[5]=D(" the requirement? "))]),e("div",Pt,[Le(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=h=>v.value=h),rows:"4",placeholder:`Write about why are you ${(T=y.requirement)!=null&&T.closed_at?"Re-Opening":"Closing"} the requirement?`,class:"w-full border rounded-lg p-2 text-gray-700 border-gray-400 placeholder:text-gray-400",required:l.currentAction==="reject",onInput:t[1]||(t[1]=h=>v.value.length>b.value?v.value=v.value.slice(0,b.value):null)},null,40,zt),[[Be,v.value]]),e("div",Ht,[e("div",{class:E(["ml-auto inline-block text-sm text-gray-500",v.value.length>=b.value?"text-red-500":""])}," left "+f(s.value)+"/"+f(b.value)+" words ",3)])])]),t[7]||(t[7]=e("hr",{class:"mt-3 -mx-4"},null,-1)),e("div",null,[e("div",Gt,f(p.value),1),e("div",Wt,[e("button",{class:"btn-3",onClick:t[2]||(t[2]=$(h=>c("clickCancel"),["prevent"]))},"Cancel"),e("button",Qt,f((A=y.requirement)!=null&&A.closed_at?"Re-Open":"Close"),1)])])],32)}}};async function Yt(y,S,{params:o={}}={}){return Ee.get(`/requirements/${y}/details/${S}`,{params:o})}async function Jt(y,S,{params:o={}}={}){const c=Xe(o);return Ee.delete(`/requirements/${y}/details/${S}${c?"?"+c:""}`)}const Xt={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},Zt={class:"mb-4"},es={class:"font-semibold"},ts={class:"mb-4"},ss={class:"line-clamp-2"},rs={key:1,class:"min-h-40"},ns={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},as={key:0,class:"mb-4 text-red-500 font-medium"},ls={key:1,class:"mb-4"},os={class:"flex items-center justify-between gap-4"},is=["disabled"],us={__name:"RequirementDetailDeleteForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["delete","closeClick","error"],setup(y,{emit:S}){const o=y,c=S,d=Ze(),v=_(null),p=_(""),b=_(),s=_([]);async function C(){var l,t;p.value="submitting";try{const n=await Jt(o.requirementId,o.detailId);c("delete",n),p.value="create"}catch(n){p.value="error",b.value=((t=(l=n.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to update requirement detail: "+n,c("error",b.value)}}return ae(async()=>{var l,t,n;p.value="loading";try{s.value=await d.fetchDepartmentWiseEmployees(),v.value=(l=(await Yt(o.requirementId,o.detailId)).data)==null?void 0:l.detail}catch(u){b.value=((n=(t=u.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to fetch requirement detail"}finally{p.value=""}}),(l,t)=>{var n,u;return a(),i("div",Xt,[t[4]||(t[4]=e("div",{class:"sticky top-0 -mx-6 px-6 z-10 bg-gray-50"},[e("h2",{class:"text-xl font-semibold text-gray-800 py-2"},"Delete Requirement Details"),e("hr",{class:"mb-4 -mx-6"})],-1)),e("form",{onSubmit:$(C,["prevent"]),class:"z-0"},[p.value!=="loading"?(a(),i(U,{key:0},[e("div",Zt,[t[1]||(t[1]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Title",-1)),e("div",es,f((n=v.value)==null?void 0:n.title),1)]),e("div",ts,[t[2]||(t[2]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),e("div",ss,f((u=v.value)==null?void 0:u.description),1)]),t[3]||(t[3]=e("div",{class:"my-8 text-center text-xl text-red-600"},"Are you sure want to delete?",-1))],64)):(a(),i("div",rs)),e("div",ns,[b.value?(a(),i("div",as,f(b.value),1)):m("",!0),b.value?(a(),i("hr",ls)):m("",!0),e("div",os,[e("button",{type:"button",onClick:t[0]||(t[0]=$(g=>c("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:p.value=="loading"||p.value=="submitting",type:"submit",class:"bg-red-700 hover:bg-red-500 text-white font-semibold px-5 py-2 rounded transition"},f(p.value=="submitting"?"Deleting...":"Delete"),9,is)])])],32),p.value==="loading"||p.value==="submitting"?(a(),j(de,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):m("",!0)])}}};const ds={class:"sticky top-0 pt-4 bg-white z-10"},ms={class:"mb-4"},cs={class:"mb-4"},ps={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},vs={key:0,class:"mb-4 text-red-500 font-medium"},fs={key:1,class:"mb-4"},bs={class:"flex items-center justify-between gap-4"},xs=["disabled"],ys={__name:"RequirementFeedbackEditForm",props:{requirementId:{type:[Number,String],required:!0},requirementId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(y,{emit:S}){const o=y,c=S,d=_(),v=_(null),p=_(""),b=_(),s=_({feedback:""});async function C(){var l,t;p.value="submitting";try{const n=await Ke(o.requirementId,s.value.feedback);c("update",n),p.value="create"}catch(n){p.value="error",b.value=((t=(l=n.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to update requirement requirement",c("error",b.value)}}return ae(async()=>{var l,t,n,u;p.value="loading";try{await ue(o.requirementId),v.value=(l=(await ue(o.requirementId)).data)==null?void 0:l.requirement,s.value={feedback:(t=v.value)==null?void 0:t.feedback}}catch(g){b.value=((u=(n=g.response)==null?void 0:n.data)==null?void 0:u.message)||"Failed to fetch requirement requirement"}finally{p.value=""}}),(l,t)=>{var n;return a(),i("div",{ref_key:"formContainerRef",ref:d,class:"max-h-[90vh] w-full mx-auto overflow-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},[e("div",ds,[t[3]||(t[3]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Requirement Feedback",-1)),t[4]||(t[4]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:t[0]||(t[0]=$(u=>c("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:$(C,["prevent"]),class:"z-0"},[p.value!=="loading"?(a(),i(U,{key:0},[e("div",ms,[t[5]||(t[5]=e("label",{class:"block text-gray-600 text-sm font-medium"},"Title ",-1)),q(J,{"line-clamp":"1",className:{paragraph:"whitespace-pre-wrap text-justify ",button:"mt-0"}},{default:R(()=>{var u;return[D(f((u=v.value)==null?void 0:u.title),1)]}),_:1})]),e("div",cs,[t[6]||(t[6]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Feedback",-1)),q(tt,{modelValue:s.value.feedback,"onUpdate:modelValue":t[1]||(t[1]=u=>s.value.feedback=u)},null,8,["modelValue"])])],64)):m("",!0),e("div",ps,[b.value?(a(),i("div",vs,f(b.value),1)):m("",!0),b.value?(a(),i("hr",fs)):m("",!0),e("div",bs,[e("button",{type:"button",onClick:t[2]||(t[2]=$(u=>c("closeClick"),["prevent"])),class:"btn-3"},"Cancel"),e("button",{disabled:p.value=="loading"||p.value=="submitting",type:"submit",class:"btn-2"},f(p.value=="submitting"?"Saving...":(n=v.value)!=null&&n.feedback?"Update Feedback":"Add Feedback"),9,xs)])])],32),p.value==="loading"||p.value==="submitting"?(a(),j(de,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):m("",!0)],512)}}},gs={class:"flex justify-center items-center"},_s={class:"modal-card"},ks=["required"],hs={class:"flex"},ws={class:"flex justify-between gap-2 mt-4"},qs=["disabled"],$s=["disabled"],Cs={__name:"RequirementSubmissionHandler",props:{requirementId:{type:[String,Number],required:!0}},emits:["loading","success","error"],setup(y,{emit:S}){const o=y,c=S,d=_(255),v=M(()=>d.value-l.value.length),p=Me(),b=_(null),s=_(null),C=_(null),l=_(""),t=_(!1),n=M(()=>C.value!==null);function u(h){C.value=h,l.value="",A()}function g(){C.value=null,l.value=""}async function k(){var h,I;if(C.value==="reject"&&!l.value)return p.error("Rejection Reason is required!");if(typeof o.onSubmit=="function")return o.onSubmit({note:l.value,action:C.value});c("loading",!0),t.value=!0;try{await Ye(o.requirementId,{note:l.value}),c("success"),g()}catch(N){return c("error",N),p.error(((I=(h=N==null?void 0:N.response)==null?void 0:h.data)==null?void 0:I.message)||"Submission failed!")}finally{c("loading",!1),t.value=!1}}function T(h){var I,N;n.value&&(h.key==="ArrowLeft"?(I=s.value)==null||I.focus():h.key==="ArrowRight"&&((N=b.value)==null||N.focus()))}function A(){Ue(()=>{var h;(h=b.value)==null||h.focus()})}return ae(()=>{window.addEventListener("keydown",T)}),Ve(()=>{window.removeEventListener("keydown",T)}),(h,I)=>(a(),i("div",null,[e("div",gs,[e("button",{onClick:I[0]||(I[0]=N=>u("accept"))},I[3]||(I[3]=[e("span",{class:"btn-2"},[e("span",{class:"fas fa-paper-plane"}),e("span",{class:"hidden md:inline"},"Submit Requirement")],-1)]))]),n.value?(a(),i("div",{key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50",onClick:$(g,["self"])},[e("div",_s,[I[4]||(I[4]=e("h3",{class:"title-lg"},"Requirement Submission",-1)),e("div",null,[Le(e("textarea",{"onUpdate:modelValue":I[1]||(I[1]=N=>l.value=N),rows:"4",placeholder:"Note...",class:"w-full border rounded-lg p-2 text-gray-700",required:C.value==="reject",onInput:I[2]||(I[2]=N=>l.value.length>d.value?l.value=l.value.slice(0,d.value):null)},null,40,ks),[[Be,l.value]]),e("div",hs,[e("div",{class:E(["ml-auto inline-block text-sm text-gray-500",l.value.length>=d.value?"text-red-500":""])}," left "+f(v.value)+"/"+f(d.value)+" words ",3)])]),e("div",ws,[e("button",{ref_key:"cancelBtnRef",ref:s,class:"btn-3 focus:ring-2 ring-offset-2 disabled:opacity-30",onClick:g,disabled:t.value}," Cancel ",8,qs),e("button",{ref_key:"confirmBtnRef",ref:b,class:E(["focus:ring-2 ring-offset-2 disabled:opacity-30",C.value==="reject"?"btn-2-red":"btn-2-green"]),onClick:k,disabled:t.value}," Confirm Submission ",10,$s)])])])):m("",!0)]))}},Ts={class:"flex items-center gap-6 justify-center my-16"},Rs={key:0,class:"border rounded-md"},Ss={__name:"RequirementTaskCreateOrAssign",props:{fromDepartmentId:{type:Number},requirement:{type:Object}},emits:["addNewTaskClick","cancelClick","assignTask"],setup(y,{emit:S}){const o=y,c=S,d=st(),v=_(""),p=_(null),b=_(""),s=_(!1);async function C(){await d.setTaskRequirement(b.value,o.requirement.id),c("assignTask")}return(l,t)=>(a(),i("div",{class:E(["text-left p-4",[v.value&&!p.value?"min-h-[400px]":""]])},[e("div",Ts,[e("button",{onClick:t[0]||(t[0]=$(n=>c("addNewTaskClick"),["prevent"])),class:"btn-3"},"Add New Task"),t[5]||(t[5]=e("span",null,"or",-1)),e("button",{class:E({"btn-3":v.value!=="direct-assign","btn-2":v.value=="direct-assign"}),onClick:t[1]||(t[1]=$(()=>v.value="direct-assign",["prevent"]))}," Assign Task ",2)]),v.value&&!p.value?(a(),i("div",Rs,[e("form",{onSubmit:$(C,["prevent"]),class:"p-4 flex items-end"},[q(rt,{class:"flex-grow mr-4 h-12",taskId:b.value,"onUpdate:taskId":t[2]||(t[2]=n=>b.value=n),show:s.value,"onUpdate:show":t[3]||(t[3]=n=>s.value=n),isOnlyMyTask:!1,taskQueryParams:{"from-department-id":y.fromDepartmentId},filterTasks:n=>!n.requirement_id,onAddNewTaskClick:t[4]||(t[4]=n=>c("addNewTaskClick")),showAddBtnIfNotFound:!0},null,8,["taskId","show","taskQueryParams","filterTasks"]),t[6]||(t[6]=e("div",{class:"flex justify-center"},[e("button",{class:"btn-2 h-12 rounded-md"},"Save")],-1))],32)])):m("",!0)],2))}},js={class:"flex flex-col items-center gax-x-1 justify-end"},Is={key:0},As={key:1},Ns={class:"text-sm text-gray-600 whitespace-normal w-64"},Ds={class:"text-gray-900 font-semibold text-sm md:text-base"},Os={class:"ml-2"},Ls={key:0,class:"text-red-700 text-sm"},Bs={key:1,class:"text-green-600 ml-2"},Es={key:2,class:"ml-2 text-yellow-700"},De={__name:"RequirementApprovalItem",props:{requirement:{type:Object,required:!0},approvalType:{type:String,required:!0}},emits:["updateApproval"],setup(y,{emit:S}){const o=y,c=S,d=Fe(),v=M(()=>{var l,t,n,u,g;return{from_in_charge:!!((l=o.requirement)!=null&&l.status&&((t=o.requirement)!=null&&t.submission_date)),from_coordinator:!!((n=o.requirement)!=null&&n.from_coordinator),to_in_charge:!!((u=o.requirement)!=null&&u.to_incharge),to_coordinator:!!((g=o.requirement)!=null&&g.to_coordinator)}}),p=M(()=>{var l,t,n,u,g,k,T,A;return{from_in_charge:(t=(l=o.requirement)==null?void 0:l.from_department)==null?void 0:t.in_charge,from_coordinator:(u=(n=o.requirement)==null?void 0:n.from_department)==null?void 0:u.coordinator,to_in_charge:(k=(g=o.requirement)==null?void 0:g.to_department)==null?void 0:k.in_charge,to_coordinator:(A=(T=o.requirement)==null?void 0:T.to_department)==null?void 0:A.coordinator}}),b=M(()=>{var u;const l=Object.keys(v.value),t=l.indexOf(o.approvalType);let n=!0;for(let g=t-1;g>=0;g--){const k=l[g];n=n&&(p.value[k]?(u=v.value)==null?void 0:u[k]:!0)}return n}),s=M(()=>{var k,T,A,h,I,N,le,w,W,Q,P,O,r,G,z,H;let l=null,t=null,n="",u="";o.approvalType==="from_in_charge"&&(l=(k=o.requirement)==null?void 0:k.from_department,t=(A=(T=o.requirement)==null?void 0:T.from_department)==null?void 0:A.in_charge,n="In Charge",u=(h=o.requirement)==null?void 0:h.from_incharge_note),o.approvalType==="from_coordinator"&&(l=(I=o.requirement)==null?void 0:I.from_department,t=(N=o.requirement)==null?void 0:N.from_coordinator,n="Coordinator",u=(le=o.requirement)==null?void 0:le.from_coordinator_note),o.approvalType==="to_in_charge"&&(l=(w=o.requirement)==null?void 0:w.to_department,t=(W=o.requirement)==null?void 0:W.to_in_charge,n="In Charge",u=(Q=o.requirement)==null?void 0:Q.to_incharge_note),o.approvalType==="to_coordinator"&&(l=(P=o.requirement)==null?void 0:P.to_department,t=(O=o.requirement)==null?void 0:O.to_coordinator,n="Coordinator",u=(r=o.requirement)==null?void 0:r.to_coordinator_note);const g=(G=p.value)==null?void 0:G[o.approvalType];return{department:l,department_user:g,approved:(z=v.value)==null?void 0:z[o.approvalType],approval_user:t,is_rejected:((H=o.requirement)==null?void 0:H.rejected_by_user_id)==(g==null?void 0:g.id),userType:n,approval_note:u}});function C(){c("updateApproval")}return(l,t)=>{var n,u,g,k,T,A;return a(),i("div",js,[s.value.department_user?(a(),i("div",Is,[q(ne,{user:s.value.department_user,"avatar-size":"xsmall"},null,8,["user"])])):(a(),i("div",As,t[0]||(t[0]=[e("span",{class:"italic text-xs text-gray-400"},"N/A",-1)]))),e("div",Ns,[s.value.is_rejected?(a(),j(J,{key:0,"line-clamp":1,class:"text-center mt-2 text-red-600"},{default:R(()=>[D(f(y.requirement.rejection_reason),1)]),_:1})):(a(),j(J,{key:1,"line-clamp":1,class:"text-center mt-2"},{default:R(()=>[D(f(s.value.approval_note),1)]),_:1}))]),e("div",null,[!s.value.is_rejected&&!s.value.approved&&b.value&&((n=Y(d).user)==null?void 0:n.id)==((g=(u=s.value)==null?void 0:u.department_user)==null?void 0:g.id)?(a(),j(ut,{key:0,class:"ml-auto z-[5000000]",notificationType:"pending-requirements",applicationId:(k=o.requirement)==null?void 0:k.id,onSuccess:C,variant:1},null,8,["applicationId"])):m("",!0)]),t[2]||(t[2]=e("hr",{class:"my-2 border-gray-600 w-40 md:w-48 lg:w-64"},null,-1)),e("div",Ds,[e("span",null,f(((T=s.value.department)==null?void 0:T.short_name)||((A=s.value.department)==null?void 0:A.name)),1),e("span",Os,f(s.value.userType),1),s.value.department_user?(a(),i(U,{key:0},[s.value.is_rejected?(a(),i("span",Ls," (Rejected)")):s.value.approved?(a(),i("span",Bs,"(✔)")):(a(),i("span",Es,t[1]||(t[1]=[e("i",{class:"fad fa-spinner"},null,-1)])))],64)):m("",!0)])])}}},Fs={class:"container mx-auto print:p-0 w-full print:max-w-full"},Vs={class:"border-b px-4 py-2 bg-gray-50 flex items-center justify-between rounded-t-md"},Us={key:0},Ms={class:"border table-auto w-full"},Ps={class:"border-y px-4 py-1"},zs={class:"border-y px-4 py-1"},Hs={class:"border-y px-4 py-1 text-center"},Gs={class:"border-y px-4 py-1 text-center"},Ws={class:"print:shadow-none print:p-0 relative min-h-[50vh] mx-4"},Qs={key:0,class:"grid grid-cols-12 gap-x-4 gap-y-3"},Ks={class:"col-span-full md:col-span-8 xl:col-span-8 2xl:col-span-9 row-span-10 bg-white shadow rounded-lg p-6"},Ys={class:"text-center text-xl font-bold mb-2 flex items-center"},Js={class:"mb-8"},Xs={class:"text-lg font-semibold mb-2"},Zs={class:"flex gap-4 items-center text-gray-500"},er={class:"text-sm"},tr={key:0,class:"flex items-center gap-1"},sr={key:0,class:"mb-5"},rr=["innerHTML"],nr={class:"mb-8"},ar={class:"font-semibold text-lg px-2"},lr={class:"w-full border rounded-lg border-gray-300 overflow-y-auto"},or={class:"w-full border-collapse"},ir={key:0},ur={class:"mb-8"},dr={class:"font-semibold text-lg px-2"},mr={key:0},cr=["innerHTML"],pr={key:1,class:"text-center my-2 text-gray-400"};const vr={key:1,class:"mt-8 border rounded-md p-8 flex items-start justify-between bg-gray-50 print:hidden"},fr={class:"flex flex-col items-end"},br={key:2,class:"mt-6 mb-8 break-before-avoid-page"},xr={class:"whitespace-nowrap border-gray-200 grid grid-cols-1 lg:grid-cols-2 items-stretch"},yr={key:0,class:"whitespace-nowrap border-gray-200 grid grid-cols-1 lg:grid-cols-2 gap-2 items-stretch"},gr={class:"bg-white shadow rounded-lg space-y-4 p-4"},_r={class:"border col-span-3 p-3 rounded-md"},kr={class:"flex items-center gap-2 mb-4"},hr={class:"flex items-center gap-x-3 gap-y-2 flex-wrap"},wr={class:"flex items-center gap-2 mb-4"},qr={class:"mb-4 flex items-center justify-between gap-1 print:mb-1"},$r={class:"font-bold print:text-gray-900"},Cr={key:0,class:"mb-3 flex items-start gap-3 print:mb-1"},Tr={class:"flex items-center gap-2 print:text-gray-900 flex-wrap"},Rr={key:1,class:"mb-3 flex items-center justify-between gap-3 print:mb-1"},Sr={class:"print:text-gray-900 text-sm text-right"},jr={key:2,class:"mb-3 flex items-center justify-between gap-3 print:mb-1"},Ir={class:"print:text-gray-900 text-sm text-right"},Ar={class:"flex justify-between items-center mb-4"},Nr={class:"mb-6"},Dr={class:"flex justify-between items-center"},Or={key:1,class:"text-red-600"},Lr={key:0,class:"mb-2"},Br={class:"flex justify-end text-sky-500"},Er={key:1,class:"text-right w-full mb-4"},Fr={key:2,class:"mb-6"},Vr={class:"flex justify-between items-center"},Ur={key:3,class:"text-center mb-4 text-red-700 mt-8 text-sm"},Mr={key:5,class:"print:hidden flex gap-2 items-center justify-between w-full text-sm"},Rn={__name:"RequirementShow",setup(y){const S=Pe(),o=ze(),c=_(""),d=Fe(),v=_(),p=_(!1),b=_(),s=_(null),C=re({detail:null,open:!1}),l=re({detail:null,open:!1}),t=re({detail:null,open:!1}),n=_(!1),u=()=>n.value=!0,g=()=>n.value=!1,k=_(),T=_({isOpen:!1,taskId:null});ae(async()=>{await h(),window.addEventListener("beforeprint",u),window.addEventListener("afterprint",g),window.addEventListener("resize",A),await Ue(),it(v.value,()=>{})});function A(){}Ve(()=>{window.removeEventListener("beforeprint",u),window.removeEventListener("afterprint",g),window.removeEventListener("resize",A)});async function h(){var O;c.value="loading",s.value=(O=(await ue(S.params.id)).data)==null?void 0:O.requirement,c.value=""}function I(){var O,r,G,z,H,X,Z,ee,te;if(d.user.role!=="super_admin"&&((O=d.user)==null?void 0:O.id)!==((G=(r=s.value)==null?void 0:r.to_department)==null?void 0:G.incharge_id))return alert(`You can't create or assign task for this requirement. 
Only ${(H=(z=s.value)==null?void 0:z.to_department)==null?void 0:H.name}'s In charge can create or assign.`);console.log({requirement:s}),w.modalShown=!0,w.from_department_id=s.value.from_department_id,w.to_department_id=s.value.to_department_id,w.taskDefaultValues={title:"",description:"",from_department_id:s.value.from_department_id,to_department_id:s.value.to_department_id,is_important:((X=s.value)==null?void 0:X.priority)=="IMPORTANT",is_urgent:((Z=s.value)==null?void 0:Z.priority)=="URGENT",supervisor_ids:(ee=s.value)!=null&&ee.supervisor_id?[(te=s.value)==null?void 0:te.supervisor_id]:[]},w.requirement=s.value}function N(O){C.open=!0,C.detail=O}function le(O){t.open=!0,t.detail=O}const w=re({modalShown:!1,requirementId:0,taskDefaultValues:{},requirement:null,creating:!1});async function W(){k.value=null,w.modalShown=!1,await h()}async function Q(){w.modalShown=!1,w.requirement=null,w.creating=!1}const P=_({open:!1});return(O,r)=>{var z,H,X,Z,ee,te,me,ce,pe,ve,fe,be,xe,ye,ge,_e,ke,he,we,qe,$e,Ce,Te,Re,Se,je,Ie,Ae;const G=Oe("RouterLink");return a(),i("div",Fs,[l.open?(a(),j(V,{key:0},{default:R(()=>{var x;return[q(ys,{requirementId:s.value.id,detailId:(x=l.requirement.value)==null?void 0:x.id,onCloseClick:r[0]||(r[0]=B=>l.open=!1),onUpdate:r[1]||(r[1]=async()=>{l.open=!1,await h()})},null,8,["requirementId","detailId"])]}),_:1})):m("",!0),t.open?(a(),j(V,{key:1},{default:R(()=>{var x;return[q(us,{requirementId:s.value.id,detailId:(x=t.requirement.value)==null?void 0:x.id,onCloseClick:r[2]||(r[2]=B=>t.open=!1),onDelete:r[3]||(r[3]=async()=>{t.open=!1,await h()})},null,8,["requirementId","detailId"])]}),_:1})):m("",!0),w.modalShown?(a(),j(V,{key:2,class:"*:relative"},{default:R(()=>{var x,B;return[e("button",{onClick:$(Q,["prevent"]),class:"absolute right-3 top-2 text-xl text-red-500 hover:text-red-400"},r[20]||(r[20]=[e("i",{class:"fas fa-times-circle"},null,-1)])),w!=null&&w.creating?m("",!0):(a(),j(Ss,{key:0,"from-department-id":(x=s.value)==null?void 0:x.from_department_id,requirement:w==null?void 0:w.requirement,onCancelClick:Q,onAddNewTaskClick:r[4]||(r[4]=()=>{w.modalShown=!0,w.creating=!0}),onAssignTask:W},null,8,["from-department-id","requirement"])),w!=null&&w.creating?(a(),j(nt,{key:1,requirementDetailId:(B=w==null?void 0:w.requirement.value)==null?void 0:B.id,requirementId:s.value.id,onClose:Q,onTaskCreated:W,defaultValues:w.taskDefaultValues,readonlyFields:{from_department_id:!0,to_department_id:!0}},null,8,["requirementDetailId","requirementId","defaultValues"])):m("",!0)]}),_:1})):m("",!0),k.value?(a(),j(V,{key:3},{default:R(()=>[q(at,{taskId:k.value,onClose:r[5]||(r[5]=x=>k.value=null),onUpdated:W},null,8,["taskId"])]),_:1})):m("",!0),T.value.isOpen?(a(),j(V,{key:4,class:"*:max-w-4xl"},{default:R(()=>[q(et,{taskId:T.value.taskId,onCancelClick:r[6]||(r[6]=()=>{T.value.isOpen=!1,T.value.taskId=0}),onSuccess:r[7]||(r[7]=()=>{T.value.isOpen=!1,T.value.taskId=0,c.value="loading",h()})},null,8,["taskId"])]),_:1})):m("",!0),P.value.open?(a(),j(V,{key:5},{default:R(()=>[q(Kt,{requirement:s.value,onClickCancel:r[8]||(r[8]=x=>P.value.open=!1),onUpdateStatus:r[9]||(r[9]=()=>{h(),P.value.open=!1})},null,8,["requirement"])]),_:1})):m("",!0),p.value?(a(),j(V,{key:6},{default:R(()=>{var x,B,F,se;return[e("div",Vs,[r[22]||(r[22]=e("h3",{class:"text-xl font-semibold"},"Closing History",-1)),e("button",{class:"btn-icon",onClick:r[10]||(r[10]=$(L=>p.value=!1,["prevent"]))},r[21]||(r[21]=[e("i",{class:"fas fa-times"},null,-1)]))]),(x=s.value)!=null&&x.closing_history&&((F=(B=s.value)==null?void 0:B.closing_history)!=null&&F.length)?(a(),i("div",Us,[e("table",Ms,[r[23]||(r[23]=e("thead",null,[e("tr",null,[e("th",{class:"border-y py-1 text-sm px-4 text-left"},"Closed AT"),e("th",{class:"border-y py-1 text-sm px-4 text-left"},"Note"),e("th",{class:"border-y py-1 text-sm px-4 text-center"},"Status"),e("th",{class:"border-y py-1 text-sm px-4 text-center"},"Close/Open")])],-1)),e("tbody",null,[(a(!0),i(U,null,K(((se=s.value)==null?void 0:se.closing_history)||[],L=>(a(),i("tr",{key:L.at},[e("td",Ps,f(L.at?Y(ie)(L.at):""),1),e("td",zs,f(L==null?void 0:L.closing_note),1),e("td",Hs,f(L==null?void 0:L.status),1),e("td",Gs,f(L==null?void 0:L.type),1)]))),128))])])])):m("",!0)]}),_:1})):m("",!0),e("div",Ws,[s.value?(a(),i("div",Qs,[e("div",Ks,[e("div",Ys,[e("button",{class:"btn-3 h-8 px-4",onClick:r[11]||(r[11]=$(()=>Y(o).back(),["prevent"]))},"Back"),r[24]||(r[24]=e("div",{class:"text-2xl ml-4"},"Requirement Form",-1))]),r[38]||(r[38]=e("hr",{class:"mb-4"},null,-1)),e("div",null,[e("div",Js,[e("div",null,[e("div",Xs,[q(J,{"line-clamp":"3",class:"mb-2"},{default:R(()=>[D(f(s.value.title),1)]),btnText:R(({lineClampClass:x})=>[D(f(x?"More":"Less"),1)]),_:1}),e("div",Zs,[e("div",er,[r[25]||(r[25]=e("span",{class:"fas fa-calendar text-sm text-gray-400"},null,-1)),D(" "+f(Y(ie)(s.value.created_at)),1)]),s.value.created_by?(a(),i("div",tr,[r[26]||(r[26]=e("span",{class:"text-gray-400 text-sm"},"By",-1)),q(ne,{"avatar-size":"xsmall",user:s.value.created_by,class:"border-sky-300"},null,8,["user"])])):m("",!0)])]),s.value.description?(a(),i("div",sr,[r[27]||(r[27]=e("div",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Description",-1)),q(J,{"line-clamp":4,"class-name":{button:"group-hover/item:underline"},class:"text-sm"},{default:R(()=>[e("p",{innerHTML:s.value.description,class:"text-justify"},null,8,rr)]),_:1})])):m("",!0)])]),e("div",nr,[q(oe,{class:"mb-4"},{default:R(()=>[e("h2",ar,[r[28]||(r[28]=e("span",null,"Task List ",-1)),s.value.status=="approved"?(a(),i("span",{key:0,class:E(["whitespace-nowrap mt-4",[{"text-green-700 font-semibold":s.value.tasks_count>0&&s.value.completed_tasks_count==s.value.tasks_count,"text-red-700 font-semibold":s.value.tasks_count==0||s.value.completed_tasks_count!=s.value.tasks_count}]])}," ("+f(s.value.completed_tasks_count)+"/"+f(s.value.tasks_count)+" task(s) done) ",3)):m("",!0)])]),_:1}),e("div",lr,[e("table",or,[r[30]||(r[30]=e("thead",null,[e("tr",null,[e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"SL"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Task"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Assigns"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Deadline"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400 sticky right-0 bg-gray-50"}," Status ")])],-1)),e("tbody",null,[c.value!="loading"&&((H=(z=s.value)==null?void 0:z.tasks)==null?void 0:H.length)===0?(a(),i("tr",ir,r[29]||(r[29]=[e("td",{class:"py-4 px-3 border-t text-center text-gray-400 text-sm",colspan:"10"}," No Task ",-1)]))):(a(!0),i(U,{key:1},K(((X=s.value)==null?void 0:X.tasks)||[],(x,B)=>(a(),j(lt,{key:x.id,task:x,indexing:B+1,class:"*:py-3 *:border-b-0",onEditClick:r[12]||(r[12]=F=>k.value=F),onEmployeeAssignClick:r[13]||(r[13]=F=>{T.value.isOpen=!0,T.value.taskId=F})},null,8,["task","indexing"]))),128))])])])]),e("div",ur,[q(oe,{class:"mb-4"},{default:R(()=>{var x,B,F,se;return[e("h2",dr," '"+f(((B=(x=s.value)==null?void 0:x.to_department)==null?void 0:B.short_name)||((se=(F=s.value)==null?void 0:F.to_department)==null?void 0:se.name))+"' Feedback ",1)]}),_:1}),e("div",{class:E(["px-3 border border-dashed rounded-lg border-sky-600",[(Z=s.value)!=null&&Z.feedback?"py-3":"py-8"]]),colspan:"5"},[c.value!="loading"&&((ee=s.value)!=null&&ee.status)?(a(),i("div",mr,[String(((te=s.value)==null?void 0:te.feedback)||"").trim().length>0?(a(),j(J,{key:0,lineClamp:"2",className:{button:"  underline"},class:"mb-4 print:mb-0"},{default:R(()=>{var x;return[e("p",{class:"text-sm text-justify",innerHTML:(x=s.value)==null?void 0:x.feedback},null,8,cr)]}),_:1})):(a(),i("div",pr,"No Feedback")),e("div",{class:E([((me=s.value)!=null&&me.feedback,"w-full flex justify-center")])},[s.value.closed_at?m("",!0):(a(),i("button",{key:0,class:"btn-3 print:hidden",onClick:r[14]||(r[14]=$(()=>{l.open=!0,l.requirement=s.value},["prevent"]))},f(s.value.feedback?"Update Feedback":"Add feedback"),1))],2)])):m("",!0)],2)]),(s.value,m("",!0)),c.value!="loading"&&!((ce=s.value)!=null&&ce.status)?(a(),i("div",vr,[e("div",fr,[q(Cs,{"requirement-id":(pe=s.value)==null?void 0:pe.id,onSuccess:h},{heading:R(()=>r[34]||(r[34]=[D(" Requirement Submission ")])),acceptButtonLabel:R(()=>r[35]||(r[35]=[e("span",{class:"btn-2 pl-2 text-base"},[e("i",{class:"fad fa-paper-plane text-lg mr-2"}),D("Submit Requirement ")],-1)])),submitButtonLabel:R(()=>r[36]||(r[36]=[D(" Submit Requirement ")])),_:1},8,["requirement-id"])])])):m("",!0),(ve=s.value)!=null&&ve.status?(a(),i("div",br,[q(oe,null,{default:R(()=>r[37]||(r[37]=[e("h2",{class:"font-semibold text-lg px-2"},"Approvals",-1)])),_:1,__:[37]}),e("div",xr,[(a(),i(U,null,K(["from_in_charge","from_coordinator"],x=>q(De,{class:"pt-12",key:x,requirement:s.value,"approval-type":x,onUpdateApproval:r[15]||(r[15]=()=>h())},null,8,["requirement","approval-type"])),64))]),((fe=s.value)==null?void 0:fe.from_department_id)!==((be=s.value)==null?void 0:be.to_department_id)?(a(),i("div",yr,[(a(),i(U,null,K(["to_in_charge","to_coordinator"],x=>q(De,{class:"pt-12",key:x,requirement:s.value,"approval-type":x,onUpdateApproval:r[16]||(r[16]=()=>h())},null,8,["requirement","approval-type"])),64))])):m("",!0)])):m("",!0)])]),e("div",{class:"col-span-full md:col-span-4 xl:col-span-4 2xl:col-span-3 sticky top-[74px] break-before-avoid-page",ref_key:"sidebarTop",ref:v},[e("div",gr,[e("div",_r,[e("div",null,[e("div",kr,[r[39]||(r[39]=e("div",{class:"text-gray-500 text-sm"},"From",-1)),q(Ne,{department:(xe=s.value)==null?void 0:xe.from_department,"short-name":!0},null,8,["department"])]),r[40]||(r[40]=e("div",{class:"text-gray-600 text-sm mb-2 border-b border-dashed"},"Supervisor",-1)),e("div",hr,[(ye=s.value)!=null&&ye.supervisor?(a(),j(ne,{key:0,user:(ge=s.value)==null?void 0:ge.supervisor},null,8,["user"])):m("",!0)])]),r[42]||(r[42]=e("hr",{class:"my-4"},null,-1)),e("div",null,[e("div",wr,[r[41]||(r[41]=e("div",{class:"text-gray-500 text-sm"},"To",-1)),q(Ne,{department:(_e=s.value)==null?void 0:_e.to_department,"short-name":!0},null,8,["department"])])])]),e("div",qr,[r[43]||(r[43]=e("div",{class:"text-gray-500 text-sm"},"Requirement ID:",-1)),e("div",$r,f((ke=s.value)==null?void 0:ke.id),1)]),((we=(he=s.value)==null?void 0:he.website_tags)==null?void 0:we.length)>0?(a(),i("div",Cr,[r[44]||(r[44]=e("div",{class:"text-gray-500 text-sm"},"Website",-1)),e("div",Tr,[(a(!0),i(U,null,K(((qe=s.value)==null?void 0:qe.website_tags)||[],x=>(a(),i("div",{key:x.id,class:"border px-1 rounded-md bg-sky-100 border-sky-400 text-sky-700 whitespace-nowrap text-xs"},f(x.name),1))),128))])])):m("",!0),($e=s.value)!=null&&$e.submission_date?(a(),i("div",Rr,[r[45]||(r[45]=e("div",{class:"text-gray-500 text-sm"},"Submission Date",-1)),e("div",Sr,f(Y(ie)((Ce=s.value)==null?void 0:Ce.submission_date)),1)])):m("",!0),(Te=s.value)!=null&&Te.better_to_complete_on?(a(),i("div",jr,[r[46]||(r[46]=e("div",{class:"text-gray-500 text-sm"},"Better To Complete",-1)),e("div",Ir,f(Y(ot)((Re=s.value)==null?void 0:Re.better_to_complete_on,{weekDay:"long"})),1)])):m("",!0),e("div",null,[e("div",Ar,[r[47]||(r[47]=e("span",{class:"text-gray-500 text-sm"},"Priority:",-1)),e("div",null,[e("span",{class:E(["font-semibold text-sm",{"text-yellow-600 ":s.value.priority=="IMPORTANT","text-red-700 ":s.value.priority=="URGENT"}])},f(s.value.priority||"NORMAL"),3)])]),e("div",Nr,[e("div",Dr,[r[48]||(r[48]=e("span",{class:"text-gray-500 text-sm"},"Status:",-1)),s.value.status?(a(),i("span",{key:0,class:E(["border rounded-lg px-2 text-sm py-0.5",{"bg-red-300 text-red-700 border-red-400":s.value.status!="approved","bg-green-300 text-green-700 border-green-400":s.value.status=="approved"}])},f(String(s.value.status).toUpperCase()),3)):(a(),i("span",Or,"..."))])]),s.value.closed_at?m("",!0):(a(),i("div",Lr,[e("div",Br,[e("button",{class:"btn-1 border border-sky-800",onClick:r[17]||(r[17]=$(x=>P.value.open=!0,["prevent"]))}," Close Requirement ")])])),((je=(Se=s.value)==null?void 0:Se.closing_history)==null?void 0:je.length)>1?(a(),i("div",Er,[e("button",{onClick:r[18]||(r[18]=x=>p.value=!p.value),class:"text-sm text-sky-400 hover:underline"}," Show Closing History ")])):m("",!0),s.value.rejected_by?(a(),i("div",Fr,[e("div",Vr,[r[49]||(r[49]=e("span",{class:"text-gray-500 text-sm"},"Rejected By:",-1)),q(ne,{user:s.value.rejected_by},null,8,["user"])])])):m("",!0),s.value.rejection_reason?(a(),i("div",Ur,[r[50]||(r[50]=e("p",{class:"text-gray-600 mb-1 italic"},"Reason",-1)),e("p",null,f(s.value.rejection_reason),1)])):m("",!0),r[53]||(r[53]=e("hr",{class:"mb-3"},null,-1)),(Ie=s.value)!=null&&Ie.closed_at?(a(),j(Bt,{key:4,requirement:s.value,onReOpenClick:r[19]||(r[19]=x=>P.value.open=!0)},null,8,["requirement"])):(a(),i("div",Mr,[s.value.status=="approved"?(a(),i("button",{key:0,class:"btn-3 font-semibold h-8 !pl-2 !pr-4",onClick:$(I,["prevent"])},r[51]||(r[51]=[e("i",{class:"fas fa-plus text-sm"},null,-1),D(" Add/Assign Task ")]))):m("",!0),q(G,{class:"btn-2 h-8",to:`/requirements/edit/${(Ae=s.value)==null?void 0:Ae.id}`},{default:R(()=>r[52]||(r[52]=[D(" Edit ")])),_:1,__:[52]},8,["to"])]))])]),q(Rt,{requirement:s.value,class:"mt-4 md:col-span-4 xl:col-span-4 2xl:col-span-3"},null,8,["requirement"]),q(He,{class:"mt-4 md:col-span-4 xl:col-span-4 2xl:col-span-3",ref_key:"shareComponent",ref:b},null,512)],512)])):m("",!0),c.value==="loading"?(a(),j(de,{key:1,class:"absolute inset-0 bg-opacity-90"})):m("",!0)])])}}};export{Rn as default};
