import{r as p,e as G,E as J,m as g,G as Q,z as W,c as f,o as v,a as d,h as L,H as m,g as j,F as R,q as H,j as x,t as b,w as X,v as z,I as S,x as A,J as Y}from"./index-Db80mu-f.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const _={class:"w-full"},ee={key:0,class:"flex flex-wrap items-center gap-1 w-full justify-items-stretch"},te={class:"bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm"},le=["onClick"],ae={key:1,class:"text-gray-400"},oe={key:2,class:"flex-grow"},se=["placeholder"],ne={key:0,class:"p-3"},re={class:"max-h-60 overflow-auto"},ue=["onClick","onKeydown"],ie={key:1,class:"px-3 py-2 text-gray-500 min-h-24 flex justify-center items-center"},de={__name:"SelectDropdown",props:{options:{type:Array,required:!0},modelValue:{type:[Object,Array,String,Number,null],default:null},placeholder:{type:String,default:"Select..."},multiple:{type:Boolean,default:!1},label:{type:String,default:"label"},value:{type:String,default:"id"},clearable:{type:Boolean,default:!0},searchable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},filterBy:{type:Function,default:null},reduce:{type:Function,default:null},position:{type:String,default:"auto",validator:s=>["top","left","right","bottom","auto"].includes(s)},containment:{type:Object,default:()=>window},taggable:{type:Boolean,default:!1},createOption:Function},emits:["update:modelValue","input","open","close","search","search:focus","search:blur","option:selecting","option:selected","option:deselecting","option:deselected"],setup(s,{emit:T}){const l=s,o=T,n=p(!1),r=p(""),y=p(),E=p(),w=p(l.position);function D(e){y.value&&!y.value.contains(e.target)&&n.value&&(n.value=!1,o("close"))}G(()=>{document.addEventListener("click",D),l.containment.addEventListener("scroll",()=>C(n.value))}),J(()=>{document.removeEventListener("click",D),l.containment.removeEventListener("scroll",()=>C(n.value))});const U=g(()=>l.multiple||l.taggable),q=g(()=>{const e={top:"bottom-[100%] mb-0.5",left:"right-[100%] mr-0.5",right:"left-[100%] ml-0.5",bottom:"top-[100%] mt-0.5"};return e[w.value]||e.bottom}),u=g(()=>l.multiple?Array.isArray(l.modelValue)?l.modelValue:[]:l.modelValue),$=e=>(e==null?void 0:e[l.label])??(e==null?void 0:e.label)??e,F=e=>{if((!l.multiple||!l.taggable)&&!Array.isArray(e)){console.log({option:e});const t=l.options.find(a=>a[l.value]==e);return t?(t==null?void 0:t[l.label])??(t==null?void 0:t.label)??t:(e==null?void 0:e[l.label])??(e==null?void 0:e.label)??e}},i=e=>typeof e=="object"?(e==null?void 0:e[l.value])??(e==null?void 0:e.value)??e:typeof e=="string"?e:"",M=()=>{l.disabled||(n.value=!n.value,o(n.value?"open":"close"))},V=e=>{const t=i(e);return l.multiple||l.taggable?u.value.some(a=>i(a)===t):i(u.value)===t},h=e=>{if(l.multiple||l.taggable)if(V(e)){o("option:deselecting",e);const t=u.value.filter(a=>i(a)!==i(e));o("update:modelValue",t),o("option:deselected",e)}else{o("option:selecting",e);const t=[...u.value,e];o("update:modelValue",t),o("option:selected",e)}else o("option:selected",e),typeof l.modelValue=="object"?o("update:modelValue",e):o("update:modelValue",i(e));n.value=!1,o("close"),o("input",e),r.value=""},I=e=>{const t=u.value.filter(a=>i(a)!==i(e));o("update:modelValue",t),o("option:deselected",e)},B=g(()=>{const e=r.value.toLowerCase();return!l.searchable||!e?l.options:typeof l.filterBy=="function"?l.filterBy(l.options,e):l.options.filter(t=>$(t).toLowerCase().includes(e))});async function C(e){if(e&&l.position==="auto"){await Q();const t=y.value,a=E.value;if(t&&a){console.log({cm:l.containment});const c=t.getBoundingClientRect(),k=a.offsetHeight,N=(l.containment.innerHeight||l.containment.clientHeight)-c.bottom,O=c.top;console.log({triggerRect:c,dropdownHeight:k,spaceBelow:N,spaceAbove:O}),O<k?w.value="bottom":w.value=N<k&&O>k?"top":"bottom"}}else w.value=l.position}const K=g(()=>B.value.find(e=>$(e).toLowerCase()===r.value.toLowerCase()));function P(e){if(e.preventDefault(),!(!l.taggable||!r.value.trim())){if(K.value)h(K.value);else{const t=l.createOption?l.createOption(r.value):r.value.trim();o("option:created",t),o("option:selected",t),o("input",t),o("update:modelValue",[...l.modelValue,{[l.label]:t}]),M()}r.value=""}}return W(n,C),(e,t)=>(v(),f("div",{class:"relative w-full",ref_key:"dropdownRef",ref:y},[d("div",{class:A(["border rounded-md px-2 py-1.5 cursor-pointer bg-white flex items-center justify-between",{"bg-gray-100":s.disabled}]),onClick:M},[d("div",_,[U.value?(v(),f("div",ee,[Array.isArray(u.value)&&u.value.length>0?(v(!0),f(R,{key:0},H(u.value,a=>m(e.$slots,"selected-option",{key:i(a),option:a,removeItem:c=>I(c)},()=>[d("span",te,[x(b(F(a))+" ",1),d("button",{type:"button",onClick:X(c=>I(a),["prevent","stop"]),class:"ml-1 text-xs"}," Ã— ",8,le)])],!0)),128)):s.taggable?j("",!0):(v(),f("span",ae,b(s.placeholder),1)),s.taggable?(v(),f("span",oe,[L(d("input",{type:"text",onKeydown:[S(P,["enter"]),t[0]||(t[0]=()=>n.value=!0)],"onUpdate:modelValue":t[1]||(t[1]=a=>r.value=a),class:"w-full px-2 py-1 rounded outline-none",placeholder:s.placeholder,onFocus:t[2]||(t[2]=a=>e.$emit("search:focus")),onBlur:t[3]||(t[3]=a=>e.$emit("search:blur"))},null,40,se),[[z,r.value]])])):j("",!0)])):m(e.$slots,"selected-option",{key:1,option:u.value,isSelected:V},()=>[x(b(F(u.value)||s.placeholder),1)],!0)]),m(e.$slots,"open-indicator",{},()=>[t[8]||(t[8]=d("svg",{class:"w-4 h-4 ml-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))],!0)],2),L(d("div",{class:A(["absolute w-full border rounded shadow-[0px_0px_10px_0px_rgba(0,0,0,0.25)] z-50 border-teal-500 bg-white",q.value]),ref_key:"dropdownMenuRef",ref:E},[s.searchable&&!s.taggable?(v(),f("div",ne,[m(e.$slots,"search",{},()=>[L(d("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=a=>r.value=a),class:"w-full px-2 py-1 border rounded",placeholder:"Search...",onFocus:t[5]||(t[5]=a=>e.$emit("search:focus")),onBlur:t[6]||(t[6]=a=>e.$emit("search:blur")),onKeyup:t[7]||(t[7]=S(a=>a.preventDefault(),["enter"]))},null,544),[[z,r.value]])],!0)])):j("",!0),m(e.$slots,"list-header",{},void 0,!0),d("ul",re,[B.value.length?(v(!0),f(R,{key:0},H(B.value,a=>(v(),f("li",{tabindex:"0",key:i(a),class:A([{"bg-blue-50":V(a)},"px-3 py-2 hover:bg-blue-100 cursor-pointer"]),onClick:c=>h(a),onKeydown:[S(c=>h(a),["space"]),S(c=>h(a),["enter"])]},[m(e.$slots,"option",{option:a},()=>[x(b($(a)),1)],!0)],42,ue))),128)):(v(),f("li",ie,[m(e.$slots,"no-options",{},()=>[x(b(s.taggable?"No option found, Enter to add":"No options found"),1)],!0)]))]),m(e.$slots,"list-footer",{},void 0,!0)],2),[[Y,n.value]])],512))}},ve=Z(de,[["__scopeId","data-v-21d35402"]]);export{ve as S};
