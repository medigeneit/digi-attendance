import{N as oe,d as ie,r as W,x as ne,A as re,f as Y,o as n,c as u,g,a as e,n as d,t as o,j as i,q as de,k as ue,i as pe,D as ce,X as me}from"./index-DBkH8yyG.js";import{_ as v}from"./ApprovalItem-BhzKsm8U.js";import{L as ve}from"./LoaderView-JXku94jZ.js";import{_ as fe}from"./ScreenshotCapture-B0sRYmk_.js";import{_ as he}from"./ShareComponent-B0jwK1RD.js";import{u as _e}from"./short-leave-DWuV9hHL.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AcceptAndRejectHandler-PA1GoFdr.js";const be={key:0,class:"fixed inset-0 z-[999] flex items-center justify-center bg-black/50 p-4","aria-modal":"true",role:"dialog","aria-labelledby":"short-leave-title"},ge={class:"relative w-full max-w-4xl rounded-lg bg-white shadow-xl max-h-[90vh] overflow-y-auto print:overflow-visible print:shadow-none print:max-h-none"},xe={class:"p-4 md:p-8"},we={key:1,id:"leave-application"},Ae={class:"flex justify-end"},ke={class:"font-medium"},Se={class:"gap-y-1"},Le={class:"gap-y-1"},Ne={class:"grid md:grid-cols-2"},De={class:"grid md:grid-cols-3 gap-x-4 pt-2 md:justify-between items-end md:items-start"},je={class:"md:col-span-2"},Ce={class:"text-center"},Fe={class:"title-md"},Be={key:0},Re={class:"grid grid-cols-2 text-sm md:text-base md:grid-cols-3 md:gap-x-4 gap-y-14 pt-14 items-end"},Te={class:"space-y-2"},Ve={key:0,class:"mb-2"},Ie=["href"],ze={key:1,class:"text-center text-lg italic text-gray-400"},Me={key:2,class:"print:hidden"},Ue={__name:"ShortLeaveDetailsModal",props:{open:{type:Boolean,default:!1},id:{type:[String,Number],required:!0}},emits:["update:open"],setup(x,{emit:Z}){const p=x,ee=Z,f=oe(),h=_e(),te=ie(),w=W(null),_=W(!1),a=ne(()=>h.shortLeave),y=()=>ee("update:open",!1),b=async()=>{if(p.id){_.value=!0;try{await h.fetchShortLeaveById(p.id)}catch(l){console.error("Failed to fetch short leave details:",l),f.error("Failed to load short leave details.")}finally{_.value=!1}}};re(()=>[p.open,p.id],([l])=>{l&&b()},{immediate:!0});const ae=async()=>{try{const l={attachment:w.value};await h.uploadShortLeaveAttachment(p.id,l),f.success("Attachment saved!"),await b()}catch(l){console.error("Failed to upload attachment:",l),f.error("Failed to upload attachment.")}},le=async l=>{var m;const t=(m=l.target.files)==null?void 0:m[0];if(!t)return;const r=new FormData;r.append("file",t);const s=await h.fetchFileUpload(r);w.value=(s==null?void 0:s.url)||null,s!=null&&s.url?await ae():f.error("Failed to upload file!")},se=l=>l?new Date(l).toISOString().slice(0,10):"N/A",A=l=>{if(!l)return"N/A";const[t,r]=l.split(":").map(Number),s=new Date;return s.setHours(t||0,r||0),s.toLocaleString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},c=async()=>{await b()};return(l,t)=>{var r,s,m,k,S,L,N,D,j,C,F,B,R,T,V,I,z,M,U,$,q,K,E,H,O,P,X,G,J,Q;return n(),Y(me,{to:"body"},[x.open?(n(),u("div",be,[e("div",{class:"relative max-h-[90vh] w-full max-w-4xl overflow-y-auto rounded-2xl bg-white p-4 md:p-6 shadow-2xl print:static print:overflow-visible",onClick:y}),e("div",{class:"fixed inset-0 flex items-center justify-center p-4",onKeydown:ce(y,["esc"])},[e("div",ge,[e("div",{class:"sticky top-0 z-10 flex items-center justify-between gap-2 border-b bg-white px-4 py-3 print:hidden"},[t[1]||(t[1]=e("h2",{id:"short-leave-title",class:"title-lg"},"Short Leave Details",-1)),e("div",{class:"flex items-center gap-2"},[e("button",{class:"btn-3",onClick:y,"aria-label":"Close"},t[0]||(t[0]=[e("i",{class:"far fa-times"},null,-1),e("span",{class:"hidden md:inline"},"Close",-1)]))])]),e("div",xe,[_.value?(n(),Y(ve,{key:0})):(n(),u("div",we,[e("div",Ae,[e("div",null,"Date: "+o(se((r=a.value)==null?void 0:r.created_at)),1)]),e("div",null,[e("p",ke,[t[2]||(t[2]=i(" Name: ")),e("b",null,o((m=(s=a.value)==null?void 0:s.user)==null?void 0:m.name),1)]),e("div",Se,[e("p",null,[t[3]||(t[3]=i("Designation: ")),e("b",null,o((L=(S=(k=a.value)==null?void 0:k.user)==null?void 0:S.designation)==null?void 0:L.title),1)])]),e("div",Le,[e("p",null,[t[4]||(t[4]=i("Department: ")),e("b",null,o((j=(D=(N=a.value)==null?void 0:N.user)==null?void 0:D.company)==null?void 0:j.name),1)])])]),e("div",null,[e("div",Ne,[e("div",null,[t[5]||(t[5]=e("b",null,"From:",-1)),i(" "+o((C=a.value)!=null&&C.start_time?A((F=a.value)==null?void 0:F.start_time):""),1)]),e("div",null,[t[6]||(t[6]=e("b",null,"To:",-1)),i(" "+o((B=a.value)!=null&&B.end_time?A((R=a.value)==null?void 0:R.end_time):""),1)]),e("div",null,[t[7]||(t[7]=e("b",null,"Short Leave Date:",-1)),i(" "+o((T=a.value)==null?void 0:T.date),1)]),e("div",null,[t[8]||(t[8]=e("b",null,"Total Minutes:",-1)),i(" "+o((V=a.value)==null?void 0:V.total_minutes),1)])]),e("div",De,[e("div",je,[t[9]||(t[9]=e("b",null,"Reason:",-1)),i(" "+o(((I=a.value)==null?void 0:I.reason)||"N/A"),1)]),d(v,{application:a.value,type:"short_leave_applications",item:"handover",onAction:c,class:"pt-10 ml-auto hidden md:block"},null,8,["application"])])]),t[14]||(t[14]=e("hr",null,null,-1)),e("div",Ce,[e("h3",Fe,[t[10]||(t[10]=i(" Approvals ")),e("span",{class:de({"text-yellow-500":((z=a.value)==null?void 0:z.status)==="Pending","text-green-500":((M=a.value)==null?void 0:M.status)==="Approved","text-red-500":((U=a.value)==null?void 0:U.status)==="Rejected"})}," ("+o((($=a.value)==null?void 0:$.status)||"N/A")+") ",3)]),((q=a.value)==null?void 0:q.status)==="Rejected"?(n(),u("div",Be,[e("div",null,[t[11]||(t[11]=e("b",null,"Rejected By:",-1)),i(" "+o(((E=(K=a.value)==null?void 0:K.rejected_by_user)==null?void 0:E.name)||"N/A"),1)]),e("div",null,[t[12]||(t[12]=e("b",null,"Rejection Reason:",-1)),i(" "+o(((H=a.value)==null?void 0:H.rejection_reason)||"N/A"),1)])])):g("",!0)]),e("div",Re,[d(v,{application:a.value,type:"short_leave_applications",item:"handover",onAction:c,class:"md:hidden"},null,8,["application"]),d(v,{application:a.value,type:"short_leave_applications",item:"in_charge",onAction:c},null,8,["application"]),d(v,{application:a.value,type:"short_leave_applications",item:"recommend_by",onAction:c},null,8,["application"]),d(v,{application:a.value,type:"short_leave_applications",item:"approved_by",onAction:c},null,8,["application"])]),e("div",Te,[t[13]||(t[13]=e("label",{class:"font-medium"},"Attachment",-1)),(O=a.value)!=null&&O.attachment&&typeof((P=a.value)==null?void 0:P.attachment)=="string"?(n(),u("div",Ve,[e("a",{href:(X=a.value)==null?void 0:X.attachment,target:"_blank",class:"text-blue-500 underline"}," View Current File ",8,Ie)])):(n(),u("div",ze,"No attachment")),((J=(G=ue(te))==null?void 0:G.user)==null?void 0:J.id)===((Q=a.value)==null?void 0:Q.user_id)?(n(),u("div",Me,[e("input",{type:"file",onChange:le,class:"w-full p-2 border rounded"},null,32)])):g("",!0)]),d(he,{class:"print:hidden"},{default:pe(()=>[d(fe,{targetId:"leave-application",platform:"whatsapp"})]),_:1})]))])])],32)])):g("",!0)])}}},Ge=ye(Ue,[["__scopeId","data-v-8bd5d4ae"]]);export{Ge as default};
