import{J as j,r as v,K as o,a0 as B}from"./index-D3P1gRIA.js";const M=j("leaveApplication",()=>{const s=v([]),d=v(null),c=v(!1),l=v(null),f=v(new Date().toISOString().substring(0,7)),h=v("");async function p(a={}){var i,n;c.value=!0,l.value=null;try{const t=await o.get("/leave-applications",{params:a});t.data?s.value=t.data:s.value=[]}catch(t){l.value=((n=(i=t.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to fetch leave applications"}finally{c.value=!1}}async function w(a={}){var i,n;c.value=!0,l.value=null;try{const t=await o.get("/my-leave-applications",{params:a});s.value=t.data.data}catch(t){l.value=((n=(i=t.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to fetch leave applications"}finally{c.value=!1}}async function m(a){var i,n,t,e;c.value=!0,l.value=null;try{const r=await o.post("/leave-applications/store",a);return s.value.push((i=r==null?void 0:r.data)==null?void 0:i.data),(n=r==null?void 0:r.data)==null?void 0:n.data}catch(r){throw l.value=((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to store leave application",new Error(l.value)}finally{c.value=!1}}async function g(a){var i,n;c.value=!0,l.value=null;try{await o.delete(`/my-leave-application/destroy/${a}`),await p()}catch(t){throw l.value=((n=(i=t.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to store leave application",new Error(l.value)}finally{c.value=!1}}const x=async a=>{var i,n;try{return c.value=!0,(await o.post("cental-attachment-upload",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){l.value=((n=(i=t.response)==null?void 0:i.data)==null?void 0:n.message)||"Something went wrong"}finally{c.value=!1}};async function y(a,i){var n,t;c.value=!0,l.value=null;try{const e=await o.post(`/leave-applications/${a}/update`,i),r=s.value.findIndex(u=>u.id===a);return r!==-1&&(s.value[r]=e.data.data),e.data.data}catch(e){throw l.value=((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to update leave application",new Error(l.value)}finally{c.value=!1}}const A=async(a,i)=>{var n,t;c.value=!0,l.value=null;try{const e=await o.put(`/leave-attachment/${a}`,i),r=s.value.findIndex(u=>u.id===a);return r!==-1&&(s.value[r]=e.data.data),e.data.data}catch(e){throw l.value=((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||`Failed to update application leave (ID: ${a})`,console.error(`Error updating application leave with id ${a}:`,e),new Error(l.value)}finally{c.value=!1}};async function F(a){var i,n;c.value=!0,l.value=null;try{const t=await o.get(`/leave-applications/${a}`);d.value=t==null?void 0:t.data,await B().fetchApprovalPermissions("leave_applications",d.value.id)}catch(t){l.value=((n=(i=t.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to fetch leave application"}finally{c.value=!1}}async function I(a){var i,n;c.value=!0,l.value=null;try{const t=await o.post(`/leave-applications/${a.id}/handover-accept`,a),e=s.value.findIndex(r=>r.id===(a==null?void 0:a.id));return e!==-1&&(s.value[e]=t.data.data),t.data.data}catch(t){throw l.value=((n=(i=t.response)==null?void 0:i.data)==null?void 0:n.message)||"Failed to accept handover",new Error(l.value)}finally{c.value=!1}}async function $(a){var i,n,t;c.value=!0,l.value=null;try{const e=await o.post(`/leave-applications/${a.id}/incharge-accept`,a),r=s.value.findIndex(u=>u.id===(a==null?void 0:a.id));return r!==-1&&(s.value[r]=e.data.data),(i=e==null?void 0:e.data)==null?void 0:i.data}catch(e){throw l.value=((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to accept in-charge approval",new Error(l.value)}finally{c.value=!1}}async function E(a){var i,n,t;c.value=!0,l.value=null;try{const e=await o.post(`/leave-applications/${a.id}/coordinator-accept`,a),r=s.value.findIndex(u=>u.id===(a==null?void 0:a.id));return r!==-1&&(s.value[r]=e.data.data),(i=e==null?void 0:e.data)==null?void 0:i.data}catch(e){throw l.value=((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to accept coordinator approval",new Error(l.value)}finally{c.value=!1}}async function L(a){var i,n,t;c.value=!0,l.value=null;try{const e=await o.post(`/leave-applications/${a.id}/operational-admin-accept`,a),r=s.value.findIndex(u=>u.id===(a==null?void 0:a.id));return r!==-1&&(s.value[r]=e.data.data),(i=e==null?void 0:e.data)==null?void 0:i.data}catch(e){throw l.value=((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to accept operational admin approval",new Error(l.value)}finally{c.value=!1}}async function S(a){var i,n,t;c.value=!0,l.value=null;try{const e=await o.post(`/leave-applications/${a.id}/recommend-by-accept`,a),r=s.value.findIndex(u=>u.id===(a==null?void 0:a.id));return r!==-1&&(s.value[r]=e.data.data),(i=e==null?void 0:e.data)==null?void 0:i.data}catch(e){throw l.value=((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to accept recommend by approval",new Error(l.value)}finally{c.value=!1}}async function b(a){var i,n,t;c.value=!0,l.value=null;try{const e=await o.post(`/leave-applications/${a==null?void 0:a.id}/approved-by-accept`,a),r=s.value.findIndex(u=>u.id===(a==null?void 0:a.id));return r!==-1&&(s.value[r]=e.data.data),(i=e==null?void 0:e.data)==null?void 0:i.data}catch(e){throw l.value=((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to accept approval by admin",new Error(l.value)}finally{c.value=!1}}async function C(a,i){var n,t;c.value=!0,l.value=null;try{const e=await o.post(`/leave-applications/${a}/reject`,i),r=s.value.findIndex(u=>u.id===a);return r!==-1&&(s.value[r]=e.data.data),e.data.data}catch(e){throw l.value=((t=(n=e.response)==null?void 0:n.data)==null?void 0:t.message)||"Failed to reject leave application",new Error(l.value)}finally{c.value=!1}}return{leaveApplications:s,leaveApplication:d,loading:c,error:l,selectedMonth:f,selectedStatus:h,fetchLeaveApplications:p,storeLeaveApplication:m,updateLeaveApplication:y,fetchLeaveApplicationById:F,acceptHandover:I,acceptInCharge:$,acceptCoordinator:E,acceptOperationalAdmin:L,acceptRecommendBy:S,acceptApprovedBy:b,rejectLeaveApplication:C,fetchMyLeaveApplications:w,deleteLeaveApplication:g,fetchFileUpload:x,uploadLeaveApplicationAttachment:A}});export{M as u};
