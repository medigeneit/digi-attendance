import{E as U,r as v,G as u,a6 as G}from"./index-DT7IHcEh.js";const N=U("leaveApplication",()=>{const f=v([]),o=v([]),p=v(null),r=v(!1),i=v(null),m=v(new Date().toISOString().substring(0,7)),g=v(new Date().getFullYear()),d=v(null),h=v([]),y=v("");async function w(e={}){var n,l;r.value=!0,i.value=null;try{const t=await u.get("/leave-applications",{params:e});t.data?o.value=t.data:o.value=[]}catch(t){i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch leave applications"}finally{r.value=!1}}const A=async(e,n)=>{var l,t;if(!e||!n){i.value="Invalid user ID or month";return}r.value=!0;try{const a=await u.get(`/user/${e}/application/monthly/${n}/log`);console.log({response:a}),f.value=a.data.applications}catch(a){i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Something went wrong",console.error(i.value)}finally{r.value=!1}};async function x(e={}){var n,l,t,a,c;r.value=!0,i.value=null;try{const s=await u.get("/yearly-user-leave-applications",{params:e});s.data?(o.value=(n=s==null?void 0:s.data)==null?void 0:n.leave_applications,d.value=(l=s==null?void 0:s.data)==null?void 0:l.user,h.value=(t=s==null?void 0:s.data)==null?void 0:t.leave_balances):(o.value=[],d.value=[])}catch(s){i.value=((c=(a=s.response)==null?void 0:a.data)==null?void 0:c.message)||"Failed to fetch leave applications"}finally{r.value=!1}}async function F(e={}){var n,l;r.value=!0,i.value=null;try{const t=await u.get("/my-leave-applications",{params:e});o.value=t.data.data}catch(t){i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch leave applications"}finally{r.value=!1}}async function $(e){var n,l,t,a;r.value=!0,i.value=null;try{const c=await u.post("/leave-applications/store",e);return o.value.push((n=c==null?void 0:c.data)==null?void 0:n.data),(l=c==null?void 0:c.data)==null?void 0:l.data}catch(c){throw i.value=((a=(t=c.response)==null?void 0:t.data)==null?void 0:a.message)||"Failed to store leave application",new Error(i.value)}finally{r.value=!1}}async function E(e){var n,l,t;r.value=!0,i.value=null;try{console.log(111);const a=await u.post("/admin-leave-applications/store",e);return console.log(a),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to store leave application",new Error(i.value)}finally{r.value=!1}}async function I(e){var n,l;r.value=!0,i.value=null;try{await u.delete(`/my-leave-application/destroy/${e}`),await w()}catch(t){throw i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to store leave application",new Error(i.value)}finally{r.value=!1}}const L=async e=>{var n,l;try{return r.value=!0,(await u.post("cental-attachment-upload",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Something went wrong"}finally{r.value=!1}};async function S(e,n){var l,t;r.value=!0,i.value=null;try{const a=await u.post(`/leave-applications/${e}/update`,n),c=o.value.findIndex(s=>s.id===e);return c!==-1&&(o.value[c]=a.data.data),a.data.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to update leave application",new Error(i.value)}finally{r.value=!1}}const b=async(e,n)=>{var l,t;r.value=!0,i.value=null;try{const a=await u.put(`/leave-attachment/${e}`,n),c=o.value.findIndex(s=>s.id===e);return c!==-1&&(o.value[c]=a.data.data),a.data.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||`Failed to update application leave (ID: ${e})`,console.error(`Error updating application leave with id ${e}:`,a),new Error(i.value)}finally{r.value=!1}};async function C(e){var n,l;r.value=!0,i.value=null;try{const t=await u.get(`/leave-applications/${e}`);p.value=t==null?void 0:t.data,await G().fetchApprovalPermissions("leave_applications",p.value.id)}catch(t){i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch leave application"}finally{r.value=!1}}async function D(e){var n,l;r.value=!0,i.value=null;try{const t=await u.post(`/leave-applications/${e.id}/handover-accept`,e),a=o.value.findIndex(c=>c.id===(e==null?void 0:e.id));return a!==-1&&(o.value[a]=t.data.data),t.data.data}catch(t){throw i.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to accept handover",new Error(i.value)}finally{r.value=!1}}async function _(e){var n,l,t;r.value=!0,i.value=null;try{const a=await u.post(`/leave-applications/${e.id}/incharge-accept`,e),c=o.value.findIndex(s=>s.id===(e==null?void 0:e.id));return c!==-1&&(o.value[c]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept in-charge approval",new Error(i.value)}finally{r.value=!1}}async function j(e){var n,l,t;r.value=!0,i.value=null;try{const a=await u.post(`/leave-applications/${e.id}/coordinator-accept`,e),c=o.value.findIndex(s=>s.id===(e==null?void 0:e.id));return c!==-1&&(o.value[c]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept coordinator approval",new Error(i.value)}finally{r.value=!1}}async function B(e){var n,l,t;r.value=!0,i.value=null;try{const a=await u.post(`/leave-applications/${e.id}/operational-admin-accept`,e),c=o.value.findIndex(s=>s.id===(e==null?void 0:e.id));return c!==-1&&(o.value[c]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept operational admin approval",new Error(i.value)}finally{r.value=!1}}async function M(e){var n,l,t;r.value=!0,i.value=null;try{const a=await u.post(`/leave-applications/${e.id}/recommend-by-accept`,e),c=o.value.findIndex(s=>s.id===(e==null?void 0:e.id));return c!==-1&&(o.value[c]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept recommend by approval",new Error(i.value)}finally{r.value=!1}}async function Y(e){var n,l,t;r.value=!0,i.value=null;try{const a=await u.post(`/leave-applications/${e==null?void 0:e.id}/approved-by-accept`,e),c=o.value.findIndex(s=>s.id===(e==null?void 0:e.id));return c!==-1&&(o.value[c]=a.data.data),(n=a==null?void 0:a.data)==null?void 0:n.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept approval by admin",new Error(i.value)}finally{r.value=!1}}async function O(e,n){var l,t;r.value=!0,i.value=null;try{const a=await u.post(`/leave-applications/${e}/reject`,n),c=o.value.findIndex(s=>s.id===e);return c!==-1&&(o.value[c]=a.data.data),a.data.data}catch(a){throw i.value=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to reject leave application",new Error(i.value)}finally{r.value=!1}}return{leaveApplications:o,leaveApplication:p,applicationLog:f,loading:r,error:i,selectedMonth:m,selectedYear:g,user:d,selectedStatus:y,fetchLeaveApplications:w,storeLeaveApplication:$,updateLeaveApplication:S,fetchLeaveApplicationById:C,acceptHandover:D,acceptInCharge:_,acceptCoordinator:j,acceptOperationalAdmin:B,acceptRecommendBy:M,acceptApprovedBy:Y,rejectLeaveApplication:O,fetchMyLeaveApplications:F,deleteLeaveApplication:I,fetchFileUpload:L,uploadLeaveApplicationAttachment:b,fetchYearlyUserLeaveApplications:x,getMonthlyApplicationLog:A,storeAdminLeaveApplication:E,leave_balances:h}});export{N as u};
