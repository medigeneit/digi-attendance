import{u as N,b as D,r as c,s as F,e as j,A as g,n as P,c as a,o as d,a as t,p as f,k as u,h as C,v as T,C as $,g as E,F as O,x as z,t as p,i as G}from"./index-Bye8Nm01.js";import{_ as H}from"./EmployeeFilter-Df4HHEfN.js";import{L as I}from"./LoaderView-CYvfQEqW.js";import{u as J}from"./exchange-BtEpD8Xn.js";import{u as K}from"./user-BQ2jK3Hg.js";import"./MultiselectDropdown-G8bpQoWY.js";import"./company-BNPdxYMK.js";import"./department-6D9R1CXi.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={class:"space-y-2 px-4"},W={class:"flex flex-wrap gap-4"},X={key:0,class:"text-center py-4"},Y={key:1,class:"space-y-4"},Z={class:"overflow-x-auto"},tt={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},et={class:"border border-gray-300 px-2"},st={class:"border border-gray-300 px-2"},ot={class:"border border-gray-300 px-2"},rt={class:"border border-gray-300 px-2"},lt={class:"border border-gray-300 px-2"},at={class:"border border-gray-300 px-2 text-center"},dt=["href"],it={class:"border border-gray-300 px-2"},nt={class:"border border-gray-300 px-2"},ut={class:"flex gap-2"},pt=["onClick"],yt={key:0},q="shift",gt={__name:"ShiftExchangeList",setup(mt){const m=N(),l=D(),r=J(),_=K(),A=c(null),i=c(l.query.date||r.selectedMonth),{loading:V}=F(r),o=c({company_id:l.query.company_id||"",department_id:l.query.department_id||"all",type:l.query.type||"all",employee_id:l.query.employee_id||"",category:""});j(async()=>{V.value=!0,await _.fetchUsers(),A.value=_.users.find(n=>{var s;return n.id==((s=l==null?void 0:l.query)==null?void 0:s.employee_id)}),await y()});const y=async()=>{o.value.employee_id?await r.fetchAllExchanges({company_id:o.value.company_id,department_id:o.value.department_id,user_id:o.value.employee_id,type:q,selectedMonth:i.value,selectedStatus:r.selectedStatus}):await r.fetchAllExchanges({company_id:o.value.company_id,department_id:o.value.department_id,type:q,selectedMonth:i.value,selectedStatus:r.selectedStatus})};g(()=>[o.value.company_id,o.value.department_id,o.value.employee_id,i.value],async()=>{await y()}),g(i,n=>{m.replace({query:{...l.query,date:n}})});const U=()=>{m.go(-1)},M=async n=>{confirm("Are you sure to delete this application?")&&r.deleteExchange(n)},R=()=>{m.replace({query:{...l.query,company_id:o.value.company_id,department_id:o.value.department_id,type:o.value.type,employee_id:o.value.employee_id}})};return(n,s)=>{var b,v,S;const B=P("RouterLink");return d(),a("div",Q,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:U},s[3]||(s[3]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),s[4]||(s[4]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Shift Exchanges",-1)),s[5]||(s[5]=t("div",null,null,-1))]),t("div",W,[f(H,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=e=>o.value=e),"initial-value":u(l).query,onFilterChange:R},null,8,["modelValue","initial-value"]),t("div",null,[C(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e),onChange:y,class:"input-1"},null,544),[[T,i.value]])]),t("div",null,[C(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>u(r).selectedStatus=e),onChange:y,class:"input-1"},s[6]||(s[6]=[t("option",{value:"",selected:""},"All",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Rejected"},"Rejected",-1)]),544),[[$,u(r).selectedStatus]])])]),u(r).loading?(d(),a("div",X,[f(I)])):(d(),a("div",Y,[t("div",Z,[t("table",tt,[s[11]||(s[11]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border border-gray-300 px-2 text-left"},"#"),t("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),t("th",{class:"border border-gray-300 px-2 text-left"},"Exchange Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Current Shift"),t("th",{class:"border border-gray-300 px-2 text-left"},"Exchange Shift"),t("th",{class:"border border-gray-300 px-2 text-left"},"Attachment"),t("th",{class:"border border-gray-300 px-2 text-left"},"Status"),t("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),t("tbody",null,[(d(!0),a(O,null,z((b=u(r))==null?void 0:b.all_exchanges,(e,L)=>{var k,w,h,x;return d(),a("tr",{key:e==null?void 0:e.id,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",et,p(L+1),1),t("td",st,p(((k=e==null?void 0:e.user)==null?void 0:k.name)||"Unknown"),1),t("td",ot,p(e==null?void 0:e.exchange_date),1),t("td",rt,p((h=(w=e==null?void 0:e.user)==null?void 0:w.shift)==null?void 0:h.name),1),t("td",lt,p((x=e==null?void 0:e.shift)==null?void 0:x.name),1),t("td",at,[e.attachment?(d(),a("a",{key:0,href:e==null?void 0:e.attachment,target:"_blank",class:"text-blue-500 underline"},s[7]||(s[7]=[t("i",{class:"fad fa-link"},null,-1)]),8,dt)):E("",!0)]),t("td",it,p((e==null?void 0:e.status)||"N/A"),1),t("td",nt,[t("div",ut,[f(B,{to:{name:"ExchangeShiftShow",params:{id:e==null?void 0:e.id}},class:"btn-icon"},{default:G(()=>s[8]||(s[8]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[8]},1032,["to"]),t("button",{onClick:ct=>M(e==null?void 0:e.id),class:"btn-icon text-red-500"},s[9]||(s[9]=[t("i",{class:"far fa-trash"},null,-1)]),8,pt)])])])}),128)),((S=(v=u(r))==null?void 0:v.all_exchanges)==null?void 0:S.length)===0?(d(),a("tr",yt,s[10]||(s[10]=[t("td",{colspan:"6",class:"p-2 text-center text-red-500"},"No shift exchanges found",-1)]))):E("",!0)])])])]))])}}};export{gt as default};
