import{u as E,b as R,s as j,r as u,e as z,m as I,c as m,o as g,a as e,n as w,i as S,h as f,B as $,v as V,l as G,k as s,t as a,j as x,F as H,y as J}from"./index-8KAp3d5I.js";import{L as O}from"./LoaderView-wPDpQ1P9.js";import{u as Q}from"./monthly-kpi-forms-BfaeHIRl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"space-y-4 px-4"},X={class:"flex items-center justify-between gap-2"},Y={class:"rounded-xl border bg-white p-4 shadow-sm"},Z={class:"grid items-end gap-3 md:grid-cols-12"},tt={class:"md:col-span-3"},et={class:"md:col-span-3"},ot={class:"md:col-span-3"},st={class:"md:col-span-3"},nt={class:"md:col-span-2"},dt={class:"md:col-span-2"},at={class:"md:col-span-2"},lt={key:0,class:"py-8 text-center"},rt={key:1,class:"rounded-md border border-red-200 bg-red-50 p-3 text-red-700"},it={key:2,class:"rounded-xl border bg-white p-8 text-center text-gray-600"},ut={key:3,class:"overflow-x-auto rounded-xl border bg-white shadow-sm"},pt={class:"min-w-full text-sm"},mt={class:"bg-gray-100 text-left text-gray-700"},gt={class:"px-3 py-2"},ft={class:"px-3 py-2 capitalize"},vt={class:"px-3 py-2"},yt={class:"px-3 py-2"},xt={class:"px-3 py-2"},bt={class:"px-3 py-2"},ct={class:"px-3 py-2 text-right"},_t={class:"inline-flex gap-1"},kt=["onClick"],Ct={class:"flex items-center justify-between gap-3 border-t px-3 py-2 text-sm"},wt={class:"text-gray-600"},$t={class:"font-medium"},Mt={class:"font-medium"},Pt={class:"font-medium"},St={class:"flex items-center gap-1"},Vt=["disabled"],Nt={class:"px-2"},ht=["disabled"],Bt={__name:"MonthlyKpiFormList",setup(Ft){const N=E(),r=R(),v=Q(),{items:h,meta:d,isLoading:T,error:F,hasNextPage:U,hasPrevPage:q}=j(v),b=u(r.query.type??""),c=u(r.query.month??""),_=u(r.query.date_from??""),k=u(r.query.date_to??""),p=u(r.query.sort_by??"created_at"),i=u(r.query.sort_dir??"desc"),y=u(Number(r.query.per_page??15)),C=u(Number(r.query.page??1));function B(){N.replace({query:{type:b.value||void 0,month:c.value||void 0,date_from:_.value||void 0,date_to:k.value||void 0,sort_by:p.value!=="created_at"?p.value:void 0,sort_dir:i.value!=="desc"?i.value:void 0,per_page:y.value!==15?String(y.value):void 0,page:v.meta.current_page>1?String(v.meta.current_page):void 0}})}async function l(n={}){await v.fetchList({type:b.value||"",month:c.value||"",date_from:_.value||"",date_to:k.value||"",sort_by:p.value,sort_dir:i.value,per_page:y.value,page:C.value,...n}),C.value=v.meta.current_page,B()}function M(n){p.value===n?i.value=i.value==="asc"?"desc":"asc":(p.value=n,i.value="asc"),l({page:1})}function D(){N.go(-1)}function L(n){C.value=Number(n),l({page:C.value})}function K(n){return n.end_month?`${n.start_month} → ${n.end_month}`:n.start_month}return z(()=>l()),(n,t)=>{const P=I("RouterLink");return g(),m("div",W,[e("div",X,[e("button",{class:"btn-3",onClick:D},t[19]||(t[19]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[21]||(t[21]=e("h1",{class:"title-md md:title-lg"},"Monthly KPI Forms",-1)),w(P,{to:{name:"MonthlyKpiFormCreate"},class:"btn-2"},{default:S(()=>t[20]||(t[20]=[e("span",{class:"hidden md:flex"},"Add New",-1),e("i",{class:"far fa-plus"},null,-1)])),_:1,__:[20]})]),e("div",Y,[e("div",Z,[e("div",tt,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700"},"Type",-1)),f(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>b.value=o),onChange:t[1]||(t[1]=o=>l({page:1})),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200"},t[22]||(t[22]=[e("option",{value:""},"All",-1),e("option",{value:"admin"},"Admin",-1),e("option",{value:"exchange"},"Exchange",-1),e("option",{value:"staff"},"Staff",-1)]),544),[[$,b.value]])]),e("div",et,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700"},"Covers Month",-1)),f(e("input",{type:"month","onUpdate:modelValue":t[2]||(t[2]=o=>c.value=o),onChange:t[3]||(t[3]=o=>l({page:1})),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200"},null,544),[[V,c.value]])]),e("div",ot,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700"},"From (period)",-1)),f(e("input",{type:"month","onUpdate:modelValue":t[4]||(t[4]=o=>_.value=o),onChange:t[5]||(t[5]=o=>l({page:1})),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200"},null,544),[[V,_.value]])]),e("div",st,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700"},"To (period)",-1)),f(e("input",{type:"month","onUpdate:modelValue":t[6]||(t[6]=o=>k.value=o),onChange:t[7]||(t[7]=o=>l({page:1})),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200"},null,544),[[V,k.value]])]),e("div",nt,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700"},"Sort By",-1)),f(e("select",{"onUpdate:modelValue":t[8]||(t[8]=o=>p.value=o),onChange:t[9]||(t[9]=o=>l({page:1})),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200"},t[27]||(t[27]=[G('<option value="created_at">Created</option><option value="updated_at">Updated</option><option value="start_month">Start</option><option value="end_month">End</option><option value="type">Type</option><option value="performance_max_mark">Perf. Max</option><option value="monthly_target_marks">Target</option>',7)]),544),[[$,p.value]])]),e("div",dt,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700"},"Direction",-1)),f(e("select",{"onUpdate:modelValue":t[10]||(t[10]=o=>i.value=o),onChange:t[11]||(t[11]=o=>l({page:1})),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200"},t[29]||(t[29]=[e("option",{value:"desc"},"Desc",-1),e("option",{value:"asc"},"Asc",-1)]),544),[[$,i.value]])]),e("div",at,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700"},"Per Page",-1)),f(e("select",{"onUpdate:modelValue":t[12]||(t[12]=o=>y.value=o),onChange:t[13]||(t[13]=o=>l({page:1})),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200"},t[31]||(t[31]=[e("option",{value:10},"10",-1),e("option",{value:15},"15",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1)]),544),[[$,y.value,void 0,{number:!0}]])])])]),s(T)?(g(),m("div",lt,[w(O)])):s(F)?(g(),m("div",rt,a(s(F)),1)):s(h).length===0?(g(),m("div",it,[t[34]||(t[34]=x(" No forms found. ")),w(P,{to:{name:"MonthlyKpiFormCreate"},class:"ml-2 text-indigo-600 underline"},{default:S(()=>t[33]||(t[33]=[x("Create one")])),_:1,__:[33]})])):(g(),m("div",ut,[e("table",pt,[e("thead",null,[e("tr",mt,[t[35]||(t[35]=e("th",{class:"px-3 py-2 w-12"},"#",-1)),e("th",{class:"px-3 py-2 cursor-pointer",onClick:t[14]||(t[14]=o=>M("type"))},"Type"),e("th",{class:"px-3 py-2 cursor-pointer",onClick:t[15]||(t[15]=o=>M("start_month"))},"Period"),t[36]||(t[36]=e("th",{class:"px-3 py-2"},"Perf.Max",-1)),t[37]||(t[37]=e("th",{class:"px-3 py-2"},"Target",-1)),e("th",{class:"px-3 py-2 cursor-pointer",onClick:t[16]||(t[16]=o=>M("updated_at"))},"Updated"),t[38]||(t[38]=e("th",{class:"px-3 py-2 text-right w-28"},"Actions",-1))])]),e("tbody",null,[(g(!0),m(H,null,J(s(h),(o,A)=>(g(),m("tr",{key:o.id,class:"border-t hover:bg-gray-50"},[e("td",gt,a((s(d).current_page-1)*s(d).per_page+A+1),1),e("td",ft,a(o.type),1),e("td",vt,a(K(o)),1),e("td",yt,a(o.performance_mark),1),e("td",xt,a(o.target_marks),1),e("td",bt,a(new Date(o.updated_at||o.created_at).toLocaleString()),1),e("td",ct,[e("div",_t,[w(P,{to:{name:"MonthlyKpiFormEdit",params:{id:o.id}},class:"btn-icon",title:"Edit"},{default:S(()=>t[39]||(t[39]=[e("i",{class:"far fa-edit"},null,-1)])),_:2,__:[39]},1032,["to"]),e("button",{class:"btn-icon text-red-600 hover:text-red-700",title:"Delete",onClick:async()=>{n.confirm(`Delete form ${o.id}?`)&&(await s(v).deleteForm(o.id),await l())}},t[40]||(t[40]=[e("i",{class:"far fa-trash-alt"},null,-1)]),8,kt)])])]))),128))])]),e("div",Ct,[e("div",wt,[t[41]||(t[41]=x(" Showing ")),e("span",$t,a((s(d).current_page-1)*s(d).per_page+1),1),t[42]||(t[42]=x(" – ")),e("span",Mt,a(Math.min(s(d).current_page*s(d).per_page,s(d).total)),1),t[43]||(t[43]=x(" of ")),e("span",Pt,a(s(d).total),1)]),e("div",St,[e("button",{class:"rounded-md border px-3 py-1 disabled:opacity-50",disabled:!s(q),onClick:t[17]||(t[17]=o=>L(s(d).current_page-1))},"Prev",8,Vt),e("span",Nt,"Page "+a(s(d).current_page)+" / "+a(s(d).last_page),1),e("button",{class:"rounded-md border px-3 py-1 disabled:opacity-50",disabled:!s(U),onClick:t[18]||(t[18]=o=>L(s(d).current_page+1))},"Next",8,ht)])])]))])}}};export{Bt as default};
