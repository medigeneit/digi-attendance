import{r as c,x as g,S as T,a6 as M,h as q,y as V,c as u,o as r,a as e,k as f,s as k,w as z,t as v,l as D,v as E,n as I,b as L,A as U}from"./index-CCY34wMb.js";const $={key:0,class:"font-bold text-lg text-green-600",title:"Approve"},F={key:1,class:"btn-2"},K={key:0,class:"text-base",title:"Reject"},O={key:1,class:"btn-1"},G={class:"modal-card"},H={class:"title-lg"},J=["placeholder","required"],P={class:"flex"},Q={class:"text-red-500 text-center"},W={class:"flex justify-between gap-2 mt-4"},X=["disabled"],Y=["disabled"],Z={class:"capitalize hidden md:inline"},te={__name:"ApproveAndReject",props:{notificationType:{type:String,required:!0},applicationId:{type:[String,Number],required:!0},onSuccess:{type:Function,default:null},onSubmit:{type:Function,default:null},variant:{type:Number,default:1}},emits:["loading"],setup(o,{emit:R}){const i=o,x=R,d=c(255),A=g(()=>d.value-n.value.length),S=T(),p=M(),y=c(null),h=c(null),a=c(null),n=c(""),m=c(!1),w=g(()=>a.value!==null),_=g(()=>a.value==="accept"?"Accept Application":"Reject Application");function j(s){(s==="accept"||s==="reject")&&(a.value=s,n.value="",N())}function b(){a.value=null,n.value=""}async function B(){if(!p.loading){if(a.value==="reject"&&!n.value)return S.error("Rejection Reason is required!");if(typeof i.onSubmit=="function")return i.onSubmit({note:n.value,action:a.value});x("loading",!0),m.value=!0;try{await p.updateNotification(i.notificationType,i.applicationId,a.value,n.value)}finally{x("loading",!1),m.value=!1}typeof i.onSuccess=="function"?i.onSuccess():p.fetchTaskNotification(),b()}}function C(s){var t,l;w.value&&(s.key==="ArrowLeft"?(t=h.value)==null||t.focus():s.key==="ArrowRight"&&((l=y.value)==null||l.focus()))}function N(){U(()=>{var s;(s=y.value)==null||s.focus()})}return q(()=>{window.addEventListener("keydown",C)}),V(()=>{window.removeEventListener("keydown",C)}),(s,t)=>(r(),u("div",null,[e("div",{class:k(["flex justify-center items-center",o.variant===1?"gap-5":"gap-2"])},[e("button",{onClick:t[0]||(t[0]=l=>j("accept"))},[o.variant===1?(r(),u("span",$,"✔")):f("",!0),o.variant===2?(r(),u("span",F,t[4]||(t[4]=[e("span",{class:"text-base scale-110"},"✔",-1),e("span",{class:"hidden md:inline"},"Approve",-1)]))):f("",!0)]),e("button",{onClick:t[1]||(t[1]=l=>j("reject"))},[o.variant===1?(r(),u("span",K,"❌")):f("",!0),o.variant===2?(r(),u("span",O,t[5]||(t[5]=[e("span",{class:"text-base"},"❌",-1),e("span",{class:"hidden md:inline"},"Reject",-1)]))):f("",!0)])],2),w.value?(r(),u("div",{key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50",onClick:z(b,["self"])},[e("div",G,[e("h3",H,v(_.value),1),e("div",null,[D(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>n.value=l),rows:"7",placeholder:a.value==="accept"?"Accept Note...":"Rejection Reason...",class:"w-full border rounded-lg p-2 text-gray-700",required:a.value==="reject",onInput:t[3]||(t[3]=l=>n.value.length>d.value?n.value=n.value.slice(0,d.value):null)},null,40,J),[[E,n.value]]),e("div",P,[e("div",{class:k(["ml-auto inline-block text-sm text-gray-500",n.value.length>=d.value?"text-red-500":""])}," left "+v(A.value)+"/"+v(d.value)+" words ",3)])]),e("div",Q,v(I(p).error),1),e("div",W,[e("button",{ref_key:"cancelBtnRef",ref:h,class:"btn-3 focus:ring-2 ring-offset-2 disabled:opacity-30",onClick:b,disabled:m.value}," Cancel ",8,X),e("button",{ref_key:"confirmBtnRef",ref:y,class:k(["focus:ring-2 ring-offset-2 disabled:opacity-30",a.value==="reject"?"btn-2-red":"btn-2-green"]),onClick:B,disabled:m.value},[t[6]||(t[6]=L(" Confirm ")),e("span",Z,v(a.value),1)],10,Y)])])])):f("",!0)]))}};export{te as _};
