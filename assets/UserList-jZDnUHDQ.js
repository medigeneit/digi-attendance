import{S as ye,r as h,q as R,h as $t,x as w,y as _e,i as qe,o as d,d as U,l as F,c as r,j as S,a as t,T as me,t as a,F as X,e as tt,b as q,k as gt,H as Ue,v as At,Z as Ne,A as zt,_ as De,u as je,f as Ie,g as Le,D as nt,G as fe,p as Ve,m as O,w as it,s as x,C as Me}from"./index-CPfwXEoI.js";import{_ as Pe}from"./EmployeeFilter-XyhMYhZP.js";import{L as We}from"./LoaderView-eTZQVyNl.js";import{d as ue}from"./dayjs.min-BgWzIsSG.js";import{u as xe}from"./shift-CACTBIc6.js";import{S as Te}from"./WeekendAssignModal-C_XsFBKo.js";import{C as Oe}from"./CriteriaAssignModal-CTtwKWtw.js";import{_ as Re}from"./FlexibleDatePicker-A_O8CXeR.js";import{u as Ke}from"./company-B73RytfM.js";import{u as Be}from"./department-COfWXir6.js";import{u as Fe}from"./user-CvkweKRA.js";import{u as He}from"./userClearance-F2gyJE0v.js";import"./EmployeeDropdownInput-4PYAVIsm.js";import"./SelectDropdown-DQIQskYS.js";import"./UserChip-BGFh-gj5.js";import"./monthly-kpi-assignments-4Mes76Dl.js";const Ye={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Qe={class:"relative w-full max-w-xl rounded-2xl bg-white shadow-xl ring-1 ring-black/5 p-5"},Ge={class:"flex items-start justify-between mb-4"},Je={class:"flex items-center gap-3"},Ze={class:"h-10 w-10 rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center font-semibold"},Xe={class:"text-base font-semibold text-gray-900"},ts={class:"text-xs text-gray-500"},es={class:"flex flex-col gap-2"},ss={class:"md:col-span-5"},ns={class:"rounded-lg border bg-white p-2"},is={class:"flex items-center justify-between mb-2"},as={class:"text-xs text-gray-500"},os={key:0,class:"text-sm text-gray-500"},ls={key:1},ds=["checked"],rs={class:"flex-1"},cs={class:"flex items-center gap-2"},ps={class:"text-sm text-gray-900"},ms={key:0,class:"inline-flex items-center text-xs font-medium rounded-full bg-green-100 text-green-700 px-2 py-0.5"},fs={key:1,class:"inline-flex items-center text-xs font-medium rounded-full bg-gray-100 text-gray-700 px-2 py-0.5"},us={class:"mt-0.5 text-xs text-gray-600"},ys={key:0,class:"ml-2 text-gray-400"},_s={class:"rounded-lg border bg-white p-4"},xs={class:"grid gap-4 md:grid-cols-12"},gs={class:"md:col-span-12"},bs=["disabled"],vs=["value"],hs={key:0,class:"mt-1 text-xs text-gray-500"},ws={class:"md:col-span-6"},ks={class:"mt-4 flex justify-end gap-2"},Ss=["disabled"],Cs=["disabled"],$s={key:0},As={key:1},zs={__name:"ShiftAssignmentModal",props:{modelValue:{type:Boolean,default:!1},isOpen:{type:Boolean,default:!1},employee:{type:Object,default:()=>({id:0,name:""})},shifts:{type:[Array,Object],default:()=>[]},hasShift:{type:Object,default:null},current_shift:{type:Object,default:null},shift_history:{type:[Object,Array,null],default:null}},emits:["update:modelValue","saved","close"],setup(at,{emit:ot}){var u;const p=at,H=ot,et=ye(),lt=xe(),v=h(!1);R(()=>p.modelValue,i=>{i!==v.value&&(v.value=i)}),R(()=>p.isOpen,i=>{i!==v.value&&(v.value=i)}),$t(()=>{v.value=!!(p.modelValue||p.isOpen)});function j(){v.value&&(v.value=!1,H("update:modelValue",!1),H("close",!1))}const g=h({shift_id:"",employee_id:((u=p.employee)==null?void 0:u.id)||0,start_date:"",end_date:""});R(()=>p.employee,i=>{g.value.employee_id=(i==null?void 0:i.id)||0},{immediate:!0,deep:!0});const N=w(()=>{var C,m,L,I;const i=((C=p.employee)==null?void 0:C.name)||String(((m=p.employee)==null?void 0:m.id)||""),l=i.trim().split(/\s+/);return((((L=l[0])==null?void 0:L[0])||"")+(((I=l[1])==null?void 0:I[0])||"")||i[0]||"#").toUpperCase().slice(0,2)});function Y(i){return i?typeof i=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(i)?i:ue(i).isValid()?ue(i).format("YYYY-MM-DD"):"":""}const dt=w(()=>{const i=p.shifts;return Array.isArray(i)?i:i&&typeof i=="object"?Object.values(i).flat().filter(Boolean):[]}),bt=w(()=>{const i=p.shift_history;return i&&typeof i=="object"&&Array.isArray(i.history)?i.history:Array.isArray(i)?i:i?[i]:[]}),V=w(()=>bt.value.map(i=>{var l,_;return{id:i.id??null,name:((l=i==null?void 0:i.shift)==null?void 0:l.name)||(i==null?void 0:i.name)||`#${(i==null?void 0:i.shift_id)||(i==null?void 0:i.id)||"—"}`,shift_id:((_=i==null?void 0:i.shift)==null?void 0:_.id)??(i==null?void 0:i.shift_id)??null,start_date:Y(i.start_date),end_date:Y(i.end_date),status:i.status||(i.end_date?"ended":"active"),days:i.days??null,active:!i.end_date||i.status==="active",created_at:i.created_at?new Date(i.created_at).getTime():0}}).sort((i,l)=>i.active!==l.active?i.active?-1:1:(l.start_date||"").localeCompare(i.start_date||""))),vt=w(()=>{const i=p.shift_history;return i&&typeof i=="object"&&typeof i.count=="number"?i.count:V.value.length}),K=w(()=>{var _,C;const i=V.value.find(m=>m.active);if(i)return i;const l=p.current_shift||p.hasShift;return l?{id:l.id??null,name:((_=l==null?void 0:l.shift)==null?void 0:_.name)||(l==null?void 0:l.name)||`#${(l==null?void 0:l.shift_id)||(l==null?void 0:l.id)||"—"}`,shift_id:((C=l==null?void 0:l.shift)==null?void 0:C.id)??(l==null?void 0:l.shift_id)??null,start_date:Y(l.start_date),end_date:Y(l.end_date),active:!l.end_date}:null});async function rt(){const i=K.value;i?(g.value.shift_id=String(i.shift_id||""),g.value.start_date=Y(i.start_date)||"",g.value.end_date=Y(i.end_date)||""):(g.value.shift_id="",g.value.start_date="",g.value.end_date="")}R(v,(i,l)=>{i&&!l&&zt(rt)}),R([K,()=>p.shift_history],()=>{v.value&&zt(rt)});const B=h(!1),D=w(()=>!!g.value.employee_id&&!!g.value.shift_id&&!!g.value.start_date&&!B.value);async function ct(){var i,l;try{if(!D.value){et.error("All required fields must be filled");return}B.value=!0;const _={employee_id:Number(g.value.employee_id),shift_id:Number(g.value.shift_id),start_date:g.value.start_date,end_date:g.value.end_date||null},C=await lt.shiftAssign(_);et.success(K.value?"Shift updated":"Shift assigned"),H("saved",C),j()}catch(_){const C=((l=(i=_==null?void 0:_.response)==null?void 0:i.data)==null?void 0:l.message)||"Failed to assign shift";et.error(C)}finally{B.value=!1}}function Q(i){v.value&&(i.key==="Escape"&&j(),(i.ctrlKey||i.metaKey)&&i.key.toLowerCase()==="enter"&&D.value&&ct())}return $t(()=>window.addEventListener("keydown",Q)),_e(()=>window.removeEventListener("keydown",Q)),(i,l)=>(d(),qe(Ne,{to:"body"},[U(me,{name:"fade"},{default:F(()=>[v.value?(d(),r("div",Ye,[t("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:j}),U(me,{name:"pop"},{default:F(()=>{var _,C;return[t("div",Qe,[t("div",Ge,[t("div",Je,[t("div",Ze,a(N.value),1),t("div",null,[t("h3",Xe,a(K.value?"Update Shift":"Assign Shift"),1),t("p",ts,a(((_=at.employee)==null?void 0:_.name)||"#"+(((C=at.employee)==null?void 0:C.id)||"")),1)])]),t("button",{class:"btn-icon",onClick:j,"aria-label":"Close"},"✕")]),t("div",es,[t("div",ss,[t("div",ns,[t("div",is,[l[2]||(l[2]=t("h4",{class:"text-sm font-semibold text-gray-800"},"Shift history",-1)),t("span",as,a(vt.value)+" item(s)",1)]),V.value.length?(d(),r("ul",ls,[(d(!0),r(X,null,tt(V.value,(m,L)=>(d(),r("li",{key:m.id??L,class:"flex items-start gap-3"},[t("input",{type:"checkbox",class:"mt-1 rounded border-gray-300",checked:m.active,disabled:""},null,8,ds),t("div",rs,[t("div",cs,[t("span",ps,a(m.name),1),m.active?(d(),r("span",ms,"Active")):(d(),r("span",fs,"Closed"))]),t("div",us,[q(" Period: "+a(m.start_date||"—")+" → "+a(m.end_date||"present")+" ",1),m.days?(d(),r("span",ys,"("+a(m.days)+" days)",1)):S("",!0)])])]))),128))])):(d(),r("div",os," No history found "))])]),t("div",_s,[t("div",xs,[t("div",gs,[l[4]||(l[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select Shift",-1)),gt(t("select",{"onUpdate:modelValue":l[0]||(l[0]=m=>g.value.shift_id=m),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200",disabled:!dt.value.length},[l[3]||(l[3]=t("option",{value:""},"Choose a shift…",-1)),(d(!0),r(X,null,tt(dt.value,m=>(d(),r("option",{key:m==null?void 0:m.id,value:m==null?void 0:m.id},a(m==null?void 0:m.name),9,vs))),128))],8,bs),[[Ue,g.value.shift_id]]),dt.value.length?S("",!0):(d(),r("p",hs,"No shifts found"))]),t("div",ws,[l[5]||(l[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),gt(t("input",{"onUpdate:modelValue":l[1]||(l[1]=m=>g.value.start_date=m),type:"date",class:"mt-1 w-full rounded-md border px-3 py-2"},null,512),[[At,g.value.start_date]])])]),t("div",ks,[t("button",{class:"btn-3",onClick:j,disabled:B.value},"Cancel",8,Ss),t("button",{class:"btn-2",onClick:ct,disabled:!D.value},[B.value?(d(),r("span",As,"Processing…")):(d(),r("span",$s,a(K.value?"Update":"Assign"),1))],8,Cs)])])])])]}),_:1})])):S("",!0)]),_:1})]))}},Es={class:"space-y-3 p-5"},qs={class:"flex items-center justify-between gap-2"},Us={class:"flex gap-3"},Ns={key:0,class:"rounded-md border border-indigo-200 bg-indigo-50 p-3 text-sm text-indigo-800"},Ds={class:"sticky top-14 z-40 -mx-5 px-5 py-3 bg-white/90 supports-[backdrop-filter]:bg-white/70 backdrop-blur border-b border-zinc-200"},js={class:"flex flex-col md:flex-row md:items-end gap-2"},Is={class:"flex items-center gap-1"},Ls={class:"flex items-center gap-2 w-full md:w-auto"},Vs={class:"mt-2 flex flex-wrap gap-2 text-[12px]"},Ms={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Ps={class:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700"},Ws={class:"px-2 py-1 rounded-full bg-rose-100 text-rose-700"},Ts={class:"px-2 py-1 rounded-full bg-amber-100 text-amber-800"},Os={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Rs={class:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-800"},Ks={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Bs={key:1,class:"text-center py-6"},Fs={key:2,class:"space-y-4"},Hs={key:0,class:"text-center py-6 text-lg italic text-gray-500"},Ys={class:"grid grid-cols-1 gap-2 md:hidden"},Qs={class:"flex items-start gap-3"},Gs={class:"h-10 w-10 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},Js={class:"min-w-0"},Zs={class:"font-medium leading-5 truncate"},Xs={class:"text-[12px] text-zinc-500"},tn={class:"mt-1 text-[12px] text-zinc-600"},en={class:"text-[12px] text-zinc-600"},sn={class:"mt-1"},nn={class:"mt-1 text-[12px]"},an=["href"],on=["href"],ln={class:"mt-2 flex flex-wrap gap-1"},dn=["disabled","onClick"],rn=["disabled","onClick"],cn=["disabled","onClick"],pn=["onClick","title"],mn={class:"hidden lg:inline"},fn={class:"hidden md:block"},un={class:"group-scroll relative overflow-auto max-h-[70vh] rounded-md border border-zinc-200 bg-white shadow-sm"},yn={class:"group-sticky sticky top-0 z-40 flex items-center justify-between h-11 px-3 bg-white/95 backdrop-blur border-b border-zinc-200"},_n={class:"title-md"},xn={class:"min-w-full table-auto"},gn={class:"border border-gray-100 px-2 py-2"},bn={class:"border border-gray-100 px-3 py-2"},vn={class:"flex items-start gap-2"},hn={key:0,class:"h-8 w-8 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold overflow-hidden"},wn=["src","alt"],kn={key:1,class:"h-8 w-8 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},Sn={class:"min-w-0"},Cn={class:"font-medium truncate max-w-[220px]"},$n={class:"text-[11px] text-zinc-500"},An={class:"text-[11px] text-zinc-500"},zn={class:"text-[11px] text-zinc-500"},En={class:"border border-gray-100 px-2 py-2"},qn={class:"flex items-center gap-2"},Un=["href"],Nn={class:"flex items-center gap-2"},Dn=["href"],jn={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},In={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},Ln={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},Vn={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Mn=["onClick","title","disabled"],Pn={class:"ml-1 hidden lg:inline"},Wn={class:"mt-1 text-[11px] text-gray-500"},Tn={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},On=["onClick","title","disabled"],Rn={class:"ml-1 hidden lg:inline"},Kn={class:"mt-1 text-[11px] text-gray-500"},Bn={class:"border border-gray-100 px-2 py-2"},Fn={key:0,class:"mt-1 text-[11px] text-rose-600"},Hn={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Yn=["onClick","title","disabled"],Qn={class:"ml-1 hidden lg:inline"},Gn={class:"border border-gray-100 px-2 py-2"},Jn={class:"flex gap-2"},Zn=["onClick","title"],Xn={class:"hidden lg:inline"},ti={key:3,class:"fixed inset-0 z-[9999] flex items-center justify-center"},ei={class:"relative w-full max-w-lg rounded-lg bg-white shadow-xl"},si={class:"space-y-4 p-4"},ni={class:"text-sm text-gray-600"},ii={class:"font-semibold text-gray-900"},ai={class:"space-y-1"},oi={class:"space-y-1"},li={key:0,class:"rounded-md border border-red-200 bg-red-50 p-2 text-sm text-red-700"},di={key:1,class:"rounded-md border border-amber-200 bg-amber-50 p-2 text-sm text-amber-800"},ri={class:"flex items-center justify-end gap-2 border-t bg-gray-50 px-4 py-3"},ci=["disabled"],pi={key:0},mi={key:1},fi=["disabled"],ui={key:0},yi={key:1},_i={key:4,class:"fixed inset-0 z-[9998] flex items-center justify-center"},xi={class:"relative w-full max-w-2xl rounded-lg bg-white shadow-xl"},gi={class:"space-y-4 p-4"},bi={class:"space-y-1 text-sm text-gray-600"},vi={class:"font-semibold text-gray-900"},hi={class:"font-medium"},wi={class:"font-medium"},ki={class:"font-medium"},Si={key:0,class:"rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700"},Ci={id:"print-area",class:"print-area"},$i={class:"text-center"},Ai={class:"text-xl font-bold tracking-wide"},zi={class:"mt-4 grid grid-cols-2 gap-3 text-sm"},Ei={class:"font-medium"},qi={class:"font-medium"},Ui={class:"font-medium"},Ni={class:"font-medium"},Di={class:"mt-4 rounded-md border border-gray-200 p-3 text-sm"},ji={class:"font-medium"},Ii={class:"mt-1"},Li={class:"font-medium"},Vi={class:"mt-4"},Mi={key:0,class:"text-sm text-gray-600"},Pi={key:1,class:"text-sm text-rose-600"},Wi={key:2,class:"w-full border border-gray-300 text-sm",style:{"border-collapse":"collapse"}},Ti={class:"border border-gray-300 px-2 py-1"},Oi={class:"border border-gray-300 px-2 py-1"},Ri={class:"border border-gray-300 px-2 py-1"},Ki={key:0},Bi={class:"mt-6 text-xs text-gray-500"},Fi={__name:"UserList",setup(at){const ot=je(),p=Ie(),H=ye(),et=Le(),lt=Ke(),v=Be(),j=Fe(),g=xe(),N=He(),{companies:Y}=nt(lt),{departments:dt}=nt(v),{shifts:bt}=nt(g),{users:V,isLoading:vt}=nt(j),{items:K,loading:rt,error:B}=nt(N),D=n=>{if(!n)return"";if(typeof n=="string")return n.slice(0,10);const e=new Date(n);return Number.isNaN(e.getTime())?"":e.toISOString().slice(0,10)},ct=()=>{const n=new Date;return new Date(n.getTime()-n.getTimezoneOffset()*6e4).toISOString().slice(0,10)},Q=n=>{const e=D(n==null?void 0:n.last_working_date);return!!e&&e<=ct()},u=n=>n!=null&&n.is_inactive||Q(n)?!0:Number((n==null?void 0:n.is_active)??0)===0,i=n=>{var e,c;return!!((c=(e=n==null?void 0:n.current_shift)==null?void 0:e.shift)!=null&&c.name)},l=n=>{var e,c;return((c=(e=n==null?void 0:n.current_shift)==null?void 0:e.shift)==null?void 0:c.name)||"Not Assigned"},_=n=>{var e;return Array.isArray((e=n==null?void 0:n.assign_weekend)==null?void 0:e.weekends)&&n.assign_weekend.weekends.length>0},C=n=>_(n)?n.assign_weekend.weekends.join(", "):"Not Assigned",m=(n,e)=>{var f,z,b;if(!e)return!0;const c=e.toLowerCase();return[n==null?void 0:n.name,n==null?void 0:n.phone,n==null?void 0:n.employee_id,(f=n==null?void 0:n.company)==null?void 0:f.name,(z=n==null?void 0:n.department)==null?void 0:z.name,(b=n==null?void 0:n.designation)==null?void 0:b.title].some($=>String($||"").toLowerCase().includes(c))},L=n=>!!D(n==null?void 0:n.last_working_date),I=n=>{const e=L(n),c=Q(n),f="inline-flex items-center gap-1.5 rounded-md border px-2.5 py-1.5 text-[12px] font-semibold transition focus:outline-none focus:ring-2 focus:ring-offset-1 active:scale-[.99]";return e?c?{label:"Edit Exit",icon:"far fa-circle-xmark",cls:`${f} border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-300`,badgeCls:"bg-white/70 text-rose-800"}:{label:"Edit Exit",icon:"far fa-pen-to-square",cls:`${f} border-amber-200 bg-amber-50 text-amber-800 hover:bg-amber-100 focus:ring-amber-300`,badgeCls:"bg-white/70 text-amber-800"}:{label:"Set Exit",icon:"far fa-door-open",cls:`${f} border-zinc-300 bg-white text-zinc-700 hover:bg-zinc-50 focus:ring-zinc-300`,badgeCls:"bg-zinc-100 text-zinc-700"}},ge=w(()=>p.query.action==="clearance"),Et=w(()=>{var e;const n=String(((e=et.user)==null?void 0:e.role)||"").toLowerCase();return["admin","super_admin","developer"].includes(n)}),o=fe({company:String(p.query.company??"all"),department:String(p.query.department??"all"),line_type:String(p.query.line_type??"all"),status:String(p.query.status??"active"),employee_id:String(p.query.employee_id??""),q:String(p.query.q??"")});let qt=null;const be=w(()=>{const n={};return o.company&&o.company!=="all"&&(n.company=o.company),o.department&&o.department!=="all"&&(n.department=o.department),o.line_type&&o.line_type!=="all"&&(n.line_type=o.line_type),o.status&&o.status!=="all"&&(n.status=o.status),o.employee_id&&(n.employee_id=o.employee_id),o.q&&(n.q=o.q),p.query.action&&(n.action=p.query.action),n});function ve(){clearTimeout(qt),qt=setTimeout(()=>{ot.replace({query:{...be.value}})},250)}R(o,ve,{deep:!0}),$t(async()=>{await lt.fetchCompanies(),o.company&&o.company!=="all"&&await v.fetchDepartments(o.company),Ut()}),R(()=>p.query,()=>Ut(),{deep:!0});async function Ut(){await j.fetchUsers({company_id:p.query.company,department_id:p.query.department,line_type:p.query.line_type,status:p.query.status,user_id:p.query.employee_id,q:p.query.q})}R(()=>o.company,async(n,e)=>{var c;n!==e&&(n&&n!=="all"?await v.fetchDepartments(n):(c=v.$reset)==null||c.call(v))});const he=()=>ot.go(-1),we=n=>{if(o.status==="all")return!0;const e=u(n);return o.status==="active"?!e:e},Nt=w(()=>(Array.isArray(V.value)?V.value:[]).filter(e=>{var c;return!(o.company!=="all"&&String((c=e==null?void 0:e.company)==null?void 0:c.id)!==String(o.company)||o.line_type!=="all"&&String(e==null?void 0:e.type)!==String(o.line_type)||o.employee_id&&String(e==null?void 0:e.id)!==String(o.employee_id)||!we(e)||!m(e,o.q))})),G=w(()=>{const n=Nt.value,e=n.length,c=n.filter(b=>Number((b==null?void 0:b.is_active)??0)===1).length,f=n.filter(b=>i(b)).length,z=n.filter(b=>_(b)).length;return{total:e,active:c,inactive:e-c,withShift:f,withoutShift:e-f,withWeekend:z,withoutWeekend:e-z}}),Dt=w(()=>{var e;const n={};for(const c of Nt.value){const f=((e=c==null?void 0:c.company)==null?void 0:e.name)||"Unknown Company";(n[f]??(n[f]=[])).push(c)}return n});h(null);const E=h(null),ht=h(null),jt=h(null),pt=h(!1),wt=h(!1),mt=h(!1),st=h(!1),k=h(null),A=fe({last_working_date:"",exit_reason:""}),It=w({get(){if(!A.last_working_date)return{year:null,month:null,day:null};const[n,e,c]=A.last_working_date.split("-");return{year:Number(n)||null,month:Number(e)||null,day:Number(c)||1}},set(n){if(!n){A.last_working_date="";return}const e=Number(n.year)||null,c=Number(n.month)||null,f=Number(n.day)||1;if(!e||!c){A.last_working_date="";return}const z=String(c).padStart(2,"0"),b=String(Math.min(f,31)).padStart(2,"0");A.last_working_date=`${e}-${z}-${b}`}}),ft=h(!1),M=h(""),ut=h(!1),P=h(""),J=w(()=>k.value),ke=w(()=>{var n,e;return((e=(n=J.value)==null?void 0:n.company)==null?void 0:e.name)||"Digi Attendance"}),Lt=w(()=>(Array.isArray(K.value)?K.value:[]).map(e=>{const c=e.latest||{};return{label:e.label||e.template_item_name||e.item_key||`#${e.template_item_id??e.id??""}`,status:c.status||e.status||(e.is_cleared?"COMPLETED":"PENDING"),remarks:c.remarks||e.remarks||""}}));async function Vt(n){if(E.value=n,n!=null&&n.company_id){const e=await j.fetchUserShifts(n.id);jt.value=e,await g.fetchShifts(n.company_id)}pt.value=!0}async function Mt(n){E.value=n,wt.value=!0;try{const e=await j.fetchUserWeekends(n.id);ht.value=e}catch{ht.value={history:[],current:null}}}function Pt(n){E.value=n,mt.value=!0}function Wt(n){n!=null&&n.id&&(k.value=n,A.last_working_date=D(n==null?void 0:n.last_working_date),A.exit_reason=(n==null?void 0:n.exit_reason)||"",M.value="",P.value="",st.value=!0)}function yt(){st.value=!1,M.value="",P.value=""}function kt(n){n.key==="Escape"&&yt()}const _t=h(!1);async function Se(){var n,e,c,f,z,b,$;if(!(!((n=k.value)!=null&&n.id)||!((e=k.value)!=null&&e.last_working_date))){ut.value=!0,P.value="";try{(c=N.resetFilters)==null||c.call(N),(f=N.setUser)==null||f.call(N,k.value.id),await((z=N.fetch)==null?void 0:z.call(N)),_t.value=!0}catch(W){P.value=(($=(b=W==null?void 0:W.response)==null?void 0:b.data)==null?void 0:$.message)||"Failed to load clearance for print.",H.error(P.value)}finally{ut.value=!1}}}async function Ce(){document.body.classList.add("printing-exit");try{await zt(),window.print()}finally{_t.value=!1,setTimeout(()=>document.body.classList.remove("printing-exit"),0)}}function St(){_t.value=!1}async function $e(){var n,e,c;if(!((n=k.value)!=null&&n.id)){M.value="Select a user first.";return}if(!A.last_working_date){M.value="Last working date is required.";return}ft.value=!0,M.value="";try{await Me.put(`/users/${k.value.id}/exit`,{last_working_date:A.last_working_date,exit_reason:A.exit_reason||null});const f=$=>{$&&($.last_working_date=A.last_working_date,$.exit_reason=A.exit_reason||"",$.is_inactive=Q($))};f(k.value);const b=(Array.isArray(V.value)?V.value:[]).find($=>{var W;return $.id===((W=k.value)==null?void 0:W.id)});f(b),st.value=!1,H.success("Exit information updated.")}catch(f){M.value=((c=(e=f==null?void 0:f.response)==null?void 0:e.data)==null?void 0:c.message)||"Failed to update exit info.",H.error(M.value)}finally{ft.value=!1}}async function Ae(){await j.fetchUsersExcelExport({data:{company_id:o.company!=="all"?o.company:void 0,department_id:o.department!=="all"?o.department:void 0,line_type:o.line_type!=="all"?o.line_type:void 0,status:o.status!=="all"?o.status:void 0,employee_id:o.employee_id||void 0,q:o.q||void 0}})}function ze(){mt.value=!1}function Ee(){o.company="all",o.department="all",o.line_type="all",o.status="active",o.employee_id="",o.q=""}return R(st,n=>{n?window.addEventListener("keydown",kt):(window.removeEventListener("keydown",kt),k.value=null)}),_e(()=>{window.removeEventListener("keydown",kt)}),(n,e)=>{var f,z,b,$,W,Tt,Ot,Rt,Kt,Bt,Ft,Ht,Yt,Qt,Gt;const c=Ve("RouterLink");return d(),r("div",Es,[t("div",qs,[t("button",{class:"btn-3",onClick:he},e[17]||(e[17]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[20]||(e[20]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Employee List",-1)),t("div",Us,[U(c,{to:{name:"UserAdd",query:{company:O(p).query.company}},class:"btn-2"},{default:F(()=>e[18]||(e[18]=[t("span",{class:"hidden md:flex"},"Add New",-1),t("i",{class:"far fa-plus"},null,-1)])),_:1,__:[18]},8,["to"]),t("button",{type:"button",onClick:Ae,class:"btn-3"},e[19]||(e[19]=[t("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1),q("Excel ")]))])]),ge.value?(d(),r("div",Ns," Select a user to view clearance & print. ")):S("",!0),t("div",Ds,[t("div",js,[U(Pe,{company_id:o.company,"onUpdate:company_id":e[3]||(e[3]=y=>o.company=y),department_id:o.department,"onUpdate:department_id":e[4]||(e[4]=y=>o.department=y),employee_id:o.employee_id,"onUpdate:employee_id":e[5]||(e[5]=y=>o.employee_id=y),line_type:o.line_type,"onUpdate:line_type":e[6]||(e[6]=y=>o.line_type=y),"with-type":!0,"initial-value":n.$route.query,class:"w-full"},{default:F(()=>[t("div",Is,[t("button",{class:x(["h-8 px-3 text-xs rounded-l-md border transition",o.status==="all"?"bg-zinc-800 text-white border-zinc-800":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:e[0]||(e[0]=it(y=>o.status="all",["prevent"]))},"All",2),t("button",{class:x(["h-8 px-3 text-xs border-y transition",o.status==="active"?"bg-emerald-600 text-white border-emerald-600":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:e[1]||(e[1]=it(y=>o.status="active",["prevent"]))},"Active",2),t("button",{class:x(["h-8 px-3 text-xs rounded-r-md border transition",o.status==="in_active"?"bg-rose-600 text-white border-rose-600":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:e[2]||(e[2]=it(y=>o.status="in_active",["prevent"]))},"Inactive",2)])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"]),t("div",Ls,[gt(t("input",{"onUpdate:modelValue":e[7]||(e[7]=y=>o.q=y),type:"text",placeholder:"Search name / phone / ID",class:"input-1 h-8 text-sm w-full md:w-64"},null,512),[[At,o.q,void 0,{trim:!0}]]),t("button",{type:"button",onClick:Ee,class:"inline-flex h-8 items-center rounded-md border border-zinc-300 bg-zinc-50 px-3 text-[12px] font-medium text-zinc-700 hover:bg-white active:scale-[.99]",title:"Reset filters"},e[21]||(e[21]=[t("i",{class:"far fa-undo mr-1"},null,-1),q(" Reset ")]))])]),t("div",Vs,[t("span",Ms,"Total: "+a(G.value.total),1),t("span",Ps,"Active: "+a(G.value.active),1),t("span",Ws,"Inactive: "+a(G.value.inactive),1),t("span",Ts,"With Shift: "+a(G.value.withShift),1),t("span",Os,"No Shift: "+a(G.value.withoutShift),1),t("span",Rs,"With Weekend: "+a(G.value.withWeekend),1),t("span",Ks,"No Weekend: "+a(G.value.withoutWeekend),1)])]),O(vt)?(d(),r("div",Bs,[U(We)])):(d(),r("div",Fs,[Object.keys(Dt.value).length===0?(d(),r("div",Hs," No users found ")):S("",!0),(d(!0),r(X,null,tt(Dt.value,(y,xt)=>{var Jt,Zt,Xt,te,ee,se,ne,ie;return d(),r("div",{key:xt,class:"space-y-2"},[t("div",Ys,[(d(!0),r(X,null,tt(y,s=>{var T;return d(),r("div",{key:s.id,class:"rounded-lg border border-zinc-200 bg-white p-3 shadow-sm"},[t("div",Qs,[t("div",Gs,a(((s==null?void 0:s.name)||"?").charAt(0).toUpperCase()),1),t("div",Js,[t("div",Zs,a(s==null?void 0:s.name),1),t("div",Xs,"ID: "+a(s==null?void 0:s.employee_id)+" • "+a(((T=s==null?void 0:s.designation)==null?void 0:T.title)||"—"),1),t("div",tn,"Shift: "+a(l(s)),1),t("div",en,"Weekend: "+a(C(s)),1),t("div",sn,[t("span",{class:x(["inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium",u(s)?"bg-rose-50 text-rose-700":"bg-emerald-50 text-emerald-700"])},a(u(s)?"Inactive":"Active"),3)]),t("div",nn,[t("a",{class:"underline",href:"tel:"+(s==null?void 0:s.phone),onClick:e[8]||(e[8]=it(()=>{},["stop"]))},a((s==null?void 0:s.phone)||"—"),9,an),e[22]||(e[22]=t("span",{class:"mx-1"},"•",-1)),t("a",{class:"underline",href:"mailto:"+((s==null?void 0:s.email)||""),onClick:e[9]||(e[9]=it(()=>{},["stop"]))},a((s==null?void 0:s.email)||"নেই"),9,on)]),t("div",ln,[t("button",{class:x(["btn-3 !px-2 !py-1",u(s)?"opacity-50 cursor-not-allowed pointer-events-none":""]),disabled:u(s),onClick:Z=>Vt(s)},"Shift",10,dn),t("button",{class:x(["btn-3 !px-2 !py-1",u(s)?"opacity-50 cursor-not-allowed pointer-events-none":""]),disabled:u(s),onClick:Z=>Mt(s)},"Weekend",10,rn),t("button",{class:x(["btn-3 !px-2 !py-1",u(s)?"opacity-50 cursor-not-allowed pointer-events-none":""]),disabled:u(s),onClick:Z=>Pt(s)},"KPI",10,cn),Et.value?(d(),r("button",{key:0,type:"button",class:x(I(s).cls),onClick:Z=>Wt(s),title:L(s)?"Update exit info":"Set exit info"},[t("i",{class:x(I(s).icon)},null,2),t("span",mn,a(I(s).label),1),e[23]||(e[23]=t("span",{class:"lg:hidden"},"Exit",-1)),L(s)?(d(),r("span",{key:0,class:x(["ml-1 rounded px-1.5 py-0.5 text-[10px] font-bold tabular-nums",I(s).badgeCls])},a(D(s==null?void 0:s.last_working_date)),3)):S("",!0)],10,pn)):S("",!0),U(c,{to:{name:"UserShow",params:{id:s.id},query:{company:O(p).query.company}},class:"btn-3 !px-2 !py-1"},{default:F(()=>e[24]||(e[24]=[q("View")])),_:2,__:[24]},1032,["to"])])])])])}),128))]),t("div",fn,[t("div",un,[t("div",yn,[t("h2",_n,a(xt)+" ("+a(y.length)+")",1)]),t("table",xn,[e[29]||(e[29]=t("thead",{class:"user-group-table-head"},[t("tr",null,[t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"#"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Name"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Phone & Email"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Finger ID"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Joining"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Role"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Shift"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Weekend"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Status"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"KPI Criteria"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Action")])],-1)),t("tbody",null,[(d(!0),r(X,null,tt(y,(s,T)=>{var Z,ae,oe,le,de,re,ce,pe;return d(),r("tr",{key:s.id,class:x(["border-b text-sm border-gray-100 hover:bg-indigo-50/50",u(s)?"opacity-70":""])},[t("td",gn,a(T+1),1),t("td",bn,[t("div",vn,[s.photo?(d(),r("div",hn,[t("img",{src:s.photo,alt:s==null?void 0:s.name,class:"h-8 w-8 rounded-full object-cover"},null,8,wn)])):(d(),r("div",kn,a(((s==null?void 0:s.name)||"?").charAt(0).toUpperCase()),1)),t("div",Sn,[t("div",Cn,a(s==null?void 0:s.name),1),t("div",$n,a(s==null?void 0:s.bn_name),1),t("div",An,a(((Z=s==null?void 0:s.designation)==null?void 0:Z.title)||"—"),1),t("div",zn,"ID: "+a(s==null?void 0:s.employee_id),1)])])]),t("td",En,[t("div",qn,[t("a",{class:"underline",href:"tel:"+(s==null?void 0:s.phone)},a((s==null?void 0:s.phone)||"—"),9,Un)]),t("div",Nn,[t("a",{class:"underline",href:"mailto:"+((s==null?void 0:s.email)||"")},a((s==null?void 0:s.email)||"নেই"),9,Dn)])]),t("td",jn,a(s==null?void 0:s.device_user_id),1),t("td",In,a(s==null?void 0:s.joining_date),1),t("td",Ln,a(s==null?void 0:s.role),1),t("td",Vn,[t("button",{onClick:Ct=>Vt(s),title:i(s)?"Manage Shift":"Assign Shift",class:x(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",u(s)?"opacity-50 cursor-not-allowed pointer-events-none":"",i(s)?"border-amber-200 bg-amber-50 text-amber-700 hover:bg-amber-100 focus:ring-amber-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"]),disabled:u(s)},[t("span",Pn,a(i(s)?"Manage":"Assign"),1),t("span",{class:x(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",i(s)?"bg-amber-600 text-white":"bg-slate-200 text-slate-700"])},a((s==null?void 0:s.shifts_count)||(i(s)?1:0)),3)],10,Mn),t("div",Wn,a(l(s)),1)]),t("td",Tn,[t("button",{onClick:Ct=>Mt(s),title:_(s)?"Manage Weekend":"Assign Weekend",class:x(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",u(s)?"opacity-50 cursor-not-allowed pointer-events-none":"",_(s)?"border-emerald-200 bg-emerald-50 text-emerald-700 hover:bg-emerald-100 focus:ring-emerald-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"]),disabled:u(s)},[t("span",Rn,a(_(s)?"Manage":"Assign"),1),t("span",{class:x(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",_(s)?"bg-emerald-600 text-white":"bg-slate-200 text-slate-700"])},a((s==null?void 0:s.assign_weekends_count)||_(s)&&((oe=(ae=s==null?void 0:s.assign_weekend)==null?void 0:ae.weekends)==null?void 0:oe.length)||0),3)],10,On),t("div",Kn,a(C(s)),1)]),t("td",Bn,[t("span",{class:x(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium",u(s)?"bg-rose-50 text-rose-700":"bg-emerald-50 text-emerald-700"])},a(u(s)?"Inactive":"Active"),3),Q(s)?(d(),r("div",Fn," Exit: "+a(D(s==null?void 0:s.last_working_date)),1)):S("",!0)]),t("td",Hn,[t("button",{onClick:Ct=>Pt(s),title:(((le=s==null?void 0:s.criteria_assignments)==null?void 0:le.length)||0)>0?"Manage KPI criteria":"Assign KPI criteria",class:x(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",u(s)?"opacity-50 cursor-not-allowed pointer-events-none":"",(((de=s==null?void 0:s.criteria_assignments)==null?void 0:de.length)||0)>0?"border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 focus:ring-indigo-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"]),disabled:u(s)},[t("span",Qn,a((((re=s==null?void 0:s.criteria_assignments)==null?void 0:re.length)||0)>0?"Manage":"Assign"),1),t("span",{class:x(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",(((ce=s==null?void 0:s.criteria_assignments)==null?void 0:ce.length)||0)>0?"bg-indigo-600 text-white":"bg-slate-200 text-slate-700"])},a(((pe=s==null?void 0:s.criteria_assignments)==null?void 0:pe.length)||0),3)],10,Yn)]),t("td",Gn,[t("div",Jn,[U(c,{to:{name:"UserShow",params:{id:s.id},query:{company:O(p).query.company}},class:"btn-icon",title:"View"},{default:F(()=>e[25]||(e[25]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[25]},1032,["to"]),U(c,{to:{name:"UserEdit",params:{id:s.id},query:{company:O(p).query.company}},class:x(["btn-icon",u(s)?"pointer-events-none opacity-50":""]),tabindex:u(s)?-1:0,title:"Edit"},{default:F(()=>e[26]||(e[26]=[t("i",{class:"far fa-edit"},null,-1)])),_:2,__:[26]},1032,["to","class","tabindex"]),U(c,{to:{name:"KpiReview",params:{employeeId:s.id}},class:x(["btn-icon",u(s)?"pointer-events-none opacity-50":""]),tabindex:u(s)?-1:0,title:"KPI"},{default:F(()=>e[27]||(e[27]=[q(" KPI ")])),_:2,__:[27]},1032,["to","class","tabindex"]),Et.value?(d(),r("button",{key:0,type:"button",class:x(I(s).cls),onClick:Ct=>Wt(s),title:L(s)?"Update exit info":"Set exit info"},[t("i",{class:x(I(s).icon)},null,2),t("span",Xn,a(I(s).label),1),e[28]||(e[28]=t("span",{class:"lg:hidden"},"Exit",-1)),L(s)?(d(),r("span",{key:0,class:x(["ml-1 rounded px-1.5 py-0.5 text-[10px] font-bold tabular-nums",I(s).badgeCls])},a(D(s==null?void 0:s.last_working_date)),3)):S("",!0)],10,Zn)):S("",!0)])])],2)}),128))])])])]),U(Oe,{modelValue:mt.value,"onUpdate:modelValue":e[10]||(e[10]=s=>mt.value=s),"user-id":(Jt=E.value)==null?void 0:Jt.id,"user-label":(Zt=E.value)==null?void 0:Zt.name,criteria_assignments:(Xt=E.value)==null?void 0:Xt.criteria_assignments,onAssigned:ze},null,8,["modelValue","user-id","user-label","criteria_assignments"]),U(Te,{modelValue:wt.value,"onUpdate:modelValue":e[11]||(e[11]=s=>wt.value=s),"user-id":(te=E.value)==null?void 0:te.id,"user-label":(ee=E.value)==null?void 0:ee.name,assign_weekends:ht.value,onSaved:e[12]||(e[12]=s=>{const T=s==null?void 0:s.current;T&&E.value&&(E.value.assign_weekend={weekends:T.weekends||[],start_month:T.start_month,end_month:T.end_month})})},null,8,["modelValue","user-id","user-label","assign_weekends"]),U(zs,{modelValue:pt.value,"onUpdate:modelValue":e[13]||(e[13]=s=>pt.value=s),shifts:O(bt),employee:{id:(se=E.value)==null?void 0:se.id,name:(ne=E.value)==null?void 0:ne.name},"has-shift":(ie=E.value)==null?void 0:ie.current_shift,shift_history:jt.value,onClose:e[14]||(e[14]=s=>pt.value=!1)},null,8,["modelValue","shifts","employee","has-shift","shift_history"])])}),128))])),st.value?(d(),r("div",ti,[t("div",{class:"absolute inset-0 bg-black/40",onClick:yt}),t("div",ei,[t("div",{class:"flex items-center justify-between border-b px-4 py-3"},[e[31]||(e[31]=t("h3",{class:"text-lg font-semibold text-gray-900"},"User Exit Information",-1)),t("button",{type:"button",class:"text-gray-500 hover:text-gray-700","aria-label":"Close",onClick:yt},e[30]||(e[30]=[t("i",{class:"far fa-times"},null,-1)]))]),t("div",si,[t("div",ni,[e[32]||(e[32]=q(" User: ")),t("span",ii,a(((f=k.value)==null?void 0:f.name)||"N/A"),1)]),t("div",ai,[e[33]||(e[33]=t("label",{class:"text-sm font-medium text-gray-700"},[q(" Last Working Date "),t("span",{class:"text-red-500"},"*")],-1)),U(Re,{modelValue:It.value,"onUpdate:modelValue":e[15]||(e[15]=y=>It.value=y),"show-year":!1,"show-month":!1,"show-date":!0,label:"Date",class:"w-full",required:""},null,8,["modelValue"])]),t("div",oi,[e[34]||(e[34]=t("label",{class:"text-sm font-medium text-gray-700"},"Exit Reason",-1)),gt(t("textarea",{"onUpdate:modelValue":e[16]||(e[16]=y=>A.exit_reason=y),class:"input-1 w-full min-h-[90px]",placeholder:"Optional"},null,512),[[At,A.exit_reason,void 0,{trim:!0}]])]),M.value?(d(),r("div",li,a(M.value),1)):S("",!0),P.value?(d(),r("div",di,a(P.value),1)):S("",!0)]),t("div",ri,[t("button",{type:"button",class:"btn-3",onClick:yt},"Cancel"),t("button",{type:"button",class:"btn-2",disabled:ut.value||!((z=k.value)!=null&&z.last_working_date),onClick:Se,title:"Print Exit + Clearance"},[ut.value?(d(),r("span",pi,"Preparing...")):(d(),r("span",mi,"Print Exit Sheet"))],8,ci),t("button",{type:"button",class:"btn-1",disabled:ft.value,onClick:$e},[ft.value?(d(),r("span",ui,"Saving...")):(d(),r("span",yi,"Save Exit Info"))],8,fi)])])])):S("",!0),_t.value?(d(),r("div",_i,[t("div",{class:"absolute inset-0 bg-black/40",onClick:St}),t("div",xi,[t("div",{class:"flex items-center justify-between border-b px-4 py-3"},[e[36]||(e[36]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Exit & Clearance Preview",-1)),t("button",{type:"button",class:"text-gray-500 hover:text-gray-700","aria-label":"Close",onClick:St},e[35]||(e[35]=[t("i",{class:"far fa-times"},null,-1)]))]),t("div",gi,[t("div",bi,[t("div",null,[e[37]||(e[37]=t("span",{class:"text-gray-500"},"User:",-1)),t("span",vi,a(((b=k.value)==null?void 0:b.name)||"N/A"),1)]),t("div",null,[e[38]||(e[38]=t("span",{class:"text-gray-500"},"Employee ID:",-1)),t("span",hi,a((($=k.value)==null?void 0:$.employee_id)||"N/A"),1)]),t("div",null,[e[39]||(e[39]=t("span",{class:"text-gray-500"},"Department:",-1)),t("span",wi,a(((Tt=(W=k.value)==null?void 0:W.department)==null?void 0:Tt.name)||"N/A"),1)]),t("div",null,[e[40]||(e[40]=t("span",{class:"text-gray-500"},"Last Working Date:",-1)),t("span",ki,a(D((Ot=k.value)==null?void 0:Ot.last_working_date)||"N/A"),1)])]),e[41]||(e[41]=t("div",null,[t("p",{class:"text-sm text-gray-600"},"The clearance summary will be printed based on the latest data below.")],-1)),P.value?(d(),r("div",Si,a(P.value),1)):S("",!0)]),t("div",{class:"flex items-center justify-end gap-2 border-t px-4 py-3 bg-gray-50"},[t("button",{type:"button",class:"btn-3",onClick:St},"Close"),t("button",{type:"button",class:"btn-1",onClick:Ce}," Print Exit Sheet ")])])])):S("",!0),t("div",Ci,[t("div",$i,[t("h1",Ai,a(ke.value),1),e[42]||(e[42]=t("p",{class:"text-xs text-gray-500"},"User Exit & Clearance Summary",-1))]),t("div",zi,[t("div",null,[e[43]||(e[43]=t("span",{class:"text-gray-500"},"Name:",-1)),e[44]||(e[44]=q()),t("span",Ei,a(((Rt=J.value)==null?void 0:Rt.name)||"N/A"),1)]),t("div",null,[e[45]||(e[45]=t("span",{class:"text-gray-500"},"Employee ID:",-1)),e[46]||(e[46]=q()),t("span",qi,a(((Kt=J.value)==null?void 0:Kt.employee_id)||"N/A"),1)]),t("div",null,[e[47]||(e[47]=t("span",{class:"text-gray-500"},"Department:",-1)),e[48]||(e[48]=q()),t("span",Ui,a(((Ft=(Bt=J.value)==null?void 0:Bt.department)==null?void 0:Ft.name)||"N/A"),1)]),t("div",null,[e[49]||(e[49]=t("span",{class:"text-gray-500"},"Designation:",-1)),e[50]||(e[50]=q()),t("span",Ni,a(((Yt=(Ht=J.value)==null?void 0:Ht.designation)==null?void 0:Yt.title)||"N/A"),1)])]),t("div",Di,[t("div",null,[e[51]||(e[51]=t("span",{class:"text-gray-500"},"Last Working Date:",-1)),e[52]||(e[52]=q()),t("span",ji,a(D((Qt=J.value)==null?void 0:Qt.last_working_date)||"N/A"),1)]),t("div",Ii,[e[53]||(e[53]=t("span",{class:"text-gray-500"},"Exit Reason:",-1)),e[54]||(e[54]=q()),t("span",Li,a(((Gt=J.value)==null?void 0:Gt.exit_reason)||"N/A"),1)])]),t("div",Vi,[e[57]||(e[57]=t("div",{class:"mb-2 text-sm font-semibold text-gray-700"},"Clearance Items Summary",-1)),O(rt)?(d(),r("div",Mi,"Loading clearance...")):O(B)?(d(),r("div",Pi,a(O(B)),1)):(d(),r("table",Wi,[e[56]||(e[56]=t("thead",null,[t("tr",{class:"bg-gray-100 text-gray-700"},[t("th",{class:"border border-gray-300 px-2 py-1 text-left"},"Item"),t("th",{class:"border border-gray-300 px-2 py-1 text-left w-[120px]"},"Status"),t("th",{class:"border border-gray-300 px-2 py-1 text-left"},"Remarks")])],-1)),t("tbody",null,[(d(!0),r(X,null,tt(Lt.value,(y,xt)=>(d(),r("tr",{key:xt},[t("td",Ti,a(y.label||"N/A"),1),t("td",Oi,a(y.status||"N/A"),1),t("td",Ri,a(y.remarks||"—"),1)]))),128)),Lt.value.length?S("",!0):(d(),r("tr",Ki,e[55]||(e[55]=[t("td",{colspan:"3",class:"border border-gray-300 px-2 py-4 text-center text-gray-500"}," No clearance items found. ",-1)])))])]))]),t("div",Bi,"Printed: "+a(new Date().toLocaleString()),1)])])}}},ra=De(Fi,[["__scopeId","data-v-fb273318"]]);export{ra as default};
