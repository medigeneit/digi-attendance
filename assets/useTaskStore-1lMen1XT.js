import{C as E,r as v,x as c,D as i}from"./index-CV9fc69a.js";const x=E("task",()=>{const o=v([]),f=v(null),r=v(!1),l=v(null),h=async(e,t)=>{var s,a;r.value=!0,l.value=null;try{await i.post(`/tasks/${e}/assign-users`,{user_ids:t}),await g(e)}catch(n){throw l.value=((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.message)||"Assign users failed",n}finally{r.value=!1}},p=async e=>{var t,s;r.value=!0,l.value=null;try{const a=await i.get("/tasks",{params:e});o.value=a.data}catch(a){l.value=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||"টাস্ক লোড করতে ব্যর্থ হয়েছে।",console.error("Error fetching tasks:",a)}finally{r.value=!1}};function d(e,t=0){return Array.isArray(e)===!1||e.length===0?[]:e.filter(s=>s.parent_id===t).map(s=>({...s,children_tasks:d(e,s.id)}))}function k(){return d(o.value,0)}function y(){const e=[],t=(s,a=0,n="")=>{s.forEach(u=>{e.push({id:u.id,title:u.title,depth:a,idPath:n+u.id}),u.children_tasks&&u.children_tasks.length&&t(u.children_tasks,a+1,n+u.id+"-")})};return t(k()),e}const g=async e=>{var t,s;r.value=!0,l.value=null;try{const a=await i.get(`/tasks/${e}`);f.value=a.data}catch(a){l.value=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||`টাস্ক (ID: ${e}) লোড করতে ব্যর্থ হয়েছে।`,console.error(`Error fetching task with id ${e}:`,a)}finally{r.value=!1}},T=async e=>{var t,s;r.value=!0,l.value=null;try{const a=await i.post("/tasks",e);return o.value.push(a.data.data),a.data.data}catch(a){l.value=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||"টাস্ক তৈরি করতে ব্যর্থ হয়েছে।",console.error("Error creating task:",a)}finally{r.value=!1}},w=async(e,t)=>{var s,a;r.value=!0,l.value=null;try{const n=await i.put(`/tasks/${e}`,t),u=o.value.findIndex(m=>m.id===e);return u!==-1&&(o.value[u]=n.data.data),n.data.data}catch(n){l.value=((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.message)||`টাস্ক (ID: ${e}) আপডেট করতে ব্যর্থ হয়েছে।`,console.error(`Error updating task with id ${e}:`,n)}finally{r.value=!1}},$=async e=>{var t,s;r.value=!0,l.value=null;try{await i.delete(`/tasks/${e}`),o.value=o.value.filter(a=>a.id!==e)}catch(a){l.value=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||`টাস্ক (ID: ${e}) মুছতে ব্যর্থ হয়েছে।`,console.error(`Error deleting task with id ${e}:`,a)}finally{r.value=!1}};return{tasks:c(()=>o.value),task:c(()=>f.value),loading:c(()=>r.value),error:c(()=>l.value),taskListTree:c(k),flattenedTasks:c(y),fetchTasks:p,fetchTask:g,createTask:T,updateTask:w,deleteTask:$,assignUsers:h}});export{x as u};
