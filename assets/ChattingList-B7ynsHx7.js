import{D as X,r as b,p as k,E as H,d as F,c as l,g as M,k as C,o as r,a as t,F as I,x as T,n as j,j as N,t as S,q as B,e as O,y as $,h as P,v as q,_ as G,u as Z,w as ee,f as D,s as te,G as z,C as se,i as K,b as ne}from"./index-CfsOA4f7.js";import{u as ae}from"./company-BWKOmGQl.js";import{u as oe}from"./department-DfSWb99C.js";import{u as re}from"./user-CP9v3KAR.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A=X("chat",()=>{const n=b(!1),e=b(null),a=b(!1),s=b([]),o=b({}),u=b(null),p=b([]),i=b(""),c=k(()=>{var y,w;return((y=s.value)==null?void 0:y.length)===0?{}:(w=s.value)==null?void 0:w.find(_=>parseInt(_.id)===parseInt(u.value))}),d=k(()=>{var y,w;return((y=s.value)==null?void 0:y.length)===0?[]:i.value?(w=s.value)==null?void 0:w.filter(_=>{var h;return(h=_==null?void 0:_.title)==null?void 0:h.toLowerCase().includes(i.value)}):s.value}),x=async(y={})=>{var w,_;n.value=!0,e.value=null;try{const h=await H.get("/chat/conversations",{params:y});s.value=h.data}catch(h){e.value=((_=(w=h.response)==null?void 0:w.data)==null?void 0:_.message)||"ডাটা লোড করতে ব্যর্থ হয়েছে।",console.error("Error fetching conversations:",h)}finally{n.value=!1}};return{loading:n,error:e,openAddModal:a,searchText:i,conversations:s,filteredConversations:d,conversation:o,activeConversationId:u,activeConversation:c,messages:p,fetchUserConversations:x,createConversation:async(y={})=>{var w,_;n.value=!0,e.value=null;try{const h=await H.post("/chat/conversations",y);return u.value=h.data.id,h.data.id}catch(h){e.value=((_=(w=h.response)==null?void 0:w.data)==null?void 0:_.message)||"ডাটা Create করতে ব্যর্থ হয়েছে।",console.error("Error creating conversation:",h)}finally{n.value=!1}},fetchConversationById:async y=>{var w,_;n.value=!0,e.value=null,o.value={};try{const h=await H.get(`/chat/conversations/${y}`);o.value=h.data}catch(h){e.value=((_=(w=h.response)==null?void 0:w.data)==null?void 0:_.message)||"ডাটা লোড করতে ব্যর্থ হয়েছে।",console.error("Error fetching conversation:",h)}finally{n.value=!1}},fetchConversationMessages:async(y,w={})=>{var _,h;n.value=!0,e.value=null,p.value=[];try{const v=await H.get(`/chat/conversations/${y}/messages`,{params:w});p.value=v.data}catch(v){e.value=((h=(_=v.response)==null?void 0:_.data)==null?void 0:h.message)||"ডাটা লোড করতে ব্যর্থ হয়েছে।",console.error("Error fetching messages:",v)}finally{n.value=!1}},createConversationMessage:async(y,w={})=>{var _,h,v;if(y){n.value=!0,e.value=null;try{const m=await H.post(`/chat/conversations/${y}/messages`,w);return(_=p.value)==null||_.push(m.data),x(),m.data}catch(m){e.value=((v=(h=m.response)==null?void 0:h.data)==null?void 0:v.message)||"ডাটা Create করতে ব্যর্থ হয়েছে।",console.error("Error creating conversation:",m)}finally{n.value=!1}}}}}),Y={__name:"AddNewButton",setup(n){const e=A(),a=F(),s=()=>{e.openAddModal=!0};return(o,u)=>["super_admin","developer"].includes(C(a).user.role)?(r(),l("div",{key:0,onClick:s,title:"Add New Conversation",class:"size-10 shrink-0 grow-0 flex justify-center items-center"},u[0]||(u[0]=[t("i",{class:"fas fa-comment-alt-plus text-3xl cursor-pointer text-[#24A1DE]"},null,-1)]))):M("",!0)}},ie={class:"flex justify-center items-center gap-3"},de=["onClick"],ce={__name:"ConversationTypeSelector",props:{modelValue:{type:String,default:""},onSelect:{tyep:Function,default:()=>{}}},emits:["update:modelValue"],setup(n,{emit:e}){const a=n,s=e,o=k(()=>[{label:"Direct",value:"direct",iconClass:"fas fa-handshake"},{label:"Group",value:"group",iconClass:"fas fa-users"}]);function u(p){s("update:modelValue",p.value),a.onSelect()}return(p,i)=>(r(),l("div",ie,[(r(!0),l(I,null,T(o.value,c=>(r(),l("button",{key:c.value,class:j(["cursor-pointer px-6 py-1 border rounded-lg transition font-bold",n.modelValue===c.value?"bg-sky-600 text-white border-sky-600":"hover:bg-gray-50"]),onClick:d=>u(c)},[t("i",{class:j(c.iconClass)},null,2),N(" "+S(c.label),1)],10,de))),128))]))}},ue={class:"flex flex-col md:flex-row justify-center md:items-center gap-2"},ve=["value"],pe={__name:"GroupTitleInput",props:{modelValue:{type:String,default:""}},emits:["update:modelValue"],setup(n,{emit:e}){return(a,s)=>(r(),l("div",ue,[s[1]||(s[1]=t("label",{for:"title",class:"text-sm text-gray-700 shrink-0 w-20 text-right"}," Group Title ",-1)),t("input",{id:"title",value:n.modelValue,onInput:s[0]||(s[0]=o=>a.$emit("update:modelValue",o.target.value)),type:"text",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500"},null,40,ve)]))}},me={class:"grid sm:grid-cols-2 gap-4"},fe={class:"flex flex-col md:flex-row justify-center md:items-center gap-2"},ge=["value"],ye=["value"],he={class:"flex flex-col md:flex-row justify-center md:items-center gap-2"},xe=["value","disabled"],_e=["value"],be={__name:"CompanyDepartmentFilter",props:{companies:{type:Array,default:()=>[]},departments:{type:Array,default:()=>[]},companyId:{type:[String,Number],default:""},departmentId:{type:[String,Number],default:""}},emits:["update:companyId","update:departmentId"],setup(n,{emit:e}){return(a,s)=>(r(),l("div",me,[t("div",fe,[s[3]||(s[3]=t("label",{for:"title",class:"text-sm text-gray-700 shrink-0 w-20 text-right"},"Company",-1)),t("select",{value:n.companyId,onChange:s[0]||(s[0]=o=>a.$emit("update:companyId",o.target.value)),class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500"},[s[2]||(s[2]=t("option",{value:""},"-- Select Company --",-1)),(r(!0),l(I,null,T(n.companies,o=>(r(),l("option",{key:o.id,value:o.id},S(o.name),9,ye))),128))],40,ge)]),t("div",he,[s[5]||(s[5]=t("label",{for:"title",class:"text-sm text-gray-700 shrink-0 w-20 text-right"},"Department",-1)),t("select",{value:n.departmentId,disabled:!n.companyId,onChange:s[1]||(s[1]=o=>a.$emit("update:departmentId",o.target.value)),class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500 disabled:opacity-60"},[s[4]||(s[4]=t("option",{value:""},"-- Select Department --",-1)),(r(!0),l(I,null,T(n.departments,o=>(r(),l("option",{key:o.id,value:o.id},S(o.name),9,_e))),128))],40,xe)])]))}},we={class:"grid gap-2"},Ce={key:0,class:"flex flex-wrap gap-2"},ke={class:"font-medium"},$e=["onClick"],Ie={class:"flex items-center gap-2"},Se=["disabled"],Ue={class:"max-h-72 overflow-y-auto rounded-lg rounded-t-none border"},je={key:0,class:"p-4 text-gray-500 text-center"},Me={key:0,class:"p-4 text-center text-gray-600"},Ae={key:1,class:"divide-y"},De=["for"],Te={class:"flex items-center gap-3"},Ee=["title"],Le={class:"leading-tight"},Ve={class:"font-medium"},He={class:"text-xs text-gray-500"},Ne={class:"shrink-0 flex justify-center items-center"},Be=["id","type","name","checked","onChange"],ze={__name:"UserPicker",props:{mode:{type:String,required:!0},users:{type:Array,default:()=>[]},companyId:{type:[String,Number],default:""},departmentId:{type:[String,Number],default:""},selectedUserIds:{type:Array,default:()=>[]}},emits:["update:companyId","update:departmentId","update:selectedUserIds"],setup(n,{emit:e}){const a=n,s=e,o=ae(),u=oe(),p=re(),i=k({get:()=>a.companyId,set:v=>s("update:companyId",v)}),c=k({get:()=>a.departmentId,set:v=>s("update:departmentId",v)}),d=k({get:()=>a.selectedUserIds,set:v=>s("update:selectedUserIds",v)}),x=k(()=>o.companies||[]),U=k(()=>u.departments||[]),E=k(()=>p.users||[]),L=k(()=>{var v;return(v=a.users)!=null&&v.length?a.users:E.value}),g=b(""),y=k(()=>{if(!g.value.trim())return L.value;const v=g.value.trim().toLowerCase();return L.value.filter(m=>{const f=(m.name||"").toLowerCase(),V=String(m.employee_id||"").toLowerCase(),R=String(m.phone||"").toLowerCase(),Q=String(m.email||"").toLowerCase();return f.includes(v)||V.includes(v)||R.includes(v)||Q.includes(v)})}),w=k(()=>!i.value);function _(v){let m=[...d.value];const f=m.indexOf(v.id);a.mode==="direct"?m=f>=0?[]:[v.id]:f>=0?m.splice(f,1):m.push(v.id),d.value=m}function h(v){var f;const m=(f=L.value)==null?void 0:f.find(V=>parseInt(V.id)==parseInt(v));return m?m.name||m.employee_id||m.id:""}return B(()=>i.value,async(v,m)=>{v!==m&&(c.value="",d.value=[],v&&await u.fetchDepartments(v),await p.fetchUsers({company_id:v||null,department_id:null}))}),B(()=>c.value,async(v,m)=>{v!==m&&(d.value=[],i.value&&await p.fetchUsers({company_id:i.value,department_id:v||null}))}),O(async()=>{!x.value.length&&o.fetchCompanies&&await o.fetchCompanies(),i.value&&(await u.fetchDepartments(i.value),await p.fetchUsers({company_id:i.value,department_id:c.value||null}))}),(v,m)=>(r(),l(I,null,[$(be,{"company-id":i.value,"onUpdate:companyId":m[0]||(m[0]=f=>i.value=f),"department-id":c.value,"onUpdate:departmentId":m[1]||(m[1]=f=>c.value=f),companies:x.value,departments:U.value},null,8,["company-id","department-id","companies","departments"]),t("div",we,[n.mode==="group"&&n.selectedUserIds.length?(r(),l("div",Ce,[(r(!0),l(I,null,T(n.selectedUserIds,f=>(r(),l("span",{key:f,class:"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-sm"},[t("span",ke,S(h(f)),1),t("button",{type:"button",class:"text-red-600",onClick:V=>d.value=n.selectedUserIds.filter(R=>R!==f)}," ✕ ",8,$e)]))),128))])):M("",!0),t("div",null,[t("div",Ie,[P(t("input",{"onUpdate:modelValue":m[2]||(m[2]=f=>g.value=f),type:"search",disabled:w.value,class:"flex-1 px-3 py-2 border rounded-lg rounded-b-none focus:outline-none focus:ring-2 focus:ring-sky-500 disabled:opacity-60",placeholder:"Search by Name / Employee ID / Phone"},null,8,Se),[[q,g.value]])]),t("div",Ue,[w.value?(r(),l("div",je,"Company নির্বাচন করুন।")):(r(),l(I,{key:1},[y.value.length?(r(),l("div",Ae,[(r(!0),l(I,null,T(y.value,f=>(r(),l("label",{key:f.id,for:`userId${f.id}`,class:"flex items-center justify-between gap-3 p-3 hover:bg-gray-50"},[t("div",Te,[t("div",{class:"border rounded-full",title:f.name},[$(G,{user:f,size:"medium"},null,8,["user"])],8,Ee),t("div",Le,[t("div",Ve,S(f.name||"User #"+(f.employee_id??f.id)),1),t("div",He,S(f.employee_id||f.phone||f.email||""),1)])]),t("div",Ne,[t("input",{id:`userId${f.id}`,type:n.mode==="direct"?"radio":"checkbox",name:n.mode==="direct"?"direct-user":"group-users",checked:n.selectedUserIds.includes(f.id),onChange:V=>_(f),class:"size-5"},null,40,Be)])],8,De))),128))])):(r(),l("div",Me," কোন ইউজার পাওয়া যায়নি। "))],64))])])])],64))}},Oe={key:0,class:"fixed inset-0 w-screen h-screen bg-black/50 flex justify-center items-center z-[9999999]"},Re={class:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90%] overflow-y-auto"},Ge={class:"flex justify-between items-center"},Pe={key:0,class:"mt-4"},qe={key:1,class:"text-red-600 text-sm"},Fe={class:"flex justify-between"},Ke=["disabled"],Ye={__name:"AddNewConversationModal",setup(n){const e={DIRECT:"direct",GROUP:"group"},a=A(),s=Z(),o=b(""),u=b(""),p=b(""),i=b(""),c=b([]),d=b(""),x=()=>{a.openAddModal=!1,U()};function U(){o.value="",u.value="",p.value="",i.value="",c.value=[],d.value=""}async function E(){var g;if(d.value="",!o.value){d.value="দয়া করে Conversation টাইপ নির্বাচন করুন।";return}if(((g=c.value)==null?void 0:g.length)==0){d.value="User নির্বাচন করুন।";return}const L=await a.createConversation({type:o.value,title:o.value=="group"?i.value:"",user_ids:c.value});a.openAddModal=!1,s.push({name:"Conversation Message",params:{conversationId:L}}),a.fetchUserConversations()}return(L,g)=>C(a).openAddModal?(r(),l("div",Oe,[t("div",Re,[t("div",Ge,[g[5]||(g[5]=t("h2",{class:"text-xl text-center"},"Add New Conversation Form",-1)),$(ce,{modelValue:o.value,"onUpdate:modelValue":g[0]||(g[0]=y=>o.value=y),onSelect:()=>c.value=[]},null,8,["modelValue","onSelect"])]),g[9]||(g[9]=t("hr",{class:"mt-4"},null,-1)),o.value?(r(),l("form",{key:1,class:"space-y-3 mt-3",onSubmit:ee(E,["prevent"])},[o.value===e.GROUP?(r(),D(pe,{key:0,modelValue:i.value,"onUpdate:modelValue":g[1]||(g[1]=y=>i.value=y)},null,8,["modelValue"])):M("",!0),$(ze,{mode:o.value,"company-id":u.value,"onUpdate:companyId":g[2]||(g[2]=y=>u.value=y),"department-id":p.value,"onUpdate:departmentId":g[3]||(g[3]=y=>p.value=y),selectedUserIds:c.value,"onUpdate:selectedUserIds":g[4]||(g[4]=y=>c.value=y)},null,8,["mode","company-id","department-id","selectedUserIds"]),d.value?(r(),l("p",qe,S(d.value),1)):M("",!0),g[8]||(g[8]=t("hr",null,null,-1)),t("div",Fe,[t("button",{type:"button",class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",onClick:x}," Cancel "),t("button",{type:"submit",class:"px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 disabled:opacity-60",disabled:o.value===e.DIRECT?c.value.length!==1:!i.value.trim()||c.value.length<2}," Create ",8,Ke)])],32)):(r(),l("div",Pe,[t("div",{class:"rounded-md border border-dashed p-4 text-center text-gray-600"},[g[6]||(g[6]=t("div",{class:"py-4 text-xl leading-loose"},[N(" Conversation টাইপ (Direct / Group) সিলেক্ট করুন, "),t("br"),N(" তারপর নিচে ফিল্টার দেখাবে। ")],-1)),g[7]||(g[7]=t("p",{class:"pb-1"},"অথবা,",-1)),t("button",{type:"button",class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",onClick:x}," Cancel ")])]))])])):M("",!0)}},We={key:0,class:"flex gap-1 items-center justify-center"},Je={class:"text-sm"},Qe=["innerHTML"],Xe={key:1},Ze={class:"border rounded-lg max-w-lg w-full"},et={class:"flex items-center gap-1"},tt={class:"font-semibold hidden sm:inline-block text-sm"},st=["innerHTML"],nt={__name:"ChatMessageCard",props:{message:{type:Object,required:!0}},setup(n){F();const e=n,a=k(()=>e.message.is_own_message),s=k(()=>e.message.type==="system");return(o,u)=>{var p,i;return r(),l("div",{class:j(["flex px-4",{"justify-end pl-12":!s.value&&a.value,"justify-start pr-12":!s.value&&!a.value,"justify-center":s.value}])},[s.value?(r(),l("div",We,[u[0]||(u[0]=t("i",{class:"far fa-cog text-gray-700"},null,-1)),t("strong",Je,S(a.value?"You":(p=n.message.sender)==null?void 0:p.name),1),t("div",{innerHTML:n.message.body,class:"block text-sm italic whitespace-pre-wrap break-words leading-relaxed"},null,8,Qe)])):(r(),l("div",Xe,[t("div",Ze,[t("div",{class:j(["flex justify-between items-center p-1 rounded-t-lg gap-4",{"bg-[#24A1DE] text-white":a.value,"bg-gray-200 text-black":!a.value}])},[t("div",et,[$(G,{user:n.message.sender,size:"small"},null,8,["user"]),t("div",tt,S((i=n.message.sender)==null?void 0:i.name),1)]),t("div",{class:j(["text-xs mt-1",a.value?"text-right":"text-left"])},S(n.message.send_at),3)],2),t("div",{class:"block py-1 px-2 rounded-b-lg bg-white text-sm whitespace-pre-wrap break-words leading-relaxed",innerHTML:n.message.body},null,8,st)]),t("div",{class:j(["flex",{"justify-end":a.value,"justify-start":!a.value}])},[t("div",{class:j(["flex flex-wrap gap-1 max-w-[280px] pt-1",{"justify-end":a.value,"justify-start":!a.value}])},[(r(!0),l(I,null,T(n.message.last_reader_photos,c=>(r(),l(I,{key:c},[c?(r(),D(G,{key:0,user:{photo:c},size:"xsmall"},null,8,["user"])):M("",!0)],64))),128))],2)],2)]))],2)}}},at={},ot={class:"flex justify-center items-center py-4"};function rt(n,e){return r(),l("div",ot,e[0]||(e[0]=[t("i",{class:"fas fa-spinner fa-spin text-2xl text-[#24A1DE]"},null,-1)]))}const W=le(at,[["render",rt]]),lt={key:1,class:"text-red-500 text-center my-4"},it={key:2,class:"text-center text-gray-500 my-4"},dt={key:0,class:"text-xs text-gray-400 text-center py-2"},ct={__name:"ChatMessageContainer",setup(n){const e=A(),a=b(null),s=b(!0),o=b(!1),u=(d,x=80)=>d.scrollHeight-d.scrollTop-d.clientHeight<x,p=async(d="auto")=>{await z();const x=a.value;x&&(x.scrollTo({top:x.scrollHeight,behavior:d}),s.value=!0)},i=async()=>{const d=a.value;if(d&&(s.value=u(d),d.scrollTop<=0&&e.hasMore&&!o.value)){o.value=!0;const x=d.scrollHeight,U=d.scrollTop;try{await e.fetchOlderMessages(e.activeConversationId),await z();const E=d.scrollHeight;d.scrollTop=E-(x-U)}catch{}finally{o.value=!1}}},c=async()=>{try{e.activeConversationId&&(await e.fetchConversationMessages(e.activeConversationId),await p("auto"))}catch{}};return O(()=>{c()}),B(()=>e.activeConversationId,async(d,x)=>{d&&d!==x&&await c()}),B(()=>e.messages.length,async(d,x)=>{const U=a.value;U&&d>x&&u(U,120)&&await p("smooth")}),k(()=>!s.value&&!!e.activeConversationId),(d,x)=>(r(),l("div",{ref_key:"scrollEl",ref:a,onScroll:i,class:j(["w-full overflow-y-auto h-[calc(100vh-200px)] scrollbar relative flex flex-col",{"items-center justify-center":!C(e).activeConversationId||C(e).error||C(e).loading}])},[C(e).loading?(r(),D(W,{key:0})):M("",!0),C(e).error?(r(),l("div",lt,S(C(e).error),1)):C(e).activeConversationId?(r(),l(I,{key:3},[o.value?(r(),l("div",dt,"Loading older…")):M("",!0),(r(!0),l(I,null,T(C(e).messages,U=>(r(),D(nt,{key:U.id,message:U,class:"w-full my-4"},null,8,["message"]))),128))],64)):(r(),l("div",it," Please select a conversation to view messages. ")),te(d.$slots,"default")],34))}},ut={class:"min-w-max size-12 flex justify-center items-center text-[#24A1DE] bg-white rounded-full overflow-hidden border"},vt=["src"],pt={key:0,class:"fas fa-users text-3xl"},mt={key:1,class:"fas fa-user text-3xl"},J={__name:"ConversationAvatar",props:{conversation:{type:Object,required:!0}},setup(n){const e=b(!0);return(a,s)=>{var o,u;return r(),l("div",null,[t("div",ut,[(o=n.conversation)!=null&&o.avatar&&e.value?(r(),l("img",{key:0,onError:s[0]||(s[0]=p=>e.value=!1),src:(u=n.conversation)==null?void 0:u.avatar,alt:"Photo",class:"object-cover w-full h-full"},null,40,vt)):(r(),l(I,{key:1},[n.conversation.type==="group"?(r(),l("i",pt)):(r(),l("i",mt))],64))])])}}},ft={key:0,class:"flex items-center justify-start gap-2 px-1 py-[3px] bg-[#24A1DE] border-b border-[#24A1DE] text-white"},gt={class:"text-lg font-semibold"},yt={key:0,class:"text-sm text-gray-50 flex items-center gap-1 font-thin"},ht={key:1,class:"text-sm text-gray-50 flex items-center gap-1 font-thin"},xt={__name:"ConversationHeader",setup(n){const e=A(),a=k(()=>{var s,o,u,p,i,c;return(s=e.activeConversation)!=null&&s.title?e.activeConversation.title:(o=e.activeConversation)!=null&&o.participants&&((p=(u=e.activeConversation)==null?void 0:u.participants)==null?void 0:p.length)>0?(c=(i=e.activeConversation)==null?void 0:i.participants)==null?void 0:c.map(d=>{var x;return(x=d.user)==null?void 0:x.name}).join(", "):"Untitled Conversation"});return(s,o)=>{var u,p;return(p=(u=C(e))==null?void 0:u.activeConversation)!=null&&p.id?(r(),l("div",ft,[$(J,{conversation:C(e).activeConversation},null,8,["conversation"]),t("div",null,[t("h3",gt,S(a.value),1),C(e).activeConversation.type==="group"?(r(),l("div",yt,o[0]||(o[0]=[t("i",{class:"fas fa-users"},null,-1),t("i",null,"Group chatting",-1)]))):(r(),l("div",ht,o[1]||(o[1]=[t("i",{class:"fas fa-handshake"},null,-1),t("i",null,"One to One chatting",-1)])))])])):M("",!0)}}},_t={class:"flex items-center gap-2"},bt={class:"text-lg font-semibold"},wt=["innerHTML"],Ct={__name:"ConversationListItem",props:{conversation:{type:Object,required:!0}},setup(n){const e=A(),a=n,s=k(()=>parseInt(a.conversation.id)===parseInt(e.activeConversationId));return(o,u)=>{var i;const p=se("RouterLink");return(i=n.conversation)!=null&&i.id?(r(),D(p,{key:0,to:`/chatting/${n.conversation.id}`,class:j(["block p-3 border-b cursor-pointer hover:bg-[#24A1DE] hover:text-white group hover:opacity-90",{"bg-[#24A1DE] text-white":s.value}])},{default:K(()=>[t("div",_t,[$(J,{conversation:n.conversation},null,8,["conversation"]),t("div",null,[t("h3",bt,S(n.conversation.title),1),t("div",{class:j(["text-sm group-hover:text-gray-50 line-clamp-1",{"text-gray-50":s.value,"text-gray-600":!s.value}]),innerHTML:n.conversation.subtitle},null,10,wt)])])]),_:1},8,["to","class"])):M("",!0)}}},kt={class:"flex flex-col items-center justify-center p-4 text-center text-gray-600"},$t={__name:"ConversationNotFoundMessage",setup(n){return(e,a)=>(r(),l("div",kt,[a[0]||(a[0]=t("i",{class:"fas fa-info-circle text-xl"},null,-1)),a[1]||(a[1]=t("p",{class:"mt-2 mb-4"},[N(" No conversations found. "),t("br"),N(" Start a new conversation! ")],-1)),$(Y)]))}},It={class:"overflow-y-auto h-[calc(100vh-200px)] scrollbar text-blue-900 bg-white border-0"},St={__name:"ConversationList",setup(n){const e=A(),a=b(!1);return O(async()=>{a.value=!0,await e.fetchUserConversations(),a.value=!1}),(s,o)=>(r(),l("div",null,[t("div",It,[a.value?(r(),D(W,{key:0})):C(e).conversations.length===0?(r(),D($t,{key:1})):(r(!0),l(I,{key:2},T(C(e).filteredConversations,u=>(r(),D(Ct,{key:u.id,conversation:u},null,8,["conversation"]))),128))])]))}},Ut={for:"search",class:"grow shrink relative block"},jt={__name:"SearchConversation",setup(n){const e=A();return(a,s)=>(r(),l("label",Ut,[s[1]||(s[1]=t("i",{class:"fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-[#24A1DE]"},null,-1)),P(t("input",{id:"search",placeholder:"Search Conversations...",type:"search",class:"input-1 pl-10 pr-2 rounded-b-none border-none outline-[#24a0deb0] py-[15px] rounded-none rounded-tl-lg","onUpdate:modelValue":s[0]||(s[0]=o=>C(e).searchText=o)},null,512),[[q,C(e).searchText]])]))}},Mt={class:"flex items-start gap-2"},At={class:"w-full border-2 border-blue-100 rounded-3xl bg-gray-100 px-4 py-2"},Dt={__name:"SendMessageBox",setup(n){const e=A(),a=b(""),s=b(null);function o(){const i=s.value;i&&(i.style.height="auto",i.style.height=i.scrollHeight+"px")}async function u(){var d;const i=a.value.replace(/\u00a0/g," ").replace(/\r\n?/g,`
`).trim();if(!e.activeConversationId||!i)return;const c=await e.createConversationMessage(e.activeConversationId,{type:"text",body:i,format:"plain"});a.value="",await z(),o(),(d=e==null?void 0:e.bumpConversationToTop)==null||d.call(e,e.activeConversationId,c)}function p(i){i.isComposing||i.key==="Enter"&&!i.shiftKey&&(i.preventDefault(),u())}return O(()=>z(o)),(i,c)=>(r(),l("div",Mt,[c[2]||(c[2]=t("label",{class:"hidden bg-gray-100 text-gray-600 rounded-full px-3 py-2 hover:bg-gray-500 hover:text-white cursor-pointer"},[t("input",{type:"file",class:"hidden",accept:"image/jpg,image/jpeg,image/png,image/gif,application/pdf"}),t("i",{class:"far fa-paperclip text-xl"})],-1)),t("div",At,[P(t("textarea",{ref_key:"taRef",ref:s,"onUpdate:modelValue":c[0]||(c[0]=d=>a.value=d),onInput:o,onKeydown:p,rows:"1",placeholder:"Write a message…",class:"w-full resize-none overflow-hidden bg-transparent outline-none leading-6 max-h-32"},null,544),[[q,a.value]])]),t("button",{type:"button",onClick:u,class:"bg-blue-100 text-blue-600 rounded-full px-3 py-2 hover:bg-blue-600 hover:text-white"},c[1]||(c[1]=[t("i",{class:"far fa-paper-plane text-xl"},null,-1)]))]))}},Tt={class:"my-container"},Et={class:"flex overflow-hidden border-[#24A1DE] border rounded-lg"},Lt={class:"grow-0 shrink-0 w-[360px] rounded-l-lg"},Vt={class:"flex items-center justify-between border-b border-[#24A1DE] bg-white rounded-tl-lg"},Ht={class:"relative grow shrink border-l rounded-r-lg overflow-hidden bg-gray-100 border-[#24A1DE]"},Nt={key:0,class:"text-2xl font-bold my-8 text-center"},Pt={__name:"ChattingList",setup(n){const e=A(),a=ne();return B(()=>a.params.conversationId,s=>{e.activeConversationId=s},{immediate:!0}),(s,o)=>(r(),l(I,null,[t("div",Tt,[t("div",Et,[t("div",Lt,[t("div",Vt,[$(jt),$(Y)]),$(St)]),t("div",Ht,[C(e).activeConversationId?(r(),l(I,{key:1},[$(xt),$(ct,null,{default:K(()=>[$(Dt,{class:"bg-white border-t border-[#24A1DE] sticky bottom-0 mt-auto z-10 w-full p-2"})]),_:1})],64)):(r(),l("h2",Nt," Select a conversation to start chatting "))])])]),$(Ye)],64))}};export{Pt as default};
