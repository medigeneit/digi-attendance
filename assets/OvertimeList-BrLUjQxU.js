import{u as S,b as h,a9 as B,r as m,e as C,m as O,A as g,c as v,o as u,a as l,f as x,g as c,p as b,h as L,v as M,x as N,k as A}from"./index-CgNX-fih.js";import{_ as D}from"./EmployeeFilter-DMIoQML4.js";import{L as V}from"./LoaderView-GhfkLam1.js";import{_ as $}from"./OvertimeDataList-C4zlzrsl.js";import{u as F}from"./overtime-D8_MYVwz.js";import{u as I}from"./user-qv-Kousv.js";import"./company-MWDHzsbN.js";import"./department-DuMvs2R8.js";import"./EmployeeDropdownInput-CBd-F32O.js";import"./SelectDropdown-HPJaYBPU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-BsQZaWiB.js";import"./AcceptAndRejectHandler-DZPvfQ4w.js";import"./DisplayFormattedWorkingHours-BbK0Sops.js";import"./TimePickerAsFloatHour-IN_2E7Dd.js";const R={class:"px-4 space-y-4"},j={key:0,class:"absolute inset-0 w-full h-full"},z={key:2},ie={__name:"OvertimeList",setup(E){const d=S(),o=h(),U=B(),y=F(),_=I(),s=m(!1),r=m(null),n=m(o.query.date||new Date().toISOString().slice(0,7)),a=m({company_id:o.query.company_id||"",department_id:o.query.department_id||"all",line_type:o.query.line_type||"all",employee_id:o.query.employee_id||"",category:""});C(async()=>{if(a.value.employee_id){s.value=!0;try{await f(a.value.employee_id),await p()}catch(t){console.log(t)}s.value=!1}});const f=async t=>{t?(await _.fetchUser(t),r.value=_.user):r.value=null},w=O(()=>{var t;return((t=y.overtimes)==null?void 0:t.map(e=>e.id))||[]}),p=async()=>{var t;a.value.employee_id&&n.value&&(await y.fetchUserMonthlyOvertimes(a.value.employee_id,n.value),(t=w.value)!=null&&t.length&&await U.fetchApprovalPermissionsByUserApplicationIds("overtime_applications",w.value))};g(n,t=>{d.replace({query:{...o.query,date:t}}),p()}),g(()=>a.value.employee_id,async(t,e)=>{t&&t!==e&&(await f(t),await p())});const k=()=>d.go(-1),q=()=>{d.replace({query:{...o.query,company_id:a.value.company_id,department_id:a.value.department_id,line_type:a.value.line_type,employee_id:a.value.employee_id||o.query.employee_id}})};return(t,e)=>(u(),v("div",R,[l("div",{class:"flex items-center justify-between gap-2"},[l("button",{class:"btn-3",onClick:k},e[5]||(e[5]=[l("i",{class:"far fa-arrow-left"},null,-1),l("span",{class:"hidden md:flex"},"Back",-1)])),e[6]||(e[6]=l("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Overtime",-1)),e[7]||(e[7]=l("div",null,null,-1))]),l("div",{class:N(["w-full flex flex-wrap gap-4 items-center md:w-auto relative",{"opacity-50":s.value}])},[b(D,{company_id:a.value.company_id,"onUpdate:company_id":e[0]||(e[0]=i=>a.value.company_id=i),department_id:a.value.department_id,"onUpdate:department_id":e[1]||(e[1]=i=>a.value.department_id=i),employee_id:a.value.employee_id,"onUpdate:employee_id":e[2]||(e[2]=i=>a.value.employee_id=i),line_type:a.value.line_type,"onUpdate:line_type":e[3]||(e[3]=i=>a.value.line_type=i),"with-type":!0,"initial-value":t.$route.query,onFilterChange:q},null,8,["company_id","department_id","employee_id","line_type","initial-value"]),l("div",null,[L(l("input",{id:"monthSelect",type:"month","onUpdate:modelValue":e[4]||(e[4]=i=>n.value=i),onChange:p,class:"input-1"},null,544),[[M,n.value]])]),s.value?(u(),v("div",j)):c("",!0)],2),A(y).isLoading||s.value?(u(),x(V,{key:0})):r.value?(u(),x($,{key:1,user:r.value,onUpdate:p},null,8,["user"])):c("",!0),r.value?c("",!0):(u(),v("div",z,e[8]||(e[8]=[l("p",{class:"text-gray-400 text-center text-2xl italic"},"Select an employee, please.",-1)])))]))}};export{ie as default};
