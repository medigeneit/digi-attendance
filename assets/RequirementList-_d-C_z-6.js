import{L as j}from"./LoaderView-nY3CLmOK.js";import{d as P,b as E,p as g,r as U,e as B,q as M,c as n,o,a as e,y as v,f as C,g as $,i as w,t as x,k as m,h as F,v as z,u as I,C as O,j as D,F as H,x as G}from"./index-CBT9UYkI.js";import{g as Y}from"./task-Cstyp4re.js";import{u as J}from"./company-C6NxKsuO.js";import{_ as N}from"./CompanyDepartmentSelectInput-A_qIcd-i.js";import{_ as K}from"./EmployeeDropdownInput-BPHl-3C6.js";import{S as Q}from"./SelectDropdown-Bno6AjT5.js";import{_ as W}from"./UserChip-CzyIrxaQ.js";import{u as X}from"./useRequirementStore-BH55n6_w.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./url-CePbr-gY.js";import"./requirement-D553jRDu.js";const Z={class:"mb-3 task-header"},q={class:"flex flex-wrap items-center justify-center gap-2 mt-3"},ee={class:"flex flex-wrap gap-x-4 gap-y-3 justify-between"},te={class:"relative"},se=["title"],ae={key:0},le={key:1,class:"text-gray-500 whitespace-nowrap"},oe={key:1,class:"relative w-full md:w-56 lg:flex-grow"},ne={class:"text-gray-600 w-full md:w-32 relative"},de={__name:"RequirementHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(S,{emit:r}){const f=S,T=P(),_=E(),y=g(c("company-id")),p=g(c("from-department-id")),s=g(c("to-department-id")),b=g(c("created-by")),k=g(c("month")),t=r,d=J(),V=U([]);function c(i){return{get:()=>f.modelValue[i]||"",set:a=>{t("update:modelValue",{...f.modelValue,[i]:a||void 0})}}}async function h(){var i,a,R;if(!f.isMyTask){const A=(i=f.modelValue)==null?void 0:i["company-id"],L=s.value,l={...A?{company_id:A}:{},...L?{department_ids:[L]}:{}};V.value=((R=(a=await Y({params:l}))==null?void 0:a.data)==null?void 0:R.employees)||[]}}B(async()=>{await d.fetchCompanies({with:"departments",ignore_permission:!0}),await d.fetchMyCompanies({with:"departments"}),await h()}),M(()=>s.value,h),M(()=>y.value,()=>{p.value="",s.value="",b.value="",h()});const u=g(()=>y.value?d==null?void 0:d.companies.filter(i=>i.id==y.value):d==null?void 0:d.companies);return(i,a)=>{var R,A,L;return o(),n("div",null,[e("div",Z,[e("div",q,[e("div",ee,[e("div",te,[v(Q,{modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=l=>y.value=l),options:((R=m(d))==null?void 0:R.companies)||[],label:"name",id:"id",class:"border-2 border-gray-300 rounded h-[40px] w-full md:w-48 bg-white text-sm",clearable:""},{"selected-option":w(({option:l})=>[e("div",{class:"line-clamp-1 text-sm text-gray-900",title:l==null?void 0:l.name},[l!=null&&l.name?(o(),n("span",ae,x(l==null?void 0:l.name),1)):(o(),n("span",le,"--ALL COMPANY--"))],8,se)]),_:1},8,["modelValue","options"]),a[5]||(a[5]=e("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Company ",-1))]),v(N,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=l=>p.value=l),companies:u.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:w(()=>a[6]||(a[6]=[e("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),m(_).name!=="MyTaskList"?(o(),C(N,{key:0,modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=l=>s.value=l),companies:u.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:w(()=>a[7]||(a[7]=[e("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):$("",!0),m(T).isAdminMood&&((L=(A=m(T))==null?void 0:A.user)==null?void 0:L.role)!=="employee"?(o(),n("div",oe,[v(K,{employees:V.value,modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=l=>b.value=l),class:"border-2 border-gray-300 rounded h-[40px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),a[8]||(a[8]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Created By ",-1))])):$("",!0),e("div",ne,[a[9]||(a[9]=e("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),F(e("input",{id:"month-filter","onUpdate:modelValue":a[4]||(a[4]=l=>k.value=l),type:"month",class:"h-10 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[z,k.value]])])])])])])}}},ie={class:"container mx-auto p-6"},re={class:"bg-white shadow-md rounded-lg p-6"},ue={key:1,class:"text-center py-4 text-red-500"},me={key:2,class:"overflow-x-auto"},pe={class:"min-w-full bg-white border overflow-hidden table table-fixed"},ce={key:0},xe={class:"px-4 py-4 font-semibold text-xl text-gray-700"},fe={class:"px-4 py-4 max-w-[60px] md:max-w-[300px]"},ye={class:"flex flex-col lg:flex-row items-start lg:items-center gap-2 text-sm mb-3"},be={class:"text-blue-500/60 group-hover/item:text-blue-500 font-semibold flex-shrink-0 border bg-blue-50 rounded-full px-2 text-xs"},ge={class:"text-sky-500/60 group-hover/item:text-sky-500 font-semibold flex-shrink-0 border bg-blue-50 rounded-full px-2 text-xs"},ve={class:"space-y-4"},we={key:0,class:"text-blue-800"},_e=["title"],he={key:1,class:"text-gray-400 text-sm italic"},ke={key:0},Ve={key:1,class:""},Re={class:"px-4 py-4 text-right whitespace-nowrap"},Ae={class:"px-4 py-4 text-center whitespace-nowrap"},Le={class:"text-gray-600"},Te={class:"px-4 py-4 text-center"},De={class:"flex gap-4 items-center justify-center"},Ie={__name:"RequirementList",setup(S){const r=X(),f=I(),T=E(),_=g({get(){return{...T.query}},set(p){f.push({query:{...p}})}});B(()=>{console.log("Requirement List Mounted"),r.fetchRequirements(_.value)}),M(()=>({..._.value}),async function(p){r.fetchRequirements(p)});const y=()=>{f.push({name:"RequirementAdd"})};return(p,s)=>{var k;const b=O("RouterLink");return o(),n("div",ie,[e("div",re,[e("div",{class:"flex justify-between items-center mb-6"},[s[3]||(s[3]=e("h2",{class:"text-2xl font-bold text-gray-800"},"Requirements",-1)),e("button",{onClick:y,class:"btn-1"},"Add Requirement")]),v(de,{modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=t=>_.value=t)},null,8,["modelValue"]),m(r).loading?(o(),C(j,{key:0,class:"min-h-64 shadow-none"},{default:w(()=>s[4]||(s[4]=[D("Loading requirements...")])),_:1,__:[4]})):m(r).error?(o(),n("div",ue,x(m(r).error),1)):(o(),n("div",me,[e("table",pe,[s[10]||(s[10]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-2 text-center whitespace-nowrap w-2"},"#"),e("th",{class:"px-4 py-2 text-left whitespace-nowrap"},"Requirement"),e("th",{class:"px-4 py-2 text-center whitespace-nowrap w-16"},"Submitted By"),e("th",{class:"px-4 py-2 text-center whitespace-nowrap w-16"},"Submitted At"),e("th",{class:"px-4 py-2 text-center whitespace-nowrap w-20"},"Actions")])],-1)),e("tbody",null,[((k=m(r).requirements)==null?void 0:k.length)===0?(o(),n("tr",ce,s[5]||(s[5]=[e("td",{colspan:"10",class:"p-4"},[e("div",{class:"text-gray-500 italic w-full h-64 flex items-center justify-center"}," No Requirement Found ")],-1)]))):(o(!0),n(H,{key:1},G(m(r).requirements,(t,d)=>{var V,c,h;return o(),n("tr",{key:t.id,class:"border-t hover:bg-blue-50 odd:bg-gray-50 group/item"},[e("td",xe,x(d+1),1),e("td",fe,[e("div",ye,[s[6]||(s[6]=e("span",{class:"text-gray-400"},"From ",-1)),e("span",be,x((V=t==null?void 0:t.from_department)==null?void 0:V.name),1),s[7]||(s[7]=e("span",{class:"text-gray-400"},"To ",-1)),e("span",ge,x((c=t==null?void 0:t.to_department)==null?void 0:c.name),1)]),e("div",ve,[((h=t==null?void 0:t.details)==null?void 0:h.length)>0&&Array.isArray(t==null?void 0:t.details)?(o(),n("div",we,[e("div",{class:"line-clamp-1 font-semibold",title:t==null?void 0:t.details[0].title},x(t==null?void 0:t.details[0].title),9,_e)])):(o(),n("div",he,"No Requirement added")),v(b,{to:{name:"RequirementShow",params:{id:t==null?void 0:t.id}},class:"text-blue-600 text-sm hover:underline hover:text-blue-800"},{default:w(()=>{var u,i;return[((u=t==null?void 0:t.details)==null?void 0:u.length)-1>0?(o(),n("span",ke,x(((i=t==null?void 0:t.details)==null?void 0:i.length)-1)+" More Requirement ",1)):(o(),n("span",Ve,"Show Form"))]}),_:2},1032,["to"])])]),e("td",Re,[t.created_by?(o(),C(W,{key:0,user:t.created_by},null,8,["user"])):$("",!0)]),e("td",Ae,[e("div",Le,x(new Date(t.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),1)]),e("td",Te,[e("div",De,[v(b,{to:{name:"RequirementShow",params:{id:t==null?void 0:t.id}},class:"btn-2",onClick:s[1]||(s[1]=u=>u.stopPropagation())},{default:w(()=>s[8]||(s[8]=[e("i",{class:"fad fa-eye"},null,-1),D(" Show ")])),_:2,__:[8]},1032,["to"]),v(b,{to:{name:"RequirementEdit",params:{id:t==null?void 0:t.id}},class:"btn-4 border border-blue-500 hover:bg-blue-500 hover:text-white",onClick:s[2]||(s[2]=u=>u.stopPropagation())},{default:w(()=>s[9]||(s[9]=[e("i",{class:"fad fa-edit"},null,-1),D(" Edit ")])),_:2,__:[9]},1032,["to"])])])])}),128))])])]))])])}}};export{Ie as default};
