import{r as h,h as X,y as Y,c as d,o as l,a as e,k as b,t as n,d as g,F as B,A as Z,f as te,u as se,g as re,ac as oe,x as D,p as ne,e as ae,s as le,n as y,j as ie,m as de}from"./index-DP_M0nuB.js";import{u as R}from"./overtime-CzeAFgub.js";import{_ as ce}from"./AcceptAndRejectHandler-B24WzOY4.js";import{_ as w}from"./DisplayFormattedWorkingHours-Dx1BDf0V.js";import{_ as ue}from"./TimePickerAsFloatHour-B7EwtVRD.js";const pe={key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50"},be={class:"modal-card max-w-sm p-4"},me={class:"grid grid-cols-3 gap-2 border p-3"},ye={class:"border-x"},ge={class:"col-span-full text-xs md:text-sm border-t pt-3"},fe={class:"flex justify-between gap-2 mt-2"},xe={__name:"DeleteOvertime",props:{overtime:Object,onSuccess:{type:Function,default:null}},setup(o){const c=o,m=R(),u=h(null),f=h(null),p=h(!1),x=async()=>{await m.deleteOvertime(c.overtime.id),c.onSuccess&&await c.onSuccess(),k()},S=()=>{p.value=!0,_()},k=()=>{p.value=!1};function _(){Z(()=>{var r;(r=u.value)==null||r.focus()})}function t(r){var i,a;p.value&&(r.key==="ArrowLeft"?(i=f.value)==null||i.focus():r.key==="ArrowRight"&&((a=u.value)==null||a.focus()))}return X(()=>{window.addEventListener("keydown",t)}),Y(()=>{window.removeEventListener("keydown",t)}),(r,i)=>(l(),d(B,null,[e("i",{onClick:S,class:"fa fa-trash cursor-pointer text-red-600"}),p.value?(l(),d("div",pe,[e("div",be,[i[0]||(i[0]=e("h3",{class:"title-lg"},"Delete Overtime",-1)),e("div",me,[e("div",null,[e("b",null,n(new Date(o.overtime.date).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})),1)]),e("div",ye,[e("b",null,n(o.overtime.duty_type),1)]),e("div",null,[e("b",null,[g(w,{workingHours:o.overtime.request_overtime_hours},null,8,["workingHours"])])]),e("div",ge,n(o.overtime.work_details),1)]),e("div",fe,[e("button",{type:"button",ref_key:"cancelBtnRef",ref:f,class:"btn-3 focus:ring-2 ring-offset-2",onClick:k}," Cancel ",512),e("button",{type:"button",ref_key:"confirmBtnRef",ref:u,class:"btn-2-red focus:ring-2 ring-offset-2",onClick:x}," Delete ",512)])])])):b("",!0)],64))}},_e={key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50"},ve={class:"modal-card max-w-sm"},he={class:"flex justify-between gap-2 mt-4"},ke={__name:"UpdateApprovalTime",props:{overtime:Object,onSuccess:{type:Function,default:null}},setup(o){const c=o,m=R(),u=h(null),f=h(null),p=h(!1),x=h(c.overtime.approval_overtime_hours||c.overtime.request_overtime_hours||""),S=async()=>{if(!x.value)return alert("Please set approval time!");await m.updateApprovalTime(c.overtime.id,x.value),c.onSuccess&&await c.onSuccess(),_()},k=()=>{p.value=!0,t()},_=()=>{p.value=!1};function t(){Z(()=>{var i;(i=u.value)==null||i.focus()})}function r(i){var a,v;p.value&&(i.key==="ArrowLeft"?(a=f.value)==null||a.focus():i.key==="ArrowRight"&&((v=u.value)==null||v.focus()))}return X(()=>{window.addEventListener("keydown",r)}),Y(()=>{window.removeEventListener("keydown",r)}),(i,a)=>(l(),d(B,null,[e("i",{onClick:k,class:"fa fa-edit cursor-pointer text-sky-600"}),p.value?(l(),d("div",_e,[e("div",ve,[a[1]||(a[1]=e("h3",{class:"title-lg"},"Update Approval Time",-1)),a[2]||(a[2]=e("hr",{class:"my-2"},null,-1)),g(ue,{modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=v=>x.value=v),"minute-interval":5,required:!0,"hour-min":1,"hour-max":16},null,8,["modelValue"]),a[3]||(a[3]=e("hr",{class:"my-2"},null,-1)),e("div",he,[e("button",{type:"button",ref_key:"cancelBtnRef",ref:f,class:"btn-3 focus:ring-2 ring-offset-2",onClick:_}," Cancel ",512),e("button",{type:"button",ref_key:"confirmBtnRef",ref:u,class:"btn-2-green focus:ring-2 ring-offset-2",onClick:S}," Update Time ",512)])])])):b("",!0)],64))}},we={class:"space-y-4"},Se={class:"card-bg p-4 gap-1"},Ae={class:"flex flex-wrap gap-x-8 gap-y-2"},De={key:0,class:"text-gray-700"},Be={class:"ml-1"},Re={key:1,class:"text-gray-700"},Ce={class:"ml-1"},Oe={key:2,class:"text-gray-700"},$e={class:"ml-1"},Le={key:3,class:"text-gray-700"},Ne={class:"ml-1"},je={key:4,class:"text-gray-700"},He={class:"ml-1"},Me={class:"overflow-x-auto"},Te={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Ue={class:"border border-gray-300 px-2 text-center"},qe={class:"border border-gray-300 px-2 text-center"},Pe={class:"border border-gray-300 px-2 text-center"},Ee={class:"border border-gray-300 px-2 text-center"},Ve={class:"border border-gray-300 px-2 text-center"},Fe={class:"border border-gray-300 px-2 text-center"},Ie={class:"border border-gray-300 px-2 text-center"},ze={class:"border border-gray-300 px-2 text-center"},Ge={class:"border border-gray-300 px-2 text-center"},Ke={class:"flex items-center justify-center gap-4"},We={class:"border border-gray-300 px-2 text-center"},Je={class:"border border-gray-300 px-2 text-center"},Qe={class:"border border-gray-300 px-2 text-center !py-0.5"},Xe={class:"flex items-center justify-center gap-x-4"},Ye={key:0,class:"border border-dashed px-4 rounded-xl"},Ze={key:0},et={key:0,class:"bg-gray-50"},tt={class:"*:py-2 font-semibold"},st={class:"border border-gray-300 px-2 text-center"},rt={class:"border border-gray-300 px-2 text-center"},ot={class:"border border-gray-300 px-2 text-center"},ct={__name:"OvertimeDataList",props:{user:Object,onUpdate:{type:Function,default:null}},setup(o){te(),se();const c=re(),m=R(),u=oe(),f=o,p=async()=>{f.onUpdate?await f.onUpdate():await u.fetchCountNotifications()},x=D(()=>(m.overtimes||[]).reduce((t,r)=>t+(Number(r==null?void 0:r.working_hours)||0),0)),S=D(()=>(m.overtimes||[]).reduce((t,r)=>t+(Number(r==null?void 0:r.request_overtime_hours)||0),0)),k=D(()=>(m.overtimes||[]).reduce((t,r)=>t+(Number(r==null?void 0:r.approval_overtime_hours)||0),0));return(_,t)=>{var i,a,v,C,O,$,L,N,j,H,M,T,U,q,P,E;const r=ne("RouterLink");return l(),d("div",we,[e("div",Se,[e("div",Ae,[(i=o.user)!=null&&i.employee_id?(l(),d("p",De,[t[0]||(t[0]=e("span",{class:"text-gray-400"},"Employee ID:",-1)),e("strong",Be,n(((a=o.user)==null?void 0:a.employee_id)||"N/A"),1)])):b("",!0),(v=o.user)!=null&&v.name?(l(),d("p",Re,[t[1]||(t[1]=e("span",{class:"text-gray-400"},"Name:",-1)),e("strong",Ce,n((C=o.user)==null?void 0:C.name),1)])):b("",!0),($=(O=o.user)==null?void 0:O.designation)!=null&&$.title?(l(),d("p",Oe,[t[2]||(t[2]=e("span",{class:"text-gray-400"},"Designation:",-1)),e("strong",$e,n(((N=(L=o.user)==null?void 0:L.designation)==null?void 0:N.title)||"N/A"),1)])):b("",!0),(H=(j=o.user)==null?void 0:j.department)!=null&&H.name?(l(),d("p",Le,[t[3]||(t[3]=e("span",{class:"text-gray-400"},"Department:",-1)),e("strong",Ne,n(((T=(M=o.user)==null?void 0:M.department)==null?void 0:T.name)||"N/A"),1)])):b("",!0),(U=o.user)!=null&&U.phone?(l(),d("p",je,[t[4]||(t[4]=e("span",{class:"text-gray-400"},"Phone:",-1)),e("strong",He,n((q=o.user)==null?void 0:q.phone),1)])):b("",!0)])]),e("div",Me,[e("table",Te,[t[11]||(t[11]=e("thead",null,[e("tr",{class:"bg-gray-200 *:py-1"},[e("th",{class:"border border-gray-300 px-2 text-center"},"#"),e("th",{class:"border border-gray-300 px-2 text-center"},"Applied Date"),e("th",{class:"border border-gray-300 px-2 text-center"},"Date"),e("th",{class:"border border-gray-300 px-2 text-center"},"Type"),e("th",{class:"border border-gray-300 px-2 text-center"},"Shift"),e("th",{class:"border border-gray-300 px-2 text-center"},"Check-In"),e("th",{class:"border border-gray-300 px-2 text-center"},"Check-Out"),e("th",{class:"border border-gray-300 px-2 text-center"},"Working (hour)"),e("th",{class:"border border-gray-300 px-2 text-center"},"Request (hour)"),e("th",{class:"border border-gray-300 px-2 text-center"},"Approved (hour)"),e("th",{class:"border border-gray-300 px-2 text-center"},"Details"),e("th",{class:"border border-gray-300 px-2 text-center"},"Status"),e("th",{class:"border border-gray-300 px-2 text-center"},"Action")])],-1)),e("tbody",null,[(l(!0),d(B,null,ae(y(m).overtimes,(s,ee)=>{var V,F,I,z,G,K,W,J,Q;return l(),d("tr",{key:s==null?void 0:s.id,class:"border-b border-gray-200 hover:bg-blue-200 *:py-2"},[e("td",Ue,n(ee+1),1),e("td",qe,n(new Date(s.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})),1),e("td",Pe,n(new Date(s.date).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})),1),e("td",Ee,n(s.duty_type),1),e("td",Ve,n(s.shift),1),e("td",Fe,n(s.check_in||"- : -"),1),e("td",Ie,n(s.check_out||"- : -"),1),e("td",ze,[g(w,{workingHours:s.working_hours},null,8,["workingHours"])]),e("td",Ge,[g(w,{workingHours:s.request_overtime_hours},null,8,["workingHours"])]),e("td",{class:le(["border border-gray-300 px-2 text-center",{"bg-red-500/50":!s.approval_overtime_hours&&(s.recommend_by_user_id===((V=y(c).user)==null?void 0:V.id)||((I=(F=y(u).applicationApprovalPermissions)==null?void 0:F[s.id])==null?void 0:I.allow_recommend_by))}])},[e("div",Ke,[g(w,{workingHours:s.approval_overtime_hours},null,8,["workingHours"]),s.recommend_by_user_id===((z=y(c).user)==null?void 0:z.id)||(K=(G=y(u).applicationApprovalPermissions)==null?void 0:G[s.id])!=null&&K.allow_recommend_by?(l(),ie(ke,{key:0,overtime:s,onSuccess:p},null,8,["overtime"])):b("",!0)])],2),e("td",We,n(s.work_details||""),1),e("td",Je,n(s.status||"Pending"),1),e("td",Qe,[e("div",Xe,[(s.recommend_by_user_id===((W=y(c).user)==null?void 0:W.id)?(s.approval_overtime_hours??null)&&Object.values(((J=y(u).applicationApprovalPermissions)==null?void 0:J[s.id])||{}).some(A=>A):Object.values(((Q=y(u).applicationApprovalPermissions)==null?void 0:Q[s.id])||{}).some(A=>A))?(l(),d("div",Ye,[g(ce,{class:"ml-auto",notificationType:"overtime_applications",applicationId:s.id,onSuccess:p,variant:1},null,8,["applicationId"])])):b("",!0),g(r,{to:{name:"MyOvertimeShow",params:{id:s.id}},class:"text-blue-800"},{default:de(()=>t[5]||(t[5]=[e("i",{class:"far fa-eye text-lg"},null,-1)])),_:2,__:[5]},1032,["to"]),g(xe,{overtime:s,onSuccess:p},null,8,["overtime"])])])])}),128)),((P=y(m).overtimes)==null?void 0:P.length)===0?(l(),d("tr",Ze,t[6]||(t[6]=[e("td",{colspan:"100",class:"p-2 text-center text-red-500"},"No overtimes found",-1)]))):b("",!0)]),(E=y(m).overtimes)!=null&&E.length?(l(),d("tfoot",et,[e("tr",tt,[t[7]||(t[7]=e("td",{class:"border border-gray-300 px-2 text-right",colspan:"7"},"Totals",-1)),e("td",st,n(x.value),1),e("td",rt,[g(w,{workingHours:S.value},null,8,["workingHours"])]),e("td",ot,[g(w,{workingHours:k.value},null,8,["workingHours"])]),t[8]||(t[8]=e("td",{class:"border border-gray-300 px-2 text-center"},"—",-1)),t[9]||(t[9]=e("td",{class:"border border-gray-300 px-2 text-center"},"—",-1)),t[10]||(t[10]=e("td",{class:"border border-gray-300 px-2 text-center"},"—",-1))])])):b("",!0)])])])}}};export{ct as _};
