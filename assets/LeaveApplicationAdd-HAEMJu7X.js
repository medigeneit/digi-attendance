import{u as S,r as p,b as U,H as V,c as s,a,k as A,w as T,d,z as b,F as c,q as k,h as w,v as u,t as m,e as g,o,g as q}from"./index-2dxYNZtw.js";import{u as E}from"./leave-application-D-PBEqJ6.js";import{u as M}from"./leave-type-CHeQeD76.js";import{u as D}from"./user--boy4QJ0.js";import{L as F}from"./LoaderView-ptcXWp6u.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"max-w-3xl mx-auto p-4 bg-white shadow-md rounded-md space-y-4"},B={key:0,class:"text-center"},N=["value"],O=["value"],R={key:0,class:"text-red-500 text-sm"},K={__name:"LeaveApplicationAdd",setup(j){const x=q(),L=E(),f=M(),y=D(),n=S(),l=p({leave_type_id:"",start_date:"",end_date:"",reason:"",works_in_hand:"",handover_user_id:""}),v=p(!1),i=p(null),_=async()=>{var r;v.value=!0,i.value=null;try{const e={user_id:(r=n==null?void 0:n.user)==null?void 0:r.id,...l.value};await L.storeLeaveApplication(e),alert("Leave application submitted successfully!"),x.push({name:"MyLeaveApplications"})}catch(e){i.value=e.message||"Failed to submit leave application"}finally{v.value=!1}};return U(()=>{V(()=>{var e;const r=(e=n==null?void 0:n.user)==null?void 0:e.company_id;r&&f.fetchLeaveTypes(r)}),y.fetchUsers()}),(r,e)=>(o(),s("div",H,[e[15]||(e[15]=a("h1",{class:"title-md text-center"},"Leave Application Form",-1)),v.value?(o(),s("div",B,[A(F)])):(o(),s("form",{key:1,onSubmit:T(_,["prevent"]),class:"space-y-4"},[a("div",null,[e[7]||(e[7]=a("label",{for:"leave-type",class:"block text-sm font-medium"},"Leave Type",-1)),d(a("select",{id:"leave-type","onUpdate:modelValue":e[0]||(e[0]=t=>l.value.leave_type_id=t),class:"input-1 w-full",required:""},[e[6]||(e[6]=a("option",{value:""},"Select Leave Type",-1)),(o(!0),s(c,null,k(w(f).leaveTypes,t=>(o(),s("option",{key:t.id,value:t.id},m(t==null?void 0:t.name),9,N))),128))],512),[[b,l.value.leave_type_id]])]),a("div",null,[e[8]||(e[8]=a("label",{for:"start-date",class:"block text-sm font-medium"},"Start Date",-1)),d(a("input",{type:"date",id:"start-date","onUpdate:modelValue":e[1]||(e[1]=t=>l.value.start_date=t),class:"input-1 w-full",required:""},null,512),[[u,l.value.start_date]])]),a("div",null,[e[9]||(e[9]=a("label",{for:"end-date",class:"block text-sm font-medium"},"End Date",-1)),d(a("input",{type:"date",id:"end-date","onUpdate:modelValue":e[2]||(e[2]=t=>l.value.end_date=t),class:"input-1 w-full",required:""},null,512),[[u,l.value.end_date]])]),a("div",null,[e[10]||(e[10]=a("label",{for:"reason",class:"block text-sm font-medium"},"Reason (Optional)",-1)),d(a("textarea",{id:"reason","onUpdate:modelValue":e[3]||(e[3]=t=>l.value.reason=t),class:"input-1 w-full",placeholder:"Enter your reason for leave"},null,512),[[u,l.value.reason]])]),a("div",null,[e[11]||(e[11]=a("label",{for:"works-in-hand",class:"block text-sm font-medium"},"Works in Hand (Optional)",-1)),d(a("textarea",{id:"works-in-hand","onUpdate:modelValue":e[4]||(e[4]=t=>l.value.works_in_hand=t),class:"input-1 w-full",placeholder:"Enter details of works in hand"},null,512),[[u,l.value.works_in_hand]])]),a("div",null,[e[13]||(e[13]=a("label",{for:"handover-user",class:"block text-sm font-medium"},"Handover User",-1)),d(a("select",{id:"handover-user","onUpdate:modelValue":e[5]||(e[5]=t=>l.value.handover_user_id=t),class:"input-1 w-full",required:""},[e[12]||(e[12]=a("option",{value:""},"Select Handover User",-1)),(o(!0),s(c,null,k(w(y).users,t=>(o(),s("option",{key:t.id,value:t.id},m(t==null?void 0:t.name),9,O))),128))],512),[[b,l.value.handover_user_id]])]),i.value?(o(),s("div",R,m(i.value),1)):g("",!0),e[14]||(e[14]=a("div",{class:"flex justify-end"},[a("button",{type:"submit",class:"btn-2"},"Submit")],-1))],32))]))}};export{K as default};
