import{u as V}from"./leave-approval-D_J7ePLU.js";import{r as g,y as j,i as U,b as D,o as n,c as d,a as e,t as r,w as F,d as B,v as O,F as L,q as k,z as q,h as w,e as I,x as z,k as b}from"./index-B4ZWr-Ut.js";import{u as R}from"./user--1MYI6TX.js";import{_ as T,a as G}from"./HeaderWithButtons-DTczmryT.js";import{L as H}from"./LoaderView-XOtHt-jl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50"},K={class:"bg-white rounded-lg shadow-lg w-full max-w-lg"},P={class:"px-6 py-4 border-b"},Q={class:"text-lg font-bold"},W=["for"],X=["id","onUpdate:modelValue"],Y=["value"],Z={class:"flex justify-end space-x-4"},ee={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},te={__name:"LeaveApprovalModal",props:{show:{type:Boolean,required:!0},leaveApproval:{type:Object,default:null}},emits:["close","save"],setup(A,{emit:i}){const p=A,u=i,_=R(),o=g(!1),l=j({id:null,name:"",in_charge_user_id:"",coordinator_user_id:"",operational_admin_user_id:"",recommend_by_user_id:"",approved_by_user_id:""}),y=()=>{Object.assign(l,{id:null,name:"",in_charge_user_id:"",coordinator_user_id:"",operational_admin_user_id:"",recommend_by_user_id:"",approved_by_user_id:""}),o.value=!1};U(()=>p.leaveApproval,v=>{v?(o.value=!0,Object.assign(l,v)):y()},{immediate:!0,deep:!0});const f=()=>{if(!l.name||!l.approved_by_user_id){alert("Name and Approved By are required!");return}u("save",{...l}),h()},h=()=>{y(),u("close")};return D(()=>{_.fetchUsers()}),(v,c)=>A.show?(n(),d("div",J,[e("div",K,[e("div",P,[e("h3",Q,r(o.value?"Edit Leave Approval":"Add Leave Approval"),1)]),e("form",{onSubmit:F(f,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[c[1]||(c[1]=e("label",{for:"name",class:"block text-sm font-medium"},"Approval Name",-1)),B(e("input",{id:"name","onUpdate:modelValue":c[0]||(c[0]=m=>l.name=m),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter approval name",required:""},null,512),[[O,l.name]])]),(n(),d(L,null,k({in_charge_user_id:"In-Charge",coordinator_user_id:"Coordinator",operational_admin_user_id:"Operational Admin",recommend_by_user_id:"Recommend By",approved_by_user_id:"Approved By"},(m,t)=>e("div",{key:t},[e("label",{for:t,class:"block text-sm font-medium"},r(m),9,W),B(e("select",{id:t,"onUpdate:modelValue":s=>l[t]=s,class:"w-full border rounded px-3 py-2"},[c[2]||(c[2]=e("option",{value:""},"-- N/A --",-1)),(n(!0),d(L,null,k(w(_).users||[],s=>(n(),d("option",{key:s.id,value:s.id},r(s.name),9,Y))),128))],8,X),[[q,l[t]]])])),64)),e("div",Z,[e("button",{type:"button",onClick:h,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400"}," Cancel "),e("button",ee,r(o.value?"Update":"Create"),1)])],32)])])):I("",!0)}},se={class:"my-container space-y-2"},oe={class:"overflow-x-auto"},ae={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},le={class:"text-gray-600 text-sm"},re={key:0},ne={colspan:"8"},de={class:"py-3 px-2 text-left"},ie={class:"py-3 px-2 text-left"},ce={class:"py-3 px-2 text-left"},pe={class:"py-3 px-2 text-left"},ue={class:"py-3 px-2 text-left"},_e={class:"py-3 px-2 text-left"},ve={class:"py-3 px-2 text-left"},me={class:"py-3 px-2 text-center"},ye={class:"flex justify-center gap-4"},fe=["onClick"],he=["onClick"],xe={key:2},Ce={__name:"LeaveApprovalList",setup(A){const i=V(),p=z(),u=g(!1),_=g(!1),o=g(null),l=()=>{o.value=null,u.value=!0},y=t=>{o.value={...t},u.value=!0},f=()=>{u.value=!1},h=t=>{o.value=t,_.value=!0},v=()=>{_.value=!1},c=async()=>{var t;if(!((t=o.value)!=null&&t.id)){p.error("Invalid leave approval selected for deletion!");return}try{await i.deleteLeaveApproval(o.value.id),p.success("Leave approval deleted successfully!")}catch(s){p.error("Failed to delete leave approval!"),console.error("Error deleting leave approval:",s)}finally{v()}},m=async t=>{const s=t.id?"updateLeaveApproval":"createLeaveApproval",x=t.id?"Leave approval updated successfully!":"Leave approval added successfully!";try{await i[s](t.id||t,t),p.success(x)}catch(a){p.error("Failed to save leave approval!"),console.error("Error saving leave approval:",a)}finally{f()}};return D(()=>{i.fetchLeaveApprovals()}),(t,s)=>{var x;return n(),d("div",se,[b(G,{title:"Leave Approvals",onAdd:l}),e("div",oe,[e("table",ae,[s[3]||(s[3]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"#"),e("th",{class:"py-3 px-2 text-left"},"Name"),e("th",{class:"py-3 px-2 text-left"},"In-Charge"),e("th",{class:"py-3 px-2 text-left"},"Coordinator"),e("th",{class:"py-3 px-2 text-left"},"Operational Admin"),e("th",{class:"py-3 px-2 text-left"},"Recommend By"),e("th",{class:"py-3 px-2 text-left"},"Approved By"),e("th",{class:"py-3 px-2 text-center"},"Actions")])],-1)),e("tbody",le,[w(i).loading?(n(),d("tr",re,[e("td",ne,[b(H,{class:"shadow-none"})])])):w(i).leaveApprovals.length?(n(!0),d(L,{key:1},k(w(i).leaveApprovals,a=>{var C,M,$,N,S;return n(),d("tr",{key:a.id,class:"border-b border-gray-200 hover:bg-gray-100"},[e("td",de,r(a.id),1),e("td",ie,r(a.name),1),e("td",ce,r(((C=a.in_charge_user)==null?void 0:C.name)||"N/A"),1),e("td",pe,r(((M=a.coordinator_user)==null?void 0:M.name)||"N/A"),1),e("td",ue,r((($=a.operational_admin_user)==null?void 0:$.name)||"N/A"),1),e("td",_e,r(((N=a.recommend_by_user)==null?void 0:N.name)||"N/A"),1),e("td",ve,r(((S=a.approved_by_user)==null?void 0:S.name)||"N/A"),1),e("td",me,[e("div",ye,[e("button",{onClick:E=>y(a),class:"text-blue-600 hover:text-blue-800"},s[0]||(s[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,fe),e("button",{onClick:E=>h(a),class:"text-red-600 hover:text-red-800"},s[1]||(s[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,he)])])])}),128)):(n(),d("tr",xe,s[2]||(s[2]=[e("td",{colspan:"8",class:"text-center text-red-500 py-4"},"No leave approvals found",-1)])))])])]),b(te,{show:u.value,leaveApproval:o.value,onClose:f,onSave:m},null,8,["show","leaveApproval"]),b(T,{show:_.value,title:"Delete Leave Approval",message:`Are you sure you want to delete ${(x=o.value)==null?void 0:x.name}?`,onClose:v,onConfirm:c},null,8,["show","message"])])}}};export{Ce as default};
