import{_ as O}from"./EmployeeFilter-CwojabHr.js";import{_ as $}from"./FlexibleDatePicker-Ctngj8Mt.js";import{L as C}from"./LoaderView-DdmIZnyR.js";import{_ as L}from"./OvertimeDataList-CZ7dzTD7.js";import{u as V,f as D,ad as F,r as s,x as h,h as j,q as g,c as x,o as u,a as l,j as b,k,d as q,m as A,n as I}from"./index-BFXrp91U.js";import{u as R}from"./overtime-Ji5Wmino.js";import{u as E}from"./user-CdzNHlTX.js";import"./company-DAjC-VJ4.js";import"./department-B41L3mvI.js";import"./EmployeeDropdownInput-msVp7K5L.js";import"./SelectDropdown-BixApdfD.js";import"./UserChip-Bj6jC9y1.js";import"./AcceptAndRejectHandler-BDbtmOSo.js";import"./DisplayFormattedWorkingHours-DyjGbxl7.js";import"./TimePickerAsFloatHour-B9Now32u.js";const P={class:"px-4 space-y-4"},Y={class:"flex flex-wrap gap-2 p-3 rounded-2xl border border-white/20 bg-white/60 backdrop-blur-md shadow-sm supports-[backdrop-filter]:bg-white/50 sticky top-14"},z={key:2},ne={__name:"OvertimeList",setup(G){const d=V(),i=D(),U=F(),m=R(),v=E(),y=s(!1),n=s(null),c=i.query.date||new Date().toISOString().slice(0,7),S=t=>t.toString().padStart(2,"0"),r=s({year:Number(c.split("-")[0]||new Date().getFullYear()),month:Number(c.split("-")[1]||new Date().getMonth()+1),day:1}),_=h(()=>{var t,e;return!((t=r.value)!=null&&t.year)||!((e=r.value)!=null&&e.month)?"":`${r.value.year}-${S(r.value.month)}`}),M=s(c),a=s({company_id:i.query.company_id||"",department_id:i.query.department_id||"all",line_type:i.query.line_type||"all",employee_id:i.query.employee_id||"",category:""});j(async()=>{if(a.value.employee_id){y.value=!0;try{await f(a.value.employee_id),await p()}catch(t){console.log(t)}y.value=!1}});const f=async t=>{t?(await v.fetchUser(t),n.value=v.user):n.value=null},w=h(()=>{var t;return((t=m.overtimes)==null?void 0:t.map(e=>e.id))||[]}),p=async()=>{var e;const t=_.value;a.value.employee_id&&t&&(await m.fetchUserMonthlyOvertimes(a.value.employee_id,t),(e=w.value)!=null&&e.length&&await U.fetchApprovalPermissionsByUserApplicationIds("overtime_applications",w.value))};g(_,t=>{t&&(M.value=t,d.replace({query:{...i.query,date:t}}),p())}),g(()=>a.value.employee_id,async(t,e)=>{t&&t!==e&&(await f(t),await p())});const B=()=>d.go(-1),N=()=>{d.replace({query:{...i.query,company_id:a.value.company_id,department_id:a.value.department_id,line_type:a.value.line_type,employee_id:a.value.employee_id||i.query.employee_id}})};return(t,e)=>(u(),x("div",P,[l("div",{class:"flex items-center justify-between gap-2"},[l("button",{class:"btn-3",onClick:B},e[5]||(e[5]=[l("i",{class:"far fa-arrow-left"},null,-1),l("span",{class:"hidden md:flex"},"Back",-1)])),e[6]||(e[6]=l("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Overtime",-1)),e[7]||(e[7]=l("div",null,null,-1))]),l("div",Y,[q(O,{company_id:a.value.company_id,"onUpdate:company_id":e[1]||(e[1]=o=>a.value.company_id=o),department_id:a.value.department_id,"onUpdate:department_id":e[2]||(e[2]=o=>a.value.department_id=o),employee_id:a.value.employee_id,"onUpdate:employee_id":e[3]||(e[3]=o=>a.value.employee_id=o),line_type:a.value.line_type,"onUpdate:line_type":e[4]||(e[4]=o=>a.value.line_type=o),"with-type":!0,"initial-value":t.$route.query,onFilterChange:N},{default:A(()=>[q($,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),"show-year":!1,"show-month":!0,"show-date":!1,label:"Month"},null,8,["modelValue"])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"])]),I(m).isLoading||y.value?(u(),b(C,{key:0})):n.value?(u(),b(L,{key:1,user:n.value,onUpdate:p},null,8,["user"])):k("",!0),n.value?k("",!0):(u(),x("div",z,e[8]||(e[8]=[l("p",{class:"text-gray-400 text-center text-2xl italic"},"Select an employee, please.",-1)])))]))}};export{ne as default};
