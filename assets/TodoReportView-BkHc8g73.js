import{_ as Ge,r as E,G as Be,x as T,q as Y,c as l,o as a,a as e,O as Ee,w as X,s as D,d as ee,l as Pe,v as Le,f as et,u as tt,D as je,h as le,y as Oe,k as b,j as st,m as G,n as B,t as i,F as S,e as O,b as z,N as nt}from"./index-Dd37oRPB.js";import{L as at}from"./LoaderView-HV2j_91p.js";import{_ as rt}from"./EmployeeFilter-B0pTLoVr.js";import{U as ot}from"./UserChip-Cj7gj4fc.js";import{g as Ue,b as Q}from"./datetime-Du_mcDA9.js";import{j as lt}from"./url-Buz9GlSr.js";import{u as dt}from"./attendance-CHtOwCCj.js";import{u as it}from"./company-D6mBZvtW.js";import{u as pt}from"./department-CHxUAo8j.js";import{u as ut}from"./useTodoDateStore-FolDTyO4.js";import"./EmployeeDropdownInput-CNBiluhJ.js";import"./SelectDropdown-BfrvBdyv.js";import"./user-CUsMlcV0.js";const mt={class:"px-4 py-4 md:py-3 bg-white rounded-md border"},ct={class:"flex flex-wrap items-center gap-3"},yt=["disabled"],gt={class:"print-hide"},xt={class:"flex flex-col md:flex-row flex-wrap items-end md:ml-auto w-full md:w-auto gap-x-3 gap-y-4 print-hide"},bt={class:"flex items-center justify-between w-full md:w-auto gap-3"},ft={class:"relative h-[32px] w-[150px] sm:w-[170px]"},vt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},wt={__name:"TodoReportHeading",props:{loading:{type:Boolean,default:!1},companyId:{type:[String,Number],default:""},departmentId:{type:[String,Number],default:""},employeeId:{type:[String,Number],default:""},lineType:{type:String,default:"all"},startDate:{type:String,default:""},endDate:{type:String,default:""}},emits:["reloadClick","change"],setup(M,{expose:R,emit:te}){const m=M,L=E(null),V=te,u=Be({companyId:String(m.companyId||""),departmentId:m.departmentId!==""&&m.departmentId!=null?String(m.departmentId):"",employeeId:String(m.employeeId||""),lineType:m.lineType||"all",startDate:m.startDate||"",endDate:m.endDate||""}),F=T(()=>({companyId:u.companyId,departmentId:u.departmentId,employeeId:u.employeeId,lineType:u.lineType,startDate:u.startDate,endDate:u.endDate}));function Z(){V("change",{...F.value})}Y(()=>[m.companyId,m.departmentId,m.employeeId,m.lineType,m.startDate,m.endDate],()=>{u.companyId=String(m.companyId||""),u.departmentId=m.departmentId!==""&&m.departmentId!=null?String(m.departmentId):"",u.employeeId=String(m.employeeId||""),u.lineType=m.lineType||"all",u.startDate=m.startDate||"",u.endDate=m.endDate||""});function H(s){const p=new Date(u.startDate);p.setDate(p.getDate()+s),u.startDate=p.toISOString().split("T")[0];const g=new Date(u.endDate);g.setDate(g.getDate()+s),u.endDate=g.toISOString().split("T")[0]}return Y(F,Z,{deep:!0}),R({employees:T(()=>{var s;return((s=L.value)==null?void 0:s.employees)||[]})}),(s,p)=>(a(),l("div",mt,[e("div",ct,[Ee(s.$slots,"before",{},void 0,!0),e("button",{class:D(["btn-icon print-hide",{"animate-spin !bg-opacity-0":M.loading}]),onClick:p[0]||(p[0]=X(g=>V("reloadClick"),["prevent"])),disabled:M.loading,title:"Reload"},[e("i",{class:D(["fas fa-redo",[M.loading?"text-gray-400":"text-gray-500"]])},null,2)],10,yt),e("span",gt,[Ee(s.$slots,"after",{},void 0,!0)]),e("div",xt,[ee(rt,{ref_key:"employeeFilterRef",ref:L,company_id:u.companyId,"onUpdate:company_id":p[1]||(p[1]=g=>u.companyId=g),department_id:u.departmentId,"onUpdate:department_id":p[2]||(p[2]=g=>u.departmentId=g),employee_id:u.employeeId,"onUpdate:employee_id":p[3]||(p[3]=g=>u.employeeId=g),line_type:u.lineType,"onUpdate:line_type":p[4]||(p[4]=g=>u.lineType=g),"with-type":!0,class:"flex-1 gap-y-4 md:flex items-center justify-between w-full md:w-auto"},null,8,["company_id","department_id","employee_id","line_type"]),e("div",bt,[e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:p[5]||(p[5]=X(()=>H(-1),["prevent"]))},p[9]||(p[9]=[e("span",{class:"fas fa-arrow-left"},null,-1)])),e("div",ft,[p[10]||(p[10]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Start Date",-1)),Pe(e("input",{type:"date","onUpdate:modelValue":p[6]||(p[6]=g=>u.startDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Le,u.startDate]])]),e("div",vt,[p[11]||(p[11]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"End Date",-1)),Pe(e("input",{type:"date","onUpdate:modelValue":p[7]||(p[7]=g=>u.endDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Le,u.endDate]])]),e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:p[8]||(p[8]=X(()=>H(1),["prevent"]))},p[12]||(p[12]=[e("span",{class:"fas fa-arrow-right"},null,-1)]))])])])]))}},ht=Ge(wt,[["__scopeId","data-v-c25b1fcb"]]),_t={class:"container print:flex-grow mx-auto print:w-full print:px-0 print:py-0"},Dt=["disabled"],kt={key:0,class:"bg-white border rounded-md mb-2 p-4 text-sm print:border-0 print:mb-2 print:px-0 print:w-full relative overflow-visible z-40"},Tt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-y-2 gap-x-6"},It={class:"font-medium text-gray-800"},St={class:"col-span-2"},Nt={class:"font-medium text-gray-800"},$t={class:"inline-flex items-center gap-5 font-bold"},At={class:"text-gray-700"},Ct={key:0,class:"mt-2 w-[280px] sm:w-[320px] lg:w-[280px] xl:w-[320px] bg-white border border-gray-200 rounded-md p-3 shadow-lg text-left absolute right-0"},Rt={class:"flex items-center justify-between mb-2"},Et={class:"text-[11px] text-gray-500"},Pt={class:"space-y-3 max-h-56 overflow-auto pr-1 z-50"},Lt={class:"pt-2 border-t border-dashed border-gray-200"},jt={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1 flex items-center justify-between"},Ot={class:"flex items-center gap-2"},Ut={key:0,class:"bg-red-500 rounded-md px-1.5 text-white text-center"},Bt={key:0,class:"flex flex-wrap gap-2 mb-3"},zt={key:0,class:"text-xs text-gray-400"},Mt=["title"],Vt={class:"block max-w-[160px] truncate"},Ft={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1 flex items-center justify-between mt-3"},Ht={class:"flex items-center gap-2"},Wt={key:0,class:"bg-amber-500 rounded-md px-1.5 text-white text-center"},Kt={key:1,class:"flex flex-wrap gap-2"},Jt={key:0,class:"text-xs text-gray-400"},Qt=["title"],Yt={class:"block max-w-[160px] truncate"},Xt={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1 mt-3"},Zt={key:0,class:"bg-green-500 rounded-md px-1.5 text-white text-center"},qt={class:"flex flex-wrap gap-2"},Gt={key:0,class:"text-xs text-gray-400"},es=["title"],ts={class:"block max-w-[160px] truncate"},ss={key:1,class:"text-center text-gray-500 py-12 border bg-gray-50 rounded-md min-h-[70vh] flex flex-col items-center justify-center space-y-4"},ns={key:3,class:"overflow-x-auto md:overflow-clip bg-white border border-t-0 rounded-md shadow-sm print:shadow-none print:rounded-none print:border-gray-400"},as={class:"min-w-full text-left text-sm border-separate border-spacing-0"},rs={class:"bg-gray-50 text-gray-600 uppercase tracking-wide text-xs"},os={class:"border-y print:border-gray-400 sticky md:top-[123px] z-30 rounded-t-md"},ls={class:"px-4 py-3 border md:w-[100px] print:w-auto print:border-l print:border-l-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center whitespace-nowrap"},ds={class:"flex items-center justify-between gap-2"},is={class:"ml-1 text-[10px] text-gray-500"},ps={key:0,class:"px-4 py-3 border bg-white bg-opacity-70 backdrop-blur-sm text-center"},us={class:"divide-y divide-gray-200"},ms={key:0},cs=["colspan"],ys=["rowspan"],gs={class:"sticky top-[180px] bg-white text-center"},xs=["rowspan"],bs=["user"],fs={key:0,class:"flex items-center gap-3"},vs={class:"font-semibold text-gray-800"},ws=["href"],hs={class:"text-xs text-gray-500"},_s=["rowspan"],Ds={class:"sticky top-[180px] bg-white"},ks={key:0,class:"text-[11px] text-gray-500 mt-2"},Ts={key:0,class:"grid grid-cols-2 gap-4"},Is={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},Ss={class:"flex gap-1 items-center justify-between"},Ns={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},$s={class:"flex gap-1 items-center justify-between"},As={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},Cs={class:"flex gap-1 items-center justify-between"},Rs={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},Es={class:"flex gap-1 items-center justify-between"},Ps={key:1,class:"mt-1 text-gray-500 text-center"},Ls=["rowspan"],js={class:"sticky top-[180px] bg-white"},Os={class:"font-medium"},Us={class:"text-gray-400 mr-2"},Bs={class:"text-xs text-gray-500 mt-1 flex flex-wrap gap-2"},zs={key:0,class:"font-semibold text-blue-600"},Ms={key:1},de="border-b-2 border-b-blue-200",tn={__name:"TodoReportView",setup(M){var be,fe,ve,we,he,_e;const R=et(),te=tt(),m=ut(),L=it(),V=pt(),{companies:u}=je(L),{departments:F}=je(V),Z=E(null),H=Ue(new Date),s=Be({companyId:((be=R.query)==null?void 0:be.company_id)||"",departmentId:((fe=R.query)==null?void 0:fe.department_id)||"",employeeId:((ve=R.query)==null?void 0:ve.employee_id)||"",lineType:((we=R.query)==null?void 0:we.line_type)||"all",startDate:((he=R.query)==null?void 0:he.start_date)||H,endDate:((_e=R.query)==null?void 0:_e.end_date)||H}),p=T(()=>{if(!s.startDate||!s.endDate)return[];const n=new Date(s.startDate),t=new Date(s.endDate);if(Number.isNaN(n.getTime())||Number.isNaN(t.getTime()))return[];const r=n<=t?1:-1,d=new Date(n),c=[];for(;c.push(Ue(d)),d.getTime()!==t.getTime();)d.setDate(d.getDate()+r);return c}),g=T(()=>{var t;return[...((t=Z.value)==null?void 0:t.employees)||[]].filter(r=>s.employeeId?String(r.id)===String(s.employeeId):!0).sort((r,d)=>{var c,w;return(((c=r.user)==null?void 0:c.name)||"").localeCompare(((w=d.user)==null?void 0:w.name)||"")}).map(r=>{const d=m.todo_dates.filter(x=>{var v;return String((v=x.user)==null?void 0:v.id)===String(r.id)});let c=p.value.map(x=>{const v={WORKING:1,PENDING:2,DEPENDANT:3,COMPLETED:4,BACK_LOG:5},o=d.filter(I=>I.date===x).sort((I,N)=>{const $=v[I.status]||999,h=v[N.status]||999;return $!==h?$-h:(I.priority||0)-(N.priority||0)});return o.length?{date:x,rowSpan:o.length,todos:o}:{date:x,rowSpan:1,todos:[{id:`empty-${r.id}-${x}`,isPlaceholder:!0,title:"",date:x}]}});c.length||(c=[{date:null,rowSpan:1,todos:[{id:`empty-${r.id}`,isPlaceholder:!0,title:""}]}]);const w=c.reduce((x,v)=>x+v.rowSpan,0);return{user:r,dates:c,rowSpan:Math.max(1,w)}})}),ze=T(()=>{if(!s.startDate||!s.endDate)return"";const n=Q(s.startDate,{weekDay:"long"}),t=Q(s.endDate,{weekDay:"long"});return`${n} ~ ${t}`}),Me=T(()=>L.employees||[]),Ve={all:"All Types",executive:"Executive",support_staff:"Support Staff",doctor:"Doctor",academy_body:"Academy Body"},P=T(()=>{var c,w,x,v,o,I,N,$;const n=s.companyId&&((c=u.value)!=null&&c.length)?(w=u.value.find(h=>String(h.id)===String(s.companyId)))==null?void 0:w.name:null,t=s.departmentId&&((x=F.value)!=null&&x.length)?(v=F.value.find(h=>String(h.id)===String(s.departmentId)))==null?void 0:v.name:null;let r=null;s.employeeId&&(r=((I=(o=Me.value)==null?void 0:o.find(h=>String(h.id)===String(s.employeeId)))==null?void 0:I.name)||(($=(N=g.value.find(h=>{var y;return String(((y=h.user)==null?void 0:y.id)||"")===String(s.employeeId)}))==null?void 0:N.user)==null?void 0:$.name)||null);const d=s.startDate===s.endDate&&s.startDate?Q(s.startDate,{weekDay:"long"}):ze.value||"-";return{company:n||(s.companyId?`#${s.companyId}`:"All Companies"),department:t||(s.departmentId?`#${s.departmentId}`:"All Departments"),employee:r||(s.employeeId?`#${s.employeeId}`:"All Employees"),lineType:Ve[s.lineType]||s.lineType||"All Types",dateRange:d}}),U=E(!1),se=E(null),ie=T(()=>{var n;return((n=g.value)==null?void 0:n.length)||0}),pe=T(()=>{var n,t;return((t=(n=f.value)==null?void 0:n.withTodos)==null?void 0:t.length)||0}),ue=T(()=>{var n,t,r,d;return(((t=(n=f.value)==null?void 0:n.withTodos)==null?void 0:t.length)||0)+(((d=(r=f.value)==null?void 0:r.withoutTodosPresent)==null?void 0:d.length)||0)}),W=E(!0),ne=E(!1),K=E(!1),ae=E(null),me=n=>{U.value&&se.value&&(se.value.contains(n.target)||(U.value=!1))},f=T(()=>{var t;if(!((t=g.value)!=null&&t.length))return{withTodos:[],withoutTodosPresent:[],withoutTodosAbsent:[]};const n=p.value;return g.value.reduce((r,d,c)=>{var v,o,I,N,$,h;const w=d.dates.reduce((y,A)=>y+A.todos.filter(j=>!j.isPlaceholder).length,0),x={id:((v=d.user)==null?void 0:v.id)??((o=d.user)==null?void 0:o.user_id)??((I=d.user)==null?void 0:I.uid)??((N=d.user)==null?void 0:N.email)??`${(($=d.user)==null?void 0:$.name)||"unknown"}-${c}`,name:((h=d.user)==null?void 0:h.name)||"Unknown user"};if(w>0)r.withTodos.push(x);else{let y=!1;n.forEach(A=>{var _;const j=xe((_=d.user)==null?void 0:_.id,A);j.hasData&&j.comment!=="Absent"&&(y=!0)}),y?r.withoutTodosPresent.push(x):r.withoutTodosAbsent.push(x)}return r},{withTodos:[],withoutTodosPresent:[],withoutTodosAbsent:[]})}),ce=T(()=>{if(!K.value)return g.value;const n=new Set([...f.value.withoutTodosPresent||[],...f.value.withoutTodosAbsent||[]].map(t=>String(t.id??t.name??"")));return g.value.filter(t=>{var d,c,w,x,v;const r=((d=t.user)==null?void 0:d.id)??((c=t.user)==null?void 0:c.user_id)??((w=t.user)==null?void 0:w.uid)??((x=t.user)==null?void 0:x.email)??((v=t.user)==null?void 0:v.name)??"";return!n.has(String(r))})});function Fe(){K.value=!K.value,ne.value=K.value}const ye=n=>{ne.value&&ae.value&&(ae.value.contains(n.target)||(ne.value=!1))},He=n=>n==="COMPLETED"?"bg-green-100 text-green-700 border border-green-200":n==="WORKING"?"bg-blue-100 text-blue-700 border border-blue-200":n==="PENDING"?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-gray-100 text-gray-700 border border-gray-200";function We(){te.replace({query:{...R.query,company_id:s.companyId||void 0,department_id:s.departmentId||void 0,employee_id:s.employeeId||void 0,line_type:s.lineType||void 0,start_date:s.startDate||void 0,end_date:s.endDate||void 0}})}async function re(){!s.companyId||!s.startDate||!s.endDate||(await m.fetchTodoDates({"company-id":s.companyId,"department-id":s.departmentId,"employee-id":s.employeeId,"line-type":s.lineType,"start-date":s.startDate,"end-date":s.endDate}),Xe())}function Ke(n){s.companyId=n.companyId||"",s.departmentId=n.departmentId||"",s.employeeId=n.employeeId||"",s.lineType=n.lineType||"all",s.startDate=n.startDate||"",s.endDate=n.endDate||""}function Je(){window.print()}const q=T(()=>s.startDate===s.endDate);Y(()=>s.companyId,n=>{n&&(V.fetchDepartments(n),L.fetchEmployee(n))},{immediate:!0}),Y(()=>({...s}),(n,t)=>{JSON.stringify(n)!==JSON.stringify(t)&&(We(),re())},{deep:!0}),Y(()=>R.query,n=>{s.companyId=(n==null?void 0:n.company_id)||s.companyId,s.departmentId=(n==null?void 0:n.department_id)||s.departmentId,s.employeeId=(n==null?void 0:n.employee_id)||s.employeeId,s.lineType=(n==null?void 0:n.line_type)||s.lineType,s.startDate=(n==null?void 0:n.start_date)||s.startDate,s.endDate=(n==null?void 0:n.end_date)||s.endDate}),le(()=>{L.fetchCompanies({ignore_permission:!0}),re()}),le(()=>{document.addEventListener("click",me,!0)}),Oe(()=>{document.removeEventListener("click",me,!0)}),le(()=>{document.addEventListener("click",ye,!0)}),Oe(()=>{document.removeEventListener("click",ye,!0)});const Qe=dt(),ge=E([]),oe=E(!1),Ye=T(()=>s.startDate===s.endDate),Xe=async()=>{if(!(!s.companyId||!s.startDate||!s.endDate)){oe.value=!0;try{const n=await Qe.getDateRangeAttendanceSummary(s.startDate,s.endDate,s.companyId,s.lineType,s.employeeId,!0);n&&(ge.value=n)}finally{oe.value=!1}}};function Ze(n,t){var d;const r=((d=ge.value)==null?void 0:d.find(c=>String(c.employee_id)===String(n)))||null;return r?!t&&Ye.value?(r==null?void 0:r.attendance[s.startDate])||null:(r==null?void 0:r.attendance[t])||null:null}function xe(n,t){const r=Ze(n,t);return r?{hasData:!0,in:r.in||"-",out:r.out||"-",late:r.late||"-",early:r.early||"-",comment:r.comment||"-"}:{hasData:!1,in:"-",out:"-",late:"-",early:"-",comment:"-"}}function qe(n,t,r,d){const c=r===n.dates.length-1,w=d===t.todos.length-1;return c&&w}function J(n,t,r,d){return qe(n,t,r,d)?de:""}return(n,t)=>{var r,d,c,w,x,v;return a(),l("div",_t,[ee(ht,{ref_key:"headingRef",ref:Z,"company-id":s.companyId,"department-id":s.departmentId,"employee-id":s.employeeId,"line-type":s.lineType,"start-date":s.startDate,"end-date":s.endDate,loading:B(m).loading,class:"mb-4 print:px-0 print:py-0 print:mb-2 print:border-0 print:border-b print:border-gray-400 print:rounded-none print:w-full sticky top-[58px] z-50",onChange:Ke,onReloadClick:re},{before:G(()=>t[3]||(t[3]=[e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-800"},"Todo Report")],-1)])),after:G(()=>[e("button",{type:"button",class:"btn-icon print-hide disabled:opacity-35 cursor-pointer disabled:cursor-not-allowed",onClick:X(Je,["prevent"]),disabled:B(m).loading},t[4]||(t[4]=[e("i",{class:"fas fa-print"},null,-1)]),8,Dt)]),_:1},8,["company-id","department-id","employee-id","line-type","start-date","end-date","loading"]),s.companyId&&s.startDate&&s.endDate?(a(),l("div",kt,[e("div",Tt,[e("div",null,[t[5]||(t[5]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Company",-1)),e("div",It,i(P.value.company),1)]),e("div",null,[t[6]||(t[6]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Department",-1)),e("div",{class:D(["font-medium",[P.value.department=="All Departments"?"text-gray-400":"text-gray-800"]])},i(P.value.department),3)]),e("div",null,[t[7]||(t[7]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Line Type",-1)),e("div",{class:D(["font-medium",[P.value.lineType=="All Types"?"text-gray-400":"text-gray-800"]])},i(P.value.lineType),3)]),e("div",null,[t[8]||(t[8]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Employee",-1)),e("div",{class:D(["font-medium",[P.value.employee=="All Employees"?"text-gray-400":"text-gray-800"]])},i(P.value.employee),3)]),e("div",St,[t[9]||(t[9]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Date",-1)),e("div",Nt,i(P.value.dateRange),1)]),e("div",{ref_key:"assignmentSummaryRef",ref:se,class:"print-hide relative"},[e("button",{type:"button",class:"px-3 bg-white text-gray-700 hover:bg-gray-50 w-full text-bg text-right",onClick:t[0]||(t[0]=o=>U.value=!U.value)},[t[10]||(t[10]=e("div",{class:"uppercase"},"Todo given",-1)),e("div",$t,[e("div",At,i(pe.value)+" / "+i(ue.value)+" / "+i(ie.value),1),e("i",{class:D(["fas",[U.value?"fa-chevron-up":"fa-chevron-down"]])},null,2)])]),U.value?(a(),l("div",Ct,[e("div",Rt,[t[11]||(t[11]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Todo Status",-1)),e("div",Et,i(pe.value)+" given / "+i(ue.value)+" present / "+i(ie.value)+" selected ",1)]),e("div",Pt,[e("div",Lt,[e("div",jt,[e("div",Ot,[t[12]||(t[12]=e("span",null,"Not given (Absent)",-1)),(r=f.value.withoutTodosAbsent)!=null&&r.length?(a(),l("span",Ut,i((d=f.value.withoutTodosAbsent)==null?void 0:d.length),1)):b("",!0)]),e("button",{type:"button",class:"text-[10px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:t[1]||(t[1]=o=>W.value=!W.value)},i(W.value?"Hide":"Show"),1)]),W.value?(a(),l("div",Bt,[f.value.withoutTodosAbsent.length?b("",!0):(a(),l("span",zt," No one is absent ")),(a(!0),l(S,null,O(f.value.withoutTodosAbsent,o=>(a(),l("span",{key:`absent-${o.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-red-50 text-red-700 border border-red-100 text-xs max-w-full",title:o.name},[t[13]||(t[13]=e("i",{class:"fas fa-user-times"},null,-1)),e("span",Vt,i(o.name),1)],8,Mt))),128))])):b("",!0),e("div",Ft,[e("div",Ht,[t[14]||(t[14]=e("span",null,"Not given (Present)",-1)),(c=f.value.withoutTodosPresent)!=null&&c.length?(a(),l("span",Wt,i((w=f.value.withoutTodosPresent)==null?void 0:w.length),1)):b("",!0)])]),W.value?(a(),l("div",Kt,[f.value.withoutTodosPresent.length?b("",!0):(a(),l("span",Jt," Everyone present has todos ")),(a(!0),l(S,null,O(f.value.withoutTodosPresent,o=>(a(),l("span",{key:`no-todo-${o.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-amber-50 text-amber-700 border border-amber-100 text-xs max-w-full",title:o.name},[t[15]||(t[15]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",Yt,i(o.name),1)],8,Qt))),128))])):b("",!0)]),e("div",null,[e("div",Xt,[t[16]||(t[16]=z(" Given todos ")),(x=f.value.withTodos)!=null&&x.length?(a(),l("span",Zt,i((v=f.value.withTodos)==null?void 0:v.length),1)):b("",!0)]),e("div",qt,[f.value.withTodos.length?b("",!0):(a(),l("span",Gt," No todos assigned ")),(a(!0),l(S,null,O(f.value.withTodos,o=>(a(),l("span",{key:`with-${o.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-50 text-green-700 border border-green-100 text-xs max-w-full",title:o.name},[t[17]||(t[17]=e("i",{class:"fas fa-check-circle"},null,-1)),e("span",ts,i(o.name),1)],8,es))),128))])])])])):b("",!0)],512)])])):b("",!0),!s.companyId||!s.startDate||!s.endDate?(a(),l("div",ss,t[18]||(t[18]=[e("i",{class:"fad fa-tasks text-4xl"},null,-1),e("div",{class:"empty-state glass-panel"},[e("p",{class:"text-base font-semibold text-rose-500"}," Select company and date range to view the report. "),e("p",{class:"text-sm text-gray-500"},"Use the filter set above to load records.")],-1)]))):B(m).loading?(a(),st(at,{key:2},{default:G(()=>t[19]||(t[19]=[z("Loading report...")])),_:1,__:[19]})):(a(),l("div",ns,[e("table",as,[e("thead",rs,[e("tr",os,[t[21]||(t[21]=e("th",{class:"px-4 py-3 border w-[10px] bg-white bg-opacity-70 backdrop-blur-sm rounded-tl-md print:rounded-tl-none text-center"}," sl ",-1)),e("th",ls,[e("div",ds,[t[20]||(t[20]=e("span",null,"Employee Name",-1)),s.employeeId?b("",!0):(a(),l("div",{key:0,class:"relative hidden md:block print:hidden",ref_key:"tableNoTodosRef",ref:ae},[e("button",{type:"button",class:"text-[11px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:t[2]||(t[2]=X(o=>Fe(),["stop"]))},[z(" No Todos ("+i(f.value.withoutTodosPresent.length+f.value.withoutTodosAbsent.length)+") ",1),e("span",is,i(K.value?"Hidden":"Showing"),1)])],512))])]),q.value?b("",!0):(a(),l("th",ps," Date ")),t[22]||(t[22]=e("th",{class:"px-4 py-3 border bg-white text-center"},"Todo",-1)),t[23]||(t[23]=e("th",{class:"px-4 py-3 border print:border-r print:border-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center rounded-tr-md print:rounded-tr-none"}," Status ",-1))])]),e("tbody",us,[ce.value.length===0?(a(),l("tr",ms,[e("td",{colspan:q.value?4:5,class:"px-4 py-6 text-center text-gray-500"},t[24]||(t[24]=[e("div",null,[e("i",{class:"fas fa-tasks fa-2x text-gray-300 mb-2"})],-1),e("div",null,"No todos.",-1)]),8,cs)])):b("",!0),(a(!0),l(S,null,O(ce.value,(o,I)=>{var N,$,h;return a(),l(S,{key:((N=o.user)==null?void 0:N.id)||(((h=($=o.dates[0])==null?void 0:$.todos[0])==null?void 0:h.id)??Math.random())},[(a(!0),l(S,null,O(o.dates,(y,A)=>{var j;return a(),l(S,{key:`${((j=o.user)==null?void 0:j.id)||"u"}-${y.date}`},[(a(!0),l(S,null,O(y.todos,(_,C)=>{var De,ke,Te,Ie,Se,Ne,$e,Ae,Ce,Re;return a(),l("tr",{key:_.id||`${((De=o.user)==null?void 0:De.id)||"u"}-${y.date||"empty"}-${C}`,class:"border odd:bg-white even:bg-gray-50 hover:bg-gray-100"},[A===0&&C===0?(a(),l("td",{key:0,rowspan:o.rowSpan||1,class:D(["px-4 py-3 align-top font-bold text-xl text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",de])},[e("div",gs,i(I+1),1)],8,ys)):b("",!0),A===0&&C===0?(a(),l("td",{key:1,rowspan:o.rowSpan||1,class:D(["px-4 py-3 align-top font-medium text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",de])},[e("div",{user:o.user,class:"sticky top-[180px] bg-white"},[n.selfOnly?b("",!0):(a(),l("div",fs,[ee(ot,{user:o.user},{trigger:G(({user:k})=>[ee(nt,{user:k,size:"medium"},null,8,["user"])]),_:2},1032,["user"]),e("div",null,[e("div",vs,[e("a",{href:B(lt)(o.user),target:"_blank",rel:"noopener",class:"inline-flex hover:underline"},[e("div",null,[z(i(((ke=o.user)==null?void 0:ke.name)||"Unknown user")+" ",1),t[25]||(t[25]=e("i",{class:"far fa-external-link-alt print:hidden"},null,-1))])],8,ws)]),e("div",hs,i(((Ie=(Te=o.user)==null?void 0:Te.department)==null?void 0:Ie.name)||"-"),1)])]))],8,bs)],8,xs)):b("",!0),_.isPlaceholder?(a(),l(S,{key:2},[C===0&&!q.value?(a(),l("td",{key:0,rowspan:y.rowSpan||1,class:D(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",J(o,y,A,C)])},[e("div",Ds,i(B(Q)(y.date)||y.date||"-"),1)],10,_s)):b("",!0),e("td",{class:D(["border-l border-t border-r bg-white px-3 py-3 text-center",J(o,y,A,C)]),colspan:"2"},[t[30]||(t[30]=e("div",{class:"flex items-center justify-center gap-2 text-red-600 text-sm font-medium opacity-70"},[e("i",{class:"far fa-clipboard-list text-red-400"}),e("span",null,"No todos was provided.")],-1)),oe.value?(a(),l("div",ks," Loading attendanceâ€¦ ")):(a(!0),l(S,{key:1},O([xe((Se=o==null?void 0:o.user)==null?void 0:Se.id,y==null?void 0:y.date)],k=>(a(),l("div",{key:k.comment,class:"min-w-[180px] mt-3 text-[11px] text-red-600 text-left inline-block align-top"},[k.hasData?(a(),l("div",Ts,[k.in==="-"&&k.out==="-"?(a(),l("div",{key:0,class:D(["text-center flex items-center justify-center rounded-md bg-slate-50 border text-xs border-dashed px-2 py-1.5 col-span-2",[{"text-red-500 border-red-300":k.comment==="Absent","text-blue-500 border-blue-300":k.comment!=="Absent"}]])},i(k.comment),3)):(a(),l(S,{key:1},[e("div",Is,[e("div",Ss,[t[26]||(t[26]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," In ",-1)),e("span",Ns,i(k.in),1)]),e("div",$s,[t[27]||(t[27]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Late ",-1)),e("div",null,i(k.late),1)])]),e("div",As,[e("div",Cs,[t[28]||(t[28]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Out ",-1)),e("span",Rs,i(k.out),1)]),e("div",Es,[t[29]||(t[29]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Early ",-1)),e("div",null,i(k.out!=="-"?k.early:"-"),1)])])],64))])):(a(),l("div",Ps," Attendance data unavailable. "))]))),128))],2)],64)):(a(),l(S,{key:3},[C===0&&!q.value?(a(),l("td",{key:0,rowspan:y.rowSpan||1,class:D(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",J(o,y,A,C)])},[e("div",js,i(B(Q)(y.date)||y.date||"-"),1)],10,Ls)):b("",!0),e("td",{class:D(["px-4 py-3 text-gray-800 border-l border-t",J(o,y,A,C)])},[e("div",Os,[e("span",Us,i(C+1)+".",1),z(" "+i(_.title),1)]),e("div",Bs,[($e=(Ne=_.todo)==null?void 0:Ne.todo_project)!=null&&$e.title?(a(),l("span",zs,[t[31]||(t[31]=e("i",{class:"fas fa-project-diagram mr-1"},null,-1)),z(" "+i(_.todo.todo_project.title),1)])):b("",!0),(Ae=_.todoable)!=null&&Ae.title||_.todoable_type?(a(),l("span",Ms,i(((Ce=_.todoable)==null?void 0:Ce.title)||((Re=_.todoable_type)==null?void 0:Re.split("\\").pop())||""),1)):b("",!0)])],2),e("td",{class:D(["px-4 py-3 border-l border-t border-r text-center",J(o,y,A,C)])},[e("div",{class:D(["inline-block text-xs font-semibold px-2.5 py-1 rounded-full whitespace-nowrap",He(_.status)])},i(_.status==="WORKING"?"IN PROGRESS":_.status||"N/A"),3)],2)],64))])}),128))],64)}),128))],64)}),128))])])]))])}}};export{tn as default};
