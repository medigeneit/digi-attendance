import{u as R,b as S,s as V,r as p,q as D,c as d,o as s,a as t,p as f,h as M,v as U,k as g,F,x as N,t as a,y as T}from"./index-DWU35BE7.js";import{_ as P}from"./EmployeeFilter-B1vp9255.js";import{L as j}from"./LoaderView-BhFrP01D.js";import{u as z}from"./attendance-B6R1AFeH.js";import{S as K}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./MultiselectDropdown-CN8JIn2p.js";import"./company-BGjkJtXz.js";import"./department-Cwqjka2i.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"space-y-2 px-4"},W={class:"flex flex-wrap items-center gap-2"},$={key:0,class:"text-center py-4"},G={key:1,class:"space-y-4"},H={key:0,class:"overflow-x-auto"},I={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},J={class:"border border-gray-300 px-2"},Q={class:"border border-gray-300 px-2"},X={class:"border border-gray-300 px-2"},Y={class:"border border-gray-300 px-2"},Z={class:"border border-gray-300 px-2"},ee={class:"border border-gray-300 px-2"},te={class:"border border-gray-300 px-2"},le={class:"border border-gray-300 px-2"},oe={key:0},ne={key:1,class:"text-gray-500 italic text-xs"},de={class:"border border-gray-300 px-2"},se={key:1,class:"text-center text-red-500 text-xl italic mt-10"},me={__name:"LateAttendanceReport",setup(ae){const y=R(),i=S(),u=z(),{monthlyLateLogs:h,isLoading:w,selectedMonth:k}=V(u),r=p(i.query.date||k.value),q=()=>{var e,n,l,c;y.replace({query:{...i.query,date:r.value}}),(e=o.value)!=null&&e.company_id&&((n=o.value)!=null&&n.department_id)&&((l=o.value)!=null&&l.type)&&((c=o.value)!=null&&c.employee_id)&&_(o.value)},_=async e=>{e.company_id&&(e!=null&&e.department_id)&&(e!=null&&e.type)&&(e!=null&&e.type)&&(e!=null&&e.employee_id)&&r.value&&await u.getAttendanceLateReport(e==null?void 0:e.company_id,e==null?void 0:e.department_id,e==null?void 0:e.type,e==null?void 0:e.employee_id,r.value,"monthly")},C=async()=>{o.value.company_id&&o.value.employee_id&&r.value?await u.lateReportDownloadExcel(o.value.company_id,o.value.employee_id,r.value,"monthly"):K.fire({icon:"warning",title:"Missing Selection!",text:"Please select Company, Employee, and Month first!",confirmButtonText:"OK"})},L=()=>{y.go(-1)},A=e=>e==="Pending"?"text-yellow-700":e==="Approved"?"text-green-700":"text-red-500",o=p({company_id:"",department_id:"all",type:"all",employee_id:""}),B=async()=>{var e,n,l,c,x,b,v,m;y.replace({query:{...i.query,company_id:(e=o.value)==null?void 0:e.company_id,department_id:(n=o.value)==null?void 0:n.department_id,type:(l=o.value)==null?void 0:l.type,employee_id:(c=o.value)==null?void 0:c.employee_id}}),(x=o.value)!=null&&x.company_id&&((b=o.value)!=null&&b.department_id)&&((v=o.value)!=null&&v.type)&&((m=o.value)!=null&&m.employee_id)&&_(o.value)},E=D(()=>({company_id:i.query.company_id||"",department_id:i.query.department_id||"all",type:i.query.type||"all",employee_id:i.query.employee_id||""}));return(e,n)=>(s(),d("div",O,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:L},n[2]||(n[2]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),n[4]||(n[4]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Late Reports",-1)),t("div",{class:"flex gap-4"},[t("button",{type:"button",onClick:C,class:"btn-3"},n[3]||(n[3]=[t("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)]))])]),t("div",W,[f(P,{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=l=>o.value=l),"initial-value":E.value,onFilterChange:B},null,8,["modelValue","initial-value"]),t("div",null,[M(t("input",{id:"user-filter","onUpdate:modelValue":n[1]||(n[1]=l=>r.value=l),onChange:q,type:"month",class:"input-1"},null,544),[[U,r.value]])])]),g(w)?(s(),d("div",$,[f(j)])):(s(),d("div",G,[o.value.company_id&&o.value.employee_id&&o.value.department_id?(s(),d("div",H,[t("table",I,[n[5]||(n[5]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border border-gray-300 px-2 text-left"},"#"),t("th",{class:"border border-gray-300 px-2 text-left"},"Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),t("th",{class:"border border-gray-300 px-2 text-left"},"Company"),t("th",{class:"border border-gray-300 px-2 text-left"},"Department"),t("th",{class:"border border-gray-300 px-2 text-left"},"Entry Time"),t("th",{class:"border border-gray-300 px-2 text-left"},"Late Duration"),t("th",{class:"border border-gray-300 px-2 text-left"},"Action"),t("th",{class:"border border-gray-300 px-2 text-left"},"Shift")])],-1)),t("tbody",null,[(s(!0),d(F,null,N(g(h),(l,c)=>(s(),d("tr",{key:l.id,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",J,a(c+1),1),t("td",Q,a(l==null?void 0:l.date),1),t("td",X,a((l==null?void 0:l.user_name)||"Unknown"),1),t("td",Y,a((l==null?void 0:l.company_name)||"Unknown"),1),t("td",Z,a((l==null?void 0:l.department_name)||"Unknown"),1),t("td",ee,a(l.entry_time),1),t("td",te,a(l.late_duration),1),t("td",le,[l!=null&&l.short_leave?(s(),d("div",oe,[t("span",{class:T(A(l.short_leave.status))},a(l.short_leave.status||"Waiting"),3)])):(s(),d("div",ne,"No Application"))]),t("td",de,a(l.shift_name),1)]))),128))])])])):(s(),d("div",se," Please select company, department and employee "))]))]))}};export{me as default};
