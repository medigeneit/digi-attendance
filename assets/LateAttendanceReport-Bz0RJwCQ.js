import{u as U,b as D,s as g,r as f,e as M,A as p,c as o,o as r,a as e,g as h,C as N,F as k,y as q,t as d,h as m,l as w,v as P,x as T}from"./index-D2ntkdUR.js";import{L as F}from"./LoaderView-D2G5V5jf.js";import{_ as j}from"./MultiselectDropdown-CbFHzHk7.js";import{u as z}from"./attendance-D7ntG6nO.js";import{u as K}from"./company-Bh7m_xPO.js";import{S as O}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue-multiselect.esm-Cft8Lh34.js";const W={class:"space-y-2 px-4"},$={class:"flex flex-wrap items-center gap-2"},G=["value"],H={key:0,class:"text-center py-4"},J={key:1,class:"space-y-4"},Q={key:0,class:"overflow-x-auto"},X={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Y={class:"border border-gray-300 px-2"},Z={class:"border border-gray-300 px-2"},E={class:"border border-gray-300 px-2"},I={class:"border border-gray-300 px-2"},ee={class:"border border-gray-300 px-2"},te={class:"border border-gray-300 px-2"},ae={class:"border border-gray-300 px-2"},se={class:"border border-gray-300 px-2"},le={key:0},oe={key:1,class:"text-gray-500 italic text-xs"},re={class:"border border-gray-300 px-2"},ne={key:1,class:"text-center text-red-500 text-xl italic mt-10"},pe={__name:"LateAttendanceReport",setup(de){const c=U(),n=D(),x=z(),u=K(),{monthlyLateLogs:S,isLoading:C,selectedMonth:_}=g(x),{companies:L,employees:v}=g(u),y=f(n.query.date||_.value),i=f(n.query.company_id||""),l=f("");M(async()=>{if(await u.fetchCompanies(),n.query.company_id&&(i.value=n.query.company_id,await u.fetchEmployee(n.query.company_id)),n.query.employee_id){const a=v.value.find(s=>s.id==n.query.employee_id);a&&(l.value=a,await b())}}),p(i,async a=>{a&&(await u.fetchEmployee(a),l.value=""),c.replace({query:{...n.query,company_id:a||"",employee_id:""}})}),p(l,async a=>{a!=null&&a.id&&await b(),c.replace({query:{...n.query,employee_id:(a==null?void 0:a.id)||""}})}),p(_,a=>{c.replace({query:{...n.query,date:a}})});const b=async()=>{var a;i.value&&((a=l==null?void 0:l.value)!=null&&a.id)&&await x.getAttendanceLateReport(i.value,l.value.id,y.value,"monthly")},A=async()=>{var a;i.value&&((a=l==null?void 0:l.value)!=null&&a.id)?await x.lateReportDownloadExcel(i.value,l.value.id,y.value,"monthly"):O.fire({icon:"warning",title:"Missing Selection!",text:"Please select Company and Employee first!",confirmButtonText:"OK"})},V=()=>{c.go(-1)},B=a=>a==="Pending"?"text-yellow-700":a==="Approved"?"text-green-700":"text-red-500";return(a,s)=>(r(),o("div",W,[e("div",{class:"flex items-center justify-between gap-2"},[e("button",{class:"btn-3",onClick:V},s[3]||(s[3]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),s[5]||(s[5]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Late Reports",-1)),e("div",{class:"flex gap-4"},[e("button",{type:"button",onClick:A,class:"btn-3"},s[4]||(s[4]=[e("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)]))])]),e("div",$,[e("div",null,[h(e("select",{id:"user-filter","onUpdate:modelValue":s[0]||(s[0]=t=>i.value=t),class:"input-1"},[s[6]||(s[6]=e("option",{value:""},"Select Company",-1)),(r(!0),o(k,null,q(m(L),t=>(r(),o("option",{key:t.id,value:t.id},d(t.name),9,G))),128))],512),[[N,i.value]])]),e("div",null,[w(j,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=t=>l.value=t),options:m(v),multiple:!1,label:"label",placeholder:"Please select employee..."},null,8,["modelValue","options"])]),e("div",null,[h(e("input",{id:"user-filter","onUpdate:modelValue":s[2]||(s[2]=t=>y.value=t),onChange:b,type:"month",class:"input-1"},null,544),[[P,y.value]])])]),m(C)?(r(),o("div",H,[w(F)])):(r(),o("div",J,[i.value&&l.value?(r(),o("div",Q,[e("table",X,[s[7]||(s[7]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-300 px-2 text-left"},"#"),e("th",{class:"border border-gray-300 px-2 text-left"},"Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),e("th",{class:"border border-gray-300 px-2 text-left"},"Company"),e("th",{class:"border border-gray-300 px-2 text-left"},"Department"),e("th",{class:"border border-gray-300 px-2 text-left"},"Entry Time"),e("th",{class:"border border-gray-300 px-2 text-left"},"Late Duration"),e("th",{class:"border border-gray-300 px-2 text-left"},"Action"),e("th",{class:"border border-gray-300 px-2 text-left"},"Shift")])],-1)),e("tbody",null,[(r(!0),o(k,null,q(m(S),(t,R)=>(r(),o("tr",{key:t.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",Y,d(R+1),1),e("td",Z,d(t==null?void 0:t.date),1),e("td",E,d((t==null?void 0:t.user_name)||"Unknown"),1),e("td",I,d((t==null?void 0:t.company_name)||"Unknown"),1),e("td",ee,d((t==null?void 0:t.department_name)||"Unknown"),1),e("td",te,d(t.entry_time),1),e("td",ae,d(t.late_duration),1),e("td",se,[t!=null&&t.short_leave?(r(),o("div",le,[e("span",{class:T(B(t.short_leave.status))},d(t.short_leave.status||"Waiting"),3)])):(r(),o("div",oe,"No Application"))]),e("td",re,d(t.shift_name),1)]))),128))])])])):(r(),o("div",ne," Please select company and employee "))]))]))}};export{pe as default};
