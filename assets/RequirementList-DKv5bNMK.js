import{L as X}from"./LoaderView-DG1nSeM0.js";import{_ as B}from"./DepartmentChip-ryEODKOV.js";import{d as G,n as Y,c as n,o as l,a as t,F as K,y as J,t as r,p as u,i as c,g as S,f as C,x as N,k as w,j as P,b as Q,m as g,r as Z,e as W,A as I,w as q,h as F,M as ee,v as te,u as se}from"./index-C5w6_6Lc.js";import{_ as D}from"./UserChip-Donf__qH.js";import{g as ae}from"./task-Z92_umQP.js";import{u as le}from"./company-BbQG1uQq.js";import{_ as H}from"./CompanyDepartmentSelectInput-CxaEtPZ8.js";import{_ as oe}from"./EmployeeDropdownInput-DX2XQ5dV.js";import{S as j}from"./SelectDropdown-C1FAPXai.js";import{u as ne}from"./useRequirementStore-B-MZMsbr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./url-CePbr-gY.js";import"./requirement-CMCmygxP.js";const de={class:"min-w-full bg-white border overflow-hidden table table-fixed"},re={key:0},ie={class:"px-4 py-4 font-semibold text-xl text-gray-700 border border-gray-200 text-center"},me={class:"px-4 py-4 min-w-[300px] md:min-w-[400px] border border-gray-200"},ue={class:"space-y-4"},ce={class:"text-blue-800"},pe=["title"],xe={key:0},ye={class:"flex gap-6 items-center mt-6"},_e={key:0,class:"text-gray-600 text-xs flex items-center gap-2 whitespace-nowrap"},be={class:"flex items-center gap-2 whitespace-nowrap"},fe={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},ge=["title"],ve={class:"flex items-center gap-2 mt-4"},he={key:1},we={class:"flex items-center gap-2 mt-1"},ke={key:1},$e={key:0,class:"text-xs text-red-300"},Ve={key:1,class:"italic text-xs text-gray-400"},Ae={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},Re=["title"],Te={class:"flex items-center gap-2 mt-4"},De={key:1},Se={key:0,class:"text-xs text-red-300"},Ce={key:1,class:"italic text-xs text-gray-400"},Le={class:"flex items-center gap-2 mt-2"},Ne={key:1},Ue={key:0,class:"text-xs text-red-300"},Me={key:1,class:"italic text-xs text-gray-400"},Ee={class:"px-4 py-4 text-center whitespace-nowrap border border-gray-200"},ze={key:0,class:"text-gray-600 text-sm"},Pe={class:"mb-2 w-full flex flex-col justify-between items-start"},je={class:"mb-2 w-full flex flex-col justify-between items-start"},Ie={class:"flex justify-between items-center gap-1"},Oe={key:1},Be={class:"px-4 py-4 text-center border border-gray-200"},Fe={class:"flex gap-4 items-center justify-center"},He={key:0,class:"absolute inset-0 flex flex-col items-center justify-center bg-white bg-opacity-50"},Ge={class:"flex flex-col gap-2 items-center justify-center bg-gray-50 bg-opacity-70 hover:bg-opacity-90 p-6 border border-gray-100 rounded-md"},Ke={class:"text-sm flex items-center gap-2 text-red-400 font-semibold"},Je={class:"mt-[2px]"},Qe={class:"text-gray-800 flex items-center gap-2"},We={class:"flex gap-4 items-center justify-center"},Xe={__name:"RequirementTable",props:{requirements:{type:Array,default:()=>[]}},setup(U){const p=G();return(k,a)=>{var v;const x=Y("RouterLink");return l(),n("table",de,[a[22]||(a[22]=t("thead",{class:"bg-gray-100 text-gray-400 text-xs"},[t("tr",null,[t("th",{class:"px-4 py-0.5 text-center whitespace-nowrap border w-[4%]"},"#"),t("th",{class:"px-4 py-0.5 text-left whitespace-nowrap border w-[60%]"},"Requirement"),t("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"},"From Department"),t("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"},"To Department"),t("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"}),t("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"},"Actions")])],-1)),t("tbody",null,[((v=U.requirements)==null?void 0:v.length)===0?(l(),n("tr",re,a[4]||(a[4]=[t("td",{colspan:"10",class:"p-4"},[t("div",{class:"text-gray-500 italic w-full h-64 flex items-center justify-center"}," No Requirement Found ")],-1)]))):(l(!0),n(K,{key:1},J(U.requirements,(e,i)=>{var d,_,m,R,T,M,y,E,b,L,z,f,o,$,V,A,s;return l(),n("tr",{key:e.id,class:"border-t hover:bg-blue-50 odd:bg-gray-50 group/item relative"},[t("td",ie,r(i+1),1),t("td",me,[t("div",ue,[u(x,{to:{name:"RequirementShow",params:{id:e==null?void 0:e.id}},class:"text-blue-600 text-sm hover:underline hover:text-blue-800 z-20"},{default:c(()=>{var h,O;return[t("div",ce,[t("div",{class:"line-clamp-1 font-semibold",title:e==null?void 0:e.title},r(e==null?void 0:e.title),9,pe)]),((h=e==null?void 0:e.details)==null?void 0:h.length)-1>0?(l(),n("span",xe,r(((O=e==null?void 0:e.details)==null?void 0:O.length)-1)+" More Requirement ",1)):S("",!0)]}),_:2},1032,["to"])]),t("div",ye,[e.created_at?(l(),n("div",_e,[a[5]||(a[5]=t("i",{class:"fas fa-clock text-sky-800/50"},null,-1)),t("div",null,r(new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})),1)])):S("",!0),t("div",be,[a[6]||(a[6]=t("span",{class:"text-xs text-gray-500"},"By:",-1)),e.created_by?(l(),C(D,{key:0,user:e.created_by,"avatar-size":"xsmall"},null,8,["user"])):S("",!0)]),e.priority?(l(),n("span",{key:1,class:N(["font-semibold text-sm border rounded-full px-2",{"bg-yellow-50 text-yellow-700 border-yellow-700 ":e.priority=="IMPORTANT","bg-red-700 text-red-50 ":e.priority=="URGENT"}])},r(e.priority),3)):S("",!0)])]),t("td",fe,[t("span",{title:(d=e==null?void 0:e.from_department)==null?void 0:d.name,class:N([{"bg-green-500 text-white group-hover/item:text-white":((_=e==null?void 0:e.from_department)==null?void 0:_.id)==((R=(m=w(p))==null?void 0:m.user)==null?void 0:R.department_id)},"text-blue-500 font-semibold flex-shrink-0 border border-blue-500 bg-blue-50 rounded-full px-2 text-xs"])},r(((T=e==null?void 0:e.from_department)==null?void 0:T.short_name)||((M=e==null?void 0:e.from_department)==null?void 0:M.name)),11,ge),t("div",ve,[a[8]||(a[8]=t("div",{class:"text-xs text-gray-500"},"In Charge:",-1)),(y=e==null?void 0:e.from_department)!=null&&y.in_charge?(l(),C(D,{key:0,user:(E=e==null?void 0:e.from_department)==null?void 0:E.in_charge,"avatar-size":"xsmall"},null,8,["user"])):(l(),n("div",he,a[7]||(a[7]=[t("span",{class:"italic text-xs text-gray-400"},"N/A",-1)])))]),t("div",we,[a[9]||(a[9]=t("div",{class:"text-xs text-gray-500"},"Coordinator:",-1)),e.from_coordinator?(l(),C(D,{key:0,user:e.from_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(l(),n("div",ke,[(b=e==null?void 0:e.from_department)!=null&&b.coordinator_id?(l(),n("div",$e," Approval Pending ")):(l(),n("div",Ve,"N/A"))]))])]),t("td",Ae,[t("span",{title:(L=e==null?void 0:e.to_department)==null?void 0:L.name,class:N([{"bg-sky-500 !text-white  ":((z=e==null?void 0:e.to_department)==null?void 0:z.id)==((o=(f=w(p))==null?void 0:f.user)==null?void 0:o.department_id)},"text-sky-500 font-semibold flex-shrink-0 border border-sky-500 bg-blue-50 rounded-full px-2 text-xs"])},r((($=e==null?void 0:e.to_department)==null?void 0:$.short_name)||((V=e==null?void 0:e.to_department)==null?void 0:V.name)),11,Re),t("div",Te,[a[10]||(a[10]=t("div",{class:"text-xs text-gray-500"},"In Charge:",-1)),e.to_incharge?(l(),C(D,{key:0,user:e.to_incharge,"avatar-size":"xsmall"},null,8,["user"])):(l(),n("div",De,[(A=e==null?void 0:e.to_department)!=null&&A.incharge_id?(l(),n("div",Se," Approval Pending ")):(l(),n("div",Ce,"N/A"))]))]),t("div",Le,[a[11]||(a[11]=t("div",{class:"text-xs text-gray-500"},"Coordinator:",-1)),e.to_coordinator?(l(),C(D,{key:0,user:e.to_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(l(),n("div",Ne,[(s=e==null?void 0:e.to_department)!=null&&s.coordinator_id?(l(),n("div",Ue," Approval Pending ")):(l(),n("div",Me,"N/A"))]))])]),t("td",Ee,[e.submission_date?(l(),n("div",ze,[t("div",Pe,[a[12]||(a[12]=t("span",{class:"text-xs font-bold"},"Submitted:",-1)),t("div",null,r(new Date(e.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))+" "+r(new Date(e.submission_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),t("div",je,[a[13]||(a[13]=t("span",{class:"text-xs font-bold"},"Better To Complete:",-1)),t("div",null,r(new Date(e.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))+" "+r(new Date(e.submission_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),t("div",Ie,[a[14]||(a[14]=t("span",{class:"text-xs font-bold"},"Status:",-1)),t("span",{class:N(["border rounded-lg px-2 py-0.5 text-xs",{"bg-red-300 text-red-700 border-red-400":e.status!="approved","bg-green-300 text-green-700 border-green-400":e.status=="approved"}])},r(String(e.status).toUpperCase()),3)])])):(l(),n("div",Oe,"-"))]),t("td",Be,[t("div",Fe,[u(x,{to:{name:"RequirementShow",params:{id:e==null?void 0:e.id}},class:"btn-2",onClick:a[0]||(a[0]=h=>h.stopPropagation())},{default:c(()=>a[15]||(a[15]=[t("i",{class:"fad fa-eye"},null,-1),P(" Show ")])),_:2,__:[15]},1032,["to"]),u(x,{to:{name:"RequirementEdit",params:{id:e==null?void 0:e.id}},class:"btn-4 border border-blue-500 hover:bg-blue-500 hover:text-white",onClick:a[1]||(a[1]=h=>h.stopPropagation())},{default:c(()=>a[16]||(a[16]=[t("i",{class:"fad fa-edit"},null,-1),P(" Edit ")])),_:2,__:[16]},1032,["to"])]),e.closed_at?(l(),n("div",He,[t("div",Ge,[t("div",Ke,[a[17]||(a[17]=t("span",{class:"fad fa-lock"},null,-1)),a[18]||(a[18]=t("span",{class:"mt-[2px]"},"CLOSED AT",-1)),t("span",Je,r(new Date(e.closed_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),t("div",Qe,[a[19]||(a[19]=t("span",{class:"text-sm"},"Closed by",-1)),u(D,{user:e.closed_by_user,"avatar-size":"xsmall"},null,8,["user"])]),t("div",We,[u(x,{to:{name:"RequirementShow",params:{id:e==null?void 0:e.id}},class:"btn-2 h-6",onClick:a[2]||(a[2]=h=>h.stopPropagation())},{default:c(()=>a[20]||(a[20]=[t("i",{class:"fad fa-eye"},null,-1),P(" Show ")])),_:2,__:[20]},1032,["to"]),u(x,{to:{name:"RequirementEdit",params:{id:e==null?void 0:e.id}},class:"btn-4 h-6 border border-blue-500 hover:bg-blue-500 hover:text-white",onClick:a[3]||(a[3]=h=>h.stopPropagation())},{default:c(()=>a[21]||(a[21]=[t("i",{class:"fad fa-edit"},null,-1),P(" Edit ")])),_:2,__:[21]},1032,["to"])])])])):S("",!0)])])}),128))])])}}},Ye={class:"flex flex-wrap items-center w-full gap-2"},Ze={class:"flex flex-wrap items-center justify-center gap-x-4 gap-y-3 ml-auto"},qe={class:"relative"},et={class:"text-xs"},tt=["title"],st={key:1},at={class:"w-36 my-0.5"},lt={class:"text-xs"},ot=["user","title"],nt={class:"text-sky-500 font-semibold mr-1"},dt={key:1,class:"text-gray-600"},rt={class:"text-xs"},it=["user","title"],mt={class:"text-sky-500 font-semibold"},ut={key:1,class:"text-gray-600"},ct={key:1,class:"relative lg:flex-grow"},pt={class:"text-xs"},xt={key:0,class:"flex items-center gap-1 overflow-hidden text-xs"},yt={key:1,class:"text-gray-600"},_t={class:"relative"},bt={class:"text-xs"},ft=["user"],gt={key:1},vt={class:"relative"},ht={class:"text-xs"},wt=["user"],kt={key:1},$t={class:"flex items-center text-xs gap-1 text-gray-600 max-w-36 relative rounded h-8 border border-gray-300 bg-white px-2"},Vt={class:"!text-sm flex text-gray-600 relative rounded h-8 border border-gray-300 bg-white pl-2"},At={__name:"RequirementHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask","clickAdd"],setup(U,{emit:p}){const k=U,a=G(),x=Q(),v=g(b("company-id")),e=g(b("from-department-id")),i=g(b("to-department-id")),d=g(b("created-by")),_=g(b("month")),m=g(b("priority")),R=g(b("status")),T=g(b("is-closed")),M=p,y=le(),E=Z([]);function b(f){return{get:()=>k.modelValue[f]||"",set:o=>{M("update:modelValue",{...k.modelValue,[f]:o||void 0})}}}async function L(){var f,o,$;if(!k.isMyTask){const V=(f=k.modelValue)==null?void 0:f["company-id"],A=i.value,s={...V?{company_id:V}:{},...A?{department_ids:[A]}:{}};E.value=(($=(o=await ae({params:s}))==null?void 0:o.data)==null?void 0:$.employees)||[]}}W(async()=>{await y.fetchCompanies({with:"departments",ignore_permission:!0}),await y.fetchMyCompanies({with:"departments"}),await L()}),I(()=>i.value,L),I(()=>v.value,()=>{e.value="",i.value="",d.value="",L()});const z=g(()=>v.value?y==null?void 0:y.companies.filter(f=>f.id==v.value):y==null?void 0:y.companies);return(f,o)=>{var $,V,A;return l(),n("div",null,[t("div",Ye,[o[16]||(o[16]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Requirements",-1)),t("button",{onClick:o[0]||(o[0]=q(s=>M("clickAdd"),["prevent"])),class:"btn-icon size-8 border border-gray-400"},o[9]||(o[9]=[t("i",{class:"fas fa-plus text-sm"},null,-1)])),t("div",Ze,[t("div",qe,[u(j,{modelValue:v.value,"onUpdate:modelValue":o[1]||(o[1]=s=>v.value=s),options:(($=w(y))==null?void 0:$.companies)||[],label:"name",id:"id",class:"border border-gray-300 rounded h-8 bg-white !text-sm",clearable:""},{"selected-option":c(({option:s})=>[t("span",et,[s?(l(),n("span",{key:0,title:s==null?void 0:s.name,class:"max-w-28 line-clamp-1 text-sky-500 font-semibold"},r(s==null?void 0:s.name),9,tt)):(l(),n("span",st,"Company"))])]),option:c(({option:s})=>[t("div",at,r(s.name),1)]),_:1},8,["modelValue","options"])]),u(H,{modelValue:e.value,"onUpdate:modelValue":o[2]||(o[2]=s=>e.value=s),companies:z.value||[],class:"relative",className:{select:"border border-gray-300 rounded h-8 bg-white !text-sm"},defaultOption:"--ALL DEPARTMENT--"},{label:c(()=>o[10]||(o[10]=[t("span",null,null,-1)])),selectedOption:c(({option:s})=>[t("span",lt,[s?(l(),n("span",{key:0,user:s,"avatar-size":"xsmall",class:"max-w-28 line-clamp-1",title:s==null?void 0:s.name},[o[11]||(o[11]=t("span",{class:"text-gray-400"},"From:",-1)),t("span",nt,r((s==null?void 0:s.short_name)||(s==null?void 0:s.name)),1)],8,ot)):(l(),n("span",dt,"--From Department--"))])]),_:1},8,["modelValue","companies"]),w(x).name!=="MyTaskList"?(l(),C(H,{key:0,modelValue:i.value,"onUpdate:modelValue":o[3]||(o[3]=s=>i.value=s),companies:z.value||[],class:"relative",className:{select:"border border-gray-300 rounded h-8 bg-white !text-sm"},defaultOption:"--ALL DEPARTMENT--"},{label:c(()=>o[12]||(o[12]=[t("span",null,null,-1)])),selectedOption:c(({option:s})=>[t("span",rt,[s?(l(),n("span",{key:0,user:s,"avatar-size":"xsmall",class:"max-w-28 line-clamp-1",title:s==null?void 0:s.name},[o[13]||(o[13]=t("span",{class:"text-gray-400 mr-1"},"To:",-1)),t("span",mt,r((s==null?void 0:s.short_name)||(s==null?void 0:s.name)),1)],8,it)):(l(),n("span",ut,"--To Department--"))])]),_:1},8,["modelValue","companies"])):S("",!0),w(a).isAdminMood&&((A=(V=w(a))==null?void 0:V.user)==null?void 0:A.role)!=="employee"?(l(),n("div",ct,[u(oe,{employees:E.value,modelValue:d.value,"onUpdate:modelValue":o[4]||(o[4]=s=>d.value=s),class:"border border-gray-300 rounded h-8 bg-white max-w-64 !text-sm"},{selectedOption:c(({option:s})=>[t("span",pt,[s?(l(),n("span",xt,[o[14]||(o[14]=t("span",{class:"text-gray-400"},"User: ",-1)),u(D,{user:s,"avatar-size":"xsmall",class:"inline"},null,8,["user"])])):(l(),n("span",yt,"--All Employee--"))])]),_:1},8,["employees","modelValue"])])):S("",!0),t("div",_t,[u(j,{modelValue:m.value,"onUpdate:modelValue":o[5]||(o[5]=s=>m.value=s),searchable:!1,clearable:!0,options:[{label:"Normal",id:"normal"},{label:"IMPORTANT",id:"IMPORTANT"},{label:"URGENT",id:"URGENT"}],class:"border border-gray-300 rounded h-8 bg-white !text-sm"},{"selected-option":c(({option:s})=>[t("span",bt,[s?(l(),n("span",{key:0,user:s,"avatar-size":"xsmall",class:"max-w-28 line-clamp-1 text-sky-500 font-semibold"},r(s==null?void 0:s.label),9,ft)):(l(),n("span",gt,"--Any Priority--"))])]),_:1},8,["modelValue"])]),t("div",vt,[u(j,{modelValue:R.value,"onUpdate:modelValue":o[6]||(o[6]=s=>R.value=s),searchable:!1,clearable:!0,options:[{label:"Pending",id:"pending"},{label:"Approved",id:"approved"},{label:"Rejected",id:"rejected"}],class:"border border-gray-300 rounded h-8 bg-white !text-sm"},{"selected-option":c(({option:s})=>[t("span",ht,[s?(l(),n("span",{key:0,user:s,"avatar-size":"xsmall",class:"max-w-28 line-clamp-1 text-sky-500 font-semibold"},r(s==null?void 0:s.label),9,wt)):(l(),n("span",kt,"--ALL Status--"))])]),_:1},8,["modelValue"])]),t("div",null,[t("label",$t,[F(t("input",{type:"checkbox",class:"size-[15px]","onUpdate:modelValue":o[7]||(o[7]=s=>T.value=s)},null,512),[[ee,T.value]]),t("span",{class:N(["font-semibold",[T.value?"text-sky-500 font-semibold":""]])},"Is Closed",2)])]),t("div",Vt,[o[15]||(o[15]=t("label",{class:"top-2 bottom-2 left-2 flex items-center text-xs text-gray-500 mr-1",for:"month-filter"}," Month: ",-1)),F(t("input",{id:"month-filter","onUpdate:modelValue":o[8]||(o[8]=s=>_.value=s),type:"month",class:N(["rounded h-full !text-xs w-full appearance-none text-gray-800 font-semibold outline-none pr-1",[T.value?"text-sky-500 font-semibold":""]]),placeholder:"All month"},null,2),[[te,_.value]])])])])])}}},Rt={class:"container mx-auto"},Tt={class:"bg-white shadow-md rounded-lg p-4"},Dt={key:1,class:"text-center py-4 text-red-500"},St={key:2,class:"text-center py-4 text-gray-500 min-h-[50vh] flex items-center justify-center border rounded-md"},Ct={key:3,class:"space-y-6"},Lt={class:"sticky top-14 z-40 text-gray-700 bg-gradient-to-tl from-sky-400/60 to-sky-400 py-2 px-4 flex items-center"},Nt={class:"font-semibold flex items-center gap-2"},Ut={class:"rounded-b-md overflow-x-auto border-x xl:border-x-0"},Qt={__name:"RequirementList",setup(U){const p=ne(),k=se(),a=Q(),x=g({get(){return{...a.query}},set(i){k.push({query:{...i}})}});W(()=>{console.log("Requirement List Mounted"),p.fetchRequirements(x.value)}),I(()=>({...x.value}),async function(i){p.fetchRequirements(i)});const v=()=>{k.push({name:"RequirementAdd"})},e=g(()=>(p.requirements||[]).reduce((i,d)=>{const _=`${d.from_department_id}-${d.to_department_id}`,m=i.find(R=>R.key==_);return m?m.requirements=[...m.requirements,d]:i.push({key:_,from_department:d.from_department,to_department:d.to_department,requirements:[d]}),i},[]));return(i,d)=>{var _;return l(),n("div",Rt,[t("div",Tt,[u(At,{modelValue:x.value,"onUpdate:modelValue":d[0]||(d[0]=m=>x.value=m),onClickAdd:v,class:"mb-4"},null,8,["modelValue"]),w(p).loading?(l(),C(X,{key:0,class:"sm:min-h-64 lg:min-h-96 shadow-none flex items-center justify-center"},{default:c(()=>d[1]||(d[1]=[P(" Loading requirements... ")])),_:1,__:[1]})):w(p).error?(l(),n("div",Dt,r(w(p).error),1)):((_=w(p).requirements)==null?void 0:_.length)===0?(l(),n("div",St," No Requirements ")):(l(),n("div",Ct,[(l(!0),n(K,null,J(e.value,m=>(l(),n("div",{key:m.key,class:"rounded-md border-2 border-sky-300"},[t("div",Lt,[t("div",Nt,[d[2]||(d[2]=t("span",{class:"text-white text-sm"},"From",-1)),u(B,{department:m.from_department},null,8,["department"]),d[3]||(d[3]=t("span",{class:"text-white text-sm"},"To",-1)),u(B,{department:m.to_department},null,8,["department"])])]),t("div",Ut,[u(Xe,{requirements:m.requirements},null,8,["requirements"])])]))),128))]))])])}}};export{Qt as default};
