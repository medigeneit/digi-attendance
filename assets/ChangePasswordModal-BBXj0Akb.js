import{_ as T,g as V,S as M,G as A,r as w,x as b,c as t,o as l,a as e,w as h,l as m,aa as y,s as v,b as k,t as O,k as q}from"./index-Bl2NPlhW.js";const B={class:"cp-modal",role:"dialog","aria-modal":"true","aria-label":"Change password"},D={class:"cp-head"},E={class:"cp-field"},$={class:"cp-input-wrap"},z=["type"],F={key:0},G={key:1},Z={class:"cp-field"},j={class:"cp-input-wrap"},I=["type"],R={key:0},W={key:1},H={class:"cp-strength"},J={class:"cp-bars"},K={class:"cp-strength-text"},L={class:"cp-strong"},Q={class:"cp-field"},X={class:"cp-input-wrap"},Y=["type"],ss={key:0},es={key:1},os={key:0,class:"cp-error"},as={class:"cp-actions"},ts=["disabled"],ls={key:0},ns={key:1},rs={__name:"ChangePasswordModal",props:{user:Object},emits:["close","updated"],setup(ds,{emit:C}){const r=C,g=V(),_=M(),o=A({old_password:"",new_password:"",confirm_password:""}),p=w(!1),i=w(!1),c=w(!1),u=w(!1),P=()=>p.value=!p.value,x=()=>i.value=!i.value,S=()=>c.value=!c.value,f=b(()=>o.confirm_password?o.new_password===o.confirm_password:!0),d=b(()=>{const a=o.new_password||"";let s=0;return a.length>=8&&s++,/[A-Z]/.test(a)&&s++,/[0-9]/.test(a)&&s++,/[^A-Za-z0-9]/.test(a)&&s++,a?s<=1?{label:"Weak",level:1}:s===2?{label:"Fair",level:2}:s===3?{label:"Good",level:3}:{label:"Strong",level:4}:{label:"Enter a password",level:0}}),N=b(()=>o.old_password&&o.new_password&&o.confirm_password&&f.value&&!u.value),U=async()=>{if(!f.value){_.error("New Password and Confirm Password do not match!");return}try{u.value=!0;const a={old_password:o.old_password,new_password:o.new_password,confirm_password:o.confirm_password};await g.changePassword(a),_.success("Password updated successfully!"),r("updated"),r("close")}catch(a){console.error(a),_.error(g.error||"Failed to update password!")}finally{u.value=!1}};return(a,s)=>(l(),t("div",{class:"cp-backdrop",onClick:s[5]||(s[5]=h(n=>r("close"),["self"]))},[e("div",B,[e("div",D,[s[6]||(s[6]=e("div",null,[e("p",{class:"cp-kicker"},"Security"),e("h2",{class:"cp-title"},"Change Password")],-1)),e("button",{type:"button",class:"cp-x",onClick:s[0]||(s[0]=n=>r("close")),"aria-label":"Close"}," âœ• ")]),e("form",{onSubmit:h(U,["prevent"]),class:"space-y-4"},[e("div",E,[s[8]||(s[8]=e("label",null,"Old Password",-1)),e("div",$,[m(e("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>o.old_password=n),type:p.value?"text":"password",class:"input-light",placeholder:"Enter old password",autocomplete:"current-password",required:""},null,8,z),[[y,o.old_password]]),e("button",{type:"button",class:"cp-eye",onClick:P,"aria-label":"Toggle old password"},[p.value?(l(),t("span",F,"ðŸ™ˆ")):(l(),t("span",G,s[7]||(s[7]=[e("i",{class:"fas fa-eye"},null,-1)])))])])]),e("div",Z,[s[11]||(s[11]=e("label",null,"New Password",-1)),e("div",j,[m(e("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>o.new_password=n),type:i.value?"text":"password",class:"input-light",placeholder:"At least 8 characters",autocomplete:"new-password",required:""},null,8,I),[[y,o.new_password]]),e("button",{type:"button",class:"cp-eye",onClick:x,"aria-label":"Toggle new password"},[i.value?(l(),t("span",R,"ðŸ™ˆ")):(l(),t("span",W,s[9]||(s[9]=[e("i",{class:"fas fa-eye"},null,-1)])))])]),e("div",H,[e("div",J,[e("span",{class:v(["cp-bar",{on:d.value.level>=1}])},null,2),e("span",{class:v(["cp-bar",{on:d.value.level>=2}])},null,2),e("span",{class:v(["cp-bar",{on:d.value.level>=3}])},null,2),e("span",{class:v(["cp-bar",{on:d.value.level>=4}])},null,2)]),e("p",K,[s[10]||(s[10]=k(" Strength: ")),e("span",L,O(d.value.label),1)])])]),e("div",Q,[s[13]||(s[13]=e("label",null,"Confirm Password",-1)),e("div",X,[m(e("input",{"onUpdate:modelValue":s[3]||(s[3]=n=>o.confirm_password=n),type:c.value?"text":"password",class:"input-light",placeholder:"Re-type new password",autocomplete:"new-password",required:""},null,8,Y),[[y,o.confirm_password]]),e("button",{type:"button",class:"cp-eye",onClick:S,"aria-label":"Toggle confirm password"},[c.value?(l(),t("span",ss,"ðŸ™ˆ")):(l(),t("span",es,s[12]||(s[12]=[e("i",{class:"fas fa-eye"},null,-1)])))])]),f.value?q("",!0):(l(),t("p",os," Passwords do not match. "))]),e("div",as,[e("button",{type:"button",class:"btn-2-red",onClick:s[4]||(s[4]=n=>r("close"))}," Cancel "),e("button",{type:"submit",class:"btn-2",disabled:!N.value},[u.value?(l(),t("span",ns,"Updating...")):(l(),t("span",ls,"Update Password"))],8,ts)]),s[14]||(s[14]=e("div",{class:"cp-hint"},[e("span",{class:"dot"}),k(" Tip: Use uppercase, numbers and symbols for stronger password. ")],-1))],32)])]))}},is=T(rs,[["__scopeId","data-v-bc2b6aa2"]]);export{is as C};
