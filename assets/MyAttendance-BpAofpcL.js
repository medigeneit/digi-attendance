import{e as Q,$ as rt,n as X,c as m,o as l,a as t,F as Y,q as Z,p as tt,i as c,j as r,t as n,w as ot,u as at,b as lt,d as it,r as J,m as dt,z as K,f as b,h as ut,v as pt,k as a,g as _,x as k}from"./index-CbJB_2xf.js";import{L as mt}from"./LoaderView-BoVIpl_5.js";import{u as _t}from"./attendance-xnZDDPib.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const yt={class:"absolute right-4 md:right-10 md:top-16 top-20 w-72 max-h-[28rem] overflow-y-auto bg-white shadow-xl border border-gray-200 rounded-xl p-4 z-50 transition-all duration-200 ease-out"},vt={class:"flex items-center justify-between mb-4 border-b pb-2"},bt={class:"space-y-3"},ct={__name:"ApplicationMenu",emits:["close"],setup(et,{emit:f}){const h=[{label:"Add Leave Application",route:"LeaveApplicationAdd"},{label:"Add Offday Exchange",route:"OffdayExchangeAdd"},{label:"Add Shift Exchange",route:"ShiftExchangeAdd"},{label:"Add Manual Attendance",route:"ManualAttendanceAdd"},{label:"Add Overtime",route:"MyOvertimeAdd"}],o=f,i=p=>{p.key==="Escape"&&o("close")};return Q(()=>document.addEventListener("keydown",i)),rt(()=>document.removeEventListener("keydown",i)),(p,d)=>{const w=X("router-link");return l(),m("div",{class:"fixed inset-0 bg-black bg-opacity-25 z-40",onClick:d[2]||(d[2]=ot(y=>o("close"),["self"]))},[t("div",yt,[t("div",vt,[d[3]||(d[3]=t("h2",{class:"text-lg font-semibold text-gray-800"},"Application Category",-1)),t("button",{onClick:d[0]||(d[0]=y=>o("close")),class:"text-gray-400 hover:text-red-500 text-2xl leading-none"}," Ã— ")]),t("div",bt,[(l(),m(Y,null,Z(h,(y,x)=>tt(w,{key:x,to:{name:y.route},class:"block w-full text-center bg-gradient-to-r from-blue-100 to-blue-200 text-blue-800 font-medium py-2 rounded-md hover:from-blue-200 hover:to-blue-300 transition"},{default:c(()=>[r(n(y.label),1)]),_:2},1032,["to"])),64))]),t("button",{onClick:d[1]||(d[1]=y=>o("close")),class:"mt-6 w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-md font-semibold transition"}," Close ")])])}}},ft={class:"px-4 space-y-4"},xt={class:"md:flex items-center justify-between gap-2"},ht={class:"title-lg md:title-lg flex-wrap text-center"},kt={class:"flex gap-4"},wt={class:"grid md:grid-cols-2 gap-4 text-sm"},At={class:"card-bg p-4 gap-1"},gt={class:"grid md:grid-cols-2"},St={class:"card-bg p-4 gap-1"},Dt={class:"flex justify-between items-center"},Ct={class:"grid md:grid-cols-2"},Lt={key:1,class:"space-y-4"},Mt={class:"overflow-x-auto card-bg"},Et={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},$t={class:"text-center text-xs"},Tt={class:"border px-1 py-0.5"},Bt={class:"border px-1 py-0.5"},jt=["title"],Ot=["title"],qt=["title"],Nt={key:0},Pt={class:"border px-1 py-0.5"},Ut={class:"border px-1 py-0.5"},Vt={class:"border px-1 py-0.5"},Wt={key:0},zt={class:"border px-1 py-0.5"},Ht={key:0},Jt={__name:"MyAttendance",setup(et){const f=at(),h=lt(),o=it(),i=_t(),p=J(h.query.date||i.selectedMonth),d=J(!1);function w(){d.value=!0}const y=dt(()=>{if(!p.value)return"";const[u,e]=p.value.split("-");return new Date(u,e-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),x=async()=>{var u;(u=o.user)!=null&&u.id&&p.value&&await i.getMonthlyAttendanceByShift(o.user.id,p.value)};Q(async()=>{o.isAuthenticated?(await o.fetchUser(),x()):f.push("/login")}),K(p,async u=>{i.selectedMonth=u,await x()}),K(p,u=>{f.replace({query:{...h.query,date:u}})});const st=()=>f.go(-1),nt=u=>{if(u)return u.split(" ").map(e=>e[0]).join("").toUpperCase()};return(u,e)=>{var A,g,S,D,C,L,M,E,$,T,B,j,O,q,N,P,U,V,W,z,H,I,R,F,G;const v=X("router-link");return l(),m("div",ft,[t("div",xt,[t("button",{class:"btn-3",onClick:st},e[3]||(e[3]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),t("h1",ht," Attendance of "+n(y.value),1),t("div",kt,[t("div",null,[ut(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),onChange:x,class:"input-1"},null,544),[[pt,p.value]])])])]),t("div",wt,[t("div",At,[e[13]||(e[13]=t("h2",{class:"title-md"},"User Info",-1)),e[14]||(e[14]=t("hr",null,null,-1)),t("div",gt,[t("p",null,[e[4]||(e[4]=t("strong",null,"Name:",-1)),r(" "+n((A=a(o).user)==null?void 0:A.name),1)]),t("p",null,[e[5]||(e[5]=t("strong",null,"Designation:",-1)),r(" "+n((S=(g=a(o).user)==null?void 0:g.designation)==null?void 0:S.title),1)]),t("p",null,[e[6]||(e[6]=t("strong",null,"Department:",-1)),r(" "+n((C=(D=a(o).user)==null?void 0:D.department)==null?void 0:C.name),1)]),t("p",null,[e[7]||(e[7]=t("strong",null,"Company:",-1)),r(" "+n((M=(L=a(o).user)==null?void 0:L.company)==null?void 0:M.name),1)]),t("p",null,[e[8]||(e[8]=t("strong",null,"Phone:",-1)),r(" "+n((E=a(o).user)==null?void 0:E.phone),1)]),t("p",null,[e[9]||(e[9]=t("strong",null,"Email:",-1)),r(" "+n(($=a(o).user)==null?void 0:$.email),1)]),t("p",null,[e[10]||(e[10]=t("strong",null,"Employee ID:",-1)),r(" "+n((T=a(o).user)==null?void 0:T.employee_id),1)]),t("p",null,[e[11]||(e[11]=t("strong",null,"Blood Group:",-1)),r(" "+n(((B=a(o).user)==null?void 0:B.blood)||"N/A"),1)]),t("p",null,[e[12]||(e[12]=t("strong",null,"Joining Date:",-1)),r(" "+n((j=a(o).user)==null?void 0:j.joining_date),1)])])]),t("div",St,[t("div",Dt,[e[15]||(e[15]=t("h2",{class:"title-md"},"Attendance Summary",-1)),t("button",{onClick:e[1]||(e[1]=s=>w()),class:"btn-2"}," Apply Application "),d.value?(l(),b(ct,{key:0,onClose:e[2]||(e[2]=s=>d.value=!1)})):_("",!0)]),e[22]||(e[22]=t("hr",null,null,-1)),t("div",Ct,[t("p",null,[e[16]||(e[16]=t("strong",null,"Total Working Days:",-1)),r(" "+n(((q=(O=a(i))==null?void 0:O.summary)==null?void 0:q.total_working_days)||0),1)]),t("p",null,[e[17]||(e[17]=t("strong",null,"Present Days:",-1)),r(" "+n(((P=(N=a(i))==null?void 0:N.summary)==null?void 0:P.total_present_days)||0),1)]),t("p",null,[e[18]||(e[18]=t("strong",null,"Absent Days:",-1)),r(" "+n(((V=(U=a(i))==null?void 0:U.summary)==null?void 0:V.total_absent_days)||0),1)]),t("p",null,[e[19]||(e[19]=t("strong",null,"Late Days:",-1)),r(" "+n(((z=(W=a(i))==null?void 0:W.summary)==null?void 0:z.actual_late_day)||0),1)]),t("p",null,[e[20]||(e[20]=t("strong",null,"Total Working Hours:",-1)),r(" "+n((I=(H=a(i))==null?void 0:H.summary)==null?void 0:I.total_working_hours),1)]),t("p",null,[e[21]||(e[21]=t("strong",null,"Total Overtime Hours:",-1)),r(" "+n((F=(R=a(i))==null?void 0:R.summary)==null?void 0:F.total_overtime_hours),1)])]),e[23]||(e[23]=t("p",null,null,-1))])]),a(i).isLoading?(l(),b(mt,{key:0})):(l(),m("div",Lt,[t("div",Mt,[t("table",Et,[e[27]||(e[27]=t("thead",null,[t("tr",{class:"bg-gray-200 text-xs"},[t("th",{class:"border p-1"},"Date"),t("th",{class:"border p-1"},"Day"),t("th",{class:"border p-1"},"Shift"),t("th",{class:"border p-1"},"Entry Time"),t("th",{class:"border p-1"},"Exit Time"),t("th",{class:"border p-1"},"Working Hours"),t("th",{class:"border p-1"},"OT Hours"),t("th",{class:"border p-1"},"Late Entry"),t("th",{class:"border p-1"},"Early Leave"),t("th",{class:"border p-1"},"Status")])],-1)),t("tbody",$t,[(l(!0),m(Y,null,Z((G=a(i))==null?void 0:G.monthlyLogs,s=>(l(),m("tr",{key:s==null?void 0:s.date,class:"hover:border-b-2 hover:border-gray-200 hover:bg-blue-200"},[t("td",Tt,n(s.date),1),t("td",Bt,n(s.weekday),1),t("td",{class:"border px-1 py-0.5",title:`${s.shift_start_time} to ${s.shift_end_time}`},n(s.shift_name),9,jt),t("td",{class:"border px-1 py-0.5",title:`Device: ${s.entry_device}`},[t("span",{class:k({"text-yellow-600":s.is_overtime_applicable})},n(s.is_overtime_applicable&&s.entry_time?nt(s.status):"")+" "+n(s.entry_time),3)],8,Ot),t("td",{class:"border px-1 py-0.5",title:`Device: ${s.exit_device}`},[r(n(s.exit_time)+" ",1),!s.exit_time&&new Date(s.date)<new Date&&s.status==="Present"?(l(),m("div",Nt,[tt(v,{to:{name:"ManualAttendanceAdd",query:{type:"Forget Punch",date:new Date(s.date+" UTC").toISOString().split("T")[0],entry_time:s.entry_time,exit_time:s.exit_time}},class:"btn-link text-red-600"},{default:c(()=>e[24]||(e[24]=[r(" (Check Out Apply) ")])),_:2,__:[24]},1032,["to"])])):_("",!0)],8,qt),t("td",Pt,n(s.working_hours),1),t("td",Ut,n(s.overtime_hours),1),t("td",Vt,[s.late_duration&&s.status!=="Weekend"?(l(),m("div",Wt,[r(n(s.late_duration)+" ",1),s.first_short_leave?(l(),b(v,{key:0,to:{name:"ShortLeaveShow",params:{id:s.first_short_leave_id}},class:k({"text-green-500":s.first_short_leave==="Approved","text-yellow-500":s.first_short_leave==="Pending","text-red-500":s.first_short_leave==="Rejected"})},{default:c(()=>[r(" ("+n(s.first_short_leave)+") ",1)]),_:2},1032,["to","class"])):_("",!0),s.late_duration&&!s.first_short_leave?(l(),b(v,{key:1,to:{name:"ShortLeaveAdd",query:{type:"Delay",start_time:s.shift_start_time,end_time:s.entry_time}},class:"btn-link text-red-600"},{default:c(()=>e[25]||(e[25]=[r(" (Apply) ")])),_:2,__:[25]},1032,["to"])):_("",!0)])):_("",!0)]),t("td",zt,[s.early_leave_duration&&s.status!=="Weekend"?(l(),m("div",Ht,[r(n(s.early_leave_duration)+" ",1),s.last_short_leave?(l(),b(v,{key:0,to:{name:"ShortLeaveShow",params:{id:s.last_short_leave_id}},class:k(["px-1",{"text-green-500":s.last_short_leave==="Approved","text-yellow-500":s.last_short_leave==="Pending","text-red-500":s.last_short_leave==="Rejected"}])},{default:c(()=>[r(" ("+n(s.last_short_leave)+") ",1)]),_:2},1032,["to","class"])):_("",!0),s.early_leave_duration&&!s.last_short_leave?(l(),b(v,{key:1,to:{name:"ShortLeaveAdd",query:{type:"Early",start_time:s.exit_time,end_time:s.shift_end_time}},class:"btn-link text-red-600"},{default:c(()=>e[26]||(e[26]=[r(" (Apply) ")])),_:2,__:[26]},1032,["to"])):_("",!0)])):_("",!0)]),t("td",{class:k(["border px-1 py-0.5 font-semibold",{"text-red-600":s.status==="Absent","text-green-600":s.status==="Present","text-yellow-600":s.is_overtime_applicable}])},n(s.status),3)]))),128))])])])]))])}}};export{Jt as default};
