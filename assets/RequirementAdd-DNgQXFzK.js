import{r as k,e as B,z as T,c as p,o as d,a as e,t as $,w as g,h as R,j as q,p as u,v as C,i as h,g as y,B as L,f as I,F as E,k as S,q as z,u as O}from"./index-yO-rMsO4.js";import{_ as M}from"./CompanyDepartmentSelectInput-BSYGQtb5.js";import{R as D}from"./RequiredIcon-OqaWMZC9.js";import{a as P}from"./requirement-B9W_wJXN.js";import{u as W}from"./company-D5YIVe1t.js";import{u as G}from"./tags-DSiGCCPV.js";import{L as H}from"./LoaderView-BocSFX7a.js";import{S as F}from"./SelectDropdown-yqTDGlyr.js";import{T as J}from"./TextWithHr-yfCIWfVU.js";import{u as K}from"./department-C9ZHB7Ey.js";import{_ as A}from"./UserChip-Cqxm1bHO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function Q(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){const b=Math.random()*16|0;return(f==="x"?b:b&3|8).toString(16)})}const X={class:"border-2 border-gray-800 text-left px-4 py-4 text-gray-800 print:text-black align-top"},Y={class:"font-semibold whitespace-nowrap text-2xl"},Z={class:"border-2 border-gray-800 px-2 py-8 text-gray-800 print:text-black text-base whitespace-nowrap"},ee={class:"mb-4"},te={class:"block text-gray-600 text-sm mb-1 font-medium"},se={class:"mb-4"},oe={class:"flex items-center justify-between h-full"},re={class:"max-w-xs w-full h-full"},le={key:0,class:"relative w-full"},ae={key:0,class:"absolute right-1 text-xl top-0 bottom-0 flex items-center"},ie={class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base px-3 whitespace-nowrap print:whitespace-normal print:p-0"},ne={class:"mb-4"},de={__name:"RequirementFormDetailItem",props:{fromDepartmentId:{type:[Number,String],required:!0},serial:{type:Number,required:!0},uuid:{type:String,required:!0}},emits:["update","removeClick"],setup(f,{emit:b}){const i=f,c=b,n=K(),s=k({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:"4"}),x=k([]);return B(async()=>{x.value=await n.fetchDepartmentEmployee([i.fromDepartmentId])}),T(()=>i.fromDepartmentId,async()=>{x.value=await n.fetchDepartmentEmployee([i.fromDepartmentId])}),T(()=>({...s.value}),r=>{c("update",{...r,uuid:i.uuid})}),(r,o)=>(d(),p("tr",null,[e("td",X,[e("div",Y,$(i.serial),1),e("button",{type:"button",onClick:o[0]||(o[0]=g(l=>c("removeClick",f.uuid),["prevent"])),class:"btn-2-red mt-8"}," Remove ")]),e("td",Z,[e("div",ee,[e("label",te,[o[7]||(o[7]=q(" Title ")),u(D)]),R(e("input",{"onUpdate:modelValue":o[1]||(o[1]=l=>s.value.title=l),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[C,s.value.title]])]),e("div",se,[o[8]||(o[8]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),R(e("textarea",{rows:"3","onUpdate:modelValue":o[2]||(o[2]=l=>s.value.description=l),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[C,s.value.description]])]),e("div",oe,[e("div",re,[o[9]||(o[9]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor ",-1)),u(F,{modelValue:s.value.supervisor_id,"onUpdate:modelValue":o[4]||(o[4]=l=>s.value.supervisor_id=l),options:x.value,placeholder:"--NO SUPERVISOR--",class:"h-10"},{option:h(({option:l})=>[u(A,{user:l||{}},null,8,["user"])]),"selected-option":h(({option:l})=>[l?(d(),p("div",le,[u(A,{user:l||{}},null,8,["user"]),s.value.supervisor_id?(d(),p("div",ae,[e("button",{onClick:o[3]||(o[3]=g(N=>s.value.supervisor_id=null,["prevent"])),class:"text-gray-6 font-semibold 00 hover:text-red-700"}," Ã— ")])):y("",!0)])):y("",!0)]),_:1},8,["modelValue","options"])]),e("div",null,[o[11]||(o[11]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),R(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 h-10","onUpdate:modelValue":o[5]||(o[5]=l=>s.value.priority=l)},o[10]||(o[10]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[L,s.value.priority]])])])]),e("td",ie,[e("div",ne,[o[12]||(o[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),R(e("input",{type:"date","onUpdate:modelValue":o[6]||(o[6]=l=>s.value.better_to_complete_on=l),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[C,s.value.better_to_complete_on]])])])]))}},ue={class:"w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},me={class:"sticky top-0 pt-4 bg-white z-10"},pe={class:"block text-gray-600 text-sm mb-1 font-medium"},be={class:"block text-gray-600 text-sm mb-1 font-medium"},ce={class:"mb-4 col-span-4"},xe={class:"col-span-full"},ve={class:"mb-8 mt-10"},fe={class:"w-full table-auto print:table-fixed mt-8"},ge={class:"mb-8 border rounded-md p-8 flex items-center justify-center bg-gray-50"},ye={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},_e={key:0,class:"mb-4 text-red-500 font-medium"},we={key:1,class:"mb-4"},ke={class:"flex items-center justify-between gap-4"},he=["disabled"],Re={__name:"RequirementAddForm",emits:["create","cancelClick","error"],setup(f,{emit:b}){const i=b,c=G(),n=W(),s=k(""),x=k(""),r=k({from_department_id:"",to_department_id:"",website_tags:[],details:[]});B(async()=>{s.value="loading",c.fetchTags("website"),await n.fetchCompanies({with:"departments",ignore_permission:!0}),await n.fetchMyCompanies({with:"departments"}),s.value="",U()});async function o(){var t,m,_,w;s.value="submitting";const v={...r.value};try{const a=await P(v);i("create",a),s.value="create"}catch(a){i("error",(m=(t=a.response)==null?void 0:t.data)==null?void 0:m.message),x.value=(w=(_=a.response)==null?void 0:_.data)==null?void 0:w.message,s.value="error"}}function l(v,t){r.value.details=r.value.details.map(m=>m.uuid===v?(console.log({uuid:v}),{...m,...t}):{...m})}function N(v){r.value.details=r.value.details.filter(t=>t.uuid!==v)}function U(){r.value.details=[...r.value.details,{uuid:Q(),title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:"4"}]}return(v,t)=>{var m,_,w;return d(),p("div",ue,[e("div",me,[t[7]||(t[7]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add New Requirement",-1)),t[8]||(t[8]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:t[0]||(t[0]=g(a=>i("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:g(o,["prevent"]),class:"z-0 grid grid-cols-8 gap-4"},[s.value!=="loading"&&s.value!=="submitting"?(d(),p(E,{key:0},[u(M,{modelValue:r.value.from_department_id,"onUpdate:modelValue":t[1]||(t[1]=a=>r.value.from_department_id=a),companies:((m=S(n))==null?void 0:m.myCompanies)||[],class:"mb-4 col-span-2",className:{select:"h-10"}},{label:h(()=>[e("label",pe,[t[9]||(t[9]=q(" From ")),u(D)])]),_:1},8,["modelValue","companies"]),u(M,{modelValue:r.value.to_department_id,"onUpdate:modelValue":t[2]||(t[2]=a=>r.value.to_department_id=a),companies:((_=S(n))==null?void 0:_.companies)||[],class:"mb-4 col-span-2",className:{select:"h-10"}},{label:h(()=>[e("label",be,[t[10]||(t[10]=q(" To ")),u(D)])]),_:1},8,["modelValue","companies"]),e("div",ce,[t[11]||(t[11]=e("label",{class:"text-gray-800"},"Websites",-1)),u(F,{options:S(c).tags,modelValue:r.value.website_tags,"onUpdate:modelValue":t[3]||(t[3]=a=>r.value.website_tags=a),taggable:"",label:"name",value:"name",class:"min-h-10"},null,8,["options","modelValue"])])],64)):y("",!0),e("div",xe,[e("div",ve,[u(J,{class:"mb-5"},{default:h(()=>t[12]||(t[12]=[e("h3",{class:"font-semibold text-xl text-gray-800 mx-2"},"Requirement details",-1)])),_:1,__:[12]}),e("table",fe,[t[13]||(t[13]=e("thead",null,[e("tr",null,[e("th",{class:"border-2 border-gray-800 text-left px-4 text-gray-800 print:text-black text-xl font-semibold whitespace-nowrap w-[5%]"}," SL "),e("th",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap w-[65%]"}," Requirement Details "),e("th",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base px-3 font-semibold whitespace-nowrap print:whitespace-normal print:p-0 w-[15%]"}," Better To Complete ")])],-1)),e("tbody",null,[(d(!0),p(E,null,z(((w=r.value)==null?void 0:w.details)||[],(a,j)=>(d(),I(de,{key:a.uuid,serial:j+1,uuid:a.uuid,"from-department-id":r.value.from_department_id,onUpdate:V=>l(a.uuid,V),onRemoveClick:t[4]||(t[4]=V=>N(V))},null,8,["serial","uuid","from-department-id","onUpdate"]))),128))])])]),e("div",ge,[e("button",{class:"btn-2 pl-2 text-base",onClick:t[5]||(t[5]=g(()=>U(),["prevent"]))},t[14]||(t[14]=[e("i",{class:"fad fa-plus-circle text-2xl mr-2"},null,-1),q("Add Requirement ")]))]),e("div",ye,[x.value?(d(),p("div",_e,$(x.value),1)):y("",!0),x.value?(d(),p("hr",we)):y("",!0),e("div",ke,[e("button",{type:"button",onClick:t[6]||(t[6]=g(a=>i("cancelClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:s.value=="loading"||s.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},$(s.value=="submitting"?"Saving...":"Save"),9,he)])])])],32),s.value==="loading"||s.value==="submitting"?(d(),I(H,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):y("",!0)])}}},qe={class:"container mx-auto p-6"},Be={__name:"RequirementAdd",setup(f){const b=O();function i(c){var s;const n=((s=c.data)==null?void 0:s.requirement)||null;n&&b.push({name:"RequirementShow",params:{id:n.id}})}return(c,n)=>(d(),p("div",qe,[u(Re,{onCreate:i})]))}};export{Be as default};
