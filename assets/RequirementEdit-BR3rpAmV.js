import{s as _,r as d,x as D,b as M,z as R,c as i,a as t,h as s,w as C,d as b,B as k,F as L,q as j,v as E,l as w,t as v,e as H,f as h,o as l,g as P}from"./index-a4uAmw83.js";import{_ as T}from"./MultiselectDropdown-c7ESu5KY.js";import{_ as B}from"./TextEditor-B-KsCg_G.js";import{u as G}from"./department-CdsblAOa.js";import{u as N}from"./useProjectStore-D2LTADTR.js";import{u as $}from"./useRequirementStore-Ck6JfxKu.js";import"./vue-multiselect.esm-CjJscMxM.js";const A={class:"container mx-auto p-6"},F={class:"max-w-xl mx-auto bg-white shadow-lg rounded-lg p-6"},O={key:0,class:"text-center py-4 text-gray-500"},W={class:"mb-4"},z=["value"],J={class:"mb-4"},K={class:"mb-4"},Q={class:"mb-4"},X={class:"mb-4"},Y={key:0,class:"mb-4 text-red-500 font-medium"},Z={class:"flex items-center gap-4"},ee=["disabled"],te={key:2,class:"text-center py-4 text-red-500"},ue={__name:"RequirementEdit",setup(oe){const f=N(),o=$(),V=h(),g=P(),y=G(),{departments:x}=_(y),{projects:I}=_(f),q=V.params.id,u=d(""),a=d(""),m=d("HIGH"),p=d(null),S=D(()=>{var n;return(n=p.value)==null?void 0:n.id}),c=d(!1);M(async()=>{await o.fetchRequirement(q),y.fetchDepartments(),f.fetchProjects(),a.value=o.requirement.description[0]||"",m.value=o.requirement.priority,u.value=o.requirement.project_id}),R(()=>o.requirement,n=>{a.value=n.description[0]||""}),R([x,()=>o.requirement],([n,e])=>{n.length&&(e!=null&&e.department_id)&&(p.value=n.find(r=>r.id===e.department_id)||null)},{immediate:!0});const U=async()=>{c.value=!0,await o.updateRequirement(q,{project_id:u.value,title:o.requirement.title,department_id:S.value,priority:m.value,description:[a.value]}),c.value=!1,o.error||g.push({name:"RequirementList"})};return(n,e)=>(l(),i("div",A,[t("div",F,[e[13]||(e[13]=t("h2",{class:"text-2xl font-semibold text-gray-800 mb-4"},"Edit Requirement",-1)),s(o).loading?(l(),i("div",O," Loading requirement details... ")):s(o).requirement?(l(),i("form",{key:1,onSubmit:C(U,["prevent"])},[t("div",W,[e[7]||(e[7]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Priority",-1)),b(t("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>u.value=r),class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},[e[6]||(e[6]=t("option",{value:""},"Select Project",-1)),(l(!0),i(L,null,j(s(I),r=>(l(),i("option",{key:r.id,value:r.id},v(r.name),9,z))),128))],512),[[k,u.value]])]),t("div",J,[e[8]||(e[8]=t("label",{class:"block text-gray-700 font-medium mb-2"}," Requirement Title ",-1)),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s(o).requirement.title=r),type:"text",required:"",placeholder:"Enter requirement title",class:"w-full px-4 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[E,s(o).requirement.title]])]),t("div",K,[e[9]||(e[9]=t("label",{class:"block text-gray-700 font-medium mb-2"}," Department ",-1)),w(T,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=r=>p.value=r),options:s(x),multiple:!1,"track-by":"id",label:"name",placeholder:"Select department",required:""},null,8,["modelValue","options"])]),t("div",Q,[e[11]||(e[11]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Priority",-1)),b(t("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>m.value=r),class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},e[10]||(e[10]=[t("option",{value:"LOW"},"LOW",-1),t("option",{value:"MEDIUM"},"MEDIUM",-1),t("option",{value:"HIGH"},"HIGH",-1),t("option",{value:"CRITICAL"},"CRITICAL",-1)]),512),[[k,m.value]])]),t("div",X,[e[12]||(e[12]=t("label",{class:"block text-gray-700 font-medium mb-2"}," Description ",-1)),w(B,{modelValue:a.value,"onUpdate:modelValue":e[4]||(e[4]=r=>a.value=r),placeholder:"Update requirement description",class:"border rounded-md"},null,8,["modelValue"])]),s(o).error?(l(),i("div",Y,v(s(o).error),1)):H("",!0),t("div",Z,[t("button",{disabled:c.value,type:"submit",class:"bg-green-500 hover:bg-green-600 text-white font-semibold px-5 py-2 rounded transition"},v(c.value?"Updating...":"Update Requirement"),9,ee),t("button",{type:"button",onClick:e[5]||(e[5]=r=>s(g).push({name:"RequirementList"})),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel ")])],32)):(l(),i("div",te,v(s(o).error||"Requirement not found."),1))])]))}};export{ue as default};
