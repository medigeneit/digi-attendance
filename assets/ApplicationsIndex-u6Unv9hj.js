import{r as p,h as D,q as R,c as i,o as d,a as e,k as u,l as m,v as U,z as $,H as h,i as w,F as H,e as I,t as l,n,b as q}from"./index-rscWEtDR.js";import{u as z}from"./adminCareers-Cnwz8ZtS.js";const B={class:"max-w-7xl mx-auto px-4 py-8"},F={class:"mt-6 grid md:grid-cols-5 gap-3"},J={class:"flex gap-2"},O={class:"mt-6 overflow-x-auto bg-white rounded-2xl border"},T={class:"min-w-full text-sm"},K={class:"px-4 py-3"},L={class:"font-medium"},P={class:"text-xs text-gray-500"},E={class:"px-4 py-3"},G={class:"font-medium"},Q={class:"text-xs text-gray-500"},W={class:"px-4 py-3"},X={class:"px-4 py-3"},Y=["value","onChange"],Z={class:"px-4 py-3"},ee={class:"text-xs"},te={class:"px-4 py-3 text-right"},se=["onClick"],oe={key:0},le={class:"mt-4 flex items-center justify-between"},ae={class:"text-sm text-gray-500"},ne={class:"flex items-center gap-2"},ie=["disabled"],de=["disabled"],pe={key:0,class:"fixed inset-0 bg-black/40 z-50 flex"},re={class:"ml-auto h-full w-full max-w-xl bg-white shadow-xl p-6 overflow-y-auto"},ue={key:0,class:"mt-4 space-y-3 text-sm"},ve={class:"font-medium"},ce={class:"text-gray-500"},xe={key:0},ge={class:"font-medium"},ye={class:"text-gray-500"},fe={key:0},me={class:"whitespace-pre-wrap"},be=["href"],_e={key:1},he={class:"bg-gray-50 border rounded p-3 overflow-x-auto"},we={class:"flex items-center gap-3"},ke=["value"],Ae={__name:"ApplicationsIndex",setup(Ce){const a=z(),c=p(""),x=p(""),g=p(null),y=p(1),f=p(15),b=p(!1),o=p(null);async function v(){try{await a.fetchApplications({q:c.value||void 0,status:x.value||void 0,job_id:g.value||void 0,per_page:f.value,page:y.value})}catch{}}function V(r){o.value=r,b.value=!0}function k(){b.value=!1,o.value=null}async function C(r,t){try{await a.updateApplicationStatus(r.id,{status:t,rating:r.rating||null})}catch{alert("Update failed")}}return D(v),R([y,f],v),(r,t)=>{var _,M,S;return d(),i("div",B,[t[22]||(t[22]=e("h1",{class:"text-2xl font-semibold"},"Applications",-1)),e("div",F,[m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),onKeyup:$(v,["enter"]),placeholder:"Search applicant name/email…",class:"border rounded-lg px-3 py-2"},null,544),[[U,c.value]]),m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),class:"border rounded-lg px-3 py-2"},t[8]||(t[8]=[e("option",{value:null},"All Jobs",-1)]),512),[[h,g.value]]),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>x.value=s),class:"border rounded-lg px-3 py-2"},t[9]||(t[9]=[w('<option value="">Any Status</option><option value="new">New</option><option value="shortlisted">Shortlisted</option><option value="interviewed">Interviewed</option><option value="offered">Offered</option><option value="hired">Hired</option><option value="rejected">Rejected</option>',7)]),512),[[h,x.value]]),e("div",J,[e("button",{onClick:v,class:"px-4 py-2 rounded-lg bg-indigo-600 text-white w-full"},"Filter"),e("button",{onClick:t[3]||(t[3]=s=>{c.value="",g.value=null,x.value="",v()}),class:"px-4 py-2 rounded-lg border w-full"},"Reset")])]),e("div",O,[e("table",T,[t[12]||(t[12]=e("thead",null,[e("tr",{class:"text-left border-b"},[e("th",{class:"px-4 py-3"},"Applicant"),e("th",{class:"px-4 py-3"},"Job"),e("th",{class:"px-4 py-3"},"Applied"),e("th",{class:"px-4 py-3"},"Status"),e("th",{class:"px-4 py-3"},"Rating"),e("th",{class:"px-4 py-3 text-right"},"Actions")])],-1)),e("tbody",null,[(d(!0),i(H,null,I(n(a).applications,s=>{var A,j;return d(),i("tr",{key:s.id,class:"border-b hover:bg-gray-50"},[e("td",K,[e("div",L,l(s.full_name),1),e("div",P,l(s.email),1)]),e("td",E,[e("div",G,l(((A=s.career)==null?void 0:A.title)||"—"),1),e("div",Q,l((j=s.career)==null?void 0:j.slug),1)]),e("td",W,l((s.applied_at||"").toString().slice(0,19).replace("T"," ")),1),e("td",X,[e("select",{class:"border rounded px-2 py-1 text-xs",value:s.status,onChange:N=>C(s,N.target.value)},t[10]||(t[10]=[w('<option value="new">New</option><option value="shortlisted">Shortlisted</option><option value="interviewed">Interviewed</option><option value="offered">Offered</option><option value="hired">Hired</option><option value="rejected">Rejected</option>',6)]),40,Y)]),e("td",Z,[e("span",ee,l(s.rating||"—"),1)]),e("td",te,[e("button",{onClick:N=>V(s),class:"px-3 py-1 rounded bg-blue-600 text-white"},"View",8,se)])])}),128)),(_=n(a).applications)!=null&&_.length?u("",!0):(d(),i("tr",oe,t[11]||(t[11]=[e("td",{colspan:"6",class:"px-4 py-8 text-center text-gray-500"},"No applications found",-1)])))])])]),e("div",le,[e("div",ae," Page "+l(n(a).appsMeta.page)+" / "+l(n(a).appsMeta.last_page)+" • "+l(n(a).appsMeta.total)+" total ",1),e("div",ne,[e("button",{disabled:n(a).appsMeta.page<=1,onClick:t[4]||(t[4]=s=>y.value=Math.max(1,n(a).appsMeta.page-1)),class:"px-3 py-1 rounded border"},"Prev",8,ie),e("button",{disabled:n(a).appsMeta.page>=n(a).appsMeta.last_page,onClick:t[5]||(t[5]=s=>y.value=Math.min(n(a).appsMeta.last_page,n(a).appsMeta.page+1)),class:"px-3 py-1 rounded border"},"Next",8,de),m(e("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>f.value=s),class:"border rounded px-2 py-1"},t[13]||(t[13]=[e("option",{value:15},"15",-1),e("option",{value:30},"30",-1),e("option",{value:60},"60",-1)]),512),[[h,f.value,void 0,{number:!0}]])])]),b.value?(d(),i("div",pe,[e("div",re,[e("div",{class:"flex items-center justify-between"},[t[14]||(t[14]=e("h3",{class:"text-xl font-semibold"},"Application Details",-1)),e("button",{onClick:k,class:"text-gray-500 hover:text-black"},"✕")]),o.value?(d(),i("div",ue,[e("div",null,[t[15]||(t[15]=e("div",{class:"text-gray-500"},"Applicant",-1)),e("div",ve,l(o.value.full_name),1),e("div",ce,[q(l(o.value.email)+" ",1),o.value.phone?(d(),i("span",xe,"• "+l(o.value.phone),1)):u("",!0)])]),e("div",null,[t[16]||(t[16]=e("div",{class:"text-gray-500"},"Job",-1)),e("div",ge,l((M=o.value.job)==null?void 0:M.title),1),e("div",ye,l((S=o.value.job)==null?void 0:S.slug),1)]),o.value.cover_letter?(d(),i("div",fe,[t[17]||(t[17]=e("div",{class:"text-gray-500"},"Cover Letter",-1)),e("div",me,l(o.value.cover_letter),1)])):u("",!0),e("div",null,[t[18]||(t[18]=e("div",{class:"text-gray-500"},"Resume",-1)),e("a",{href:`https://hrm-file.s3.ap-southeast-1.amazonaws.com/${o.value.resume_path}`,target:"_blank",class:"text-indigo-600 underline"},"Download resume",8,be)]),o.value.answers?(d(),i("div",_e,[t[19]||(t[19]=e("div",{class:"text-gray-500"},"Answers",-1)),e("pre",he,l(o.value.answers),1)])):u("",!0),e("div",we,[t[21]||(t[21]=e("label",{class:"text-gray-500"},"Status",-1)),e("select",{class:"border rounded px-2 py-1",value:o.value.status,onChange:t[7]||(t[7]=s=>C(o.value,s.target.value))},t[20]||(t[20]=[w('<option value="new">New</option><option value="shortlisted">Shortlisted</option><option value="interviewed">Interviewed</option><option value="offered">Offered</option><option value="hired">Hired</option><option value="rejected">Rejected</option>',6)]),40,ke)])])):u("",!0),e("div",{class:"mt-6 text-right"},[e("button",{onClick:k,class:"px-4 py-2 rounded-lg bg-emerald-600 text-white"},"Close")])])])):u("",!0)])}}};export{Ae as default};
