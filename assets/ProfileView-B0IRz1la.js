import{o as l,c as r,u as H,s as J,i as K,r as o,a as e,h as a,t as u,j as c,k as j,l as A,m as Q,w as W,d as p,v,F as X,n as Y}from"./index-D9fyjAEt.js";import{_ as Z}from"./PhotoModal-Ck_Mib-Z.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as te}from"./user-DnhgJAv6.js";const se={},le={class:"bg-gray-200 w-full h-4 rounded-sm animate-pulse"};function oe(I,d){return l(),r("div",le)}const f=ee(se,[["render",oe]]),ae={class:"my-container max-w-xl"},ne={class:"card-bg p-4 md:p-8 flex flex-col items-center relative"},ie={class:"flex justify-center w-full"},re=["src"],de={key:0,class:"space-y-4"},ue={class:"title-md text-center"},pe={class:"grid grid-cols-2 items-center gap-4"},ve={key:1},ce={key:1},fe={key:1},me={key:1},ge={class:"text-wrap"},ye={key:1},_e={key:1},be={class:"grid grid-cols-4 items-center"},he={class:"grid grid-cols-4 items-center"},xe={class:"grid grid-cols-4 items-center"},ke={class:"grid grid-cols-4 items-center"},Pe={class:"grid grid-cols-4 items-center"},we={class:"grid grid-cols-4 items-center"},Ce={__name:"ProfileView",setup(I){te();const d=H(),{user:s}=J(d),m=K(),g=o(!1),y=o(""),_=o(""),b=o(""),h=o(""),x=o(""),k=o(""),w=o(!1),F=o(null),P=o(null),U=o(!1),S=o(!1),O=()=>{F.value=s.value.photo,w.value=!0},V=()=>{w.value=!1,P.value=null},R=()=>{g.value=!0,y.value=s.value.name,_.value=s.value.phone,b.value=s.value.email,h.value=s.value.nid,x.value=s.value.date_of_birth,k.value=s.value.address},$=()=>{g.value=!1},L=async()=>{try{const i={name:y.value,phone:_.value,email:b.value,nid:h.value,date_of_birth:x.value,address:k.value};await d.updateProfile(i),g.value=!1,m.success("Profile updated successfully!");return}catch(i){console.error("Failed to update profile:",i),m.error(d.error||"Failed to save profile!");return}},z=i=>{P.value=i},q=async()=>{if(!P.value)return;const i=new FormData;i.append("photo",P.value),i.append("user_id",s.value.id);try{U.value=!0,await d.uploadProfilePhoto(i),S.value=!0,setTimeout(()=>{V(),U.value=!1,S.value=!1},1500),m.success("Image updated successfully!")}catch(t){console.error("Failed to upload photo:",t),m.error(d.error||"Failed to save profile!")}finally{U.value=!1}};return(i,t)=>{var C,D,E,B,M,N,T;const G=Y("RouterLink");return l(),r(X,null,[e("div",ae,[e("div",ne,[t[21]||(t[21]=e("h1",{class:"title-lg"},"My Profile",-1)),e("div",{onClick:O,class:"bg-gray-200 size-40 rounded-full overflow-hidden relative"},[e("div",ie,[e("img",{class:"object-cover",src:((C=a(s))==null?void 0:C.photo)||"/default-avatar.png",alt:"Profile Photo"},null,8,re)])]),g.value?(l(),r("div",_e,[t[20]||(t[20]=e("h1",{class:"text-center title-md"},"Edit Profile",-1)),e("form",{onSubmit:W(L,["prevent"]),class:"space-y-2"},[e("div",be,[t[13]||(t[13]=e("label",{for:"name"},"Name:",-1)),p(e("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=n=>y.value=n),type:"text",class:"input-1 col-span-3"},null,512),[[v,y.value]])]),e("div",he,[t[14]||(t[14]=e("label",{for:"phone"},"Phone:",-1)),p(e("input",{id:"phone","onUpdate:modelValue":t[1]||(t[1]=n=>_.value=n),type:"text",class:"input-1 col-span-3"},null,512),[[v,_.value]])]),e("div",xe,[t[15]||(t[15]=e("label",{for:"email"},"Email:",-1)),p(e("input",{id:"email","onUpdate:modelValue":t[2]||(t[2]=n=>b.value=n),type:"text",class:"input-1 col-span-3"},null,512),[[v,b.value]])]),e("div",ke,[t[16]||(t[16]=e("label",{for:"nid"},"NID:",-1)),p(e("input",{id:"nid","onUpdate:modelValue":t[3]||(t[3]=n=>h.value=n),type:"text",class:"input-1 col-span-3"},null,512),[[v,h.value]])]),e("div",Pe,[t[17]||(t[17]=e("label",{for:"date_of_birth"},"Date of Birth:",-1)),p(e("input",{id:"date_of_birth","onUpdate:modelValue":t[4]||(t[4]=n=>x.value=n),type:"date",class:"input-1 col-span-3"},null,512),[[v,x.value]])]),e("div",we,[t[18]||(t[18]=e("label",{for:"address"},"Address:",-1)),p(e("textarea",{id:"address",rows:"3","onUpdate:modelValue":t[5]||(t[5]=n=>k.value=n),type:"text",class:"input-1 col-span-3"},null,512),[[v,k.value]])]),e("div",{class:"flex justify-center gap-4 pt-4"},[e("button",{class:"btn-3",onClick:$},"Cancel"),t[19]||(t[19]=e("button",{class:"btn-2",type:"submit"},"Update",-1))])],32)])):(l(),r("div",de,[e("p",ue,u((D=a(s))==null?void 0:D.name),1),e("div",pe,[t[6]||(t[6]=e("div",null,[e("strong",null,"Phone:")],-1)),e("div",null,[a(s)?(l(),r("span",ve,u((E=a(s))==null?void 0:E.phone),1)):(l(),c(f,{key:0}))]),t[7]||(t[7]=e("div",null,[e("strong",null,"Email:")],-1)),e("div",null,[a(s)?(l(),r("span",ce,u((B=a(s))==null?void 0:B.email),1)):(l(),c(f,{key:0}))]),t[8]||(t[8]=e("div",null,[e("strong",null,"NID:")],-1)),e("div",null,[a(s)?(l(),r("span",fe,u((M=a(s))==null?void 0:M.nid),1)):(l(),c(f,{key:0}))]),t[9]||(t[9]=e("div",null,[e("strong",null,"Date of Birth:")],-1)),e("div",null,[a(s)?(l(),r("span",me,u((N=a(s))==null?void 0:N.date_of_birth),1)):(l(),c(f,{key:0}))]),t[10]||(t[10]=e("div",{class:""},[e("strong",null,"Address:")],-1)),e("div",ge,[a(s)?(l(),r("span",ye,u((T=a(s))==null?void 0:T.phone),1)):(l(),c(f,{key:0}))])]),e("button",{class:"btn-2 absolute top-4 right-4",onClick:R},t[11]||(t[11]=[e("i",{class:"far fa-edit"},null,-1),j(" Edit ")])),A(G,{class:"btn-2",to:"/profile/change-password"},{default:Q(()=>t[12]||(t[12]=[j(" Change Password ")])),_:1})]))])]),A(Z,{imageSrc:F.value,isOpen:w.value,onClose:V,onFileSelected:z,onUploadPhoto:q},null,8,["imageSrc","isOpen"])],64)}}};export{Ce as default};
