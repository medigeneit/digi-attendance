import{d as O,a3 as U,y as B,r as g,e as V,m as T,c as f,g as d,o as s,a as n,h as L,v as q,t as j,u as Z,b as K,z as Q,k as A,F as W,n as X,f as m,p as Y,j as M,i as I}from"./index-C5Xn0f7U.js";import{u as G}from"./leave-application-CopOwE8Y.js";import{u as ee}from"./exchange-DPlXSGP9.js";import{u as ae}from"./manual-attendance-DTp5YwyV.js";import{u as te}from"./short-leave-B8r6Iz5_.js";const oe={key:0,class:"text-center space-y-2 print:hidden"},ne={key:0,class:"modal-bg"},re={class:"modal-card"},se={class:"flex justify-end gap-2 mt-4"},le={key:1,class:"mt-2"},ie={class:"flex justify-end gap-2 pt-2"},ce={__name:"ExchangeApplicationApprovalSection",props:{application:Object,notificationId:{type:String,required:!0}},setup(C){const b=O(),h=U(),k=ee(),{user:S}=B(b),$=C,r=g(null);V(()=>{r.value=JSON.parse(JSON.stringify($.application))});const i=g(!1),p=g(""),c=g(!1),v=g("");function o(){c.value=!0,i.value=!1}const u=[{key:"handover",approved_field:"handover_user_id",approved_by_field:null,label:"Handover",action:async a=>{await k.handoverAccept({id:a,note:v.value}),await _(),c.value=!1},condition:()=>{var a,t;return!((a=r.value)!=null&&a.status)&&((t=r.value)==null?void 0:t.handover_user_id)===S.value.id}},{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await k.inChargeAccept({id:a,note:v.value}),await _(),c.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await k.recommendByAccept({id:a,note:v.value}),await _(),c.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await k.approvedByAccept({id:a,note:v.value}),await _(),c.value=!1}}],y=T(()=>u.find(a=>{var t,l,w,x;return r.value?a.key==="handover"?a.condition():((t=r.value)==null?void 0:t.status)!=="Rejected"&&((l=r.value)==null?void 0:l.status)!=="Approved"&&!((w=r.value)!=null&&w[a.approved_field])&&((x=r.value)==null?void 0:x[a.approved_by_field])===S.value.id:!1})),e=()=>{i.value&&p.value?(R(),i.value=!1):i.value=!0};async function R(){try{await k.rejectExchange(r.value.id,p.value),alert("Exchange application rejected!"),p.value="",await _(r.value.id)}catch(a){alert(a.message||"Something went wrong!")}}async function _(){await h.markAsRead($.notificationId)}return(a,t)=>y.value&&r.value?(s(),f("div",oe,[c.value?(s(),f("div",ne,[n("div",re,[t[4]||(t[4]=n("h3",{class:"title-lg"},"Accept Application",-1)),L(n("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>v.value=l),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,v.value]]),n("div",se,[n("button",{class:"btn-3",onClick:t[1]||(t[1]=l=>c.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:t[2]||(t[2]=l=>y.value.action(r.value.id))}," Confirm ")])])])):d("",!0),i.value?(s(),f("div",le,[L(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>p.value=l),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter accept note"},null,512),[[q,p.value]])])):d("",!0),n("div",ie,[i.value?d("",!0):(s(),f("button",{key:0,class:"btn-2",onClick:o},"Approve")),n("button",{class:"btn-4 bg-red-500 text-white",onClick:e},"Reject")])])):d("",!0)}},de={class:"text-center space-y-2 print:hidden"},ue={key:0,class:"modal-bg"},pe={class:"modal-card"},ve={class:"flex justify-end gap-2 mt-4"},_e={key:1,class:"mt-2"},fe={class:"flex justify-end gap-2 pt-2"},ye={__name:"LeaveApplicationApprovalSection",props:{application:{type:Object,required:!0},notificationId:{type:String,required:!0}},setup(C){const b=O(),h=G(),k=U(),{user:S}=B(b),$=C,r=g(null);V(()=>{r.value=JSON.parse(JSON.stringify($.application))});const i=g(!1),p=g(""),c=g(!1),v=g("");function o(){i.value=!0,c.value=!1}const u=[{key:"handover",approved_field:"handover_user_id",approved_by_field:null,label:"Handover",action:async a=>{await h.acceptHandover({id:a,note:p.value}),await _(),i.value=!1},condition:()=>{var a,t;return!((a=r.value)!=null&&a.status)&&((t=r.value)==null?void 0:t.handover_user_id)===S.value.id}},{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await h.acceptInCharge({id:a,note:p.value}),await _(),i.value=!1}},{key:"coordinator",approved_field:"coordinator_user_id",approved_by_field:"approval_coordinator_user_id",label:"Coordinator",action:async a=>{await h.acceptCoordinator({id:a,note:p.value}),await _(),i.value=!1}},{key:"operational_admin",approved_field:"operational_admin_user_id",approved_by_field:"approval_operational_admin_user_id",label:"Operational Admin",action:async a=>{await h.acceptOperationalAdmin({id:a,note:p.value}),await _(),i.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await h.acceptRecommendBy({id:a,note:p.value}),await _(),i.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await h.acceptApprovedBy({id:a,note:p.value}),await _(),i.value=!1}}],y=T(()=>u.find(a=>{var w,x,N,E;if(!r.value)return!1;if(a.key==="handover")return a.condition();const t=!!((w=r.value)!=null&&w[a.approved_field]),l=((x=r.value)==null?void 0:x[a.approved_by_field])===S.value.id;return((N=r.value)==null?void 0:N.status)!=="Rejected"&&((E=r.value)==null?void 0:E.status)!=="Approved"&&!t&&l})),e=()=>{c.value&&v.value?(R(),c.value=!1):c.value=!0};async function R(){try{await h.rejectLeaveApplication(r.value.id,{rejection_reason:v.value}),alert("Application rejected!"),v.value="",await _()}catch(a){alert(a.message||"Something went wrong!")}}async function _(){await k.markAsRead($.notificationId)}return(a,t)=>(s(),f("div",de,[i.value?(s(),f("div",ue,[n("div",pe,[t[4]||(t[4]=n("h3",{class:"title-lg"},"Accept Application",-1)),L(n("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>p.value=l),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,p.value]]),n("div",ve,[n("button",{class:"btn-3",onClick:t[1]||(t[1]=l=>i.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:t[2]||(t[2]=l=>y.value.action(r.value.id))}," Confirm ")])])])):d("",!0),c.value?(s(),f("div",_e,[L(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>v.value=l),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter accept note"},null,512),[[q,v.value]])])):d("",!0),n("div",fe,[c.value?d("",!0):(s(),f("button",{key:0,class:"btn-2",onClick:o},"Approve")),n("button",{class:"btn-1",onClick:e},"Reject")])]))}},he={key:0,class:"text-center space-y-2 print:hidden"},ge={key:0,class:"modal-bg"},be={class:"modal-card"},ke={class:"flex justify-end gap-2 mt-4"},we={key:1,class:"mt-2"},xe={class:"flex justify-end gap-2 pt-2"},Ae={__name:"ManualAttendanceApprovalSection",props:{application:{type:Object,required:!0},notificationId:{type:String,required:!0}},setup(C){const b=O(),h=ae(),k=U(),{user:S}=B(b),$=C,r=g(null);V(()=>{r.value=JSON.parse(JSON.stringify($.application))});const i=g(!1),p=g(""),c=g(!1),v=g("");function o(){c.value=!0,i.value=!1}const u=[{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await h.inChargeAccept({id:a,note:v.value}),await _(),c.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await h.recommendByAccept({id:a,note:v.value}),await _(),c.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await h.approvedByAccept({id:a,note:v.value}),await _(),c.value=!1}}],y=T(()=>u.find(a=>{var w,x,N,E;if(!r.value)return!1;if(a.key==="handover")return a.condition();const t=!!((w=r.value)!=null&&w[a.approved_field]),l=((x=r.value)==null?void 0:x[a.approved_by_field])===S.value.id;return((N=r.value)==null?void 0:N.status)!=="Rejected"&&((E=r.value)==null?void 0:E.status)!=="Approved"&&!t&&l})),e=()=>{i.value&&p.value?(R(),i.value=!1):i.value=!0};async function R(){try{await h.rejectLeaveApplication(r.value.id,{rejection_reason:p.value}),alert("Application rejected!"),p.value="",await _(r.value.id)}catch(a){alert(a.message||"Something went wrong!")}}async function _(a){await k.markAsRead($.notificationId)}return(a,t)=>y.value&&r.value?(s(),f("div",he,[c.value?(s(),f("div",ge,[n("div",be,[t[4]||(t[4]=n("h3",{class:"title-lg"},"Accept Application",-1)),L(n("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>v.value=l),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,v.value]]),n("div",ke,[n("button",{class:"btn-3",onClick:t[1]||(t[1]=l=>c.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:t[2]||(t[2]=l=>y.value.action(r.value.id))}," Confirm ")])])])):d("",!0),i.value?(s(),f("div",we,[L(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>p.value=l),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter accept note"},null,512),[[q,p.value]])])):d("",!0),n("div",xe,[i.value?d("",!0):(s(),f("button",{key:0,class:"btn-2",onClick:o},"Approve")),n("button",{class:"btn-1",onClick:e},"Reject")])])):d("",!0)}},Se={key:0,class:"text-center space-y-2 print:hidden"},$e={key:0,class:"modal-bg"},me={class:"modal-card"},je={class:"flex justify-end gap-2 mt-4"},Ce={key:1,class:"mt-2"},Re={class:"flex justify-end gap-2 pt-2"},Ne={__name:"ShortLeaveApplicationApprovalSection",props:{application:{type:Object,required:!0},notificationId:{type:String,required:!0}},setup(C){const b=O(),h=te(),k=U(),{user:S}=B(b),$=C,r=g(null);V(()=>{r.value=JSON.parse(JSON.stringify($.application))});const i=g(!1),p=g(""),c=g(!1),v=g("");function o(){c.value=!0,i.value=!1}const u=[{key:"handover",approved_field:"handover_user_id",approved_by_field:null,label:"Handover",action:async a=>{await h.handoverAccept({id:a,note:v.value}),await _(),c.value=!1},condition:()=>{var a,t;return!((a=r.value)!=null&&a.status)&&((t=r.value)==null?void 0:t.handover_user_id)===S.value.id}},{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await h.inChargeAccept({id:a,note:v.value}),await _(),c.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await h.recommendByAccept({id:a,note:v.value}),await _(),c.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await h.approvedByAccept({id:a,note:v.value}),await _(),c.value=!1}}],y=T(()=>u.find(a=>{var t,l,w,x;return r.value?a.key==="handover"?a.condition():((t=r.value)==null?void 0:t.status)!=="Rejected"&&((l=r.value)==null?void 0:l.status)!=="Approved"&&!((w=r.value)!=null&&w[a.approved_field])&&((x=r.value)==null?void 0:x[a.approved_by_field])===S.value.id:!1})),e=()=>{i.value&&p.value?(R(),i.value=!1):i.value=!0};async function R(){try{await h.rejectShortLeave(r.value.id,p.value),alert("Application rejected!"),p.value="",await _(r.value.id)}catch(a){alert(a.message||"Something went wrong!")}}async function _(){await k.markAsRead($.notificationId)}return(a,t)=>y.value&&r.value?(s(),f("div",Se,[c.value?(s(),f("div",$e,[n("div",me,[t[4]||(t[4]=n("h3",{class:"title-lg"},"Accept Application Note",-1)),L(n("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>v.value=l),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,v.value]]),n("div",je,[n("button",{class:"btn-3",onClick:t[1]||(t[1]=l=>c.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:t[2]||(t[2]=l=>y.value.action(r.value.id))}," Confirm ")])])])):d("",!0),i.value?(s(),f("div",Ce,[L(n("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>p.value=l),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter accept note"},null,512),[[q,p.value]])])):d("",!0),n("div",Re,[i.value?d("",!0):(s(),f("button",{key:0,class:"btn-2",onClick:o},"Approve")),n("button",{class:"btn-1",onClick:e},j(i.value?"Submit":"Reject"),1)])])):d("",!0)}},Ee={class:"space-y-6 px-4 py-4"},Le={class:"text-2xl font-semibold capitalize text-gray-700"},qe={key:0,class:"space-y-4"},Ie={class:"flex items-start gap-4"},Be={class:"text-2xl text-blue-500"},Oe={class:"flex-1"},Ue={class:"flex items-center gap-8"},Ve={class:"text-gray-800 font-medium"},Te={key:0,class:"flex gap-2 text-sm btn-4"},Je={key:0,class:"text-gray-800 font-medium"},De={class:"text-red-600 text-sm font-semibold"},He={key:1,class:"text-xs text-gray-400"},ze={key:0,class:"grid gap-1"},Fe={class:"flex items-center gap-4"},Pe=["href"],Ge={class:"grow-0 w-full"},Ze={key:0,class:"text-xs font-semibold"},Ke={class:"text-xs text-gray-400"},Qe={key:1,class:"text-center text-red-500 py-10 text-xl italic"},aa={__name:"NotificationList",setup(C){Z();const b=K(),h=U(),{notifications:k}=B(h);G();const S=O(),{user:$}=B(S);g(!1),g({}),g({}),V(()=>{h.fetchNotifications()});const r=(o,u)=>{if(!o)return"application not found";switch(u){case"leaveApplication":return`Last Office ( ${o.last_working_date} ) → Join Date ( ${o.resumption_date} )`;case"shortLeave":return`Short Leave on ${o.date} form ${v(o.start_time)??"N/A"} to ${o.end_time?v(o.end_time):"N/A"}`;case"shift":return o.exchange_type==="shift"?`Exchange (${o.exchange_type}) on ${o.current_date} (${(o==null?void 0:o.shift_name)??"No Shift"})`:`Exchange (${o.exchange_type})`;case"exchange":return`Exchange (${o.exchange_type}) on ${o.current_date} (${(o==null?void 0:o.shift_name)??"No Shift"})`;case"offday":return o.exchange_type==="offday"?`Exchange (Offday): ${o.current_date} → ${o.exchange_date}`:`Exchange (${o.exchange_type})`;case"manualAttendance":const y=o.check_in?c(o.check_in):null,e=o.check_out?c(o.check_out):null;return y&&e?`${o==null?void 0:o.reason} Checked in (${y}) → Checked out (${e})`:y?`${o==null?void 0:o.reason} Checked in (${y})`:e?`${o==null?void 0:o.reason} Checked out (${e})`:`${o==null?void 0:o.reason} No check-in or check-out data`;default:return"Unknown Event"}},i=o=>{switch(o){case"leaveApplication":return"fas fa-calendar-alt";case"shortLeave":return"fas fa-clock";case"manualAttendance":return"fas fa-clock";case"exchange":return"fas fa-random";case"offday":return"fas fa-random";default:return"fas fa-bell"}},p=o=>new Date(o).toLocaleString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function c(o){const u={year:"numeric",month:"short",day:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0};return new Date(o).toLocaleString("en-US",u)}const v=o=>{const[u,y]=o.split(":").map(Number),e=new Date;return e.setHours(u,y),e.toLocaleString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};return(o,u)=>{const y=Q("RouterLink");return s(),f("div",Ee,[n("h2",Le,j(A(b).query.type.replace(/([A-Z])/g," $1")),1),Array.isArray(A(k)[A(b).query.type])&&A(k)[A(b).query.type].length?(s(),f("div",qe,[(s(!0),f(W,null,X(A(k)[A(b).query.type],(e,R)=>{var _,a,t,l,w,x,N,E,J,D,H,z,F,P;return s(),f("div",{key:e.id,class:"bg-white p-4 rounded-xl shadow border"},[n("div",Ie,[n("div",Be,[n("i",{class:Y(i(e.event_type))},null,2)]),n("div",Oe,[n("div",Ue,[n("p",Ve,j((_=e.event_model)==null?void 0:_.user_name),1),e!=null&&e.monthly_short_leave_count?(s(),f("p",Te,[n("strong",null,"Pending: "+j((e==null?void 0:e.monthly_short_leave_count.Pending)||0),1),u[0]||(u[0]=M("/ ")),n("strong",null,"Approved: "+j((e==null?void 0:e.monthly_short_leave_count.Approved)||0),1)])):d("",!0)]),(a=e.event_model)!=null&&a.reason?(s(),f("p",Je," Reason: "+j((t=e.event_model)==null?void 0:t.reason),1)):d("",!0),n("p",De,j(r(e.event_model,e.event_type)),1),(l=e==null?void 0:e.event_model)!=null&&l.total_leave_days_without_week?(s(),f("p",He," Total Leave: "+j(e==null?void 0:e.event_model.total_leave_days_without_week)+" days ",1)):d("",!0)]),e!=null&&e.event_model?(s(),f("div",ze,[n("div",Fe,[e!=null&&e.event_model.attachment?(s(),f("a",{key:0,href:(w=e==null?void 0:e.event_model)==null?void 0:w.attachment,target:"_blank",class:"btn-1"},u[1]||(u[1]=[n("i",{class:"fad fa-link"},null,-1)]),8,Pe)):d("",!0),A(b).query.type==="leaveApplication"?(s(),m(y,{key:1,to:{name:"LeaveApplicationShow",params:{id:(x=e==null?void 0:e.event_model)==null?void 0:x.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[2]||(u[2]=[n("i",{class:"far fa-eye"},null,-1)])),_:2,__:[2]},1032,["to"])):d("",!0),A(b).query.type==="shortLeave"?(s(),m(y,{key:2,to:{name:"ShortLeaveShow",params:{id:(N=e==null?void 0:e.event_model)==null?void 0:N.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[3]||(u[3]=[n("i",{class:"far fa-eye"},null,-1)])),_:2,__:[3]},1032,["to"])):d("",!0),A(b).query.type==="exchange"?(s(),m(y,{key:3,to:{name:((E=e==null?void 0:e.event_model)==null?void 0:E.exchange_type)=="offday"?"ExchangeOffdayShow":"ExchangeShiftShow",params:{id:(J=e==null?void 0:e.event_model)==null?void 0:J.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[4]||(u[4]=[n("i",{class:"far fa-eye"},null,-1)])),_:2,__:[4]},1032,["to"])):d("",!0),A(b).query.type==="offday"?(s(),m(y,{key:4,to:{name:"ExchangeOffdayShow",params:{id:(D=e==null?void 0:e.event_model)==null?void 0:D.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[5]||(u[5]=[n("i",{class:"far fa-eye"},null,-1)])),_:2,__:[5]},1032,["to"])):d("",!0),A(b).query.type==="shift"?(s(),m(y,{key:5,to:{name:"ExchangeShiftShow",params:{id:(H=e==null?void 0:e.event_model)==null?void 0:H.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[6]||(u[6]=[n("i",{class:"far fa-eye"},null,-1)])),_:2,__:[6]},1032,["to"])):d("",!0),A(b).query.type==="manualAttendance"?(s(),m(y,{key:6,to:{name:"ManualAttendanceShow",params:{id:(z=e==null?void 0:e.event_model)==null?void 0:z.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[7]||(u[7]=[n("i",{class:"far fa-eye"},null,-1)])),_:2,__:[7]},1032,["to"])):d("",!0)]),n("div",Ge,[(F=e==null?void 0:e.event_model)!=null&&F.type?(s(),f("p",Ze," Type : "+j((P=e==null?void 0:e.event_model)==null?void 0:P.type),1)):d("",!0),n("p",Ke,j(p(e.created_at)),1)])])):d("",!0)]),e!=null&&e.event_model&&e.event_type==="leaveApplication"?(s(),m(ye,{key:0,application:e.event_model,"notification-id":e.id},null,8,["application","notification-id"])):d("",!0),e!=null&&e.event_model&&e.event_type==="manualAttendance"?(s(),m(Ae,{key:1,application:e.event_model,"notification-id":e.id},null,8,["application","notification-id"])):d("",!0),e!=null&&e.event_model&&e.event_type==="shortLeave"?(s(),m(Ne,{key:2,application:e.event_model,"notification-id":e.id},null,8,["application","notification-id"])):d("",!0),e!=null&&e.event_model&&(e.event_type==="offday"||e.event_type==="shift"||e.event_type==="exchange")?(s(),m(ce,{key:3,application:e.event_model,notificationId:e.id},null,8,["application","notificationId"])):d("",!0)])}),128))])):(s(),f("div",Qe,"notifications not found."))])}}};export{aa as default};
