import{O as J}from"./OverlyModal-BV_Kla2a.js";import{r as I,m as z,e as H,n as K,c as i,o as a,p as N,a as t,F as P,q as R,t as d,g as B,f as U,s as q,x as C,i as M,k as b,R as Q,w as V,y as X,h as Z,v as tt,j as k,d as et,z as E,u as st,A as nt}from"./index-BR5t5sGL.js";import{o as j}from"./datetime-DLSuPxzD.js";import{u as at}from"./useTaskStore-CmLj28p_.js";import{_ as ot}from"./TaskTreeView-CRUYmBU3.js";import{u as lt}from"./user-jxFchJFh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./url-CePbr-gY.js";import"./UserChip-BCaGXdU2.js";const W=(w,D,n,g)=>{const h=new Date(g,n-1,D);return w.filter(o=>{const m=o.deadline?new Date(o.deadline):null,c=j(new Date);if(o.assigned_at||o.created_at){let T=o.assigned_at?j(new Date(o.assigned_at)):null;!T&&o.created_at&&(T=j(new Date(o.created_at)));let p=null;return!(h<T||(o.completed_at&&(p=j(new Date(o.completed_at))),p&&p<h)||m&&m<h&&h>c)}return!1}).map(o=>{let m=!1;return o.deadline&&(m=new Date(o.deadline)<h),{...o,deadline_crossed:m}})},rt={class:"grid grid-cols-7 *:text-center *:p-2 *:border-r *:border-b *:text-blue-800 *:text-sm"},it={class:"flex flex-col"},dt={class:"p-2 border-r border-t"},ut={__name:"CalenderView",props:{month:{type:String,required:!0,validator:w=>/^\d{4}-(0[1-9]|1[0-2])$/.test(w)}},emits:["change"],setup(w,{emit:D}){const n=w,g=D,h=I(),o=I(),m=I(),c=I(),T=["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];function p(e,u,y,_){const f=[];for(let S=y-1;S>=0;S--){const A=_-S,$=new Date(e,u-1,A);f.push({date:$,day:$.getDate(),month:$.getMonth()+1,year:$.getFullYear(),isCurrentMonth:!1})}return f}function x(e,u,y){const _=[];for(let f=1;f<=y;f++){const A={date:new Date(e,u,f),day:f,month:u+1,year:e,isCurrentMonth:!0};_.push(A)}return _}function l(e,u,y){const _=[...e],f=Math.ceil(_.length/7)*7,S=1;for(let A=0;_.length<f;A++){const $=new Date(u,y+1,S+A);_.push({date:$,day:$.getDate(),month:$.getMonth()+1,year:$.getFullYear(),isCurrentMonth:!1})}return _}function s(e,u){const y=new Date(e,u,1),f=new Date(e,u+1,0).getDate(),A=(y.getDay()+1)%7,G=new Date(e,u,0).getDate();let O=[];O=[...p(e,u,A,G)];const F=x(e,u,f);return m.value=F[0],c.value=F[F.length-1],O=[...O,...F],O=[...l(O,e,u)],h.value=O[0],o.value=O[O.length-1],O}const r=z(()=>{const[e,u]=n.month.split("-"),y=parseInt(e),_=parseInt(u)-1;return s(y,_)}),v=z(()=>{const e=r.value,u=[];for(let y=0;y<e.length;y+=7)u.push(e.slice(y,y+7));return u});function L(){g("change",{gridStartDate:h.value,gridEndDate:o.value,startOfMonth:m.value,endOfMonth:c.value})}return H(()=>L()),K(()=>n.month,L),(e,u)=>(a(),i("div",null,[N(e.$slots,"calender-top"),t("div",rt,[(a(),i(P,null,R(T,y=>t("div",{key:y},d(y),1)),64))]),t("div",it,[(a(!0),i(P,null,R(v.value,(y,_)=>(a(),i("div",{class:"week grid grid-cols-7 min-h-28",key:_},[(a(!0),i(P,null,R(y,(f,S)=>N(e.$slots,"date",{key:S,day:f.day,month:f.month,year:f.year,weekday:(f.date.getDay()+1)%7,isCurrentMonth:f.isCurrentMonth},()=>[t("div",dt,d(f.getDate()),1)])),128))]))),128))]),N(e.$slots,"calender-bottom")]))}},ct={key:0},yt={key:0,class:"fad fa-folder text-xs mr-2"},mt={key:1,class:"fad fa-file-alt text-xs mr-2"},pt={key:2,class:"text-center w-full mt-4 text-xs text-gray-600"},Y={__name:"TaskListOnDay",props:{isCurrentMonth:{type:Boolean,default:!1},tasks:{type:Array,default:()=>[]},limit:{type:Number,default:null},tree:{type:Boolean,default:!1}},emits:["clickOnMore"],setup(w,{emit:D}){const n=w,g=D,h=z(()=>{var o;return n.limit?((o=n==null?void 0:n.tasks)==null?void 0:o.slice(0,n.limit))||[]:[...n.tasks]});return(o,m)=>(a(),i("div",null,[w.tree?(a(),i("div",ct,[(a(!0),i(P,null,R(h.value,c=>(a(),U(ot,{"hide-buttons":"","hide-assigned-users":"",task:c,key:c.id,class:"mb-6"},null,8,["task"]))),128))])):(a(),i("ul",{key:1,class:q({"text-gray-500 group-hover:text-gray-900":!w.isCurrentMonth})},[(a(!0),i(P,null,R(h.value,c=>(a(),i("li",{class:"mb-2",key:c.id},[C(b(Q),{to:`/tasks/${c.id}`,target:"_blank",class:"flex items-center hover:underline hover:text-blue-600"},{default:M(()=>[c.children_task_count>0?(a(),i("i",yt)):B("",!0),c.children_task_count==0?(a(),i("i",mt)):B("",!0),t("span",{class:q(["line-clamp-1",{"text-red-800":c.deadline_crossed}])},d(c.title),3)]),_:2},1032,["to"])]))),128))],2)),w.tasks.length-h.value.length>0?(a(),i("div",pt,[t("button",{onClick:m[0]||(m[0]=V(c=>g("clickOnMore",c),["prevent"])),class:"text-blue-600 hover:underline"}," +"+d(w.tasks.length-h.value.length)+" More Tasks ",1)])):B("",!0)]))}},ft={class:"relative"},ht={class:"px-4 py-2 flex items-center bg-gray-50 group"},gt={class:"ml-auto"},xt=["onClick"],bt={key:0,class:"absolute inset-0 bg-white bg-opacity-90"},vt={class:"absolute inset-16 bg-white border border-blue-500 rounded-md z-20 overflow-y-auto"},_t={class:"text-lg font-semibold mb-4 sticky top-0 border-b border-blue-200 px-4 z-30 py-3 bg-white flex items-center"},wt={__name:"TaskInMonth",setup(w){const D=I("2025-08"),n=X({day:null,month:null,year:null}),g=at();function h(x){x.stopPropagation(),n.day=null,n.month=null,n.year=null}function o(x,l,s,r){x.stopPropagation(),n.day=l,n.month=s,n.year=r}async function m({gridStartDate:x,gridEndDate:l,startOfMonth:s,endOfMonth:r}){await g.fetchMyTasks()}const c=(x,l,s)=>{const r=new Date;return x===r.getDate()&&l===r.getMonth()+1&&s===r.getFullYear()},T=(x,l,s)=>x===n.day&&l===n.month&&s===n.year,p=(x,l,s,r)=>{const v=c(x,l,s);return{"bg-green-100 text-green-900 border-blue-500 border-2 scale-105 z-10":v,"border-r border-t hover:border border-blue-200  hover:scale-105 hover:z-20 hover:bg-blue-50":!v,"bg-gray-50":!r}};return(x,l)=>(a(),i("div",ft,[t("div",ht,[l[1]||(l[1]=t("h2",{class:"leading-none font-semibold text-lg"},"Task List",-1)),Z(t("input",{type:"month","onUpdate:modelValue":l[0]||(l[0]=s=>D.value=s),class:"ml-auto border px-2 rounded"},null,512),[[tt,D.value]])]),C(ut,{month:D.value,class:"border-t border-blue-200/50 relative",onChange:m},{date:M(({day:s,month:r,year:v,isCurrentMonth:L})=>[t("div",{tabindex:"0",class:q(["transition origin-center p-2 outline-blue-600 outline-1 cursor-pointer",p(s,r,v,L)])},[t("div",{class:q(["font-bold w-full flex items-center",{"text-gray-300":!L}])},[t("div",null,d(s),1),t("div",gt,[T(s,r,v)?B("",!0):(a(),i("button",{key:0,class:"btn-icon",onClick:V(e=>o(e,s,r,v),["prevent"])},l[2]||(l[2]=[t("i",{class:"fas fa-expand-arrows text-gray-400 hover:text-gray-600"},null,-1)]),8,xt))])],2),C(Y,{"is-current-month":L,tasks:b(W)(b(g).tasks,s,r,v),limit:3,class:"text-xs mt-4",onClickOnMore:e=>o(e,s,r,v)},null,8,["is-current-month","tasks","onClickOnMore"])],2)]),"calender-bottom":M(()=>[n.day?(a(),i("div",bt,[t("div",vt,[t("div",_t,[k(" Tasks for "+d(n.day)+"/"+d(n.month)+"/"+d(n.year)+" ",1),t("button",{class:"ml-auto",type:"button",onClick:V(h,["prevent"])},l[3]||(l[3]=[t("i",{class:"fas fa-times"},null,-1)]))]),C(Y,{class:"p-4","is-current-month":x.isCurrentMonth,tasks:b(W)(b(g).tasks,n.day,n.month,n.year),tree:!0},null,8,["is-current-month","tasks"])])])):B("",!0)]),_:1},8,["month"])]))}},Dt={class:"container px-6 mx-auto"},kt={key:0,class:"grid gap-4 md:grid-cols-3 mt-4"},Mt={class:"text-3xl"},Ct={class:"text-3xl"},Tt={class:"text-3xl"},$t={class:"text-3xl"},Lt={class:"text-3xl"},St={class:"text-3xl"},Ot={key:1,class:"w-full mt-4"},At={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Pt={class:"bg-white shadow-md rounded-lg p-4"},Rt={class:"space-y-2"},qt={class:"flex justify-between items-center px-4 py-2 rounded hover:bg-gray-50 transition-colors"},It={class:"font-semibold text-gray-800"},Bt={key:0},Ft={key:1},jt={key:2},zt={class:"space-y-3"},Nt={class:"flex items-center space-x-4"},Ut={class:"absolute top-10 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition pointer-events-none z-10 whitespace-nowrap"},Vt={class:"text-sm font-medium text-gray-900"},Et={class:"text-xs text-gray-500 mt-0.5"},Wt={class:"text-xl font-bold text-gray-800 flex items-center gap-2 p-4"},Yt={class:"space-y-5 px-4 md:px-6 py-4"},Ht={class:"text-sm text-gray-500 flex items-center gap-2"},Gt={class:"flex justify-end gap-3 mt-6"},Jt={class:"bg-white shadow-md rounded-lg"},Kt={class:"overflow-x-auto shadow-md sm:rounded-lg min-h-max"},Qt={class:"min-w-full text-sm text-left text-gray-500"},Xt={class:"px-6 py-4 font-medium text-gray-900"},Zt={class:"px-6 py-4"},te={class:"px-6 py-4"},ee={class:"px-6 py-4"},se={class:"card-bg mt-4 gap-0 shadow-md border border-gray-300"},pe={__name:"DashBoard",setup(w){const D=et(),n=lt(),{dashboardInfo:g,selectedDate:h,userDashboard:o}=E(n),{user:m}=E(D),c=st(),T=z(()=>{var l;return["admin","super_admin","developer"].includes((l=m==null?void 0:m.value)==null?void 0:l.role)}),p=I(null);H(async()=>{var s,r;m.value||await D.fetchUser(),await n.fetchUserDashboardData(),T.value&&await n.fetchAdminDashboardData();const l=(r=(s=o.value)==null?void 0:s.notices)==null?void 0:r.find(v=>!v.user_feedback);l&&(p.value=l)});const x=()=>{if(!p.value)return;const l=p.value.type===1?`/notice-details/${p.value.id}`:`/policy-details/${p.value.id}`;c.push(l)};return(l,s)=>{var v,L;const r=nt("RouterLink");return a(),i("div",Dt,[T.value&&b(D).isAdminMood?(a(),i("div",kt,[C(r,{to:{name:"TodayAttendanceReport",query:{search:"all"}},class:"main-button"},{default:M(()=>{var e;return[t("span",Mt,d((e=b(g))==null?void 0:e.totalUsers),1),s[2]||(s[2]=k(" Total Employees "))]}),_:1,__:[2]}),C(r,{to:{name:"TodayAttendanceReport",query:{search:"Present"}},class:"main-button"},{default:M(()=>{var e;return[t("span",Ct,d((e=b(g))==null?void 0:e.todayPresents),1),s[3]||(s[3]=k(" Today Present "))]}),_:1,__:[3]}),C(r,{to:{name:"TodayAttendanceReport",query:{search:"Absent"}},class:"main-button"},{default:M(()=>{var e;return[t("span",Tt,d((e=b(g))==null?void 0:e.todayAbsents),1),s[4]||(s[4]=k(" Today Absent "))]}),_:1,__:[4]}),C(r,{to:{name:"LeaveApplicationList",query:{search:"today"}},class:"main-button"},{default:M(()=>{var e;return[t("span",$t,d((e=b(g))==null?void 0:e.todayLeaves),1),s[5]||(s[5]=k(" Today Leave "))]}),_:1,__:[5]}),C(r,{to:{name:"LeaveApplicationList",query:{search:"tomorrow"}},class:"main-button"},{default:M(()=>{var e;return[t("span",Lt,d((e=b(g))==null?void 0:e.tomorrowLeaves),1),s[6]||(s[6]=k(" Tomorrow Leave "))]}),_:1,__:[6]}),C(r,{to:{name:"ShortLeaveList",query:{search:b(h)}},class:"main-button"},{default:M(()=>{var e;return[t("span",St,d((e=b(g))==null?void 0:e.todayShortLeaves),1),s[7]||(s[7]=k(" Today Short Leaves "))]}),_:1,__:[7]},8,["to"])])):(a(),i("div",Ot,[t("div",At,[t("div",Pt,[t("div",Rt,[s[11]||(s[11]=t("div",{class:"flex items-center"},[t("i",{class:"fas fa-file mr-2 h-5 w-5"}),t("h2",{class:"text-xl font-semibold"},"Applications")],-1)),(a(!0),i(P,null,R((v=b(o))==null?void 0:v.current_month_leave,e=>(a(),U(r,{to:{name:"MyLeaveApplicationShow",params:{id:e.id}},key:e.id},{default:M(()=>[t("div",qt,[t("h3",It," Leave Application #"+d(e.id),1),t("p",{class:q(["text-sm font-medium flex items-center space-x-2",{"bg-gray-500 py-1.5 rounded-full px-4 text-white":e.status===null,"bg-yellow-500 py-1.5 rounded-full px-4 text-white":e.status==="Pending","bg-green-500 py-1.5 rounded-full px-4 text-white":e.status==="approved"}])},[e.status===null?(a(),i("span",Bt,s[8]||(s[8]=[t("i",{class:"fas fa-clock mr-2"},null,-1),k(" Wait for Hanover ")]))):e.status==="Pending"?(a(),i("span",Ft,s[9]||(s[9]=[t("i",{class:"fas fa-hourglass-half mr-2"},null,-1),k(" Pending ")]))):(a(),i("span",jt,s[10]||(s[10]=[t("i",{class:"fas fa-check-circle mr-2"},null,-1),k(" Approved ")])))],2)])]),_:2},1032,["to"]))),128))]),s[16]||(s[16]=t("div",{class:"flex justify-between items-start mb-4"},[t("div",{class:"flex items-center"},[t("i",{class:"fas fa-file mr-2 h-5 w-5"}),t("h2",{class:"text-xl font-semibold"},"Notices")])],-1)),t("div",zt,[(a(!0),i(P,null,R(b(o).notices,(e,u)=>(a(),i("div",{key:u,class:"flex items-center justify-between p-4 border rounded-lg shadow-sm hover:shadow transition-all bg-white"},[t("div",Nt,[t("div",{class:q([["rounded-full",e.user_feedback?"bg-green-100":"bg-red-100"],"h-8 w-8 flex items-center justify-center rounded-full"])},[t("span",{class:q(["h-3 w-3",e.user_feedback?"bg-green-600":"bg-red-600","rounded-full inline-block"])},null,2),t("div",Ut,d(e.user_feedback?"Feedback Submitted":"Feedback Pending"),1)],2),t("div",null,[t("p",Vt,d(e.title),1),t("p",Et,d(e.published_at),1)])]),C(r,{to:e.type===1?`/notice-details/${e.id}`:`/policy-details/${e.id}`,class:"text-blue-600 hover:text-blue-800 font-semibold text-sm"},{default:M(()=>s[12]||(s[12]=[k(" View ")])),_:2,__:[12]},1032,["to"])]))),128)),p.value?(a(),U(J,{key:0,show:!0,onClose:s[1]||(s[1]=e=>p.value=null)},{default:M(()=>[t("div",Wt,[s[13]||(s[13]=t("i",{class:"fas fa-bell text-blue-500"},null,-1)),k(" "+d(p.value.title),1)]),t("div",Yt,[t("p",Ht,[s[14]||(s[14]=t("i",{class:"fas fa-calendar-alt text-gray-400"},null,-1)),k(" Published: "+d(p.value.published_at),1)]),s[15]||(s[15]=t("p",{class:"text-base text-gray-700 leading-relaxed"}," You must read this notice before proceeding. ",-1)),t("div",Gt,[t("button",{onClick:s[0]||(s[0]=e=>p.value=null),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-5 py-2 rounded-lg transition"}," Cancel "),t("button",{onClick:x,class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2.5 rounded-lg shadow transition"}," Read Details ")])])]),_:1})):B("",!0)])]),t("div",Jt,[s[18]||(s[18]=t("h2",{class:"text-xl font-semibold py-3 px-4"},"Leave Balance",-1)),t("div",Kt,[t("table",Qt,[s[17]||(s[17]=t("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3"},"Type"),t("th",{scope:"col",class:"px-6 py-3"},"Total Days"),t("th",{scope:"col",class:"px-6 py-3"},"Used Days"),t("th",{scope:"col",class:"px-6 py-3"},"Remaining Days")])],-1)),t("tbody",null,[(a(!0),i(P,null,R((L=b(o))==null?void 0:L.leave_balance,e=>(a(),i("tr",{key:e.id,class:"border-b hover:bg-gray-100"},[t("td",Xt,d(e.leave_type),1),t("td",Zt,d(e.annual_quota),1),t("td",te,d(e.used_days),1),t("td",ee,d(e.remaining_days),1)]))),128))])])])])]),t("div",se,[C(wt)])]))])}}};export{pe as default};
