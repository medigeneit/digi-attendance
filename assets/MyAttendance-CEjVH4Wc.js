import{u as rt,b as nt,d as at,r as F,m as lt,e as ot,z as G,n as dt,c as u,o as l,a as t,f as v,t as r,h as it,v as ut,j as n,k as a,g as m,F as J,q as K,p as Q,i as y,x as c}from"./index-TAPWLbqf.js";import{L as pt}from"./LoaderView-C5j9qb_S.js";import{u as mt}from"./attendance-DPQyv1Hh.js";import{_ as _t}from"./_plugin-vue_export-helper-DlAUqK2U.js";const yt={class:"px-4 space-y-4"},vt={class:"md:flex items-center justify-between gap-2"},bt={class:"title-lg md:title-lg flex-wrap text-center"},ct={class:"flex gap-4"},ft={class:"grid md:grid-cols-2 gap-4 text-sm"},xt={class:"card-bg p-4 gap-1"},ht={class:"grid md:grid-cols-2"},kt={class:"card-bg p-4 gap-1"},At={class:"flex justify-between items-center"},wt={class:"grid md:grid-cols-2"},gt={key:1,class:"space-y-4"},St={key:0,class:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm flex items-center justify-center z-50"},Dt={class:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6 animate-fade-in"},Ct={class:"flex items-center justify-between mb-4"},Lt={class:"space-y-3"},Mt={class:"overflow-x-auto card-bg"},Et={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},Tt={class:"text-center text-xs"},jt={class:"border px-1 py-0.5"},Bt={class:"border px-1 py-0.5"},Ot=["title"],qt=["title"],Nt=["title"],Pt={key:0},$t={class:"border px-1 py-0.5"},Ut={class:"border px-1 py-0.5"},Vt={class:"border px-1 py-0.5"},It={key:0},Wt={class:"border px-1 py-0.5"},Ht={key:0},Rt={__name:"MyAttendance",setup(zt){const f=rt(),h=nt(),o=at(),i=mt(),p=F(h.query.date||i.selectedMonth),b=F(!1);function X(){b.value=!0}const Y=[{label:"Add Leave Application",route:"LeaveApplicationAdd"},{label:"Add Offday Exchange",route:"OffdayExchangeAdd"},{label:"Add Shift Exchange",route:"ShiftExchangeAdd"},{label:"Add Manual Attendance",route:"ManualAttendanceAdd"},{label:"Add  Overtime",route:"MyOvertimeAdd"}],Z=lt(()=>{if(!p.value)return"";const[d,e]=p.value.split("-");return new Date(d,e-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),x=async()=>{var d;(d=o.user)!=null&&d.id&&p.value&&await i.getMonthlyAttendanceByShift(o.user.id,p.value)};ot(async()=>{o.isAuthenticated?(await o.fetchUser(),x()):f.push("/login")}),G(p,async d=>{i.selectedMonth=d,await x()}),G(p,d=>{f.replace({query:{...h.query,date:d}})});const tt=()=>f.go(-1),et=d=>{if(d)return d.split(" ").map(e=>e[0]).join("").toUpperCase()};return(d,e)=>{var k,A,w,g,S,D,C,L,M,E,T,j,B,O,q,N,P,$,U,V,I,W,H,R,z;const _=dt("router-link");return l(),u("div",yt,[t("div",vt,[t("button",{class:"btn-3",onClick:tt},e[4]||(e[4]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),t("h1",bt," Attendance of "+r(Z.value),1),t("div",ct,[t("div",null,[it(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":e[0]||(e[0]=s=>p.value=s),onChange:x,class:"input-1"},null,544),[[ut,p.value]])])])]),t("div",ft,[t("div",xt,[e[14]||(e[14]=t("h2",{class:"title-md"},"User Info",-1)),e[15]||(e[15]=t("hr",null,null,-1)),t("div",ht,[t("p",null,[e[5]||(e[5]=t("strong",null,"Name:",-1)),n(" "+r((k=a(o).user)==null?void 0:k.name),1)]),t("p",null,[e[6]||(e[6]=t("strong",null,"Designation:",-1)),n(" "+r((w=(A=a(o).user)==null?void 0:A.designation)==null?void 0:w.title),1)]),t("p",null,[e[7]||(e[7]=t("strong",null,"Department:",-1)),n(" "+r((S=(g=a(o).user)==null?void 0:g.department)==null?void 0:S.name),1)]),t("p",null,[e[8]||(e[8]=t("strong",null,"Company:",-1)),n(" "+r((C=(D=a(o).user)==null?void 0:D.company)==null?void 0:C.name),1)]),t("p",null,[e[9]||(e[9]=t("strong",null,"Phone:",-1)),n(" "+r((L=a(o).user)==null?void 0:L.phone),1)]),t("p",null,[e[10]||(e[10]=t("strong",null,"Email:",-1)),n(" "+r((M=a(o).user)==null?void 0:M.email),1)]),t("p",null,[e[11]||(e[11]=t("strong",null,"Employee ID:",-1)),n(" "+r((E=a(o).user)==null?void 0:E.employee_id),1)]),t("p",null,[e[12]||(e[12]=t("strong",null,"Blood Group:",-1)),n(" "+r(((T=a(o).user)==null?void 0:T.blood)||"N/A"),1)]),t("p",null,[e[13]||(e[13]=t("strong",null,"Joining Date:",-1)),n(" "+r((j=a(o).user)==null?void 0:j.joining_date),1)])])]),t("div",kt,[t("div",At,[e[16]||(e[16]=t("h2",{class:"title-md"},"Attendance Summary",-1)),t("button",{onClick:e[1]||(e[1]=s=>X()),class:"btn-2"}," Apply Application ")]),e[23]||(e[23]=t("hr",null,null,-1)),t("div",wt,[t("p",null,[e[17]||(e[17]=t("strong",null,"Total Working Days:",-1)),n(" "+r(((O=(B=a(i))==null?void 0:B.summary)==null?void 0:O.total_working_days)||0),1)]),t("p",null,[e[18]||(e[18]=t("strong",null,"Present Days:",-1)),n(" "+r(((N=(q=a(i))==null?void 0:q.summary)==null?void 0:N.total_present_days)||0),1)]),t("p",null,[e[19]||(e[19]=t("strong",null,"Absent Days:",-1)),n(" "+r((($=(P=a(i))==null?void 0:P.summary)==null?void 0:$.total_absent_days)||0),1)]),t("p",null,[e[20]||(e[20]=t("strong",null,"Late Days:",-1)),n(" "+r(((V=(U=a(i))==null?void 0:U.summary)==null?void 0:V.actual_late_day)||0),1)]),t("p",null,[e[21]||(e[21]=t("strong",null,"Total Working Hours:",-1)),n(" "+r((W=(I=a(i))==null?void 0:I.summary)==null?void 0:W.total_working_hours),1)]),t("p",null,[e[22]||(e[22]=t("strong",null,"Total Overtime Hours:",-1)),n(" "+r((R=(H=a(i))==null?void 0:H.summary)==null?void 0:R.total_overtime_hours),1)])]),e[24]||(e[24]=t("p",null,null,-1))])]),a(i).isLoading?(l(),v(pt,{key:0})):(l(),u("div",gt,[b.value?(l(),u("div",St,[t("div",Dt,[t("div",Ct,[e[25]||(e[25]=t("h2",{class:"text-xl font-bold text-red-600"},"Application Category",-1)),t("button",{onClick:e[2]||(e[2]=s=>b.value=!1),class:"text-gray-500 hover:text-red-500 text-xl"},"Ã—")]),t("div",Lt,[(l(),u(J,null,K(Y,(s,st)=>Q(_,{key:st,to:{name:s.route},class:"block w-full text-center bg-gradient-to-r from-blue-100 to-blue-200 text-blue-700 font-semibold py-2 rounded-lg hover:from-blue-200 hover:to-blue-300 transition"},{default:y(()=>[n(r(s.label),1)]),_:2},1032,["to"])),64))]),t("button",{onClick:e[3]||(e[3]=s=>b.value=!1),class:"mt-6 w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg font-semibold transition"}," Close ")])])):m("",!0),t("div",Mt,[t("table",Et,[e[29]||(e[29]=t("thead",null,[t("tr",{class:"bg-gray-200 text-xs"},[t("th",{class:"border p-1"},"Date"),t("th",{class:"border p-1"},"Day"),t("th",{class:"border p-1"},"Shift"),t("th",{class:"border p-1"},"Entry Time"),t("th",{class:"border p-1"},"Exit Time"),t("th",{class:"border p-1"},"Working Hours"),t("th",{class:"border p-1"},"OT Hours"),t("th",{class:"border p-1"},"Late Entry"),t("th",{class:"border p-1"},"Early Leave"),t("th",{class:"border p-1"},"Status")])],-1)),t("tbody",Tt,[(l(!0),u(J,null,K((z=a(i))==null?void 0:z.monthlyLogs,s=>(l(),u("tr",{key:s==null?void 0:s.date,class:"hover:border-b-2 hover:border-gray-200 hover:bg-blue-200"},[t("td",jt,r(s.date),1),t("td",Bt,r(s.weekday),1),t("td",{class:"border px-1 py-0.5",title:`${s.shift_start_time} to ${s.shift_end_time}`},r(s.shift_name),9,Ot),t("td",{class:"border px-1 py-0.5",title:`Device: ${s.entry_device}`},[t("span",{class:c({"text-yellow-600":s.is_overtime_applicable})},r(s.is_overtime_applicable&&s.entry_time?et(s.status):"")+" "+r(s.entry_time),3)],8,qt),t("td",{class:"border px-1 py-0.5",title:`Device: ${s.exit_device}`},[n(r(s.exit_time)+" ",1),!s.exit_time&&new Date(s.date)<new Date&&s.status==="Present"?(l(),u("div",Pt,[Q(_,{to:{name:"ManualAttendanceAdd",query:{type:"Forget Punch",date:new Date(s.date+" UTC").toISOString().split("T")[0],entry_time:s.entry_time,exit_time:s.exit_time}},class:"btn-link text-red-600"},{default:y(()=>e[26]||(e[26]=[n(" (Check Out Apply) ")])),_:2,__:[26]},1032,["to"])])):m("",!0)],8,Nt),t("td",$t,r(s.working_hours),1),t("td",Ut,r(s.overtime_hours),1),t("td",Vt,[s.late_duration&&s.status!=="Weekend"?(l(),u("div",It,[n(r(s.late_duration)+" ",1),s.first_short_leave?(l(),v(_,{key:0,to:{name:"ShortLeaveShow",params:{id:s.first_short_leave_id}},class:c({"text-green-500":s.first_short_leave==="Approved","text-yellow-500":s.first_short_leave==="Pending","text-red-500":s.first_short_leave==="Rejected"})},{default:y(()=>[n(" ("+r(s.first_short_leave)+") ",1)]),_:2},1032,["to","class"])):m("",!0),s.late_duration&&!s.first_short_leave?(l(),v(_,{key:1,to:{name:"ShortLeaveAdd",query:{type:"Delay",start_time:s.shift_start_time,end_time:s.entry_time}},class:"btn-link text-red-600"},{default:y(()=>e[27]||(e[27]=[n(" (Apply) ")])),_:2,__:[27]},1032,["to"])):m("",!0)])):m("",!0)]),t("td",Wt,[s.early_leave_duration&&s.status!=="Weekend"?(l(),u("div",Ht,[n(r(s.early_leave_duration)+" ",1),s.last_short_leave?(l(),v(_,{key:0,to:{name:"ShortLeaveShow",params:{id:s.last_short_leave_id}},class:c(["px-1",{"text-green-500":s.last_short_leave==="Approved","text-yellow-500":s.last_short_leave==="Pending","text-red-500":s.last_short_leave==="Rejected"}])},{default:y(()=>[n(" ("+r(s.last_short_leave)+") ",1)]),_:2},1032,["to","class"])):m("",!0),s.early_leave_duration&&!s.last_short_leave?(l(),v(_,{key:1,to:{name:"ShortLeaveAdd",query:{type:"Early",start_time:s.exit_time,end_time:s.shift_end_time}},class:"btn-link text-red-600"},{default:y(()=>e[28]||(e[28]=[n(" (Apply) ")])),_:2,__:[28]},1032,["to"])):m("",!0)])):m("",!0)]),t("td",{class:c(["border px-1 py-0.5 font-semibold",{"text-red-600":s.status==="Absent","text-green-600":s.status==="Present","text-yellow-600":s.is_overtime_applicable}])},r(s.status),3)]))),128))])])])]))])}}},Qt=_t(Rt,[["__scopeId","data-v-16165be0"]]);export{Qt as default};
