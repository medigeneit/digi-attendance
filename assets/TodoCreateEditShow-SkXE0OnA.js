import{O as X}from"./OverlyModal-BPu4L9C8.js";import{c as k,o as m,O as et,a as t,k as T,t as P,w as U,r as v,x as B,q as K,h as z,U as ct,l as G,j as O,v as q,P as ft,F as dt,e as yt,Z as vt,A as H,y as bt,d as j,g as ot,n as p,m as I,b as V,H as gt}from"./index-CiN0Aetu.js";import{g as W,b as xt}from"./datetime-Du_mcDA9.js";import{u as nt}from"./company-Cjo81ZTA.js";import{u as it}from"./useTodoProjectStore--hPk_Dgg.js";import{u as lt}from"./useTodoStore-s2LwQ3vG.js";import{_ as rt}from"./CompanyDepartmentSelectInput-D0RKsG-5.js";import{L as tt}from"./LoaderView-CRAnv_Zo.js";import{u as wt}from"./useTaskStore-DMhiCRXF.js";import{_ as kt}from"./TaskSelectionInput-CD0n4GZ_.js";import{u as ut,f as Tt,d as Ct,a as St}from"./useTodoDateStore-HF0CKDMr.js";import{_ as Dt}from"./UserChip-BSEhWwOx.js";import{a as $t}from"./TodoItemCard-BUlWojWu.js";const _t={class:"bg-white border-t px-4 py-4 sticky bottom-0 rounded-b-md shadow-lg shadow-red-600"},Et={key:0,class:"mb-4 text-red-500 font-medium"},Vt={key:0,class:"mb-4 text-blue-500 font-medium"},ht={class:"flex justify-between items-center gap-4"},It=["disabled"],at={__name:"FormHandler",props:{isSubmitting:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["submit","clickCancel"],setup(n,{emit:h}){const a=h;return(s,y)=>(m(),k("form",{onSubmit:y[1]||(y[1]=U(g=>a("submit"),["prevent"])),class:"overflow-hidden"},[et(s.$slots,"default"),t("div",_t,[et(s.$slots,"error",{},()=>[n.error?(m(),k("div",Et,P(n.error),1)):T("",!0)]),n.isSubmitting?(m(),k("div",Vt,"Saving changes...")):T("",!0),et(s.$slots,"footer",{},()=>[t("div",ht,[t("button",{type:"button",onClick:y[0]||(y[0]=g=>a("clickCancel")),class:"btn-3"},"Cancel"),t("button",{disabled:n.isSubmitting||n.isLoading,type:"submit",class:"btn-2"},P(n.isSubmitting?"Saving...":"Save"),9,It)])])])],32))}},jt={class:"relative"},Lt=["placeholder"],Ot=["onClick"],pt={__name:"InputWithSuggestions",props:{modelValue:{type:[String,Number],default:null},options:{type:Array,default:()=>[]},label:{type:String,default:"title"},value:{type:String,default:"id"},placeholder:{type:String,default:"Select or type..."}},emits:["update:modelValue","update:inputValue"],setup(n,{emit:h}){const a=n,s=h,y=v(""),g=v(!1),d=v(null),b=v(null),r=v({top:"0px",left:"0px",width:"0px"}),C=B(()=>{if(!y.value)return a.options;const o=y.value.toLowerCase();return a.options.filter($=>{const S=$[a.label];return S&&String(S).toLowerCase().includes(o)})});function i(){if(d.value){const o=d.value.getBoundingClientRect();r.value={top:`${o.bottom}px`,left:`${o.left}px`,width:`${o.width}px`}}}function c(o){y.value=o[a.label],s("update:modelValue",o[a.value]),s("update:inputValue",o[a.label]),g.value=!1}function e(){g.value=!0,i(),s("update:inputValue",y.value);const o=a.options.find($=>{var S;return((S=$[a.label])==null?void 0:S.toLowerCase())===y.value.toLowerCase()});o?s("update:modelValue",o[a.value]):s("update:modelValue",null)}function D(){g.value=!0,i()}K(()=>a.modelValue,o=>{if(o){const $=a.options.find(S=>S[a.value]==o);$&&(y.value=$[a.label],s("update:inputValue",$[a.label]))}},{immediate:!0}),K(()=>a.options,()=>{if(a.modelValue){const o=a.options.find($=>$[a.value]==a.modelValue);o&&(y.value=o[a.label],s("update:inputValue",o[a.label]))}}),K(g,o=>{o&&H(()=>i())});function u(o){d.value&&d.value.contains(o.target)||b.value&&b.value.contains(o.target)||(g.value=!1)}function L(){g.value&&i()}function _(){g.value&&i()}return z(()=>{document.addEventListener("click",u),window.addEventListener("scroll",L,!0),window.addEventListener("resize",_)}),ct(()=>{document.removeEventListener("click",u),window.removeEventListener("scroll",L,!0),window.removeEventListener("resize",_)}),(o,$)=>(m(),k("div",jt,[G(t("input",{ref_key:"inputRef",ref:d,type:"text","onUpdate:modelValue":$[0]||($[0]=S=>y.value=S),onInput:e,onFocus:D,class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 outline-none",placeholder:n.placeholder},null,40,Lt),[[q,y.value]]),(m(),O(vt,{to:"body"},[g.value&&C.value.length>0?(m(),k("ul",{key:0,ref_key:"dropdownRef",ref:b,class:"fixed z-[9999] bg-white border rounded-md shadow-lg max-h-60 overflow-y-auto mt-1",style:ft(r.value)},[(m(!0),k(dt,null,yt(C.value,S=>(m(),k("li",{key:S[n.value],onClick:R=>c(S),class:"px-4 py-2 hover:bg-blue-50 cursor-pointer text-sm text-gray-700 block text-left"},P(S[n.label]),9,Ot))),128))],4)):T("",!0)]))]))}},mt={__name:"TodoTypeInput",props:{todoType:{type:String,default:"task"},todoTypeId:{type:[String,Number],default:null},show:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["update:todoType","update:todoTypeId","update:show"],setup(n,{emit:h}){const a=n,s=h,y=B({get:()=>a.todoTypeId,set:i=>s("update:todoTypeId",i)}),g=B({get:()=>a.show,set:i=>s("update:show",i)}),d=v(null),b=v({});function r(){if(!(d!=null&&d.value))return;const i=d.value.getBoundingClientRect(),c=window.innerHeight,e=300,u=c-i.bottom<e;b.value={position:"fixed",top:u?i.top-e+"px":i.bottom+"px",left:i.left+"px",width:i.width+"px",zIndex:5e3}}z(async()=>{await H(),window.addEventListener("resize",r),document.addEventListener("scroll",r)});const C=wt();return K(()=>g.value,async i=>{i&&await C.fetchAllMyTasks()}),bt(()=>{window.removeEventListener("resize",r),document.removeEventListener("scroll",r)}),(i,c)=>(m(),k("div",null,[j(kt,{show:g.value,"onUpdate:show":c[0]||(c[0]=e=>g.value=e),taskId:y.value,"onUpdate:taskId":c[1]||(c[1]=e=>y.value=e),readonly:n.readonly},null,8,["show","taskId","readonly"])]))}},Pt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},Rt={class:"mb-4"},Mt={class:"mb-4"},Ut=["readonly"],Nt={class:"mb-4"},At={class:"mb-4"},Bt={__name:"TodoAddForm",props:{date:{type:String,default:W(new Date)},userRole:{type:String,default:"employee"},todoType:{type:String,default:"task"},todoTypeId:{type:String,default:null},readonlyValues:{type:Object,default:()=>({date:!1,todo_type_id:!1})}},emits:["update","cancelClick"],setup(n,{emit:h}){const a=n,s=v(),y=v(!1),g=v(),d=lt(),b=it(),r=ot(),C=nt(),i=v(null),c=v(""),e=v(null),D=h,u=v({title:"",date:a.date||"",todo_type:"task",todo_type_id:""});async function L(){try{s.value="submitting";const _={...u.value};if(_.todo_type_id||(delete _.todo_type_id,delete _.todo_type),i.value)_.todo_project_id=i.value;else if(c.value){const o=await b.createProject({title:c.value,department_id:e.value});_.todo_project_id=o.id}await d.createTodo(_,{returnWith:a.userRole!=="employee"?"user,department,company":""}),D("update")}finally{s.value=""}}return K(()=>({date:a.date,todo_type:a.todoType,todo_type_id:a.todoTypeId}),_=>{u.value={...u.value,..._}},{immediate:!0}),z(async()=>{var _;await H(),(_=g.value)==null||_.focus(),r.isAdminMood&&await C.fetchMyCompanies({with:"departments"}),await b.fetchProjects()}),(_,o)=>(m(),k("div",{onClick:o[9]||(o[9]=$=>y.value=!1)},[p(d).loading?(m(),O(tt,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:I(()=>o[10]||(o[10]=[V(" Loading... ")])),_:1,__:[10]})):T("",!0),j(at,{onSubmit:L,onClickCancel:o[8]||(o[8]=$=>D("cancelClick")),isSubmitting:s.value=="submitting",error:p(d).error,class:"rounded-md relative"},{default:I(()=>{var $,S,R;return[o[16]||(o[16]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Add Todo")],-1)),t("div",Pt,[t("div",Rt,[o[11]||(o[11]=t("label",{class:"block text-gray-700 font-medium mb-1 text-sm"},"Title",-1)),G(t("input",{ref_key:"titleRef",ref:g,"onUpdate:modelValue":o[0]||(o[0]=E=>u.value.title=E),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[q,u.value.title]])]),t("div",Mt,[o[12]||(o[12]=t("label",{class:"block text-gray-700 font-medium mb-1 text-sm"},"Date",-1)),G(t("input",{readonly:($=n.readonlyValues)==null?void 0:$.date,"onUpdate:modelValue":o[1]||(o[1]=E=>u.value.date=E),type:"date",required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,8,Ut),[[q,u.value.date]])]),p(r).isAdminMood?(m(),O(rt,{key:0,modelValue:e.value,"onUpdate:modelValue":o[2]||(o[2]=E=>e.value=E),companies:((S=p(C))==null?void 0:S.myCompanies)||[],class:"mb-4"},{label:I(()=>o[13]||(o[13]=[t("label",{class:"block text-gray-700 font-medium mb-1 text-sm"},[V(" Project Department "),t("span",{class:"text-gray-500"},"(Optional - for new project)")],-1)])),_:1},8,["modelValue","companies"])):T("",!0),t("div",Nt,[o[14]||(o[14]=t("label",{class:"block text-gray-700 font-medium mb-1 text-sm"},[V(" Issue/Website/Project "),t("span",{class:"text-gray-500"},"(Optional)")],-1)),j(pt,{modelValue:i.value,"onUpdate:modelValue":o[3]||(o[3]=E=>i.value=E),"onUpdate:inputValue":o[4]||(o[4]=E=>c.value=E),options:p(b).projects,label:"title",value:"id",placeholder:"Select or type project..."},null,8,["modelValue","options"])]),t("div",At,[o[15]||(o[15]=t("label",{class:"block text-gray-700 font-medium mb-1 text-sm"},"Task (optional)",-1)),j(mt,{show:y.value,"onUpdate:show":o[5]||(o[5]=E=>y.value=E),todoType:u.value.todo_type,"onUpdate:todoType":o[6]||(o[6]=E=>u.value.todo_type=E),todoTypeId:u.value.todo_type_id,"onUpdate:todoTypeId":o[7]||(o[7]=E=>u.value.todo_type_id=E),readonly:(R=n.readonlyValues)==null?void 0:R.todo_type_id},null,8,["show","todoType","todoTypeId","readonly"])])])]}),_:1,__:[16]},8,["isSubmitting","error"])]))}},Gt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},zt={class:"mb-4 text-md"},Ft={class:"font-semibold"},Kt={class:"mb-2"},Wt={__name:"TodoDateAddForm",props:{date:{type:[String,Number],default:W(new Date)},todoId:{type:[String,Number],required:!0},userRole:{type:String,default:"employee"}},emits:["update","cancelClick"],setup(n,{emit:h}){const a=n,s=v(),y=v(!1),g=v(),d=lt(),b=ut(),r=h,C=v({date:a.date||"",todo_id:a.todoId});async function i(){try{s.value="submitting",await b.createTodoDate(C.value),r("update")}finally{s.value=""}}return z(async()=>{var c;await H(),await d.fetchTodo(a.todoId),(c=g.value)==null||c.focus()}),(c,e)=>(m(),k("div",{onClick:e[2]||(e[2]=D=>y.value=!1)},[p(d).loading?(m(),O(tt,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:I(()=>e[3]||(e[3]=[V(" Loading... ")])),_:1,__:[3]})):T("",!0),j(at,{onSubmit:i,onClickCancel:e[1]||(e[1]=D=>r("cancelClick")),isSubmitting:s.value=="submitting",error:p(b).error,class:"rounded-md relative"},{default:I(()=>{var D;return[e[6]||(e[6]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Carry Todo To Date")],-1)),t("div",Gt,[t("div",zt,[e[4]||(e[4]=V(" TODO: ")),t("span",Ft,P((D=p(d).todo)==null?void 0:D.title),1)]),t("div",Kt,[e[5]||(e[5]=t("span",{class:"font-semibold"}," Date ",-1)),G(t("input",{"onUpdate:modelValue":e[0]||(e[0]=u=>C.value.date=u),type:"date",multiple:"",required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[q,C.value.date]])])])]}),_:1,__:[6]},8,["isSubmitting","error"])]))}},qt={key:0,class:"mb-4 text-red-500 font-medium"},Ht={key:1,class:"mb-4 text-red-500 font-medium"},Qt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},Yt={class:"mb-5"},Zt={class:"relative group"},Jt={class:"mb-5"},Xt={class:"relative group"},te={key:0,value:"PENDING"},ee={class:"mb-5"},oe={class:"mb-8"},le={__name:"TodoEditForm",props:{date:{type:String,default:W(new Date)},todo:{type:Object,default:()=>({})}},emits:["update","cancelClick"],setup(n,{emit:h}){var M;const a=n,s=v(),y=v(!1),g=v(),d=lt(),b=it(),r=ot(),C=nt(),i=v(null),c=v(""),e=v(null),D=h,u=v({title:"",todo_type:"task",todo_type_id:"",status:"PENDING"}),L=v({id:null,repeat_type:"daily",start_date:((M=a.todo)==null?void 0:M.date)||a.date||W(new Date),end_date:null,weekly_day:null,monthly_mode:null,monthly_value:null,monthly_week:null,yearly_month:null,yearly_day:null}),_=v(!1),o=v({});async function $(){var x,l,w,f,st;await d.fetchTodo((x=a.todo)==null?void 0:x.id),u.value.title=(l=d.todo)==null?void 0:l.title,u.value.todo_type_id=(w=d.todo)==null?void 0:w.todoable_id,u.value.status=((f=d.todo)==null?void 0:f.status)||"PENDING",i.value=((st=d.todo)==null?void 0:st.todo_project_id)||null}const S=v(null);async function R(){var x,l;try{const{data:w}=await Tt(a.todo.id),f=w==null?void 0:w.setting;f?(_.value=!0,S.value=f.id,L.value={repeat_type:f.repeat_type??"daily",start_date:f.start_date??L.value.start_date,end_date:f.end_date??null,weekly_day:f.weekly_day??null,monthly_mode:f.monthly_mode??null,monthly_value:f.monthly_value??null,monthly_week:f.monthly_week??null,yearly_month:f.yearly_month??null,yearly_day:f.yearly_day??null}):L.value.id=null}catch(w){N.value=(l=(x=w==null?void 0:w.response)==null?void 0:x.data)==null?void 0:l.message,console.error("Load setting failed:",(w==null?void 0:w.message)||w)}}async function E(){const x={title:u.value.title,todo_type:u.value.todo_type,todo_type_id:u.value.todo_type_id,status:u.value.status};if(i.value)x.todo_project_id=i.value;else if(c.value){const l=await b.createProject({title:c.value,department_id:e.value});x.todo_project_id=l.id}await d.updateTodo(a.todo.id,x)}async function Q(){var x,l;if(!_.value)S.value&&await Ct(a.todo.id,S.value);else{const w=(x=o.value)!=null&&x.buildPayload?o.value.buildPayload():{...L.value};w.start_date||(w.start_date=((l=a.todo)==null?void 0:l.date)||a.date||W(new Date)),await St(a.todo.id,w)}}const Y=x=>{var l,w;return((w=(l=x==null?void 0:x.response)==null?void 0:l.data)==null?void 0:w.message)||(x==null?void 0:x.message)||"Something went wrong"};async function Z(){const[x,l]=await Promise.allSettled([E(),Q()]),w=x.status==="fulfilled",f=l.status==="fulfilled";f||(N.value=Y(l.reason)),w&&f&&D("update")}const A=v(!1),N=v(!1);async function J(){var x;r.isAdminMood&&await C.fetchMyCompanies({with:"departments"}),b.fetchProjects(),await $(),A.value=!0,await R(),A.value=!1,await H(),(x=g.value)==null||x.focus()}const F=B(()=>d.loading||A.value);return z(()=>{J()}),(x,l)=>(m(),k("div",{class:"relative",onClick:l[9]||(l[9]=w=>y.value=!1)},[F.value?(m(),O(tt,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:I(()=>l[10]||(l[10]=[V(" Loading... ")])),_:1,__:[10]})):T("",!0),j(at,{onSubmit:Z,onClickCancel:l[8]||(l[8]=w=>D("cancelClick")),isSubmitting:s.value=="submitting",isLoading:F.value,id:"todoEditForm"},{error:I(()=>[t("div",null,[p(d).error?(m(),k("div",qt,P(p(d).error),1)):T("",!0),N.value?(m(),k("div",Ht,P(N.value),1)):T("",!0)])]),default:I(()=>{var w;return[l[24]||(l[24]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Edit Todo")],-1)),t("div",Qt,[l[23]||(l[23]=t("div",{class:"text-xs text-red-800 mb-6"},[t("strong",null,"Tips:"),V(" If you change the todo, it will change to all the concurrent dates ")],-1)),t("div",Yt,[l[12]||(l[12]=t("label",{class:"block text-slate-500 font-bold text-[11px] uppercase tracking-wider mb-1.5 ml-1"}," Title ",-1)),t("div",Zt,[G(t("input",{ref_key:"titleRef",ref:g,"onUpdate:modelValue":l[0]||(l[0]=f=>u.value.title=f),required:"",placeholder:"Enter todo title",class:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-sky-500/10 focus:border-sky-400 outline-none transition-all duration-200 font-medium text-slate-700"},null,512),[[q,u.value.title]]),l[11]||(l[11]=t("div",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-sky-500 transition-colors"},[t("i",{class:"fas fa-edit text-sm"})],-1))])]),t("div",Jt,[l[19]||(l[19]=t("label",{class:"block text-slate-500 font-bold text-[11px] uppercase tracking-wider mb-1.5 ml-1"}," Status ",-1)),t("div",Xt,[G(t("select",{"onUpdate:modelValue":l[1]||(l[1]=f=>u.value.status=f),class:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-sky-500/10 focus:border-sky-400 outline-none appearance-none transition-all duration-200 font-medium text-slate-700"},[u.value.status==="PENDING"?(m(),k("option",te,"PENDING")):T("",!0),l[13]||(l[13]=t("option",{value:"WORKING"},"WORKING",-1)),l[14]||(l[14]=t("option",{value:"DEPENDANT"},"DEPENDANT",-1)),l[15]||(l[15]=t("option",{value:"BACK_LOG"},"BACK_LOG",-1)),l[16]||(l[16]=t("option",{value:"COMPLETED"},"COMPLETED",-1))],512),[[gt,u.value.status]]),l[17]||(l[17]=t("div",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 group-focus-within:text-sky-500 transition-colors"},[t("i",{class:"fas fa-tasks text-sm"})],-1)),l[18]||(l[18]=t("div",{class:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none"},[t("i",{class:"fas fa-chevron-down text-[10px]"})],-1))])]),p(r).isAdminMood?(m(),O(rt,{key:0,modelValue:e.value,"onUpdate:modelValue":l[2]||(l[2]=f=>e.value=f),companies:((w=p(C))==null?void 0:w.myCompanies)||[],class:"mb-5"},{label:I(()=>l[20]||(l[20]=[t("label",{class:"block text-slate-500 font-bold text-[11px] uppercase tracking-wider mb-1.5 ml-1"},[V(" Project Department "),t("span",{class:"text-[10px] lowercase font-normal"},"(Optional - for new project)")],-1)])),_:1},8,["modelValue","companies"])):T("",!0),t("div",ee,[l[21]||(l[21]=t("label",{class:"block text-slate-500 font-bold text-[11px] uppercase tracking-wider mb-1.5 ml-1"},[V(" Issue/Website/Project "),t("span",{class:"text-[10px] lowercase font-normal"},"(Optional)")],-1)),j(pt,{modelValue:i.value,"onUpdate:modelValue":l[3]||(l[3]=f=>i.value=f),"onUpdate:inputValue":l[4]||(l[4]=f=>c.value=f),options:p(b).projects,value:"id",label:"title",placeholder:"Select or type project..."},null,8,["modelValue","options"])]),t("div",oe,[l[22]||(l[22]=t("label",{class:"block text-slate-500 font-bold text-[11px] uppercase tracking-wider mb-1.5 ml-1"},[V(" Task ID "),t("span",{class:"text-[10px] lowercase font-normal"},"(Optional)")],-1)),j(mt,{show:y.value,"onUpdate:show":l[5]||(l[5]=f=>y.value=f),todoType:u.value.todo_type,"onUpdate:todoType":l[6]||(l[6]=f=>u.value.todo_type=f),todoTypeId:u.value.todo_type_id,"onUpdate:todoTypeId":l[7]||(l[7]=f=>u.value.todo_type_id=f)},null,8,["show","todoType","todoTypeId"])])])]}),_:1,__:[24]},8,["isSubmitting","isLoading"])]))}},ae={class:"relative"},se={class:"min-h-[10vh] max-h-[50vh] overflow-y-auto p-4"},de={class:"mb-4 flex justify-between items-end"},ne={class:"mb-4 flex justify-between items-center group"},ie={class:"text-sm font-semibold text-slate-700"},re={key:0,class:"mt-1 flex items-center gap-2 mb-4"},ue={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},pe={class:"mt-6 p-4 bg-slate-50 rounded-xl border border-slate-200 shadow-inner"},me={class:"flex items-center justify-between mb-4"},ce={class:"flex items-center gap-2 px-3 py-1.5 bg-white rounded-full shadow-sm border border-slate-100"},fe={class:"text-xs font-bold text-slate-700 tracking-wide"},ye={key:0},ve={class:"grid grid-cols-2 gap-3"},be={key:1,class:"py-4 text-center text-emerald-600 bg-emerald-50 rounded-lg border border-emerald-100"},ge={class:"flex justify-between items-center gap-4 py-4 px-4 border-t"},xe={key:0,class:"ml-auto flex items-center gap-2"},we={__name:"TodoShow",props:{todoDate:{type:Object,default:()=>{}}},emits:["cancelClick","clickEdit","update","clickAddTodoDate"],setup(n,{emit:h}){const a=n,s=ut(),y=ot(),g=h;async function d(){var c;console.log({todo_date:"dd"}),await s.fetchTodoDate((c=a.todoDate)==null?void 0:c.id)}const b=B(()=>{var c,e;return(c=s.todo_date)!=null&&c.date?new Date((e=s.todo_date)==null?void 0:e.date):null}),r=B(()=>{var c,e,D;return((e=(c=s.todo_date)==null?void 0:c.user)==null?void 0:e.id)===((D=y.user)==null?void 0:D.id)});async function C(c){var e;confirm(`Are your sure want to delete todo
'${(e=s.todo_date)==null?void 0:e.title}'`)&&(await s.deleteTodoDate(c.id),g("update"))}async function i(c,e){var D;confirm(`Are your sure want to compete todo
'${(D=s.todo_date)==null?void 0:D.title}'`)&&(await s.updateStatus(c.id,e),g("update"))}return z(async()=>{await d()}),(c,e)=>{var D,u,L,_,o,$,S,R,E,Q,Y,Z,A,N,J;return m(),k("div",ae,[p(s).loading?(m(),O(tt,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:I(()=>e[8]||(e[8]=[V(" Loading... ")])),_:1,__:[8]})):T("",!0),t("div",null,[e[21]||(e[21]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Show Todo")],-1)),t("div",se,[t("div",de,[t("div",null,[e[9]||(e[9]=t("div",{class:"text-xs text-gray-500"},"Todo",-1)),V(" "+P((D=p(s).todo_date)==null?void 0:D.title),1)]),((u=p(s).todo_date)==null?void 0:u.status)!=="COMPLETED"?(m(),k("button",{key:0,class:"btn-2 bg-sky-400 text-white hover:bg-sky-600 hover:text-white bg-none",onClick:e[0]||(e[0]=U(F=>{var M;return g("clickEdit",(M=p(s).todo_date)==null?void 0:M.todo)},["prevent","stop"]))},e[10]||(e[10]=[t("i",{class:"fas fa-pen"},null,-1),V(" Edit Todo ")]))):T("",!0)]),e[20]||(e[20]=t("hr",{class:"mb-4"},null,-1)),t("div",ne,[t("div",null,[e[11]||(e[11]=t("div",{class:"font-semibold text-[10px] text-slate-400 uppercase tracking-wider mb-0.5"}," Date ",-1)),t("div",ie,P(p(xt)(b.value,{weekDay:"long"})),1)]),r.value&&!p(s).loading?(m(),k("button",{key:0,class:"btn-2 bg-emerald-500 text-white hover:bg-emerald-700 hover:text-white bg-none",onClick:e[1]||(e[1]=U(F=>{var M,x;return g("clickAddTodoDate",(M=p(s).todo_date)==null?void 0:M.todo_id,(x=p(s).todo_date)==null?void 0:x.date)},["prevent","stop"]))},e[12]||(e[12]=[t("i",{class:"fas fa-calendar-plus mr-1"},null,-1),V(" Add to another date ")]))):T("",!0)]),(L=n.todoDate)!=null&&L.user?(m(),k("div",re,[j(Dt,{user:n.todoDate.user,"avatar-size":"xsmall"},null,8,["user"]),t("div",ue,P((o=(_=n.todoDate.user)==null?void 0:_.department)==null?void 0:o.name),1)])):T("",!0),t("div",pe,[t("div",me,[e[13]||(e[13]=t("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"}," Current Status ",-1)),t("div",ce,[($=p(s))!=null&&$.todo_date?(m(),O($t,{key:0,todoDate:(S=p(s))==null?void 0:S.todo_date},null,8,["todoDate"])):T("",!0),t("span",fe,P((R=p(s).todo_date)==null?void 0:R.status),1)])]),r.value&&!p(s).loading&&((E=p(s).todo_date)==null?void 0:E.status)!=="COMPLETED"?(m(),k("div",ye,[e[18]||(e[18]=t("div",{class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-3 text-center"}," Quick Transitions ",-1)),t("div",ve,[((Q=p(s).todo_date)==null?void 0:Q.status)!=="WORKING"?(m(),k("button",{key:0,class:"btn-2 py-2.5 from-amber-600 to-amber-400 text-white hover:scale-[1.02] active:scale-[0.98] shadow-md transition-all duration-200",onClick:e[2]||(e[2]=U(()=>i(p(s).todo_date,"WORKING"),["prevent","stop"]))},e[14]||(e[14]=[t("i",{class:"fas fa-sync-alt mr-1"},null,-1),V(" Working ")]))):T("",!0),((Y=p(s).todo_date)==null?void 0:Y.status)!=="COMPLETED"&&((Z=p(s).todo_date)==null?void 0:Z.status)!=="BACK_LOG"?(m(),k("button",{key:1,class:"btn-2 py-2.5 from-emerald-600 to-emerald-400 text-white hover:scale-[1.02] active:scale-[0.98] shadow-md transition-all duration-200",onClick:e[3]||(e[3]=U(()=>i(p(s).todo_date,"COMPLETED"),["prevent","stop"]))},e[15]||(e[15]=[t("i",{class:"fas fa-check-double mr-1"},null,-1),V(" Complete ")]))):T("",!0),((A=p(s).todo_date)==null?void 0:A.status)!=="DEPENDANT"?(m(),k("button",{key:2,class:"btn-4 py-2 bg-white border border-slate-200 text-slate-600 hover:bg-orange-50 hover:text-orange-600 hover:border-orange-200 hover:scale-[1.02] active:scale-[0.98] shadow-sm transition-all duration-200",onClick:e[4]||(e[4]=U(()=>i(p(s).todo_date,"DEPENDANT"),["prevent","stop"]))},e[16]||(e[16]=[t("i",{class:"fas fa-pause-circle mr-1"},null,-1),V(" Dependant / Pause ")]))):T("",!0),((N=p(s).todo_date)==null?void 0:N.status)!=="BACK_LOG"?(m(),k("button",{key:3,class:"btn-4 py-2 bg-white border border-slate-200 text-slate-600 hover:bg-purple-50 hover:text-purple-600 hover:border-purple-200 hover:scale-[1.02] active:scale-[0.98] shadow-sm transition-all duration-200",onClick:e[5]||(e[5]=U(()=>i(p(s).todo_date,"BACK_LOG"),["prevent","stop"]))},e[17]||(e[17]=[t("i",{class:"fas fa-history mr-1"},null,-1),V(" Backlog ")]))):T("",!0)])])):((J=p(s).todo_date)==null?void 0:J.status)==="COMPLETED"?(m(),k("div",be,e[19]||(e[19]=[t("i",{class:"fas fa-check-circle text-2xl mb-1"},null,-1),t("div",{class:"text-xs font-bold uppercase tracking-wider"},"This Todo is Completed",-1)]))):T("",!0)])])]),t("div",ge,[t("button",{type:"button",onClick:e[6]||(e[6]=F=>g("cancelClick")),class:"btn-3"},"Cancel"),r.value&&!p(s).loading?(m(),k("div",xe,[t("button",{class:"btn-2-red",onClick:e[7]||(e[7]=U(()=>C(p(s).todo_date),["prevent","stop"]))},e[22]||(e[22]=[t("i",{class:"fas fa-trash-alt"},null,-1),V(" Delete ")]))])):T("",!0)])])}}},Oe={__name:"TodoCreateEditShow",props:{todoModal:{type:Object,required:!0},userRole:{type:String,required:"employee"}},emits:["cancelClick","todoUpdate","todoDateUpdate","clickEdit","clickDelete","clickChangeStatus","clickAddTodoDate"],setup(n,{emit:h}){const a=h;function s(){a("todoUpdate")}function y(){a("todoDateUpdate")}return(g,d)=>(m(),k(dt,null,[n.todoModal.action=="add"?(m(),O(X,{key:0},{default:I(()=>{var b,r,C,i;return[j(Bt,{onCancelClick:d[0]||(d[0]=c=>a("cancelClick")),onUpdate:s,date:(b=n.todoModal)==null?void 0:b.date,todoType:(r=n.todoModal)==null?void 0:r.todoType,todoTypeId:(C=n.todoModal)==null?void 0:C.todoTypeId,readonlyValues:((i=n.todoModal)==null?void 0:i.formReadonlyValues)||{},userRole:n.userRole},null,8,["date","todoType","todoTypeId","readonlyValues","userRole"])]}),_:1})):T("",!0),n.todoModal.action=="addDate"?(m(),O(X,{key:1},{default:I(()=>{var b,r,C;return[j(Wt,{onCancelClick:d[1]||(d[1]=i=>a("cancelClick")),onUpdate:y,date:(b=n.todoModal)==null?void 0:b.date,todoId:(r=n.todoModal)==null?void 0:r.todo_id,userRole:n.userRole,readonlyValues:((C=n.todoModal)==null?void 0:C.formReadonlyValues)||{}},null,8,["date","todoId","userRole","readonlyValues"])]}),_:1})):T("",!0),n.todoModal.action=="edit"?(m(),O(X,{key:2},{default:I(()=>{var b,r;return[j(le,{onCancelClick:d[2]||(d[2]=C=>a("cancelClick")),onUpdate:s,todo:(b=n.todoModal)==null?void 0:b.todo,userRole:n.userRole,readonlyValues:((r=n.todoModal)==null?void 0:r.formReadonlyValues)||{}},null,8,["todo","userRole","readonlyValues"])]}),_:1})):T("",!0),n.todoModal.action=="show"?(m(),O(X,{key:3},{default:I(()=>{var b;return[j(we,{onCancelClick:d[3]||(d[3]=r=>a("cancelClick")),onUpdate:y,onClickEdit:d[4]||(d[4]=r=>a("clickEdit",r)),onClickAddTodoDate:d[5]||(d[5]=(...r)=>a("clickAddTodoDate",...r)),onClickDelete:d[6]||(d[6]=r=>a("clickDelete",r)),onClickChangeStatus:d[7]||(d[7]=(r,C)=>a("clickChangeStatus",r,C)),todoDate:(b=n.todoModal)==null?void 0:b.todo,userRole:n.userRole},null,8,["todoDate","userRole"])]}),_:1})):T("",!0)],64))}};export{Oe as _};
