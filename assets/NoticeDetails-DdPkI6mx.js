import{a1 as q,b as J,r as g,p as N,y as Q,e as X,c as i,o,a as e,l as Z,j as f,f as ee,t as n,g as y,h as te,v as se,V as ae,w as oe,n as ie,s as de,a7 as le}from"./index-Dxc5EEcs.js";import{L as re}from"./LoaderView-BcM1hLIT.js";import{_ as ne}from"./ShareComponent-BNHkPc5w.js";import{u as ce}from"./notice-D9EiHrc4.js";import{S as ue}from"./sweetalert2.esm.all-DGhwgajj.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ve="/assets/notice-tV7AYWV_.png",fe={class:"my-container py-6"},be={class:"mx-auto max-w-5xl"},xe={class:"rounded-2xl bg-white shadow-sm ring-1 ring-gray-100 overflow-hidden"},pe={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 px-5 py-4 border-b"},ge={class:"flex items-center gap-2"},ye={key:0,class:"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-medium text-amber-700 bg-amber-50 border-amber-200",title:"No feedback yet"},_e={key:1,class:"inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-medium text-emerald-700 bg-emerald-50 border-emerald-200",title:"Feedback submitted"},he={class:"px-5 py-5"},ke={key:1,class:"rounded-lg bg-red-50 text-red-700 px-4 py-3"},we={key:2,class:"grid gap-6"},Fe={class:"rounded-xl border p-5"},Ne={class:"flex items-start justify-between gap-4"},je=["innerHTML"],De={class:"shrink-0 mt-1"},Ce={key:0,class:"h-3 w-3 bg-red-500 rounded-full inline-block",title:"No feedback yet"},Se={key:1,class:"inline-flex items-center justify-center h-6 w-6 rounded-full bg-emerald-50",title:"Feedback submitted"},Ve={key:0,class:"mt-4"},Te=["innerHTML"],Le={key:1,class:"mt-5 grid sm:grid-cols-2 gap-4"},Me={class:"rounded-lg bg-gray-50 p-3"},$e={class:"text-sm font-medium text-gray-800"},Be={class:"rounded-lg bg-gray-50 p-3"},He={class:"text-sm font-medium text-gray-800"},Ie={key:0,class:"rounded-xl border p-5"},Pe={class:"flex items-center justify-between"},Ye={class:"mt-3"},Ee={key:0,class:"relative rounded-lg overflow-hidden border"},Ae=["src"],Ge={key:1,class:"rounded-lg overflow-hidden border"},Ke=["src"],Re={key:2,class:"rounded-lg bg-gray-50 p-4 border flex items-center justify-between"},Ue={class:"text-gray-700"},ze={class:"rounded-2xl border p-5"},Oe={class:"flex items-center justify-between"},We={key:0,class:"mt-4 space-y-3"},qe=["maxlength","onKeyup"],Je={class:"mt-1 flex items-center justify-between text-xs"},Qe={class:"flex items-center gap-3"},Xe=["disabled"],Ze={key:0,class:"text-sm text-gray-500"},et={key:1,class:"mt-4"},tt={class:"rounded-xl bg-emerald-50 border border-emerald-200 px-4 py-3 text-emerald-800"},st={class:"flex items-start gap-3"},at={class:"text-sm mt-0.5"},ot={class:"rounded-2xl border p-5"},_=300,it={__name:"NoticeDetails",setup(dt){const j=ce(),h=q(),D=J(),a=g(null),u=g(!0),m=g(null),v=g(!1),b=g(""),C=t=>t?new Date(t).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}):"N/A",U=t=>!!t&&/\.(jpg|jpeg|png|gif|webp)$/i.test(t),z=t=>!!t&&/\.pdf$/i.test(t),S=t=>(t==null?void 0:t.split("/").pop())||"file",k=N(()=>{var t;return!!((t=a.value)!=null&&t.user_feedback)}),V=N(()=>{var t;return _-(((t=b.value)==null?void 0:t.length)||0)}),O=N(()=>{const t=(b.value||"").trim();return u.value||t.length===0||t.length>_}),W=async()=>{var t,s,c;try{u.value=!0,m.value=null;const l=D.params.id,d=await j.fetchNoticeDetails(l);a.value=d,b.value=((t=d==null?void 0:d.user_feedback)==null?void 0:t.feedback)||"",v.value=!(d!=null&&d.user_feedback)}catch(l){m.value=((c=(s=l==null?void 0:l.response)==null?void 0:s.data)==null?void 0:c.message)||"Failed to load notice details",h.error(m.value)}finally{u.value=!1}},T=async()=>{var s,c,l;const t=(b.value||"").trim();if(!t){h.error("Please enter your feedback");return}if(t.length>_){h.error(`Feedback must be within ${_} characters`);return}u.value=!0;try{const d=D.params.id,x={feedback:t},r=await j.createNoticeFeedback(d,x),w=((s=r==null?void 0:r.data)==null?void 0:s.user_feedback)||(r==null?void 0:r.user_feedback)||x;a.value={...a.value,user_feedback:w},await ue.fire({position:"top-end",icon:"success",title:"Your feedback has been saved",showConfirmButton:!1,timer:1300}),v.value=!1}catch(d){m.value=((l=(c=d==null?void 0:d.response)==null?void 0:c.data)==null?void 0:l.message)||"Failed to save feedback",h.error(m.value)}finally{u.value=!1}};Q(()=>a.value,t=>{le({title:(t==null?void 0:t.title)||"Genesis - Notice",meta:[{property:"og:title",content:(t==null?void 0:t.title)||"Genesis - Notice"},{property:"og:image",content:(t==null?void 0:t.file)||ve},{property:"og:description",content:(t==null?void 0:t.description)||"Genesis - Notice Description"}]})},{immediate:!0});const L=t=>{t&&window.open(t,"_blank")};return X(W),(t,s)=>{var c,l,d,x,r,w,M,$,B,H,I,P,Y,E,A,G,K,R;return o(),i("div",fe,[e("div",be,[e("div",xe,[e("div",pe,[s[6]||(s[6]=Z('<div class="flex items-center gap-3" data-v-579036d8><div class="h-10 w-10 rounded-xl bg-indigo-50 flex items-center justify-center" data-v-579036d8><i class="far fa-bell text-indigo-600" data-v-579036d8></i></div><div data-v-579036d8><h1 class="text-xl md:text-2xl font-semibold text-gray-900" data-v-579036d8>Notice Details</h1><p class="text-sm text-gray-500" data-v-579036d8>Review the notice and leave your feedback</p></div></div>',1)),e("div",ge,[(c=a.value)!=null&&c.user_feedback?(o(),i("span",_e,s[5]||(s[5]=[e("i",{class:"far fa-check"},null,-1),f(" Feedback Submitted ")]))):(o(),i("span",ye,s[4]||(s[4]=[e("span",{class:"h-2 w-2 rounded-full bg-amber-500"},null,-1),f(" Pending Feedback ")])))])]),e("div",he,[u.value?(o(),ee(re,{key:0,class:"shadow-none"})):m.value?(o(),i("div",ke,n(m.value),1)):(o(),i("div",we,[e("div",Fe,[e("div",Ne,[e("div",null,[s[7]||(s[7]=e("div",{class:"text-xs uppercase tracking-wider font-medium text-gray-500 mb-1"},"Title",-1)),e("h2",{class:"text-lg md:text-xl font-semibold text-gray-900",innerHTML:(l=a.value)==null?void 0:l.title},null,8,je)]),e("div",De,[(d=a.value)!=null&&d.user_feedback?(o(),i("span",Se,s[8]||(s[8]=[e("i",{class:"far fa-check text-emerald-600"},null,-1)]))):(o(),i("span",Ce))])]),(x=a.value)!=null&&x.description?(o(),i("div",Ve,[s[9]||(s[9]=e("div",{class:"text-xs uppercase tracking-wider font-medium text-gray-500 mb-1"},"Description",-1)),e("div",{class:"prose max-w-none text-gray-800",innerHTML:(r=a.value)==null?void 0:r.description},null,8,Te)])):y("",!0),(w=a.value)!=null&&w.published_at||(M=a.value)!=null&&M.expired_at?(o(),i("div",Le,[e("div",Me,[s[10]||(s[10]=e("div",{class:"text-xs text-gray-500"},"Published",-1)),e("div",$e,n(C(($=a.value)==null?void 0:$.published_at)),1)]),e("div",Be,[s[11]||(s[11]=e("div",{class:"text-xs text-gray-500"},"Expires",-1)),e("div",He,n(C((B=a.value)==null?void 0:B.expired_at)),1)])])):y("",!0)]),(H=a.value)!=null&&H.file?(o(),i("div",Ie,[e("div",Pe,[s[12]||(s[12]=e("div",{class:"text-sm font-semibold text-gray-800 flex items-center gap-2"},[e("i",{class:"far fa-file"}),f(" Attachment ")],-1)),e("button",{class:"text-sm underline text-indigo-600 hover:text-indigo-700",onClick:s[0]||(s[0]=F=>{var p;return L((p=a.value)==null?void 0:p.file)})}," Download ("+n(S((I=a.value)==null?void 0:I.file))+") ",1)]),e("div",Ye,[U((P=a.value)==null?void 0:P.file)?(o(),i("div",Ee,[e("img",{src:(Y=a.value)==null?void 0:Y.file,alt:"Notice File",class:"w-full max-h-[480px] object-contain bg-gray-50"},null,8,Ae)])):z((E=a.value)==null?void 0:E.file)?(o(),i("div",Ge,[e("iframe",{src:(A=a.value)==null?void 0:A.file,class:"w-full h-[700px] bg-white"},null,8,Ke)])):(o(),i("div",Re,[e("div",Ue,[s[13]||(s[13]=e("span",{class:"font-medium"},"File:",-1)),f(" "+n(S((G=a.value)==null?void 0:G.file)),1)]),e("button",{class:"px-3 py-2 rounded-lg bg-indigo-600 text-white text-sm hover:bg-indigo-700",onClick:s[1]||(s[1]=F=>{var p;return L((p=a.value)==null?void 0:p.file)})}," Open ")]))])])):y("",!0),e("div",ze,[e("div",Oe,[s[14]||(s[14]=e("div",{class:"flex items-center gap-2"},[e("div",{class:"h-8 w-8 rounded-lg bg-emerald-50 flex items-center justify-center"},[e("i",{class:"far fa-comment-dots text-emerald-600"})]),e("h3",{class:"text-base md:text-lg font-semibold text-gray-900"},"Your Feedback")],-1)),k.value?(o(),i("button",{key:0,onClick:s[2]||(s[2]=F=>v.value=!v.value),class:"text-sm px-3 py-1.5 rounded-lg border hover:bg-gray-50"},n(v.value?"Cancel":"Edit Feedback"),1)):y("",!0)]),!k.value||v.value?(o(),i("div",We,[e("div",null,[te(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=F=>b.value=F),maxlength:_+1,rows:"3",class:"w-full rounded-xl border px-3 py-2 focus:ring-2 focus:ring-indigo-200 focus:border-indigo-400 outline-none",placeholder:"Type your feedback here...",onKeyup:ae(oe(T,["ctrl"]),["enter"])},null,40,qe),[[se,b.value]]),e("div",Je,[s[15]||(s[15]=e("span",{class:"text-gray-500"},[f("Press "),e("kbd",{class:"px-1 border rounded"},"Ctrl"),f(" + "),e("kbd",{class:"px-1 border rounded"},"Enter"),f(" to submit")],-1)),e("span",{class:ie(V.value<0?"text-red-600":"text-gray-500")},n(V.value)+" characters left",3)])]),e("div",Qe,[e("button",{onClick:T,disabled:O.value,class:"px-4 py-2 rounded-xl text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-60 disabled:cursor-not-allowed"},n(u.value?"Saving...":k.value?"Update Feedback":"Submit Feedback"),9,Xe),k.value&&!v.value?(o(),i("span",Ze,"You can edit your feedback anytime.")):y("",!0)])])):(o(),i("div",et,[e("div",tt,[e("div",st,[s[17]||(s[17]=e("i",{class:"far fa-check-circle mt-0.5"},null,-1)),e("div",null,[s[16]||(s[16]=e("div",{class:"text-sm font-semibold"},"Your feedback",-1)),e("div",at,n((R=(K=a.value)==null?void 0:K.user_feedback)==null?void 0:R.feedback),1)])])])]))]),e("div",ot,[de(ne)])]))])])])])}}},vt=me(it,[["__scopeId","data-v-579036d8"]]);export{vt as default};
