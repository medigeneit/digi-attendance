import{N as Rt,u as Dt,j as Et,r as v,y as Ft,b as Nt,c as o,a as t,l as a,k as St,t as l,h,e as i,q as Bt,m as ct,n as $t,d as mt,v as _t,F as Vt,f as Mt,o as n,g as qt}from"./index-oqIfDxm5.js";import{L as Ut}from"./LoaderView-wP3ygJkD.js";import{_ as It}from"./ScreenshotCapture-DLAjq6ad.js";import{_ as Lt}from"./ShareComponent-BzxrVw_-.js";import{u as Tt}from"./exchange-BKT4HoYk.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Wt={class:"my-container max-w-3xl space-y-6"},Ht={key:1,class:"bg-white rounded p-4 md:p-8",id:"leave-application"},Pt={class:"flex justify-end"},zt={class:"font-medium"},Ot={class:"gap-y-1"},Gt={class:"gap-y-1"},Jt={class:"grid md:grid-cols-2 pt-3"},Kt={class:"col-span-2 pt-2"},Qt={class:"grid print:grid-cols-2 md:grid-cols-2 gap-4 pt-10"},Xt={key:0,class:"print:hidden"},Yt={class:"text-xs"},Zt={class:"flex gap-2"},es={class:"font-bold"},ts={key:0,class:"text-green-600 print:text-black"},ss={key:1,class:"pl-2 text-yellow-700"},ls={class:"text-xs text-gray-500"},as={class:"title-md"},ns={key:0},os={class:"grid grid-cols-2 print:grid-cols-3 md:grid-cols-3 justify-center items-center gap-4"},rs={class:"pt-10"},is={key:0},us={key:1},ds={key:2,class:"print:hidden"},ps={class:"text-xs text-blue-600"},vs={class:"flex gap-4"},cs={class:"font-bold"},ms={key:0,class:"text-green-600"},_s={key:1,class:"pl-2 text-yellow-700"},gs={class:"text-xs text-gray-500"},fs={class:"pt-10"},ys={key:0},xs={key:1},bs={key:2,class:"print:hidden"},hs={class:"text-xs text-blue-600"},ks={class:"flex gap-4"},ws={class:"font-bold"},As={key:0,class:"text-green-600"},js={key:1,class:"pl-2 text-yellow-700"},Cs={class:"text-xs text-gray-500"},Rs={class:"pt-10"},Ds={key:0},Es={key:1},Fs={key:2,class:"print:hidden"},Ns={class:"text-xs text-blue-600"},Ss={class:"flex gap-4"},Bs={class:"font-bold"},$s={key:0,class:"text-green-600"},Vs={key:1,class:"pl-2 text-yellow-700"},Ms={class:"text-xs text-gray-500"},qs={class:"print:hidden"},Us={key:0,class:"mb-2"},Is=["href"],Ls={key:0,class:"modal-bg"},Ts={class:"modal-card"},Ws={class:"flex justify-end gap-2 mt-4"},Hs={key:1,class:"modal-bg"},Ps={class:"modal-card"},zs={class:"flex justify-end gap-2 mt-4"},Zs={__name:"ExchangeShiftShow",setup(Os){const gt=Rt(),ft=qt(),c=Mt(),u=Tt(),g=Dt(),w=Et(),A=v(!0),f=v(!1),y=v(""),x=v(!1),m=v(""),j=v(null),s=Ft(()=>u.exchange);Nt(async()=>{const{id:r}=c.params;try{await u.fetchExchange(r)}catch(e){console.error("Failed to fetch exchange details:",e)}finally{A.value=!1}});let C=v("");function b(r){C.value=r,x.value=!0}async function yt(){bt(C.value),x.value=!1}const xt=async()=>{try{await u.rejectExchange(c.params.id,y.value),f.value=!1,y.value="",await u.fetchExchange(c.params.id),R()}catch(r){console.error("Failed to reject exchange request:",r),alert("Failed to reject exchange request.")}},k=()=>{f.value=!0},bt=async r=>{try{const{id:e}=c.params;r==="handover"&&await u.handoverAccept({id:e,note:m.value}),r==="inCharge"&&await u.inChargeAccept({id:e,note:m.value}),r==="recommend"&&await u.recommendByAccept({id:e,note:m.value}),r==="approve"&&await u.approvedByAccept({id:e,note:m.value}),confirm("Are you sure you want to approve?")&&(await u.fetchExchange(e),R())}catch(e){console.error(`Failed to accept ${r}:`,e),alert(`Failed to accept ${r}.`)}},ht=async r=>{const e=r.target.files[0];if(e){const _=new FormData;_.append("file",e);const d=await u.fetchFileUpload(_);j.value=d==null?void 0:d.url,d!=null&&d.url?(kt(),w.success("File uploaded successfully")):w.error("Failed to upload file")}},kt=async()=>{try{const r={attachment:j.value};await u.uploadAttachmentExchange(c.params.id,r)}catch(r){console.error("Failed to reject short leave:",r),alert("Failed to reject short leave.")}};function wt(){window.print()}const At=()=>ft.go(-1),jt=r=>new Date(r).toISOString().slice(0,10),Ct=r=>new Date(r).toLocaleDateString("en-US",{weekday:"long"});async function R(){await gt.markAsRead(c.query.notifyId)}return(r,e)=>{var _,d,D,E,F,N,S,B,$,V,M,q,U,I,L,T,W,H,P,z,O,G,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ie,ue,de,pe,ve,ce,me,_e,ge,fe,ye,xe,be,he,ke,we,Ae,je,Ce,Re,De,Ee,Fe,Ne,Se,Be,$e,Ve,Me,qe,Ue,Ie,Le,Te,We,He,Pe,ze,Oe,Ge,Je,Ke,Qe,Xe,Ye,Ze,et,tt,st,lt,at,nt,ot,rt,it,ut,dt,pt,vt;return n(),o(Vt,null,[t("div",Wt,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:At},e[8]||(e[8]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[10]||(e[10]=t("h1",{class:"title-lg text-center"},"Exchange Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:wt},e[9]||(e[9]=[t("i",{class:"far fa-print"},null,-1),a(" Print ")]))])]),A.value?(n(),St(Ut,{key:0})):(n(),o("div",Ht,[e[44]||(e[44]=t("div",null,[t("h1",{class:"title-lg text-center"},"Shift Exchange Application")],-1)),t("div",Pt,[t("div",null,"Date: "+l(jt((_=s.value)==null?void 0:_.created_at)),1)]),t("div",null,[t("p",zt,[e[11]||(e[11]=a(" Name: ")),t("b",null,l((D=(d=s.value)==null?void 0:d.user)==null?void 0:D.name),1)]),t("div",Ot,[t("p",null,[e[12]||(e[12]=a(" Designation: ")),t("b",null,l((N=(F=(E=s.value)==null?void 0:E.user)==null?void 0:F.designation)==null?void 0:N.title),1)])]),t("div",Gt,[t("p",null,[e[13]||(e[13]=a(" Department: ")),t("b",null,l(($=(B=(S=s.value)==null?void 0:S.user)==null?void 0:B.company)==null?void 0:$.name),1)])])]),t("div",Jt,[t("div",null,[e[14]||(e[14]=t("b",null,"Exchange Day:",-1)),a(" "+l(Ct((V=s.value)==null?void 0:V.exchange_date)),1)]),t("div",null,[e[15]||(e[15]=t("b",null,"Date:",-1)),a(" "+l((M=s.value)==null?void 0:M.exchange_date),1)]),t("div",null,[e[16]||(e[16]=t("b",null,"From:",-1)),a(" "+l((U=(q=s.value)==null?void 0:q.current_shift)==null?void 0:U.name),1)]),t("div",null,[e[17]||(e[17]=t("b",null,"To:",-1)),a(" "+l((L=(I=s.value)==null?void 0:I.shift)==null?void 0:L.name),1)]),t("div",Kt,[e[18]||(e[18]=t("b",null,"Reason:",-1)),a(" "+l(((T=s.value)==null?void 0:T.reason)||"N/A"),1)])]),t("div",Qt,[t("div",null,[t("div",null,[e[19]||(e[19]=t("b",null,"Works in Hand:",-1)),a(" "+l(((W=s.value)==null?void 0:W.works_in_hand)||"N/A"),1)])]),t("div",null,[t("p",null,l(((P=(H=s.value)==null?void 0:H.handover_user)==null?void 0:P.name)||"Not assigned"),1),!((z=s.value)!=null&&z.status)&&s.value.handover_user_id===h(g).user.id?(n(),o("div",Xt,[t("p",Yt,[a(l((G=(O=s.value)==null?void 0:O.user)==null?void 0:G.name)+" has assigned you for his handover.",1),e[20]||(e[20]=t("br",null,null,-1)),e[21]||(e[21]=a(" Do you agree? "))]),t("div",Zt,[t("button",{class:"font-bold text-lg text-green-600 px-2",onClick:e[0]||(e[0]=p=>b("handover"))}," ✔ "),e[22]||(e[22]=t("button",{class:"px-2"},"❌",-1))])])):i("",!0),e[25]||(e[25]=t("hr",{class:"w-44 border-black mt-2"},null,-1)),t("h4",es,[e[24]||(e[24]=a(" Handover ")),(J=s.value)!=null&&J.handover_user_id&&((K=s.value)!=null&&K.status)?(n(),o("span",ts," (✔) ")):i("",!0),(Q=s.value)!=null&&Q.handover_user_id&&!((X=s.value)!=null&&X.status)?(n(),o("span",ss,e[23]||(e[23]=[t("i",{class:"fad fa-spinner"},null,-1)]))):i("",!0)]),t("p",ls,l((Y=s.value)==null?void 0:Y.handover_note),1)])]),e[45]||(e[45]=t("hr",{class:"mt-2"},null,-1)),t("div",null,[t("h3",as,[e[26]||(e[26]=a(" Approvals ")),t("span",{class:Bt({"text-yellow-500":((Z=s.value)==null?void 0:Z.status)==="Pending","text-green-500":((ee=s.value)==null?void 0:ee.status)==="Approved","text-red-500":((te=s.value)==null?void 0:te.status)==="Rejected"})}," ("+l(((se=s.value)==null?void 0:se.status)||"N/A")+") ",3)]),((le=s.value)==null?void 0:le.status)==="Rejected"?(n(),o("div",ns,[t("div",null,[e[27]||(e[27]=t("b",null,"Rejected By:",-1)),a(" "+l(((ne=(ae=s.value)==null?void 0:ae.rejected_by_user)==null?void 0:ne.name)||"N/A"),1)]),t("div",null,[e[28]||(e[28]=t("b",null,"Rejection Reason:",-1)),a(" "+l(((oe=s.value)==null?void 0:oe.rejection_reason)||"N/A"),1)])])):i("",!0)]),t("div",os,[t("div",rs,[(re=s.value)!=null&&re.in_charge_user?(n(),o("p",is,l(((ue=(ie=s.value)==null?void 0:ie.in_charge_user)==null?void 0:ue.name)||""),1)):(n(),o("p",us,l(((ce=(ve=(pe=(de=s.value)==null?void 0:de.user)==null?void 0:pe.other_approval)==null?void 0:ve.in_charge_user)==null?void 0:ce.name)||""),1)),s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((me=s.value)!=null&&me.in_charge_user_id)&&((fe=(ge=(_e=s.value)==null?void 0:_e.user)==null?void 0:ge.other_approval)==null?void 0:fe.in_charge_user_id)===h(g).user.id?(n(),o("div",ds,[t("p",ps,[a(l((xe=(ye=s.value)==null?void 0:ye.user)==null?void 0:xe.name)+" has submitted an application. ",1),e[29]||(e[29]=t("br",null,null,-1)),e[30]||(e[30]=a(" Will you forward it? "))]),t("div",vs,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=p=>b("inCharge"))}," ✔ "),t("button",{class:"",onClick:k},"❌")])])):i("",!0),e[33]||(e[33]=t("hr",{class:"w-28 md:w-44 border-black mt-2"},null,-1)),t("p",cs,[e[32]||(e[32]=a(" In-Charge ")),(be=s.value)!=null&&be.in_charge_user_id?(n(),o("span",ms,"(✔)")):i("",!0),!((he=s.value)!=null&&he.in_charge_user_id)&&((Ae=(we=(ke=s.value)==null?void 0:ke.user)==null?void 0:we.other_approval)!=null&&Ae.in_charge_user)?(n(),o("span",_s,e[31]||(e[31]=[t("i",{class:"fad fa-spinner"},null,-1)]))):i("",!0)]),t("p",gs,l((je=s.value)==null?void 0:je.in_charge_note),1)]),t("div",fs,[(Ce=s.value)!=null&&Ce.recommend_by_user?(n(),o("p",ys,l(((De=(Re=s.value)==null?void 0:Re.recommend_by_user)==null?void 0:De.name)||""),1)):(n(),o("p",xs,l(((Se=(Ne=(Fe=(Ee=s.value)==null?void 0:Ee.user)==null?void 0:Fe.other_approval)==null?void 0:Ne.recommend_by_user)==null?void 0:Se.name)||"N/A"),1)),s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Be=s.value)!=null&&Be.recommend_by_user_id)&&((Me=(Ve=($e=s.value)==null?void 0:$e.user)==null?void 0:Ve.other_approval)==null?void 0:Me.recommend_by_user_id)===h(g).user.id?(n(),o("div",bs,[t("p",hs,[a(l((Ue=(qe=s.value)==null?void 0:qe.user)==null?void 0:Ue.name)+" has submitted an application.",1),e[34]||(e[34]=t("br",null,null,-1)),e[35]||(e[35]=a(" Will you recommend it? "))]),t("div",ks,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=p=>b("recommend"))}," ✔ "),t("button",{class:"",onClick:k},"❌")])])):i("",!0),e[38]||(e[38]=t("hr",{class:"w-28 md:w-44 border-black mt-2"},null,-1)),t("p",ws,[e[37]||(e[37]=a(" Recommend By ")),(Ie=s.value)!=null&&Ie.recommend_by_user_id?(n(),o("span",As,"(✔)")):i("",!0),!((Le=s.value)!=null&&Le.recommend_by_user_id)&&((He=(We=(Te=s.value)==null?void 0:Te.user)==null?void 0:We.other_approval)!=null&&He.recommend_by_user)?(n(),o("span",js,e[36]||(e[36]=[t("i",{class:"fad fa-spinner"},null,-1)]))):i("",!0)]),t("p",Cs,l((Pe=s.value)==null?void 0:Pe.recommend_note),1)]),t("div",Rs,[(ze=s.value)!=null&&ze.approved_by_user?(n(),o("p",Ds,l(((Ge=(Oe=s.value)==null?void 0:Oe.approved_by_user)==null?void 0:Ge.name)||""),1)):(n(),o("p",Es,l(((Xe=(Qe=(Ke=(Je=s.value)==null?void 0:Je.user)==null?void 0:Ke.other_approval)==null?void 0:Qe.approved_by_user)==null?void 0:Xe.name)||""),1)),s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Ye=s.value)!=null&&Ye.approved_by_user_id)&&((tt=(et=(Ze=s.value)==null?void 0:Ze.user)==null?void 0:et.other_approval)==null?void 0:tt.approved_by_user_id)===h(g).user.id?(n(),o("div",Fs,[t("p",Ns,[a(l((lt=(st=s.value)==null?void 0:st.user)==null?void 0:lt.name)+" has submitted an application.",1),e[39]||(e[39]=t("br",null,null,-1)),e[40]||(e[40]=a(" Will you accept it? "))]),t("div",Ss,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[3]||(e[3]=p=>b("approve"))}," ✔ "),t("button",{class:"",onClick:k},"❌")])])):i("",!0),e[43]||(e[43]=t("hr",{class:"w-44 border-black mt-2"},null,-1)),t("p",Bs,[e[42]||(e[42]=a(" Approved By ")),(at=s.value)!=null&&at.approved_by_user_id?(n(),o("span",$s,"(✔)")):i("",!0),!((nt=s.value)!=null&&nt.approved_by_user_id)&&((it=(rt=(ot=s.value)==null?void 0:ot.user)==null?void 0:rt.other_approval)!=null&&it.approved_by_user)?(n(),o("span",Vs,e[41]||(e[41]=[t("i",{class:"fad fa-spinner"},null,-1)]))):i("",!0)]),t("p",Ms,l((ut=s.value)==null?void 0:ut.approval_note),1)])])])),t("div",qs,[t("div",null,[e[46]||(e[46]=t("label",null,"Attachment",-1)),(dt=s.value)!=null&&dt.attachment&&typeof((pt=s.value)==null?void 0:pt.attachment)=="string"?(n(),o("div",Us,[t("a",{href:(vt=s.value)==null?void 0:vt.attachment,target:"_blank",class:"text-blue-500 underline"}," View Current File ",8,Is)])):i("",!0),t("input",{type:"file",onChange:ht,class:"w-full p-2 border rounded"},null,32),e[47]||(e[47]=t("p",{class:"text-sm text-gray-600 mt-1"},"Selected File",-1))])]),ct(Lt,null,{default:$t(()=>[ct(It,{targetId:"leave-application",platform:"whatsapp"})]),_:1})]),x.value?(n(),o("div",Ls,[t("div",Ts,[e[48]||(e[48]=t("h3",{class:"title-lg"},"Accept Application",-1)),mt(t("input",{"onUpdate:modelValue":e[4]||(e[4]=p=>m.value=p),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[_t,m.value]]),t("div",Ws,[t("button",{class:"btn-3",onClick:e[5]||(e[5]=p=>x.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:yt},"Confirm")])])])):i("",!0),f.value?(n(),o("div",Hs,[t("div",Ps,[e[49]||(e[49]=t("h3",{class:"title-lg"},"Reject Exchange Request",-1)),mt(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=p=>y.value=p),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[_t,y.value]]),t("div",zs,[t("button",{class:"btn-3",onClick:e[7]||(e[7]=p=>f.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:xt},"Confirm")])])])):i("",!0)],64)}}};export{Zs as default};
