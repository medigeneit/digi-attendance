import{m as V,c,o as d,g as f,x as W,d as et,n as it,p as M,a as o,t as h,f as E,j as S,i as I,w as $,k as g,F as z,L as K,r as T,e as q,J,A as ot,K as rt,M as ut,y as Y,X as ct,h as _,v as H}from"./index-D7WFQ8O_.js";import{_ as mt}from"./DepartmentChip-DJAWfSAu.js";import{_ as lt}from"./UserChip-BfL1c_L2.js";import{O as G}from"./OverlyModal-DOHkpFLY.js";import{g as A,b as at}from"./datetime-DcVwRp76.js";import{u as Z,a as st,f as yt,d as ft,b as vt}from"./useTodoStore-OA0f8GGk.js";import{L as X}from"./LoaderView-CANp5_lp.js";import{u as pt}from"./useTaskStore-B9KCI2Rg.js";const bt={key:0,class:"fa fa-exclamation-square",title:"Pending"},gt={key:1,class:"fa fa-pause",title:"Working"},kt={key:2,class:"fa fa-check-square",title:"Completed"},dt={__name:"TodoStatusIcon",props:{todoDate:{type:Object,required:!0}},setup(e){const D=e,n=V(()=>{switch(D.todoDate.status){case"PENDING":return"text-red-400";case"WORKING":return"text-yellow-600";case"COMPLETED":return"text-green-400"}return""});return(a,m)=>(d(),c("span",{class:W(n.value)},[e.todoDate.status=="PENDING"?(d(),c("i",bt)):f("",!0),e.todoDate.status=="WORKING"?(d(),c("i",gt)):f("",!0),e.todoDate.status=="COMPLETED"?(d(),c("i",kt)):f("",!0)],2))}},xt={class:""},wt={key:0,class:"mt-1 flex items-center gap-2"},Tt={key:0,class:"line-clamp-2 text-gray-500 whitespace-nowrap mr-2"},Dt={class:"md:ml-auto w-full md:w-auto flex items-center justify-center gap-2"},Ct={key:0,class:"flex items-center gap-1 text-red-600"},ge={__name:"TodoItemCard",props:{todoDate:{type:Object,required:!0},hideDepartment:{type:Boolean,default:!1},hideUser:{type:Boolean,default:!1},hideSortingBtn:{type:Boolean,default:!1},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickEdit","clickDelete","clickChangeStatus","clickDelete"],setup(e,{emit:D}){const n=et(),a=D;return(m,s)=>{var v,l,b,C,u,t,p;const i=it("RouterLink");return d(),c("div",{class:W(["px-4 py-4 md:py-2 cursor-pointer flex flex-wrap items-center gap-y-2 gap-x-4 text-sm",{"bg-green-100":e.todoDate.status=="COMPLETED","hover:bg-gray-50":e.todoDate.status!="COMPLETED"}]),onClick:s[4]||(s[4]=$(x=>a("clickTodo",e.todoDate),["prevent"]))},[M(dt,{todoDate:e.todoDate},null,8,["todoDate"]),o("div",xt,[o("div",{class:W(["line-clamp-1",{"text-green-800":e.todoDate.status=="COMPLETED","text-blue-800":e.todoDate.status!="COMPLETED"}])},h(e.todoDate.id)+" - "+h(e.todoDate.title),3),e.todoDate.user?(d(),c("div",wt,[e.hideUser?f("",!0):(d(),E(lt,{key:0,user:e.todoDate.user,"avatar-size":"xsmall"},null,8,["user"])),e.hideDepartment?f("",!0):(d(),E(mt,{key:1,department:(l=(v=e.todoDate)==null?void 0:v.user)==null?void 0:l.department},null,8,["department"]))])):f("",!0)]),(b=e.todoDate.todo)!=null&&b.todo_type&&((C=e.todoDate.todo)!=null&&C.todo_type_id)?(d(),c("div",Tt,[S(h((u=e.todoDate.todo)==null?void 0:u.todo_type)+" ",1),M(i,{class:"text-blue-600 font-semibold underline hover:text-sky-400",onClick:$(x=>null,["stop"]),to:{name:e.userRole=="employee"?"MyTaskShow":"TaskShow",params:{id:(t=e.todoDate.todo)==null?void 0:t.todo_type_id}}},{default:I(()=>{var x;return[s[5]||(s[5]=o("i",{class:"fas fa-link"},null,-1)),S(" "+h((x=e.todoDate.todo)==null?void 0:x.todo_type_id),1)]}),_:1,__:[5]},8,["to"])])):f("",!0),o("div",Dt,[e.todoDate.status=="WORKING"?(d(),c("div",Ct,s[6]||(s[6]=[o("span",{class:"fas fa-circle animate-pulse text-xs"},null,-1),o("span",{class:"text-xs"},"Working",-1)]))):f("",!0),e.todoDate.user_id===((p=g(n).user)==null?void 0:p.id)?(d(),c(z,{key:1},[e.todoDate.status==="WORKING"?(d(),c("button",{key:0,title:"Mark as Completed",class:"btn-icon bg-transparent text-green-400 border-green-400 border hover:bg-green-400 hover:text-white",onClick:s[0]||(s[0]=$(()=>a("clickChangeStatus",e.todoDate,"COMPLETED"),["prevent","stop"]))},s[7]||(s[7]=[o("i",{class:"fas fa-check"},null,-1)]))):f("",!0),e.todoDate.status==="PENDING"?(d(),c("button",{key:1,title:"Start Working",class:"btn-icon bg-transparent text-red-400 border-red-400 border hover:bg-red-400 hover:text-white",onClick:s[1]||(s[1]=$(()=>a("clickChangeStatus",e.todoDate,"WORKING"),["prevent","stop"]))},s[8]||(s[8]=[o("i",{class:"fas fa-play ml-[4px]"},null,-1)]))):f("",!0),o("button",{class:"btn-icon bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:s[2]||(s[2]=$(x=>{var w;return a("clickEdit",(w=e.todoDate)==null?void 0:w.todo)},["prevent","stop"]))},s[9]||(s[9]=[o("i",{class:"fas fa-pen"},null,-1)])),o("button",{class:"btn-icon bg-red-400 text-white hover:bg-red-600 hover:text-white",onClick:s[3]||(s[3]=$(()=>a("clickDelete",e.todoDate),["prevent","stop"]))},s[10]||(s[10]=[o("i",{class:"fas fa-trash-alt"},null,-1)]))],64)):f("",!0),e.hideSortingBtn?f("",!0):(d(),c("button",{key:2,onClick:$(()=>null,["stop","prevent"]),class:"btn-icon bg-gray-400 text-white hover:bg-gray-600 hover:text-white handle"},s[11]||(s[11]=[o("i",{class:"fas fa-arrows-alt-v"},null,-1)])))])],2)}}},ht={class:"bg-white border-t px-4 py-4 sticky bottom-0 rounded-b-md"},St={key:0,class:"mb-4 text-red-500 font-medium"},$t={key:0,class:"mb-4 text-blue-500 font-medium"},Et={class:"flex justify-between items-center gap-4"},It=["disabled"],tt={__name:"FormHandler",props:{isSubmitting:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["submit","clickCancel"],setup(e,{emit:D}){const n=D;return(a,m)=>(d(),c("form",{onSubmit:m[1]||(m[1]=$(s=>n("submit"),["prevent"]))},[K(a.$slots,"default"),o("div",ht,[K(a.$slots,"error",{},()=>[e.error?(d(),c("div",St,h(e.error),1)):f("",!0)]),e.isSubmitting?(d(),c("div",$t,"Saving changes...")):f("",!0),K(a.$slots,"footer",{},()=>[o("div",Et,[o("button",{type:"button",onClick:m[0]||(m[0]=s=>n("clickCancel")),class:"btn-3"},"Cancel"),o("button",{disabled:e.isSubmitting||e.isLoading,type:"submit",class:"btn-2"},h(e.isSubmitting?"Saving...":"Save"),9,It)])])])],32))}},Rt={class:"px-2 border-b py-3 over text-sm relative"},Mt={class:"flex items-center py-1"},Q={__name:"TodoInputTaskItem",props:{task:Object,level:Number,selected:Number},emits:["select"],setup(e,{emit:D}){const n=D;return(a,m)=>{var s,i,v;return d(),c("div",Rt,[o("div",Mt,[o("div",{class:W(["line-clamp-2 mr-4 ",{"text-red-50 bg-green-800 px-2":e.task.id==e.selected},{"hover:text-blue-500":e.task.id!=e.selected}])},h(e.task.id)+" - "+h(e.task.title),3),o("button",{class:"border btn-2 ml-auto",onClick:m[0]||(m[0]=$(()=>n("select",e.task),["prevent"]))}," Select ")]),(i=(s=e.task)==null?void 0:s.children_tasks)!=null&&i.length?K(a.$slots,"children",{key:0,childrenTasks:(v=e.task)==null?void 0:v.children_tasks,level:e.level+1}):f("",!0)])}}},Ot={class:"border"},Lt={class:"border ml-4 mt-4"},Nt={class:"border ml-4 mt-4"},nt={__name:"TodoTypeInput",props:{todoType:{type:String,default:"task"},todoTypeId:{type:[String,Number],default:null},show:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["update:todoType","update:todoTypeId","update:show"],setup(e,{emit:D}){const n=e,a=D,m=V({get:()=>n.todoTypeId,set:t=>a("update:todoTypeId",t)}),s=V({get:()=>n.show,set:t=>a("update:show",t)}),i=T(null),v=T({});function l(){if(!(i!=null&&i.value))return;const t=i.value.getBoundingClientRect(),p=window.innerHeight,x=300,O=p-t.bottom<x;v.value={position:"fixed",top:O?t.top-x+"px":t.bottom+"px",left:t.left+"px",width:t.width+"px",zIndex:5e3}}function b(t){m.value=t.id,s.value=!1}function C(t){m.value="",s.value=!1}q(async()=>{await J(),window.addEventListener("resize",l),document.addEventListener("scroll",l)});const u=pt();return ot(()=>s.value,async t=>{t&&await u.fetchMyTasks()}),rt(()=>{window.removeEventListener("resize",l),document.removeEventListener("scroll",l)}),(t,p)=>(d(),c("div",{class:"relative",ref_key:"anchor",ref:i},[o("div",{class:W(["w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 cursor-pointer flex items-center shadow-sm",m.value?"":"text-gray-400"]),onClick:p[0]||(p[0]=$(()=>{e.readonly||(s.value=!0,l())},["stop"]))},[S(h(m.value||"Click to select todo")+" ",1),m.value&&!e.readonly?(d(),c("button",{key:0,class:"btn-icon fas fa-times !size-8 text-sm ml-auto",onClick:$(C,["prevent","stop"])})):f("",!0)],2),(d(),E(ct,{to:"body"},[s.value?(d(),c("div",{key:0,style:ut(v.value),class:"fixed h-[300px] bg-white rounded-b-md overflow-y-auto shadow-lg border z-[5000] p-4"},[o("div",Ot,[(d(!0),c(z,null,Y(g(u).tasks,x=>(d(),E(Q,{key:x.id,task:x,onSelect:b,selected:m.value,class:"group/main"},{children:I(({childrenTasks:w})=>[o("div",Lt,[(d(!0),c(z,null,Y(w,O=>(d(),E(Q,{key:O.id,task:O,onSelect:b,selected:m.value},{children:I(({childrenTasks:j})=>[o("div",Nt,[(d(!0),c(z,null,Y(j,N=>(d(),E(Q,{key:N.id,task:N,onSelect:b,selected:m.value},null,8,["task","selected"]))),128))])]),_:2},1032,["task","selected"]))),128))])]),_:2},1032,["task","selected"]))),128))])],4)):f("",!0)]))],512))}},Ut={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},Vt={class:"mb-2"},jt={class:"mb-4"},Bt={class:"mb-4"},Pt=["readonly"],zt={class:"mb-4"},At={__name:"TodoAddForm",props:{date:{type:String,default:A(new Date)},userRole:{type:String,default:"employee"},todoType:{type:String,default:null},todoTypeId:{type:String,default:null},readonlyValues:{type:Object,default:()=>({date:!1,todo_type_id:!1})}},emits:["update","cancelClick"],setup(e,{emit:D}){const n=e,a=T(),m=T(!1),s=T(),i=Z(),v=D,l=T({title:"",date:n.date||"",todo_type:"",todo_type_id:""});async function b(){var u;try{a.value="submitting",(u=l.value)!=null&&u.todo_type_id||(l.value={title:l.value.title,date:l.value.date}),await i.createTodo(l.value,{returnWith:n.userRole!=="employee"?"user,department,company":""}),v("update")}finally{a.value=""}}ot(()=>({date:n.date,todo_type:n.todoType,todo_type_id:n.todoTypeId}),u=>{l.value=u},{immediate:!0});const C=V(()=>new Date(n.date));return q(async()=>{var u;await J(),(u=s.value)==null||u.focus()}),(u,t)=>(d(),c("div",{onClick:t[6]||(t[6]=p=>m.value=!1)},[g(i).loading?(d(),E(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:I(()=>t[7]||(t[7]=[S(" Loading... ")])),_:1,__:[7]})):f("",!0),M(tt,{onSubmit:b,onClickCancel:t[5]||(t[5]=p=>v("cancelClick")),isSubmitting:a.value=="submitting",error:g(i).error,class:"rounded-md relative"},{default:I(()=>{var p,x;return[t[12]||(t[12]=o("div",{class:"border-b py-2 px-4"},[o("h2",{class:"text-xl font-semibold"},"Add Todo")],-1)),o("div",Ut,[o("div",Vt,[t[8]||(t[8]=o("span",{class:"font-semibold"}," Date ",-1)),o("span",null,h(g(at)(C.value,{weekDay:"long"})),1)]),o("div",jt,[t[9]||(t[9]=o("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),_(o("input",{ref_key:"titleRef",ref:s,"onUpdate:modelValue":t[0]||(t[0]=w=>l.value.title=w),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[H,l.value.title]])]),o("div",Bt,[t[10]||(t[10]=o("label",{class:"block text-gray-700 font-medium mb-2"},"Date",-1)),_(o("input",{readonly:(p=e.readonlyValues)==null?void 0:p.date,"onUpdate:modelValue":t[1]||(t[1]=w=>l.value.date=w),type:"date",required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,8,Pt),[[H,l.value.date]])]),o("div",zt,[t[11]||(t[11]=o("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),M(nt,{show:m.value,"onUpdate:show":t[2]||(t[2]=w=>m.value=w),todoType:l.value.todo_type,"onUpdate:todoType":t[3]||(t[3]=w=>l.value.todo_type=w),todoTypeId:l.value.todo_type_id,"onUpdate:todoTypeId":t[4]||(t[4]=w=>l.value.todo_type_id=w),readonly:(x=e.readonlyValues)==null?void 0:x.todo_type_id},null,8,["show","todoType","todoTypeId","readonly"])])])]}),_:1,__:[12]},8,["isSubmitting","error"])]))}},Wt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},qt={class:"mb-4 text-md"},Ft={class:"font-semibold"},Gt={class:"mb-2"},Kt={__name:"TodoDateAddForm",props:{date:{type:[String,Number],default:A(new Date)},todoId:{type:[String,Number],required:!0},userRole:{type:String,default:"employee"}},emits:["update","cancelClick"],setup(e,{emit:D}){const n=e,a=T(),m=T(!1),s=T(),i=Z(),v=st(),l=D,b=T({date:n.date||"",todo_id:n.todoId});async function C(){try{a.value="submitting",await v.createTodoDate(b.value),l("update")}finally{a.value=""}}return q(async()=>{var u;await J(),await i.fetchTodo(n.todoId),(u=s.value)==null||u.focus()}),(u,t)=>(d(),c("div",{onClick:t[2]||(t[2]=p=>m.value=!1)},[g(i).loading?(d(),E(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:I(()=>t[3]||(t[3]=[S(" Loading... ")])),_:1,__:[3]})):f("",!0),M(tt,{onSubmit:C,onClickCancel:t[1]||(t[1]=p=>l("cancelClick")),isSubmitting:a.value=="submitting",error:g(v).error,class:"rounded-md relative"},{default:I(()=>{var p;return[t[6]||(t[6]=o("div",{class:"border-b py-2 px-4"},[o("h2",{class:"text-xl font-semibold"},"Carry Todo To Date")],-1)),o("div",Wt,[o("div",qt,[t[4]||(t[4]=S(" TODO: ")),o("span",Ft,h((p=g(i).todo)==null?void 0:p.title),1)]),o("div",Gt,[t[5]||(t[5]=o("span",{class:"font-semibold"}," Date ",-1)),_(o("input",{"onUpdate:modelValue":t[0]||(t[0]=x=>b.value.date=x),type:"date",multiple:"",required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[H,b.value.date]])])])]}),_:1,__:[6]},8,["isSubmitting","error"])]))}},_t={key:0,class:"mb-4 text-red-500 font-medium"},Ht={key:1,class:"mb-4 text-red-500 font-medium"},Jt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},Xt={class:"mb-4"},Yt={class:"mb-4"},Qt={__name:"TodoEditForm",props:{date:{type:String,default:A(new Date)},todo:{type:Object,default:()=>({})}},emits:["update","cancelClick"],setup(e,{emit:D}){var L;const n=e,a=T(),m=T(!1),s=T(),i=Z(),v=D,l=T({title:"",todo_type:"task",todo_type_id:""}),b=T({id:null,repeat_type:"daily",start_date:((L=n.todo)==null?void 0:L.date)||n.date||A(new Date),end_date:null,weekly_day:null,monthly_mode:null,monthly_value:null,monthly_week:null,yearly_month:null,yearly_day:null}),C=T(!1),u=T({});async function t(){var k,r,y;await i.fetchTodo((k=n.todo)==null?void 0:k.id),l.value.title=(r=i.todo)==null?void 0:r.title,l.value.todo_type_id=(y=i.todo)==null?void 0:y.todoable_id}const p=T(null);async function x(){var k,r;try{const{data:y}=await yt(n.todo.id),R=y==null?void 0:y.setting;R?(C.value=!0,p.value=R.id,b.value={repeat_type:R.repeat_type??"daily",start_date:R.start_date??b.value.start_date,end_date:R.end_date??null,weekly_day:R.weekly_day??null,monthly_mode:R.monthly_mode??null,monthly_value:R.monthly_value??null,monthly_week:R.monthly_week??null,yearly_month:R.yearly_month??null,yearly_day:R.yearly_day??null}):b.value.id=null}catch(y){U.value=(r=(k=y==null?void 0:y.response)==null?void 0:k.data)==null?void 0:r.message,console.error("Load setting failed:",(y==null?void 0:y.message)||y)}}async function w(){await i.updateTodo(n.todo.id,{title:l.value.title,todo_type:l.value.todo_type,todo_type_id:l.value.todo_type_id})}async function O(){var k,r;if(!C.value)p.value&&await ft(n.todo.id,p.value);else{const y=(k=u.value)!=null&&k.buildPayload?u.value.buildPayload():{...b.value};y.start_date||(y.start_date=((r=n.todo)==null?void 0:r.date)||n.date||A(new Date)),await vt(n.todo.id,y)}}const j=k=>{var r,y;return((y=(r=k==null?void 0:k.response)==null?void 0:r.data)==null?void 0:y.message)||(k==null?void 0:k.message)||"Something went wrong"};async function N(){const[k,r]=await Promise.allSettled([w(),O()]),y=k.status==="fulfilled",R=r.status==="fulfilled";R||(U.value=j(r.reason)),y&&R&&v("update")}const B=T(!1),U=T(!1);async function F(){var k;await t(),B.value=!0,await x(),B.value=!1,await J(),(k=s.value)==null||k.focus()}const P=V(()=>i.loading||B.value);return q(()=>{F()}),(k,r)=>(d(),c("div",{class:"relative",onClick:r[5]||(r[5]=y=>m.value=!1)},[P.value?(d(),E(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:I(()=>r[6]||(r[6]=[S(" Loading... ")])),_:1,__:[6]})):f("",!0),M(tt,{onSubmit:N,onClickCancel:r[4]||(r[4]=y=>v("cancelClick")),isSubmitting:a.value=="submitting",isLoading:P.value,id:"todoEditForm"},{error:I(()=>[o("div",null,[g(i).error?(d(),c("div",_t,h(g(i).error),1)):f("",!0),U.value?(d(),c("div",Ht,h(U.value),1)):f("",!0)])]),default:I(()=>[r[10]||(r[10]=o("div",{class:"border-b py-2 px-4"},[o("h2",{class:"text-xl font-semibold"},"Edit Todo")],-1)),o("div",Jt,[r[9]||(r[9]=o("div",{class:"text-xs text-red-800 mb-6"},[o("strong",null,"Tips:"),S(" If you change the todo, it will change to all the concurrent dates ")],-1)),o("div",Xt,[r[7]||(r[7]=o("label",{class:"block text-gray-500 font-medium text-sm"},"Title",-1)),_(o("input",{ref_key:"titleRef",ref:s,"onUpdate:modelValue":r[0]||(r[0]=y=>l.value.title=y),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 shadow-sm"},null,512),[[H,l.value.title]])]),o("div",Yt,[r[8]||(r[8]=o("label",{class:"block text-gray-500 font-medium text-sm"},"Task ID (optional)",-1)),M(nt,{show:m.value,"onUpdate:show":r[1]||(r[1]=y=>m.value=y),todoType:l.value.todo_type,"onUpdate:todoType":r[2]||(r[2]=y=>l.value.todo_type=y),todoTypeId:l.value.todo_type_id,"onUpdate:todoTypeId":r[3]||(r[3]=y=>l.value.todo_type_id=y)},null,8,["show","todoType","todoTypeId"])])])]),_:1,__:[10]},8,["isSubmitting","isLoading"])]))}},Zt={class:"relative"},te={class:"min-h-[10vh] max-h-[50vh] overflow-y-auto p-4"},ee={class:"mb-4"},oe={class:"mb-4 flex justify-between items-end"},le={key:0,class:"mt-1 flex items-center gap-2 mb-4"},ae={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},se={class:"flex items-center justify-between gap-4"},de={key:0,class:"flex items-center gap-2"},ne={class:"flex justify-between items-center gap-4 py-4 px-4 border-t"},ie={key:0,class:"ml-auto flex items-center gap-2"},re={__name:"TodoShow",props:{todoDate:{type:Object,default:()=>{}}},emits:["cancelClick","clickEdit","update","clickAddTodoDate"],setup(e,{emit:D}){const n=e,a=st(),m=et(),s=D;async function i(){var u;console.log({todo_date:"dd"}),await a.fetchTodoDate((u=n.todoDate)==null?void 0:u.id)}const v=V(()=>{var u,t;return(u=a.todo_date)!=null&&u.date?new Date((t=a.todo_date)==null?void 0:t.date):null}),l=V(()=>{var u,t,p;return((t=(u=a.todo_date)==null?void 0:u.user)==null?void 0:t.id)===((p=m.user)==null?void 0:p.id)});async function b(u){var t;confirm(`Are your sure want to delete todo
'${(t=a.todo_date)==null?void 0:t.title}'`)&&(await a.deleteTodoDate(u.id),s("update"))}async function C(u,t){var p;confirm(`Are your sure want to compete todo
'${(p=a.todo_date)==null?void 0:p.title}'`)&&(await a.updateStatus(u.id,t),s("update"))}return q(async()=>{await i()}),(u,t)=>{var p,x,w,O,j,N,B,U,F;return d(),c("div",Zt,[g(a).loading?(d(),E(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:I(()=>t[6]||(t[6]=[S(" Loading... ")])),_:1,__:[6]})):f("",!0),o("div",null,[t[13]||(t[13]=o("div",{class:"border-b py-2 px-4"},[o("h2",{class:"text-xl font-semibold"},"Show Todo")],-1)),o("div",te,[o("div",ee,[t[7]||(t[7]=o("div",{class:"font-semibold text-xs text-gray-500"},"Date",-1)),o("span",null,h(g(at)(v.value,{weekDay:"long"})),1)]),o("div",oe,[o("div",null,[t[8]||(t[8]=o("div",{class:"text-xs text-gray-500"},"Todo",-1)),S(" "+h((p=g(a).todo_date)==null?void 0:p.title),1)]),o("button",{class:"btn-2 bg-sky-400 text-white hover:bg-sky-600 hover:text-white bg-none",onClick:t[0]||(t[0]=$(P=>{var L;return s("clickEdit",(L=g(a).todo_date)==null?void 0:L.todo)},["prevent","stop"]))},t[9]||(t[9]=[o("i",{class:"fas fa-pen"},null,-1),S(" Edit Todo ")]))]),(x=e.todoDate)!=null&&x.user?(d(),c("div",le,[M(lt,{user:e.todoDate.user,"avatar-size":"xsmall"},null,8,["user"]),o("div",ae,h((O=(w=e.todoDate.user)==null?void 0:w.department)==null?void 0:O.name),1)])):f("",!0),o("div",null,[t[12]||(t[12]=o("div",{class:"text-xs text-gray-500"},"Status",-1)),o("div",se,[o("div",null,[(j=g(a))!=null&&j.todo_date?(d(),E(dt,{key:0,todoDate:(N=g(a))==null?void 0:N.todo_date},null,8,["todoDate"])):f("",!0),S(" "+h((B=g(a).todo_date)==null?void 0:B.status),1)]),l.value&&!g(a).loading?(d(),c("div",de,[((U=g(a).todo_date)==null?void 0:U.status)==="PENDING"?(d(),c("button",{key:0,class:"btn-2 from-yellow-700 to-yellow-500 text-white hover:bg-green-600 hover:text-white",onClick:t[1]||(t[1]=$(()=>C(g(a).todo_date,"WORKING"),["prevent","stop"]))},t[10]||(t[10]=[o("i",{class:"fas fa-exclamation-circle"},null,-1),S(" Change to Working ")]))):f("",!0),((F=g(a).todo_date)==null?void 0:F.status)==="WORKING"?(d(),c("button",{key:1,class:"btn-2 from-green-700 to-green-300 text-white hover:bg-green-600 hover:text-white",onClick:t[2]||(t[2]=$(()=>C(g(a).todo_date,"COMPLETED"),["prevent","stop"]))},t[11]||(t[11]=[o("i",{class:"fas fa-check"},null,-1),S(" Make Complete ")]))):f("",!0)])):f("",!0)])])])]),o("div",ne,[o("button",{type:"button",onClick:t[3]||(t[3]=P=>s("cancelClick")),class:"btn-3"},"Cancel"),l.value&&!g(a).loading?(d(),c("div",ie,[o("button",{class:"btn-2 bg-green-600 text-white hover:bg-green-700 hover:text-white bg-none",onClick:t[4]||(t[4]=$(P=>{var L,k;return s("clickAddTodoDate",(L=g(a).todo_date)==null?void 0:L.todo_id,(k=g(a).todo_date)==null?void 0:k.date)},["prevent","stop"]))},t[14]||(t[14]=[o("i",{class:"fas fa-plus"},null,-1),S(" Add To another date ")])),o("button",{class:"btn-2-red",onClick:t[5]||(t[5]=$(()=>b(g(a).todo_date),["prevent","stop"]))},t[15]||(t[15]=[o("i",{class:"fas fa-trash-alt"},null,-1),S(" Delete ")]))])):f("",!0)])])}}},ke={__name:"TodoCreateEditShow",props:{todoModal:{type:Object,required:!0},userRole:{type:String,required:"employee"}},emits:["cancelClick","todoUpdate","todoDateUpdate","clickEdit","clickDelete","clickChangeStatus","clickAddTodoDate"],setup(e,{emit:D}){const n=D;function a(){n("todoUpdate")}function m(){n("todoDateUpdate")}return(s,i)=>(d(),c(z,null,[e.todoModal.action=="add"?(d(),E(G,{key:0},{default:I(()=>{var v,l,b,C;return[M(At,{onCancelClick:i[0]||(i[0]=u=>n("cancelClick")),onUpdate:a,date:(v=e.todoModal)==null?void 0:v.date,todoType:(l=e.todoModal)==null?void 0:l.todoType,todoTypeId:(b=e.todoModal)==null?void 0:b.todoTypeId,readonlyValues:((C=e.todoModal)==null?void 0:C.formReadonlyValues)||{},userRole:e.userRole},null,8,["date","todoType","todoTypeId","readonlyValues","userRole"])]}),_:1})):f("",!0),e.todoModal.action=="addDate"?(d(),E(G,{key:1},{default:I(()=>{var v,l,b;return[M(Kt,{onCancelClick:i[1]||(i[1]=C=>n("cancelClick")),onUpdate:m,date:(v=e.todoModal)==null?void 0:v.date,todoId:(l=e.todoModal)==null?void 0:l.todo_id,userRole:e.userRole,readonlyValues:((b=e.todoModal)==null?void 0:b.formReadonlyValues)||{}},null,8,["date","todoId","userRole","readonlyValues"])]}),_:1})):f("",!0),e.todoModal.action=="edit"?(d(),E(G,{key:2},{default:I(()=>{var v,l;return[M(Qt,{onCancelClick:i[2]||(i[2]=b=>n("cancelClick")),onUpdate:a,todo:(v=e.todoModal)==null?void 0:v.todo,userRole:e.userRole,readonlyValues:((l=e.todoModal)==null?void 0:l.formReadonlyValues)||{}},null,8,["todo","userRole","readonlyValues"])]}),_:1})):f("",!0),e.todoModal.action=="show"?(d(),E(G,{key:3},{default:I(()=>{var v;return[M(re,{onCancelClick:i[3]||(i[3]=l=>n("cancelClick")),onUpdate:m,onClickEdit:i[4]||(i[4]=l=>n("clickEdit",l)),onClickAddTodoDate:i[5]||(i[5]=(...l)=>n("clickAddTodoDate",...l)),onClickDelete:i[6]||(i[6]=l=>n("clickDelete",l)),onClickChangeStatus:i[7]||(i[7]=(l,b)=>n("clickChangeStatus",l,b)),todoDate:(v=e.todoModal)==null?void 0:v.todo,userRole:e.userRole},null,8,["todoDate","userRole"])]}),_:1})):f("",!0)],64))}};export{ge as _,ke as a,dt as b};
