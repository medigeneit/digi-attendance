import{x as u,c as o,o as a,a as e,j as _,t as n,F as C,e as M,f as Bt,g as Kt,r as F,q as ye,d as zt,i as we,m as Z,b as H,s as xt,O as he,n as Ot,k as _e,v as ke,l as Vt,z as qt,T as Ut}from"./index-DQ_eI-jS.js";import{u as Yt}from"./kpi-DMK7SA_W.js";const Wt={class:"border rounded-2xl bg-white shadow-sm overflow-hidden"},Jt={class:"flex items-center justify-between border-b bg-slate-50 px-4 py-2.5"},Xt={class:"text-sm font-semibold text-slate-800"},Zt={key:0,class:"text-xs text-slate-500"},es={key:1,class:"flex items-center gap-2"},ts={class:"inline-flex items-center rounded-xl border bg-white p-1 shadow-sm"},ss=["disabled"],ls=["disabled"],as=["disabled"],ns={class:"overflow-auto"},os={key:0,class:"min-w-[980px] w-full text-sm"},is={class:"bg-slate-50 sticky top-0 z-10"},rs={class:"text-slate-700"},ds={class:"text-left px-3 py-2 w-[20%] font-medium"},us={class:"font-medium"},cs={class:"text-[11px] text-slate-500 flex flex-col items-center"},xs={key:0,class:"mt-0.5 inline-flex items-center gap-1 rounded-full bg-blue-50 px-2 py-0.5 text-[10px] font-semibold text-blue-700 border border-blue-200"},ms={class:"bg-slate-100/80 border-t"},vs=["colspan"],bs={class:"px-3 py-2 text-center text-slate-500"},fs={class:"px-3 py-2 align-top"},ps={class:"font-medium text-slate-800"},gs={class:"mt-1"},ys={class:"inline-flex items-center rounded-lg border bg-white p-0.5 shadow-sm opacity-0 group-hover:opacity-100 transition"},hs=["disabled","onClick"],_s=["disabled","onClick"],ks=["disabled","onClick"],ws=["disabled","onClick"],$s=["disabled","onClick"],Fs={class:"px-3 py-2 text-center text-slate-700"},Ns={key:0,class:"flex items-center justify-center"},Cs=["max","value","onInput","onBlur"],Ss={key:1,class:"text-slate-700 text-sm"},Ls={key:2,class:"text-slate-300 text-sm"},Ms={class:"bg-slate-50 border-t"},As={class:"px-3 py-2 text-center font-semibold text-slate-800"},Es=["colspan"],Ts={class:"font-semibold text-slate-900"},js={class:"text-slate-500"},Gs={key:1,class:"w-full text-sm"},Rs={class:"sticky top-0 bg-white z-10"},Ps={class:"bg-slate-100 text-slate-700"},Hs={class:"text-left px-3 py-2 w-[30%] font-medium"},Is={class:"px-3 py-2 text-center text-slate-500"},Ds={class:"px-3 py-2"},Qs={class:"font-medium text-slate-800"},Bs={class:"px-3 py-2 text-center text-slate-700"},Ks={class:"px-3 py-2 text-center"},zs=["max","value","onInput","onBlur"],Os={key:1,class:"text-slate-700 text-sm"},Vs={class:"bg-slate-50 border-t"},qs={class:"px-3 py-2 text-center font-semibold text-slate-800"},Us={class:"px-3 py-2 text-center text-sm"},mt={__name:"KpiGroupTable",props:{group:{type:Object,required:!0},isPersonal:{type:Boolean,default:!1},lanes:{type:Array,default:()=>[]},editableLaneKey:{type:String,default:null},canEdit:{type:Boolean,default:!1},marks:{type:Object,default:()=>({})},headerLabel:{type:String,default:""},itemLabel:{type:String,default:"Item"},helperText:{type:String,default:""},showQuickFillGroup:{type:Boolean,default:!1},autoFillLabel:{type:String,default:""},autoFillVisible:{type:Boolean,default:!1},onAutoFill:{type:Function,default:null},serialMap:{type:Object,default:()=>({})},getLaneMark:{type:Function,default:()=>""},getHrMark:{type:Function,default:()=>""},onMarkChange:{type:Function,default:null},onCap:{type:Function,default:null},onQuickFillItem:{type:Function,default:null},onQuickFillGroup:{type:Function,default:null}},setup(i){const N=i,w=u(()=>{var f;return((f=N.group)==null?void 0:f.items)??[]}),I=u(()=>w.value.reduce((f,d)=>f+Number((d==null?void 0:d.max)||0),0)),y=u(()=>w.value.reduce((f,d)=>{var $;const r=($=N.marks)==null?void 0:$[d.id],h=r===""||r==null?0:Number(r);return f+Math.min(Math.max(h||0,0),Number((d==null?void 0:d.max)||0))},0)),j=(f,d)=>{var r;return((r=N.serialMap)==null?void 0:r[f.id])??d+1},D=f=>(f==null?void 0:f.key)===N.editableLaneKey&&(f==null?void 0:f.can_current_user_review),Q=(f,d)=>{var h;const r=d===""?"":Number(d);d!==""&&Number.isNaN(r)||(h=N.onMarkChange)==null||h.call(N,f,r)},B=(f,d)=>{var r;return(r=N.onCap)==null?void 0:r.call(N,f,d)};return(f,d)=>(a(),o("section",Wt,[e("div",Jt,[e("div",Xt,n(i.headerLabel),1),i.helperText?(a(),o("div",Zt,n(i.helperText),1)):i.showQuickFillGroup?(a(),o("div",es,[d[4]||(d[4]=e("span",{class:"text-xs font-medium text-slate-500"},"Quick fill",-1)),e("div",ts,[e("button",{type:"button",class:"px-3 py-1.5 text-xs font-semibold rounded-lg text-slate-700 hover:bg-slate-100 active:scale-[0.98] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-200 disabled:opacity-40",onClick:d[0]||(d[0]=r=>{var h;return(h=i.onQuickFillGroup)==null?void 0:h.call(i,i.group,"half")}),disabled:!i.canEdit,title:"Fill all items with 50%"}," All 1/2 ",8,ss),e("button",{type:"button",class:"px-3 py-1.5 text-xs font-semibold rounded-lg text-slate-700 hover:bg-slate-100 active:scale-[0.98] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-200 disabled:opacity-40",onClick:d[1]||(d[1]=r=>{var h;return(h=i.onQuickFillGroup)==null?void 0:h.call(i,i.group,"threeQuarter")}),disabled:!i.canEdit,title:"Fill all items with 75%"}," All 3/4 ",8,ls),e("button",{type:"button",class:"px-3 py-1.5 text-xs font-semibold rounded-lg bg-slate-900 text-white hover:bg-slate-800 active:scale-[0.98] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-300 disabled:opacity-40",onClick:d[2]||(d[2]=r=>{var h;return(h=i.onQuickFillGroup)==null?void 0:h.call(i,i.group,"full")}),disabled:!i.canEdit,title:"Fill all items with 100%"}," All Full ",8,as)]),i.autoFillVisible?(a(),o("button",{key:0,type:"button",class:"rounded-full border border-slate-300 bg-white px-2.5 py-1 text-[10px] font-semibold text-slate-600 hover:border-slate-400 hover:text-slate-800",onClick:d[3]||(d[3]=r=>{var h;return(h=i.onAutoFill)==null?void 0:h.call(i)})},n(i.autoFillLabel),1)):_("",!0)])):_("",!0)]),e("div",ns,[i.isPersonal?(a(),o("table",os,[e("thead",is,[e("tr",rs,[d[5]||(d[5]=e("th",{class:"px-3 py-2 w-[40px] text-center font-medium"},"#",-1)),e("th",ds,n(i.itemLabel),1),d[6]||(d[6]=e("th",{class:"px-3 py-2 text-center font-medium"},"Max",-1)),(a(!0),o(C,null,M(i.lanes,r=>(a(),o("th",{key:r.key,class:"px-3 py-2 text-center font-medium"},[e("div",us,n(r.label||r.key),1),e("div",cs,[e("span",null,n(r.assigned_user_name||"-"),1),D(r)?(a(),o("span",xs," ✎ You can edit ")):_("",!0)])]))),128))])]),e("tbody",null,[e("tr",ms,[e("td",{colspan:3+i.lanes.length,class:"px-3 py-2 font-medium text-slate-800"},n(i.group.label||"Personal"),9,vs)]),(a(!0),o(C,null,M(w.value,(r,h)=>(a(),o("tr",{key:r.id,class:"border-t hover:bg-slate-50/60 group"},[e("td",bs,n(j(r,h)),1),e("td",fs,[e("div",ps,n(r.label),1),e("div",gs,[e("div",ys,[e("button",{type:"button",class:"px-2 py-1 text-[11px] font-semibold rounded-md text-slate-700 hover:bg-slate-100 active:scale-[0.98] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-200 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!i.canEdit,onClick:$=>{var k;return i.canEdit&&((k=i.onQuickFillItem)==null?void 0:k.call(i,r.id,r.max,"zero"))},title:"Set 0"}," 0 ",8,hs),e("button",{type:"button",class:"px-2 py-1 text-[11px] font-semibold rounded-md text-slate-700 hover:bg-slate-100 active:scale-[0.98] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-200 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!i.canEdit,onClick:$=>{var k;return i.canEdit&&((k=i.onQuickFillItem)==null?void 0:k.call(i,r.id,r.max,"quarter"))},title:"Set 25%"}," ¼ ",8,_s),e("button",{type:"button",class:"px-2 py-1 text-[11px] font-semibold rounded-md text-slate-700 hover:bg-slate-100 active:scale-[0.98] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-200 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!i.canEdit,onClick:$=>{var k;return i.canEdit&&((k=i.onQuickFillItem)==null?void 0:k.call(i,r.id,r.max,"half"))},title:"Set 50%"}," ½ ",8,ks),e("button",{type:"button",class:"px-2 py-1 text-[11px] font-semibold rounded-md text-slate-700 hover:bg-slate-100 active:scale-[0.98] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-indigo-200 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!i.canEdit,onClick:$=>{var k;return i.canEdit&&((k=i.onQuickFillItem)==null?void 0:k.call(i,r.id,r.max,"threeQuarter"))},title:"Set 75%"}," ¾ ",8,ws),e("button",{type:"button",class:"px-2 py-1 text-[11px] font-semibold rounded-md bg-emerald-600 text-white hover:bg-emerald-700 active:scale-[0.98] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-200 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!i.canEdit,onClick:$=>{var k;return i.canEdit&&((k=i.onQuickFillItem)==null?void 0:k.call(i,r.id,r.max,"full"))},title:"Set 100%"}," Full ",8,$s)])])]),e("td",Fs,n(r.max),1),(a(!0),o(C,null,M(i.lanes,$=>(a(),o("td",{key:$.key,class:"px-3 py-2 text-center"},[D($)?(a(),o("div",Ns,[e("input",{type:"number",step:"0.1",min:"0",max:r.max,value:i.marks[r.id]??"",onInput:k=>Q(r.id,k.target.value),onBlur:k=>B(r.id,r.max),inputmode:"decimal",class:"w-24 text-right rounded-lg border px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"},null,40,Cs)])):$.can_view_marks?(a(),o("div",Ss,n(i.getLaneMark($.key,r.id)),1)):(a(),o("div",Ls,"—"))]))),128))]))),128)),e("tr",Ms,[d[7]||(d[7]=e("td",null,null,-1)),d[8]||(d[8]=e("td",{class:"px-3 py-2 text-right font-medium text-slate-700"},"Group Total",-1)),e("td",As,n(I.value.toFixed(2)),1),e("td",{colspan:i.lanes.length,class:"px-3 py-2 text-center text-sm"},[e("span",Ts,n(y.value.toFixed(2)),1),e("span",js,"/ "+n(I.value.toFixed(2)),1)],8,Es)])])])):(a(),o("table",Gs,[e("thead",Rs,[e("tr",Ps,[d[9]||(d[9]=e("th",{class:"px-3 py-2 w-[40px] text-center font-medium"},"#",-1)),e("th",Hs,n(i.itemLabel),1),d[10]||(d[10]=e("th",{class:"px-3 py-2 text-center w-[40px] font-medium"},"Max",-1)),d[11]||(d[11]=e("th",{class:"px-3 py-2 text-center w-[80px] font-medium"},"HR Score",-1))])]),e("tbody",null,[(a(!0),o(C,null,M(w.value,(r,h)=>(a(),o("tr",{key:r.id,class:"border-t hover:bg-slate-50/60 group"},[e("td",Is,n(h+1),1),e("td",Ds,[e("div",Qs,n(r.label),1)]),e("td",Bs,n(r.max),1),e("td",Ks,[i.canEdit?(a(),o("input",{key:0,type:"number",step:"0.1",min:"0",max:r.max,value:i.marks[r.id]??"",onInput:$=>Q(r.id,$.target.value),onBlur:$=>B(r.id,r.max),inputmode:"decimal",class:"w-24 text-right rounded-lg border px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"},null,40,zs)):(a(),o("p",Os,n(i.getHrMark(r.id)||"—"),1))])]))),128)),e("tr",Vs,[d[12]||(d[12]=e("td",null,null,-1)),d[13]||(d[13]=e("td",{class:"px-3 py-2 text-right font-medium text-slate-700"},"Group Total",-1)),e("td",qs,n(I.value.toFixed(2)),1),e("td",Us,n(y.value.toFixed(2)),1)])])]))])]))}},Ys={class:"max-w-7xl mx-auto px-4 py-6 space-y-6"},Ws={class:"border rounded-2xl bg-white/80 backdrop-blur px-4 py-3 shadow-sm"},Js={class:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between"},Xs={class:"space-y-1"},Zs={class:"inline-flex items-center gap-2 rounded-full bg-indigo-50 px-3 py-1"},el={class:"text-xs text-indigo-900"},tl={class:"text-sm text-slate-600"},sl={class:"font-medium text-slate-800"},ll={class:"flex flex-wrap gap-2 text-xs mt-0.5"},al={key:0,class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},nl={class:"ml-1 font-medium text-slate-800"},ol={key:1,class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},il={class:"ml-1 font-medium text-slate-800"},rl={class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},dl={key:0,class:"ml-1 inline-flex items-center gap-1"},ul={key:1,class:"ml-1 font-semibold text-slate-800"},cl={class:"flex items-end gap-4"},xl={class:"text-right"},ml={class:"text-lg font-bold text-slate-900"},vl={class:"text-slate-400"},bl={class:"text-xs text-slate-500"},fl={key:0},pl={class:"border rounded-2xl bg-white shadow-sm overflow-hidden"},gl={key:0,class:"p-4 text-sm font-bold text-slate-500"},yl=["innerHTML"],hl={class:"mt-2"},_l={class:"grid gap-4 lg:grid-cols-5"},kl={key:0,class:"space-y-4 lg:col-span-3"},wl={key:0,class:"sticky top-6 border rounded-2xl bg-white shadow-sm"},$l={class:"flex flex-wrap items-center justify-between border-b px-4 py-3 text-sm font-semibold text-slate-800"},Fl={class:"flex flex-wrap items-center gap-2 text-[11px] text-slate-500"},Nl={class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},Cl={key:0,class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},Sl={class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},Ll={class:"p-4 space-y-4 max-h-[360px] overflow-y-auto"},Ml={class:"flex flex-wrap gap-2 border-b border-slate-100 pb-3"},Al=["onClick"],El={class:"space-y-4"},Tl={class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},jl={class:"rounded-xl border bg-slate-50 p-3"},Gl={class:"flex items-center justify-between"},Rl={class:"text-[11px] px-1.5 py-0.5 rounded bg-blue-50 text-blue-700 border border-blue-200"},Pl={class:"mt-1 text-sm font-semibold text-slate-900"},Hl={class:"text-xs text-slate-500"},Il={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},Dl={class:"rounded-xl border bg-slate-50 p-3"},Ql={class:"flex items-center justify-between"},Bl={class:"text-[11px] px-1.5 py-0.5 rounded bg-violet-50 text-violet-700 border border-violet-200"},Kl={class:"mt-1 text-sm font-semibold text-slate-900"},zl={class:"text-xs text-slate-500"},Ol={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},Vl={class:"rounded-xl border bg-slate-50 p-3 sm:col-span-2"},ql={class:"flex items-center justify-between"},Ul={class:"text-[11px] px-1.5 py-0.5 rounded bg-emerald-50 text-emerald-700 border border-emerald-200"},Yl={class:"mt-1 text-sm font-semibold text-slate-900"},Wl={class:"text-xs text-slate-500"},Jl={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},Xl={class:"border-t pt-2 text-xs"},Zl={key:0,class:"mt-3 rounded-xl border border-slate-200 bg-slate-50 p-3 text-xs space-y-2"},ea={class:"grid grid-cols-2 gap-2"},ta={class:"font-medium text-slate-800"},sa={class:"font-medium text-slate-800"},la={class:"font-medium text-slate-800"},aa={class:"font-medium text-slate-800"},na={class:"font-medium text-slate-800"},oa={class:"font-medium text-slate-800"},ia={class:"font-medium text-slate-800"},ra={class:"font-medium text-slate-800"},da={class:"font-medium text-slate-800"},ua={key:1,class:"border rounded-2xl bg-white shadow-sm"},ca={class:"flex items-center justify-between border-b px-4 py-3 text-sm font-semibold text-slate-800"},xa={class:"text-[11px] text-slate-500"},ma={class:"p-4 space-y-3"},va={class:"max-h-96 overflow-auto border rounded-xl"},ba={class:"min-w-full text-xs text-left"},fa={class:"px-2 py-2"},pa={class:"font-semibold text-slate-700"},ga={key:0,class:"mt-0.5 text-[11px] text-slate-400"},ya={class:"px-2 py-2 text-right"},ha=["onClick"],_a={key:2,class:"rounded-2xl bg-white border shadow-sm px-4 py-4 space-y-4"},ka={class:"grid gap-4 md:grid-cols-3"},wa={class:"space-y-3"},$a={class:"flex items-center justify-between text-xs font-semibold text-slate-600"},Fa={key:0,class:"text-[11px] text-emerald-600"},Na={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 h-40 overflow-y-auto"},Ca={class:"flex flex-wrap gap-1.5"},Sa=["onClick","disabled"],La={key:1,class:"text-[11px] text-slate-400"},Ma={class:"space-y-1"},Aa={class:"space-y-3"},Ea={class:"flex items-center justify-between text-xs font-semibold text-slate-600"},Ta={key:0,class:"text-[11px] text-amber-600"},ja={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 h-40 overflow-y-auto"},Ga={class:"flex flex-wrap gap-1.5"},Ra=["onClick","disabled"],Pa={key:1,class:"text-[11px] text-slate-400"},Ha={class:"space-y-1"},Ia={class:"space-y-3"},Da={class:"flex items-center justify-between text-xs font-semibold text-slate-600"},Qa={key:0,class:"text-[11px] text-sky-600"},Ba={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 h-40 overflow-y-auto"},Ka={class:"flex flex-wrap gap-1.5"},za=["onClick","disabled"],Oa={class:"space-y-1"},Va={class:"mt-2 flex flex-col gap-3 border-t pt-3 md:flex-row md:items-center md:justify-between"},qa={class:"text-sm text-slate-600"},Ua={class:"text-slate-900"},Ya={class:"text-slate-400"},Wa=["disabled"],Ja={class:"relative w-full max-w-2xl rounded-2xl border border-slate-200 bg-white p-5 shadow-xl",role:"dialog","aria-modal":"true"},Xa={class:"flex items-start justify-between gap-3"},Za={class:"text-lg font-semibold text-slate-900"},en={class:"text-xs text-slate-500"},tn={key:0,class:"text-xs text-slate-400 mt-1"},sn={class:"mt-5 space-y-4 text-sm text-slate-700"},ln={class:"mt-2 min-h-[40px] space-y-1 text-[13px] text-slate-600"},an={key:0},nn={key:1,class:"text-slate-400"},on={class:"mt-2 min-h-[40px] space-y-1 text-[13px] text-slate-600"},rn={key:0},dn={key:1,class:"text-slate-400"},un={class:"mt-2 min-h-[40px] space-y-1 text-[13px] text-slate-600"},cn={key:0},xn={key:1,class:"text-slate-400"},mn={__name:"KpiReviewForm",setup(i){const N=Bt(),w=Yt(),I=Kt(),y=F({}),j=F({}),D=F(""),Q=F(""),B=F(""),f=F(null),d=F(null),r=F(!1),h=F([]),$=F({}),k=F(!1),ie=u(()=>{var t;return((t=w.cycle)==null?void 0:t.groups_json)||[]}),vt=u(()=>{var c;const t=w.cycle||{},s=Array.isArray(t==null?void 0:t.groups_json)?t.groups_json:[];return(t==null?void 0:t.slug)==="support_staff"&&s.length===1&&((c=s[0])==null?void 0:c.id)==="personal"?"staff":"executive"}),K=u(()=>vt.value==="staff"),$e=t=>(t==null?void 0:t.id)==="personal",q=u(()=>ie.value.find($e)||null),z=u(()=>K.value?[]:ie.value.filter(t=>!$e(t))),bt=(t,s)=>(t==null?void 0:t.label)||`Group ${s+1}`,ft=t=>/^hr\d*$/i.test(t)||t==="hr",Fe=t=>ft((t==null?void 0:t.key)||"")||(t==null?void 0:t.is_hr_lane)===!0,ee=u(()=>[...h.value||[]].sort((t,s)=>(t.rank??999)-(s.rank??999))),re=u(()=>ee.value.filter(Fe)),Ne=u(()=>ee.value.filter(t=>!Fe(t))),de=u(()=>K.value?ee.value:Ne.value),O=u(()=>{var t;return((t=de.value.find(s=>s.can_current_user_review))==null?void 0:t.key)||null}),pt=u(()=>de.value.find(t=>t.key===O.value)||null),gt=u(()=>{var t;return((t=pt.value)==null?void 0:t.rank)??null}),yt=u(()=>{var t;return Number(((t=I==null?void 0:I.user)==null?void 0:t.id)||0)}),ue=u(()=>{const t=yt.value;if(!t)return null;const s=re.value.find(l=>Number(l.assigned_user_id)===t);return s||re.value.find(l=>l.can_current_user_review)||null}),R=u(()=>{var t;return((t=ue.value)==null?void 0:t.key)||null}),ht=u(()=>!!(ue.value&&ue.value.can_current_user_review)),P=u(()=>!!(k.value||ht.value)),ce=u(()=>!!O.value),te=u(()=>K.value?O.value:P.value&&R.value?R.value:O.value),Ce=u(()=>!!(te.value&&R.value&&te.value===R.value));function U(t){var c;const s=(c=$.value)==null?void 0:c[t];return s?(Array.isArray(s)?s:[s]).reduce((m,v)=>{if(!v)return m;if(!m)return v;const b=new Date(v.submitted_at||0).getTime(),p=new Date(m.submitted_at||0).getTime();return b>p?v:m},null):null}function Se(t,s){var c;const l=U(t);return((c=l==null?void 0:l.marks)==null?void 0:c[s])??""}function Le(t){var l,c,m;if(R.value){const v=U(R.value),b=(l=v==null?void 0:v.marks)==null?void 0:l[t];if(b!=null)return b}let s=null;for(const v of re.value){const b=U(v.key);if(!b||((c=b==null?void 0:b.marks)==null?void 0:c[t])==null)continue;if(!s){s=b;continue}const p=new Date(b.submitted_at||0).getTime(),L=new Date(s.submitted_at||0).getTime();p>L&&(s=b)}return((m=s==null?void 0:s.marks)==null?void 0:m[t])??""}function Me(t,s){y.value[t]=s===""?"":Number(s)}function Y(t,s){const l=Number(y.value[t]??0);l<0&&(y.value[t]=0),l>Number(s)&&(y.value[t]=Number(s))}function Ae(t,s,l){l==="zero"?y.value[t]=0:l==="quarter"?y.value[t]=Number(s)/4:l==="half"?y.value[t]=Number(s)/2:l==="threeQuarter"?y.value[t]=Number((Number(s)*.75).toFixed(1)):l==="full"&&(y.value[t]=Number(s)),Y(t,s)}function _t(t,s){t.items.forEach(l=>Ae(l.id,l.max,s))}const W=u(()=>{let t=0,s=0;const l=q.value;l&&l.items.forEach(m=>{t+=Number(m.max||0);const v=Number(y.value[m.id]||0);s+=Math.min(Math.max(v,0),Number(m.max||0))});const c=t>0?s/t*100:0;return{max:Number(t.toFixed(2)),got:Number(s.toFixed(2)),percent:Number(c.toFixed(2))}}),kt=u(()=>!!f.value&&typeof f.value=="object"),wt=u(()=>{var t;return((t=f.value)==null?void 0:t.avg)||{per_scored_month:{},per_form_yearly:{},percent_simple:0,percent_weighted:0}}),$t=u(()=>{var t;return((t=f.value)==null?void 0:t.year)??null}),Ft=u(()=>{var t;return((t=d.value)==null?void 0:t.avg)||{per_scored_month:{},per_form_yearly:{},percent_simple:0,percent_weighted:0}}),Nt=u(()=>{var t;return((t=d.value)==null?void 0:t.year)??null}),A=F("target"),xe=[{key:"target",label:"Annual Target"},{key:"performance",label:"Annual Performance"}],Ee=u(()=>{var t;return((t=f.value)==null?void 0:t.months_total_form)??0}),Ct=u(()=>{var t;return((t=d.value)==null?void 0:t.months_total_form)??Ee.value}),g=u(()=>A.value==="target"?wt.value:Ft.value),Te=u(()=>{var t,s;return Number(((s=(t=g.value)==null?void 0:t.per_form_yearly)==null?void 0:s.final)||0)}),je=u(()=>{var t,s;return Number(((s=(t=g.value)==null?void 0:t.per_scored_month)==null?void 0:s.max)||0)}),St=u(()=>je.value?Math.round(Te.value/je.value*100):0),Ge=u(()=>P.value&&!K.value),me=u(()=>A.value==="target"?$t.value:Nt.value),Re=u(()=>A.value==="target"?Ee.value:Ct.value),ve=u(()=>{var t;return((t=xe.find(s=>s.key===A.value))==null?void 0:t.label)||"Annual Target"}),Lt={target:"target",performance:"regular_activities_of_the_department"},Mt=u(()=>{const t=Lt[A.value];return t&&z.value.find(s=>s.id===t)||null}),At=u(()=>{var t;return((t=Mt.value)==null?void 0:t.label)||ve.value}),Et=t=>{xe.some(s=>s.key===t)&&(A.value=t)};ye(A,()=>{r.value=!1});const Pe=t=>String(t||"").toLowerCase(),He=(t,s)=>t?s==="target"?t.id==="monthly_target"?!0:Pe(t.label).includes("monthly target"):s==="performance"?t.id==="execution"?!0:Pe(t.label).includes("execution")||String(t.label||"").includes("কার্যসম্পাদন"):!1:!1,Tt=t=>z.value.find(s=>He(s,t))||null,Ie=(t,{overwrite:s}={overwrite:!1})=>{if(!Ge.value)return;const l=Tt(t);if(!l||!Array.isArray(l.items)||l.items.length===0)return;const c=l.items,m=c.every(p=>Number(y.value[p.id]||0)===0);if(!s&&!m)return;const v=Te.value,b=c.reduce((p,L)=>p+Number(L.max||0),0);if(b){if(c.length===1){const p=c[0];y.value[p.id]=Math.min(v,Number(p.max||0)),Y(p.id,p.max);return}c.forEach(p=>{const L=Number(p.max||0)/b*v,T=Number(L.toFixed(1));y.value[p.id]=T,Y(p.id,p.max)})}},jt=u(()=>`Auto: ${A.value==="target"?"Annual Target":"Annual Performance"} (${St.value}%)`);ye(A,t=>{Ie(t,{overwrite:!1})},{immediate:!0});const se=u(()=>{const t=K.value?ee.value:Ne.value,s=[],l=Ce.value||P.value?1/0:gt.value??null,c=m=>{if(!m)return[];const v=[];if(Array.isArray(m))v.push(...m);else if(typeof m=="string"&&m.trim())v.push(m.trim());else return[];const b=new Set;return v.reduce((p,L)=>{const T=typeof L=="string"?L.trim():"";return!T||b.has(T)||(b.add(T),p.push(T)),p},[])};return t.forEach(m=>{const v=m.key;if(!v||l!=null&&(m.rank??999)>l)return;const b=U(v);if(!b)return;const p=c(b.strengths),L=c(b.gaps),T=c(b.suggestions);!p.length&&!L.length&&!T.length||s.push({key:v,lane:v,label:m.label||(b==null?void 0:b.lane_label)||v,reviewer_id:b.reviewer_id,reviewer_name:b.reviewer_name,strengths:p,gaps:L,suggestions:T,submitted_at:b.submitted_at??null})}),s}),Gt=t=>{const s=new Set;return se.value.forEach(l=>{(Array.isArray(l[t])?l[t]:[]).forEach(m=>{const v=typeof m=="string"?m.trim():"";v&&s.add(v)})}),Array.from(s)},De=t=>{if(!Array.isArray(t))return[];const s=new Set;return t.forEach(l=>{const c=typeof l=="string"?l.trim():"";c&&s.add(c)}),Array.from(s)},le=u(()=>De(w.strengths)),ae=u(()=>De(w.gaps)),ne=u(()=>Gt("suggestions"));F([]),F([]),F([]);const be=F(!1),S=F(null);function Rt(t){S.value=t,be.value=!0}function fe(){be.value=!1,S.value=null}const Qe={strengths:D,gaps:Q,suggestions:B};function Pt(t,s){const l=(s||"").trim();return l?t!=null&&t.trim()?`${t.trim()}
${l}`:l:t}const Ht=u(()=>{const t={};let s=1;const l=q.value;return l&&l.items.forEach(c=>{t[c.id]=s++}),t}),It=u(()=>Number(N.params.employeeId)),Dt=t=>{var s;if(j.value=t.employee,f.value=(t==null?void 0:t.annual_target_avg_marks)||null,d.value=(t==null?void 0:t.annual_performance_avg_marks)||null,h.value=t.lanes||[],$.value=t.reviews_by_lane||{},k.value=!!(((s=t==null?void 0:t.meta)==null?void 0:s.is_hr)??(t==null?void 0:t.hr)??!1),y.value={},ie.value.forEach(l=>l.items.forEach(c=>{y.value[c.id]=0})),O.value){const l=U(O.value);l!=null&&l.marks&&Object.assign(y.value,l.marks)}P.value&&z.value.length&&z.value.forEach(l=>{l.items.forEach(c=>{let m=R.value?Se(R.value,c.id):"";(m===""||m==null)&&(m=Le(c.id)),m!==""&&m!=null&&(y.value[c.id]=Number(m))})})};ye(It,async(t,s)=>{if(!t||s&&t===s)return;await w.fetchActiveCycle(t);const l=await w.fetchLanes(w.cycle.id,t);Dt(l)},{immediate:!0});async function Qt(){const t=te.value;if(!t){alert("Unable to determine reviewer lane.");return}await w.submitReview({cycle_id:w.cycle.id,employee_id:Number(N.params.employeeId),reviewer_lane:t,marks:y.value,strengths:D.value,gaps:Q.value,suggestions:B.value}),alert("Submitted")}function E(t){const s=Number(t??0);return isNaN(s)?"0.00":s.toFixed(2)}function V(t,s){const l=Number(t??0),c=Number(s??0);return c>0?Math.round(l/c*100):0}function oe(t,s){const l=Qe[t];if(!l)return!1;const c=(l.value||"").split(`
`).map(v=>v.trim()).filter(Boolean),m=(s||"").trim();return m?c.includes(m):!1}function pe(t,s){const l=Qe[t];if(!l)return;const c=typeof s=="string"?s.trim():"";c&&(oe(t,c)||(l.value=Pt(l.value,c)))}return(t,s)=>{var l,c,m,v,b,p,L,T,ge,Be,Ke,ze,Oe,Ve,qe,Ue,Ye,We,Je,Xe,Ze,et,tt,st,lt,at,nt,ot,it,rt,dt,ut;return a(),o(C,null,[e("div",Ys,[e("header",Ws,[e("div",Js,[e("div",Xs,[e("div",Zs,[s[5]||(s[5]=e("span",{class:"text-xs font-semibold text-indigo-700"},"KPI Cycle",-1)),e("span",el,n((l=Z(w).cycle)==null?void 0:l.title),1)]),e("div",tl,[e("div",sl,n(((c=j.value)==null?void 0:c.name)||"Employee"),1),e("div",ll,[(v=(m=j.value)==null?void 0:m.designation)!=null&&v.title?(a(),o("span",al,[s[6]||(s[6]=H(" Designation: ")),e("span",nl,n(j.value.designation.title),1)])):_("",!0),(p=(b=j.value)==null?void 0:b.department)!=null&&p.name?(a(),o("span",ol,[s[7]||(s[7]=H(" Department: ")),e("span",il,n(j.value.department.name),1)])):_("",!0),e("span",rl,[s[9]||(s[9]=H(" Reviewing as: ")),Ce.value?(a(),o("span",dl,s[8]||(s[8]=[e("span",{class:"font-semibold text-emerald-700"},"HR",-1),e("span",{class:"text-[10px] rounded bg-emerald-50 border border-emerald-200 px-1.5 py-0.5 text-emerald-700"}," HR mode ",-1)]))):(a(),o("span",ul,n(te.value||"No lane"),1))])])])]),e("div",cl,[e("div",xl,[s[10]||(s[10]=e("div",{class:"text-[11px] uppercase tracking-wide text-slate-500"}," Personal group total ",-1)),e("div",ml,[H(n(W.value.got.toFixed(2))+" ",1),e("span",vl,"/ "+n(W.value.max.toFixed(2)),1)]),e("div",bl,n(W.value.percent.toFixed(2))+"% achieved ",1)]),k.value?(a(),o("button",{key:0,onClick:s[0]||(s[0]=x=>Z(w).submitFinalResult(Z(w).cycle.id,Z(N).params.employeeId)),class:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-4 py-2.5 text-sm font-medium text-white shadow hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-300 focus:outline-none"},s[11]||(s[11]=[e("span",null,"Finalize & Lock",-1)]))):_("",!0)])])]),(L=j.value)!=null&&L.active_criteria?(a(),o("div",fl,[e("section",pl,[s[12]||(s[12]=e("div",{class:"flex items-center justify-between border-b bg-slate-50 px-4 py-2"},[e("div",{class:"text-sm font-semibold text-slate-800"},"কার্যসম্পাদন বিষয়")],-1)),((ge=(T=j.value)==null?void 0:T.active_criteria)==null?void 0:ge.length)===0?(a(),o("div",gl," -- ")):_("",!0),(a(!0),o(C,null,M(j.value.active_criteria,x=>(a(),o("div",{class:"p-4 text-sm text-slate-700",key:x.id},[e("div",{class:"print:block richtext print:break-inside-avoid",innerHTML:x==null?void 0:x.description},null,8,yl)]))),128))])])):_("",!0),Z(w).cycle&&q.value?(a(),we(mt,{key:1,group:q.value,"is-personal":!0,lanes:de.value,"editable-lane-key":O.value,"can-edit":ce.value,marks:y.value,"header-label":"Personal Evaluation","item-label":((Be=q.value)==null?void 0:Be.label)||"Personal","helper-text":K.value?"All reviewer lanes score the Personal table.":"Fill only your lane; others appear as read-only.","serial-map":Ht.value,"get-lane-mark":Se,"on-mark-change":Me,"on-cap":Y,"on-quick-fill-item":Ae},null,8,["group","lanes","editable-lane-key","can-edit","marks","item-label","helper-text","serial-map"])):_("",!0),e("section",hl,[e("div",_l,[z.value.length?(a(),o("div",kl,[(a(!0),o(C,null,M(z.value,(x,G)=>(a(),we(mt,{key:G,group:x,"is-personal":!1,"can-edit":P.value,marks:y.value,"header-label":`Group ${G+1} - ${bt(x,G)}`,"item-label":"Item","show-quick-fill-group":!0,"auto-fill-visible":Ge.value&&He(x,A.value),"auto-fill-label":jt.value,"on-auto-fill":()=>Ie(A.value,{overwrite:!0}),"get-hr-mark":Le,"on-mark-change":Me,"on-cap":Y,"on-quick-fill-group":_t},null,8,["group","can-edit","marks","header-label","auto-fill-visible","auto-fill-label","on-auto-fill"]))),128))])):_("",!0),e("aside",{class:xt(["space-y-4 sticky top-10 z-50",[z.value.length===0?"lg:col-span-full":"lg:col-span-2"]])},[!K.value&&kt.value&&P.value?(a(),o("section",wl,[e("header",$l,[s[13]||(s[13]=e("span",null,"Annual Summary",-1)),e("div",Fl,[e("span",Nl,n(ve.value),1),me.value?(a(),o("span",Cl," Year "+n(me.value),1)):_("",!0),e("span",Sl,n(Re.value)+" month(s) ",1)])]),e("div",Ll,[e("div",Ml,[(a(),o(C,null,M(xe,x=>e("button",{key:x.key,type:"button",onClick:G=>Et(x.key),class:xt(["px-3 py-1 rounded-full text-xs font-semibold transition",A.value===x.key?"bg-slate-900 text-white shadow":"border border-slate-200 text-slate-700 bg-white hover:border-slate-400"])},n(x.label),11,Al)),64))]),e("div",El,[e("div",Tl,[e("div",jl,[e("div",Gl,[s[14]||(s[14]=e("span",{class:"text-xs font-medium text-slate-600"},"Incharge",-1)),e("span",Rl,n(V((Ke=g.value.per_scored_month)==null?void 0:Ke.incharge,(ze=g.value.per_scored_month)==null?void 0:ze.max))+"% ",1)]),e("div",Pl,[H(n(E((Oe=g.value.per_scored_month)==null?void 0:Oe.incharge))+" ",1),e("span",Hl,"/ "+n(E((Ve=g.value.per_scored_month)==null?void 0:Ve.max)),1)]),e("div",Il,[e("div",{class:"h-2 bg-blue-500",style:he({width:V((qe=g.value.per_scored_month)==null?void 0:qe.incharge,(Ue=g.value.per_scored_month)==null?void 0:Ue.max)+"%"})},null,4)])]),e("div",Dl,[e("div",Ql,[s[15]||(s[15]=e("span",{class:"text-xs font-medium text-slate-600"},"Coordinator",-1)),e("span",Bl,n(V((Ye=g.value.per_scored_month)==null?void 0:Ye.coordinator,(We=g.value.per_scored_month)==null?void 0:We.max))+"% ",1)]),e("div",Kl,[H(n(E((Je=g.value.per_scored_month)==null?void 0:Je.coordinator))+" ",1),e("span",zl,"/ "+n(E((Xe=g.value.per_scored_month)==null?void 0:Xe.max)),1)]),e("div",Ol,[e("div",{class:"h-2 bg-violet-500",style:he({width:V((Ze=g.value.per_scored_month)==null?void 0:Ze.coordinator,(et=g.value.per_scored_month)==null?void 0:et.max)+"%"})},null,4)])]),e("div",Vl,[e("div",ql,[s[16]||(s[16]=e("span",{class:"text-xs font-medium text-slate-600"},"Final",-1)),e("span",Ul,n(V((tt=g.value.per_form_yearly)==null?void 0:tt.final,(st=g.value.per_scored_month)==null?void 0:st.max))+"% ",1)]),e("div",Yl,[H(n(E((lt=g.value.per_form_yearly)==null?void 0:lt.final))+" ",1),e("span",Wl,"/ "+n(E((at=g.value.per_scored_month)==null?void 0:at.max)),1)]),e("div",Jl,[e("div",{class:"h-2 bg-emerald-500",style:he({width:V((nt=g.value.per_form_yearly)==null?void 0:nt.final,(ot=g.value.per_scored_month)==null?void 0:ot.max)+"%"})},null,4)])])]),e("div",Xl,[e("button",{class:"text-xs px-3 py-1.5 rounded-md border hover:bg-slate-50",onClick:s[1]||(s[1]=x=>r.value=!r.value)},n(r.value?"Hide details":"Show "+ve.value+" details"),1),r.value?(a(),o("div",Zl,[e("div",ea,[s[17]||(s[17]=e("div",{class:"text-slate-500"},"Year",-1)),e("div",ta,n(me.value||"-"),1),s[18]||(s[18]=e("div",{class:"text-slate-500"},"Months counted",-1)),e("div",sa,n(Re.value),1),s[19]||(s[19]=e("div",{class:"text-slate-500"},"Group",-1)),e("div",la,n(At.value),1),s[20]||(s[20]=e("div",{class:"text-slate-500"},"Max (denominator)",-1)),e("div",aa,n(E((it=g.value.per_scored_month)==null?void 0:it.max)),1),s[21]||(s[21]=e("div",{class:"text-slate-500"},"Incharge avg",-1)),e("div",na,n(E((rt=g.value.per_form_yearly)==null?void 0:rt.incharge)),1),s[22]||(s[22]=e("div",{class:"text-slate-500"},"Coordinator avg",-1)),e("div",oa,n(E((dt=g.value.per_form_yearly)==null?void 0:dt.coordinator)),1),s[23]||(s[23]=e("div",{class:"text-slate-500"},"Final avg",-1)),e("div",ia,n(E((ut=g.value.per_form_yearly)==null?void 0:ut.final)),1),s[24]||(s[24]=e("div",{class:"text-slate-500"},"Percent (simple)",-1)),e("div",ra,n(E(g.value.percent_simple))+"% ",1),s[25]||(s[25]=e("div",{class:"text-slate-500"},"Percent (weighted)",-1)),e("div",da,n(E(g.value.percent_weighted))+"% ",1)])])):_("",!0)])])])])):_("",!0),se.value.length?(a(),o("section",ua,[e("header",ca,[s[26]||(s[26]=e("span",null,"Review Comments",-1)),e("span",xa,n(se.value.length)+" lane(s) ",1)]),e("div",ma,[e("div",va,[e("table",ba,[s[28]||(s[28]=e("thead",{class:"text-[11px] text-slate-600 uppercase tracking-wide bg-slate-50"},[e("tr",null,[e("th",{class:"px-2 py-2 w-[140px]"},"Lane"),e("th",{class:"px-2 py-2 text-right"},"Details")])],-1)),e("tbody",null,[(a(!0),o(C,null,M(se.value,x=>(a(),o("tr",{key:x.key,class:"border-t hover:bg-slate-50/60 align-top"},[e("td",fa,[e("div",pa,n(x.label),1),x.submitted_at?(a(),o("div",ga,n(new Date(x.submitted_at).toLocaleDateString()),1)):_("",!0)]),e("td",ya,[e("button",{type:"button",class:"inline-flex items-center gap-1 rounded-full border border-slate-200 bg-white px-3 py-1.5 text-[11px] font-semibold text-slate-600 hover:border-slate-300 hover:text-slate-800",onClick:G=>Rt(x)},s[27]||(s[27]=[e("span",null,"View comments",-1),e("span",{class:"text-[10px] text-slate-400"},"Strengths · Gaps · Suggestions",-1)]),8,ha)])]))),128))])])])])])):_("",!0)],2)])]),ce.value||P.value?(a(),o("section",_a,[s[35]||(s[35]=Ot('<header class="flex items-center justify-between mb-1"><div><h2 class="text-sm font-semibold text-slate-800">Overall Review Notes</h2><p class="text-[11px] text-slate-500"> Use saved hints or write your own detailed comments. </p></div><div class="hidden md:flex items-center gap-2 text-[11px] text-slate-500"><span class="inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 border border-emerald-100"><span class="text-xs">●</span> Strengths </span><span class="inline-flex items-center gap-1 rounded-full bg-amber-50 px-2 py-0.5 border border-amber-100"><span class="text-xs">●</span> Gaps </span><span class="inline-flex items-center gap-1 rounded-full bg-sky-50 px-2 py-0.5 border border-sky-100"><span class="text-xs">●</span> Suggestions </span></div></header>',1)),e("div",ka,[e("div",wa,[e("header",$a,[s[29]||(s[29]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-emerald-500 text-base leading-none"},"★"),e("span",null,"Strengths")],-1)),le.value.length?(a(),o("span",Fa,n(le.value.length)+" saved hint(s) ",1)):_("",!0)]),le.value.length?(a(),o("div",Na,[e("div",Ca,[(a(!0),o(C,null,M(le.value,x=>(a(),o("button",{key:x,type:"button",onClick:G=>pe("strengths",x),disabled:oe("strengths",x),class:"rounded-full border px-2.5 py-1 text-[11px] font-medium transition border-slate-200 bg-white text-slate-700 hover:border-emerald-300 hover:bg-emerald-50 hover:text-emerald-800 disabled:opacity-40 disabled:cursor-not-allowed"},n(x),9,Sa))),128))])])):(a(),o("p",La," No historical strengths yet. Write your own notes below. ")),e("div",Ma,[s[30]||(s[30]=e("label",{class:"text-[11px] font-medium text-slate-500"}," Key Strength(s) ",-1)),_e(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=x=>D.value=x),placeholder:"e.g. Strong ownership, proactive problem solving…",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[ke,D.value]])])]),e("div",Aa,[e("header",Ea,[s[31]||(s[31]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-amber-500 text-base leading-none"},"!"),e("span",null,"Gaps")],-1)),ae.value.length?(a(),o("span",Ta,n(ae.value.length)+" saved hint(s) ",1)):_("",!0)]),ae.value.length?(a(),o("div",ja,[e("div",Ga,[(a(!0),o(C,null,M(ae.value,x=>(a(),o("button",{key:x,type:"button",onClick:G=>pe("gaps",x),disabled:oe("gaps",x),class:"rounded-full border px-2.5 py-1 text-[11px] font-medium transition border-slate-200 bg-white text-slate-700 hover:border-amber-300 hover:bg-amber-50 hover:text-amber-800 disabled:opacity-40 disabled:cursor-not-allowed"},n(x),9,Ra))),128))])])):(a(),o("p",Pa,"No historical gaps yet.")),e("div",Ha,[s[32]||(s[32]=e("label",{class:"text-[11px] font-medium text-slate-500"},"GAP(s)",-1)),_e(e("textarea",{"onUpdate:modelValue":s[3]||(s[3]=x=>Q.value=x),placeholder:"e.g. Needs improvement in documentation, communication…",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-amber-200"},null,512),[[ke,Q.value]])])]),e("div",Ia,[e("header",Da,[s[33]||(s[33]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-sky-500 text-base leading-none"},"✱"),e("span",null,"Suggestions / Training")],-1)),ne.value.length?(a(),o("span",Qa,n(ne.value.length)+" common suggestion(s) ",1)):_("",!0)]),ne.value.length?(a(),o("div",Ba,[e("div",Ka,[(a(!0),o(C,null,M(ne.value,x=>(a(),o("button",{key:x,type:"button",onClick:G=>pe("suggestions",x),disabled:oe("suggestions",x),class:"rounded-full border px-2.5 py-1 text-[11px] font-medium transition border-slate-200 bg-white text-slate-700 hover:border-sky-300 hover:bg-sky-50 hover:text-sky-800 disabled:opacity-40 disabled:cursor-not-allowed"},n(x),9,za))),128))])])):_("",!0),e("div",Oa,[s[34]||(s[34]=e("label",{class:"text-[11px] font-medium text-slate-500"}," Suggestions / Development plan ",-1)),_e(e("textarea",{"onUpdate:modelValue":s[4]||(s[4]=x=>B.value=x),placeholder:"Specific actions, training plans, timeline and expectations…",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-sky-200"},null,512),[[ke,B.value]])])])])])):_("",!0),e("div",Va,[e("div",qa,[s[36]||(s[36]=H(" My (Personal) Total: ")),e("b",Ua,n(W.value.got.toFixed(2)),1),e("span",Ya,"/ "+n(W.value.max.toFixed(2)),1)]),e("button",{onClick:Qt,disabled:!(P.value||ce.value),class:"inline-flex items-center justify-center rounded-xl bg-emerald-600 px-5 py-2.5 text-sm font-medium text-white shadow hover:bg-emerald-700 disabled:opacity-40 focus:outline-none focus:ring-2 focus:ring-emerald-300"}," Submit ",8,Wa)])]),zt(Ut,{name:"fade-scale"},{default:Vt(()=>{var x,G,ct;return[be.value&&S.value?(a(),o("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center px-4 py-6",onKeydown:qt(fe,["escape","window"])},[e("div",{class:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm","aria-hidden":"true",onClick:fe}),e("div",Ja,[e("div",Xa,[e("div",null,[e("p",Za,n(S.value.label),1),e("p",en," Lane: "+n(S.value.lane)+" - Reviewed by "+n(S.value.reviewer_name||"––"),1),S.value.submitted_at?(a(),o("p",tn,n(new Date(S.value.submitted_at).toLocaleString()),1)):_("",!0)]),e("button",{type:"button",class:"rounded-lg border border-slate-200 bg-white px-3 py-1.5 text-sm font-semibold text-slate-600 hover:bg-slate-50",onClick:fe}," Close ")]),e("div",sn,[e("div",null,[s[37]||(s[37]=e("div",{class:"flex items-center justify-between text-xs font-semibold text-slate-500 uppercase"},[e("span",null,"Strengths")],-1)),e("div",ln,[(x=S.value.strengths)!=null&&x.length?(a(),o("div",an,[(a(!0),o(C,null,M(S.value.strengths,(J,X)=>(a(),o("p",{key:"modal-strength-"+X}," - "+n(J),1))),128))])):(a(),o("p",nn,"No strengths entered."))])]),e("div",null,[s[38]||(s[38]=e("div",{class:"flex items-center justify-between text-xs font-semibold text-slate-500 uppercase"},[e("span",null,"Gaps")],-1)),e("div",on,[(G=S.value.gaps)!=null&&G.length?(a(),o("div",rn,[(a(!0),o(C,null,M(S.value.gaps,(J,X)=>(a(),o("p",{key:"modal-gap-"+X}," - "+n(J),1))),128))])):(a(),o("p",dn,"No gaps recorded."))])]),e("div",null,[s[39]||(s[39]=e("div",{class:"flex items-center justify-between text-xs font-semibold text-slate-500 uppercase"},[e("span",null,"Suggestions")],-1)),e("div",un,[(ct=S.value.suggestions)!=null&&ct.length?(a(),o("div",cn,[(a(!0),o(C,null,M(S.value.suggestions,(J,X)=>(a(),o("p",{key:"modal-sug-"+X}," - "+n(J),1))),128))])):(a(),o("p",xn,"No suggestions provided."))])])])])],32)):_("",!0)]}),_:1})],64)}}},fn={__name:"KpiReviewPage",setup(i){return(N,w)=>(a(),we(mn))}};export{fn as default};
