import{O}from"./OverlyModal-BY3rbn19.js";import{m as z,c as i,o as n,a as e,t as r,k as m,w as L,n as M,p as N,g as T,F as S,q as A,f as B,s as b,i as k,R as W,x as E,r as $,d as j,e as F,y as U,j as g,h as I,z as H,A as V,u as Y,B as K}from"./index-BKgdzu_o.js";import{L as G}from"./LoaderView-GlVQbooq.js";import{m as J,_ as Q}from"./task-tree-BA1HATB0.js";import{o as R,g as X,a as P}from"./datetime-BcVQVGye.js";import{u as Z}from"./useTaskStore-BcoJ42X2.js";import{_ as ee}from"./TaskTreeViewWithSubTable-BEnxkXVI.js";import{u as te}from"./user-HxOpoM6x.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TaskSupervisorAndEmployee-D-lDiTYG.js";import"./UserChip-IDoNCYdY.js";import"./url-CePbr-gY.js";const se=(_,f,l,u)=>{const a=new Date(u,l-1,f);return _.filter(o=>{const y=o.deadline?new Date(o.deadline):null,p=R(new Date);if(o.assigned_at||o.created_at){let D=o.assigned_at?R(new Date(o.assigned_at)):null;!D&&o.created_at&&(D=R(new Date(o.created_at)));let x=null;return!(a<D||(o.completed_at&&(x=R(new Date(o.completed_at))),x&&x<a)||y&&y<a&&a>p)}return!1}).map(o=>{let y=!1;return o.deadline&&(y=new Date(o.deadline)<a),{...o,deadline_crossed:y}})},ae={class:"px-4 py-2 flex items-center bg-gray-50 group"},oe={class:"mx-4"},le=["disabled"],ne={class:"ml-4 md:ml-auto flex items-center gap-2"},ie=["value"],de=z({__name:"DailyTaskHeading",props:{selectedDay:{type:String,required:!0},loading:{type:Boolean,default:!1}},emits:["todayButtonClick","reloadClick","previousDayClick","nextDayClick","inputSelectedDay"],setup(_,{emit:f}){const l=f;return(u,a)=>(n(),i("div",ae,[a[6]||(a[6]=e("h2",{class:"leading-none font-semibold text-lg"},"Daily Task",-1)),e("div",oe,r(m(X)(_.selectedDay)),1),e("button",{class:"btn-3 mx-4 h-7",onClick:a[0]||(a[0]=L(o=>l("todayButtonClick"),["prevent"]))},"Today"),e("button",{class:M(["btn-3 px-2 py-2 mx-4 size-7 disabled:text-gray-300 disabled:border-gray-300",{"animate-spin text-gray-300 border-gray-300 !bg-opacity-0":_.loading}]),onClick:a[1]||(a[1]=L(o=>l("reloadClick"),["prevent"])),disabled:_.loading},a[5]||(a[5]=[e("i",{class:"fas fa-redo-alt"},null,-1)]),10,le),e("div",ne,[e("button",{class:"btn-2 h-7",onClick:a[2]||(a[2]=L(o=>l("previousDayClick"),["prevent"]))},"Previous Day"),e("button",{class:"btn-2 h-7",onClick:a[3]||(a[3]=L(o=>l("nextDayClick"),["prevent"]))},"Next Day"),e("input",{type:"date",value:_.selectedDay,onInput:a[4]||(a[4]=o=>l("inputSelectedDay",o)),class:"border px-2 rounded"},null,40,ie)])]))}}),re={key:0},ue={key:0,class:"fad fa-folder text-xs mr-2"},ce={key:1,class:"fad fa-file-alt text-xs mr-2"},pe={key:2,class:"text-center w-full mt-4 text-xs text-gray-600"},me={__name:"TaskListOnDay",props:{isCurrentMonth:{type:Boolean,default:!1},tasks:{type:Array,default:()=>[]},limit:{type:Number,default:null},tree:{type:Boolean,default:!1}},emits:["clickOnMore"],setup(_,{emit:f}){const l=_,u=f,a=N(()=>{var o;return l.limit?((o=l==null?void 0:l.tasks)==null?void 0:o.slice(0,l.limit))||[]:[...l.tasks]});return(o,y)=>(n(),i("div",null,[_.tree?(n(),i("div",re,[(n(!0),i(S,null,A(a.value,p=>(n(),B(ee,{"hide-buttons":"","hide-assigned-users":"",task:p,key:p.id,class:"mb-6 shadow hover:shadow-md"},null,8,["task"]))),128))])):(n(),i("ul",{key:1,class:M({"text-gray-500 group-hover:text-gray-900":!_.isCurrentMonth})},[(n(!0),i(S,null,A(a.value,p=>(n(),i("li",{class:"mb-2",key:p.id},[b(m(W),{to:`/tasks/${p.id}`,target:"_blank",class:"flex items-center hover:underline hover:text-blue-600"},{default:k(()=>[p.children_task_count>0?(n(),i("i",ue)):T("",!0),p.children_task_count==0?(n(),i("i",ce)):T("",!0),e("span",{class:M(["line-clamp-1",{"text-red-800":p.deadline_crossed}])},r(p.title),3)]),_:2},1032,["to"])]))),128))],2)),_.tasks.length-a.value.length>0?(n(),i("div",pe,[e("button",{onClick:y[0]||(y[0]=L(p=>u("clickOnMore",p),["prevent"])),class:"text-blue-600 hover:underline"}," +"+r(_.tasks.length-a.value.length)+" More Tasks ",1)])):T("",!0)]))}},ye={class:"border"},fe={class:"bg-gray-300 bg-opacity-90 relative"},xe={class:"bg-gray-50 border-y rounded-md z-20"},ve={class:"text-md font-semibold sticky top-0 border-b px-4 z-30 py-3 bg-white flex items-center shadow"},ge={class:"flex justify-between items-center gap-4 ml-auto"},be={class:"w-32 relative h-8 mx-4"},_e={__name:"DailyTask",setup(_){const f=E({day:null,month:null,year:null}),l=$(),u=$("loading"),a=Z(),o=j(),y=$(""),p=$("not-completed");F(()=>{l.value=P(new Date)}),U(l,d=>{const[c,t,h]=d.split("-").map(Number);f.day=h,f.month=t,f.year=c}),U(()=>f.month,async()=>{u.value="loading",await D(),u.value=""});async function D(){await a.fetchMyTasks({status:"not-completed"})}function x(){const d=new Date;l.value=P(d)}function q(){const d=new Date(l.value);d.setDate(d.getDate()+1),l.value=P(d)}function w(){const d=new Date(l.value);d.setDate(d.getDate()-1),l.value=P(d)}const s=async()=>{u.value="loading",await D(),u.value=""},v=N(()=>{var c;const d=t=>{var h,C;return y.value?(C=t==null?void 0:t.toUpperCase())==null?void 0:C.includes((h=y.value)==null?void 0:h.toUpperCase()):!0};return J(se(a.tasks,f.day,f.month,f.year),{"user-ids":(c=o==null?void 0:o.user)==null?void 0:c.id,status:p.value}).filter(t=>{var h;return d(t.title)||((h=t.children_tasks)==null?void 0:h.some(C=>d(C==null?void 0:C.title)))}).map(t=>({...t,children_tasks:t.children_tasks.filter(h=>d(h.title))}))});return(d,c)=>(n(),i("div",ye,[b(de,{"selected-day":l.value,loading:u.value=="loading",onTodayButtonClick:x,onReloadClick:s,onPreviousDayClick:w,onNextDayClick:q,onInputSelectedDay:c[0]||(c[0]=t=>{var h;return l.value=(h=t==null?void 0:t.target)==null?void 0:h.value})},null,8,["selected-day","loading"]),e("div",fe,[e("div",xe,[e("div",ve,[c[5]||(c[5]=g(" Tasks ")),e("div",ge,[e("div",be,[c[4]||(c[4]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),I(e("select",{"onUpdate:modelValue":c[1]||(c[1]=t=>p.value=t),class:"h-8 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},c[3]||(c[3]=[e("option",{value:""},"--ALL TASKS--",-1),e("option",{value:"not-completed"},"Not Completed",-1)]),512),[[H,p.value]])]),b(Q,{modelValue:y.value,"onUpdate:modelValue":c[2]||(c[2]=t=>y.value=t),class:"w-full md:w-48 md:ml-auto h-8","debounce-time":0},null,8,["modelValue"])])]),b(me,{class:"p-4 min-h-[40vh] max-h-[60vh] overflow-y-auto","is-current-month":d.isCurrentMonth,tasks:v.value,tree:!0},null,8,["is-current-month","tasks"])]),u.value==="loading"?(n(),B(G,{key:0,class:"absolute inset-0 flex items-center justify-center z-20 bg-opacity-70"})):T("",!0)])]))}},he={class:"container px-6 mx-auto"},ke={key:0,class:"grid gap-4 md:grid-cols-3 mt-4"},we={class:"text-3xl"},De={class:"text-3xl"},Ce={class:"text-3xl"},Le={class:"text-3xl"},$e={class:"text-3xl"},Te={class:"text-3xl"},Se={class:"text-3xl"},Ae={class:"text-3xl"},Me={class:"text-3xl"},Re={key:1,class:"w-full mt-4"},Pe={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Be={class:"bg-white shadow-md rounded-lg p-4"},qe={class:"space-y-2"},Ne={class:"flex justify-between items-center px-4 py-2 rounded hover:bg-gray-50 transition-colors"},Ue={class:"font-semibold text-gray-800"},Ve={key:0},je={key:1},Fe={key:2},Oe={class:"space-y-3"},ze={class:"flex items-center space-x-4"},We={key:0,class:"h-3 w-3 bg-red-600 rounded-full inline-block"},Ee={key:1,class:"inline-block"},Ie={class:"absolute top-10 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition pointer-events-none z-10 whitespace-nowrap"},He={class:"text-sm font-medium text-gray-900"},Ye={class:"text-xs text-gray-500 mt-0.5"},Ke={class:"text-xl font-bold text-gray-800 flex items-center gap-2 p-4"},Ge={class:"space-y-5 px-4 md:px-6 py-4"},Je={class:"text-sm text-gray-500 flex items-center gap-2"},Qe={class:"flex justify-end gap-3 mt-6"},Xe={class:"bg-white shadow-md rounded-lg"},Ze={class:"overflow-x-auto shadow-md sm:rounded-lg min-h-max"},et={class:"min-w-full text-sm text-left text-gray-500"},tt={class:"px-6 py-4 font-medium text-gray-900"},st={class:"px-6 py-4"},at={class:"px-6 py-4"},ot={class:"px-6 py-4"},lt={class:"card-bg mt-4 gap-0 shadow-md border border-gray-300"},gt={__name:"DashBoard",setup(_){const f=j(),l=te(),{dashboardInfo:u,selectedDate:a,userDashboard:o}=V(l),{user:y}=V(f),p=Y(),D=N(()=>{var w;return["admin","super_admin","developer"].includes((w=y==null?void 0:y.value)==null?void 0:w.role)}),x=$(null);F(async()=>{var s,v;y.value||await f.fetchUser(),await l.fetchUserDashboardData(),D.value&&await l.fetchAdminDashboardData();const w=(v=(s=o.value)==null?void 0:s.notices)==null?void 0:v.find(d=>!d.user_feedback);w&&(x.value=w)});const q=()=>{if(!x.value)return;const w=x.value.type===1?`/notice-details/${x.value.id}`:`/policy-details/${x.value.id}`;p.push(w)};return(w,s)=>{var d,c;const v=K("RouterLink");return n(),i("div",he,[D.value&&m(f).isAdminMood?(n(),i("div",ke,[b(v,{to:{name:"TodayAttendanceReport",query:{status:"all"}},class:"main-button"},{default:k(()=>{var t;return[e("span",we,r((t=m(u))==null?void 0:t.totalUsers),1),s[2]||(s[2]=g(" Total Employees "))]}),_:1,__:[2]}),b(v,{to:{name:"TodayAttendanceReport",query:{status:"Present"}},class:"main-button"},{default:k(()=>{var t;return[e("span",De,r((t=m(u))==null?void 0:t.todayPresents),1),s[3]||(s[3]=g(" Today Present "))]}),_:1,__:[3]}),b(v,{to:{name:"TodayAttendanceReport",query:{status:"Absent"}},class:"main-button"},{default:k(()=>{var t;return[e("span",Ce,r((t=m(u))==null?void 0:t.todayAbsents),1),s[4]||(s[4]=g(" Today Absent "))]}),_:1,__:[4]}),b(v,{to:{name:"LeaveApplicationsForDay",query:{applicationType:"today"}},class:"main-button"},{default:k(()=>{var t;return[e("span",Le,r((t=m(u))==null?void 0:t.todayLeaves),1),s[5]||(s[5]=g(" Today Leave "))]}),_:1,__:[5]}),b(v,{to:{name:"LeaveApplicationsForDay",query:{applicationType:"tomorrow"}},class:"main-button"},{default:k(()=>{var t;return[e("span",$e,r((t=m(u))==null?void 0:t.tomorrowLeaves),1),s[6]||(s[6]=g(" Tomorrow Leave "))]}),_:1,__:[6]}),b(v,{to:{name:"DateWiseShortLeaveList",query:{date:m(a)}},class:"main-button"},{default:k(()=>{var t;return[e("span",Te,r((t=m(u))==null?void 0:t.todayShortLeaves),1),s[7]||(s[7]=g(" Today Short Leaves "))]}),_:1,__:[7]},8,["to"]),b(v,{to:{name:"DailyLateAttendanceReport",query:{date:m(a)}},class:"main-button"},{default:k(()=>{var t;return[e("span",Se,r((t=m(u))==null?void 0:t.todayLateEntries),1),s[8]||(s[8]=g(" Today Late Report "))]}),_:1,__:[8]},8,["to"]),b(v,{to:{name:"PreviousAfterApplicationList",query:{applicationType:"prev",date:m(a)}},class:"main-button"},{default:k(()=>{var t;return[e("span",Ae,r((t=m(u))==null?void 0:t.prevWeekLeaves),1),s[9]||(s[9]=g(" Leave history of previousÂ week "))]}),_:1,__:[9]},8,["to"]),b(v,{to:{name:"PreviousAfterApplicationList",query:{applicationType:"after",date:m(a)}},class:"main-button"},{default:k(()=>{var t;return[e("span",Me,r((t=m(u))==null?void 0:t.nextWeekLeaves),1),s[10]||(s[10]=g(" Upcoming leaves "))]}),_:1,__:[10]},8,["to"])])):(n(),i("div",Re,[e("div",Pe,[e("div",Be,[e("div",qe,[s[14]||(s[14]=e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Applications")],-1)),(n(!0),i(S,null,A((d=m(o))==null?void 0:d.current_month_leave,t=>(n(),B(v,{to:{name:"MyLeaveApplicationShow",params:{id:t.id}},key:t.id},{default:k(()=>[e("div",Ne,[e("h3",Ue," Leave Application #"+r(t.id),1),e("p",{class:M(["text-sm font-medium flex items-center space-x-2",{"bg-gray-500 py-1.5 rounded-full px-4 text-white":t.status===null,"bg-yellow-500 py-1.5 rounded-full px-4 text-white":t.status==="Pending","bg-green-500 py-1.5 rounded-full px-4 text-white":t.status==="approved"}])},[t.status===null?(n(),i("span",Ve,s[11]||(s[11]=[e("i",{class:"fas fa-clock mr-2"},null,-1),g(" Wait for Hanover ")]))):t.status==="Pending"?(n(),i("span",je,s[12]||(s[12]=[e("i",{class:"fas fa-hourglass-half mr-2"},null,-1),g(" Pending ")]))):(n(),i("span",Fe,s[13]||(s[13]=[e("i",{class:"fas fa-check-circle mr-2"},null,-1),g(" Approved ")])))],2)])]),_:2},1032,["to"]))),128))]),s[20]||(s[20]=e("div",{class:"flex justify-between items-start mb-4"},[e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Notices")])],-1)),e("div",Oe,[(n(!0),i(S,null,A(m(o).notices,(t,h)=>(n(),i("div",{key:h,class:"flex items-center justify-between p-4 border rounded-lg shadow-sm hover:shadow transition-all bg-white"},[e("div",ze,[e("div",{class:M([["rounded-full",t.user_feedback?"bg-green-100":"bg-red-100"],"h-8 w-8 flex items-center justify-center rounded-full"])},[t.user_feedback?(n(),i("span",Ee,s[15]||(s[15]=[e("i",{class:"far fa-check text-green-600"},null,-1)]))):(n(),i("span",We)),e("div",Ie,r(t.user_feedback?"Feedback Submitted":"Feedback Pending"),1)],2),e("div",null,[e("p",He,r(t.title),1),e("p",Ye,r(t.published_at),1)])]),b(v,{to:t.type===1?`/notice-details/${t.id}`:`/policy-details/${t.id}`,class:"text-blue-600 hover:text-blue-800 font-semibold text-sm"},{default:k(()=>s[16]||(s[16]=[g(" View ")])),_:2,__:[16]},1032,["to"])]))),128)),x.value?(n(),B(O,{key:0,show:!0,onClose:s[1]||(s[1]=t=>x.value=null)},{default:k(()=>[e("div",Ke,[s[17]||(s[17]=e("i",{class:"fas fa-bell text-blue-500"},null,-1)),g(" "+r(x.value.title),1)]),e("div",Ge,[e("p",Je,[s[18]||(s[18]=e("i",{class:"fas fa-calendar-alt text-gray-400"},null,-1)),g(" Published: "+r(x.value.published_at),1)]),s[19]||(s[19]=e("p",{class:"text-base text-gray-700 leading-relaxed"}," You must read this notice before proceeding. ",-1)),e("div",Qe,[e("button",{onClick:s[0]||(s[0]=t=>x.value=null),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-5 py-2 rounded-lg transition"}," Cancel "),e("button",{onClick:q,class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2.5 rounded-lg shadow transition"}," Read Details ")])])]),_:1})):T("",!0)])]),e("div",Xe,[s[22]||(s[22]=e("h2",{class:"text-xl font-semibold py-3 px-4"},"Leave Balance",-1)),e("div",Ze,[e("table",et,[s[21]||(s[21]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"Type"),e("th",{scope:"col",class:"px-6 py-3"},"Total Days"),e("th",{scope:"col",class:"px-6 py-3"},"Used Days"),e("th",{scope:"col",class:"px-6 py-3"},"Remaining Days")])],-1)),e("tbody",null,[(n(!0),i(S,null,A((c=m(o))==null?void 0:c.leave_balance,t=>(n(),i("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[e("td",tt,r(t.leave_type),1),e("td",st,r(t.annual_quota),1),e("td",at,r(t.used_days),1),e("td",ot,r(t.remaining_days),1)]))),128))])])])])]),e("div",lt,[b(_e)])]))])}}};export{gt as default};
