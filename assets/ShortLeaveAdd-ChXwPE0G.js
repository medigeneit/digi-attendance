import{u as M,r as p,n as w,b as _,c as o,a as t,k as x,l as q,w as D,d as n,v as i,z as c,e as f,F,q as B,h as H,t as S,m as C,o as a,j as E,g as N}from"./index-AYxz4H6X.js";import{u as R}from"./short-leave-9OUdjNah.js";import{u as j}from"./user-DA5a8iXc.js";import{L as A}from"./LoaderView-CtV-Y6Be.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const I={class:"max-w-3xl mx-auto p-4 space-y-4"},$={class:"flex items-center justify-between gap-2"},h={key:0,class:"text-center"},z={key:0},O={key:1},W=["value"],G={key:2,class:"text-red-500 text-sm"},Z={__name:"ShortLeaveAdd",setup(J){const y=N(),L=R(),b=j(),d=M(),T=new Date().toISOString().split("T")[0],s=p({date:T,start_time:"",end_time:"",reason:"",works_in_hand:"",handover_user_id:"",type:""}),m=p(!1),u=p(null),U=w(()=>{if(s.value.start_time&&s.value.end_time){const r=new Date(`1970-01-01T${s.value.start_time}:00`),v=new Date(`1970-01-01T${s.value.end_time}:00`)-r;return Math.round(v/(1e3*60))}return 0}),k=w(()=>U.value>30),V=async()=>{var r;m.value=!0,u.value=null;try{const e={user_id:(r=d==null?void 0:d.user)==null?void 0:r.id,...s.value};await L.createShortLeave(e),alert("Short leave application submitted successfully!"),y.push({name:"MyShortLeaves"})}catch(e){u.value=e.message||"Failed to submit short leave application"}finally{m.value=!1}};_(()=>{b.fetchUsers()});const g=()=>{y.go(-1)};return(r,e)=>{const v=C("RouterLink");return a(),o("div",I,[t("div",$,[t("button",{class:"btn-3",onClick:g},e[7]||(e[7]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[9]||(e[9]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Short Leave Application Form",-1)),t("div",null,[x(v,{to:"/",class:"btn-2"},{default:q(()=>e[8]||(e[8]=[E("Home")])),_:1})])]),m.value?(a(),o("div",h,[x(A)])):(a(),o("form",{key:1,onSubmit:D(V,["prevent"]),class:"space-y-4 card-bg md:p-8 p-4"},[t("div",null,[e[10]||(e[10]=t("label",{for:"date",class:"block text-sm font-medium"},"Date",-1)),n(t("input",{type:"date",id:"date","onUpdate:modelValue":e[0]||(e[0]=l=>s.value.date=l),class:"input-1 w-full",required:""},null,512),[[i,s.value.date]])]),t("div",null,[e[12]||(e[12]=t("label",{for:"type",class:"block text-sm font-medium"},"Type",-1)),n(t("select",{id:"type","onUpdate:modelValue":e[1]||(e[1]=l=>s.value.type=l),class:"input-1 w-full",required:""},e[11]||(e[11]=[t("option",{value:""},"Select Type",-1),t("option",{value:"First"},"First",-1),t("option",{value:"Middle"},"Middle",-1),t("option",{value:"Last"},"Last",-1)]),512),[[c,s.value.type]])]),t("div",null,[e[13]||(e[13]=t("label",{for:"start-time",class:"block text-sm font-medium"},"Start Time",-1)),n(t("input",{type:"time",id:"start-time","onUpdate:modelValue":e[2]||(e[2]=l=>s.value.start_time=l),class:"input-1 w-full",required:""},null,512),[[i,s.value.start_time]])]),t("div",null,[e[14]||(e[14]=t("label",{for:"end-time",class:"block text-sm font-medium"},"End Time",-1)),n(t("input",{type:"time",id:"end-time","onUpdate:modelValue":e[3]||(e[3]=l=>s.value.end_time=l),class:"input-1 w-full",required:""},null,512),[[i,s.value.end_time]])]),t("div",null,[e[15]||(e[15]=t("label",{for:"reason",class:"block text-sm font-medium"},"Reason",-1)),n(t("textarea",{id:"reason","onUpdate:modelValue":e[4]||(e[4]=l=>s.value.reason=l),class:"input-1 w-full",placeholder:"Enter your reason for leave",required:""},null,512),[[i,s.value.reason]])]),k.value?(a(),o("div",z,[e[16]||(e[16]=t("label",{for:"works-in-hand",class:"block text-sm font-medium"},"Works in Hand",-1)),n(t("textarea",{id:"works-in-hand","onUpdate:modelValue":e[5]||(e[5]=l=>s.value.works_in_hand=l),class:"input-1 w-full",placeholder:"Enter details of works in hand"},null,512),[[i,s.value.works_in_hand]])])):f("",!0),k.value?(a(),o("div",O,[e[18]||(e[18]=t("label",{for:"handover-user",class:"block text-sm font-medium"},"Handover User",-1)),n(t("select",{id:"handover-user","onUpdate:modelValue":e[6]||(e[6]=l=>s.value.handover_user_id=l),class:"input-1 w-full",required:""},[e[17]||(e[17]=t("option",{value:""},"Select Handover User",-1)),(a(!0),o(F,null,B(H(b).users,l=>(a(),o("option",{key:l.id,value:l.id},S(l.name),9,W))),128))],512),[[c,s.value.handover_user_id]])])):f("",!0),u.value?(a(),o("div",G,S(u.value),1)):f("",!0),e[19]||(e[19]=t("div",{class:"flex justify-center"},[t("button",{type:"submit",class:"btn-2"},"Submit")],-1))],32))])}}};export{Z as default};
