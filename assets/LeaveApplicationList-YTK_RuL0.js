import{u as D,b as M,d as N,y as T,r as i,e as j,x as w,m as F,z as E,c as y,o as a,a as e,q as c,k as v,h as A,v as P,C as H,g as k,F as $,n as z,t as u,f as W,i as L}from"./index-D9IEX7DE.js";import{_ as G}from"./EmployeeFilter-Ca3ZoABE.js";import{L as I}from"./LoaderView-BmbnyFUa.js";import{u as J}from"./leave-application-BqQy5qgb.js";import{u as K}from"./user-C1oOsaUK.js";import"./MultiselectDropdown-C1SgkTOl.js";import"./company-CqJ1XfCM.js";import"./department-27-mR-EF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"space-y-2 px-4"},Q={class:"flex flex-wrap gap-2"},X={key:0,class:"text-center py-4"},Y={key:1,class:"space-y-4"},Z={class:"overflow-x-auto"},ee={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},te={class:"border border-gray-300 px-2"},se={class:"border border-gray-300 px-2"},re={class:"border border-gray-300 px-2"},oe={class:"border border-gray-300 px-2"},de={class:"border border-gray-300 px-2"},le={class:"border border-gray-300 px-2"},ae=["innerHTML"],ue={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},ye={class:"border border-gray-300 px-2"},me={class:"flex justify-center gap-2"},ve=["onClick"],ie={key:0},Le={__name:"LeaveApplicationList",setup(_e){const _=D(),o=M(),d=J(),b=K(),S=N(),{leaveApplications:q,loading:f}=T(d),C=i(null),m=i(o.query.date||d.selectedMonth),V=i(o.query.search||""),r=i({company_id:o.query.company_id||"",department_id:o.query.department_id||"all",type:o.query.type||"all",employee_id:o.query.employee_id||"",category:""}),n=async()=>{const l={company_id:r.value.company_id,department_id:r.value.department_id,selectedDate:m.value,selectedStatus:d.selectedStatus,query:V.value};r.value.employee_id&&(l.user_id=r.value.employee_id),f.value=!0,await d.fetchLeaveApplications(l),f.value=!1};j(async()=>{r.value.employee_id&&(await b.fetchUser(r.value.employee_id),C.value=b.user||null),await n()}),w(()=>[r.value.company_id,r.value.department_id,r.value.employee_id,m.value],async()=>{await n()}),w(()=>m.value,l=>{_.replace({query:{...o.query,date:l}}),n()});const g=F(()=>q.value||[]),R=async l=>{confirm("Are you sure to delete this application?")&&(await d.deleteLeaveApplication(l),await n())},U=()=>_.go(-1),B=()=>{_.replace({query:{...o.query,company_id:r.value.company_id,department_id:r.value.department_id,type:r.value.type,employee_id:r.value.employee_id}})};return(l,s)=>{const x=E("RouterLink");return a(),y("div",O,[e("div",{class:"flex items-center justify-between gap-2"},[e("button",{class:"btn-3",onClick:U},s[3]||(s[3]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),s[4]||(s[4]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Leave Applications",-1)),s[5]||(s[5]=e("div",null,null,-1))]),e("div",Q,[c(G,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=t=>r.value=t),"initial-value":v(o).query,onFilterChange:B},null,8,["modelValue","initial-value"]),e("div",null,[A(e("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[1]||(s[1]=t=>m.value=t),onChange:n,class:"input-1"},null,544),[[P,m.value]])]),e("div",null,[A(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>v(d).selectedStatus=t),onChange:n,class:"input-1"},s[6]||(s[6]=[e("option",{value:"",selected:""},"All",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Approved"},"Approved",-1),e("option",{value:"Rejected"},"Rejected",-1)]),544),[[H,v(d).selectedStatus]])])]),v(d).loading?(a(),y("div",X,[c(I)])):(a(),y("div",Y,[e("div",Z,[e("table",ee,[s[11]||(s[11]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-300 px-2 text-left"},"#"),e("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),e("th",{class:"border border-gray-300 px-2 text-left"},"Last Working Day"),e("th",{class:"border border-gray-300 px-2 text-left"},"Resumption Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Leave Period"),e("th",{class:"border border-gray-300 px-2 text-left"},"Total Days"),e("th",{class:"border border-gray-300 px-2 text-left"},"Type"),e("th",{class:"border border-gray-300 px-2 text-left"},"Status"),e("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),e("tbody",null,[(a(!0),y($,null,z(g.value,(t,h)=>{var p;return a(),y("tr",{key:h,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",te,u(h+1),1),e("td",se,u(((p=t==null?void 0:t.user)==null?void 0:p.name)||"Unknown"),1),e("td",re,u(t==null?void 0:t.last_working_date),1),e("td",oe,u(t==null?void 0:t.resumption_date),1),e("td",de,u(t==null?void 0:t.leave_period),1),e("td",le,[e("div",{innerHTML:t.duration||(t==null?void 0:t.total_leave_days)},null,8,ae)]),e("td",ue,u(t==null?void 0:t.application_types),1),e("td",ne,u((t==null?void 0:t.status)||"N/A"),1),e("td",ye,[e("div",me,[c(x,{to:{name:"LeaveApplicationShow",params:{id:t==null?void 0:t.id}},class:"btn-icon"},{default:L(()=>s[7]||(s[7]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[7]},1032,["to"]),v(S).user.role==="super_admin"||(t==null?void 0:t.status)!=="Approved"?(a(),W(x,{key:0,to:{name:"LeaveApplicationEdit",params:{id:t==null?void 0:t.id}},class:"btn-icon"},{default:L(()=>s[8]||(s[8]=[e("i",{class:"far fa-edit text-orange-600"},null,-1)])),_:2,__:[8]},1032,["to"])):k("",!0),e("button",{onClick:ce=>R(t==null?void 0:t.id),class:"btn-icon text-red-500"},s[9]||(s[9]=[e("i",{class:"far fa-trash"},null,-1)]),8,ve)])])])}),128)),g.value.length?k("",!0):(a(),y("tr",ie,s[10]||(s[10]=[e("td",{colspan:"7",class:"p-1 text-center text-red-500"},"No application found",-1)])))])])])]))])}}};export{Le as default};
