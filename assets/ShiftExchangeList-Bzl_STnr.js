import{u as G,f as H,r as m,x as I,D as T,h as Y,q as U,p as z,c as d,o as i,a as e,d as _,l as A,k as J,m as u,H as K,j as M,F as Q,e as W,t as n}from"./index-CntMW3dQ.js";import{_ as X}from"./EmployeeFilter-Xo9J_Dcs.js";import{L as Z}from"./LoaderView-JTCkriDB.js";import{_ as ee}from"./FlexibleDatePicker-0xwL-vq-.js";import{u as te}from"./exchange-cWUqjRg9.js";import{u as re}from"./user-XHBHUD_U.js";import"./company-Cgai5JMt.js";import"./department-Cskt7E8P.js";import"./EmployeeDropdownInput-Bl6zBQJ3.js";import"./SelectDropdown-XBMCWIxZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-DM2qwj35.js";const oe={class:"space-y-2 px-4"},se={class:"grid md:flex gap-4 p-2"},le={class:"relative"},ae={key:0,class:"text-center py-4"},de={key:1,class:"space-y-4"},ie={class:"overflow-x-auto"},ne={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},pe={class:"border border-gray-300 px-2"},ue={class:"border border-gray-300 px-2"},ye={class:"border border-gray-300 px-2 text-center"},me={class:"border border-gray-300 px-2 text-center"},_e={class:"border border-gray-300 px-2"},fe={class:"border border-gray-300 px-2"},ce={class:"border border-gray-300 px-2 text-center"},be=["href"],ve={class:"border border-gray-300 px-2"},we={class:"border border-gray-300 px-2"},Se={class:"flex gap-2"},ke=["onClick"],he={key:0},N="shift",$e={__name:"ShiftExchangeList",setup(ge){const f=G(),a=H(),l=te(),v=re(),V=m(null),c=a.query.date||l.selectedMonth||new Date().toISOString().slice(0,7),b=m(c),w=new Date,B=s=>s.toString().padStart(2,"0"),p=m({year:Number(c.split("-")[0]||w.getFullYear()),month:Number(c.split("-")[1]||w.getMonth()+1),day:1}),L=I(()=>{var s,r;return!((s=p.value)!=null&&s.year)||!((r=p.value)!=null&&r.month)?"":`${p.value.year}-${B(p.value.month)}`}),{loading:R}=T(l),o=m({company_id:a.query.company_id||"",department_id:a.query.department_id||"all",line_type:a.query.line_type||"all",type:a.query.type||"all",employee_id:a.query.employee_id||"",line_type:""});Y(async()=>{R.value=!0,await v.fetchUsers(),V.value=v.users.find(s=>{var r;return s.id==((r=a==null?void 0:a.query)==null?void 0:r.employee_id)}),await y()});const y=async()=>{o.value.employee_id?await l.fetchAllExchanges({company_id:o.value.company_id,department_id:o.value.department_id,user_id:o.value.employee_id,line_type:o.value.line_type,type:N,selectedMonth:b.value,selectedStatus:l.selectedStatus}):await l.fetchAllExchanges({company_id:o.value.company_id,department_id:o.value.department_id,line_type:o.value.line_type,type:N,selectedMonth:b.value,selectedStatus:l.selectedStatus})};U(()=>[o.value.company_id,o.value.department_id,o.value.employee_id,o.value.line_type],async()=>{await y()}),U(L,s=>{s&&(b.value=s,f.replace({query:{...a.query,date:s}}),y())},{immediate:!0});const $=()=>{f.go(-1)},F=async s=>{confirm("Are you sure to delete this application?")&&l.deleteExchange(s)},j=()=>{f.replace({query:{...a.query,company_id:o.value.company_id,department_id:o.value.department_id,line_type:o.value.line_type,employee_id:o.value.employee_id}})},S=s=>s?new Date(s).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"";return(s,r)=>{var k,h,g;const O=z("RouterLink");return i(),d("div",oe,[e("div",{class:"flex items-center justify-between gap-2"},[e("button",{class:"btn-3",onClick:$},r[6]||(r[6]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),r[7]||(r[7]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Shift Exchanges",-1)),r[8]||(r[8]=e("div",null,null,-1))]),e("div",se,[_(X,{company_id:o.value.company_id,"onUpdate:company_id":r[1]||(r[1]=t=>o.value.company_id=t),department_id:o.value.department_id,"onUpdate:department_id":r[2]||(r[2]=t=>o.value.department_id=t),employee_id:o.value.employee_id,"onUpdate:employee_id":r[3]||(r[3]=t=>o.value.employee_id=t),line_type:o.value.line_type,"onUpdate:line_type":r[4]||(r[4]=t=>o.value.line_type=t),"with-type":!0,"initial-value":s.$route.query,onFilterChange:j},{default:A(()=>[e("div",null,[r[10]||(r[10]=e("label",{for:"",class:"top-label -top-1"},"Status ",-1)),J(e("select",{"onUpdate:modelValue":r[0]||(r[0]=t=>u(l).selectedStatus=t),onChange:y,class:"input-1 py-0.5 text-center"},r[9]||(r[9]=[e("option",{value:"",selected:""},"All",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Approved"},"Approved",-1),e("option",{value:"Rejected"},"Rejected",-1)]),544),[[K,u(l).selectedStatus]])])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"]),e("div",le,[r[11]||(r[11]=e("label",{for:"",class:"top-label -top-1"},"Month",-1)),_(ee,{modelValue:p.value,"onUpdate:modelValue":r[5]||(r[5]=t=>p.value=t),"show-year":!1,"show-month":!0,"show-date":!1},null,8,["modelValue"])])]),u(l).loading?(i(),d("div",ae,[_(Z)])):(i(),d("div",de,[e("div",ie,[e("table",ne,[r[16]||(r[16]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-300 px-2 text-left"},"#"),e("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),e("th",{class:"border border-gray-300 px-2"},"Created Date"),e("th",{class:"border border-gray-300 px-2"},"Exchange Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Current Shift"),e("th",{class:"border border-gray-300 px-2 text-left"},"Exchange Shift"),e("th",{class:"border border-gray-300 px-2 text-left"},"Attachment"),e("th",{class:"border border-gray-300 px-2 text-left"},"Status"),e("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),e("tbody",null,[(i(!0),d(Q,null,W((k=u(l))==null?void 0:k.all_exchanges,(t,P)=>{var q,E,x,C,D;return i(),d("tr",{key:t==null?void 0:t.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",pe,n(P+1),1),e("td",ue,n(((q=t==null?void 0:t.user)==null?void 0:q.name)||"Unknown"),1),e("td",ye,n(S(t==null?void 0:t.created_at)),1),e("td",me,n(S(t==null?void 0:t.exchange_date)),1),e("td",_e,n((C=(x=(E=t==null?void 0:t.user)==null?void 0:E.current_shift)==null?void 0:x.shift)==null?void 0:C.name),1),e("td",fe,n((D=t==null?void 0:t.shift)==null?void 0:D.name),1),e("td",ce,[t.attachment?(i(),d("a",{key:0,href:t==null?void 0:t.attachment,target:"_blank",class:"text-blue-500 underline"},r[12]||(r[12]=[e("i",{class:"fad fa-link"},null,-1)]),8,be)):M("",!0)]),e("td",ve,n((t==null?void 0:t.status)||"N/A"),1),e("td",we,[e("div",Se,[_(O,{to:{name:"ExchangeShiftShow",params:{id:t==null?void 0:t.id}},class:"btn-icon"},{default:A(()=>r[13]||(r[13]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[13]},1032,["to"]),e("button",{onClick:qe=>F(t==null?void 0:t.id),class:"btn-icon text-red-500"},r[14]||(r[14]=[e("i",{class:"far fa-trash"},null,-1)]),8,ke)])])])}),128)),((g=(h=u(l))==null?void 0:h.all_exchanges)==null?void 0:g.length)===0?(i(),d("tr",he,r[15]||(r[15]=[e("td",{colspan:"6",class:"p-2 text-center text-red-500"},"No shift exchanges found",-1)]))):M("",!0)])])])]))])}}};export{$e as default};
