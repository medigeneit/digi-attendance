import{r as C,q as H,x as b,c as i,o,a as t,N as g,j as c,t as d,b as B,d as Q,U as G,l as h,F as J,e as K,w as y,V as W,a5 as X,s as M,m as Y,O as Z}from"./index-BvQkN2MQ.js";import{s as _}from"./MultiselectDropdown.vue_vue_type_style_index_0_lang-B77pLl07.js";const ee={class:"w-full"},te={class:"mb-2 flex items-start justify-between gap-3"},le={class:"min-w-0"},se={key:0,class:"text-sm font-semibold text-slate-600"},ae={key:0,class:"text-xs text-slate-400"},re={class:"flex items-center gap-2"},ne={key:0,class:"whitespace-nowrap rounded-full bg-slate-100 px-2 py-0.5 text-[11px] font-medium text-slate-500"},ie={class:"sticky top-0 z-10 border-b border-gray-100 bg-white/95 px-2 pt-2 pb-2 backdrop-blur supports-[backdrop-filter]:bg-white/80"},oe={class:"relative"},ue=["placeholder"],de=["onClick"],ce={key:0,class:"mt-2 flex flex-wrap items-center gap-1 text-[11px] text-gray-600"},fe=["disabled"],he=["disabled"],me=["disabled"],be={class:"flex items-center justify-between gap-3"},ve={class:"truncate text-sm"},ye={key:0,class:"text-gray-400"},ge={class:"text-gray-700"},pe={key:0,class:"inline-flex items-center gap-1 rounded-full bg-indigo-50 px-2 py-0.5 text-[11px] font-semibold text-indigo-600"},xe=["title"],we={key:0},ke={class:"flex flex-wrap items-center gap-1"},Se=["onClick"],Ce={key:0,class:"text-xs text-gray-500"},Be={key:1,class:"ml-1 text-[11px] text-gray-400"},Le={class:"px-3 py-2 text-sm text-gray-500"},Ve={class:"px-3 py-2 text-sm text-gray-500"},ze={class:"mt-1 flex items-center justify-between text-xs"},He={key:0,class:"text-gray-500"},Me={key:0,class:"text-red-600 ml-auto"},Oe={key:1,class:"text-emerald-600 ml-auto"},Te={__name:"MultiselectDropdown",props:{modelValue:{type:[Number,Array,Object,String,null],default:null},options:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},clearOnSelect:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},maxHeight:{type:Number,default:240},label:{type:String,default:"name"},labelPrefix:{type:String,default:""},trackBy:{type:String,default:"id"},placeholder:{type:String,default:"Select…"},searchPlaceholder:{type:String,default:"Search..."},size:{type:String,default:"md"},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},error:{type:[Boolean,String],default:!1},success:{type:Boolean,default:!1},help:{type:String,default:""},labelText:{type:String,default:""},labelHint:{type:String,default:""},chipLimit:{type:Number,default:2},showCounter:{type:Boolean,default:!0},showToolbar:{type:Boolean,default:!0},enableSelectVisible:{type:Boolean,default:!0},noOptionsText:{type:String,default:"No options"},noResultText:{type:String,default:"No results found"}},emits:["update:modelValue","select","remove","open","close","search-change","clear"],setup(s,{emit:O}){const r=s,m=O,n=C(r.modelValue);H(()=>r.modelValue,e=>{n.value=e}),H(n,e=>m("update:modelValue",e));const v=e=>e?(e==null?void 0:e[r.label])??(e==null?void 0:e.title)??(e==null?void 0:e.name)??(e==null?void 0:e.id)??"":"",f=e=>(e==null?void 0:e[r.trackBy])??e,$=e=>e?r.multiple?(n.value||[]).some(l=>f(l)===f(e)):f(n.value)===f(e):!1,x=C(!1),w=C(""),p=b(()=>r.multiple?Array.isArray(n.value)&&n.value.length>0:!!n.value),N=b(()=>{var e;return p.value?r.multiple?((e=n.value)==null?void 0:e.length)||0:1:0}),L=b(()=>p.value?r.multiple?`${N.value} selected`:v(n.value):""),T=()=>{x.value=!0,m("open")},A=()=>{x.value=!1,m("close")},V=b(()=>{if(!r.multiple)return!1;const e=r.options||[],l=n.value||[];return e.length?l.length===e.length:!1}),z=()=>{n.value=r.multiple?[]:null,m("clear")},P=()=>{r.multiple&&(n.value=V.value?[]:[...r.options])},j=()=>{if(!r.multiple)return;const e=new Map((n.value||[]).map(l=>[f(l),!0]));n.value=(r.options||[]).filter(l=>!e.get(f(l)))},R=e=>{r.multiple&&(n.value=(n.value||[]).filter(l=>f(l)!==f(e)))},U=()=>{if(!r.multiple)return;const e=w.value.trim().toLowerCase();if(!e)return;const l=(r.options||[]).filter(u=>String(v(u)).toLowerCase().includes(e)),a=new Map((n.value||[]).map(u=>[f(u),u]));for(const u of l)a.set(f(u),u);n.value=Array.from(a.values())},D=e=>{w.value=e||"",m("search-change",e)},F=b(()=>{switch(r.size){case"sm":return"text-sm py-1";case"lg":return"text-base py-2";default:return"text-sm py-1.5"}}),I=b(()=>r.error?"ring-1 ring-red-400 border-red-400":r.success?"ring-1 ring-emerald-400 border-emerald-400":"border-gray-300 focus-within:ring-2 focus-within:ring-indigo-500"),q=b(()=>({"--multi-max-height":`${r.maxHeight||240}px`}));return(e,l)=>(o(),i("div",ee,[t("div",te,[t("div",le,[g(e.$slots,"label",{},()=>[s.labelText?(o(),i("p",se,d(s.labelText),1)):c("",!0)]),s.labelHint?(o(),i("p",ae,d(s.labelHint),1)):c("",!0)]),t("div",re,[L.value?(o(),i("span",ne,d(L.value),1)):c("",!0),s.clearable&&p.value?(o(),i("button",{key:1,type:"button",class:"inline-flex items-center gap-1 rounded-full border border-slate-200 px-2 py-0.5 text-xs font-semibold text-slate-500 transition hover:border-slate-300 hover:text-slate-700 disabled:opacity-50",onClick:l[0]||(l[0]=a=>z())},l[5]||(l[5]=[t("svg",{class:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 8.586l4.95-4.95a1 1 0 1 1 1.414 1.414L11.414 10l4.95 4.95a1 1 0 0 1-1.414 1.414L10 11.414l-4.95 4.95a1 1 0 1 1-1.414-1.414L8.586 10l-4.95-4.95A1 1 0 1 1 5.05 3.636L10 8.586z","clip-rule":"evenodd"})],-1),B(" Clear ")]))):c("",!0)])]),t("div",{class:"relative",style:Z(q.value)},[Q(Y(_),{modelValue:n.value,"onUpdate:modelValue":l[2]||(l[2]=a=>n.value=a),options:s.options,multiple:s.multiple,"track-by":s.trackBy,label:s.label,searchable:s.searchable,"clear-on-select":s.clearOnSelect,"close-on-select":!s.multiple,"allow-empty":!0,"internal-search":!0,loading:s.loading,"show-no-results":!0,"max-height":s.maxHeight,placeholder:s.placeholder,disabled:s.disabled,onSelect:l[3]||(l[3]=(a,u)=>m("select",a,u)),onRemove:l[4]||(l[4]=(a,u)=>m("remove",a,u)),onOpen:T,onClose:A,onSearchChange:D,class:M(["w-full",["smart-multi",F.value,I.value,s.disabled?"opacity-60 cursor-not-allowed":"cursor-pointer"]])},G({caret:h(()=>[(o(),i("svg",{class:M(["h-4 w-4 text-gray-500 mr-2 transition-transform",{"rotate-180":x.value}]),viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},l[6]||(l[6]=[t("path",{"fill-rule":"evenodd",d:"M10 12a1 1 0 0 1-.7-.29l-4-4a1 1 0 1 1 1.4-1.42L10 9.59l3.3-3.3a1 1 0 1 1 1.4 1.42l-4 4A1 1 0 0 1 10 12z","clip-rule":"evenodd"},null,-1)]),2))]),search:h(({search:a,attributes:u,events:k})=>{var S;return[t("div",ie,[t("div",oe,[l[8]||(l[8]=t("svg",{class:"absolute left-2 top-2.5 h-4 w-4 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M13.293 14.707a8 8 0 1 1 1.414-1.414l3.5 3.5a1 1 0 0 1-1.414 1.414l-3.5-3.5zM8 14a6 6 0 1 0 0-12 6 6 0 0 0 0 12z","clip-rule":"evenodd"})],-1)),t("input",W({class:"w-full pl-8 pr-8 py-2 rounded-md border border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500"},u,X(k,!0),{placeholder:s.searchPlaceholder||"Search..."}),null,16,ue),a?(o(),i("button",{key:0,type:"button",class:"absolute right-2 top-2 h-6 w-6 inline-flex items-center justify-center rounded hover:bg-gray-100",onClick:y(E=>k.input({target:{value:""}}),["stop"]),"aria-label":"Clear search"},l[7]||(l[7]=[t("svg",{class:"h-4 w-4 text-gray-500",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 8.586l4.243-4.243a1 1 0 1 1 1.414 1.414L11.414 10l4.243 4.243a1 1 0 0 1-1.414 1.414L10 11.414l-4.243 4.243a1 1 0 0 1-1.414-1.414L8.586 10 4.343 5.757a1 1 0 0 1 1.414-1.414L10 8.586z","clip-rule":"evenodd"})],-1)]),8,de)):c("",!0)]),s.multiple&&s.showToolbar?(o(),i("div",ce,[t("button",{type:"button",class:"btn-chip",onClick:y(P,["stop"])},[l[9]||(l[9]=t("svg",{class:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M16 3H4a2 2 0 00-2 2v5h2V5h12v10H4v-2H2v2a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2z"}),t("path",{d:"M5 9l3 3 5-6 1.5 1.2L8 14 3.5 9.5 5 9z"})],-1)),t("span",null,d(V.value?"Unselect all":"Select all"),1)]),t("button",{type:"button",class:"btn-chip",disabled:!p.value,onClick:l[1]||(l[1]=y(E=>z(),["stop"]))},l[10]||(l[10]=[t("svg",{class:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M6 7h8v10a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2V7zm2-4h4l1 1h3a1 1 0 1 1 0 2H4a1 1 0 1 1 0-2h3l1-1z"})],-1),t("span",null,"Clear",-1)]),8,fe),t("button",{type:"button",class:"btn-chip",disabled:!((S=s.options)!=null&&S.length),onClick:y(j,["stop"])},l[11]||(l[11]=[t("svg",{class:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M4 4h12v2H4V4zm0 5h8v2H4V9zm0 5h12v2H4v-2z"})],-1),t("span",null,"Invert",-1)]),8,he),s.enableSelectVisible?(o(),i("button",{key:0,type:"button",class:"btn-chip",disabled:!w.value,onClick:y(U,["stop"]),title:"Select items matching current search"},l[12]||(l[12]=[t("svg",{class:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{d:"M8 12l-3-3 1.414-1.414L8 9.172l5.586-5.586L15 5z"})],-1),t("span",null,"Select visible",-1)]),8,me)):c("",!0)])):c("",!0)])]}),option:h(({option:a})=>[g(e.$slots,"option",{option:a},()=>[t("div",be,[t("span",ve,[s.labelPrefix?(o(),i("span",ye,d(a==null?void 0:a[s.labelPrefix])+" - ",1)):c("",!0),t("span",ge,d(v(a)),1)]),$(a)?(o(),i("span",pe,l[13]||(l[13]=[t("span",{class:"h-1.5 w-1.5 rounded-full bg-current"},null,-1),B(" Selected ")]))):c("",!0)])])]),singleLabel:h(({option:a})=>[g(e.$slots,"singleLabel",{option:a},()=>[t("div",{class:"line-clamp-1",title:v(a)},[s.labelPrefix?(o(),i("span",we,d(a==null?void 0:a[s.labelPrefix])+" - ",1)):c("",!0),t("span",null,d(v(a)),1)],8,xe)])]),spinner:h(()=>[l[14]||(l[14]=t("svg",{class:"animate-spin h-4 w-4 text-gray-500 mr-2",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"3",fill:"none"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 0 1 8-8v3a5 5 0 0 0-5 5H4z"})],-1))]),noOptions:h(()=>[t("div",Le,d(s.noOptionsText),1)]),noResult:h(()=>[t("div",Ve,d(s.noResultText),1)]),_:2},[s.multiple?{name:"selection",fn:h(({values:a})=>[g(e.$slots,"selection",{values:a},()=>[t("div",ke,[(o(!0),i(J,null,K(a.slice(0,s.chipLimit),(u,k)=>(o(),i("span",{key:f(u),class:"chip"},[B(d(v(u))+" ",1),t("button",{type:"button",class:"chip-x",onClick:y(S=>R(u),["stop"]),"aria-label":"Remove"},"×",8,Se)]))),128)),a.length>s.chipLimit?(o(),i("span",Ce,"+"+d(a.length-s.chipLimit)+" more",1)):c("",!0),s.showCounter&&a.length?(o(),i("span",Be,"("+d(a.length)+")",1)):c("",!0)])])]),key:"0"}:void 0]),1032,["modelValue","options","multiple","track-by","label","searchable","clear-on-select","close-on-select","loading","max-height","placeholder","disabled","class"]),t("div",ze,[g(e.$slots,"help",{},()=>[s.help?(o(),i("p",He,d(s.help),1)):c("",!0)]),s.error?(o(),i("p",Me,d(typeof s.error=="string"?s.error:"Invalid selection"),1)):s.success?(o(),i("p",Oe,"Looks good")):c("",!0)])],4)]))}};export{Te as _};
