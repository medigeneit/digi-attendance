import{_ as Q}from"./EmployeeFilter-Da3rjbvm.js";import{L as X}from"./LoaderView-BMi3QEyj.js";import{_ as R}from"./DisplayFormattedWorkingHours-Bx-MU1G7.js";import{S as Z}from"./SelectedEmployeeCard-CKiFkN0D.js";import{_ as ee}from"./FlexibleDatePicker-C9SOo3rv.js";import{u as te}from"./leave-application-DSgzOT_h.js";import{u as se}from"./user-BILdUnSh.js";import{u as ae,f as le,r as A,x as B,q as N,h as ne,p as oe,c as d,o as i,a as e,j as re,i as ie,d as h,l as v,F as b,e as k,s as t,t as r,b as D,m as q}from"./index-Ocf9ygh3.js";import"./company-C9ZWhsNk.js";import"./department-BuF7wL4q.js";import"./EmployeeDropdownInput-BYx3pqqk.js";import"./SelectDropdown-DVIQl_9u.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-CVnLEvW9.js";const de={class:"px-4 space-y-4"},ce={class:"rounded-xl border bg-white p-3 md:p-4"},ue={class:"flex items-center gap-2"},pe={key:0,class:"flex"},he={key:2,class:"rounded-xl border bg-white p-10 text-center"},fe={key:3,class:"space-y-4"},ye={class:"flex flex-wrap items-center gap-2"},_e=["onClick"],me={class:"inline-flex h-5 min-w-5 items-center justify-center rounded-full bg-black/5 px-1 text-[12px] font-semibold"},xe={class:"rounded-xl border bg-white overflow-hidden"},ge={class:"border-b bg-slate-50 px-4 py-2.5 text-sm font-semibold text-slate-800"},ve={key:0,class:"overflow-x-auto"},be={key:1,class:"overflow-x-auto"},ke={class:"sticky top-0 bg-white/90 backdrop-blur border-b"},we={class:"text-xs uppercase text-slate-600"},Se={key:2,class:"overflow-x-auto"},Le={class:"sticky top-0 bg-white/90 backdrop-blur border-b"},Ce={class:"text-xs uppercase text-slate-600"},Ae=["href"],De={key:1,class:"text-slate-400"},qe={key:3,class:"overflow-x-auto"},Me={class:"sticky top-0 bg-white/90 backdrop-blur border-b"},Ve={class:"text-xs uppercase text-slate-600"},$e={key:4,class:"overflow-x-auto"},Ne={class:"sticky top-0 bg-white/90 backdrop-blur border-b"},Oe={class:"text-xs uppercase text-slate-600"},Re={key:5,class:"p-6 text-center text-slate-500"},M="min-w-full text-sm",l="px-3 py-2 text-left font-semibold text-slate-700 whitespace-nowrap",n="px-3 py-2 align-top text-slate-700",Qe={__name:"MonthWiseApplicationLog",setup(Be){var G;const w=ae(),f=le(),U=se(),y=te(),S=A(null),O=f.query.date||y.selectedMonth||new Date().toISOString().slice(0,7),x=A(O),V=new Date,I=o=>o.toString().padStart(2,"0"),T=o=>{if(!o)return{year:V.getFullYear(),month:V.getMonth()+1};const[a=V.getFullYear(),m=String(V.getMonth()+1)]=o.split("-");return{year:Number(a),month:Number(m)}},g=A({year:T(O).year,month:T(O).month,day:1}),P=B(()=>{var o,a;return!((o=g.value)!=null&&o.year)||!((a=g.value)!=null&&a.month)?"":`${g.value.year}-${I(g.value.month)}`}),c=A({company_id:f.query.company_id||"",department_id:f.query.department_id||"all",line_type:f.query.line_type||"all",employee_id:f.query.employee_id||"",category:""}),E={overtime:"Overtime",leave_application:"Leave Applications",short_leave:"Short Leave",exchange_offday:"Exchange Offday",exchange_shift:"Exchange Shift",manual_attendance:"Manual Attendance"},W=["overtime","leave_application","short_leave","exchange_offday","exchange_shift","manual_attendance"],$=B(()=>{const o=y.applicationLog||{};return W.filter(a=>Array.isArray(o[a])&&o[a].length).map(a=>({key:a,label:E[a]||a,count:o[a].length}))}),u=A(f.query.group||((G=$.value[0])==null?void 0:G.key)||null);N($,o=>{if(!o.length){u.value=null;return}o.find(a=>a.key===u.value)||(u.value=o[0].key)}),N(u,o=>{w.replace({query:{...f.query,group:o||void 0}})});const Y=B(()=>y.loading),F=async o=>{o?(await U.fetchUser(o),S.value=U.user):S.value=null},L=async()=>{c.value.employee_id&&x.value&&await y.getMonthlyApplicationLog(c.value.employee_id,x.value)};ne(async()=>{c.value.employee_id&&await F(c.value.employee_id),c.value.employee_id&&x.value&&await L()}),N(()=>c.value.employee_id,async o=>{o?(await F(o),x.value&&await L(),w.replace({query:{...f.query,employee_id:o}})):S.value=null},{immediate:!0}),N(P,o=>{o&&(x.value=o,w.replace({query:{...f.query,date:o}}),c.value.employee_id&&o&&L())},{immediate:!0});const z=()=>w.go(-1),H=o=>o?new Date(o).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A",j=o=>o?new Date(`1970-01-01T${o}`).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A",_=o=>o?new Date(o).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"",J=()=>{w.replace({query:{...f.query,company_id:c.value.company_id,department_id:c.value.department_id,line_type:c.value.line_type,employee_id:c.value.employee_id}}),c.value.employee_id&&x.value&&L()},K={exchange_shift:"ExchangeShiftShow",exchange_offday:"ExchangeOffdayShow"},C=o=>{const a=(o||"").toLowerCase();return a==="approved"||a==="success"?"bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200":a==="rejected"||a==="declined"?"bg-rose-50 text-rose-700 ring-1 ring-rose-200":a==="pending"?"bg-amber-50 text-amber-700 ring-1 ring-amber-200":a==="processing"||a==="reviewing"?"bg-blue-50 text-blue-700 ring-1 ring-blue-200":"bg-slate-100 text-slate-700 ring-1 ring-slate-200"};return(o,a)=>{const m=oe("RouterLink");return i(),d("div",de,[e("div",{class:"flex flex-wrap items-center justify-between gap-3"},[e("button",{class:"inline-flex items-center gap-2 rounded-lg border px-3 py-1.5 hover:bg-slate-50",onClick:z},a[5]||(a[5]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:inline"},"Back",-1)])),a[6]||(a[6]=e("h1",{class:"text-xl md:text-2xl font-semibold tracking-tight text-slate-800"}," Monthly Application Log ",-1)),a[7]||(a[7]=e("div",null,null,-1))]),e("div",ce,[h(Q,{company_id:c.value.company_id,"onUpdate:company_id":a[1]||(a[1]=s=>c.value.company_id=s),department_id:c.value.department_id,"onUpdate:department_id":a[2]||(a[2]=s=>c.value.department_id=s),employee_id:c.value.employee_id,"onUpdate:employee_id":a[3]||(a[3]=s=>c.value.employee_id=s),line_type:c.value.line_type,"onUpdate:line_type":a[4]||(a[4]=s=>c.value.line_type=s),"with-type":!0,"initial-value":o.$route.query,onFilterChange:J},{default:v(()=>[e("div",ue,[e("div",null,[a[8]||(a[8]=e("label",{class:"top-label -top-1"},"Select Month",-1)),h(ee,{modelValue:g.value,"onUpdate:modelValue":a[0]||(a[0]=s=>g.value=s),"show-year":!1,"show-month":!0,"show-date":!1},null,8,["modelValue"])]),e("button",{class:"btn-2 rounded",onClick:L},a[9]||(a[9]=[e("i",{class:"far fa-rotate-right"},null,-1),e("span",{class:"hidden md:inline"},"Refresh",-1)]))])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"])]),S.value?(i(),d("div",pe,[h(Z,{user:S.value},null,8,["user"])])):re("",!0),Y.value?(i(),ie(X,{key:1})):$.value.length?(i(),d("div",fe,[e("div",ye,[(i(!0),d(b,null,k($.value,s=>(i(),d("button",{key:s.key,type:"button",onClick:p=>u.value=s.key,class:t(["inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-sm",u.value===s.key?"border-emerald-600 text-emerald-700 bg-emerald-50":"border-slate-200 text-slate-700 hover:bg-slate-50"])},[e("span",null,r(s.label),1),e("span",me,r(s.count),1)],10,_e))),128))]),e("div",xe,[e("div",ge,r(E[u.value]||u.value),1),u.value==="overtime"?(i(),d("div",ve,[e("table",{class:t(M)},[e("thead",{class:"sticky top-0 bg-white/90 backdrop-blur border-b"},[e("tr",{class:"text-xs uppercase text-slate-600"},[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Created Date"),e("th",{class:t(l)},"Applied Date"),e("th",{class:t(l)},"Type"),e("th",{class:t(l)},"Shift"),e("th",{class:t(l)},"Check-In"),e("th",{class:t(l)},"Check-Out"),e("th",{class:t(l)},"Working"),e("th",{class:t(l)},"Request"),e("th",{class:t(l)},"Approved"),e("th",{class:t(l)},"Details"),e("th",{class:t(l)},"Status"),e("th",{class:t(l)},"Action")])]),e("tbody",null,[(i(!0),d(b,null,k(q(y).applicationLog.overtime,(s,p)=>(i(),d("tr",{key:`ot-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},r(p+1),1),e("td",{class:t(n)},r(_(s.created_date)),1),e("td",{class:t(n)},r(_(s.date)),1),e("td",{class:t(n)},r(s.duty_type),1),e("td",{class:t(n)},r(s.shift),1),e("td",{class:t(n)},r(s.check_in||"—"),1),e("td",{class:t(n)},r(s.check_out||"—"),1),e("td",{class:t(n)},[h(R,{workingHours:s.working_hours},null,8,["workingHours"])]),e("td",{class:t(n)},[h(R,{workingHours:s.request_overtime_hours},null,8,["workingHours"])]),e("td",{class:t(n)},[h(R,{workingHours:s.approval_overtime_hours},null,8,["workingHours"])]),e("td",{class:t(n)},r(s.work_details||""),1),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",C(s.status)])},r(s.status||"Pending"),3)]),e("td",{class:t(n+" text-right")},[h(m,{to:{name:"MyOvertimeShow",params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:v(()=>a[11]||(a[11]=[e("i",{class:"far fa-eye"},null,-1),D(" View ")])),_:2,__:[11]},1032,["to"])],2)]))),128))])])])):u.value==="leave_application"?(i(),d("div",be,[e("table",{class:t(M)},[e("thead",ke,[e("tr",we,[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Created Date"),e("th",{class:t(l)},"Last Working"),e("th",{class:t(l)},"Resumption"),e("th",{class:t(l)},"Type"),e("th",{class:t([l,"!w-1/3"])},"Reason"),e("th",{class:t(l)},"Status"),e("th",{class:t(l)},"Action")])]),e("tbody",null,[(i(!0),d(b,null,k(q(y).applicationLog.leave_application,(s,p)=>(i(),d("tr",{key:`la-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},r(p+1),1),e("td",{class:t(n)},r(_(s.create_date)),1),e("td",{class:t(n)},r(s.from),1),e("td",{class:t(n)},r(s.to),1),e("td",{class:t([n,"whitespace-pre-line"])},r(s.application_types),1),e("td",{class:t([n,"whitespace-pre-line"])},r(s.reason),1),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",C(s.status)])},r(s.status),3)]),e("td",{class:t(n+" text-right")},[h(m,{to:{name:"LeaveApplicationShow",params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:v(()=>a[12]||(a[12]=[e("i",{class:"far fa-eye"},null,-1),D(" View ")])),_:2,__:[12]},1032,["to"])],2)]))),128))])])])):u.value==="short_leave"?(i(),d("div",Se,[e("table",{class:t(M)},[e("thead",Le,[e("tr",Ce,[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Created Date"),e("th",{class:t(l)},"Type"),e("th",{class:t(l)},"Date"),e("th",{class:t(l)},"Check-In"),e("th",{class:t(l)},"Check-Out"),e("th",{class:t(l)},"Duration"),e("th",{class:t(l)},"Attachment"),e("th",{class:t(l)},"Status"),e("th",{class:t([l,"text-right"])},"Action")])]),e("tbody",null,[(i(!0),d(b,null,k(q(y).applicationLog.short_leave,(s,p)=>(i(),d("tr",{key:`sl-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},r(p+1),1),e("td",{class:t(n)},r(_(s.create_date)),1),e("td",{class:t(n)},r(s.application_types),1),e("td",{class:t(n)},r(s.date),1),e("td",{class:t(n)},r(j(s.start_time)),1),e("td",{class:t(n)},r(j(s.end_time)),1),e("td",{class:t(n)},r(s.duration)+" m",1),e("td",{class:t(n+" text-center")},[s.attachment?(i(),d("a",{key:0,href:s.attachment,target:"_blank",rel:"noopener",class:"text-emerald-700 hover:underline"},a[13]||(a[13]=[e("i",{class:"far fa-eye"},null,-1)]),8,Ae)):(i(),d("span",De,"No file"))],2),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",C(s.status)])},r(s.status),3)]),e("td",{class:t(n+" text-right")},[h(m,{to:{name:"ShortLeaveShow",params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:v(()=>a[14]||(a[14]=[e("i",{class:"far fa-eye"},null,-1),D(" View ")])),_:2,__:[14]},1032,["to"])],2)]))),128))])])])):u.value==="exchange_offday"||u.value==="exchange_shift"?(i(),d("div",qe,[e("table",{class:t(M)},[e("thead",Me,[e("tr",Ve,[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Created Date"),e("th",{class:t(l)},"Current Date"),e("th",{class:t(l)},"Exchange Date"),e("th",{class:t(l)},"Shift"),e("th",{class:t(l)},"Status"),e("th",{class:t([l,"text-right"])},"Action")])]),e("tbody",null,[(i(!0),d(b,null,k(q(y).applicationLog[u.value],(s,p)=>(i(),d("tr",{key:`ex-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},r(p+1),1),e("td",{class:t(n)},r(_(s.create_date)),1),e("td",{class:t(n)},r(s.current_date),1),e("td",{class:t(n)},r(s.exchange_date),1),e("td",{class:t(n)},r((s==null?void 0:s.shift)||"N/A"),1),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",C(s.status)])},r(s.status),3)]),e("td",{class:t(n+" text-right")},[h(m,{to:{name:K[s.type],params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:v(()=>a[15]||(a[15]=[e("i",{class:"far fa-eye"},null,-1),D(" View ")])),_:2,__:[15]},1032,["to"])],2)]))),128))])])])):u.value==="manual_attendance"?(i(),d("div",$e,[e("table",{class:t(M)},[e("thead",Ne,[e("tr",Oe,[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Created Date"),e("th",{class:t(l)},"Date"),e("th",{class:t(l)},"Type"),e("th",{class:t(l)},"Check-In"),e("th",{class:t(l)},"Check-Out"),e("th",{class:t(l)},"Status"),e("th",{class:t([l,"text-right"])},"Action")])]),e("tbody",null,[(i(!0),d(b,null,k(q(y).applicationLog.manual_attendance,(s,p)=>(i(),d("tr",{key:`ma-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},r(p+1),1),e("td",{class:t(n)},r(_(s.create_date)),1),e("td",{class:t(n)},r(_(s.check_in||s.check_out)),1),e("td",{class:t(n)},r(s.application_types),1),e("td",{class:t(n)},r(H(s.check_in)),1),e("td",{class:t(n)},r(H(s.check_out)),1),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",C(s.status)])},r(s.status),3)]),e("td",{class:t(n+" text-right")},[h(m,{to:{name:"ManualAttendanceShow",params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:v(()=>a[16]||(a[16]=[e("i",{class:"far fa-eye"},null,-1),D(" View ")])),_:2,__:[16]},1032,["to"])],2)]))),128))])])])):(i(),d("div",Re," No data for this group. "))])])):(i(),d("div",he,a[10]||(a[10]=[e("div",{class:"mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-emerald-50"},[e("i",{class:"far fa-clipboard-list text-emerald-600 text-xl"})],-1),e("h3",{class:"text-lg font-semibold text-slate-800"},"No applications found",-1),e("p",{class:"mt-1 text-sm text-slate-500"},"Choose an employee and month to view logs.",-1)])))])}}};export{Qe as default};
