import{H as p,r as u,I as l}from"./index-CKknogop.js";const E=p("notice",()=>{const d=u([]),v=u([]),f=u({}),o=u(null),n=u(!1),g=u([]),h=u(0);return{notices:d,notice:f,error:o,isLoading:n,policies:v,feedbacks:g,totalFeedbacks:h,fetchPolices:async()=>{var s,t,e;try{n.value=!0;const a=await l.get("/policies");v.value=(s=a==null?void 0:a.data)==null?void 0:s.polices,o.value=null}catch(a){o.value=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchFileUpload:async s=>{var t,e;try{return n.value=!0,(await l.post("file-upload",s,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(a){o.value=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},createNoticeFeedback:async(s,t)=>{var e,a;try{return n.value=!0,await l.post(`/user/notice/feedback/${s}`,t)}catch(c){o.value=((a=(e=c.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}finally{n.value=!1}},fetchNotices:async()=>{var s,t;try{n.value=!0;const e=await l.get("/notices");d.value=e==null?void 0:e.data,o.value=null}catch(e){o.value=((t=(s=e.response)==null?void 0:s.data)==null?void 0:t.message)||"Something went wrong"}finally{n.value=!1}},fetchNotice:async s=>{var t,e;try{n.value=!0;const c=(await l.get(`/notices/${s}`)).data;return c&&(f.value=c),o.value=null,c}catch(a){o.value=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},createNotice:async s=>{var t,e;try{n.value=!0;const a=await l.post("/notices",s);d.value.push(a.data.notices),o.value=null}catch(a){o.value=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},updateNotice:async(s,t)=>{var e,a;try{n.value=!0,console.log({payload:t});const c=await l.put(`/notices/${s}`,t),r=users.value.findIndex(i=>i.id===s);r!==-1&&(f.value[r]=c.data.notice),o.value=null}catch(c){o.value=((a=(e=c.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}finally{n.value=!1}},fetchUserNotices:async()=>{var s,t,e;try{n.value=!0;const a=await l.get("/user/notices");d.value=(s=a==null?void 0:a.data)==null?void 0:s.notices,o.value=null}catch(a){o.value=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchNoticeDetails:async s=>{var t,e;try{n.value=!0;const c=(await l.get(`/notices/details/${s}`)).data;return c&&(f.value=c),o.value=null,c}catch(a){o.value=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchFeedbacks:async(s,t={})=>{var a,c,r;const e=await l.get(`/notice/feedbacks/${s}`,t);g.value=(a=e==null?void 0:e.data)==null?void 0:a.data,h.value=(r=(c=e==null?void 0:e.data)==null?void 0:c.meta)==null?void 0:r.total},downloadFeedbackUserExcel:async(s,t={})=>{var e,a;n.value=!0;try{const c=await l.get(`/notice/feedbacks/${s}?flag=excel`,{params:t,responseType:"blob"}),r=window.URL.createObjectURL(new Blob([c.data])),i=document.createElement("a");i.href=r,i.setAttribute("download",`notice_feedback_users_${s}.xlsx`),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(c){o.value=((a=(e=c.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong",console.error(o.value)}finally{n.value=!1}}}});export{E as u};
