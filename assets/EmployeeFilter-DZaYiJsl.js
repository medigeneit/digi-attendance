import{y as A,r as c,e as $,x as g,c as S,o as b,q as f,f as F,g as h,a as d,i as v,k as C,_ as I,t as N,w as j}from"./index-cziN7Cb2.js";import{_ as D}from"./MultiselectDropdown-FKu6ihKO.js";import{u as L}from"./company-WhT-hSqN.js";import{u as M}from"./department-BlMQv4Cn.js";import{S as O}from"./SelectDropdown-BJaXc7Gk.js";import{_ as q}from"./UserChip-CECeUO-i.js";const R={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},G={class:"relative"},H={key:0,class:"relative w-full pr-4"},J={class:"flex items-center gap-2 text-sm text-gray-700"},K={class:"line-clamp-1"},P={key:0,class:"absolute right-1 text-xl top-0 bottom-0 flex items-center"},le={__name:"EmployeeFilter",props:{modelValue:Object,withType:{type:Boolean,default:!0},initialValue:{type:Object,default:()=>({})}},emits:["update:modelValue","filter-change"],setup(k,{emit:z}){const a=k,E=z,n=L(),V=M(),{companies:T}=A(n),{departments:x}=A(V),m=c(null),i=c({id:"all",name:"All Departments"}),o=c({id:"all",name:"All Types"}),s=c(null),p=c([]),U=t=>({executive:"Executive",support_staff:"Support Staff",doctor:"Doctor",academy_body:"Academy Body"})[t]||t;$(async()=>{var t,e,l,u;if(await n.fetchCompanies(),(t=a.initialValue)!=null&&t.company_id){const y=T.value.find(r=>r.id==a.initialValue.company_id);if(y){if(m.value=y,await V.fetchDepartments(y.id),await n.fetchEmployee(y.id),p.value=[...n.employees],(e=a.initialValue)!=null&&e.department_id&&a.initialValue.department_id!=="all"){const r=x.value.find(w=>w.id==a.initialValue.department_id);r&&(i.value=r)}if((l=a.initialValue)!=null&&l.type&&a.initialValue.type!=="all"&&(o.value={id:a.initialValue.type,name:U(a.initialValue.type)}),B(),(u=a.initialValue)!=null&&u.employee_id){const r=p.value.find(w=>w.id==a.initialValue.employee_id);r&&(s.value=r.id)}}}}),g(m,async t=>{t?(await V.fetchDepartments(t.id),await n.fetchEmployee(t.id),p.value=[...n.employees]):(p.value=[],x.value=[]),_()}),g([i,o],()=>{B()}),g(s,()=>{_()});const B=()=>{var e,l;let t=[...n.employees];(e=i.value)!=null&&e.id&&i.value.id!=="all"&&(t=t.filter(u=>u.department_id==i.value.id)),a.withType&&((l=o.value)!=null&&l.id)&&o.value.id!=="all"&&(t=t.filter(u=>u.type==o.value.id)),p.value=t,s.value=null,_()},_=()=>{var t,e,l;E("update:modelValue",{company_id:((t=m.value)==null?void 0:t.id)||"",department_id:((e=i.value)==null?void 0:e.id)||"all",type:a.withType?((l=o.value)==null?void 0:l.id)||"all":null,employee_id:s.value||""}),E("filter-change")};return(t,e)=>(b(),S("div",R,[f(D,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=l=>m.value=l),options:C(T),label:"name","track-by":"id",placeholder:"Select Company",class:"relative w-full md:!w-64"},{label:v(()=>e[5]||(e[5]=[d("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Company ",-1)])),_:1},8,["modelValue","options"]),f(D,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=l=>i.value=l),options:[{id:"all",name:"All Departments"},...C(x)],label:"name","track-by":"id",placeholder:"Select Department",disabled:!m.value,class:"relative w-full md:!w-64"},{label:v(()=>e[6]||(e[6]=[d("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Department ",-1)])),_:1},8,["modelValue","options","disabled"]),k.withType?(b(),F(D,{key:0,modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value=l),options:[{id:"all",name:"All Types"},{id:"executive",name:"Executive"},{id:"support_staff",name:"Support Staff"},{id:"doctor",name:"Doctor"},{id:"academy_body",name:"Academy Body"}],label:"name","track-by":"id",placeholder:"Select Type",class:"relative w-full md:!w-64"},{label:v(()=>e[7]||(e[7]=[d("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Line Type ",-1)])),_:1},8,["modelValue"])):h("",!0),d("div",G,[f(O,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=l=>s.value=l),options:p.value,placeholder:"--Select Employee--",class:"border-2 border-gray-400 relative rounded h-[44px] w-full md:w-64 bg-white *:border-0"},{option:v(({option:l})=>[f(q,{user:l||{},class:"w-full overflow-hidden border relative"},null,8,["user"])]),"selected-option":v(({option:l})=>[l?(b(),S("div",H,[d("div",J,[f(I,{user:l},null,8,["user"]),d("div",K,N(l==null?void 0:l.label),1)]),s.value?(b(),S("div",P,[d("button",{onClick:e[3]||(e[3]=j(u=>s.value=null,["prevent"])),class:"text-gray-6 font-semibold 00 hover:text-red-700"}," Ã— ")])):h("",!0)])):h("",!0)]),_:1},8,["modelValue","options"]),e[8]||(e[8]=d("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Employee ",-1))])]))}};export{le as _};
