import{d as xt,m as G,c as r,o,n as p,a as s,g as u,q as P,t as y,k as a,f,j as g,i as v,w as x,F as E,b as ht,u as bt,r as V,z as dt,e as _t,x as O,A as ut,y as q,I as Dt}from"./index-a7sAWbwt.js";import{L as ct}from"./LoaderView-CRHjgMJ8.js";import{O as z}from"./OverlyModal-b-kyag5t.js";import{_ as wt}from"./DescriptionView-DhP9crpU.js";import{b as Ct,c as Tt,T as $t,a as Et}from"./TaskSupervisorAndEmployee-BrOBg9Ys.js";import{g as Mt,_ as Lt,a as Rt,b as St,c as Ut}from"./TaskStatusManager-wmcZ1CsN.js";import{_ as Pt}from"./TaskStatus-D8I6TKKS.js";import{b as Bt,d as At}from"./datetime-DcVwRp76.js";import{_ as Nt}from"./DepartmentChip-Bu6RL8vx.js";import{_ as It}from"./UserChip-BwKnmrSF.js";import{_ as Ot,a as jt}from"./TodoCreateEditShow-B-RhYKZK.js";import{s as pt}from"./dom-BKn8Ftnz.js";import{u as Vt}from"./useTaskStore-qdXwi4KE.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./task-JHabeUP8.js";import"./url-CePbr-gY.js";import"./useTodoStore-BC7mxGW7.js";const qt={class:""},zt={key:0,class:"mt-1 flex items-center gap-2"},Gt={key:0,class:"line-clamp-2 text-gray-500 whitespace-nowrap mr-2"},Wt={class:"md:ml-auto w-full md:w-auto flex items-center justify-center gap-2"},Kt={key:0,class:"flex items-center gap-1 text-red-600"},Ft={__name:"TodoDateItemCard",props:{todoDate:{type:Object,required:!0},hideDepartment:{type:Boolean,default:!1},hideUser:{type:Boolean,default:!1},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickEdit","clickDelete","clickChangeStatus","clickDelete"],setup(i,{emit:e}){const c=xt(),h=e;return(w,d)=>{var b,_,B,A,N,M,I;const D=G("RouterLink");return o(),r("div",{class:P(["px-4 py-4 md:py-2 cursor-pointer flex flex-wrap items-center gap-y-2 gap-x-4 text-sm",{"bg-green-100":i.todoDate.status=="COMPLETED","hover:bg-gray-50":i.todoDate.status!="COMPLETED"}]),onClick:d[4]||(d[4]=x(C=>h("clickTodo",i.todoDate),["prevent"]))},[p(Ot,{todoDate:i.todoDate},null,8,["todoDate"]),s("div",qt,[s("div",{class:P(["line-clamp-1",{"text-green-800":i.todoDate.status=="COMPLETED","text-blue-800":i.todoDate.status!="COMPLETED"}])},y(i.todoDate.id)+" - "+y(a(Bt)(i.todoDate.date)),3),i.todoDate.user?(o(),r("div",zt,[i.hideUser?u("",!0):(o(),f(It,{key:0,user:i.todoDate.user,"avatar-size":"xsmall"},null,8,["user"])),i.hideDepartment?u("",!0):(o(),f(Nt,{key:1,department:(_=(b=i.todoDate)==null?void 0:b.user)==null?void 0:_.department},null,8,["department"]))])):u("",!0)]),(B=i.todoDate.todo)!=null&&B.todo_type&&((A=i.todoDate.todo)!=null&&A.todo_type_id)?(o(),r("div",Gt,[g(y((N=i.todoDate.todo)==null?void 0:N.todo_type)+" ",1),p(D,{class:"text-blue-600 font-semibold underline hover:text-sky-400",onClick:x(C=>null,["stop"]),to:{name:i.userRole=="employee"?"MyTaskShow":"TaskShow",params:{id:(M=i.todoDate.todo)==null?void 0:M.todo_type_id}}},{default:v(()=>{var C;return[d[5]||(d[5]=s("i",{class:"fas fa-link"},null,-1)),g(" "+y((C=i.todoDate.todo)==null?void 0:C.todo_type_id),1)]}),_:1,__:[5]},8,["to"])])):u("",!0),s("div",Wt,[i.todoDate.status=="WORKING"?(o(),r("div",Kt,d[6]||(d[6]=[s("span",{class:"fas fa-circle animate-pulse text-xs"},null,-1),s("span",{class:"text-xs"},"Working",-1)]))):u("",!0),i.todoDate.user_id===((I=a(c).user)==null?void 0:I.id)?(o(),r(E,{key:1},[i.todoDate.status==="WORKING"?(o(),r("button",{key:0,title:"Mark as Completed",class:"btn-icon bg-transparent text-green-400 border-green-400 border hover:bg-green-400 hover:text-white",onClick:d[0]||(d[0]=x(()=>h("clickChangeStatus",i.todoDate,"COMPLETED"),["prevent","stop"]))},d[7]||(d[7]=[s("i",{class:"fas fa-check"},null,-1)]))):u("",!0),i.todoDate.status==="PENDING"?(o(),r("button",{key:1,title:"Start Working",class:"btn-icon bg-transparent text-red-400 border-red-400 border hover:bg-red-400 hover:text-white",onClick:d[1]||(d[1]=x(()=>h("clickChangeStatus",i.todoDate,"WORKING"),["prevent","stop"]))},d[8]||(d[8]=[s("i",{class:"fas fa-play ml-[4px]"},null,-1)]))):u("",!0),s("button",{class:"btn-icon bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:d[2]||(d[2]=x(C=>{var T;return h("clickEdit",(T=i.todoDate)==null?void 0:T.todo)},["prevent","stop"]))},d[9]||(d[9]=[s("i",{class:"fas fa-pen"},null,-1)])),s("button",{class:"btn-icon bg-red-400 text-white hover:bg-red-600 hover:text-white",onClick:d[3]||(d[3]=x(()=>h("clickDelete",i.todoDate),["prevent","stop"]))},d[10]||(d[10]=[s("i",{class:"fas fa-trash-alt"},null,-1)]))],64)):u("",!0)])],2)}}},Ht={class:"container mx-auto p-6"},Jt={key:3,class:"max-w-8xl min-h-64 mx-auto bg-white shadow-lg rounded-lg p-6 relative"},Qt={key:0,class:"text-sm mb-2 border-b","aria-label":"Breadcrumb"},Xt={class:"flex items-center gap-2"},Yt={key:0,"aria-hidden":"true",class:"text-gray-400 text-base"},Zt=["title"],te={key:1,class:"text-gray-900 font-medium line-clamp-1","aria-current":"page"},ee={class:"grid grid-cols-4"},se={class:"mb-4 flex col-span-full"},ae={class:"font-medium text-xl"},oe={class:"flex items-center gap-3 text-xs text-gray-500 mt-2 opacity-80 text-left"},le={key:0,class:"text-white bg-green-700 text-[12px] uppercase px-2 py-[2px] rounded-full border border-green-200 opacity-80"},ne={class:"font-semibold"},ie={class:"mt-2 col-span-full flex items-center"},re={class:"text-gray-400 text-xs"},de={class:"flex items-center gap-0.5"},ue={class:"text-sky-400 text-sm font-semibold"},ce={class:"text-right col-span-full md:col-span-1 ml-auto flex items-start justify-center gap-4 !text-lg"},pe={class:"col-span-full mb-4"},ke=["innerHTML"],me={key:0,class:"mt-4 col-span-full mb-6"},fe={class:"mt-2 py-2 flex flex-col lg:flex-row gap-y-4 justify-center items-center gap-2 col-span-full"},ye={class:"flex items-center gap-4 flex-wrap justify-center"},ge=["disabled"],ve={class:"lg:ml-auto flex gap-4 items-center"},xe={class:"mt-4"},he={class:"mb-3 flex justify-between items-end"},be={class:"px-4 py-1 bg-sky-400 text-white rounded-t-md flex items-center"},_e=["onClick"],De={key:2},we={key:1,class:"text-center py-4 text-red-500"},qe={__name:"RequirementTaskShow",setup(i){const e=Vt(),c=ht(),h=bt(),w=V(""),d=V({}),D=dt({open:!1,task:null});_t(async()=>{w.value="loading",await _(c.params.id),w.value="",c.hash=="#sub-tasks"&&setTimeout(()=>pt(c.hash,66),0)});const b=dt({user:null,type:""});async function _(l){await e.fetchTask(l,{with_todos:"true"})}const B=O(()=>Mt(e.task.users,e.task.task_reports||[]));async function A(){await _(c.params.id),b.user=null,b.type=""}const N=l=>{h.push({name:"TaskEdit",params:{id:l}})},M=O(()=>{var l,t;return e.task?((l=e.task)==null?void 0:l.parent_id)==0?{name:T.value?"MyTaskList":"TaskList"}:{params:{id:(t=e.task)==null?void 0:t.parent_id},query:{"is-my-task":T.value}}:null});function I(){D.open=!0,D.task=e.task}function C(){D.open=!1,console.log({STATE:"Deleted",backLink:M.value}),h.push(M.value)}const T=O(()=>c.name=="MyTaskShow"||!!c.query["is-my-task"]),j=(l,t=!1)=>({id:l==null?void 0:l.id,title:l==null?void 0:l.title,status:l==null?void 0:l.status,is_current_page:t}),W=O(()=>{var t,$,L,R,S,U;const l=[];return(t=e==null?void 0:e.task)!=null&&t.parent&&(l.push(j(($=e.task)==null?void 0:$.parent)),(R=(L=e==null?void 0:e.task)==null?void 0:L.parent)!=null&&R.parent&&l.push(j((U=(S=e.task)==null?void 0:S.parent)==null?void 0:U.parent))),[...l.reverse(),j(e.task,!0)]});ut(()=>c.params.id,async l=>{w.value="changing",await _(l),w.value=""}),ut(()=>c.hash,async function(){setTimeout(()=>pt(c.hash,66),0)});const k=V({action:null});function kt(){k.value={...k.value,action:""},_(c.params.id)}function mt(){k.value={...k.value,action:""},_(c.params.id)}function K(l){k.value={...k.value,action:"edit",todo:l}}function ft(l,t){console.log({yearMonthDay:t,todoId:l}),k.value={...k.value,action:"addDate",date:t,todo_id:l,formReadonlyValues:{date:!0}}}function yt(){k.value={action:null,todo:null}}function gt(l){console.log({todo:l}),k.value={...k.value,action:"show",todo:l}}function vt(){var l;k.value={...k.value,action:"add",todoTypeId:(l=c.params)==null?void 0:l.id,todoType:"task",formReadonlyValues:{todo_type_id:!0}}}return(l,t)=>{var R,S,U,F,H,J,Q,X,Y,Z,tt,et,st,at,ot,lt,nt,it,rt;const $=G("RouterLink"),L=G("router-view");return o(),r("div",Ht,[b.user?(o(),f(z,{key:0},{default:v(()=>[p(Lt,{task:a(e).task,user:b.user,type:b.type,onCloseClick:t[0]||(t[0]=n=>b.user=null),onUpdateDate:A},null,8,["task","user","type"])]),_:1})):u("",!0),D.open?(o(),f(z,{key:1},{default:v(()=>[p(Rt,{onCloseClick:t[1]||(t[1]=n=>D.open=!1),task:D.task,onDelete:C},null,8,["task"])]),_:1})):u("",!0),w.value==="loading"?(o(),f(ct,{key:2})):(o(),r("div",Jt,[a(e).task?(o(),r(E,{key:0},[W.value.length>1?(o(),r("nav",Qt,[s("ol",Xt,[(o(!0),r(E,null,q(W.value,(n,m)=>(o(),r(E,{key:n.id},[m>0?(o(),r("li",Yt,"/")):u("",!0),s("li",{title:n==null?void 0:n.title,class:"text-gray-600 line-clamp-1"},[n.is_current_page?(o(),r("span",te,y(n==null?void 0:n.title),1)):(o(),f($,{key:0,to:`${T.value?"/my-tasks":"/tasks"}/${n.id}`,class:P(["hover:text-gray-900 hover:underline transition",{"line-clamp-1 text-justify":m>0,"whitespace-nowrap":m===0}])},{default:v(()=>[g(y(n==null?void 0:n.title),1)]),_:2},1032,["to","class"]))],8,Zt)],64))),128))])])):u("",!0),s("section",ee,[s("div",se,[s("div",null,[s("h2",ae,y(a(e).task.title),1),s("div",oe,[a(e).task.parent_id==0?(o(),r("div",le," MAIN TASK ")):u("",!0),s("div",ne,"#"+y((R=a(e).task)==null?void 0:R.serial),1),(S=a(e).task)!=null&&S.is_important?(o(),f($t,{key:1})):u("",!0),(U=a(e).task)!=null&&U.is_urgent?(o(),f(Et,{key:2})):u("",!0)]),s("div",ie,[s("div",re,[t[9]||(t[9]=s("i",{class:"fas fa-clock"},null,-1)),g(" "+y(a(At)(a(e).task.created_at)),1)]),(F=a(e).task)!=null&&F.created_by_user?(o(),r(E,{key:0},[t[10]||(t[10]=s("span",{class:"text-sm text-gray-600 ml-4"},"By",-1)),s("div",de,[p(Dt,{user:(H=a(e).task)==null?void 0:H.created_by_user,class:"ml-1",size:"xsmall"},null,8,["user"]),s("div",ue,y((Q=(J=a(e).task)==null?void 0:J.created_by_user)==null?void 0:Q.label),1)])],64)):u("",!0)])]),s("div",ce,[p(Pt,{status:(X=a(e).task)==null?void 0:X.status,progressPercent:(Y=a(e).task)==null?void 0:Y.progress_percent,class:"h-6 !text-lg"},null,8,["status","progressPercent"]),a(e).task?(o(),f(Ct,{key:0,task:a(e).task,ref_key:"progress",ref:d,class:"!text-lg"},null,8,["task"])):u("",!0)])]),s("div",pe,[p(wt,null,{default:v(()=>{var n;return[s("p",{innerHTML:(n=a(e).task)==null?void 0:n.description,class:"text-justify"},null,8,ke)]}),_:1})]),p(Tt,{task:(Z=a(e))==null?void 0:Z.task,"tree-level":(et=(tt=a(e))==null?void 0:tt.task)==null?void 0:et.level,class:"justify-center border col-span-full border-dashed rounded-lg"},null,8,["task","tree-level"]),a(e).task.children_task_count>0?(o(),r("section",me,[p(St,{"task-users":((st=a(e).task)==null?void 0:st.users)||[],task:a(e).task,"sub-tasks":a(e).tasks,"progress-users":B.value},{caption:v(()=>t[11]||(t[11]=[s("div",{class:"text-sm py-1 text-left uppercase font-semibold text-gray-600"}," Assigned Users ",-1)])),_:1},8,["task-users","task","sub-tasks","progress-users"])])):u("",!0),(at=a(e))!=null&&at.task?(o(),f(Ut,{key:1,task:((ot=a(e))==null?void 0:ot.task)||{},class:"col-span-full mt-4",onUpdateStatus:t[2]||(t[2]=()=>{var n,m;return _((m=(n=a(e))==null?void 0:n.task)==null?void 0:m.id)})},null,8,["task"])):u("",!0),s("div",fe,[s("div",ye,[s("button",{onClick:t[3]||(t[3]=x(n=>{var m;return N((m=a(e).task)==null?void 0:m.id)},["stop"])),class:"btn-2 py-0.5 disabled:opacity-30 disabled:pointer-events-none",disabled:!!a(e).task.closed_at},t[12]||(t[12]=[s("i",{class:"fas fa-edit"},null,-1),g(" Edit ")]),8,ge),p($,{to:{name:"TaskUserAssign",params:{id:(lt=a(e).task)==null?void 0:lt.id}},class:P(["bg-indigo-500 hover:bg-indigo-600 text-white font-semibold px-3 py-0.5 rounded-full transition whitespace-nowrap",a(e).task.closed_at?"opacity-30 pointer-events-none":""]),onClick:t[4]||(t[4]=n=>n.stopPropagation())},{default:v(()=>t[13]||(t[13]=[s("i",{class:"fas fa-users-cog"},null,-1),g(" Assign Users ")])),_:1,__:[13]},8,["to","class"]),s("button",{class:"border-2 border-indigo-500 hover:bg-indigo-500 hover:text-white text-indigo-500 font-semibold px-3 py-0.5 rounded-full transition disabled:opacity-30 disabled:pointer-events-none whitespace-nowrap",onClick:t[5]||(t[5]=n=>a(h).back())},t[14]||(t[14]=[s("i",{class:"fas fa-arrow-left"},null,-1),g(" Back ")])),p($,{to:M.value,class:"border-2 border-indigo-500 hover:bg-indigo-500 hover:text-white ml-2 text-indigo-500 font-semibold px-3 py-0.5 rounded-full transition disabled:opacity-30 disabled:pointer-events-none whitespace-nowrap",onClick:t[6]||(t[6]=n=>n.stopPropagation())},{default:v(()=>t[15]||(t[15]=[s("i",{class:"fas fa-arrow-left"},null,-1),g(" Parent Task ")])),_:1,__:[15]},8,["to"])]),s("div",ve,[((nt=a(e).task)==null?void 0:nt.children_task_count)===0&&((it=a(e).task)==null?void 0:it.status)==="PENDING"?(o(),r("button",{key:0,class:"btn-2-red h-8",onClick:x(I,["prevent"])}," Delete ")):u("",!0),p($,{to:{name:"TaskReports",params:{id:(rt=a(e).task)==null?void 0:rt.id},query:{"is-my-task":T.value},hash:"#task-reports"},onClick:t[7]||(t[7]=n=>n.stopPropagation()),class:P(["py-0.5 btn-3 text-sm h-8",{"bg-blue-500 text-white":a(c).name=="TaskReports"}])},{default:v(()=>t[16]||(t[16]=[s("i",{class:"fal fa-file-alt"},null,-1),g(" Reports ")])),_:1,__:[16]},8,["to","class"])])])]),t[20]||(t[20]=s("hr",null,null,-1)),s("div",xe,[s("div",he,[t[18]||(t[18]=s("h3",{class:"font-semibold text-xl"},"Todos",-1)),s("button",{class:"btn btn-3 h-8",onClick:t[8]||(t[8]=x(()=>vt(),["prevent"]))},t[17]||(t[17]=[s("i",{class:"fas fa-plus"},null,-1),g(" Add Todo ")]))]),s("div",null,[(o(!0),r(E,null,q(a(e).task_todos,n=>(o(),r("div",{key:n.id,class:"mb-4 border rounded-md border-blue-300"},[s("div",be,[s("h4",null,y(n.title),1),s("button",{class:"ml-auto btn-2 h-7 px-3 bg-sky-500 text-white hover:bg-sky-600 hover:text-white bg-none",onClick:x(()=>K(n),["prevent","stop"])},t[19]||(t[19]=[s("i",{class:"fas fa-pen"},null,-1),g(" Edit ")]),8,_e)]),(o(!0),r(E,null,q(n.dates,m=>(o(),r("div",{key:m.id},[p(Ft,{"todo-date":m,onClickTodo:()=>gt(m),class:"border-t"},null,8,["todo-date","onClickTodo"])]))),128))]))),128))])]),a(c).name==="TaskReportAdd"?(o(),f(z,{key:1,class:"*:bg-transparent"},{default:v(()=>[p(L)]),_:1})):(o(),r("section",De,[p(L)]))],64)):(o(),r("div",we,y(a(e).error),1)),w.value==="changing"?(o(),f(ct,{key:2,class:"absolute bg-opacity-80 inset-0 z-20"})):u("",!0)])),p(jt,{userRole:"employee",todoModal:k.value,onCancelClick:yt,onTodoUpdate:kt,onTodoDateUpdate:mt,onClickEdit:K,onClickAddTodoDate:ft},null,8,["todoModal"])])}}};export{qe as default};
