import{u as J,b as G,r as f,e as K,z as W,n as Q,c as o,o as n,a as e,f as h,p as O,k as u,h as X,v as Y,j as a,t as r,i as k,F as Z,q as ee,x as y,g as v}from"./index-DAz2JruQ.js";import{_ as te}from"./EmployeeFilter-BjlnM1ec.js";import{L as se}from"./LoaderView-LBOIqCz4.js";import{u as re}from"./attendance-BAgn8o23.js";import{u as ae}from"./user-BvDNB7H6.js";import"./MultiselectDropdown-C0j4IqCL.js";import"./company-CzPmYwWA.js";import"./department-B_mJvUZv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"px-4 space-y-4"},le={class:"w-full flex flex-wrap gap-4 items-center md:w-auto"},oe={key:0,class:"grid md:grid-cols-2 gap-4 text-sm"},ie={class:"card-bg p-4 gap-1"},de={class:"grid md:grid-cols-2"},ue={class:"card-bg p-4 gap-1"},pe={class:"flex justify-between items-center"},me={class:"grid md:grid-cols-2"},_e={key:1},ye={key:3,class:"space-y-4"},ve={class:"overflow-x-auto card-bg"},ce={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},be={class:"text-center text-xs"},xe={class:"border px-1 py-0.5"},fe={class:"border px-1 py-0.5"},he=["title"],ke=["title"],we=["title"],Ae={class:"border px-1 py-0.5"},Se={class:"border px-1 py-0.5"},De={key:0,class:"bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-semibold"},qe={key:1,class:"bg-yellow-100 text-yellow-700 px-2 py-1 rounded text-xs font-semibold animate-pulse"},Ne={key:2,class:"bg-red-100 text-red-700 px-2 py-1 rounded text-xs font-semibold"},Le={key:3},Ee={class:"border px-1 py-0.5"},Ce={class:"border px-1 py-0.5"},Te={key:0},je={class:"border px-1 py-0.5"},Me={key:0},Oe={__name:"EmployeeAttendance",setup(Be){const b=J(),p=G(),d=re(),w=ae(),l=f(null),_=f(p.query.date||d.selectedMonth),i=f({company_id:p.query.company_id||"",department_id:p.query.department_id||"all",type:p.query.type||"all",employee_id:p.query.employee_id||"",category:""}),A=async m=>{m?(await w.fetchUser(m),l.value=w.user):l.value=null},c=async()=>{i.value.employee_id&&_.value&&await d.getMonthlyAttendanceByShift(i.value.employee_id,_.value)};K(async()=>{i.value.employee_id&&(await A(i.value.employee_id),await c())}),W(_,m=>{b.replace({query:{...p.query,date:m}}),c()}),W(()=>i.value.employee_id,async(m,s)=>{m&&m!==s&&(await A(m),await c())});const z=()=>b.go(-1),I=()=>{b.replace({query:{...p.query,company_id:i.value.company_id,department_id:i.value.department_id,type:i.value.type,employee_id:i.value.employee_id}})};return(m,s)=>{var S,D,q,N,L,E,C,T,j,M,B,P,V,R,U,g;const x=Q("router-link");return n(),o("div",ne,[e("div",{class:"flex items-center justify-between gap-2"},[e("button",{class:"btn-3",onClick:z},s[2]||(s[2]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),s[3]||(s[3]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Attendance",-1)),s[4]||(s[4]=e("div",null,null,-1))]),e("div",le,[O(te,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=t=>i.value=t),"initial-value":u(p).query,onFilterChange:I},null,8,["modelValue","initial-value"]),e("div",null,[X(e("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[1]||(s[1]=t=>_.value=t),onChange:c,class:"input-1"},null,544),[[Y,_.value]])])]),l.value?(n(),o("div",oe,[e("div",ie,[s[14]||(s[14]=e("h2",{class:"title-md"},"Selected Employee Info",-1)),s[15]||(s[15]=e("hr",null,null,-1)),e("div",de,[e("p",null,[s[5]||(s[5]=e("strong",null,"Name:",-1)),a(" "+r(l.value.name),1)]),e("p",null,[s[6]||(s[6]=e("strong",null,"Designation:",-1)),a(" "+r(((S=l.value.designation)==null?void 0:S.title)||"N/A"),1)]),e("p",null,[s[7]||(s[7]=e("strong",null,"Department:",-1)),a(" "+r(((D=l.value.department)==null?void 0:D.name)||"N/A"),1)]),e("p",null,[s[8]||(s[8]=e("strong",null,"Company:",-1)),a(" "+r(((q=l.value.company)==null?void 0:q.name)||"N/A"),1)]),e("p",null,[s[9]||(s[9]=e("strong",null,"Phone:",-1)),a(" "+r(l.value.phone),1)]),e("p",null,[s[10]||(s[10]=e("strong",null,"Email:",-1)),a(" "+r(l.value.email||"N/A"),1)]),e("p",null,[s[11]||(s[11]=e("strong",null,"Employee ID :",-1)),a(" "+r(l.value.employee_id||"N/A"),1)]),e("p",null,[s[12]||(s[12]=e("strong",null,"Joining Date :",-1)),a(" "+r(l.value.joining_date||"N/A"),1)]),e("p",null,[s[13]||(s[13]=e("strong",null,"Employee ID :",-1)),a(" "+r(l.value.blood||"N/A"),1)])])]),e("div",ue,[e("div",pe,[s[17]||(s[17]=e("h2",{class:"title-md"},"Attendance Summary",-1)),O(x,{to:{name:"MonthWiseApplicationLog",query:{...u(p).query}},class:"btn-2",target:"_blank",rel:"noopener noreferrer"},{default:k(()=>s[16]||(s[16]=[a(" Application History ")])),_:1,__:[16]},8,["to"])]),s[24]||(s[24]=e("hr",null,null,-1)),e("div",me,[e("p",null,[s[18]||(s[18]=e("strong",null,"Total Working Days:",-1)),a(" "+r((L=(N=u(d))==null?void 0:N.summary)==null?void 0:L.total_working_days),1)]),e("p",null,[s[19]||(s[19]=e("strong",null,"Present Days:",-1)),a(" "+r((C=(E=u(d))==null?void 0:E.summary)==null?void 0:C.total_present_days),1)]),e("p",null,[s[20]||(s[20]=e("strong",null,"Absent Days:",-1)),a(" "+r((j=(T=u(d))==null?void 0:T.summary)==null?void 0:j.total_absent_days),1)]),e("p",null,[s[21]||(s[21]=e("strong",null,"Late Days:",-1)),a(" "+r((B=(M=u(d))==null?void 0:M.summary)==null?void 0:B.total_late_days),1)]),e("p",null,[s[22]||(s[22]=e("strong",null,"Total Working Hours:",-1)),a(" "+r((V=(P=u(d))==null?void 0:P.summary)==null?void 0:V.total_working_hours),1)]),e("p",null,[s[23]||(s[23]=e("strong",null,"Total Overtime Hours:",-1)),a(" "+r((U=(R=u(d))==null?void 0:R.summary)==null?void 0:U.total_overtime_hours),1)])])])])):(n(),o("div",_e,s[25]||(s[25]=[e("p",{class:"text-gray-400 text-center text-2xl italic"},"Select an employee, please.",-1)]))),u(d).isLoading?(n(),h(se,{key:2})):(n(),o("div",ye,[e("div",ve,[e("table",ce,[s[26]||(s[26]=e("thead",null,[e("tr",{class:"bg-gray-200 text-xs"},[e("th",{class:"border p-1"},"Date"),e("th",{class:"border p-1"},"Day"),e("th",{class:"border p-1"},"Shift"),e("th",{class:"border p-1"},"Entry Time"),e("th",{class:"border p-1"},"Exit Time"),e("th",{class:"border p-1"},"Working Hours"),e("th",{class:"border p-1"},"Over Time"),e("th",{class:"border p-1"},"Approved OT"),e("th",{class:"border p-1"},"Late Entry"),e("th",{class:"border p-1"},"Early Leave"),e("th",{class:"border p-1"},"Status")])],-1)),e("tbody",be,[(n(!0),o(Z,null,ee((g=u(d))==null?void 0:g.monthlyLogs,t=>{var H,$,F;return n(),o("tr",{key:t==null?void 0:t.date,class:"hover:border-b-2 hover:border-gray-200 hover:bg-blue-200"},[e("td",xe,r(t.date),1),e("td",fe,r(t.weekday),1),e("td",{class:"border px-1 py-0.5",title:`${t.shift_start_time} to ${t.shift_end_time}`},r(t.shift_name),9,he),e("td",{class:y(["border px-1 py-0.5",{"bg-red-200":t.late_duration,"bg-blue-200":((H=t==null?void 0:t.manual_attendance)==null?void 0:H.check_in)&&t.entry_time}]),title:`Device: ${t.entry_device}`},r(($=t==null?void 0:t.manual_attendance)!=null&&$.check_in&&t.entry_time?"M: ":"")+" "+r(t.entry_time),11,ke),e("td",{class:y(["border px-1 py-0.5",{"bg-red-200":t.early_leave_duration,"bg-blue-200":((F=t==null?void 0:t.manual_attendance)==null?void 0:F.check_out)&&t.exit_time}]),title:`Device: ${t.exit_device}`},r(t.exit_time),11,we),e("td",Ae,r(t.working_hours),1),e("td",Se,[t.over_time_status==="Approved"?(n(),o("span",De,r(t.overtime_hours)+" | Approved ",1)):t.over_time_status==="Pending"?(n(),o("span",qe,r(t.overtime_hours??"--")+" | Pending ",1)):t.over_time_status==="Rejected"?(n(),o("span",Ne," Rejected ")):t.over_time_status&&t.overtime_hours?(n(),o("span",Le,r(t.overtime_hours),1)):v("",!0)]),e("td",Ee,r(t!=null&&t.approved_over_times?(t==null?void 0:t.approved_over_times)+" H":""),1),e("td",Ce,[t.late_duration?(n(),o("div",Te,[a(r(t.late_duration)+" ",1),t.first_short_leave?(n(),h(x,{key:0,to:{name:"ShortLeaveShow",params:{id:t.first_short_leave_id}},class:y({"text-green-500":t.first_short_leave==="Approved","text-yellow-500":t.first_short_leave==="Pending","text-red-500":t.first_short_leave==="Rejected"})},{default:k(()=>[a(" ("+r(t.first_short_leave)+") ",1)]),_:2},1032,["to","class"])):v("",!0)])):v("",!0)]),e("td",je,[t.early_leave_duration?(n(),o("div",Me,[a(r(t.early_leave_duration)+" ",1),t.last_short_leave?(n(),h(x,{key:0,to:{name:"ShortLeaveShow",params:{id:t.last_short_leave_id}},class:y(["px-1",{"text-green-500":t.last_short_leave==="Approved","text-yellow-500":t.last_short_leave==="Pending","text-red-500":t.last_short_leave==="Rejected"}])},{default:k(()=>[a(" ("+r(t.last_short_leave)+") ",1)]),_:2},1032,["to","class"])):v("",!0)])):v("",!0)]),e("td",{class:y(["border px-1 py-0.5 font-semibold",{"text-red-600":t.status==="Absent","text-green-600":t.status==="Present","text-yellow-600":t.is_overtime_applicable}])},r(t.status),3)])}),128))])])])]))])}}};export{Oe as default};
