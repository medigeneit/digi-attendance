import{g as ee,f as te,x as n,r as le,h as ae,q as O,p as se,c as f,o as d,a as t,j as x,i as I,d as _,l as j,F as $,m as c,k as M,H as oe,P as S,v as ne,e as ue,b as B,t as H,w as re,s as W}from"./index-5QuK440Q.js";import{g as ie}from"./task-ByuHKAkS.js";import{u as de}from"./company-C3PLwgDn.js";import{_ as G}from"./CompanyDepartmentSelectInput-DEW22bLD.js";import{_ as me}from"./EmployeeDropdownInput-Qt2kXCE1.js";import{_ as K}from"./SearchInput-YaNJerWf.js";const pe={class:"mb-3 task-header"},ve={class:"flex justify-between items-start"},ce={key:0,class:"ml-auto flex gap-6 items-center"},fe={class:"flex flex-wrap items-center justify-center gap-2 mt-3"},xe={class:"flex flex-wrap gap-x-4 gap-y-3 justify-between"},ye={key:1,class:"relative w-full md:w-56 lg:flex-grow"},be={class:"relative"},ge={class:"w-32 relative h-10"},we={class:"flex gap-4 items-center flex-shrink-0"},ke={class:"flex gap-2"},Ve={class:"flex gap-2"},Te={class:"flex gap-2"},Ce={class:"text-gray-600 w-full md:w-32 relative"},Me={class:"flex flex-col md:flex-row mb-2 items-end mt-6 gap-6 sticky top-[4.1rem] z-40 bg-white/80"},Ae={class:"flex items-center gap-3 flex-grow flex-wrap justify-center"},he={key:0,class:"text-[9px] text-green-800"},Ue=["onClick"],De={key:1,class:"flex justify-end gap-5"},Ie={__name:"TaskHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(g,{emit:J}){const A=g,R=ee(),y=te(),w=n(p("company-id")),k=n(p("from-department-id")),b=n(p("to-department-id")),h=n(p("user-ids")),U=n(p("month")),D=n(p("status")),L=n(p("is-important")),E=n(p("is-urgent")),q=n(p("is-target")),N=n(p("search")),z=J,m=de(),V=le([]);function p(s){return{get:()=>A.modelValue[s]||"",set:e=>{z("update:modelValue",{...A.modelValue,[s]:e||void 0})}}}const Q=n(()=>X(h.value));async function P(){var s,e,r;if(!A.isMyTask){const i=(s=A.modelValue)==null?void 0:s["company-id"],a=b.value,u={...i?{company_id:i}:{},...a?{department_ids:[a]}:{}};V.value=((r=(e=await ie({params:u}))==null?void 0:e.data)==null?void 0:r.employees)||[]}}ae(async()=>{await m.fetchCompanies({with:"departments",ignore_permission:!0}),await m.fetchMyCompanies({with:"departments"}),await P()});function X(s){return Array.isArray(V.value)&&V.value.find(e=>e.id==s)||null}function Y(){h.value=""}O(()=>b.value,P),O(()=>w.value,()=>{k.value="",b.value=""});function T(s,e,{value:r,id:i,label:a,onCancel:u}={}){if(!s)return[];const o=Array.isArray(e)?e.find(v=>(v==null?void 0:v[i])==s):null;return o?[{label:a,value:typeof r=="function"?r(o):o==null?void 0:o[r],id:o==null?void 0:o[i],onCancel:u}]:[]}const Z=n(()=>{var i;const s=m.companies.reduce((a,u)=>[...a,...u.departments],[]),e=(a,{label:u,value:o,id:v,onCancel:l})=>a?[{label:u,value:o,id:v,onCancel:l}]:[],r=(a,{label:u,onCancel:o})=>{if(!a)return[];const v=new Date(a);return[{label:u,value:v.toLocaleDateString("en-US",{month:"long",year:"numeric"}),id:a,onCancel:o}]};return[...T(w.value,m.companies,{label:"Company",value:"short_name",id:"id",onCancel:()=>{w.value=""}}),...T(k.value,s,{id:"id",label:"From",value:a=>a.short_name||a.name,onCancel:()=>{k.value=""}}),...T(b.value,s,{id:"id",label:"To",value:a=>a.short_name||a.name,onCancel:()=>{b.value=""}}),...T((i=Q.value)==null?void 0:i.id,V.value,{label:"Employee",value:"name",id:"id",onCancel:Y}),...T(D.value,[{id:"only-completed",name:"Completed Only"},{id:"not-completed",name:"Not Completed"}],{label:"",value:"name",id:"id",onCancel:()=>{D.value=""}}),...e(L.value,{label:"",value:"Important ",id:!0,onCancel:()=>{L.value=""}}),...e(E.value,{label:"",value:"Urgent ",id:!0,onCancel:()=>{E.value=""}}),...e(q.value,{label:"",value:"Targeted Task",id:!0,onCancel:()=>{q.value=""}}),...r(U.value,{label:"",onCancel:()=>{U.value=""}})]}),F=n(()=>w.value?m==null?void 0:m.companies.filter(s=>s.id==w.value):m==null?void 0:m.companies);return(s,e)=>{var i,a,u,o,v;const r=se("RouterLink");return d(),f("div",null,[t("div",pe,[t("div",ve,[e[11]||(e[11]=t("h2",{class:"text-2xl font-bold text-gray-800 leading-none h-10"},"Task List",-1)),g.isMyTask?x("",!0):(d(),f("div",ce,[t("button",{onClick:e[0]||(e[0]=l=>z("clickAddTask")),class:"btn-1"},"Add Main Task / Project")]))]),t("div",fe,[t("div",xe,[_(G,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=l=>k.value=l),companies:F.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:j(()=>e[12]||(e[12]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),g.isMyTask?x("",!0):(d(),f($,{key:0},[c(y).name!=="MyRequirementTaskList"?(d(),I(G,{key:0,modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l),companies:F.value||[],class:"relative w-full md:w-40 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:j(()=>e[13]||(e[13]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):x("",!0),c(R).isAdminMood&&((a=(i=c(R))==null?void 0:i.user)==null?void 0:a.role)!=="employee"?(d(),f("div",ye,[t("div",be,[_(me,{employees:V.value,modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=l=>h.value=l),class:"border-2 border-gray-300 rounded h-[40px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),e[14]||(e[14]=t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Employee ",-1))]),e[15]||(e[15]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Employee ",-1))])):x("",!0)],64)),t("div",ge,[e[17]||(e[17]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),M(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>D.value=l),class:"h-full text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},e[16]||(e[16]=[t("option",{value:""},"--ALL TASKS--",-1),t("option",{value:"not-completed"},"Not Completed",-1),t("option",{value:"only-completed"},"Completed",-1)]),512),[[oe,D.value]])]),t("div",we,[t("label",ke,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=l=>L.value=l)},null,512),[[S,L.value]]),e[18]||(e[18]=t("span",null,"Important",-1))]),t("label",Ve,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=l=>E.value=l)},null,512),[[S,E.value]]),e[19]||(e[19]=t("span",null,"Urgent",-1))]),t("label",Te,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=l=>q.value=l)},null,512),[[S,q.value]]),e[20]||(e[20]=t("span",null,"Is Target",-1))])]),t("div",Ce,[e[21]||(e[21]=t("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),M(t("input",{id:"month-filter","onUpdate:modelValue":e[8]||(e[8]=l=>U.value=l),type:"month",class:"h-10 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[ne,U.value]])])]),g.isMyTask?(d(),I(K,{key:0,modelValue:N.value,"onUpdate:modelValue":e[9]||(e[9]=l=>N.value=l),class:"w-full md:w-64 lg:w-64 md:ml-auto"},null,8,["modelValue"])):x("",!0)])]),t("div",Me,[g.isMyTask?x("",!0):(d(),I(K,{key:0,modelValue:N.value,"onUpdate:modelValue":e[10]||(e[10]=l=>N.value=l),class:"w-full md:w-64 md:ml-auto"},null,8,["modelValue"])),t("div",Ae,[(d(!0),f($,null,ue(Z.value,l=>(d(),f("div",{key:l.label||l.value,class:"flex-shrink-0 text-xs bg-gray-50 border border-gray-300 rounded-md px-2 flex gap-1"},[t("div",null,[l.label?(d(),f("span",he,H(l.label)+": ",1)):x("",!0),B(H(l.value),1)]),t("button",{type:"button",class:"text-gray-400 hover:text-red-400",onClick:re(l.onCancel,["prevent"])},e[22]||(e[22]=[t("i",{class:"fas fa-times-circle"},null,-1)]),8,Ue)]))),128))]),g.isMyTask?x("",!0):(d(),f("div",De,[_(r,{class:W(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((u=c(y).query)==null?void 0:u.view)==="userwise"?"bg-blue-500 text-white":""]),to:{query:{...c(y).query,view:"userwise"}}},{default:j(()=>e[23]||(e[23]=[B(" User Wise List ")])),_:1,__:[23]},8,["class","to"]),_(r,{class:W(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((o=c(y).query)==null?void 0:o.view)!=="userwise"?"bg-blue-500 text-white":""]),to:{query:{...Object.keys(((v=c(y))==null?void 0:v.query)||{}).filter(l=>{var C;return((C=c(y))==null?void 0:C.query[l])!=="userwise"}).reduce((l,C)=>({...l,[C]:c(y).query[C]}),{})}}},{default:j(()=>e[24]||(e[24]=[B(" Department Wise List ")])),_:1,__:[24]},8,["class","to"])]))])])}}};export{Ie as _};
