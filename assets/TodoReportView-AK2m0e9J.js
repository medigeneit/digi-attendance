import{_ as Je,r as $,G as Re,x as _,q as W,c as d,o,a as e,O as Te,w as J,s as h,d as q,l as Se,v as Ie,f as Ke,u as Qe,D as $e,h as oe,y as Ne,k as w,j as Ye,m as X,n as P,t as p,F as T,e as j,b as Z,N as Xe}from"./index-0W4OwH8Z.js";import{L as Ze}from"./LoaderView-B8CObJOS.js";import{_ as qe}from"./EmployeeFilter-Bb7cAEup.js";import{U as Ge}from"./UserChip-4H_VF7Jm.js";import{g as Ce,b as H}from"./datetime-Du_mcDA9.js";import{u as et}from"./attendance-ChqgbRGQ.js";import{u as tt}from"./company-C8nG-hHn.js";import{u as nt}from"./department-1Allel5r.js";import{u as st}from"./useTodoDateStore-FljzG8hB.js";import"./EmployeeDropdownInput-Cx2swdRO.js";import"./SelectDropdown-BvC8BCQ3.js";import"./user-DpT7Nwn_.js";import"./url-CePbr-gY.js";const at={class:"px-4 py-4 md:py-3 bg-white rounded-md border"},rt={class:"flex flex-wrap items-center gap-3"},ot=["disabled"],dt={class:"print-hide"},lt={class:"flex flex-col md:flex-row flex-wrap items-end md:ml-auto w-full md:w-auto gap-x-3 gap-y-4 print-hide"},it={class:"flex items-center justify-between w-full md:w-auto gap-3"},pt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},ut={class:"relative h-[32px] w-[150px] sm:w-[170px]"},mt={__name:"TodoReportHeading",props:{loading:{type:Boolean,default:!1},companyId:{type:[String,Number],default:""},departmentId:{type:[String,Number],default:""},employeeId:{type:[String,Number],default:""},lineType:{type:String,default:"all"},startDate:{type:String,default:""},endDate:{type:String,default:""}},emits:["reloadClick","change"],setup(B,{expose:S,emit:G}){const u=B,E=$(null),O=G,i=Re({companyId:String(u.companyId||""),departmentId:u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",employeeId:String(u.employeeId||""),lineType:u.lineType||"all",startDate:u.startDate||"",endDate:u.endDate||""}),z=_(()=>({companyId:i.companyId,departmentId:i.departmentId,employeeId:i.employeeId,lineType:i.lineType,startDate:i.startDate,endDate:i.endDate}));function K(){O("change",{...z.value})}W(()=>[u.companyId,u.departmentId,u.employeeId,u.lineType,u.startDate,u.endDate],()=>{i.companyId=String(u.companyId||""),i.departmentId=u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",i.employeeId=String(u.employeeId||""),i.lineType=u.lineType||"all",i.startDate=u.startDate||"",i.endDate=u.endDate||""});function M(t){const l=new Date(i.startDate);l.setDate(l.getDate()+t),i.startDate=l.toISOString().split("T")[0];const c=new Date(i.endDate);c.setDate(c.getDate()+t),i.endDate=c.toISOString().split("T")[0]}return W(z,K,{deep:!0}),S({employees:_(()=>{var t;return((t=E.value)==null?void 0:t.employees)||[]})}),(t,l)=>(o(),d("div",at,[e("div",rt,[Te(t.$slots,"before",{},void 0,!0),e("button",{class:h(["btn-icon print-hide",{"animate-spin !bg-opacity-0":B.loading}]),onClick:l[0]||(l[0]=J(c=>O("reloadClick"),["prevent"])),disabled:B.loading,title:"Reload"},[e("i",{class:h(["fas fa-redo",[B.loading?"text-gray-400":"text-gray-500"]])},null,2)],10,ot),e("span",dt,[Te(t.$slots,"after",{},void 0,!0)]),e("div",lt,[q(qe,{ref_key:"employeeFilterRef",ref:E,company_id:i.companyId,"onUpdate:company_id":l[1]||(l[1]=c=>i.companyId=c),department_id:i.departmentId,"onUpdate:department_id":l[2]||(l[2]=c=>i.departmentId=c),employee_id:i.employeeId,"onUpdate:employee_id":l[3]||(l[3]=c=>i.employeeId=c),line_type:i.lineType,"onUpdate:line_type":l[4]||(l[4]=c=>i.lineType=c),"with-type":!0,class:"flex-1 gap-y-4 md:flex items-center justify-between w-full md:w-auto"},null,8,["company_id","department_id","employee_id","line_type"]),e("div",it,[e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:l[5]||(l[5]=J(()=>M(-1),["prevent"]))},l[9]||(l[9]=[e("span",{class:"fas fa-arrow-left"},null,-1)])),e("div",pt,[l[10]||(l[10]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Start Date",-1)),Se(e("input",{type:"date","onUpdate:modelValue":l[6]||(l[6]=c=>i.startDate=c),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ie,i.startDate]])]),e("div",ut,[l[11]||(l[11]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"End Date",-1)),Se(e("input",{type:"date","onUpdate:modelValue":l[7]||(l[7]=c=>i.endDate=c),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ie,i.endDate]])]),e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:l[8]||(l[8]=J(()=>M(1),["prevent"]))},l[12]||(l[12]=[e("span",{class:"fas fa-arrow-right"},null,-1)]))])])])]))}},yt=Je(mt,[["__scopeId","data-v-c25b1fcb"]]),ct={class:"container print:flex-grow mx-auto print:w-full print:px-0 print:py-0"},gt=["disabled"],xt={key:0,class:"bg-white border rounded-md mb-2 p-4 text-sm print:border-0 print:mb-2 print:px-0 print:w-full relative overflow-visible z-40"},bt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-y-2 gap-x-6"},ft={class:"font-medium text-gray-800"},vt={class:"col-span-2"},wt={class:"font-medium text-gray-800"},ht={class:"inline-flex items-center gap-5 font-bold"},_t={class:"text-gray-700"},Dt={key:0,class:"mt-2 w-[280px] sm:w-[320px] lg:w-[280px] xl:w-[320px] bg-white border border-gray-200 rounded-md p-3 shadow-lg text-left absolute right-0"},kt={class:"flex items-center justify-between mb-2"},Tt={class:"text-[11px] text-gray-500"},St={class:"space-y-3 max-h-56 overflow-auto pr-1 z-50"},It={class:"pt-2 border-t border-dashed border-gray-200"},$t={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1 flex items-center justify-between"},Nt={class:"flex items-center gap-2"},Ct={key:0,class:"bg-red-500 rounded-md px-1.5 text-white text-center"},Rt={key:0,class:"flex flex-wrap gap-2"},At={key:0,class:"text-xs text-gray-400"},Et=["title"],Lt={class:"block max-w-[160px] truncate"},Ut={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1"},jt={key:0,class:"bg-green-500 rounded-md px-1.5 text-white text-center"},Bt={class:"flex flex-wrap gap-2"},Ot={key:0,class:"text-xs text-gray-400"},zt=["title"],Mt={class:"block max-w-[160px] truncate"},Vt={key:1,class:"text-center text-gray-500 py-12 border bg-gray-50 rounded-md min-h-[70vh] flex flex-col items-center justify-center space-y-4"},Ft={key:3,class:"overflow-x-auto md:overflow-clip bg-white border border-t-0 rounded-md shadow-sm print:shadow-none print:rounded-none print:border-gray-400"},Pt={class:"min-w-full text-left text-sm border-separate border-spacing-0"},Ht={class:"bg-gray-50 text-gray-600 uppercase tracking-wide text-xs"},Wt={class:"border-y print:border-gray-400 sticky md:top-[123px] z-30 rounded-t-md"},Jt={class:"px-4 py-3 border md:w-[100px] print:w-auto print:border-l print:border-l-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center whitespace-nowrap"},Kt={class:"flex items-center justify-between gap-2"},Qt={class:"ml-1 text-[10px] text-gray-500"},Yt={key:0,class:"px-4 py-3 border bg-white bg-opacity-70 backdrop-blur-sm text-center"},Xt={class:"divide-y divide-gray-200"},Zt={key:0},qt=["colspan"],Gt=["rowspan"],en={class:"sticky top-[180px] bg-white text-center"},tn=["rowspan"],nn={class:"flex"},sn={key:0,class:"text-xs text-gray-500"},an=["rowspan"],rn={class:"sticky top-[180px] bg-white"},on={key:0,class:"text-[11px] text-gray-500 mt-2"},dn={key:0,class:"grid grid-cols-2 gap-4"},ln={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},pn={class:"flex gap-1 items-center justify-between"},un={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},mn={class:"flex gap-1 items-center justify-between"},yn={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},cn={class:"flex gap-1 items-center justify-between"},gn={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},xn={class:"flex gap-1 items-center justify-between"},bn={key:1,class:"mt-1 text-gray-500 text-center"},fn=["rowspan"],vn={class:"sticky top-[180px] bg-white"},wn={class:"font-medium"},hn={class:"text-gray-400 mr-2"},_n={class:"text-xs text-gray-500"},de="border-b-2 border-b-blue-200",jn={__name:"TodoReportView",setup(B){var ye,ce,ge,xe,be,fe;const S=Ke(),G=Qe(),u=st(),E=tt(),O=nt(),{companies:i}=$e(E),{departments:z}=$e(O),K=$(null),M=Ce(new Date),t=Re({companyId:((ye=S.query)==null?void 0:ye.company_id)||"",departmentId:((ce=S.query)==null?void 0:ce.department_id)||"",employeeId:((ge=S.query)==null?void 0:ge.employee_id)||"",lineType:((xe=S.query)==null?void 0:xe.line_type)||"all",startDate:((be=S.query)==null?void 0:be.start_date)||M,endDate:((fe=S.query)==null?void 0:fe.end_date)||M}),l=_(()=>{if(!t.startDate||!t.endDate)return[];const s=new Date(t.startDate),n=new Date(t.endDate);if(Number.isNaN(s.getTime())||Number.isNaN(n.getTime()))return[];const r=s<=n?1:-1,m=new Date(s),y=[];for(;y.push(Ce(m)),m.getTime()!==n.getTime();)m.setDate(m.getDate()+r);return y}),c=_(()=>{var n;return[...((n=K.value)==null?void 0:n.employees)||[]].filter(r=>t.employeeId?String(r.id)===String(t.employeeId):!0).sort((r,m)=>{var y,f;return(((y=r.user)==null?void 0:y.name)||"").localeCompare(((f=m.user)==null?void 0:f.name)||"")}).map(r=>{const m=u.todo_dates.filter(a=>{var b;return String((b=a.user)==null?void 0:b.id)===String(r.id)});let y=l.value.map(a=>{const b=m.filter(I=>I.date===a);return b.length?{date:a,rowSpan:b.length,todos:b}:{date:a,rowSpan:1,todos:[{id:`empty-${r.id}-${a}`,isPlaceholder:!0,title:"",date:a}]}});y.length||(y=[{date:null,rowSpan:1,todos:[{id:`empty-${r.id}`,isPlaceholder:!0,title:""}]}]);const f=y.reduce((a,b)=>a+b.rowSpan,0);return{user:r,dates:y,rowSpan:Math.max(1,f)}})}),Ae=_(()=>{if(!t.startDate||!t.endDate)return"";const s=H(t.startDate,{weekDay:"long"}),n=H(t.endDate,{weekDay:"long"});return`${s} ~ ${n}`}),Ee=_(()=>E.employees||[]),Le={all:"All Types",executive:"Executive",support_staff:"Support Staff",doctor:"Doctor",academy_body:"Academy Body"},C=_(()=>{var y,f,a,b,I,R,A,g;const s=t.companyId&&((y=i.value)!=null&&y.length)?(f=i.value.find(v=>String(v.id)===String(t.companyId)))==null?void 0:f.name:null,n=t.departmentId&&((a=z.value)!=null&&a.length)?(b=z.value.find(v=>String(v.id)===String(t.departmentId)))==null?void 0:b.name:null;let r=null;t.employeeId&&(r=((R=(I=Ee.value)==null?void 0:I.find(v=>String(v.id)===String(t.employeeId)))==null?void 0:R.name)||((g=(A=c.value.find(v=>{var L;return String(((L=v.user)==null?void 0:L.id)||"")===String(t.employeeId)}))==null?void 0:A.user)==null?void 0:g.name)||null);const m=t.startDate===t.endDate&&t.startDate?H(t.startDate,{weekDay:"long"}):Ae.value||"-";return{company:s||(t.companyId?`#${t.companyId}`:"All Companies"),department:n||(t.departmentId?`#${t.departmentId}`:"All Departments"),employee:r||(t.employeeId?`#${t.employeeId}`:"All Employees"),lineType:Le[t.lineType]||t.lineType||"All Types",dateRange:m}}),U=$(!1),ee=$(null),te=_(()=>{var s;return((s=c.value)==null?void 0:s.length)||0}),le=_(()=>{var s,n;return Math.max(0,te.value-(((n=(s=D.value)==null?void 0:s.withoutTodos)==null?void 0:n.length)||0))}),Q=$(!0),ne=$(!1),V=$(!1),se=$(null),ie=s=>{U.value&&ee.value&&(ee.value.contains(s.target)||(U.value=!1))},D=_(()=>{var s;return(s=c.value)!=null&&s.length?c.value.reduce((n,r,m)=>{var a,b,I,R,A,g;const y=r.dates.reduce((v,L)=>v+L.todos.filter(N=>!N.isPlaceholder).length,0),f={id:((a=r.user)==null?void 0:a.id)??((b=r.user)==null?void 0:b.user_id)??((I=r.user)==null?void 0:I.uid)??((R=r.user)==null?void 0:R.email)??`${((A=r.user)==null?void 0:A.name)||"unknown"}-${m}`,name:((g=r.user)==null?void 0:g.name)||"Unknown user"};return y>0?n.withTodos.push(f):n.withoutTodos.push(f),n},{withTodos:[],withoutTodos:[]}):{withTodos:[],withoutTodos:[]}}),pe=_(()=>{if(!V.value)return c.value;const s=new Set((D.value.withoutTodos||[]).map(n=>String(n.id??n.name??"")));return c.value.filter(n=>{var m,y,f,a,b;const r=((m=n.user)==null?void 0:m.id)??((y=n.user)==null?void 0:y.user_id)??((f=n.user)==null?void 0:f.uid)??((a=n.user)==null?void 0:a.email)??((b=n.user)==null?void 0:b.name)??"";return!s.has(String(r))})});function Ue(){V.value=!V.value,ne.value=V.value}const ue=s=>{ne.value&&se.value&&(se.value.contains(s.target)||(ne.value=!1))},je=s=>s==="COMPLETED"?"bg-green-100 text-green-700 border border-green-200":s==="WORKING"?"bg-blue-100 text-blue-700 border border-blue-200":s==="PENDING"?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-gray-100 text-gray-700 border border-gray-200";function Be(){G.replace({query:{...S.query,company_id:t.companyId||void 0,department_id:t.departmentId||void 0,employee_id:t.employeeId||void 0,line_type:t.lineType||void 0,start_date:t.startDate||void 0,end_date:t.endDate||void 0}})}async function ae(){!t.companyId||!t.startDate||!t.endDate||(await u.fetchTodoDates({"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate}),Fe())}function Oe(s){t.companyId=s.companyId||"",t.departmentId=s.departmentId||"",t.employeeId=s.employeeId||"",t.lineType=s.lineType||"all",t.startDate=s.startDate||"",t.endDate=s.endDate||""}function ze(){window.print()}const Y=_(()=>t.startDate===t.endDate);W(()=>t.companyId,s=>{s&&(O.fetchDepartments(s),E.fetchEmployee(s))},{immediate:!0}),W(()=>({...t}),(s,n)=>{JSON.stringify(s)!==JSON.stringify(n)&&(Be(),ae())},{deep:!0}),W(()=>S.query,s=>{t.companyId=(s==null?void 0:s.company_id)||t.companyId,t.departmentId=(s==null?void 0:s.department_id)||t.departmentId,t.employeeId=(s==null?void 0:s.employee_id)||t.employeeId,t.lineType=(s==null?void 0:s.line_type)||t.lineType,t.startDate=(s==null?void 0:s.start_date)||t.startDate,t.endDate=(s==null?void 0:s.end_date)||t.endDate}),oe(()=>{E.fetchCompanies({ignore_permission:!0}),ae()}),oe(()=>{document.addEventListener("click",ie,!0)}),Ne(()=>{document.removeEventListener("click",ie,!0)}),oe(()=>{document.addEventListener("click",ue,!0)}),Ne(()=>{document.removeEventListener("click",ue,!0)});const Me=et(),me=$([]),re=$(!1),Ve=_(()=>t.startDate===t.endDate),Fe=async()=>{if(!(!t.companyId||!t.startDate||!t.endDate)){re.value=!0;try{const s=await Me.getDateRangeAttendanceSummary(t.startDate,t.endDate,t.companyId,t.lineType,t.employeeId,!0);s&&(me.value=s)}finally{re.value=!1}}};function Pe(s,n){var m;const r=((m=me.value)==null?void 0:m.find(y=>String(y.employee_id)===String(s)))||null;return r?!n&&Ve.value?(r==null?void 0:r.attendance[t.startDate])||null:(r==null?void 0:r.attendance[n])||null:null}function He(s,n){const r=Pe(s,n);return r?{hasData:!0,in:r.in||"-",out:r.out||"-",late:r.late||"-",early:r.early||"-",comment:r.comment||"-"}:{hasData:!1,in:"-",out:"-",late:"-",early:"-",comment:"-"}}function We(s,n,r,m){const y=r===s.dates.length-1,f=m===n.todos.length-1;return y&&f}function F(s,n,r,m){return We(s,n,r,m)?de:""}return(s,n)=>{var r,m,y,f;return o(),d("div",ct,[q(yt,{ref_key:"headingRef",ref:K,"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate,loading:P(u).loading,class:"mb-4 print:px-0 print:py-0 print:mb-2 print:border-0 print:border-b print:border-gray-400 print:rounded-none print:w-full sticky top-[58px] z-50",onChange:Oe,onReloadClick:ae},{before:X(()=>n[3]||(n[3]=[e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-800"},"Todo Report")],-1)])),after:X(()=>[e("button",{type:"button",class:"btn-icon print-hide disabled:opacity-35 cursor-pointer disabled:cursor-not-allowed",onClick:J(ze,["prevent"]),disabled:P(u).loading},n[4]||(n[4]=[e("i",{class:"fas fa-print"},null,-1)]),8,gt)]),_:1},8,["company-id","department-id","employee-id","line-type","start-date","end-date","loading"]),t.companyId&&t.startDate&&t.endDate?(o(),d("div",xt,[e("div",bt,[e("div",null,[n[5]||(n[5]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Company",-1)),e("div",ft,p(C.value.company),1)]),e("div",null,[n[6]||(n[6]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Department",-1)),e("div",{class:h(["font-medium",[C.value.department=="All Departments"?"text-gray-400":"text-gray-800"]])},p(C.value.department),3)]),e("div",null,[n[7]||(n[7]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Line Type",-1)),e("div",{class:h(["font-medium",[C.value.lineType=="All Types"?"text-gray-400":"text-gray-800"]])},p(C.value.lineType),3)]),e("div",null,[n[8]||(n[8]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Employee",-1)),e("div",{class:h(["font-medium",[C.value.employee=="All Employees"?"text-gray-400":"text-gray-800"]])},p(C.value.employee),3)]),e("div",vt,[n[9]||(n[9]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Date",-1)),e("div",wt,p(C.value.dateRange),1)]),e("div",{ref_key:"assignmentSummaryRef",ref:ee,class:"print-hide relative"},[e("button",{type:"button",class:"px-3 bg-white text-gray-700 hover:bg-gray-50 w-full text-bg text-right",onClick:n[0]||(n[0]=a=>U.value=!U.value)},[n[10]||(n[10]=e("div",{class:"uppercase"},"Todo given",-1)),e("div",ht,[e("div",_t,p(le.value)+" / "+p(te.value),1),e("i",{class:h(["fas",[U.value?"fa-chevron-up":"fa-chevron-down"]])},null,2)])]),U.value?(o(),d("div",Dt,[e("div",kt,[n[11]||(n[11]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Todo Status",-1)),e("div",Tt,p(le.value)+" given / "+p(te.value)+" selected ",1)]),e("div",St,[e("div",It,[e("div",$t,[e("div",Nt,[n[12]||(n[12]=e("span",null,"Not given todos",-1)),(r=D.value.withoutTodos)!=null&&r.length?(o(),d("span",Ct,p((m=D.value.withoutTodos)==null?void 0:m.length),1)):w("",!0)]),e("button",{type:"button",class:"text-[10px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:n[1]||(n[1]=a=>Q.value=!Q.value)},p(Q.value?"Hide":"Show"),1)]),Q.value?(o(),d("div",Rt,[D.value.withoutTodos.length?w("",!0):(o(),d("span",At," Everyone has todos ")),(o(!0),d(T,null,j(D.value.withoutTodos,a=>(o(),d("span",{key:`without-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-red-50 text-red-700 border border-red-100 text-xs max-w-full",title:a.name},[n[13]||(n[13]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",Lt,p(a.name),1)],8,Et))),128))])):w("",!0)]),e("div",null,[e("div",Ut,[n[14]||(n[14]=Z(" Given todos ")),(y=D.value.withTodos)!=null&&y.length?(o(),d("span",jt,p((f=D.value.withTodos)==null?void 0:f.length),1)):w("",!0)]),e("div",Bt,[D.value.withTodos.length?w("",!0):(o(),d("span",Ot," No todos assigned ")),(o(!0),d(T,null,j(D.value.withTodos,a=>(o(),d("span",{key:`with-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-50 text-green-700 border border-green-100 text-xs max-w-full",title:a.name},[n[15]||(n[15]=e("i",{class:"fas fa-check-circle"},null,-1)),e("span",Mt,p(a.name),1)],8,zt))),128))])])])])):w("",!0)],512)])])):w("",!0),!t.companyId||!t.startDate||!t.endDate?(o(),d("div",Vt,n[16]||(n[16]=[e("i",{class:"fad fa-tasks text-4xl"},null,-1),e("div",{class:"empty-state glass-panel"},[e("p",{class:"text-base font-semibold text-rose-500"}," Select company and date range to view the report. "),e("p",{class:"text-sm text-gray-500"},"Use the filter set above to load records.")],-1)]))):P(u).loading?(o(),Ye(Ze,{key:2},{default:X(()=>n[17]||(n[17]=[Z("Loading report...")])),_:1,__:[17]})):(o(),d("div",Ft,[e("table",Pt,[e("thead",Ht,[e("tr",Wt,[n[19]||(n[19]=e("th",{class:"px-4 py-3 border w-[10px] bg-white bg-opacity-70 backdrop-blur-sm rounded-tl-md print:rounded-tl-none text-center"}," sl ",-1)),e("th",Jt,[e("div",Kt,[n[18]||(n[18]=e("span",null,"Employee Name",-1)),t.employeeId?w("",!0):(o(),d("div",{key:0,class:"relative hidden md:block print:hidden",ref_key:"tableNoTodosRef",ref:se},[e("button",{type:"button",class:"text-[11px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:n[2]||(n[2]=J(a=>Ue(),["stop"]))},[Z(" No Todos ("+p(D.value.withoutTodos.length)+") ",1),e("span",Qt,p(V.value?"Hidden":"Showing"),1)])],512))])]),Y.value?w("",!0):(o(),d("th",Yt," Date ")),n[20]||(n[20]=e("th",{class:"px-4 py-3 border bg-white text-center"},"Todo",-1)),n[21]||(n[21]=e("th",{class:"px-4 py-3 border print:border-r print:border-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center rounded-tr-md print:rounded-tr-none"}," Status ",-1))])]),e("tbody",Xt,[pe.value.length===0?(o(),d("tr",Zt,[e("td",{colspan:Y.value?4:5,class:"px-4 py-6 text-center text-gray-500"},n[22]||(n[22]=[e("div",null,[e("i",{class:"fas fa-tasks fa-2x text-gray-300 mb-2"})],-1),e("div",null,"No todos.",-1)]),8,qt)])):w("",!0),(o(!0),d(T,null,j(pe.value,(a,b)=>{var I,R,A;return o(),d(T,{key:((I=a.user)==null?void 0:I.id)||(((A=(R=a.dates[0])==null?void 0:R.todos[0])==null?void 0:A.id)??Math.random())},[(o(!0),d(T,null,j(a.dates,(g,v)=>{var L;return o(),d(T,{key:`${((L=a.user)==null?void 0:L.id)||"u"}-${g.date}`},[(o(!0),d(T,null,j(g.todos,(N,k)=>{var ve,we,he,_e;return o(),d("tr",{key:N.id||`${((ve=a.user)==null?void 0:ve.id)||"u"}-${g.date||"empty"}-${k}`,class:"border odd:bg-white even:bg-gray-50 hover:bg-gray-100"},[v===0&&k===0?(o(),d("td",{key:0,rowspan:a.rowSpan||1,class:h(["px-4 py-3 align-top font-bold text-xl text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",de])},[e("div",en,p(b+1),1)],8,Gt)):w("",!0),v===0&&k===0?(o(),d("td",{key:1,rowspan:a.rowSpan||1,class:h(["px-4 py-3 align-top font-medium text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",de])},[q(Ge,{user:a.user,class:"sticky top-[180px] bg-white"},{trigger:X(({user:x})=>{var De,ke;return[e("div",nn,[q(Xe,{size:"medium",user:x,class:"inline-block mr-2 align-middle"},null,8,["user"]),e("div",null,[e("div",null,p((x==null?void 0:x.name)||"Unknown user"),1),(De=x==null?void 0:x.department)!=null&&De.name?(o(),d("div",sn,p((ke=x==null?void 0:x.department)==null?void 0:ke.name),1)):w("",!0)])])]}),_:2},1032,["user"])],8,tn)):w("",!0),N.isPlaceholder?(o(),d(T,{key:2},[k===0&&!Y.value?(o(),d("td",{key:0,rowspan:g.rowSpan||1,class:h(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",F(a,g,v,k)])},[e("div",rn,p(P(H)(g.date)||g.date||"-"),1)],10,an)):w("",!0),e("td",{class:h(["border-l border-t border-r bg-white px-3 py-3 text-center",F(a,g,v,k)]),colspan:"2"},[n[27]||(n[27]=e("div",{class:"flex items-center justify-center gap-2 text-red-600 text-sm font-medium opacity-70"},[e("i",{class:"far fa-clipboard-list text-red-400"}),e("span",null,"No todos was provided.")],-1)),re.value?(o(),d("div",on," Loading attendanceâ€¦ ")):(o(!0),d(T,{key:1},j([He((we=a==null?void 0:a.user)==null?void 0:we.id,g==null?void 0:g.date)],x=>(o(),d("div",{key:x.comment,class:"min-w-[180px] mt-3 text-[11px] text-red-600 text-left inline-block align-top"},[x.hasData?(o(),d("div",dn,[x.in==="-"&&x.out==="-"?(o(),d("div",{key:0,class:h(["text-center flex items-center justify-center rounded-md bg-slate-50 border text-xs border-dashed px-2 py-1.5 col-span-2",[{"text-red-500 border-red-300":x.comment==="Absent","text-blue-500 border-blue-300":x.comment!=="Absent"}]])},p(x.comment),3)):(o(),d(T,{key:1},[e("div",ln,[e("div",pn,[n[23]||(n[23]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," In ",-1)),e("span",un,p(x.in),1)]),e("div",mn,[n[24]||(n[24]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Late ",-1)),e("div",null,p(x.late),1)])]),e("div",yn,[e("div",cn,[n[25]||(n[25]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Out ",-1)),e("span",gn,p(x.out),1)]),e("div",xn,[n[26]||(n[26]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Early ",-1)),e("div",null,p(x.out!=="-"?x.early:"-"),1)])])],64))])):(o(),d("div",bn," Attendance data unavailable. "))]))),128))],2)],64)):(o(),d(T,{key:3},[k===0&&!Y.value?(o(),d("td",{key:0,rowspan:g.rowSpan||1,class:h(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",F(a,g,v,k)])},[e("div",vn,p(P(H)(g.date)||g.date||"-"),1)],10,fn)):w("",!0),e("td",{class:h(["px-4 py-3 text-gray-800 border-l border-t",F(a,g,v,k)])},[e("div",wn,[e("span",hn,p(k+1)+".",1),Z(" "+p(N.title),1)]),e("div",_n,p(((he=N.todoable)==null?void 0:he.title)||((_e=N.todoable_type)==null?void 0:_e.split("\\").pop())||""),1)],2),e("td",{class:h(["px-4 py-3 border-l border-t border-r text-center",F(a,g,v,k)])},[e("span",{class:h(["text-xs font-semibold px-2.5 py-1 rounded-full",je(N.status)])},p(N.status||"N/A"),3)],2)],64))])}),128))],64)}),128))],64)}),128))])])]))])}}};export{jn as default};
