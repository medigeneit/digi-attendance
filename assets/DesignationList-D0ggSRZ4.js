import{_ as j,a as I}from"./HeaderWithButtons-CKF3eRzt.js";import{L as G}from"./LoaderView-2A27fjqL.js";import{r as g,D as N,z as F,c as i,g as O,o as n,a as e,t as p,w as z,h as v,B as V,F as C,q as M,k as S,v as $,$ as R,s as H,e as J,p as w}from"./index-DJmvO8sT.js";import{u as K}from"./company-C7SgBSYB.js";import{u as P}from"./designation-DtU5IjDQ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={key:0,class:"modal-bg"},W={class:"modal-card"},X={class:"text-lg font-semibold mb-4"},Y={class:"mb-4"},Z=["value"],ee={class:"mb-4"},te={class:"mb-4"},se={class:"mb-4"},oe={class:"mb-4"},ae={class:"flex justify-end"},le={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},ie={__name:"DesignationModal",props:{show:{type:Boolean,required:!0},designation:{type:Object,default:null}},emits:["close","save"],setup(k,{emit:c}){const d=k,b=c,x=K(),m=g(!1),D=g(!1),t=N({id:null,company_id:"",title:"",grade:"",description:"",status:"Active"}),f=()=>{m.value=!1,t.id=null,t.company_id="",t.title="",t.grade="",t.description="",t.status="Active"};F(()=>d.designation,a=>{a&&Object.keys(a).length>0?(m.value=!0,t.id=a.id||null,t.company_id=a.company_id||"",t.title=a.title||"",t.grade=a.grade||"",t.description=a.description||"",t.status=a.status||"Active"):f()},{immediate:!0,deep:!0}),F(()=>d.show,async a=>{a&&!D.value&&await _()});const r=()=>{b("save",{...t}),f(),h()},h=()=>{f(),b("close")},_=async()=>{try{await x.fetchCompanies(),D.value=!0}catch(a){console.error("Failed to fetch companies:",a)}};return(a,s)=>k.show?(n(),i("div",Q,[e("div",W,[e("h2",X,p(m.value?"Edit Designation":"Add Designation"),1),e("form",{onSubmit:z(r,["prevent"])},[e("div",Y,[s[6]||(s[6]=e("label",{for:"company_id",class:"block text-sm font-medium mb-2"},"Company",-1)),v(e("select",{id:"company_id","onUpdate:modelValue":s[0]||(s[0]=o=>t.company_id=o),class:"w-full border rounded px-3 py-2",required:""},[s[5]||(s[5]=e("option",{value:"",disabled:""},"Select a company",-1)),(n(!0),i(C,null,M(S(x).companies,o=>(n(),i("option",{key:o.id,value:o.id},p(o.name),9,Z))),128))],512),[[V,t.company_id]])]),e("div",ee,[s[7]||(s[7]=e("label",{for:"title",class:"block text-sm font-medium mb-2"},"Title",-1)),v(e("input",{id:"title","onUpdate:modelValue":s[1]||(s[1]=o=>t.title=o),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter designation title",required:""},null,512),[[$,t.title]])]),e("div",te,[s[8]||(s[8]=e("label",{for:"grade",class:"block text-sm font-medium mb-2"},"Grade",-1)),v(e("input",{id:"grade","onUpdate:modelValue":s[2]||(s[2]=o=>t.grade=o),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter grade (optional)"},null,512),[[$,t.grade]])]),e("div",se,[s[9]||(s[9]=e("label",{for:"description",class:"block text-sm font-medium mb-2"},"Description",-1)),v(e("textarea",{id:"description","onUpdate:modelValue":s[3]||(s[3]=o=>t.description=o),class:"w-full border rounded px-3 py-2",placeholder:"Enter description"},null,512),[[$,t.description]])]),e("div",oe,[s[11]||(s[11]=e("label",{for:"status",class:"block text-sm font-medium mb-2"},"Status",-1)),v(e("select",{id:"status","onUpdate:modelValue":s[4]||(s[4]=o=>t.status=o),class:"w-full border rounded px-3 py-2",required:""},s[10]||(s[10]=[e("option",{value:"Active"},"Active",-1),e("option",{value:"Inactive"},"Inactive",-1)]),512),[[V,t.status]])]),e("div",ae,[e("button",{type:"button",onClick:h,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2"}," Cancel "),e("button",le,p(m.value?"Update":"Create"),1)])],32)])])):O("",!0)}},ne={class:"my-container space-y-4"},de={key:0,class:"text-center py-4"},re={key:1,class:"space-y-4"},ce={key:0,class:"space-y-4"},ue={class:"title-md"},pe={class:"overflow-x-auto"},me={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},fe={class:"text-gray-600 text-sm"},ye={class:"py-3 px-2 text-left"},ve={class:"py-3 px-2 text-left"},ge={class:"py-3 px-2 text-left whitespace-nowrap"},be={class:"py-3 px-2 text-center"},xe={class:"py-3 px-2 text-center"},he={class:"flex item-center justify-center gap-4"},_e=["onClick"],we=["onClick"],Ae={__name:"DesignationList",setup(k){const c=P(),d=R(),{designations:b,loading:x,message:m,error:D}=H(c),t=g(!1),f=g(!1),r=g(null),h=()=>{r.value=null,t.value=!0},_=()=>{t.value=!1},a=l=>{r.value=l,t.value=!0},s=l=>{r.value=l,f.value=!0},o=()=>{f.value=!1},U=async l=>{try{l.id?(await c.updateDesignation(l.id,l),d.success(m)):(await c.createDesignation(l),d.success(m)),await c.fetchDesignations()}catch(u){d.error("Failed to save designation!"),console.error("Error handling save:",u)}finally{_()}},q=async()=>{if(!r.value||!r.value.id){d.error("Invalid designation selected for deletion!");return}try{await c.deleteDesignation(r.value.id),d.success("Designation deleted successfully!")}catch(l){d.error("Failed to delete designation!"),console.error("Error deleting designation:",l)}finally{o()}};return J(async()=>{try{await c.fetchDesignations()}catch(l){d.error("Failed to fetch designations!"),console.error("Error fetching designations:",l)}}),(l,u)=>{var A;return n(),i("div",ne,[w(j,{title:"Designation List",onAdd:h}),S(x)?(n(),i("div",de,[w(G)])):(n(),i("div",re,[(n(),i("div",ce,[(n(!0),i(C,null,M(S(b),(B,E)=>(n(),i("div",{key:E},[e("h2",ue,p(E),1),e("div",pe,[e("table",me,[u[2]||(u[2]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"#"),e("th",{class:"py-3 px-2 text-left"},"Title"),e("th",{class:"py-3 px-2 text-left"},"Grade"),e("th",{class:"py-3 px-2 text-center"},"Status"),e("th",{class:"py-3 px-2 text-center"},"Action")])],-1)),e("tbody",fe,[(n(!0),i(C,null,M(B,(y,L)=>(n(),i("tr",{key:y.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",ye,p(L+=1),1),e("td",ve,p(y.title),1),e("td",ge,p(y.grade),1),e("td",be,p(y.status),1),e("td",xe,[e("div",he,[e("button",{onClick:T=>a(y),class:"text-blue-600 hover:text-blue-800"},u[0]||(u[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,_e),e("button",{onClick:T=>s(y),class:"text-red-600 hover:text-red-800"},u[1]||(u[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,we)])])]))),128))])])])]))),128))]))])),w(ie,{show:t.value,designation:r.value,onClose:_,onSave:U},null,8,["show","designation"]),w(I,{show:f.value,title:"Delete Designation",message:`Are you sure you want to delete ${(A=r.value)==null?void 0:A.title}?`,onClose:o,onConfirm:q},null,8,["show","message"])])}}};export{Ae as default};
