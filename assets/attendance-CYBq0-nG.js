import{Q as D,r as y,R as g}from"./index-BwlsWjXD.js";const T=D("attendance",()=>{const v=y([]),w=y([]),p=y([]),h=y([]),f=y([]),b=y(null),L=y(null),S=y(new Date().toISOString().substring(0,7)),R=y(new Date().toISOString().substring(0,10)),e=y(null),c=y(!1);return{monthlyLogs:v,dailyLateLogs:h,monthlyLateLogs:f,summary:b,monthly_company_summary:L,selectedMonth:S,selectedDate:R,error:e,isLoading:c,dailyLogs:p,attendanceLogs:w,getMonthlyAttendanceByShift:async(l,s)=>{var t,a;if(!l||!s){e.value="Invalid user ID or month";return}c.value=!0;try{const n=await g.get(`/user/${l}/attendance/monthly/${s}`);v.value=n.data.monthly_logs,b.value=n.data.summary,e.value=null}catch(n){e.value=((a=(t=n.response)==null?void 0:t.data)==null?void 0:a.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}},getTodayAttendanceReport:async(l,s,t,a,n,r)=>{var o,d;c.value=!0;try{const u={companyId:l,departmentId:s,employee_id:t,category:a,month:n,status:r},m=await g.get("/attendance/today",{params:u});p.value=m.data,e.value=null}catch(u){e.value=((d=(o=u.response)==null?void 0:o.data)==null?void 0:d.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}},getAttendanceLateReport:async(l,s,t,a)=>{var n,r;c.value=!0;try{const o={company_id:l,employee_id:s,type:a,...a==="daily"?{date:t}:{month:t}},d=await g.get("/monthly/attendance/late-reports",{params:o});a==="daily"?h.value=d.data:a==="monthly"&&(f.value=d.data),e.value=null}catch(o){e.value=((r=(n=o.response)==null?void 0:n.data)==null?void 0:r.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}},getMonthlyAttendanceSummaryReport:async(l,s,t,a)=>{var n,r;if(!l||!a){e.value="Invalid user ID or month";return}c.value=!0;try{const o={company_id:l,employee_id:s,category:t,month:a},d=await g.get("/attendance/monthly-summary-reports",{params:o});L.value=d.data,e.value=null}catch(o){e.value=((r=(n=o.response)==null?void 0:n.data)==null?void 0:r.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}},downloadExcel:async(l,s,t)=>{var a,n;if(!l||!t){e.value="Invalid company ID or month";return}c.value=!0;try{const r={company_id:l,category:s,month:t},o=await g.get("/attendance/monthly-summary-reports?flag=excel",{params:r,responseType:"blob"}),d=window.URL.createObjectURL(new Blob([o.data])),u=document.createElement("a");u.href=d,u.setAttribute("download",`${t} attendance_summary.xlsx`),document.body.appendChild(u),u.click(),document.body.removeChild(u)}catch(r){e.value=((n=(a=r.response)==null?void 0:a.data)==null?void 0:n.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}},downloadPDF:async(l,s,t,a=0)=>{var n,r;if(!l||!t){e.value="Invalid user ID or month";return}c.value=!0;try{const o={company_id:l,category:s,month:t},d=await g.get("/attendance/monthly-summary-reports?flag=pdf",{params:o,responseType:"blob"}),u=window.URL.createObjectURL(new Blob([d.data])),m=document.createElement("a");m.href=u,m.setAttribute("download",`${t} attendance_summary.pdf`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(o){e.value=((r=(n=o.response)==null?void 0:n.data)==null?void 0:r.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}},attendanceDownloadExcel:async(l,s,t,a,n)=>{var r,o;c.value=!0;try{const d={companyId:l,employee_id:s,category:t,month:a,status:n},u=await g.get("/attendance/today?flag=excel",{params:d,responseType:"blob"}),m=window.URL.createObjectURL(new Blob([u.data])),i=document.createElement("a");i.href=m,i.setAttribute("download",`${a} attendance_summary.xlsx`),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(d){e.value=((o=(r=d.response)==null?void 0:r.data)==null?void 0:o.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}},attendanceDownloadPdf:async(l,s,t,a,n)=>{var r,o;c.value=!0;try{const d={companyId:l,employee_id:s,category:t,month:a,status:n},u=await g.get("/attendance/today?flag=pdf",{params:d,responseType:"blob"}),m=window.URL.createObjectURL(new Blob([u.data])),i=document.createElement("a");i.href=m,i.setAttribute("download",`${a} attendance_summary.pdf`),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(d){e.value=((o=(r=d.response)==null?void 0:r.data)==null?void 0:o.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}},lateReportDownloadExcel:async(l,s,t,a)=>{var n,r;if(!l){e.value="Invalid company ID or date/month";return}c.value=!0;try{const o={company_id:l,...s?{employee_id:s}:{},type:a,...a==="daily"?{date:t}:{month:t}},d=await g.get("/monthly/attendance/late-reports?flag=excel",{params:o,responseType:"blob"}),u=window.URL.createObjectURL(new Blob([d.data])),m=document.createElement("a");m.href=u;const i=`${t}-late-attendance.xlsx`;m.setAttribute("download",i),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(o){e.value=((r=(n=o.response)==null?void 0:n.data)==null?void 0:r.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}},getMonthlyAttendanceLog:async(l,s)=>{var t,a;if(!l||!s){e.value="Invalid user ID or month";return}c.value=!0;try{const n=await g.get(`/user/${l}/attendance/monthly/${s}/log`);w.value=n.data.attendance_logs}catch(n){e.value=((a=(t=n.response)==null?void 0:t.data)==null?void 0:a.message)||"Something went wrong",console.error(e.value)}finally{c.value=!1}}}});export{T as u};
