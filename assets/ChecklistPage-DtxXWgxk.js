import{P as se,r as D,m as R,Q as q,c as v,o as m,a as e,g as F,F as O,t as u,j as G,M as ae,y as H,x as Y,h as Z,B as le,v as de,k as j,p as oe,s as ie,A as K,K as ce,l as ue,J as ne,b as pe,e as ee,f as me}from"./index-DpOrr75N.js";import{_ as re}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W=se("checklist",()=>{const $=D(!1),N=D(null),n=D(null),S=t=>typeof t=="boolean"?t:typeof t=="number"?t===1:typeof t=="string"?t==="1"||t.toLowerCase()==="true":!!t,w=t=>{var p,a;return(t==null?void 0:t.label)??((p=t==null?void 0:t.template_item)==null?void 0:p.label)??((a=t==null?void 0:t.templateItem)==null?void 0:a.label)??""},h=t=>{var p,a;return S((t==null?void 0:t.required)??((p=t==null?void 0:t.template_item)==null?void 0:p.required)??((a=t==null?void 0:t.templateItem)==null?void 0:a.required))},_=t=>{var p,a;return Number((t==null?void 0:t.order_no)??((p=t==null?void 0:t.template_item)==null?void 0:p.order_no)??((a=t==null?void 0:t.templateItem)==null?void 0:a.order_no)??0)};function x(t){return{...t,_label:w(t),_required:h(t),_order:_(t)}}function B(t){if(!t)return null;const p=Array.isArray(t.items)?t.items.map(x):[];return p.sort((a,r)=>a._order-r._order),{...t,items:p}}const f=R(()=>{var t;return((t=n.value)==null?void 0:t.items)??[]}),k=R(()=>f.value.filter(t=>t._required)),V=R(()=>{const t=k.value.length;if(!t)return 100;const p=k.value.filter(a=>a.status==="done").length;return Math.round(p/t*100)}),M=t=>(t==null?void 0:t._label)??w(t),i=t=>(t==null?void 0:t._required)??h(t);async function c(t,p){$.value=!0,N.value=null;try{const{data:a}=await q.post(`/users/${Number(t)}/checklists`,{template_id:Number(p)});n.value=B(a.data)}catch(a){N.value=a,console.error("ensureChecklist failed:",a)}finally{$.value=!1}}async function d(t,p){$.value=!0,N.value=null;try{const{data:a}=await q.get(`/users/${Number(t)}/checklists/${Number(p)}`);n.value=B(a.data)}catch(a){N.value=a,console.error("fetchChecklist failed:",a)}finally{$.value=!1}}async function I(t,p){var b;const a=((b=n.value)==null?void 0:b.items)||[],r=a.findIndex(A=>A.id===t.id),o=r>=0?a[r]:t,s={...o};Object.assign(o,p);try{const{data:A}=await q.patch(`/checklist-items/${o.id}`,p),g=x({...o,...(A==null?void 0:A.data)||{}});a[r]=g}catch(A){throw r>=0&&(a[r]=x(s)),A}}async function C(t,{deleteDocument:p=!0,force:a=!1}={}){var g,T,U;console.log("detachAttachment",t,{deleteDocument:p,force:a});const r=((g=n.value)==null?void 0:g.items)||[],o=typeof t=="object"?t==null?void 0:t.id:t;if(!o)return{ok:!0,data:null};const s=r.findIndex(E=>E.id===Number(o)),b=s>=0?r[s]:{id:Number(o)};if(!(b!=null&&b.attachment_id)&&!(b!=null&&b.attachment))return{ok:!0,data:b};const A=s>=0?{...r[s]}:null;s>=0&&(r[s]={...r[s],attachment_id:null,attachment:null});try{const{data:E}=await q.patch(`/checklist-items/${o}/detach-attachment`,{delete_document:!!p,force:!!a}),P={...(E==null?void 0:E.data)||{}};return s>=0&&(r[s]={...r[s],...P}),(T=window==null?void 0:window.notify)!=null&&T.success&&window.notify.success("Attachment removed"),{ok:!0,data:P}}catch(E){throw s>=0&&A&&(r[s]=A),(U=window==null?void 0:window.notify)!=null&&U.error&&window.notify.error("Failed to remove attachment"),E}}async function l(t){const p=new FormData;p.append("file",t);const{data:a}=await q.post("/documents",p,{headers:{"Content-Type":"multipart/form-data"}});return a.data}async function y(){$.value=!1,N.value=null,n.value=null}return{loading:$,error:N,checklist:n,items:f,requiredItems:k,completion:V,labelOf:M,requiredOf:i,ensureChecklist:c,fetchChecklist:d,saveItem:I,uploadDocument:l,reset:y,detachAttachment:C}}),_e={class:"min-w-0"},ve={class:"flex items-center gap-2 min-w-0"},be=["href","title"],he={class:"inline-flex h-4 w-4 items-center justify-center"},fe=["src"],ye={key:1,class:"h-4 w-4 text-gray-500",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true"},ge={class:"truncate"},xe=["disabled"],we=["disabled"],ke=["disabled"],$e=["disabled"],Ce={key:2,class:"h-4 w-4 animate-spin text-gray-500",viewBox:"0 0 24 24",fill:"none","aria-label":"Uploading"},Ne={key:0,class:"mt-1 h-[3px] w-full overflow-hidden rounded bg-gray-200"},Ie={key:1,class:"mt-1 truncate text-[11px] text-rose-600",role:"alert"},te=10*1024*1024,Se=".jpg,.jpeg,.png,.pdf,.doc,.docx",Me={__name:"AttachmentUploader",props:{itemId:{type:[Number,String],required:!0},modelValue:{type:[Number,null],default:null},current:{type:Object,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","update:current","uploaded","detached"],setup($,{emit:N}){const n=$,S=N,w=W(),h=D(null),_=D(!1),x=D(""),B=D(0),f=D(!1),k=["image/jpeg","image/png","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],V=R(()=>{var a,r;return!!((a=n.current)!=null&&a.url||(r=n.current)!=null&&r.path)}),M=R(()=>{var a,r;return((a=n.current)==null?void 0:a.url)||((r=n.current)==null?void 0:r.path)||null}),i=R(()=>{var a,r;return((a=n.current)==null?void 0:a.name)||((r=n.current)==null?void 0:r.original_name)||d(M.value)||"Document"}),c=R(()=>{var a;return(((a=n.current)==null?void 0:a.mime)||"").startsWith("image/")});function d(a){if(!a)return"";try{return decodeURIComponent(a.split("/").pop().split("?")[0])}catch{return""}}function I(a){const r=["B","KB","MB","GB"];let o=0,s=a;for(;s>=1024&&o<r.length-1;)s/=1024,o++;return`${s.toFixed(o?1:0)} ${r[o]}`}function C(a){return a?a.size>te?`Max ${I(te)}`:k.includes(a.type)?"":"Unsupported type":"No file selected"}async function l(a){var o,s;const r=C(a);if(r){x.value=r;return}if(!n.disabled){_.value=!0,x.value="",B.value=0,f.value=!1;try{const b=await w.uploadDocument(a,{onProgress:A=>{f.value=!0,B.value=A}});S("update:modelValue",b.id),S("uploaded",b),(o=window==null?void 0:window.notify)!=null&&o.success&&window.notify.success("File uploaded")}catch(b){console.error(b),x.value="Upload failed",(s=window==null?void 0:window.notify)!=null&&s.error&&window.notify.error("Upload failed")}finally{_.value=!1,B.value=0,f.value=!1,h.value&&(h.value.value="")}}}function y(a){var o;const r=(o=a.target.files)==null?void 0:o[0];r&&l(r)}function t(){var a;_.value||n.disabled||(a=h.value)==null||a.click()}const p=async()=>{var a,r;if(!(_.value||n.disabled)){_.value=!0,x.value="";try{const o=await w.detachAttachment(n.itemId,{deleteDocument:!0});S("update:modelValue",null),S("update:current",null),S("detached",(o==null?void 0:o.data)||null),(a=window==null?void 0:window.notify)!=null&&a.success&&window.notify.success("Attachment removed")}catch(o){console.error(o),x.value="Failed to remove",(r=window==null?void 0:window.notify)!=null&&r.error&&window.notify.error("Failed to remove")}finally{_.value=!1}}};return(a,r)=>(m(),v("div",_e,[e("div",ve,[V.value?(m(),v(O,{key:0},[e("a",{href:M.value,target:"_blank",class:"group inline-flex max-w-[12rem] items-center gap-1 truncate rounded-full border px-2 py-0.5 text-xs hover:bg-gray-50",title:i.value},[e("span",he,[c.value?(m(),v("img",{key:0,src:M.value,alt:"",class:"h-4 w-4 rounded object-cover"},null,8,fe)):(m(),v("svg",ye,r[0]||(r[0]=[e("path",{d:"M14 2H6a2 2 0 00-2 2v16c0 1.1.9 2 2 2h12a2 2 0 002-2V8l-6-6z",stroke:"currentColor","stroke-width":"1.5"},null,-1),e("path",{d:"M14 2v6h6",stroke:"currentColor","stroke-width":"1.5"},null,-1)])))]),e("span",ge,u(i.value),1)],8,be),e("button",{type:"button",class:"inline-flex h-7 w-7 items-center justify-center rounded border text-gray-700 hover:bg-gray-50 disabled:opacity-60",disabled:_.value||$.disabled,title:"Replace",onClick:t},r[1]||(r[1]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true"},[e("path",{d:"M4 12a8 8 0 118 8",stroke:"currentColor","stroke-width":"1.5"}),e("path",{d:"M12 8v8m0-8l-3 3m3-3l3 3",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"})],-1)]),8,xe),e("button",{type:"button",class:"inline-flex h-7 w-7 items-center justify-center rounded border border-rose-200 text-rose-700 hover:bg-rose-50 disabled:opacity-60",disabled:_.value||$.disabled,title:"Remove",onClick:p},r[2]||(r[2]=[e("svg",{class:"h-4 w-4",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true"},[e("path",{d:"M6 6l12 12M18 6L6 18",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"})],-1)]),8,we)],64)):(m(),v("button",{key:1,type:"button",class:"inline-flex items-center gap-1 rounded-md bg-gray-900 px-2.5 py-1 text-xs text-white hover:bg-gray-800 disabled:opacity-60",disabled:_.value||$.disabled,onClick:t,title:"Upload file"},r[3]||(r[3]=[e("svg",{class:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true"},[e("path",{d:"M12 16V4m0 12l-3-3m3 3l3-3M6 20h12",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round"})],-1),G(" Upload ")]),8,ke)),e("input",{ref_key:"inputRef",ref:h,type:"file",class:"hidden",accept:Se,onChange:y,disabled:_.value||$.disabled},null,40,$e),_.value?(m(),v("svg",Ce,r[4]||(r[4]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"3"},null,-1),e("path",{class:"opacity-75",d:"M4 12a8 8 0 018-8",stroke:"currentColor","stroke-width":"3"},null,-1)]))):F("",!0)]),_.value?(m(),v("div",Ne,[e("div",{class:"h-[3px] bg-blue-500 transition-[width]",style:ae({width:(f.value?B.value:60)+"%"})},null,4)])):F("",!0),x.value?(m(),v("p",Ie,u(x.value),1)):F("",!0)]))}},Ae={class:"w-full overflow-x-auto bg-white"},De={class:"min-w-full text-sm"},Re={class:"p-3"},Te={class:"p-3 font-medium"},Be={class:"p-3"},Ee={class:"p-3"},Fe=["onUpdate:modelValue","onChange","disabled"],Ue=["value"],Ve={class:"p-3"},je=["onUpdate:modelValue","onInput","disabled"],Le={class:"p-3"},Pe={class:"p-3"},qe={class:"p-3"},Oe={__name:"ChecklistTable",props:{items:{type:Array,required:!0}},setup($){const N=$,n=W(),S=[{value:"pending",label:"Pending"},{value:"done",label:"Done ✓"},{value:"waived",label:"Waived"},{value:"rejected",label:"Rejected"}],w=D(Object.create(null));function h(i,c){w.value[i]=!!c,w.value={...w.value}}function _(i,c=600){let d;return(...I)=>{clearTimeout(d),d=setTimeout(()=>i(...I),c)}}function x(i){return n.labelOf(i)}function B(i){return n.requiredOf(i)}const f=_(async i=>{var c,d;try{h(i.id,!0),await n.saveItem(i,{comment:i.comment||null}),(c=window==null?void 0:window.notify)!=null&&c.success&&window.notify.success("Note saved")}catch{(d=window==null?void 0:window.notify)!=null&&d.error&&window.notify.error("Failed to save note")}finally{h(i.id,!1)}},600);async function k(i){var c,d;try{h(i.id,!0),await n.saveItem(i,{status:i.status}),(c=window==null?void 0:window.notify)!=null&&c.success&&window.notify.success("Status updated")}catch{(d=window==null?void 0:window.notify)!=null&&d.error&&window.notify.error("Failed to update status")}finally{h(i.id,!1)}}async function V(i,c){var d,I;try{h(i.id,!0),console.log("linking attachment",i,c),await n.saveItem(i,{attachment_id:c.id}),i.attachment={...c},(d=window==null?void 0:window.notify)!=null&&d.success&&window.notify.success("Attachment linked")}catch{(I=window==null?void 0:window.notify)!=null&&I.error&&window.notify.error("Failed to link file")}finally{h(i.id,!1)}}function M(i){if(!i)return"-";try{return new Date(i).toLocaleString()}catch{return String(i)}}return(i,c)=>(m(),v("div",Ae,[e("table",De,[c[0]||(c[0]=e("thead",{class:"sticky top-0 bg-gray-100 backdrop-blur"},[e("tr",{class:"text-left border-b"},[e("th",{class:"p-3 w-10"},"#"),e("th",{class:"p-3"},"Item"),e("th",{class:"p-3 w-20"},"Req."),e("th",{class:"p-3 w-40"},"Status"),e("th",{class:"p-3"},"Comment"),e("th",{class:"p-3 w-64"},"Attachment"),e("th",{class:"p-3 w-44"},"Checked By"),e("th",{class:"p-3 w-48"},"Checked At")])],-1)),e("tbody",null,[(m(!0),v(O,null,H(N.items,(d,I)=>{var C,l;return m(),v("tr",{key:d.id,class:"border-b hover:bg-gray-50"},[e("td",Re,u(I+1),1),e("td",Te,u(x(d)),1),e("td",Be,[e("span",{class:Y(["px-2 py-0.5 rounded text-xs",B(d)?"bg-rose-100 text-rose-700":"bg-gray-100 text-gray-600"])},u(B(d)?"Yes":"No"),3)]),e("td",Ee,[Z(e("select",{"onUpdate:modelValue":y=>d.status=y,onChange:y=>k(d),class:"border rounded px-2 py-1 w-full focus:outline-none focus:ring disabled:opacity-60",disabled:w.value[d.id]},[(m(),v(O,null,H(S,y=>e("option",{key:y.value,value:y.value},u(y.label),9,Ue)),64))],40,Fe),[[le,d.status]])]),e("td",Ve,[Z(e("textarea",{"onUpdate:modelValue":y=>d.comment=y,onInput:y=>j(f)(d),placeholder:"Notes…",class:"border rounded p-2 w-60 h-10 resize-y focus:outline-none focus:ring disabled:opacity-60",disabled:w.value[d.id]},null,40,je),[[de,d.comment]])]),e("td",Le,[oe(Me,{"item-id":d.id,modelValue:d.attachment_id,"onUpdate:modelValue":y=>d.attachment_id=y,current:d.attachment,disabled:w.value[d.id],onUploaded:y=>V(d,y),"onUpdate:current":y=>d.attachment=y,onDetached:()=>{d.attachment=null}},null,8,["item-id","modelValue","onUpdate:modelValue","current","disabled","onUploaded","onUpdate:current","onDetached"])]),e("td",Pe,u(((C=d.checked_by)==null?void 0:C.name)||((l=d.checker)==null?void 0:l.name)||"-"),1),e("td",qe,u(M(d.checked_at)),1)])}),128))])])]))}},ze=se("userClearance",()=>{const $=D(null),N=D(null),n=D([]),S=D(!1),w=D(""),h=D({total:0,by_status:{},by_handover_to:{}}),_=D({by:"created_at",dir:"desc"}),x=D({search:"",status:"",department_id:"",template_item_id:"",handover_to:""});function B(M){$.value=M}async function f(){var M,i;if($.value){S.value=!0,w.value="";try{const{data:c}=await q.get(`/users/${$.value}/clearance-items`,{params:{include:"department,templateItem,clearedBy",sort:_.value.by,order:_.value.dir,search:x.value.search||void 0,status:x.value.status||void 0,department_id:x.value.department_id||void 0,template_item_id:x.value.template_item_id||void 0,handover_to:x.value.handover_to||void 0}}),d=Array.isArray(c==null?void 0:c.data)?c.data:Array.isArray(c)?c:[];n.value=d;const I=(c==null?void 0:c.meta)||{},C=(c==null?void 0:c.extra)||{},l=I.summary||C.summary||{};h.value={total:Number(l.total??d.length)||0,by_status:l.by_status||{},by_handover_to:l.by_handover_to||{}},I.user&&(N.value=I.user)}catch(c){console.error(c),w.value=((i=(M=c==null?void 0:c.response)==null?void 0:M.data)==null?void 0:i.message)||"Failed to load",n.value=[],h.value={total:0,by_status:{},by_handover_to:{}},N.value=null}finally{S.value=!1}}}function k(M){_.value.by===M?_.value.dir=_.value.dir==="asc"?"desc":"asc":(_.value.by=M,_.value.dir="desc")}function V(){x.value={search:"",status:"",department_id:"",template_item_id:"",handover_to:""}}return{currentUserId:$,currentUserInfo:N,items:n,loading:S,error:w,summary:h,sort:_,filters:x,setUser:B,fetch:f,setSort:k,resetFilters:V}}),Ge={key:1,class:"fixed inset-0 z-50 print:static print:z-auto"},He={class:"absolute inset-0 flex items-start justify-center overflow-y-auto print:block print:overflow-visible"},Ye={class:"modal-print mt-6 mb-10 w-[1150px] max-w-[96vw] rounded-2xl bg-white shadow-2xl print:w-[210mm] print:max-w-[210mm] print:rounded-none print:shadow-none print:m-0 print:mt-0"},Ke={class:"px-6 pt-6 pb-4 border-b print:px-[12mm] print:pt-[10mm] print:pb-[4mm]"},We={class:"mt-4 grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm print:text-[12px]"},Je={class:"form-row"},Qe={class:"value"},Xe={class:"value-text font-medium"},Ze={key:0,class:"value-extra"},et={class:"form-row"},tt={class:"value"},st={class:"value-text"},at={class:"form-row"},ot={class:"value"},nt={class:"value-text"},rt={class:"px-6 pb-6 print:px-[12mm] print:pb-[12mm] overflow-x-auto print:overflow-visible"},lt={class:"w-full border border-gray-800 text-[13px] print:text-[12px]",style:{"border-collapse":"collapse"}},dt={key:0},it={key:1},ct={colspan:"6",class:"border border-gray-800 text-center py-6 text-red-600"},ut={key:2},pt={class:"border border-gray-800 px-2 py-1 align-top tabular-nums"},mt=["rowspan"],_t={class:"border border-gray-800 px-2 py-1"},vt={class:"font-medium"},bt={class:"text-[11px] text-gray-700 mt-0.5"},ht={key:0,class:"text-gray-500"},ft={class:"border border-gray-800 px-2 py-1"},yt={class:"inline-block min-w-[22mm] text-center font-semibold"},gt={class:"border border-gray-800 px-2 py-1"},xt={class:"whitespace-pre-line"},wt={class:"border border-gray-800 px-2 py-1"},kt={key:0,class:"text-[11px] text-gray-600 mt-0.5"},$t={__name:"UserClearanceModal",props:{user:{type:Object,required:!0},open:{type:Boolean,default:!1},buttonClass:{type:String,default:"px-3 py-1.5 rounded-md bg-indigo-600 text-white hover:bg-indigo-700"},hideTrigger:{type:Boolean,default:!1}},emits:["update:open"],setup($,{emit:N}){const n=$,S=N,w=R({get:()=>n.open,set:o=>S("update:open",o)}),h=ze(),{items:_,loading:x,error:B,currentUserInfo:f}=ie(h),k=R(()=>{var o,s,b;return((o=f==null?void 0:f.value)==null?void 0:o.name)||((s=n.user)==null?void 0:s.name)||`#${(b=n.user)==null?void 0:b.id}`}),V=R(()=>{var o,s;return((o=f==null?void 0:f.value)==null?void 0:o.employee_id)||((s=n.user)==null?void 0:s.employee_id)||""}),M=R(()=>{var o,s;return((o=f==null?void 0:f.value)==null?void 0:o.department_name)||((s=n.user)==null?void 0:s.department_name)||""}),i=R(()=>{var o,s,b;return((o=f==null?void 0:f.value)==null?void 0:o.post)||((s=f==null?void 0:f.value)==null?void 0:s.designation)||((b=n.user)==null?void 0:b.post)||""}),c=async()=>{var o,s,b;(o=n.user)!=null&&o.id&&((s=h.setUser)==null||s.call(h,n.user.id),await((b=h.fetch)==null?void 0:b.call(h)))};function d(){w.value=!0}function I(){w.value=!1}function C(o){o.key==="Escape"&&I()}K(w,o=>{o?(c(),window.addEventListener("keydown",C)):window.removeEventListener("keydown",C)},{immediate:!0}),K(()=>{var o;return(o=n.user)==null?void 0:o.id},(o,s)=>{o&&o!==s&&w.value&&c()}),ce(()=>window.removeEventListener("keydown",C));const l={departmental_incharge:"Departmental In-charge",technical_support_team:"Technical Support Team",it_incharge:"IT In-charge",hr_department:"HR Department"},y=["Departmental In-charge","Technical Support Team","IT In-charge","HR Department"];function t(o){const s=String((o==null?void 0:o.handover_to)||"").toLowerCase();return l[s]||"Departmental In-charge"}const p=R(()=>{var g;const o=Array.isArray(_==null?void 0:_.value)?_.value:[],s=new Map(y.map(T=>[T,[]]));for(const T of o)(g=s.get(t(T)))==null||g.push(T);for(const[,T]of s.entries())T.sort((U,E)=>{const P=U.template_order_no??U.order_no??U.template_item_id??U.id??0,z=E.template_order_no??E.order_no??E.template_item_id??E.id??0;return P-z});const b=[];let A=1;for(const T of y){const U=s.get(T)||[];U.length&&U.forEach((E,P)=>b.push({sl:A++,group:T,isGroupFirst:P===0,groupSpan:U.length,row:E}))}return b});function a(o){const s=String(o??"").trim().toLowerCase();return["y","yes","true","1","done","cleared","complete","completed","yes.","yes,"].includes(s)?"Yes":["n","no","false","0","pending","not done","incomplete","no.","no,","rejected"].includes(s)?"No":"—"}async function r(){document.body.classList.add("print-modal"),await ne(),window.print(),setTimeout(()=>document.body.classList.remove("print-modal"),0)}return(o,s)=>{var b,A;return m(),v(O,null,[$.hideTrigger?F("",!0):(m(),v("button",{key:0,class:Y($.buttonClass),onClick:d},"View Clearance",2)),w.value?(m(),v("div",Ge,[e("div",{class:"absolute inset-0 bg-black/50 print:hidden",onClick:I}),e("div",He,[e("div",Ye,[e("div",Ke,[s[3]||(s[3]=e("div",{class:"text-center"},[e("h1",{class:"text-2xl font-extrabold tracking-wide print:text-[20px]"},"GENESIS PG ORIENTATION CENTRE"),e("p",{class:"text-sm text-gray-600 print:text-[12px]"},"230, New Elephant Road, Katabon Mor, Dhaka-1205")],-1)),e("div",We,[e("div",Je,[s[0]||(s[0]=e("span",{class:"label"},"Name:",-1)),e("span",Qe,[e("span",Xe,u(k.value),1),V.value?(m(),v("span",Ze,"(ID: "+u(V.value)+")",1)):F("",!0)])]),e("div",et,[s[1]||(s[1]=e("span",{class:"label"},"Department:",-1)),e("span",tt,[e("span",st,u(M.value||"—"),1)])]),e("div",at,[s[2]||(s[2]=e("span",{class:"label"},"Post:",-1)),e("span",ot,[e("span",nt,u(i.value||"—"),1)])])]),s[4]||(s[4]=e("div",{class:"mt-4 text-center"},[e("h2",{class:"inline-block text-base font-semibold px-4 py-1 border rounded print:text-[13px]"}," Employment Resignation Checklist ")],-1))]),e("div",{class:"px-6 py-3 flex justify-end gap-2 print:hidden"},[e("button",{class:"rounded border px-3 py-1.5 hover:bg-gray-50",onClick:r},"Print"),e("button",{class:"rounded bg-gray-900 px-3 py-1.5 text-white hover:bg-gray-800",onClick:I},"Close")]),e("div",rt,[e("table",lt,[s[8]||(s[8]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[14mm]"},"S. L."),e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[28mm]"},"Handover To"),e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[70mm]"},[G(" Particulars "),e("span",{class:"block text-[11px] text-gray-600"},"Cleared by")]),e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[28mm]"},"Handed over (Yes/No)"),e("th",{class:"border border-gray-800 text-left px-2 py-1"},"Present Conditions (note please)"),e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[42mm]"},"Receiver’s Name")])],-1)),e("tbody",null,[(b=j(x))!=null&&b.value?(m(),v("tr",dt,s[5]||(s[5]=[e("td",{colspan:"6",class:"border border-gray-800 text-center py-6 text-gray-600"},"Loading…",-1)]))):(A=j(B))!=null&&A.value?(m(),v("tr",it,[e("td",ct,u(j(B).value),1)])):p.value.length?F("",!0):(m(),v("tr",ut,s[6]||(s[6]=[e("td",{colspan:"6",class:"border border-gray-800 text-center py-6 text-gray-600"},"No items found",-1)]))),(m(!0),v(O,null,H(p.value,g=>{var T;return m(),v("tr",{key:g.row.id,class:"align-top"},[e("td",pt,u(g.sl)+".",1),g.isGroupFirst?(m(),v("td",{key:0,rowspan:g.groupSpan,class:"border border-gray-800 px-2 py-1 align-top font-medium"},u(g.group),9,mt)):F("",!0),e("td",_t,[e("div",vt,u(g.row.template_item_name||`#${g.row.template_item_id}`),1),e("div",bt,[s[7]||(s[7]=G(" Cleared by: ")),e("strong",null,u(((T=g.row.cleared_by_user)==null?void 0:T.name)||(g.row.cleared_by?`#${g.row.cleared_by}`:"—")),1),g.row.cleared_at?(m(),v("span",ht," ("+u(new Date(g.row.cleared_at).toLocaleString())+") ",1)):F("",!0)])]),e("td",ft,[e("span",yt,u(a(g.row.handover_status)),1)]),e("td",gt,[e("div",xt,u(g.row.present_condition||"—"),1)]),e("td",wt,[e("div",null,u(g.row.receiver_name||"—"),1),g.row.remarks?(m(),v("div",kt,u(g.row.remarks),1)):F("",!0)])])}),128))])]),s[9]||(s[9]=ue('<div class="mt-8 grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm print:text-[12px]" data-v-d0bfba58><div class="border-t border-gray-800 pt-6 text-center" data-v-d0bfba58><div class="font-medium" data-v-d0bfba58>User Signature</div></div><div class="border-t border-gray-800 pt-6 text-center" data-v-d0bfba58><div class="font-medium" data-v-d0bfba58>Received by Head of HR</div></div><div class="border-t border-gray-800 pt-6 text-center" data-v-d0bfba58><div class="font-medium" data-v-d0bfba58>Verified by ACC/CC</div></div></div>',1))])])])])):F("",!0)],64)}}},Ct=re($t,[["__scopeId","data-v-d0bfba58"]]),Nt={class:"space-y-3"},It={class:"print:hidden sticky top-0 z-10 -mx-4 md:-mx-6 bg-white/80 backdrop-blur border-b"},St={class:"mx-auto max-w-7xl px-4 md:px-6"},Mt={class:"py-3 flex flex-wrap items-center gap-3"},At={class:"min-w-0"},Dt={class:"text-xs uppercase tracking-wide text-gray-500"},Rt={class:"flex items-center gap-2"},Tt={class:"text-lg md:text-xl font-semibold leading-tight truncate"},Bt={key:0,class:"hidden sm:inline-flex rounded-full bg-gray-100 px-2 py-0.5 text-[11px] text-gray-700"},Et={class:"ml-auto flex items-center gap-4"},Ft={class:"flex items-center gap-2",title:"Completion"},Ut={class:"w-44 h-2 rounded-full bg-gray-200 overflow-hidden"},Vt={class:"text-sm font-medium tabular-nums"},jt={class:"flex items-center gap-2"},Lt={class:"inline-flex rounded-md border overflow-hidden"},Pt={class:"mx-auto max-w-7xl print:hidden"},qt={class:"rounded-2xl border bg-white shadow-sm overflow-hidden"},Ot={class:"px-4 md:px-6 py-4 border-b bg-gradient-to-b from-white to-gray-50"},zt={class:"flex flex-wrap items-end gap-3 text-sm"},Gt={class:"flex-1 min-w-[220px] form-line"},Ht={class:"value"},Yt={key:0,class:"muted"},Kt={class:"flex-1 min-w-[220px] form-line"},Wt={class:"value"},Jt={class:"flex-1 min-w-[220px] form-line"},Qt={class:"value"},Xt={class:"px-4 md:px-6 py-5"},Zt={key:0,class:"space-y-3"},es={key:1,class:"rounded-lg border border-rose-200 bg-rose-50 p-4 text-rose-700"},ts={key:3,class:"rounded-lg border bg-gray-50 p-6 text-gray-600"},ss={key:0,class:"hidden print:block bg-white text-gray-900 print-a4"},as={class:"text-center"},os={class:"text-xl font-bold tracking-wide"},ns={class:"text-sm"},rs={class:"mt-2 text-base font-semibold underline"},ls={class:"mt-3 grid grid-cols-12 gap-2 text-[12px] leading-5"},ds={class:"col-span-4"},is={class:"inline-block min-w-[150px] border-b border-gray-800 ml-2"},cs={class:"col-span-4"},us={class:"inline-block min-w-[150px] border-b border-gray-800 ml-2"},ps={class:"col-span-4"},ms={class:"inline-block min-w-[150px] border-b border-gray-800 ml-2"},_s={class:"mt-3 w-full border border-gray-900 text-[12px] leading-5 print-table"},vs={class:"border border-gray-900 px-2 py-1 text-center"},bs={class:"border border-gray-900 px-2 py-1"},hs={class:"border border-gray-900 px-2 py-1 text-center"},fs={class:"inline-flex items-center justify-center align-middle border border-gray-900 w-4 h-4"},ys={key:0,class:"leading-none text-[12px] font-bold"},gs={class:"border border-gray-900 px-2 py-1 text-center"},xs={key:0,class:"mt-12 text-right text-[12px]"},ws={__name:"ChecklistPage",setup($){const N=pe(),n=W(),S=R(()=>Number(N.params.userId)),w=R(()=>N.params.checklistId?Number(N.params.checklistId):null),h=R(()=>N.params.templateId?Number(N.params.templateId):null),_=D(!1),x=D(!1);function B(C,l=0,y=100){const t=Number(C||0);return Math.min(Math.max(t,l),y)}const f=R(()=>B(n.completion)),k=R(()=>{var C;return((C=n.checklist)==null?void 0:C.employee)||{}}),V=R(()=>{var C,l,y,t,p;return{id:S.value,name:((C=k.value)==null?void 0:C.name)??`#${S.value}`,department_name:((y=(l=k.value)==null?void 0:l.department)==null?void 0:y.name)??null,post:((p=(t=k.value)==null?void 0:t.designation)==null?void 0:p.title)??null}});ee(()=>{N.query.open==="clearance"&&(_.value=!0)});async function M(){if(S.value){x.value=!0;try{w.value?await n.fetchChecklist(S.value,w.value):h.value?await n.ensureChecklist(S.value,h.value):await n.reset()}finally{x.value=!1}}}ee(M),K([S,w,h],M);const i=D("blank");async function c(){await ne(),window.print()}const d=R(()=>(n.items||[]).slice().sort((C,l)=>(C.order_no??0)-(l.order_no??0))),I={name:"GENESIS PG ORIENTATION CENTRE",address:"230, New Elephant Road, Katabon Mor, Dhaka-1205"};return(C,l)=>{var y,t,p,a,r,o,s,b,A,g,T,U,E,P,z,J,Q;return m(),v("div",Nt,[e("header",It,[e("div",St,[e("div",Mt,[e("div",At,[e("div",Dt,u(((t=(y=j(n).checklist)==null?void 0:y.template)==null?void 0:t.type)||"Checklist"),1),e("div",Rt,[e("h1",Tt,u(((a=(p=j(n).checklist)==null?void 0:p.template)==null?void 0:a.name)||"Checklist"),1),(r=k.value)!=null&&r.employee_id?(m(),v("span",Bt," ID: "+u(k.value.employee_id),1)):F("",!0)])]),e("div",Et,[e("div",Ft,[e("div",Ut,[e("div",{class:"h-2 rounded-full bg-gradient-to-r from-emerald-500 to-indigo-500",style:ae({width:f.value+"%"})},null,4)]),e("span",Vt,u(f.value)+"%",1)]),h.value===2?(m(),v("button",{key:0,type:"button",class:"inline-flex items-center gap-2 rounded-md bg-indigo-600 px-3 py-2 text-xs md:text-sm font-medium text-white hover:bg-indigo-700",onClick:l[0]||(l[0]=L=>_.value=!0)}," View Clearance ")):F("",!0),e("div",jt,[e("div",Lt,[e("button",{type:"button",class:Y(["px-3 py-1.5 text-xs md:text-sm",i.value==="blank"?"bg-gray-900 text-white":"bg-white hover:bg-gray-50"]),onClick:l[1]||(l[1]=L=>i.value="blank")},"Blank",2),e("button",{type:"button",class:Y(["px-3 py-1.5 text-xs md:text-sm border-l",i.value==="filled"?"bg-gray-900 text-white":"bg-white hover:bg-gray-50"]),onClick:l[2]||(l[2]=L=>i.value="filled")},"Filled",2)]),e("button",{class:"rounded-md bg-gray-900 px-3 py-2 text-xs md:text-sm font-medium text-white hover:bg-black",onClick:c},"Print")])])])])]),e("section",Pt,[e("div",qt,[e("div",Ot,[e("div",zt,[e("div",Gt,[l[4]||(l[4]=e("span",{class:"label"},"Name",-1)),e("span",Ht,[G(u(((o=k.value)==null?void 0:o.name)||"-")+" ",1),(s=k.value)!=null&&s.employee_id?(m(),v("span",Yt," ("+u(k.value.employee_id)+")",1)):F("",!0)])]),e("div",Kt,[l[5]||(l[5]=e("span",{class:"label"},"Department",-1)),e("span",Wt,u(((A=(b=k.value)==null?void 0:b.department)==null?void 0:A.name)||"—"),1)]),e("div",Jt,[l[6]||(l[6]=e("span",{class:"label"},"Designation",-1)),e("span",Qt,u(((T=(g=k.value)==null?void 0:g.designation)==null?void 0:T.title)||"—"),1)])])]),e("div",Xt,[x.value||j(n).loading?(m(),v("div",Zt,l[7]||(l[7]=[e("div",{class:"h-4 w-40 rounded bg-gray-100 animate-pulse"},null,-1),e("div",{class:"h-10 w-full rounded bg-gray-100 animate-pulse"},null,-1),e("div",{class:"h-10 w-full rounded bg-gray-100 animate-pulse"},null,-1),e("div",{class:"h-10 w-full rounded bg-gray-100 animate-pulse"},null,-1)]))):j(n).error?(m(),v("div",es," Failed to load. ")):j(n).checklist?(m(),me(Oe,{key:2,items:j(n).items},null,8,["items"])):(m(),v("div",ts," No checklist found. "))])])]),oe(Ct,{open:_.value,"onUpdate:open":l[3]||(l[3]=L=>_.value=L),user:V.value,"hide-trigger":!0},null,8,["open","user"]),j(n).checklist?(m(),v("section",ss,[e("div",as,[e("div",os,u(I.name),1),e("div",ns,u(I.address),1),e("div",rs,u(((E=(U=j(n).checklist)==null?void 0:U.template)==null?void 0:E.name)||"Checklist"),1)]),l[13]||(l[13]=e("div",{class:"text-right text-sm mt-1"},"( Office Copy )",-1)),e("div",ls,[e("div",ds,[l[8]||(l[8]=e("span",{class:"font-medium"},"নাম:",-1)),e("span",is,"  "+u(((P=k.value)==null?void 0:P.name)||" "),1)]),e("div",cs,[l[9]||(l[9]=e("span",{class:"font-medium"},"বিভাগ:",-1)),e("span",us,"  "+u(((J=(z=k.value)==null?void 0:z.department)==null?void 0:J.name)||" "),1)]),e("div",ps,[l[10]||(l[10]=e("span",{class:"font-medium"},"যোগদানের তারিখ:",-1)),e("span",ms,"  "+u(((Q=k.value)==null?void 0:Q.joining_date)||" "),1)])]),e("table",_s,[l[12]||(l[12]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"w-12 border border-gray-900 px-2 py-1 text-center"},"ক্রম."),e("th",{class:"border border-gray-900 px-2 py-1 text-left"},"বিষয়"),e("th",{class:"w-40 border border-gray-900 px-2 py-1 text-center"},"সম্পন্ন হলে টিক চিহ্ন দিন"),e("th",{class:"border border-gray-900 px-2 py-1 text-center"},"Attachment"),e("th",{class:"w-52 border border-gray-900 px-2 py-1 text-left"},"মন্তব্য")])],-1)),e("tbody",null,[(m(!0),v(O,null,H(d.value,(L,X)=>(m(),v("tr",{key:L.id??X,class:"align-top print-row"},[e("td",vs,u(X+1),1),e("td",bs,u(L._label||L.label),1),e("td",hs,[e("span",fs,[L.status=="done"?(m(),v("span",ys,"✓")):F("",!0)])]),e("td",gs,u(L.attachment?"Yes":"No"),1),l[11]||(l[11]=e("td",{class:"border border-gray-900 px-2 py-1"}," ",-1))]))),128))])]),l[14]||(l[14]=e("div",{class:"mt-8 grid grid-cols-2 gap-4 text-[12px]"},[e("div",null,[e("div",null,"কর্মীর স্বাক্ষর: ______________________________"),e("div",{class:"mt-2"},"তারিখ: _____________")]),e("div",{class:"text-right"},[e("div",null,"পরীক্ষণকারী: ______________________________"),e("div",{class:"mt-2"},"পদবি: __________________")])],-1)),_.value?F("",!0):(m(),v("div",xs,"হেড অব এইচআর"))])):F("",!0)])}}},Cs=re(ws,[["__scopeId","data-v-e31ec1ff"]]);export{Cs as default};
