import{N as Re,r as x,e as te,c as o,o as n,a as e,f as N,g as u,F as H,t as g,w as A,d as Se,m as ne,n as Ae,y as X,p as k,i as q,j as E,x as z,k as J,O as je,K as Ne,h as Le,v as Be,J as De,b as Ee,u as Oe,z as Z}from"./index-FMiHHvAr.js";import{L as le}from"./LoaderView-BCH5-jNb.js";import{O as Y}from"./OverlyModal-Bz5sy6sS.js";import{_ as Ve}from"./ShareComponent-3qLvwWNs.js";import{_ as Te}from"./DepartmentChip-DCYe0DZW.js";import{_ as ee}from"./DescriptionView-DrSj_buz.js";import{o as Me}from"./url-CePbr-gY.js";import{u as Pe}from"./user-yBTrN7pa.js";import{_ as Bs,a as Ue}from"./TaskUserAssignForm-CUMf6Gz7.js";import{f as ae,b as Fe,s as ze}from"./requirement-DxxZLa_H.js";import{_ as He}from"./TextEditor-DeBfKR1A.js";import{u as Ge}from"./useTaskStore-B6qFuAhl.js";import{_ as Qe}from"./TaskSelectionInput-DLb0I0AP.js";import{_ as We}from"./TaskAddForm-DF6_CbG9.js";import{_ as Ke}from"./TaskEditForm-SH6fIj9J.js";import{_ as Ye}from"./TaskTableRow-DigEnN9m.js";import{T as se}from"./TextWithHr-BNZUbPoq.js";import{_ as ie}from"./UserChip-CB6YwH8o.js";import{d as re}from"./datetime-BEfC2TVK.js";import{_ as Je}from"./ApproveAndReject-Dlxj1uFF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TaskUrgencyInput-DqGsaZi9.js";import"./DraggableList.vue_vue_type_script_setup_true_lang-DVk5L2ot.js";import"./SelectDropdown-oNAdFkpC.js";import"./TaskTitle-C0riNemr.js";import"./RequiredIcon-ZodIS7Mw.js";import"./company-CVMBJext.js";import"./CompanyDepartmentSelectInput-CVa-Rfk3.js";import"./SectionLoading-DcASRvKo.js";import"./tags-CbO76Idu.js";import"./MultiselectDropdown-DPMqmZx5.js";import"./MultiselectDropdown.vue_vue_type_style_index_0_lang-CIEiQmnh.js";import"./TaskUrgentBadge-DKlM6KPX.js";import"./TaskAssignedUsers-BMVlFnxT.js";import"./TaskIsClosedBadge-cl2MrVbG.js";async function Xe(I,R,{params:a={}}={}){return Re.get(`/requirements/${I}/details/${R}`,{params:a})}async function Ze(I,R,{params:a={}}={}){const m=Me(a);return Re.delete(`/requirements/${I}/details/${R}${m?"?"+m:""}`)}const et={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},tt={class:"mb-4"},st={class:"font-semibold"},rt={class:"mb-4"},nt={class:"line-clamp-2"},at={key:1,class:"min-h-40"},it={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},lt={key:0,class:"mb-4 text-red-500 font-medium"},ot={key:1,class:"mb-4"},dt={class:"flex items-center justify-between gap-4"},ut=["disabled"],mt={__name:"RequirementDetailDeleteForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["delete","closeClick","error"],setup(I,{emit:R}){const a=I,m=R,$=Pe(),p=x(null),d=x(""),t=x(),f=x([]);async function c(){var i,r;d.value="submitting";try{const l=await Ze(a.requirementId,a.detailId);m("delete",l),d.value="create"}catch(l){d.value="error",t.value=((r=(i=l.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update requirement detail: "+l,m("error",t.value)}}return te(async()=>{var i,r,l;d.value="loading";try{f.value=await $.fetchDepartmentWiseEmployees(),p.value=(i=(await Xe(a.requirementId,a.detailId)).data)==null?void 0:i.detail}catch(y){t.value=((l=(r=y.response)==null?void 0:r.data)==null?void 0:l.message)||"Failed to fetch requirement detail"}finally{d.value=""}}),(i,r)=>{var l,y;return n(),o("div",et,[r[4]||(r[4]=e("div",{class:"sticky top-0 -mx-6 px-6 z-10 bg-gray-50"},[e("h2",{class:"text-xl font-semibold text-gray-800 py-2"},"Delete Requirement Details"),e("hr",{class:"mb-4 -mx-6"})],-1)),e("form",{onSubmit:A(c,["prevent"]),class:"z-0"},[d.value!=="loading"?(n(),o(H,{key:0},[e("div",tt,[r[1]||(r[1]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Title",-1)),e("div",st,g((l=p.value)==null?void 0:l.title),1)]),e("div",rt,[r[2]||(r[2]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),e("div",nt,g((y=p.value)==null?void 0:y.description),1)]),r[3]||(r[3]=e("div",{class:"my-8 text-center text-xl text-red-600"},"Are you sure want to delete?",-1))],64)):(n(),o("div",at)),e("div",it,[t.value?(n(),o("div",lt,g(t.value),1)):u("",!0),t.value?(n(),o("hr",ot)):u("",!0),e("div",dt,[e("button",{type:"button",onClick:r[0]||(r[0]=A(h=>m("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:d.value=="loading"||d.value=="submitting",type:"submit",class:"bg-red-700 hover:bg-red-500 text-white font-semibold px-5 py-2 rounded transition"},g(d.value=="submitting"?"Deleting...":"Delete"),9,ut)])])],32),d.value==="loading"||d.value==="submitting"?(n(),N(le,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):u("",!0)])}}};const pt={class:"sticky top-0 pt-4 bg-white z-10"},ct={class:"mb-4"},vt={class:"mb-4"},ft={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},bt={key:0,class:"mb-4 text-red-500 font-medium"},xt={key:1,class:"mb-4"},yt={class:"flex items-center justify-between gap-4"},gt=["disabled"],_t={__name:"RequirementFeedbackEditForm",props:{requirementId:{type:[Number,String],required:!0},requirementId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(I,{emit:R}){const a=I,m=R,$=x(),p=x(null),d=x(""),t=x(),f=x({feedback:""});async function c(){var i,r;d.value="submitting";try{const l=await Fe(a.requirementId,f.value.feedback);m("update",l),d.value="create"}catch(l){d.value="error",t.value=((r=(i=l.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update requirement requirement",m("error",t.value)}}return te(async()=>{var i,r,l,y;d.value="loading";try{await ae(a.requirementId),p.value=(i=(await ae(a.requirementId)).data)==null?void 0:i.requirement,f.value={feedback:(r=p.value)==null?void 0:r.feedback}}catch(h){t.value=((y=(l=h.response)==null?void 0:l.data)==null?void 0:y.message)||"Failed to fetch requirement requirement"}finally{d.value=""}}),(i,r)=>{var l;return n(),o("div",{ref_key:"formContainerRef",ref:$,class:"max-h-[90vh] w-full mx-auto overflow-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},[e("div",pt,[r[3]||(r[3]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Requirement Feedback",-1)),r[4]||(r[4]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:r[0]||(r[0]=A(y=>m("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:A(c,["prevent"]),class:"z-0"},[d.value!=="loading"?(n(),o(H,{key:0},[e("div",ct,[r[5]||(r[5]=e("label",{class:"block text-gray-600 text-sm font-medium"},"Title ",-1)),k(ee,{"line-clamp":"1",className:{paragraph:"whitespace-pre-wrap text-justify ",button:"mt-0"}},{default:q(()=>{var y;return[E(g((y=p.value)==null?void 0:y.title),1)]}),_:1})]),e("div",vt,[r[6]||(r[6]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Feedback",-1)),k(He,{modelValue:f.value.feedback,"onUpdate:modelValue":r[1]||(r[1]=y=>f.value.feedback=y)},null,8,["modelValue"])])],64)):u("",!0),e("div",ft,[t.value?(n(),o("div",bt,g(t.value),1)):u("",!0),t.value?(n(),o("hr",xt)):u("",!0),e("div",yt,[e("button",{type:"button",onClick:r[2]||(r[2]=A(y=>m("closeClick"),["prevent"])),class:"btn-3"},"Cancel"),e("button",{disabled:d.value=="loading"||d.value=="submitting",type:"submit",class:"btn-2"},g(d.value=="submitting"?"Saving...":(l=p.value)!=null&&l.feedback?"Update Feedback":"Add Feedback"),9,gt)])])],32),d.value==="loading"||d.value==="submitting"?(n(),N(le,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):u("",!0)],512)}}},kt={class:"flex justify-center items-center"},wt={class:"modal-card"},ht=["required"],qt={class:"flex"},$t={class:"flex justify-between gap-2 mt-4"},Ct=["disabled"],Tt=["disabled"],It={__name:"RequirementSubmissionHandler",props:{requirementId:{type:[String,Number],required:!0}},emits:["loading","success","error"],setup(I,{emit:R}){const a=I,m=R,$=x(255),p=ne(()=>$.value-i.value.length),d=je(),t=x(null),f=x(null),c=x(null),i=x(""),r=x(!1),l=ne(()=>c.value!==null);function y(T){c.value=T,i.value="",D()}function h(){c.value=null,i.value=""}async function C(){var T,w;if(c.value==="reject"&&!i.value)return d.error("Rejection Reason is required!");if(typeof a.onSubmit=="function")return a.onSubmit({note:i.value,action:c.value});m("loading",!0),r.value=!0;try{await ze(a.requirementId,{note:i.value}),m("success"),h()}catch(S){return m("error",S),d.error(((w=(T=S==null?void 0:S.response)==null?void 0:T.data)==null?void 0:w.message)||"Submission failed!")}finally{m("loading",!1),r.value=!1}}function L(T){var w,S;l.value&&(T.key==="ArrowLeft"?(w=f.value)==null||w.focus():T.key==="ArrowRight"&&((S=t.value)==null||S.focus()))}function D(){De(()=>{var T;(T=t.value)==null||T.focus()})}return te(()=>{window.addEventListener("keydown",L)}),Ne(()=>{window.removeEventListener("keydown",L)}),(T,w)=>(n(),o("div",null,[e("div",kt,[e("button",{onClick:w[0]||(w[0]=S=>y("accept"))},w[3]||(w[3]=[e("span",{class:"btn-2"},[e("span",{class:"fas fa-paper-plane"}),e("span",{class:"hidden md:inline"},"Submit Requirement")],-1)]))]),l.value?(n(),o("div",{key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50",onClick:A(h,["self"])},[e("div",wt,[w[4]||(w[4]=e("h3",{class:"title-lg"},"Requirement Submission",-1)),e("div",null,[Le(e("textarea",{"onUpdate:modelValue":w[1]||(w[1]=S=>i.value=S),rows:"4",placeholder:"Note...",class:"w-full border rounded-lg p-2 text-gray-700",required:c.value==="reject",onInput:w[2]||(w[2]=S=>i.value.length>$.value?i.value=i.value.slice(0,$.value):null)},null,40,ht),[[Be,i.value]]),e("div",qt,[e("div",{class:z(["ml-auto inline-block text-sm text-gray-500",i.value.length>=$.value?"text-red-500":""])}," left "+g(p.value)+"/"+g($.value)+" words ",3)])]),e("div",$t,[e("button",{ref_key:"cancelBtnRef",ref:f,class:"btn-3 focus:ring-2 ring-offset-2 disabled:opacity-30",onClick:h,disabled:r.value}," Cancel ",8,Ct),e("button",{ref_key:"confirmBtnRef",ref:t,class:z(["focus:ring-2 ring-offset-2 disabled:opacity-30",c.value==="reject"?"btn-2-red":"btn-2-green"]),onClick:C,disabled:r.value}," Confirm Submission ",10,Tt)])])])):u("",!0)]))}},Rt={class:"flex items-center gap-6 justify-center my-16"},St={key:0,class:"border rounded-md"},Nt={__name:"RequirementTaskCreateOrAssign",props:{fromDepartmentId:{type:Number},requirement:{type:Object}},emits:["addNewTaskClick","cancelClick","assignTask"],setup(I,{emit:R}){const a=I,m=R,$=Ge(),p=x(""),d=x(null),t=x(""),f=x(!1);async function c(){await $.setTaskRequirement(t.value,a.requirement.id),m("assignTask")}return(i,r)=>(n(),o("div",{class:z(["text-left p-4",[p.value&&!d.value?"min-h-[400px]":""]])},[e("div",Rt,[e("button",{onClick:r[0]||(r[0]=A(l=>m("addNewTaskClick"),["prevent"])),class:"btn-3"},"Add New Task"),r[5]||(r[5]=e("span",null,"or",-1)),e("button",{class:z({"btn-3":p.value!=="direct-assign","btn-2":p.value=="direct-assign"}),onClick:r[1]||(r[1]=A(()=>p.value="direct-assign",["prevent"]))}," Assign Task ",2)]),p.value&&!d.value?(n(),o("div",St,[e("form",{onSubmit:A(c,["prevent"]),class:"p-4 flex items-end"},[k(Qe,{class:"flex-grow mr-4 h-12",taskId:t.value,"onUpdate:taskId":r[2]||(r[2]=l=>t.value=l),show:f.value,"onUpdate:show":r[3]||(r[3]=l=>f.value=l),isOnlyMyTask:!1,taskQueryParams:{"from-department-id":I.fromDepartmentId},filterTasks:l=>!l.requirement_id,onAddNewTaskClick:r[4]||(r[4]=l=>m("addNewTaskClick")),showAddBtnIfNotFound:!0},null,8,["taskId","show","taskQueryParams","filterTasks"]),r[6]||(r[6]=e("div",{class:"flex justify-center"},[e("button",{class:"btn-2 h-12 rounded-md"},"Save")],-1))],32)])):u("",!0)],2))}},Dt={class:"flex flex-col items-center gax-x-1 justify-between"},At={key:0},jt={key:1},Lt={class:"text-base text-gray-900 font-semibold"},Bt={class:"ml-2"},Et={key:0,class:"text-green-600 ml-2"},Ot={key:1,class:"ml-2 text-yellow-700"},Ie={__name:"RequirementApprovalItem",props:{requirement:{type:Object,required:!0},approvalType:{type:String,required:!0}},emits:["updateApproval"],setup(I,{emit:R}){const a=I,m=R,$=Se(),p=ne(()=>{var l,y,h,C,L,D,T,w,S,b,G,Q,_,s,j,O,V,M,P,U,F,K;let t=null,f=null,c=null,i="",r=!1;return a.approvalType==="from_in_charge"&&(t=(l=a.requirement)==null?void 0:l.from_department,f=(h=(y=a.requirement)==null?void 0:y.from_department)==null?void 0:h.in_charge,c=(L=(C=a.requirement)==null?void 0:C.from_department)==null?void 0:L.in_charge,i="In Charge",r=!!((D=a.requirement)!=null&&D.status&&((T=a.requirement)!=null&&T.submission_date))),a.approvalType==="from_coordinator"&&(t=(w=a.requirement)==null?void 0:w.from_department,f=(b=(S=a.requirement)==null?void 0:S.from_department)==null?void 0:b.coordinator,c=(G=a.requirement)==null?void 0:G.from_coordinator,r=!!((Q=a.requirement)!=null&&Q.from_coordinator),i="Coordinator"),a.approvalType==="to_in_charge"&&(t=(_=a.requirement)==null?void 0:_.to_department,f=(j=(s=a.requirement)==null?void 0:s.to_department)==null?void 0:j.in_charge,c=(O=a.requirement)==null?void 0:O.to_in_charge,r=!!((V=a.requirement)!=null&&V.to_incharge),i="In Charge"),a.approvalType==="to_coordinator"&&(t=(M=a.requirement)==null?void 0:M.to_department,f=(U=(P=a.requirement)==null?void 0:P.to_department)==null?void 0:U.coordinator,c=(F=a.requirement)==null?void 0:F.to_coordinator,r=!!((K=a.requirement)!=null&&K.to_coordinator),i="Coordinator"),{department:t,department_user:f,approval_user:c,userType:i,approved:r}});function d(){m("updateApproval")}return(t,f)=>{var c,i,r,l,y,h,C;return n(),o("div",Dt,[p.value.department_user?(n(),o("div",At,[k(ie,{user:p.value.department_user,"avatar-size":"xsmall"},null,8,["user"])])):(n(),o("div",jt,f[0]||(f[0]=[e("span",{class:"italic text-xs text-gray-400"},"N/A",-1)]))),f[2]||(f[2]=e("hr",{class:"my-2 border-gray-600 w-64"},null,-1)),e("div",Lt,[e("span",null,g(((c=p.value.department)==null?void 0:c.short_name)||((i=p.value.department)==null?void 0:i.name)),1),e("span",Bt,g(p.value.userType),1),p.value.department_user?(n(),o(H,{key:0},[p.value.approved?(n(),o("span",Et,"(âœ”)")):(n(),o("span",Ot,f[1]||(f[1]=[e("i",{class:"fad fa-spinner"},null,-1)])))],64)):u("",!0),((r=a.requirement)==null?void 0:r.status)!=="approved"&&p.value.department_user&&!p.value.approved&&((l=J($).user)==null?void 0:l.id)==((h=(y=p.value)==null?void 0:y.department_user)==null?void 0:h.id)?(n(),N(Je,{key:1,class:"ml-auto z-[5000000]",notificationType:"pending-requirements",applicationId:(C=a.requirement)==null?void 0:C.id,onSuccess:d,variant:1},null,8,["applicationId"])):u("",!0)])])}}},Vt={class:"container mx-auto print:p-0 w-full print:max-w-full"},Mt={class:"print:shadow-none print:p-0 relative min-h-[50vh] mx-4"},Pt={key:0,class:"grid grid-cols-12 gap-x-4 gap-y-3"},Ut={class:"col-span-full md:col-span-8 xl:col-span-8 2xl:col-span-9 row-span-10 bg-white shadow rounded-lg p-6"},Ft={class:"text-center text-xl font-bold mb-2 flex items-center"},zt={class:"mb-8"},Ht={class:"text-lg font-semibold mb-2"},Gt={class:"flex gap-4 items-center text-gray-500"},Qt={class:"text-sm"},Wt={key:0,class:"flex items-center gap-1"},Kt={key:0,class:"mb-5"},Yt=["innerHTML"],Jt={class:"mb-8"},Xt={class:"w-full border rounded-lg border-gray-300 overflow-y-auto"},Zt={class:"w-full border-collapse"},es={key:0},ts={class:"mb-8"},ss={class:"font-semibold text-lg px-2"},rs={key:0},ns=["innerHTML"];const as={key:1,class:"mt-8 border rounded-md p-8 flex items-start justify-between bg-gray-50 print:hidden"},is={class:"flex flex-col items-end"},ls={key:2,class:"mt-6 mb-8 break-before-avoid-page"},os={class:"whitespace-nowrap border-gray-200 grid grid-cols-2 items-center"},ds={key:0,class:"whitespace-nowrap border-gray-200 grid grid-cols-2 gap-2 items-center"},us={class:"border col-span-3 p-3 rounded-md"},ms={class:"flex items-center gap-2 mb-4"},ps={class:"flex items-center gap-x-3 gap-y-2 flex-wrap"},cs={class:"flex items-center gap-2 mb-4"},vs={class:"mb-4 flex items-center justify-between gap-1 print:mb-1"},fs={class:"font-bold print:text-gray-900"},bs={key:0,class:"mb-3 flex items-start gap-3 print:mb-1"},xs={class:"flex items-center gap-2 print:text-gray-900 flex-wrap"},ys={key:1,class:"mb-3 flex items-center justify-between gap-3 print:mb-1"},gs={class:"print:text-gray-900"},_s={key:2,class:"mb-3 flex items-center justify-between gap-3 print:mb-1"},ks={class:"print:text-gray-900"},ws={class:"flex justify-between items-center mb-4"},hs={class:"mb-6"},qs={class:"flex justify-between items-center"},$s={key:1,class:"text-red-600"},Cs={class:"print:hidden flex gap-2 items-center justify-between w-full text-sm"},dr={__name:"RequirementShow",setup(I){const R=Ee(),a=Oe(),m=x(""),$=Se(),p=x(),d=x(),t=x(null),f=Z({detail:null,open:!1}),c=Z({detail:null,open:!1}),i=Z({detail:null,open:!1}),r=x(!1),l=()=>r.value=!0,y=()=>r.value=!1,h=x(),C=x({isOpen:!1,taskId:null});te(async()=>{await D(),window.addEventListener("beforeprint",l),window.addEventListener("afterprint",y),window.addEventListener("resize",L),await De(),L()});function L(){var j;const _=p.value,s=(j=d.value)==null?void 0:j.$el;_&&s&&(_!=null&&_.offsetHeight)&&(s.style.top=`${(_==null?void 0:_.offsetHeight)+90}px`)}Ne(()=>{window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",y),window.removeEventListener("resize",L)});async function D(){var _;m.value="loading",t.value=(_=(await ae(R.params.id)).data)==null?void 0:_.requirement,m.value=""}function T(){var _,s,j,O,V,M,P,U,F;if($.user.role!=="super_admin"&&((_=$.user)==null?void 0:_.id)!==((j=(s=t.value)==null?void 0:s.to_department)==null?void 0:j.incharge_id))return alert(`You can't create or assign task for this requirement. 
Only ${(V=(O=t.value)==null?void 0:O.to_department)==null?void 0:V.name}'s In charge can create or assign.`);console.log({requirement:t}),b.modalShown=!0,b.from_department_id=t.value.from_department_id,b.to_department_id=t.value.to_department_id,b.taskDefaultValues={title:"",description:"",from_department_id:t.value.from_department_id,to_department_id:t.value.to_department_id,is_important:((M=t.value)==null?void 0:M.priority)=="IMPORTANT",is_urgent:((P=t.value)==null?void 0:P.priority)=="URGENT",supervisor_ids:(U=t.value)!=null&&U.supervisor_id?[(F=t.value)==null?void 0:F.supervisor_id]:[]},b.requirement=t.value}function w(_){f.open=!0,f.detail=_}function S(_){i.open=!0,i.detail=_}const b=Z({modalShown:!1,requirementId:0,taskDefaultValues:{},requirement:null,creating:!1});async function G(){h.value=null,await D()}async function Q(){b.modalShown=!1,b.requirement=null,b.creating=!1}return(_,s)=>{var O,V,M,P,U,F,K,oe,de,ue,me,pe,ce,ve,fe,be,xe,ye,ge,_e,ke,we,he,qe,$e;const j=Ae("RouterLink");return n(),o("div",Vt,[c.open?(n(),N(Y,{key:0},{default:q(()=>{var v;return[k(_t,{requirementId:t.value.id,detailId:(v=c.requirement.value)==null?void 0:v.id,onCloseClick:s[0]||(s[0]=B=>c.open=!1),onUpdate:s[1]||(s[1]=async()=>{c.open=!1,await D()})},null,8,["requirementId","detailId"])]}),_:1})):u("",!0),i.open?(n(),N(Y,{key:1},{default:q(()=>{var v;return[k(mt,{requirementId:t.value.id,detailId:(v=i.requirement.value)==null?void 0:v.id,onCloseClick:s[2]||(s[2]=B=>i.open=!1),onDelete:s[3]||(s[3]=async()=>{i.open=!1,await D()})},null,8,["requirementId","detailId"])]}),_:1})):u("",!0),b.modalShown?(n(),N(Y,{key:2,class:"*:relative"},{default:q(()=>{var v,B;return[e("button",{onClick:A(Q,["prevent"]),class:"absolute right-3 top-2 text-xl text-red-500 hover:text-red-400"},s[14]||(s[14]=[e("i",{class:"fas fa-times-circle"},null,-1)])),b!=null&&b.creating?u("",!0):(n(),N(Nt,{key:0,"from-department-id":(v=t.value)==null?void 0:v.from_department_id,requirement:b==null?void 0:b.requirement,onCancelClick:Q,onAddNewTaskClick:s[4]||(s[4]=()=>{b.modalShown=!0,b.creating=!0}),onAssignTask:G},null,8,["from-department-id","requirement"])),b!=null&&b.creating?(n(),N(We,{key:1,requirementDetailId:(B=b==null?void 0:b.requirement.value)==null?void 0:B.id,requirementId:t.value.id,onClose:Q,onTaskCreated:G,defaultValues:b.taskDefaultValues,readonlyFields:{from_department_id:!0,to_department_id:!0}},null,8,["requirementDetailId","requirementId","defaultValues"])):u("",!0)]}),_:1})):u("",!0),h.value?(n(),N(Y,{key:3},{default:q(()=>[k(Ke,{taskId:h.value,onClose:s[5]||(s[5]=v=>h.value=null),onUpdated:G},null,8,["taskId"])]),_:1})):u("",!0),C.value.isOpen?(n(),N(Y,{key:4,class:"*:max-w-4xl"},{default:q(()=>[k(Ue,{taskId:C.value.taskId,onCancelClick:s[6]||(s[6]=()=>{C.value.isOpen=!1,C.value.taskId=0}),onSuccess:s[7]||(s[7]=()=>{C.value.isOpen=!1,C.value.taskId=0,m.value="loading",D()})},null,8,["taskId"])]),_:1})):u("",!0),e("div",Mt,[t.value?(n(),o("div",Pt,[e("div",Ut,[e("div",Ft,[e("button",{class:"btn-3 h-8 px-4",onClick:s[8]||(s[8]=A(()=>J(a).back(),["prevent"]))},"Back"),s[15]||(s[15]=e("div",{class:"text-2xl ml-4"},"Requirement Form",-1))]),s[29]||(s[29]=e("hr",{class:"mb-4"},null,-1)),e("div",null,[e("div",zt,[e("div",null,[e("div",Ht,[k(ee,{"line-clamp":"3",class:"mb-2"},{default:q(()=>[E(g(t.value.title),1)]),btnText:q(({lineClampClass:v})=>[E(g(v?"More":"Less"),1)]),_:1}),e("div",Gt,[e("div",Qt,[s[16]||(s[16]=e("span",{class:"fas fa-calendar text-sm text-gray-400"},null,-1)),E(" "+g(J(re)(t.value.created_at)),1)]),t.value.created_by?(n(),o("div",Wt,[s[17]||(s[17]=e("span",{class:"text-gray-400 text-sm"},"By",-1)),k(ie,{"avatar-size":"xsmall",user:t.value.created_by,class:"border-sky-300"},null,8,["user"])])):u("",!0)])]),t.value.description?(n(),o("div",Kt,[s[18]||(s[18]=e("div",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Description",-1)),k(ee,{"line-clamp":4,"class-name":{button:"group-hover/item:underline"},class:"text-sm"},{default:q(()=>[e("p",{innerHTML:t.value.description,class:"text-justify"},null,8,Yt)]),_:1})])):u("",!0)])]),e("div",Jt,[k(se,{class:"mb-4"},{default:q(()=>s[19]||(s[19]=[e("h2",{class:"font-semibold text-lg px-2"},"Task List",-1)])),_:1,__:[19]}),e("div",Xt,[e("table",Zt,[s[21]||(s[21]=e("thead",null,[e("tr",null,[e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"SL"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Task"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Assigns"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Deadline"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400 sticky right-0 bg-gray-50"}," Status ")])],-1)),e("tbody",null,[m.value!="loading"&&((V=(O=t.value)==null?void 0:O.tasks)==null?void 0:V.length)===0?(n(),o("tr",es,s[20]||(s[20]=[e("td",{class:"py-4 px-3 border-t text-center text-gray-400 text-sm",colspan:"10"}," No Task ",-1)]))):(n(!0),o(H,{key:1},X(((M=t.value)==null?void 0:M.tasks)||[],(v,B)=>(n(),N(Ye,{key:v.id,task:v,indexing:B+1,class:"*:py-3 *:border-b-0",onEditClick:s[9]||(s[9]=W=>h.value=W),onEmployeeAssignClick:s[10]||(s[10]=W=>{C.value.isOpen=!0,C.value.taskId=W})},null,8,["task","indexing"]))),128))])])])]),e("div",ts,[k(se,{class:"mb-4"},{default:q(()=>{var v,B,W,Ce;return[e("h2",ss," '"+g(((B=(v=t.value)==null?void 0:v.to_department)==null?void 0:B.short_name)||((Ce=(W=t.value)==null?void 0:W.to_department)==null?void 0:Ce.name))+"' Feedback ",1)]}),_:1}),e("div",{class:z(["px-3 border border-dashed rounded-lg border-sky-600",[(P=t.value)!=null&&P.feedback?"py-3":"py-8"]]),colspan:"5"},[m.value!="loading"&&((U=t.value)!=null&&U.status)?(n(),o("div",rs,[(F=t.value)!=null&&F.feedback?(n(),N(ee,{key:0,lineClamp:"2",className:{button:"  underline"},class:"mb-4 print:mb-0"},{default:q(()=>{var v;return[e("p",{class:"text-sm text-justify",innerHTML:(v=t.value)==null?void 0:v.feedback},null,8,ns)]}),_:1})):u("",!0),e("div",{class:z([((K=t.value)!=null&&K.feedback,"w-full flex justify-center")])},[e("button",{class:"btn-3 print:hidden",onClick:s[11]||(s[11]=A(()=>{c.open=!0,c.requirement=t.value},["prevent"]))},g(t.value.feedback?"Update Feedback":"Add feedback"),1)],2)])):u("",!0)],2)]),(t.value,u("",!0)),m.value!="loading"&&!((oe=t.value)!=null&&oe.status)?(n(),o("div",as,[e("div",is,[k(It,{"requirement-id":(de=t.value)==null?void 0:de.id,onSuccess:D},{heading:q(()=>s[25]||(s[25]=[E(" Requirement Submission ")])),acceptButtonLabel:q(()=>s[26]||(s[26]=[e("span",{class:"btn-2 pl-2 text-base"},[e("i",{class:"fad fa-paper-plane text-lg mr-2"}),E("Submit Requirement ")],-1)])),submitButtonLabel:q(()=>s[27]||(s[27]=[E(" Submit Requirement ")])),_:1},8,["requirement-id"])])])):u("",!0),(ue=t.value)!=null&&ue.status?(n(),o("div",ls,[k(se,null,{default:q(()=>s[28]||(s[28]=[e("h2",{class:"font-semibold text-lg px-2"},"Approvals",-1)])),_:1,__:[28]}),e("div",os,[(n(),o(H,null,X(["from_in_charge","from_coordinator"],v=>k(Ie,{class:"pt-12",key:v,requirement:t.value,"approval-type":v,onUpdateApproval:s[12]||(s[12]=()=>D())},null,8,["requirement","approval-type"])),64))]),((me=t.value)==null?void 0:me.from_department_id)!==((pe=t.value)==null?void 0:pe.to_department_id)?(n(),o("div",ds,[(n(),o(H,null,X(["to_in_charge","to_coordinator"],v=>k(Ie,{class:"pt-12",key:v,requirement:t.value,"approval-type":v,onUpdateApproval:s[13]||(s[13]=()=>D())},null,8,["requirement","approval-type"])),64))])):u("",!0)])):u("",!0)])]),e("div",{class:"col-span-full md:col-span-4 xl:col-span-4 2xl:col-span-3 space-y-4 sticky top-[74px] bg-white shadow rounded-lg p-4 break-before-avoid-page",ref_key:"sidebarTop",ref:p},[e("div",us,[e("div",null,[e("div",ms,[s[30]||(s[30]=e("div",{class:"text-gray-500 text-sm"},"From",-1)),k(Te,{department:(ce=t.value)==null?void 0:ce.from_department,"short-name":!0},null,8,["department"])]),s[31]||(s[31]=e("div",{class:"text-gray-600 text-sm mb-2 border-b border-dashed"},"Supervisor",-1)),e("div",ps,[(ve=t.value)!=null&&ve.supervisor?(n(),N(ie,{key:0,user:(fe=t.value)==null?void 0:fe.supervisor},null,8,["user"])):u("",!0)])]),s[33]||(s[33]=e("hr",{class:"my-4"},null,-1)),e("div",null,[e("div",cs,[s[32]||(s[32]=e("div",{class:"text-gray-500 text-sm"},"To",-1)),k(Te,{department:(be=t.value)==null?void 0:be.to_department,"short-name":!0},null,8,["department"])])])]),e("div",vs,[s[34]||(s[34]=e("div",{class:"text-gray-500 text-sm"},"Requirement ID:",-1)),e("div",fs,g((xe=t.value)==null?void 0:xe.id),1)]),((ge=(ye=t.value)==null?void 0:ye.website_tags)==null?void 0:ge.length)>0?(n(),o("div",bs,[s[35]||(s[35]=e("div",{class:"text-gray-500 text-sm"},"Website",-1)),e("div",xs,[(n(!0),o(H,null,X(((_e=t.value)==null?void 0:_e.website_tags)||[],v=>(n(),o("div",{key:v.id,class:"border px-1 rounded-md bg-sky-100 border-sky-400 text-sky-700 whitespace-nowrap text-xs"},g(v.name),1))),128))])])):u("",!0),(ke=t.value)!=null&&ke.submission_date?(n(),o("div",ys,[s[36]||(s[36]=e("div",{class:"text-gray-500 text-sm"},"Submission Date",-1)),e("div",gs,g(J(re)((we=t.value)==null?void 0:we.submission_date)),1)])):u("",!0),(he=t.value)!=null&&he.better_to_complete_on?(n(),o("div",_s,[s[37]||(s[37]=e("div",{class:"text-gray-500 text-sm"},"Better To Complete",-1)),e("div",ks,g(J(re)((qe=t.value)==null?void 0:qe.better_to_complete_on)),1)])):u("",!0),e("div",null,[e("div",ws,[s[38]||(s[38]=e("span",{class:"text-gray-500 text-sm"},"Priority:",-1)),e("div",null,[e("span",{class:z(["font-semibold text-sm",{"text-yellow-600 ":t.value.priority=="IMPORTANT","text-red-700 ":t.value.priority=="URGENT"}])},g(t.value.priority||"NORMAL"),3)])]),e("div",hs,[e("div",qs,[s[39]||(s[39]=e("span",{class:"text-gray-500 text-sm"},"Status:",-1)),t.value.status?(n(),o("span",{key:0,class:z(["border rounded-lg px-2 text-sm py-0.5",{"bg-red-300 text-red-700 border-red-400":t.value.status!="approved","bg-green-300 text-green-700 border-green-400":t.value.status=="approved"}])},g(String(t.value.status).toUpperCase()),3)):(n(),o("span",$s,"..."))])]),s[42]||(s[42]=e("hr",{class:"mb-3"},null,-1)),e("div",Cs,[t.value.status=="approved"?(n(),o("button",{key:0,class:"btn-3 font-semibold h-8 !pl-2 !pr-4",onClick:A(T,["prevent"])},s[40]||(s[40]=[e("i",{class:"fas fa-plus text-sm"},null,-1),E(" Add/Assign Task ")]))):u("",!0),k(j,{class:"btn-2 h-8",to:`/requirements/edit/${($e=t.value)==null?void 0:$e.id}`},{default:q(()=>s[41]||(s[41]=[E(" Edit ")])),_:1,__:[41]},8,["to"])])])],512),k(Ve,{class:"col-span-full md:col-span-4 xl:col-span-4 2xl:col-span-3 md:sticky",ref_key:"shareComponent",ref:d},null,512)])):u("",!0),m.value==="loading"?(n(),N(le,{key:1,class:"absolute inset-0 bg-opacity-90"})):u("",!0)])])}}};export{dr as default};
