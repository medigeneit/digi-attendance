import{L as D}from"./LoaderView-DFgqNtYf.js";import{_ as V}from"./FlexibleDatePicker-CH_fnWhB.js";import{u as L,g as N,r as q,x as i,q as B,p as M,c as r,o as a,a as t,d as u,m as v,b as p,n as O,t as n,F as R,e as j,s as F,k as $}from"./index-vB-QvZ4T.js";import{u as P}from"./exchange-jFJWKswL.js";const z={class:"space-y-6 px-4 py-5"},T={class:"rounded-2xl border border-slate-200 bg-white px-4 py-4 shadow-sm md:px-6"},U={class:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between"},G={class:"flex flex-wrap items-center gap-2"},H={key:0,class:"text-center py-10"},W={key:1,class:"space-y-4"},Y={key:0,class:"rounded-2xl border border-dashed border-slate-300 bg-slate-50 p-6 text-center text-slate-600"},I={key:1,class:"rounded-2xl border border-slate-200 bg-white shadow-sm"},J={class:"flex items-center justify-between border-b border-slate-100 px-5 py-3"},K={class:"text-sm font-semibold text-slate-600"},Q={class:"overflow-x-auto"},X={class:"min-w-full divide-y divide-slate-100 text-sm"},Z={class:"divide-y divide-slate-100"},tt={class:"px-4 py-3 font-semibold text-slate-600"},et={class:"px-4 py-3 text-slate-700"},st={class:"px-4 py-3 text-slate-700"},ot={class:"px-4 py-3 text-slate-700"},rt={class:"px-4 py-3"},at=["href"],lt={key:1,class:"text-xs text-slate-400"},dt={class:"px-4 py-3"},nt={class:"px-4 py-3"},it={class:"flex items-center justify-end gap-2"},ut=["onClick"],w="offday",bt={__name:"MyOffdayExchangeList",setup(pt){const h=L(),l=P();N();const c=new Date,f=q({year:c.getFullYear(),month:c.getMonth()+1,day:c.getDate()}),k=o=>o.toString().padStart(2,"0"),m=i(()=>{const o=f.value||{};return!o.year||!o.month?"":`${o.year}-${k(o.month)}`}),E=async o=>{if(!(!o||!window.confirm("Are you sure you want to delete this exchange request?")))try{await l.deleteExchange(o),alert("Exchange request deleted successfully."),await l.fetchExchanges({payload:{type:w,date:m.value}})}catch{alert(l.error||"Failed to delete the exchange request. Please try again.")}},S=o=>{l.fetchExchanges({payload:{type:w,date:o}})};B(m,o=>{o&&S(o)},{immediate:!0});const y=o=>o?new Date(o).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"N/A",x=i(()=>l.exchanges||[]),_=i(()=>Array.isArray(x.value)?x.value.length:0);i(()=>{const o=m.value,[s,d]=(o||"").split("-");return!s||!d?"Month":new Date(Number(s),Number(d)-1).toLocaleString("en-US",{month:"long",year:"numeric"})});const g=o=>{const s=(o||"").toLowerCase();return["approved","accepted"].includes(s)?"border border-emerald-200 bg-emerald-50 text-emerald-700":["rejected","declined","cancelled"].includes(s)?"border border-red-200 bg-red-50 text-red-700":s==="pending"||!s?"border border-amber-200 bg-amber-50 text-amber-800":"border border-slate-200 bg-slate-50 text-slate-800"},A=()=>{h.go(-1)};return(o,s)=>{var b;const d=M("RouterLink");return a(),r("div",z,[t("div",T,[t("div",U,[t("div",null,[t("button",{class:"btn-3",onClick:A},s[1]||(s[1]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:inline-flex"},"Back",-1)]))]),s[3]||(s[3]=t("div",{class:"space-y-1"},[t("p",{class:"text-2xl font-semibold text-slate-900"},"Offday Exchanges Records")],-1)),t("div",G,[u(d,{to:{name:"OffdayExchangeAdd"},class:"btn-2"},{default:v(()=>s[2]||(s[2]=[t("i",{class:"far fa-plus mr-1"},null,-1),p(" Request Offday Exchange ")])),_:1,__:[2]}),u(V,{modelValue:f.value,"onUpdate:modelValue":s[0]||(s[0]=e=>f.value=e),"show-year":!1,"show-month":!0,"show-date":!1,label:"Month"},null,8,["modelValue"])])])]),(b=O(l))!=null&&b.loading?(a(),r("div",H,[u(D)])):(a(),r("div",W,[_.value===0?(a(),r("div",Y,s[4]||(s[4]=[t("p",{class:"text-lg font-semibold text-slate-800"},"No exchanges yet",-1),t("p",{class:"text-sm text-slate-500"},"Try a different month or create a new request",-1)]))):(a(),r("div",I,[t("div",J,[t("p",K,"Showing "+n(_.value)+" requests",1),s[5]||(s[5]=t("span",{class:"text-xs text-slate-500"},"Auto-updated",-1))]),t("div",Q,[t("table",X,[s[9]||(s[9]=t("thead",{class:"bg-slate-50 text-[11px] uppercase tracking-wider text-slate-500"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left"},"#"),t("th",{class:"px-4 py-3 text-left"},"Created Date"),t("th",{class:"px-4 py-3 text-left"},"Holiday / Weekend"),t("th",{class:"px-4 py-3 text-left"},"Exchange Date"),t("th",{class:"px-4 py-3 text-left"},"Attachment"),t("th",{class:"px-4 py-3 text-left"},"Status"),t("th",{class:"px-4 py-3 text-right"},"Actions")])],-1)),t("tbody",Z,[(a(!0),r(R,null,j(x.value,(e,C)=>(a(),r("tr",{key:e==null?void 0:e.id,class:"hover:bg-slate-50 transition"},[t("td",tt,n(C+1),1),t("td",et,n(y(e==null?void 0:e.created_at)),1),t("td",st,n(y(e==null?void 0:e.current_date)),1),t("td",ot,n(y(e==null?void 0:e.exchange_date)),1),t("td",rt,[e!=null&&e.attachment&&typeof(e==null?void 0:e.attachment)=="string"?(a(),r("a",{key:0,href:e.attachment,target:"_blank",class:"inline-flex items-center gap-1 text-xs font-semibold text-indigo-600 hover:underline"},s[6]||(s[6]=[t("i",{class:"far fa-paperclip"},null,-1),p(" View ")]),8,at)):(a(),r("span",lt,"None"))]),t("td",dt,[t("span",{class:F(["inline-flex items-center rounded-full px-3 py-1 text-[11px] font-semibold tracking-wide",g(e==null?void 0:e.status)])},n((e==null?void 0:e.status)||"Pending"),3)]),t("td",nt,[t("div",it,[u(d,{to:{name:"ExchangeOffdayShow",params:{id:e==null?void 0:e.id}},class:"inline-flex items-center rounded-full border border-slate-200 px-3 py-1.5 text-xs font-semibold text-slate-600 transition hover:border-indigo-200 hover:text-indigo-700"},{default:v(()=>s[7]||(s[7]=[t("i",{class:"far fa-eye mr-1"},null,-1),p(" View ")])),_:2,__:[7]},1032,["to"]),e.status=="Pending"||!e.status?(a(),r("button",{key:0,type:"button",onClick:ct=>E(e==null?void 0:e.id),class:"inline-flex items-center rounded-full border border-red-200 px-3 py-1.5 text-xs font-semibold text-red-600 transition hover:border-red-300 hover:text-red-700"},s[8]||(s[8]=[t("i",{class:"far fa-trash mr-1"},null,-1),p(" Delete ")]),8,ut)):$("",!0)])])]))),128))])])])]))]))])}}};export{bt as default};
