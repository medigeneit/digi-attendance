import{L as Q}from"./LoaderView-DrXpvEzX.js";import{r as L,x as P,e as z,A as H,c as p,o as c,I as O,a as t,F as V,y as K,t as S,g as k,w as D,q as B,n as j,f as A,i as _,k as x,J as at,j as U,h as J,v as Z,Z as G,$ as Y}from"./index-Djrv-rUc.js";import{f as rt,b as X,g as lt}from"./datetime-l2Vm98rT.js";import{u as W}from"./useTodoStore-DLg1PPAe.js";import{O as et}from"./OverlyModal-BrxxS_hm.js";const ut={class:"grid grid-cols-7 *:text-center *:p-2 *:border-r *:border-b *:text-blue-800 *:text-sm"},ct={class:"flex flex-col"},mt={key:0,class:"p-2 border-r border-t"},yt={__name:"CalenderView",props:{month:{type:String,required:!0,validator:u=>/^\d{4}-(0[1-9]|1[0-2])$/.test(u)}},emits:["change"],setup(u,{emit:C}){const s=u,a=C,r=L(),e=L(),l=L(),d=L(),i=["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];function m(g,n,h,w){const b=[];for(let N=h-1;N>=0;N--){const y=w-N,$=new Date(g,n-1,y);b.push({date:$,day:$.getDate(),month:$.getMonth()+1,year:$.getFullYear(),isCurrentMonth:!1})}return b}function o(g,n,h){const w=[];for(let b=1;b<=h;b++){const y={date:new Date(g,n,b),day:b,month:n+1,year:g,isCurrentMonth:!0};w.push(y)}return w}function v(g,n,h){const w=[...g],b=Math.ceil(w.length/7)*7,N=1;for(let y=0;w.length<b;y++){const $=new Date(n,h+1,N+y);w.push({date:$,day:$.getDate(),month:$.getMonth()+1,year:$.getFullYear(),isCurrentMonth:!1})}return w}function f(g,n){const h=new Date(g,n,1),b=new Date(g,n+1,0).getDate(),y=(h.getDay()+1)%7,I=new Date(g,n,0).getDate();let T=[];T=[...m(g,n,y,I)];const R=o(g,n,b);return l.value=R[0],d.value=R[R.length-1],T=[...T,...R],T=[...v(T,g,n)],r.value=T[0],e.value=T[T.length-1],T}const M=P(()=>{const[g,n]=s.month.split("-"),h=parseInt(g),w=parseInt(n)-1;return console.log({yearStr:g,monthStr:n}),f(h,w)}),E=P(()=>{const g=M.value,n=[];for(let h=0;h<g.length;h+=7)n.push(g.slice(h,h+7));return n});function F(){a("change",{gridStartDate:r.value,gridEndDate:e.value,startOfMonth:l.value,endOfMonth:d.value})}return z(()=>F()),H(()=>s.month,F),(g,n)=>(c(),p("div",null,[O(g.$slots,"calender-top"),t("div",ut,[(c(),p(V,null,K(i,h=>t("div",{key:h},S(h),1)),64))]),t("div",ct,[(c(!0),p(V,null,K(E.value,(h,w)=>(c(),p("div",{class:"week grid grid-cols-7 min-h-28 items-stretch",key:w},[(c(!0),p(V,null,K(h,(b,N)=>O(g.$slots,"date",{key:N,day:b.day,month:b.month,year:b.year,weekday:(b.date.getDay()+1)%7,isCurrentMonth:b.isCurrentMonth,yearMonthDate:`${b.year}-${String(b.month).padStart(2,"0")}-${String(b.day).padStart(2,"0")}`},()=>{var y;return[b!=null&&b.date?(c(),p("div",mt,S((y=b==null?void 0:b.date)==null?void 0:y.getDate()),1)):k("",!0)]})),128))]))),128))]),O(g.$slots,"calender-bottom")]))}},vt={class:"px-4 py-2 flex items-center bg-gray-50 group gap-2"},pt=["value"],ft=["value"],gt=["value"],bt=["value"],ht=["disabled"],kt={key:4,class:"ml-4 md:ml-auto flex items-center gap-2"},wt={key:5,class:"ml-4 md:ml-auto flex items-center gap-2"},Ct={__name:"TodoHeading",props:{selected:{type:Object,default:()=>({type:"month-view",month:"",day:"",year:"",week:""})},loading:{type:Boolean,default:!1}},emits:["reloadClick",,"change"],setup(u,{emit:C}){const s=u,a=[{value:"month-view",label:"Monthly"},{value:"day-view",label:"Daily"}],r=C,e=L();function l(n){e.value=n,r("change",{...s.selected,type:n})}H(()=>{var n;return(n=s.selected)==null?void 0:n.type},n=>l(n),{immediate:!0});const d=P(()=>e.value=="month-view"&&s.selected.year&&s.selected.month?[s.selected.year,s.selected.month-1,1]:e.value=="day-view"&&s.selected.year&&s.selected.month&&s.selected.day?[s.selected.year,s.selected.month-1,s.selected.day]:[new Date().getFullYear(),new Date().getMonth(),new Date().getDate()]);function i(){e.value=="month-view"&&E(new Date)}function m(){if(e.value=="month-view"){const n=new Date(...d.value);n.setMonth(n.getMonth()+1),E(n)}}function o(){if(e.value=="month-view"){const n=new Date(...d.value);n.setMonth(n.getMonth()-1),E(n)}}function v(){e.value=="day-view"&&E(new Date)}function f(){if(e.value=="day-view"){const n=new Date(...d.value);n.setDate(n.getDate()+1),E(n)}}function M(){if(e.value=="day-view"){const n=new Date(...d.value);n.setDate(n.getDate()-1),E(n)}}function E(n){r("change",{type:e.value,month:n.getMonth()+1,day:n.getDate(),year:n.getFullYear(),week:n.getDay()})}const F=P(()=>e.value=="month-view"?`${s.selected.year}-${s.selected.month.toString().padStart(2,"0")}`:e.value=="day-view"?`${s.selected.year}-${s.selected.month.toString().padStart(2,"0")}-${s.selected.day.toString().padStart(2,"0")}`:s.selected),g=n=>{var h,w;if(e.value=="month-view"){const[b,N]=(h=n.target.value)==null?void 0:h.split("-").map(Number),y=new Date(b,N-1,1);E(y)}if(e.value=="day-view"){const b=new Date((w=n.target)==null?void 0:w.value);E(b)}};return(n,h)=>(c(),p("div",null,[t("div",vt,[O(n.$slots,"before",{selected:u.selected}),O(n.$slots,"typeSelection",{selected:u.selected,types:a,changeType:l},()=>[t("select",{class:"px-2 h-7 border rounded",value:e.value,onChange:h[0]||(h[0]=w=>l(w.target.value))},[(c(),p(V,null,K(a,w=>t("option",{value:w.value,key:w.id},S(w.label),9,ft)),64))],40,pt)]),e.value=="month-view"?(c(),p("input",{key:0,type:"month",value:F.value,onInput:g,class:"border px-2 rounded"},null,40,gt)):k("",!0),e.value=="day-view"?(c(),p("input",{key:1,type:"date",value:F.value,onInput:g,class:"border px-2 rounded"},null,40,bt)):k("",!0),e.value=="month-view"?(c(),p("button",{key:2,class:"btn-3 mx-4 h-7",onClick:D(i,["prevent"])}," Current Month ")):k("",!0),e.value=="day-view"?(c(),p("button",{key:3,class:"btn-3 mx-4 h-7",onClick:D(v,["prevent"])}," Today ")):k("",!0),t("button",{class:B(["btn-3 px-2 py-2 mx-4 size-7 disabled:text-gray-300 disabled:border-gray-300",{"animate-spin text-gray-300 border-gray-300 !bg-opacity-0":u.loading}]),onClick:h[1]||(h[1]=D(w=>r("reloadClick"),["prevent"])),disabled:u.loading},h[2]||(h[2]=[t("i",{class:"fas fa-redo-alt"},null,-1)]),10,ht),e.value=="month-view"?(c(),p("div",kt,[t("button",{class:"btn-2 h-7",onClick:D(o,["prevent"])}," Previous Month "),t("button",{class:"btn-2 h-7",onClick:D(m,["prevent"])},"Next Month")])):k("",!0),e.value=="day-view"?(c(),p("div",wt,[t("button",{class:"btn-2 h-7",onClick:D(M,["prevent"])},"Previous Day"),t("button",{class:"btn-2 h-7",onClick:D(f,["prevent"])},"Next Day")])):k("",!0),O(n.$slots,"after",{selected:u.selected})]),O(n.$slots,"bottom",{selected:u.selected})]))}},xt={key:0,class:"fa fa-exclamation-circle",title:"Pending"},Dt={key:1,class:"fa fa-exclamation-square",title:"Wording"},$t={key:2,class:"fa fa-check-square",title:"Completed"},ot={__name:"TodoStatusIcon",props:{todo:{type:Object,required:!0}},setup(u){const C=u,s=P(()=>{switch(C.todo.status){case"PENDING":return"text-red-400";case"WORKING":return"text-yellow-400";case"COMPLETED":return"text-green-400"}return""});return(a,r)=>(c(),p("span",{class:B(s.value)},[u.todo.status=="PENDING"?(c(),p("i",xt)):k("",!0),u.todo.status=="WORKING"?(c(),p("i",Dt)):k("",!0),u.todo.status=="COMPLETED"?(c(),p("i",$t)):k("",!0)],2))}},St=["onClick","title"],Tt={class:"line-clamp-1"},_t={key:0,class:"text-purple-600 text-center"},it={__name:"TodosInDate",props:{date:{type:String,required:!0},maxItems:{type:[Number,String],default:3}},emits:["clickTodo"],setup(u,{emit:C}){const s=u,a=C,{getTodosByDate:r}=W(),e=P(()=>{let l=[],d=!1,i=[];if(typeof r=="function"){const m=r(s.date);if(i=Array.isArray(m)?m:[],s.maxItems==="all")return{all:i,items:i,moreItemsCount:0};l=i.slice(0,s.maxItems),d=i.length-l.length}return{all:i,items:l,moreItemsCount:d}});return(l,d)=>(c(),p("div",null,[e.value.items.length===0?O(l.$slots,"noTodos",{key:0},()=>[d[0]||(d[0]=t("div",{class:"text-gray-400 text-center"},"No todos",-1))]):(c(),p(V,{key:1},[(c(!0),p(V,null,K(e.value.items,i=>O(l.$slots,"todoItem",{key:i.id,todo:i,moreItemsCount:e.value.moreItemsCount},()=>[t("div",{class:B(["px-1 mb-2 text-sm rounded cursor-pointer flex items-center gap-2",{"bg-sky-50 text-sky-900 hover:bg-sky-700 hover:text-white border border-sky-300":i.status!=="COMPLETED","bg-green-500 text-white":i.status==="COMPLETED"}]),onClick:D(m=>a("clickTodo",i),["prevent","stop"]),title:i.title},[j(ot,{todo:i,class:B(["text-sm",[i.status=="COMPLETED"?"!text-white":""]])},null,8,["todo","class"]),t("div",Tt,S(i.title),1)],10,St)])),128)),e.value.moreItemsCount>0?(c(),p("div",_t," + "+S(e.value.moreItemsCount)+" more todo"+S(e.value.moreItemsCount>1?"s":""),1)):k("",!0)],64))]))}},Mt={class:"relative"},It=["onClick","onKeypress"],Et={class:"flex items-center justify-center"},Ot=["onClick"],Nt={__name:"TodosInCalenderView",props:{month:{type:String,required:!0,validator:u=>/^\d{4}-(0[1-9]|1[0-2])$/.test(u)}},emits:["dateClick","clickTodo","clickDateCell"],setup(u,{emit:C}){const s=C;function a(e,l){e.isTrusted&&e.ctrlKey&&e.which==10&&s("dateClick",l)}function r(e){const[l,d,i]=String(e).split("-").map(Number),m=new Date(l,d-1,i);return rt(m)}return(e,l)=>(c(),p("div",Mt,[u.month?(c(),A(yt,{key:0,month:u.month,class:"border-t border-blue-200/50 relative"},{date:_(({day:d,yearMonthDate:i,isCurrentMonth:m})=>[t("div",{tabindex:"0",class:B(["border p-4 cursor-pointer group/date relative",{"bg-rose-50  border-rose-300 focus:bg-rose-50 focus:outline-rose-400":r(i),"hover:bg-sky-50  hover:border-blue-300 focus:bg-sky-50 focus:outline-blue-400":!r(i)}]),onClick:D(o=>s("dateClick",i),["prevent","stop"]),onKeypress:D(o=>a(o,i),["prevent"])},[t("button",{tabindex:"1",class:B([{"text-gray-300":!m,"text-sky-400":m},"text-center mb-2 font-semibold hover:bg-sky-200 w-full rounded"])},S(d),3),t("div",null,[j(it,{date:i,onClickTodo:l[0]||(l[0]=o=>s("clickTodo",o))},{noTodos:_(()=>l[1]||(l[1]=[t("span",null,null,-1)])),_:2},1032,["date"])]),t("div",Et,[t("button",{onClick:D(o=>s("clickDateCell",i),["prevent","stop"]),class:"btn-3 !py-1 invisible group-hover/date:visible text-sm text-red-800/40"},l[2]||(l[2]=[t("i",{class:"fas fa-plus"},null,-1),t("span",{class:"hidden lg:inline whitespace-nowrap"}," Add todo ",-1)]),8,Ot)])],42,It)]),_:1},8,["month"])):k("",!0)]))}},Lt={class:"relative bg-white p-4"},Pt={class:"max-w-6xl mx-auto border rounded my-10"},Ft={class:"mb-4 text-gray-700 border-b py-2 px-4 flex items-center"},jt={class:"text-lg font-semibold"},At={class:"ml-auto"},Rt=["onClick"],Ut={class:"line-clamp-2 ml-2"},Vt={key:0,class:"line-clamp-2 ml-2 text-gray-500"},qt={class:"ml-auto flex items-center gap-2"},Bt=["onClick"],Wt=["onClick"],Kt=["onClick"],zt={__name:"TodosInDailyView",props:{date:{type:String,required:!0}},emits:["clickTodo","clickAdd","clickEdit","clickDelete","clickChangeStatus","backClick","update"],setup(u,{emit:C}){const s=u,a=C,r=P(()=>new Date(s.date)),e=W();async function l(i){confirm(`Are your sure want to delete todo
'${i==null?void 0:i.title}'`)&&(await e.deleteTodo(i.id),a("update"))}async function d(i){confirm(`Are your sure want to compete todo
'${i==null?void 0:i.title}'`)&&(await e.updateTodoStatus(i.id,"COMPLETED"),a("update"))}return(i,m)=>(c(),p("div",Lt,[t("div",Pt,[t("div",Ft,[t("button",{class:"fa fa-arrow-left btn-icon mr-2",onClick:m[0]||(m[0]=D(o=>a("backClick"),["prevent"]))}),t("div",jt,S(x(X)(r.value,{weekDay:"long"})),1),t("div",At,[t("button",{class:"btn btn-icon",onClick:m[1]||(m[1]=D(o=>a("clickAdd",s.date),["prevent"]))},m[2]||(m[2]=[t("i",{class:"fas fa-plus"},null,-1)]))])]),j(it,{date:u.date,"max-items":10,class:"my-8 w-full px-4"},{todoItem:_(({todo:o})=>[t("div",{class:"border rounded px-4 py-3 my-4 hover:bg-sky-50 cursor-pointer flex items-center",onClick:D(v=>a("clickTodo",o),["prevent"])},[j(ot,{todo:o},null,8,["todo"]),t("div",Ut,S(o.title),1),o.todo_type&&o.todo_type_id?(c(),p("div",Vt,S(o.todo_type)+" id "+S(o.todo_type_id),1)):k("",!0),t("div",qt,[o.status==="WORKING"?(c(),p("button",{key:0,class:"btn-icon bg-green-400 text-white hover:bg-green-600 hover:text-white",onClick:D(()=>d(o),["prevent","stop"])},m[3]||(m[3]=[t("i",{class:"fas fa-check"},null,-1)]),8,Bt)):k("",!0),t("button",{class:"btn-icon bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:D(v=>a("clickEdit",o),["prevent","stop"])},m[4]||(m[4]=[t("i",{class:"fas fa-pen"},null,-1)]),8,Wt),t("button",{class:"btn-icon bg-red-400 text-white hover:bg-red-600 hover:text-white",onClick:D(()=>l(o),["prevent","stop"])},m[5]||(m[5]=[t("i",{class:"fas fa-trash-alt"},null,-1)]),8,Kt)])],8,Rt)]),noTodos:_(()=>m[6]||(m[6]=[t("div",{class:"flex min-h-[38vh] items-center justify-center text-gray-400 text-center rounded-md"}," No Todos ",-1)])),_:1},8,["date"])])]))}},Gt={class:"bg-white border-t px-4 py-4 sticky bottom-0 rounded-b-md"},Yt={key:0,class:"mb-4 text-red-500 font-medium"},Ht={key:1,class:"mb-4 text-blue-500 font-medium"},Jt={class:"flex justify-between items-center gap-4"},Zt=["disabled"],dt={__name:"FormHandler",props:{isSubmitting:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["submit","clickCancel"],setup(u,{emit:C}){const s=C;return(a,r)=>(c(),p("form",{onSubmit:r[1]||(r[1]=D(e=>s("submit"),["prevent"]))},[O(a.$slots,"default"),t("div",Gt,[u.error?(c(),p("div",Yt,S(u.error),1)):k("",!0),u.isSubmitting?(c(),p("div",Ht,"Saving changes...")):k("",!0),O(a.$slots,"footer",{},()=>[t("div",Jt,[t("button",{type:"button",onClick:r[0]||(r[0]=e=>s("clickCancel")),class:"btn-3"},"Cancel"),t("button",{disabled:u.isSubmitting||u.isLoading,type:"submit",class:"btn-2"},S(u.isSubmitting?"Saving...":"Save"),9,Zt)])])])],32))}},Qt={class:""},Xt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},te={class:"mb-2"},ee={class:"mb-4"},oe={class:"mb-4"},ne={__name:"TodoAddForm",props:{date:{type:String,default:lt(new Date)}},emits:["update","cancelClick"],setup(u,{emit:C}){const s=u,a=L(),r=L(),e=W(),l=C,d=L({title:"",date:s.date||"",task_id:""});async function i(){try{a.value="submitting",await e.createTodo(d.value),l("update")}finally{a.value=""}}const m=P(()=>new Date(s.date));return z(async()=>{var o;await at(),(o=r.value)==null||o.focus()}),(o,v)=>(c(),p("div",Qt,[x(e).loading?(c(),A(Q,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:_(()=>v[3]||(v[3]=[U(" Loading... ")])),_:1,__:[3]})):k("",!0),j(dt,{onSubmit:i,onClickCancel:v[2]||(v[2]=f=>l("cancelClick")),isSubmitting:a.value=="submitting",error:x(e).error,class:"rounded-md relative"},{default:_(()=>[v[7]||(v[7]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Add Todo")],-1)),t("div",Xt,[t("div",te,[v[4]||(v[4]=t("span",{class:"font-semibold"}," Date ",-1)),t("span",null,S(x(X)(m.value,{weekDay:"long"})),1)]),t("div",ee,[v[5]||(v[5]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),J(t("input",{ref_key:"titleRef",ref:r,"onUpdate:modelValue":v[0]||(v[0]=f=>d.value.title=f),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Z,d.value.title]])]),t("div",oe,[v[6]||(v[6]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),J(t("input",{"onUpdate:modelValue":v[1]||(v[1]=f=>d.value.task_id=f),placeholder:"Enter a task id",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Z,d.value.task_id]])])])]),_:1,__:[7]},8,["isSubmitting","error"])]))}},se={class:"relative"},ae={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},le={class:"mb-2"},ie={class:"mb-4"},de={class:"mb-4"},re={__name:"TodoEditForm",props:{date:{type:String,default:lt(new Date)},todo:{type:Object,default:()=>{}}},emits:["update","cancelClick"],setup(u,{emit:C}){const s=u,a=L(),r=L(),e=W(),l=C,d=L({title:"",todo_type:"task",todo_type_id:""});async function i(){var v,f,M;await e.fetchTodo((v=s.todo)==null?void 0:v.id),d.value.title=(f=e.todo)==null?void 0:f.title,d.value.todo_type_id=(M=e.todo)==null?void 0:M.todoable_id}async function m(){a.value="submitting";try{await e.updateTodo(s.todo.id,d.value),l("update")}finally{a.value=""}}const o=P(()=>new Date(s.todo.date));return z(async()=>{var v;await i(),await at(),(v=r.value)==null||v.focus()}),(v,f)=>(c(),p("div",se,[x(e).loading?(c(),A(Q,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:_(()=>f[3]||(f[3]=[U(" Loading... ")])),_:1,__:[3]})):k("",!0),j(dt,{onSubmit:m,onClickCancel:f[2]||(f[2]=M=>l("cancelClick")),isSubmitting:a.value=="submitting",isLoading:x(e).loading,error:x(e).error},{default:_(()=>[f[7]||(f[7]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Edit Todo")],-1)),t("div",ae,[t("div",le,[f[4]||(f[4]=t("span",{class:"font-semibold"}," Date ",-1)),t("span",null,S(x(X)(o.value,{weekDay:"long"})),1)]),t("div",ie,[f[5]||(f[5]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),J(t("input",{ref_key:"titleRef",ref:r,"onUpdate:modelValue":f[0]||(f[0]=M=>d.value.title=M),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Z,d.value.title]])]),t("div",de,[f[6]||(f[6]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),J(t("input",{"onUpdate:modelValue":f[1]||(f[1]=M=>d.value.todo_type_id=M),placeholder:"Enter a task id",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Z,d.value.todo_type_id]])])])]),_:1,__:[7]},8,["isSubmitting","isLoading","error"])]))}},ue={class:"relative"},ce={class:"min-h-[10vh] max-h-[50vh] overflow-y-auto p-4"},me={class:"mb-4"},ye={class:"mb-4"},ve={class:"flex items-center gap-4"},pe={key:0,class:"flex items-center gap-2"},fe={class:"flex justify-between items-center gap-4 py-4 px-4 border-t"},ge={class:"ml-auto flex items-center gap-2"},be={__name:"TodoShow",props:{todo:{type:Object,default:()=>{}}},emits:["cancelClick","clickEdit","update"],setup(u,{emit:C}){const s=u,a=W(),r=C;async function e(){var m;await a.fetchTodo((m=s.todo)==null?void 0:m.id)}const l=P(()=>{var m,o;return(m=a.todo)!=null&&m.date?new Date((o=a.todo)==null?void 0:o.date):null});async function d(m){var o;confirm(`Are your sure want to delete todo
'${(o=a.todo)==null?void 0:o.title}'`)&&(await a.deleteTodo(m.id),r("update"))}async function i(m,o){var v;confirm(`Are your sure want to compete todo
'${(v=a.todo)==null?void 0:v.title}'`)&&(await a.updateTodoStatus(m.id,o),r("update"))}return z(async()=>{await e()}),(m,o)=>{var v,f,M,E,F,g;return c(),p("div",ue,[x(a).loading?(c(),A(Q,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:_(()=>o[5]||(o[5]=[U(" Loading... ")])),_:1,__:[5]})):k("",!0),t("div",null,[o[11]||(o[11]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Show Todo")],-1)),t("div",ce,[t("div",me,[o[6]||(o[6]=t("div",{class:"font-semibold text-xs text-gray-500"},"Date",-1)),t("span",null,S(x(X)(l.value,{weekDay:"long"})),1)]),t("div",ye,[o[7]||(o[7]=t("div",{class:"text-xs text-gray-500"},"Todo",-1)),U(" "+S((v=x(a).todo)==null?void 0:v.title),1)]),t("div",null,[o[10]||(o[10]=t("div",{class:"text-xs text-gray-500"},"Status",-1)),t("div",ve,[t("div",null,[(f=x(a))!=null&&f.todo?(c(),A(ot,{key:0,todo:(M=x(a))==null?void 0:M.todo},null,8,["todo"])):k("",!0),U(" "+S((E=x(a).todo)==null?void 0:E.status),1)]),x(a).loading?k("",!0):(c(),p("div",pe,[((F=x(a).todo)==null?void 0:F.status)==="PENDING"?(c(),p("button",{key:0,class:"btn-2 from-yellow-700 to-yellow-500 text-white hover:bg-green-600 hover:text-white",onClick:o[0]||(o[0]=D(()=>i(x(a).todo,"WORKING"),["prevent","stop"]))},o[8]||(o[8]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),U(" Change to Working ")]))):k("",!0),((g=x(a).todo)==null?void 0:g.status)==="WORKING"?(c(),p("button",{key:1,class:"btn-2 from-green-700 to-green-300 text-white hover:bg-green-600 hover:text-white",onClick:o[1]||(o[1]=D(()=>i(x(a).todo,"COMPLETED"),["prevent","stop"]))},o[9]||(o[9]=[t("i",{class:"fas fa-check"},null,-1),U(" Make Complete ")]))):k("",!0)]))])])])]),t("div",fe,[t("button",{type:"button",onClick:o[2]||(o[2]=n=>r("cancelClick")),class:"btn-3"},"Cancel"),t("div",ge,[t("button",{class:"btn-2 bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:o[3]||(o[3]=D(n=>r("clickEdit",x(a).todo),["prevent","stop"]))},o[12]||(o[12]=[t("i",{class:"fas fa-pen"},null,-1),U(" Edit ")])),t("button",{class:"btn-2-red",onClick:o[4]||(o[4]=D(()=>d(x(a).todo),["prevent","stop"]))},o[13]||(o[13]=[t("i",{class:"fas fa-trash-alt"},null,-1),U(" Delete ")]))])])])}}},he={__name:"TodoCreateEditShow",props:{todoModal:{type:Object,required:!0}},emits:["cancelClick","update","clickEdit","clickDelete","clickChangeStatus"],setup(u,{emit:C}){const s=C;function a(){s("update")}return(r,e)=>(c(),p(V,null,[u.todoModal.action=="add"?(c(),A(et,{key:0},{default:_(()=>{var l;return[j(ne,{onCancelClick:e[0]||(e[0]=d=>s("cancelClick")),onUpdate:a,date:(l=u.todoModal)==null?void 0:l.date},null,8,["date"])]}),_:1})):k("",!0),u.todoModal.action=="edit"?(c(),A(et,{key:1},{default:_(()=>{var l;return[j(re,{onCancelClick:e[1]||(e[1]=d=>s("cancelClick")),onUpdate:a,todo:(l=u.todoModal)==null?void 0:l.todo},null,8,["todo"])]}),_:1})):k("",!0),u.todoModal.action=="show"?(c(),A(et,{key:2},{default:_(()=>{var l;return[j(be,{onCancelClick:e[2]||(e[2]=d=>s("cancelClick")),onUpdate:a,onClickEdit:e[3]||(e[3]=d=>s("clickEdit",d)),onClickDelete:e[4]||(e[4]=d=>s("clickDelete",d)),onClickChangeStatus:e[5]||(e[5]=(d,i)=>s("clickChangeStatus",d,i)),todo:(l=u.todoModal)==null?void 0:l.todo},null,8,["todo"])]}),_:1})):k("",!0)],64))}},ke={class:"border bg-white relative"},Se={__name:"TodoSection",props:{year:{type:Number,default:()=>new Date().getFullYear()},month:{type:Number,default:()=>new Date().getMonth()+1},day:{type:Number,default:()=>new Date().getDate()},week:{type:Number,default:()=>new Date().getDay()},type:{type:String,default:"month-view"},listUserRole:{type:String,default:"employee"}},emits:["changeInput"],setup(u,{emit:C}){const s=new Date,a=u,r=L({type:"month-view",month:s.getMonth()+1,day:s.getDate(),year:s.getFullYear(),week:s.getDay()}),e=C;H(()=>({...r.value}),y=>{e("changeInput",y)}),H(()=>({year:a.year,month:a.month,day:a.day,week:a.week,type:a.type}),y=>{r.value={...y}},{immediate:!0});const l=L({action:null}),d=W();async function i(){await N()}function m(){l.value={...l.value,action:""}}async function o(y,$){await d.updateTodoStatus(y,$)}async function v(y){await d.deleteTodo(y)}function f(){r.value={...r.value,type:"month-view"}}function M(y){r.value={...r.value,...y}}function E(y){const[$,I,T]=y.split("-").map(Number);r.value={...r.value,type:"day-view",year:$,month:I,day:T}}function F(y){l.value={...l.value,action:"show",todo:y}}function g(y){l.value={...l.value,action:"edit",todo:y}}function n(y){l.value={...l.value,action:"add",date:y}}function h(){l.value={action:null,todo:null}}const w=P(()=>{var T,q,R,tt,nt,st;const y=(q=(T=r.value)==null?void 0:T.year)==null?void 0:q.toString(),$=(tt=(R=r.value)==null?void 0:R.month)==null?void 0:tt.toString().padStart(2,"0"),I=(st=(nt=r.value)==null?void 0:nt.day)==null?void 0:st.toString().padStart(2,"0");return`${y}-${$}-${I}`}),b=P(()=>{var I,T,q,R;const y=(T=(I=r.value)==null?void 0:I.year)==null?void 0:T.toString(),$=(R=(q=r.value)==null?void 0:q.month)==null?void 0:R.toString().padStart(2,"0");return`${y}-${$}`});async function N(){a.listUserRole=="employee"?await d.fetchMyTodos():await d.fetchTodos()}return z(async()=>{await N()}),(y,$)=>(c(),p("div",null,[t("div",ke,[x(d).loading?(c(),A(Q,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:_(()=>$[0]||($[0]=[U(" Loading... ")])),_:1,__:[0]})):k("",!0),j(Ct,{selected:r.value,class:"border-b shadow z-20",onChange:M,onReloadClick:i},{before:_(I=>[O(y.$slots,"beforeHeader",G(Y(I)))]),after:_(I=>[O(y.$slots,"afterHeader",G(Y(I)))]),bottom:_(I=>[O(y.$slots,"bottomHeader",G(Y(I)))]),typeSelection:_(I=>[O(y.$slots,"typeSelection",G(Y(I)))]),_:3},8,["selected"]),r.value.type=="month-view"?(c(),A(Nt,{key:1,month:b.value,class:"bg-white",onDateClick:E,onClickTodo:F,onClickDateCell:n},null,8,["month"])):k("",!0),r.value.type=="day-view"?(c(),A(zt,{key:2,date:w.value,onClickTodo:F,onClickEdit:g,onClickAdd:n,onClickDelete:v,onClickChangeStatus:o,onBackClick:f,onUpdate:m},null,8,["date"])):k("",!0)]),j(he,{todoModal:l.value,onCancelClick:h,onUpdate:m,onClickEdit:g},null,8,["todoModal"])]))}};export{yt as _,Se as a};
