import{u as B,b as E,B as R,r as b,p as S,c as d,o as i,a as l,y as f,h as D,v as M,k as g,F,x as N,t as a,n as T}from"./index-Bk7gtYxA.js";import{_ as V}from"./EmployeeFilter-pb4gDKj7.js";import{L as P}from"./LoaderView-hdhWzbKP.js";import{u as $}from"./attendance-QDF_LqOF.js";import{S as j}from"./sweetalert2.esm.all-DGhwgajj.js";import"./company-BqYvx0Ye.js";import"./department-Upu97Hhe.js";import"./EmployeeDropdownInput-D1h8gwSN.js";import"./SelectDropdown-BrLUcugp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-D5xIdD-W.js";const z={class:"space-y-2 px-4"},K={class:"flex flex-wrap items-center gap-2"},O={key:0,class:"text-center py-4"},W={key:1,class:"space-y-4"},G={key:0,class:"overflow-x-auto"},H={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},I={class:"border border-gray-300 px-2"},J={class:"border border-gray-300 px-2"},Q={class:"border border-gray-300 px-2"},X={class:"border border-gray-300 px-2"},Y={class:"border border-gray-300 px-2"},Z={class:"border border-gray-300 px-2"},ee={class:"border border-gray-300 px-2"},te={class:"border border-gray-300 px-2"},le={key:0},ne={key:1,class:"text-gray-500 italic text-xs"},oe={class:"border border-gray-300 px-2"},de={key:1,class:"text-center text-red-500 text-xl italic mt-10"},be={__name:"LateAttendanceReport",setup(ie){const c=B(),s=E(),_=$(),{monthlyLateLogs:h,isLoading:w,selectedMonth:k}=R(_),r=b(s.query.date||k.value),q=()=>{var t,o,e,y;c.replace({query:{...s.query,date:r.value}}),(t=n.value)!=null&&t.company_id&&((o=n.value)!=null&&o.department_id)&&((e=n.value)!=null&&e.type)&&((y=n.value)!=null&&y.employee_id)&&u(n.value)},u=async t=>{t.company_id&&(t!=null&&t.department_id)&&(t!=null&&t.line_type)&&(t!=null&&t.line_type)&&(t!=null&&t.employee_id)&&r.value&&await _.getAttendanceLateReport(t==null?void 0:t.company_id,t==null?void 0:t.department_id,t==null?void 0:t.line_type,t==null?void 0:t.employee_id,r.value,"monthly")},C=async()=>{n.value.company_id&&n.value.employee_id&&r.value?await _.lateReportDownloadExcel(n.value.company_id,n.value.employee_id,r.value,"monthly"):j.fire({icon:"warning",title:"Missing Selection!",text:"Please select Company, Employee, and Month first!",confirmButtonText:"OK"})},L=()=>{c.go(-1)},U=t=>t==="Pending"?"text-yellow-700":t==="Approved"?"text-green-700":"text-red-500",n=b({company_id:"",department_id:"all",line_type:"all",employee_id:""}),A=async()=>{var t,o,e,y,p,m,x,v;c.replace({query:{...s.query,company_id:(t=n.value)==null?void 0:t.company_id,department_id:(o=n.value)==null?void 0:o.department_id,line_type:(e=n.value)==null?void 0:e.line_type,employee_id:(y=n.value)==null?void 0:y.employee_id}}),(p=n.value)!=null&&p.company_id&&((m=n.value)!=null&&m.department_id)&&((x=n.value)!=null&&x.line_type)&&((v=n.value)!=null&&v.employee_id)&&u(n.value)};return S(()=>({company_id:s.query.company_id||"",department_id:s.query.department_id||"all",line_type:s.query.line_type||"all",employee_id:s.query.employee_id||""})),(t,o)=>(i(),d("div",z,[l("div",{class:"flex items-center justify-between gap-2"},[l("button",{class:"btn-3",onClick:L},o[5]||(o[5]=[l("i",{class:"far fa-arrow-left"},null,-1),l("span",{class:"hidden md:flex"},"Back",-1)])),o[7]||(o[7]=l("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Late Reports",-1)),l("div",{class:"flex gap-4"},[l("button",{type:"button",onClick:C,class:"btn-3"},o[6]||(o[6]=[l("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)]))])]),l("div",K,[f(V,{company_id:n.value.company_id,"onUpdate:company_id":o[0]||(o[0]=e=>n.value.company_id=e),department_id:n.value.department_id,"onUpdate:department_id":o[1]||(o[1]=e=>n.value.department_id=e),employee_id:n.value.employee_id,"onUpdate:employee_id":o[2]||(o[2]=e=>n.value.employee_id=e),line_type:n.value.line_type,"onUpdate:line_type":o[3]||(o[3]=e=>n.value.line_type=e),"with-type":!0,"initial-value":t.$route.query,onFilterChange:A},null,8,["company_id","department_id","employee_id","line_type","initial-value"]),l("div",null,[D(l("input",{id:"user-filter","onUpdate:modelValue":o[4]||(o[4]=e=>r.value=e),onChange:q,type:"month",class:"input-1"},null,544),[[M,r.value]])])]),g(w)?(i(),d("div",O,[f(P)])):(i(),d("div",W,[n.value.company_id&&n.value.employee_id&&n.value.department_id?(i(),d("div",G,[l("table",H,[o[8]||(o[8]=l("thead",null,[l("tr",{class:"bg-gray-200"},[l("th",{class:"border border-gray-300 px-2 text-left"},"#"),l("th",{class:"border border-gray-300 px-2 text-left"},"Date"),l("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),l("th",{class:"border border-gray-300 px-2 text-left"},"Company"),l("th",{class:"border border-gray-300 px-2 text-left"},"Department"),l("th",{class:"border border-gray-300 px-2 text-left"},"Entry Time"),l("th",{class:"border border-gray-300 px-2 text-left"},"Late Duration"),l("th",{class:"border border-gray-300 px-2 text-left"},"Action"),l("th",{class:"border border-gray-300 px-2 text-left"},"Shift")])],-1)),l("tbody",null,[(i(!0),d(F,null,N(g(h),(e,y)=>(i(),d("tr",{key:e.id,class:"border-b border-gray-200 hover:bg-blue-200"},[l("td",I,a(y+1),1),l("td",J,a(e==null?void 0:e.date),1),l("td",Q,a((e==null?void 0:e.user_name)||"Unknown"),1),l("td",X,a((e==null?void 0:e.company_name)||"Unknown"),1),l("td",Y,a((e==null?void 0:e.department_name)||"Unknown"),1),l("td",Z,a(e.entry_time),1),l("td",ee,a(e.late_duration),1),l("td",te,[e!=null&&e.short_leave?(i(),d("div",le,[l("span",{class:T(U(e.short_leave.status))},a(e.short_leave.status||"Waiting"),3)])):(i(),d("div",ne,"No Application"))]),l("td",oe,a(e.shift_name),1)]))),128))])])])):(i(),d("div",de," Please select company, department and employee "))]))]))}};export{be as default};
