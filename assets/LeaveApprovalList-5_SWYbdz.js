import{r as g,A as N,q as S,b as j,o as _,c as m,a as e,t as r,w as U,d as D,v as V,F as B,x as E,l as v,h as w,e as F,i as q}from"./index-D9fyjAEt.js";import{u as I}from"./user-DnhgJAv6.js";import{_ as R}from"./MultiselectDropdown-C606tXwk.js";import{_ as T,a as z}from"./HeaderWithButtons-BF2htYQP.js";import{L as G}from"./LoaderView-CAyOYSq-.js";import{u as H}from"./leave-approval-BgxVKF4v.js";import"./vue-multiselect.esm-JKg8_ZwO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50"},K={class:"bg-white rounded-lg shadow-lg w-full max-w-lg"},P={class:"px-6 py-4 border-b"},Q={class:"text-lg font-bold"},W=["for"],X={class:"flex justify-end space-x-4"},Y={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},Z={__name:"LeaveApprovalModal",props:{show:{type:Boolean,required:!0},leaveApproval:{type:Object,default:null}},emits:["close","save"],setup(A,{emit:d}){const c=A,u=d,p=I(),a=g(!1),l=N({id:null,name:"",in_charge_user_id:"",coordinator_user_id:"",operational_admin_user_id:"",recommend_by_user_id:"",approved_by_user_id:""}),n=N({in_charge_user_id:null,coordinator_user_id:null,operational_admin_user_id:null,recommend_by_user_id:null,approved_by_user_id:null}),y=()=>{Object.keys(n).forEach(t=>{n[t]=p.users.find(s=>s.id===l[t])||null})};Object.keys(n).forEach(t=>{S(()=>n[t],s=>{console.log(s),l[t]=s?s.id:null})});const f=()=>{Object.assign(l,{id:null,name:"",in_charge_user_id:"",coordinator_user_id:"",operational_admin_user_id:"",recommend_by_user_id:"",approved_by_user_id:""}),a.value=!1},h=()=>{Object.assign(n,{in_charge_user_id:"",coordinator_user_id:"",operational_admin_user_id:"",recommend_by_user_id:"",approved_by_user_id:""}),a.value=!1};S(()=>c.leaveApproval,t=>{t?(a.value=!0,Object.assign(l,t),y()):(f(),h())},{immediate:!0,deep:!0});const L=()=>{if(!l.name||!l.approved_by_user_id){alert("Name and Approved By are required!");return}u("save",{...l}),x()},x=()=>{f(),u("close")};return j(()=>{p.fetchUsers()}),(t,s)=>A.show?(_(),m("div",J,[e("div",K,[e("div",P,[e("h3",Q,r(a.value?"Edit Leave Approval":"Add Leave Approval"),1)]),e("form",{onSubmit:U(L,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[s[1]||(s[1]=e("label",{for:"name",class:"block text-sm font-medium"},"Approval Name",-1)),D(e("input",{id:"name","onUpdate:modelValue":s[0]||(s[0]=i=>l.name=i),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter approval name",required:""},null,512),[[V,l.name]])]),(_(),m(B,null,E({in_charge_user_id:"In-Charge",coordinator_user_id:"Coordinator",operational_admin_user_id:"Operational Admin",recommend_by_user_id:"Recommend By",approved_by_user_id:"Approved By"},(i,o)=>e("div",{key:o},[e("label",{for:o,class:"block text-sm font-medium"},r(i),9,W),v(R,{modelValue:n[o],"onUpdate:modelValue":b=>n[o]=b,multiple:!1,options:w(p).users},null,8,["modelValue","onUpdate:modelValue","options"])])),64)),e("div",X,[e("button",{type:"button",onClick:x,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400"}," Cancel "),e("button",Y,r(a.value?"Update":"Create"),1)])],32)])])):F("",!0)}},ee={class:"my-container space-y-2"},te={class:"overflow-x-auto"},se={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},oe={class:"text-gray-600 text-sm"},ae={key:0},le={colspan:"8"},re={class:"py-3 px-2 text-left"},ne={class:"py-3 px-2 text-left"},de={class:"py-3 px-2 text-left"},ie={class:"py-3 px-2 text-left"},ce={class:"py-3 px-2 text-left"},ue={class:"py-3 px-2 text-left"},pe={class:"py-3 px-2 text-left"},_e={class:"py-3 px-2 text-center"},me={class:"flex justify-center gap-4"},ve=["onClick"],ye=["onClick"],fe={key:2},Ce={__name:"LeaveApprovalList",setup(A){const d=H(),c=q(),u=g(!1),p=g(!1),a=g(null),l=()=>{a.value=null,u.value=!0},n=t=>{a.value={...t},u.value=!0},y=()=>{u.value=!1},f=t=>{a.value=t,p.value=!0},h=()=>{p.value=!1},L=async()=>{var t;if(!((t=a.value)!=null&&t.id)){c.error("Invalid leave approval selected for deletion!");return}try{await d.deleteLeaveApproval(a.value.id),c.success("Leave approval deleted successfully!")}catch(s){c.error("Failed to delete leave approval!"),console.error("Error deleting leave approval:",s)}finally{h()}},x=async t=>{const s=t.id?"updateLeaveApproval":"createLeaveApproval",i=t.id?"Leave approval updated successfully!":"Leave approval added successfully!";try{await d[s](t.id||t,t),c.success(i)}catch(o){c.error("Failed to save leave approval!"),console.error("Error saving leave approval:",o)}finally{y()}};return j(()=>{d.fetchLeaveApprovals()}),(t,s)=>{var i;return _(),m("div",ee,[v(z,{title:"Leave Approvals",onAdd:l}),e("div",te,[e("table",se,[s[3]||(s[3]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"#"),e("th",{class:"py-3 px-2 text-left"},"Name"),e("th",{class:"py-3 px-2 text-left"},"In-Charge"),e("th",{class:"py-3 px-2 text-left"},"Coordinator"),e("th",{class:"py-3 px-2 text-left"},"Operational Admin"),e("th",{class:"py-3 px-2 text-left"},"Recommend By"),e("th",{class:"py-3 px-2 text-left"},"Approved By"),e("th",{class:"py-3 px-2 text-center"},"Actions")])],-1)),e("tbody",oe,[w(d).loading?(_(),m("tr",ae,[e("td",le,[v(G,{class:"shadow-none"})])])):w(d).leaveApprovals.length?(_(!0),m(B,{key:1},E(w(d).leaveApprovals,o=>{var b,k,C,M,$;return _(),m("tr",{key:o.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",re,r(o.id),1),e("td",ne,r(o.name),1),e("td",de,r(((b=o.in_charge_user)==null?void 0:b.name)||"N/A"),1),e("td",ie,r(((k=o.coordinator_user)==null?void 0:k.name)||"N/A"),1),e("td",ce,r(((C=o.operational_admin_user)==null?void 0:C.name)||"N/A"),1),e("td",ue,r(((M=o.recommend_by_user)==null?void 0:M.name)||"N/A"),1),e("td",pe,r((($=o.approved_by_user)==null?void 0:$.name)||"N/A"),1),e("td",_e,[e("div",me,[e("button",{onClick:O=>n(o),class:"text-blue-600 hover:text-blue-800"},s[0]||(s[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ve),e("button",{onClick:O=>f(o),class:"text-red-600 hover:text-red-800"},s[1]||(s[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ye)])])])}),128)):(_(),m("tr",fe,s[2]||(s[2]=[e("td",{colspan:"8",class:"text-center text-red-500 py-4"},"No leave approvals found",-1)])))])])]),v(Z,{show:u.value,leaveApproval:a.value,onClose:y,onSave:x},null,8,["show","leaveApproval"]),v(T,{show:p.value,title:"Delete Leave Approval",message:`Are you sure you want to delete ${(i=a.value)==null?void 0:i.name}?`,onClose:h,onConfirm:L},null,8,["show","message"])])}}};export{Ce as default};
