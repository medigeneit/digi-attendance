import{r as k,h as Q,y as X,c as i,o as a,a as e,j as b,t as n,d as f,F as D,A as Y,f as ee,u as te,g as se,ab as re,x as J,p as oe,e as ne,s as ae,m,i as le,l as ie}from"./index-BUxtDSZU.js";import{u as B}from"./overtime-ClNCGRYP.js";import{_ as de}from"./AcceptAndRejectHandler-Cz_OR4D-.js";import{_ as w}from"./DisplayFormattedWorkingHours-C4ZlBV8I.js";import{_ as ce}from"./TimePickerAsFloatHour-Diu2X3lt.js";const ue={key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50"},pe={class:"modal-card max-w-sm p-4"},ye={class:"grid grid-cols-3 gap-2 border p-3"},be={class:"border-x"},me={class:"col-span-full text-xs md:text-sm border-t pt-3"},fe={class:"flex justify-between gap-2 mt-2"},ge={__name:"DeleteOvertime",props:{overtime:Object,onSuccess:{type:Function,default:null}},setup(r){const c=r,g=B(),u=k(null),x=k(null),p=k(!1),_=async()=>{await g.deleteOvertime(c.overtime.id),c.onSuccess&&await c.onSuccess(),v()},S=()=>{p.value=!0,t()},v=()=>{p.value=!1};function t(){Y(()=>{var y;(y=u.value)==null||y.focus()})}function d(y){var l,o;p.value&&(y.key==="ArrowLeft"?(l=x.value)==null||l.focus():y.key==="ArrowRight"&&((o=u.value)==null||o.focus()))}return Q(()=>{window.addEventListener("keydown",d)}),X(()=>{window.removeEventListener("keydown",d)}),(y,l)=>(a(),i(D,null,[e("i",{onClick:S,class:"fa fa-trash cursor-pointer text-red-600"}),p.value?(a(),i("div",ue,[e("div",pe,[l[0]||(l[0]=e("h3",{class:"title-lg"},"Delete Overtime",-1)),e("div",ye,[e("div",null,[e("b",null,n(new Date(r.overtime.date).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})),1)]),e("div",be,[e("b",null,n(r.overtime.duty_type),1)]),e("div",null,[e("b",null,[f(w,{workingHours:r.overtime.request_overtime_hours},null,8,["workingHours"])])]),e("div",me,n(r.overtime.work_details),1)]),e("div",fe,[e("button",{type:"button",ref_key:"cancelBtnRef",ref:x,class:"btn-3 focus:ring-2 ring-offset-2",onClick:v}," Cancel ",512),e("button",{type:"button",ref_key:"confirmBtnRef",ref:u,class:"btn-2-red focus:ring-2 ring-offset-2",onClick:_}," Delete ",512)])])])):b("",!0)],64))}},xe={key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50"},_e={class:"modal-card max-w-sm"},ve={class:"flex justify-between gap-2 mt-4"},he={__name:"UpdateApprovalTime",props:{overtime:Object,onSuccess:{type:Function,default:null}},setup(r){const c=r,g=B(),u=k(null),x=k(null),p=k(!1),_=k(c.overtime.approval_overtime_hours||c.overtime.request_overtime_hours||""),S=async()=>{if(!_.value)return alert("Please set approval time!");await g.updateApprovalTime(c.overtime.id,_.value),c.onSuccess&&await c.onSuccess(),t()},v=()=>{p.value=!0,d()},t=()=>{p.value=!1};function d(){Y(()=>{var l;(l=u.value)==null||l.focus()})}function y(l){var o,h;p.value&&(l.key==="ArrowLeft"?(o=x.value)==null||o.focus():l.key==="ArrowRight"&&((h=u.value)==null||h.focus()))}return Q(()=>{window.addEventListener("keydown",y)}),X(()=>{window.removeEventListener("keydown",y)}),(l,o)=>(a(),i(D,null,[e("i",{onClick:v,class:"fa fa-edit cursor-pointer text-sky-600"}),p.value?(a(),i("div",xe,[e("div",_e,[o[1]||(o[1]=e("h3",{class:"title-lg"},"Update Approval Time",-1)),o[2]||(o[2]=e("hr",{class:"my-2"},null,-1)),f(ce,{modelValue:_.value,"onUpdate:modelValue":o[0]||(o[0]=h=>_.value=h),"minute-interval":5,required:!0,"hour-min":1,"hour-max":16},null,8,["modelValue"]),o[3]||(o[3]=e("hr",{class:"my-2"},null,-1)),e("div",ve,[e("button",{type:"button",ref_key:"cancelBtnRef",ref:x,class:"btn-3 focus:ring-2 ring-offset-2",onClick:t}," Cancel ",512),e("button",{type:"button",ref_key:"confirmBtnRef",ref:u,class:"btn-2-green focus:ring-2 ring-offset-2",onClick:S}," Update Time ",512)])])])):b("",!0)],64))}},ke={class:"space-y-4"},we={class:"card-bg p-4 gap-1"},Se={class:"flex flex-wrap gap-x-8 gap-y-2"},Ae={key:0,class:"text-gray-700"},De={class:"ml-1"},Be={key:1,class:"text-gray-700"},Re={class:"ml-1"},Ce={key:2,class:"text-gray-700"},Oe={class:"ml-1"},$e={key:3,class:"text-gray-700"},Le={class:"ml-1"},je={key:4,class:"text-gray-700"},He={class:"ml-1"},Ne={class:"overflow-x-auto"},Me={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Te={class:"border border-gray-300 px-2 text-center"},Ue={class:"border border-gray-300 px-2 text-center"},qe={class:"border border-gray-300 px-2 text-center"},Pe={class:"border border-gray-300 px-2 text-center"},Ee={class:"border border-gray-300 px-2 text-center"},Ve={class:"border border-gray-300 px-2 text-center"},Fe={class:"border border-gray-300 px-2 text-center"},Ie={class:"border border-gray-300 px-2 text-center"},ze={class:"border border-gray-300 px-2 text-center"},Ge={class:"flex items-center justify-center gap-4"},Ke={class:"border border-gray-300 px-2 text-center"},We={class:"border border-gray-300 px-2 text-center"},Je={class:"border border-gray-300 px-2 text-center !py-0.5"},Qe={class:"flex items-center justify-center gap-x-4"},Xe={key:0,class:"border border-dashed px-4 rounded-xl"},Ye={key:0},Ze={key:0,class:"bg-gray-50"},et={class:"*:py-2 font-semibold"},tt={class:"border border-gray-300 px-2 text-center"},st={class:"border border-gray-300 px-2 text-center"},it={__name:"OvertimeDataList",props:{user:Object,onUpdate:{type:Function,default:null}},setup(r){ee(),te();const c=se(),g=B(),u=re(),x=r,p=async()=>{x.onUpdate?await x.onUpdate():await u.fetchCountNotifications()},_=J(()=>(g.overtimes||[]).reduce((t,d)=>t+(Number(d==null?void 0:d.request_overtime_hours)||0),0)),S=J(()=>(g.overtimes||[]).reduce((t,d)=>t+(Number(d==null?void 0:d.approval_overtime_hours)||0),0));return(v,t)=>{var y,l,o,h,R,C,O,$,L,j,H,N,M,T,U,q;const d=oe("RouterLink");return a(),i("div",ke,[e("div",we,[e("div",Se,[(y=r.user)!=null&&y.employee_id?(a(),i("p",Ae,[t[0]||(t[0]=e("span",{class:"text-gray-400"},"Employee ID:",-1)),e("strong",De,n(((l=r.user)==null?void 0:l.employee_id)||"N/A"),1)])):b("",!0),(o=r.user)!=null&&o.name?(a(),i("p",Be,[t[1]||(t[1]=e("span",{class:"text-gray-400"},"Name:",-1)),e("strong",Re,n((h=r.user)==null?void 0:h.name),1)])):b("",!0),(C=(R=r.user)==null?void 0:R.designation)!=null&&C.title?(a(),i("p",Ce,[t[2]||(t[2]=e("span",{class:"text-gray-400"},"Designation:",-1)),e("strong",Oe,n((($=(O=r.user)==null?void 0:O.designation)==null?void 0:$.title)||"N/A"),1)])):b("",!0),(j=(L=r.user)==null?void 0:L.department)!=null&&j.name?(a(),i("p",$e,[t[3]||(t[3]=e("span",{class:"text-gray-400"},"Department:",-1)),e("strong",Le,n(((N=(H=r.user)==null?void 0:H.department)==null?void 0:N.name)||"N/A"),1)])):b("",!0),(M=r.user)!=null&&M.phone?(a(),i("p",je,[t[4]||(t[4]=e("span",{class:"text-gray-400"},"Phone:",-1)),e("strong",He,n((T=r.user)==null?void 0:T.phone),1)])):b("",!0)])]),e("div",Ne,[e("table",Me,[t[11]||(t[11]=e("thead",null,[e("tr",{class:"bg-gray-200 *:py-1"},[e("th",{class:"border border-gray-300 px-2 text-center"},"#"),e("th",{class:"border border-gray-300 px-2 text-center"},"Applied Date"),e("th",{class:"border border-gray-300 px-2 text-center"},"Date"),e("th",{class:"border border-gray-300 px-2 text-center"},"Type"),e("th",{class:"border border-gray-300 px-2 text-center"},"Shift"),e("th",{class:"border border-gray-300 px-2 text-center"},"Check-In"),e("th",{class:"border border-gray-300 px-2 text-center"},"Check-Out"),e("th",{class:"border border-gray-300 px-2 text-center"},"Working (hour)"),e("th",{class:"border border-gray-300 px-2 text-center"},"Request (hour)"),e("th",{class:"border border-gray-300 px-2 text-center"},"Approved (hour)"),e("th",{class:"border border-gray-300 px-2 text-center"},"Details"),e("th",{class:"border border-gray-300 px-2 text-center"},"Status"),e("th",{class:"border border-gray-300 px-2 text-center"},"Action")])],-1)),e("tbody",null,[(a(!0),i(D,null,ne(m(g).overtimes,(s,Z)=>{var P,E,V,F,I,z,G,K,W;return a(),i("tr",{key:s==null?void 0:s.id,class:"border-b border-gray-200 hover:bg-blue-200 *:py-2"},[e("td",Te,n(Z+1),1),e("td",Ue,n(new Date(s.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})),1),e("td",qe,n(new Date(s.date).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})),1),e("td",Pe,n(s.duty_type),1),e("td",Ee,n(s.shift),1),e("td",Ve,n(s.check_in||"- : -"),1),e("td",Fe,n(s.check_out||"- : -"),1),e("td",Ie,[f(w,{workingHours:s.working_hours},null,8,["workingHours"])]),e("td",ze,[f(w,{workingHours:s.request_overtime_hours},null,8,["workingHours"])]),e("td",{class:ae(["border border-gray-300 px-2 text-center",{"bg-red-500/50":!s.approval_overtime_hours&&(s.recommend_by_user_id===((P=m(c).user)==null?void 0:P.id)||((V=(E=m(u).applicationApprovalPermissions)==null?void 0:E[s.id])==null?void 0:V.allow_recommend_by))}])},[e("div",Ge,[f(w,{workingHours:s.approval_overtime_hours},null,8,["workingHours"]),s.recommend_by_user_id===((F=m(c).user)==null?void 0:F.id)||(z=(I=m(u).applicationApprovalPermissions)==null?void 0:I[s.id])!=null&&z.allow_recommend_by?(a(),le(he,{key:0,overtime:s,onSuccess:p},null,8,["overtime"])):b("",!0)])],2),e("td",Ke,n(s.work_details||""),1),e("td",We,n(s.status||"Pending"),1),e("td",Je,[e("div",Qe,[(s.recommend_by_user_id===((G=m(c).user)==null?void 0:G.id)?(s.approval_overtime_hours??null)&&Object.values(((K=m(u).applicationApprovalPermissions)==null?void 0:K[s.id])||{}).some(A=>A):Object.values(((W=m(u).applicationApprovalPermissions)==null?void 0:W[s.id])||{}).some(A=>A))?(a(),i("div",Xe,[f(de,{class:"ml-auto",notificationType:"overtime_applications",applicationId:s.id,onSuccess:p,variant:1},null,8,["applicationId"])])):b("",!0),f(d,{to:{name:"MyOvertimeShow",params:{id:s.id}},class:"text-blue-800"},{default:ie(()=>t[5]||(t[5]=[e("i",{class:"far fa-eye text-lg"},null,-1)])),_:2,__:[5]},1032,["to"]),f(ge,{overtime:s,onSuccess:p},null,8,["overtime"])])])])}),128)),((U=m(g).overtimes)==null?void 0:U.length)===0?(a(),i("tr",Ye,t[6]||(t[6]=[e("td",{colspan:"100",class:"p-2 text-center text-red-500"},"No overtimes found",-1)]))):b("",!0)]),(q=m(g).overtimes)!=null&&q.length?(a(),i("tfoot",Ze,[e("tr",et,[t[7]||(t[7]=e("td",{class:"border border-gray-300 px-2 text-right",colspan:"7"},"Totals",-1)),e("td",tt,[f(w,{workingHours:_.value},null,8,["workingHours"])]),e("td",st,[f(w,{workingHours:S.value},null,8,["workingHours"])]),t[8]||(t[8]=e("td",{class:"border border-gray-300 px-2 text-center"},"—",-1)),t[9]||(t[9]=e("td",{class:"border border-gray-300 px-2 text-center"},"—",-1)),t[10]||(t[10]=e("td",{class:"border border-gray-300 px-2 text-center"},"—",-1))])])):b("",!0)])])])}}};export{it as _};
