import{u as z,b as G,d as J,r as K,q as Q,e as X,A as R,n as Y,c as _,o as l,a as t,f as y,t as r,h as Z,v as tt,j as a,k as n,F as et,x as st,y as v,g as p,p as rt,i as c}from"./index-Nb0dutxh.js";import{L as at}from"./LoaderView-CJgm30I9.js";import{u as nt}from"./attendance-BM2PhGks.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ot={class:"px-4 space-y-4"},lt={class:"md:flex items-center justify-between gap-2"},it={class:"title-lg md:title-lg flex-wrap text-center"},dt={class:"flex gap-4"},ut={class:"grid md:grid-cols-2 gap-4 text-sm"},_t={class:"card-bg p-4 gap-1"},pt={class:"grid md:grid-cols-2"},mt={class:"card-bg p-4 gap-1"},yt={class:"grid md:grid-cols-2"},ct={key:1,class:"space-y-4"},vt={class:"overflow-x-auto card-bg"},ht={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},bt={class:"text-center text-xs"},xt={class:"border px-1 py-0.5"},ft={class:"border px-1 py-0.5"},kt=["title"],wt=["title"],At=["title"],St={key:0},Dt={class:"border px-1 py-0.5"},Lt={class:"border px-1 py-0.5"},Ct={class:"border px-1 py-0.5"},Tt={key:0},Mt={class:"border px-1 py-0.5"},gt={key:0},Ut={__name:"MyAttendance",setup(qt){const h=z(),x=G(),d=J(),i=nt(),u=K(x.query.date||i.selectedMonth),$=Q(()=>{if(!u.value)return"";const[o,s]=u.value.split("-");return new Date(o,s-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),b=async()=>{var o;(o=d.user)!=null&&o.id&&u.value&&await i.getMonthlyAttendanceByShift(d.user.id,u.value)};X(async()=>{d.isAuthenticated?(await d.fetchUser(),b()):h.push("/login")}),R(u,async o=>{i.selectedMonth=o,await b()}),R(u,o=>{h.replace({query:{...x.query,date:o}})});const F=()=>h.go(-1),I=o=>{if(o)return o.split(" ").map(s=>s[0]).join("").toUpperCase()};return(o,s)=>{var f,k,w,A,S,D,L,C,T,M,g,q,B,E,P,N,U,V,j,W,H,O;const m=Y("router-link");return l(),_("div",ot,[t("div",lt,[t("button",{class:"btn-3",onClick:F},s[1]||(s[1]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),t("h1",it," Attendance of "+r($.value),1),t("div",dt,[t("div",null,[Z(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),onChange:b,class:"input-1"},null,544),[[tt,u.value]])])])]),t("div",ut,[t("div",_t,[s[8]||(s[8]=t("h2",{class:"title-md"},"User Info",-1)),s[9]||(s[9]=t("hr",null,null,-1)),t("div",pt,[t("p",null,[s[2]||(s[2]=t("strong",null,"Name:",-1)),a(" "+r((f=n(d).user)==null?void 0:f.name),1)]),t("p",null,[s[3]||(s[3]=t("strong",null,"Designation:",-1)),a(" "+r((w=(k=n(d).user)==null?void 0:k.designation)==null?void 0:w.title),1)]),t("p",null,[s[4]||(s[4]=t("strong",null,"Department:",-1)),a(" "+r((S=(A=n(d).user)==null?void 0:A.department)==null?void 0:S.name),1)]),t("p",null,[s[5]||(s[5]=t("strong",null,"Company:",-1)),a(" "+r((L=(D=n(d).user)==null?void 0:D.company)==null?void 0:L.name),1)]),t("p",null,[s[6]||(s[6]=t("strong",null,"Phone:",-1)),a(" "+r((C=n(d).user)==null?void 0:C.phone),1)]),t("p",null,[s[7]||(s[7]=t("strong",null,"Email:",-1)),a(" "+r((T=n(d).user)==null?void 0:T.email),1)])])]),t("div",mt,[s[16]||(s[16]=t("h2",{class:"title-md"},"Attendance Summary",-1)),s[17]||(s[17]=t("hr",null,null,-1)),t("div",yt,[t("p",null,[s[10]||(s[10]=t("strong",null,"Total Working Days:",-1)),a(" "+r(((g=(M=n(i))==null?void 0:M.summary)==null?void 0:g.total_working_days)||0),1)]),t("p",null,[s[11]||(s[11]=t("strong",null,"Present Days:",-1)),a(" "+r(((B=(q=n(i))==null?void 0:q.summary)==null?void 0:B.total_present_days)||0),1)]),t("p",null,[s[12]||(s[12]=t("strong",null,"Absent Days:",-1)),a(" "+r(((P=(E=n(i))==null?void 0:E.summary)==null?void 0:P.total_absent_days)||0),1)]),t("p",null,[s[13]||(s[13]=t("strong",null,"Late Days:",-1)),a(" "+r(((U=(N=n(i))==null?void 0:N.summary)==null?void 0:U.actual_late_day)||0),1)]),t("p",null,[s[14]||(s[14]=t("strong",null,"Total Working Hours:",-1)),a(" "+r((j=(V=n(i))==null?void 0:V.summary)==null?void 0:j.total_working_hours),1)]),t("p",null,[s[15]||(s[15]=t("strong",null,"Total Overtime Hours:",-1)),a(" "+r((H=(W=n(i))==null?void 0:W.summary)==null?void 0:H.total_overtime_hours),1)])])])]),n(i).isLoading?(l(),y(at,{key:0})):(l(),_("div",ct,[t("div",vt,[t("table",ht,[s[21]||(s[21]=t("thead",null,[t("tr",{class:"bg-gray-200 text-xs"},[t("th",{class:"border p-1"},"Date"),t("th",{class:"border p-1"},"Day"),t("th",{class:"border p-1"},"Shift"),t("th",{class:"border p-1"},"Entry Time"),t("th",{class:"border p-1"},"Exit Time"),t("th",{class:"border p-1"},"Working Hours"),t("th",{class:"border p-1"},"OT Hours"),t("th",{class:"border p-1"},"Late Entry"),t("th",{class:"border p-1"},"Early Leave"),t("th",{class:"border p-1"},"Status")])],-1)),t("tbody",bt,[(l(!0),_(et,null,st((O=n(i))==null?void 0:O.monthlyLogs,e=>(l(),_("tr",{key:e==null?void 0:e.date,class:"hover:border-b-2 hover:border-gray-200 hover:bg-blue-200"},[t("td",xt,r(e.date),1),t("td",ft,r(e.weekday),1),t("td",{class:"border px-1 py-0.5",title:`${e.shift_start_time} to ${e.shift_end_time}`},r(e.shift_name),9,kt),t("td",{class:"border px-1 py-0.5",title:`Device: ${e.entry_device}`},[t("span",{class:v({"text-yellow-600":e.is_overtime_applicable})},r(e.is_overtime_applicable&&e.entry_time?I(e.status):"")+" "+r(e.entry_time),3)],8,wt),t("td",{class:"border px-1 py-0.5",title:`Device: ${e.exit_device}`},[a(r(e.exit_time)+" ",1),!e.exit_time&&new Date(e.date)<new Date&&e.status==="Present"?(l(),_("div",St,[rt(m,{to:{name:"ManualAttendanceAdd",query:{type:"Forget Punch",date:new Date(e.date+" UTC").toISOString().split("T")[0],entry_time:e.entry_time,exit_time:e.exit_time}},class:"btn-link text-red-600"},{default:c(()=>s[18]||(s[18]=[a(" (Check Out Apply) ")])),_:2,__:[18]},1032,["to"])])):p("",!0)],8,At),t("td",Dt,r(e.working_hours),1),t("td",Lt,r(e.overtime_hours),1),t("td",Ct,[e.late_duration&&e.status!=="Weekend"?(l(),_("div",Tt,[a(r(e.late_duration)+" ",1),e.first_short_leave?(l(),y(m,{key:0,to:{name:"ShortLeaveShow",params:{id:e.first_short_leave_id}},class:v({"text-green-500":e.first_short_leave==="Approved","text-yellow-500":e.first_short_leave==="Pending","text-red-500":e.first_short_leave==="Rejected"})},{default:c(()=>[a(" ("+r(e.first_short_leave)+") ",1)]),_:2},1032,["to","class"])):p("",!0),e.late_duration&&!e.first_short_leave?(l(),y(m,{key:1,to:{name:"ShortLeaveAdd",query:{type:"Delay",start_time:e.shift_start_time,end_time:e.entry_time}},class:"btn-link text-red-600"},{default:c(()=>s[19]||(s[19]=[a(" (Apply) ")])),_:2,__:[19]},1032,["to"])):p("",!0)])):p("",!0)]),t("td",Mt,[e.early_leave_duration&&e.status!=="Weekend"?(l(),_("div",gt,[a(r(e.early_leave_duration)+" ",1),e.last_short_leave?(l(),y(m,{key:0,to:{name:"ShortLeaveShow",params:{id:e.last_short_leave_id}},class:v(["px-1",{"text-green-500":e.last_short_leave==="Approved","text-yellow-500":e.last_short_leave==="Pending","text-red-500":e.last_short_leave==="Rejected"}])},{default:c(()=>[a(" ("+r(e.last_short_leave)+") ",1)]),_:2},1032,["to","class"])):p("",!0),e.early_leave_duration&&!e.last_short_leave?(l(),y(m,{key:1,to:{name:"ShortLeaveAdd",query:{type:"Early",start_time:e.exit_time,end_time:e.shift_end_time}},class:"btn-link text-red-600"},{default:c(()=>s[20]||(s[20]=[a(" (Apply) ")])),_:2,__:[20]},1032,["to"])):p("",!0)])):p("",!0)]),t("td",{class:v(["border px-1 py-0.5 font-semibold",{"text-red-600":e.status==="Absent","text-green-600":e.status==="Present","text-yellow-600":e.is_overtime_applicable}])},r(e.status),3)]))),128))])])])]))])}}};export{Ut as default};
