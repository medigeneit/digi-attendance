import{u as lt,r as Qe,x as Xe,b as at,c as a,a as t,k as o,j as nt,t as n,e as r,p as ot,h as b,l as rt,d as ut,v as dt,F as it,f as pt,o as l,g as ct}from"./index-LiJ-LRhu.js";import{L as vt}from"./LoaderView-CAwSZ7ko.js";import{_ as _t}from"./ShareComponent-D6SM7ogw.js";import{u as mt}from"./manual-attendance-7Tn19NSK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const yt={class:"my-container max-w-3xl space-y-6"},bt={key:1,class:"card-bg p-4 md:p-8"},gt={class:"grid md:grid-cols-2"},ft={key:0},kt={key:1},xt={class:"pt-10"},At={class:"font-medium"},ht={class:"text-sm"},wt={class:"title-md"},jt={key:0},Ct={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Mt={class:"pt-10"},Rt={key:0},Bt={key:1},Nt={key:2,class:"print:hidden"},St={class:"text-xs text-blue-600"},Dt={class:"flex gap-4"},$t={class:"font-bold"},Ft={key:0,class:"text-green-600"},Vt={key:1,class:"pl-2 text-yellow-700"},It={class:"pt-10"},Lt={key:0},Tt={key:1},qt={key:2,class:"print:hidden"},Wt={class:"text-xs text-blue-600"},Et={class:"flex gap-4"},Pt={class:"font-bold"},zt={key:0,class:"text-green-600"},Gt={key:1,class:"pl-2 text-yellow-700"},Ot={class:"flex flex-col pt-10"},Ut={key:0},Ht={key:1},Jt={key:2,class:"print:hidden"},Kt={class:"text-xs text-blue-600"},Qt={class:"flex gap-4"},Xt={class:"font-bold"},Yt={key:0,class:"text-green-600"},Zt={key:1,class:"pl-2 text-yellow-700"},es={key:0,class:"modal-bg"},ts={class:"modal-card"},ss={class:"flex justify-end gap-2 mt-4"},ds={__name:"ManualAttendanceShow",setup(ls){const Ye=ct(),p=pt(),d=mt(),_=lt(),c=Qe(!1),v=Qe(""),Ze=Xe(()=>d.loading),s=Xe(()=>d.manualAttendance);at(async()=>{const{id:u}=p.params;try{await d.fetchManualAttendanceById(u)}catch(e){console.error("Failed to fetch manual attendance details:",e)}});const et=async()=>{try{await d.rejectManualAttendance(p.params.id,v.value),alert("Manual attendance rejected successfully!"),c.value=!1,v.value="",await d.fetchManualAttendanceById(p.params.id)}catch(u){console.error("Failed to reject manual attendance:",u),alert("Failed to reject manual attendance.")}},m=()=>{c.value=!0},y=async u=>{try{const{id:e}=p.params;u==="inCharge"&&await d.inChargeAccept(e),u==="recommend"&&await d.recommendByAccept(e),u==="approve"&&await d.approvedByAccept(e),alert(`${u} accepted successfully!`),await d.fetchManualAttendanceById(e)}catch(e){console.error(`Failed to accept ${u}:`,e),alert(`Failed to accept ${u}.`)}},tt=()=>Ye.go(-1);function st(){window.print()}return(u,e)=>{var g,f,k,x,A,h,w,j,C,M,R,B,N,S,D,$,F,V,I,L,T,q,W,E,P,z,G,O,U,H,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ue,de,ie,pe,ce,ve,_e,me,ye,be,ge,fe,ke,xe,Ae,he,we,je,Ce,Me,Re,Be,Ne,Se,De,$e,Fe,Ve,Ie,Le,Te,qe,We,Ee,Pe,ze,Ge,Oe,Ue,He,Je,Ke;return l(),a(it,null,[t("div",yt,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:tt},e[5]||(e[5]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[7]||(e[7]=t("h1",{class:"title-lg text-center"},"Manual Attendance Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:st},e[6]||(e[6]=[t("i",{class:"far fa-print"},null,-1),o(" Print ")]))])]),Ze.value?(l(),nt(vt,{key:0})):(l(),a("div",bt,[e[33]||(e[33]=t("h2",{class:"title-md"},"Manual Attendance Request",-1)),t("div",null,[t("div",gt,[t("div",null,[e[8]||(e[8]=t("b",null,"Date:",-1)),o(" "+n(new Date((g=s.value)==null?void 0:g.check_in).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})),1)]),(f=s.value)!=null&&f.check_in?(l(),a("div",ft,[e[9]||(e[9]=t("b",null,"Check-In:",-1)),o(" "+n((k=s.value)!=null&&k.check_in?new Date(s.value.check_in).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"),1)])):r("",!0),(x=s.value)!=null&&x.check_out?(l(),a("div",kt,[e[10]||(e[10]=t("b",null,"Check-Out:",-1)),o(" "+n((A=s.value)!=null&&A.check_out?new Date(s.value.check_out).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"),1)])):r("",!0),t("div",null,[e[11]||(e[11]=t("b",null,"Type:",-1)),o(" "+n((h=s.value)==null?void 0:h.type),1)]),t("div",null,[e[12]||(e[12]=t("b",null,"Reason:",-1)),o(" "+n(((w=s.value)==null?void 0:w.description)||"N/A"),1)])]),t("div",xt,[t("div",null,[e[13]||(e[13]=t("hr",{class:"w-44 border-black"},null,-1)),e[14]||(e[14]=t("div",null,[t("b",null,"Applicant")],-1)),t("p",At,n((j=s.value)==null?void 0:j.user.name),1),t("div",ht,[t("p",null,n((R=(M=(C=s.value)==null?void 0:C.user)==null?void 0:M.department)==null?void 0:R.name),1),t("p",null,n((S=(N=(B=s.value)==null?void 0:B.user)==null?void 0:N.designation)==null?void 0:S.title),1)])])])]),e[34]||(e[34]=t("hr",null,null,-1)),t("div",null,[t("h3",wt,[e[15]||(e[15]=o(" Approvals ")),t("span",{class:ot({"text-yellow-500":((D=s.value)==null?void 0:D.status)==="Pending","text-green-500":(($=s.value)==null?void 0:$.status)==="Approved","text-red-500":((F=s.value)==null?void 0:F.status)==="Rejected"})}," ("+n(((V=s.value)==null?void 0:V.status)||"N/A")+") ",3)]),((I=s.value)==null?void 0:I.status)==="Rejected"?(l(),a("div",jt,[t("div",null,[e[16]||(e[16]=t("b",null,"Rejected By:",-1)),o(" "+n(((T=(L=s.value)==null?void 0:L.rejected_by_user)==null?void 0:T.name)||"N/A"),1)]),t("div",null,[e[17]||(e[17]=t("b",null,"Rejection Reason:",-1)),o(" "+n(((q=s.value)==null?void 0:q.rejection_reason)||"N/A"),1)])])):r("",!0)]),t("div",Ct,[t("div",Mt,[(W=s.value)!=null&&W.in_charge_user?(l(),a("p",Rt,n(((P=(E=s.value)==null?void 0:E.in_charge_user)==null?void 0:P.name)||""),1)):(l(),a("p",Bt,n(((U=(O=(G=(z=s.value)==null?void 0:z.user)==null?void 0:G.other_approval)==null?void 0:O.in_charge_user)==null?void 0:U.name)||"N/A"),1)),((H=s.value)==null?void 0:H.status)!=="Rejected"&&((J=s.value)==null?void 0:J.status)!=="Approved"&&!((K=s.value)!=null&&K.in_charge_user_id)&&((Y=(X=(Q=s.value)==null?void 0:Q.user)==null?void 0:X.other_approval)==null?void 0:Y.in_charge_user_id)===((ee=(Z=b(_))==null?void 0:Z.user)==null?void 0:ee.id)?(l(),a("div",Nt,[t("p",St,[o(n((se=(te=s.value)==null?void 0:te.user)==null?void 0:se.name)+' has submitted an "attendance request". ',1),e[18]||(e[18]=t("br",null,null,-1)),e[19]||(e[19]=o(" Will you forward it? "))]),t("div",Dt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[0]||(e[0]=i=>y("inCharge"))}," ✔ "),t("button",{class:"",onClick:m},"❌")])])):r("",!0),e[22]||(e[22]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",$t,[e[21]||(e[21]=o(" In-Charge ")),(le=s.value)!=null&&le.in_charge_user_id?(l(),a("span",Ft,"(✔)")):r("",!0),(oe=(ne=(ae=s.value)==null?void 0:ae.user)==null?void 0:ne.other_approval)!=null&&oe.in_charge_user&&!((re=s.value)!=null&&re.in_charge_user_id)?(l(),a("span",Vt,e[20]||(e[20]=[t("i",{class:"fad fa-spinner"},null,-1)]))):r("",!0)])]),t("div",It,[(ue=s.value)!=null&&ue.recommend_by_user?(l(),a("p",Lt,n(((ie=(de=s.value)==null?void 0:de.recommend_by_user)==null?void 0:ie.name)||""),1)):(l(),a("p",Tt,n(((_e=(ve=(ce=(pe=s.value)==null?void 0:pe.user)==null?void 0:ce.other_approval)==null?void 0:ve.recommend_by_user)==null?void 0:_e.name)||"N/A"),1)),((me=s.value)==null?void 0:me.status)!=="Rejected"&&((ye=s.value)==null?void 0:ye.status)!=="Approved"&&!((be=s.value)!=null&&be.recommend_by_user_id)&&((ke=(fe=(ge=s.value)==null?void 0:ge.user)==null?void 0:fe.other_approval)==null?void 0:ke.recommend_by_user_id)===((xe=b(_).user)==null?void 0:xe.id)?(l(),a("div",qt,[t("p",Wt,[o(n((he=(Ae=s.value)==null?void 0:Ae.user)==null?void 0:he.name)+' has submitted an "attendance request".',1),e[23]||(e[23]=t("br",null,null,-1)),e[24]||(e[24]=o(" Will you recommend it? "))]),t("div",Et,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=i=>y("recommend"))}," ✔ "),t("button",{class:"",onClick:m},"❌")])])):r("",!0),e[27]||(e[27]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Pt,[e[26]||(e[26]=o(" Recommend By ")),(we=s.value)!=null&&we.recommend_by_user_id?(l(),a("span",zt,"(✔)")):r("",!0),(Me=(Ce=(je=s.value)==null?void 0:je.user)==null?void 0:Ce.other_approval)!=null&&Me.recommend_by_user&&!((Re=s.value)!=null&&Re.recommend_by_user_id)?(l(),a("span",Gt,e[25]||(e[25]=[t("i",{class:"fad fa-spinner"},null,-1)]))):r("",!0)])])]),t("div",Ot,[(Be=s.value)!=null&&Be.approved_by_user?(l(),a("p",Ut,n(((Se=(Ne=s.value)==null?void 0:Ne.approved_by_user)==null?void 0:Se.name)||""),1)):(l(),a("p",Ht,n(((Ve=(Fe=($e=(De=s.value)==null?void 0:De.user)==null?void 0:$e.other_approval)==null?void 0:Fe.approved_by_user)==null?void 0:Ve.name)||"N/A"),1)),((Ie=s.value)==null?void 0:Ie.status)!=="Rejected"&&((Le=s.value)==null?void 0:Le.status)!=="Approved"&&!((Te=s.value)!=null&&Te.approved_by_user_id)&&((Ee=(We=(qe=s.value)==null?void 0:qe.user)==null?void 0:We.other_approval)==null?void 0:Ee.approved_by_user_id)===((Pe=b(_).user)==null?void 0:Pe.id)?(l(),a("div",Jt,[t("p",Kt,[o(n((Ge=(ze=s.value)==null?void 0:ze.user)==null?void 0:Ge.name)+' has submitted an "attendance request".',1),e[28]||(e[28]=t("br",null,null,-1)),e[29]||(e[29]=o(" Will you accept it? "))]),t("div",Qt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=i=>y("approve"))}," ✔ "),t("button",{class:"",onClick:m},"❌")])])):r("",!0),e[32]||(e[32]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Xt,[e[31]||(e[31]=o(" Approved By ")),(Oe=s.value)!=null&&Oe.approved_by_user_id?(l(),a("span",Yt,"(✔)")):r("",!0),(Je=(He=(Ue=s.value)==null?void 0:Ue.user)==null?void 0:He.other_approval)!=null&&Je.approved_by_user&&!((Ke=s.value)!=null&&Ke.approved_by_user_id)?(l(),a("span",Zt,e[30]||(e[30]=[t("i",{class:"fad fa-spinner"},null,-1)]))):r("",!0)])])])),rt(_t)]),c.value?(l(),a("div",es,[t("div",ts,[e[35]||(e[35]=t("h3",{class:"title-lg"},"Reject Manual Attendance",-1)),ut(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=i=>v.value=i),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[dt,v.value]]),t("div",ss,[t("button",{class:"btn-3",onClick:e[4]||(e[4]=i=>c.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:et},"Confirm")])])])):r("",!0)],64)}}};export{ds as default};
