import{u as F,f as H,D as W,r as p,h as I,q as C,p as j,c as y,o as d,a as e,i as x,t as n,m,d as M,k as q,H as g,n as O,v as z,F as Q,e as G,s as v,b as J,j as A,l as E}from"./index-BlJfJgs9.js";import{L as K}from"./LoaderView-CjwtcO93.js";import{_ as X}from"./EmployeeFilter-C61Q-xD9.js";import{u as Y}from"./attendance-D7ndrhkH.js";import{u as Z}from"./company-_LaaiMgc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./department-uzL_MuVW.js";import"./EmployeeDropdownInput-DJVpNquv.js";import"./SelectDropdown-C3FPlUvF.js";import"./UserChip-DSABSRHn.js";const ee={class:"px-4 space-y-4"},te={class:"flex items-center justify-between gap-2"},ae={class:"title-md md:title-lg flex-wrap text-center"},se={class:"flex flex-wrap gap-4"},ne={class:"flex gap-4"},oe={key:1,class:"space-y-4"},ie={class:"overflow-x-auto card-bg"},de={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},re={class:"text-center text-xs"},le={class:"border px-1 py-0.5"},pe={class:"border px-1 py-0.5"},ue={class:"border px-1 py-0.5"},ce={class:"border px-1 py-0.5"},_e={class:"border px-1 py-0.5"},ye=["title"],me=["title"],ve=["title"],be={class:"border px-1 py-0.5"},fe={class:"border px-1 py-0.5"},xe={class:"border px-1 py-0.5"},he={class:"border px-1 py-0.5"},Te={__name:"TodayAttendanceReport",setup(ke){const h=F(),i=H(),L=Z(),u=Y(),{dailyLogs:V}=W(u),P=p(i.query.company_id||""),T=p(i.query.department_id||""),b=p(i.query.employee_id||""),l=p(i.query.date||u.selectedDate||""),r=p(i.query.status||""),B=p(i.query.line_type||"all"),s=p({company_id:P.value,department_id:T.value,line_type:B.value,employee_id:b.value}),k=async()=>{const{company_id:o,department_id:a,employee_id:c,line_type:_}=s.value;(o||r.value)&&await u.getTodayAttendanceReport({companyId:s.value.company_id,departmentId:a,employee_id:c,line_type:_,month:l.value,status:r.value})},f=()=>{const o={company_id:s.value.company_id,department_id:s.value.department_id,line_type:s.value.line_type,employee_id:s.value.employee_id,date:l.value,status:r.value};Object.entries(o).some(([c,_])=>i.query[c]!==String(_))&&h.replace({query:o})},N=()=>{var o;return u.attendanceDownloadExcel(s.value.company_id,(o=b.value)==null?void 0:o.id,s.value.line_type,l.value,r.value)},R=()=>{var o;return u.attendanceDownloadPdf(s.value.company_id,(o=b.value)==null?void 0:o.id,s.value.line_type,l.value,r.value)},U=()=>h.go(-1);return I(async()=>{await L.fetchCompanies(),await k()}),C(l,o=>{f()}),C(r,()=>{f()}),(o,a)=>{var _,w,D,S;const c=j("router-link");return d(),y("div",ee,[e("div",te,[e("button",{class:"btn-3",onClick:U},a[6]||(a[6]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),e("h1",ae," Daily "+n(((w=(_=m(i))==null?void 0:_.query)==null?void 0:w.status)==="all"?"Attendance":(S=(D=m(i))==null?void 0:D.query)==null?void 0:S.status)+" Report ",1),e("div",{class:"flex gap-4"},[e("button",{type:"button",onClick:N,class:"btn-1"},a[7]||(a[7]=[e("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)])),e("button",{type:"button",onClick:R,class:"btn-1"},a[8]||(a[8]=[e("i",{class:"fal fa-file-pdf text-2xl text-red-500"},null,-1)]))])]),e("div",se,[M(X,{company_id:s.value.company_id,"onUpdate:company_id":a[0]||(a[0]=t=>s.value.company_id=t),department_id:s.value.department_id,"onUpdate:department_id":a[1]||(a[1]=t=>s.value.department_id=t),employee_id:s.value.employee_id,"onUpdate:employee_id":a[2]||(a[2]=t=>s.value.employee_id=t),line_type:s.value.line_type,"onUpdate:line_type":a[3]||(a[3]=t=>s.value.line_type=t),"with-type":!0,"initial-value":o.$route.query,onFilterChange:f},null,8,["company_id","department_id","employee_id","line_type","initial-value"]),e("div",ne,[e("div",null,[q(e("select",{id:"userSelect","onUpdate:modelValue":a[4]||(a[4]=t=>r.value=t),class:"input-1"},a[9]||(a[9]=[O('<option value="all">All Status</option><option value="Present">Present</option><option value="Absent">Absent</option><option value="Weekend">Weekend</option><option value="Holiday">Holiday</option><option value="Leave">Leave</option>',6)]),512),[[g,r.value]])]),e("div",null,[q(e("input",{type:"date","onUpdate:modelValue":a[5]||(a[5]=t=>l.value=t),class:"input-1"},null,512),[[z,l.value]])]),e("button",{type:"button",onClick:k,class:"btn-2"},"Search")])]),m(u).isLoading?(d(),x(K,{key:0})):(d(),y("div",oe,[e("div",ie,[e("table",de,[a[12]||(a[12]=e("thead",null,[e("tr",{class:"bg-gray-200 text-xs"},[e("th",{class:"border p-1"},"#"),e("th",{class:"border p-1"},"Emp/Worker Name"),e("th",{class:"border p-1"},"Department"),e("th",{class:"border p-1"},"Date"),e("th",{class:"border p-1"},"Day"),e("th",{class:"border p-1"},"Shift"),e("th",{class:"border p-1"},"Entry Time"),e("th",{class:"border p-1"},"Exit Time"),e("th",{class:"border p-1"},"Working Hours"),e("th",{class:"border p-1"},"Late Entry"),e("th",{class:"border p-1"},"Early Leave"),e("th",{class:"border p-1"},"Status")])],-1)),e("tbody",re,[(d(!0),y(Q,null,G(m(V),(t,$)=>(d(),y("tr",{key:t==null?void 0:t.date,class:"border-b hover:bg-blue-100"},[e("td",le,n($+=1),1),e("td",pe,n(t.user_name),1),e("td",ue,n(t.department),1),e("td",ce,n(t.date),1),e("td",_e,n(t.weekday),1),e("td",{class:"border px-1 py-0.5",title:`${t.shift_start_time} to ${t.shift_end_time}`},n(t.shift_name),9,ye),e("td",{class:v(["border px-1 py-0.5",{"bg-red-200":t.late_duration}]),title:`Device: ${t.entry_device}`},n(t.entry_time),11,me),e("td",{class:v(["border px-1 py-0.5",{"bg-red-200":t.early_leave_duration}]),title:`Device: ${t.exit_device}`},n(t.exit_time),11,ve),e("td",be,n(t.working_hours),1),e("td",fe,n(t.late_duration),1),e("td",xe,n(t.early_leave_duration),1),e("td",he,[t.absent_reason?(d(),y("span",{key:0,class:v(["font-medium",{"text-green-600":t.absent_reason.includes("Approved"),"text-orange-500":t.absent_reason.includes("Pending"),"text-gray-600":!t.absent_reason.includes("Approved")&&!t.absent_reason.includes("Pending")}])},[J(n(t.absent_reason)+" ",1),t.application_id?(d(),x(c,{key:0,to:{name:"LeaveApplicationShow",params:{id:t.application_id}}},{default:E(()=>a[10]||(a[10]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[10]},1032,["to"])):A("",!0),t.exchange_application_id?(d(),x(c,{key:1,to:{name:"ExchangeOffdayShow",params:{id:t.exchange_application_id}}},{default:E(()=>a[11]||(a[11]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[11]},1032,["to"])):A("",!0)],2)):(d(),y("span",{key:1,class:v(["font-medium",{"text-red-600":t.status==="Absent","text-blue-600":t.status==="Holiday","text-green-600":t.status==="Present","text-gray-600":t.status==="Weekend"||t.status==="Leave"}])},n(t.status),3))])]))),128))])])])]))])}}};export{Te as default};
