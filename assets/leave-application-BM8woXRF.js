import{J as Y,r as v,K as u,a1 as M}from"./index-lbbj0ndd.js";const U=Y("leaveApplication",()=>{const s=v([]),d=v(null),c=v(!1),r=v(null),h=v(new Date().toISOString().substring(0,7)),w=v(new Date().getFullYear()),p=v(null),m=v("");async function f(a={}){var n,l;c.value=!0,r.value=null;try{const t=await u.get("/leave-applications",{params:a});t.data?s.value=t.data:s.value=[]}catch(t){r.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch leave applications"}finally{c.value=!1}}async function g(a={}){var n,l,t,e;c.value=!0,r.value=null;try{const i=await u.get("/yearly-user-leave-applications",{params:a});i.data?(s.value=(n=i==null?void 0:i.data)==null?void 0:n.leave_applications,p.value=(l=i==null?void 0:i.data)==null?void 0:l.user):(s.value=[],p.value=[])}catch(i){r.value=((e=(t=i.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to fetch leave applications"}finally{c.value=!1}}async function y(a={}){var n,l;c.value=!0,r.value=null;try{const t=await u.get("/my-leave-applications",{params:a});s.value=t.data.data}catch(t){r.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch leave applications"}finally{c.value=!1}}async function x(a){var n,l,t,e;c.value=!0,r.value=null;try{const i=await u.post("/leave-applications/store",a);return s.value.push((n=i==null?void 0:i.data)==null?void 0:n.data),(l=i==null?void 0:i.data)==null?void 0:l.data}catch(i){throw r.value=((e=(t=i.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to store leave application",new Error(r.value)}finally{c.value=!1}}async function A(a){var n,l;c.value=!0,r.value=null;try{await u.delete(`/my-leave-application/destroy/${a}`),await f()}catch(t){throw r.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to store leave application",new Error(r.value)}finally{c.value=!1}}const F=async a=>{var n,l;try{return c.value=!0,(await u.post("cental-attachment-upload",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){r.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Something went wrong"}finally{c.value=!1}};async function I(a,n){var l,t;c.value=!0,r.value=null;try{const e=await u.post(`/leave-applications/${a}/update`,n),i=s.value.findIndex(o=>o.id===a);return i!==-1&&(s.value[i]=e.data.data),e.data.data}catch(e){throw r.value=((t=(l=e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to update leave application",new Error(r.value)}finally{c.value=!1}}const $=async(a,n)=>{var l,t;c.value=!0,r.value=null;try{const e=await u.put(`/leave-attachment/${a}`,n),i=s.value.findIndex(o=>o.id===a);return i!==-1&&(s.value[i]=e.data.data),e.data.data}catch(e){throw r.value=((t=(l=e.response)==null?void 0:l.data)==null?void 0:t.message)||`Failed to update application leave (ID: ${a})`,console.error(`Error updating application leave with id ${a}:`,e),new Error(r.value)}finally{c.value=!1}};async function E(a){var n,l;c.value=!0,r.value=null;try{const t=await u.get(`/leave-applications/${a}`);d.value=t==null?void 0:t.data,await M().fetchApprovalPermissions("leave_applications",d.value.id)}catch(t){r.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to fetch leave application"}finally{c.value=!1}}async function L(a){var n,l;c.value=!0,r.value=null;try{const t=await u.post(`/leave-applications/${a.id}/handover-accept`,a),e=s.value.findIndex(i=>i.id===(a==null?void 0:a.id));return e!==-1&&(s.value[e]=t.data.data),t.data.data}catch(t){throw r.value=((l=(n=t.response)==null?void 0:n.data)==null?void 0:l.message)||"Failed to accept handover",new Error(r.value)}finally{c.value=!1}}async function S(a){var n,l,t;c.value=!0,r.value=null;try{const e=await u.post(`/leave-applications/${a.id}/incharge-accept`,a),i=s.value.findIndex(o=>o.id===(a==null?void 0:a.id));return i!==-1&&(s.value[i]=e.data.data),(n=e==null?void 0:e.data)==null?void 0:n.data}catch(e){throw r.value=((t=(l=e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept in-charge approval",new Error(r.value)}finally{c.value=!1}}async function b(a){var n,l,t;c.value=!0,r.value=null;try{const e=await u.post(`/leave-applications/${a.id}/coordinator-accept`,a),i=s.value.findIndex(o=>o.id===(a==null?void 0:a.id));return i!==-1&&(s.value[i]=e.data.data),(n=e==null?void 0:e.data)==null?void 0:n.data}catch(e){throw r.value=((t=(l=e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept coordinator approval",new Error(r.value)}finally{c.value=!1}}async function C(a){var n,l,t;c.value=!0,r.value=null;try{const e=await u.post(`/leave-applications/${a.id}/operational-admin-accept`,a),i=s.value.findIndex(o=>o.id===(a==null?void 0:a.id));return i!==-1&&(s.value[i]=e.data.data),(n=e==null?void 0:e.data)==null?void 0:n.data}catch(e){throw r.value=((t=(l=e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept operational admin approval",new Error(r.value)}finally{c.value=!1}}async function j(a){var n,l,t;c.value=!0,r.value=null;try{const e=await u.post(`/leave-applications/${a.id}/recommend-by-accept`,a),i=s.value.findIndex(o=>o.id===(a==null?void 0:a.id));return i!==-1&&(s.value[i]=e.data.data),(n=e==null?void 0:e.data)==null?void 0:n.data}catch(e){throw r.value=((t=(l=e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept recommend by approval",new Error(r.value)}finally{c.value=!1}}async function B(a){var n,l,t;c.value=!0,r.value=null;try{const e=await u.post(`/leave-applications/${a==null?void 0:a.id}/approved-by-accept`,a),i=s.value.findIndex(o=>o.id===(a==null?void 0:a.id));return i!==-1&&(s.value[i]=e.data.data),(n=e==null?void 0:e.data)==null?void 0:n.data}catch(e){throw r.value=((t=(l=e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to accept approval by admin",new Error(r.value)}finally{c.value=!1}}async function D(a,n){var l,t;c.value=!0,r.value=null;try{const e=await u.post(`/leave-applications/${a}/reject`,n),i=s.value.findIndex(o=>o.id===a);return i!==-1&&(s.value[i]=e.data.data),e.data.data}catch(e){throw r.value=((t=(l=e.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to reject leave application",new Error(r.value)}finally{c.value=!1}}return{leaveApplications:s,leaveApplication:d,loading:c,error:r,selectedMonth:h,selectedYear:w,user:p,selectedStatus:m,fetchLeaveApplications:f,storeLeaveApplication:x,updateLeaveApplication:I,fetchLeaveApplicationById:E,acceptHandover:L,acceptInCharge:S,acceptCoordinator:b,acceptOperationalAdmin:C,acceptRecommendBy:j,acceptApprovedBy:B,rejectLeaveApplication:D,fetchMyLeaveApplications:y,deleteLeaveApplication:A,fetchFileUpload:F,uploadLeaveApplicationAttachment:$,fetchYearlyUserLeaveApplications:g}});export{U as u};
