import{S as X,r as I,m as G,Q as L,ab as Z,h as B,B as K,c,o as d,F as P,y as O,a as t,t as p,A as F,j as A,x as T,K as J,g as M,p as q,M as ee,d as te,s as ae,e as se,ac as ne,k as w,a2 as Q,f as re,l as le}from"./index-D_5uLc0m.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ie=X("clearance",()=>{const _=I(null),b=I(""),N=I([]),v=I([]),o=I([]),r=I(new Map),x=I(new Set),k=I(!1),$=I(!1),y=I(""),C=G(()=>{const u=o.value.slice().sort((l,n)=>(l.order_no??0)-(n.order_no??0)).map(l=>{const n=r.value.get(l.template_item_id)||{};return{template_item_id:l.template_item_id,label:l.label||l.item_label||l.item_key,status:n.status||"PENDING",handover_status:n.handover_status||"NA",present_condition:n.present_condition||"",receiver_name:n.receiver_name||"",remarks:n.remarks||""}});return b.value?u.filter(l=>l.status===b.value):u});function D(u,l=!0){l?x.value.add(u):x.value.delete(u)}function m(){x.value.clear()}const f=async(u=null)=>{var l,n;k.value=!0,y.value=null;try{const e=await L.get("/departments",{params:{company_id:u}});N.value=e.data}catch(e){y.value=((n=(l=e.response)==null?void 0:l.data)==null?void 0:n.message)||"ডিপার্টমেন্ট লোড করতে ব্যর্থ হয়েছে।",console.error("Error fetching departments:",e)}finally{k.value=!1}};async function i(u){var l;y.value="";try{const n=await L.get("/without-permission-users",{params:{department_id:u,per_page:1e3}});v.value=((l=n.data)==null?void 0:l.data)||n.data||[]}catch(n){y.value="Failed to load users",console.error(n)}}async function S(){var u;o.value=[],y.value="";try{const l=await L.get("/department-clearance-items"),n=((u=l.data)==null?void 0:u.data)||l.data||[];o.value=n.map(e=>{var s,a,g,h;return{template_item_id:e.template_item_id??((s=e.templateItem)==null?void 0:s.id),label:((a=e.templateItem)==null?void 0:a.label)??((g=e.templateItem)==null?void 0:g.item_key)??e.label,order_no:((h=e.templateItem)==null?void 0:h.order_no)??0}}).filter(e=>e.template_item_id)}catch(l){y.value="Failed to load assigned items",console.error(l)}}async function R(u,l,n){var e;r.value=new Map,y.value="";try{const s=await L.get("/clearances",{params:{user_id:u,department_id:l,template_id:n,per_page:1e3}}),a=((e=s.data)==null?void 0:e.data)||s.data||[];for(const g of a)r.value.set(g.template_item_id,g)}catch(s){y.value="Failed to load clearances",console.error(s)}}async function U(u,l){if(!(!u||!l)){k.value=!0,y.value="";try{await S(u,l),_.value&&await R(_.value,u,l)}catch(n){y.value="Failed to refresh data",console.error(n)}finally{k.value=!1}}}async function V(u,l){if(!_.value)return;const n=C.value.filter(e=>x.value.has(e.template_item_id)).map(e=>({template_item_id:e.template_item_id,status:e.status,handover_status:e.handover_status,present_condition:(typeof e.present_condition=="string"?e.present_condition.trim():"")||null,receiver_name:(typeof e.receiver_name=="string"?e.receiver_name.trim():"")||null,remarks:(typeof e.remarks=="string"?e.remarks.trim():"")||null}));if(n.length!==0){$.value=!0,y.value="";try{await L.post("/clearances/bulk-upsert",{user_id:_.value,department_id:u,items:n}),m(),await R(_.value,u,l)}catch(e){y.value="Failed to save",console.error(e)}finally{$.value=!1}}}return{userId:_,departments:N,statusFilter:b,users:v,assignedItems:o,clearanceByItemId:r,itemsForTable:C,dirty:x,loading:k,saving:$,error:y,loadUsersByDept:i,fetchDepartments:f,loadAssignedItems:S,loadClearances:R,refreshAll:U,saveBulk:V,markDirty:D}}),de=["value"],ue={__name:"HandoverSelect",props:{modelValue:{type:String,default:"NA"},modelModifiers:{}},emits:["update:modelValue"],setup(_){const b=Z(_,"modelValue"),N=[{v:"YES",t:"Yes"},{v:"NO",t:"No"},{v:"NA",t:"N/A"}];return(v,o)=>B((d(),c("select",{"onUpdate:modelValue":o[0]||(o[0]=r=>b.value=r),class:"input-1"},[(d(),c(P,null,O(N,r=>t("option",{key:r.v,value:r.v},p(r.t),9,de)),64))],512)),[[K,b.value]])}},ce=["aria-disabled"],me=["aria-checked","onClick"],pe="inline-flex items-center gap-1 rounded-md border px-2.5 py-1.5 text-xs font-medium transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500/40 select-none",ve=Object.assign({name:"StatusSegment"},{__name:"StatusSegment",props:{modelValue:{type:String,default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(_,{emit:b}){const N=_,v=b,o=m=>(m??"").toString().trim().toUpperCase(),r=I(o(N.modelValue));F(()=>N.modelValue,m=>{const f=o(m);f!==r.value&&(r.value=f)});const x=[{value:"PENDING",label:"Pending"},{value:"WORKING",label:"Working"},{value:"COMPLETED",label:"Completed"}],k=m=>r.value===m;function $(m){if(N.disabled)return;const f=o(m);r.value=f,v("update:modelValue",f),v("change",f)}function y(m){if(N.disabled)return;const f=Math.max(0,x.findIndex(i=>i.value===r.value));["ArrowRight","ArrowDown"].includes(m.key)?(m.preventDefault(),$(x[(f+1)%x.length].value)):["ArrowLeft","ArrowUp"].includes(m.key)&&(m.preventDefault(),$(x[(f-1+x.length)%x.length].value))}function C(m){const i=k(m)?{PENDING:"bg-amber-600 text-white border-amber-600",WORKING:"bg-sky-600 text-white border-sky-600",COMPLETED:"bg-emerald-600 text-white border-emerald-600"}[m]||"bg-gray-800 text-white border-gray-800":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50",S=N.disabled?"opacity-60 cursor-not-allowed":"cursor-pointer";return`${pe} ${i} ${S}`}const D=G(()=>`inline-flex items-center gap-1 bg-white rounded-lg p-1 border ${N.disabled?"opacity-75":""}`);return(m,f)=>(d(),c("div",{class:T(D.value),role:"radiogroup","aria-disabled":_.disabled?"true":"false",onKeydown:y},[(d(),c(P,null,O(x,i=>t("button",{key:i.value,type:"button",class:T(C(i.value)),"aria-checked":k(i.value)?"true":"false",role:"radio",onClick:S=>$(i.value)},[t("span",{class:T(["h-1.5 w-1.5 rounded-full",{"bg-amber-200":i.value==="PENDING"&&!k(i.value),"bg-sky-200":i.value==="WORKING"&&!k(i.value),"bg-emerald-200":i.value==="COMPLETED"&&!k(i.value),"bg-white":k(i.value)}])},null,2),A(" "+p(i.label),1)],10,me)),64))],42,ce))}}),_e={class:"card overflow-hidden border rounded-xl bg-white shadow-sm print:shadow-none"},be={class:"px-4 py-3 border-b bg-white/85 backdrop-blur supports-[backdrop-filter]:bg-white/70 flex flex-wrap items-center justify-between gap-3","aria-live":"polite"},ge={class:"text-sm text-gray-700"},fe={class:"ml-1 font-semibold tabular-nums"},ye={class:"flex items-center gap-2 text-xs"},he={class:"font-medium"},we={class:"ml-1.5 px-1.5 py-0.5 rounded bg-white/70 border text-[10px] tabular-nums"},xe={class:"w-full text-sm min-w-[980px]"},ke={class:"px-3 py-2 align-top text-gray-500 tabular-nums"},Ne={class:"px-3 py-2 align-top"},Ee={class:"font-medium leading-tight text-gray-900"},$e={class:"mt-1 flex flex-wrap gap-1.5 text-[11px] text-amber-700"},Ce={key:0,class:"inline-flex items-center gap-1 bg-amber-50 border border-amber-200 rounded px-1.5 py-0.5"},Se={key:1,class:"inline-flex items-center gap-1 bg-amber-50 border border-amber-200 rounded px-1.5 py-0.5"},Ie={key:2,class:"inline-flex items-center gap-1 bg-amber-50 border border-amber-200 rounded px-1.5 py-0.5"},De={class:"px-3 py-2 align-top print:text-gray-900 print:font-medium"},Re={class:"print:hidden"},Te={class:"hidden print:block"},Ae={class:"px-3 py-2 align-top"},Be={class:"relative group"},Me=["disabled","value","maxlength","aria-describedby","onInput","onBlur"],Pe=["id"],Oe={class:"hidden print:block text-gray-900 whitespace-pre-wrap"},Ue={class:"px-3 py-2 align-top"},Ve={class:"relative"},ze=["disabled","value","maxlength","aria-describedby","onInput","onBlur"],Le=["id"],Fe={class:"hidden print:block text-gray-900 whitespace-pre-wrap"},Ge={class:"px-3 py-2 align-top"},We={class:"relative"},Ke=["disabled","value","maxlength","aria-describedby","onInput","onBlur"],He=["id"],je={class:"hidden print:block text-gray-900 whitespace-pre-wrap"},Ye={class:"px-3 py-2 align-top"},qe={class:"print:hidden"},Qe={class:"hidden print:block text-gray-900 font-medium"},Je={key:0},Xe={__name:"ClearanceEditorTable",props:{rows:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},maxHeight:{type:String,default:"60vh"}},emits:["update:row"],setup(_,{emit:b}){const N=_,v=b,o=new Map,r=new Set,x=(e,s)=>`${e}::${s}`;function k(e,s,a,g=300){const h=x(e,s);o.has(h)&&clearTimeout(o.get(h)),r.add(h),o.set(h,setTimeout(()=>{v("update:row",e,{[s]:a}),o.delete(h),r.delete(h)},g))}function $(e,s,a){var h;const g=x(e,s);o.has(g)&&(clearTimeout(o.get(g)),o.delete(g)),r.delete(g),v("update:row",e,{[s]:((h=a==null?void 0:a.trim)==null?void 0:h.call(a))??a})}J(()=>{o.forEach(e=>clearTimeout(e)),o.clear(),r.clear()});function y(e,s=6){if(typeof window>"u")return;e.style.height="auto";const a=window.getComputedStyle(e),g=parseFloat(a.lineHeight)||20,h=(parseFloat(a.borderTopWidth)||0)+(parseFloat(a.borderBottomWidth)||0),W=(parseFloat(a.paddingTop)||0)+(parseFloat(a.paddingBottom)||0),z=g*s+h+W;e.style.height=Math.min(e.scrollHeight,z)+"px",e.style.overflowY=e.scrollHeight>z?"auto":"hidden"}const C={mounted(e,s){var g;const a=Number(((g=s==null?void 0:s.value)==null?void 0:g.maxRows)??6);e.__autosize__=()=>y(e,a),requestAnimationFrame(e.__autosize__),e.addEventListener("input",e.__autosize__)},updated(e){e.__autosize__&&e.__autosize__()},unmounted(e){e.removeEventListener("input",e.__autosize__),delete e.__autosize__}},D=(e,s,a)=>v("update:row",e,{[s]:a}),m=(e,s,a)=>k(e,s,a.target.value),f=(e,s,a)=>$(e,s,a.target.value),i={present_condition:200,receiver_name:120,remarks:255},S=(e,s)=>r.has(x(e,s)),R=(e,s)=>e>=s?"text-red-500":e>=Math.floor(s*.9)?"text-amber-600":"text-gray-400",U=["PENDING","WORKING","COMPLETED"],V={PENDING:{label:"Pending",dot:"bg-amber-500",pill:"bg-amber-50 text-amber-800 border-amber-200"},WORKING:{label:"Working",dot:"bg-sky-500",pill:"bg-sky-50 text-sky-800 border-sky-200"},COMPLETED:{label:"Completed",dot:"bg-emerald-500",pill:"bg-emerald-50 text-emerald-800 border-emerald-200"}},u=G(()=>{const e={PENDING:0,WORKING:0,COMPLETED:0};for(const s of N.rows){const a=s==null?void 0:s.status;a&&e[a]!==void 0&&(e[a]+=1)}return e}),l=G(()=>U.map(e=>[e,u.value[e],V[e]])),n=e=>e==="COMPLETED"?"border-l-4 border-emerald-400":e==="WORKING"?"border-l-4 border-sky-400":e==="PENDING"?"border-l-4 border-amber-400":"";return(e,s)=>(d(),c("div",_e,[t("div",be,[t("div",ge,[s[0]||(s[0]=t("span",{class:"font-medium"},"Assigned items:",-1)),t("span",fe,p(_.rows.length),1)]),t("div",ye,[(d(!0),c(P,null,O(l.value,([a,g,h])=>(d(),c("span",{key:a,class:T(["inline-flex items-center gap-1 rounded-full border px-2.5 py-1",h.pill])},[t("span",{class:T(["h-1.5 w-1.5 rounded-full",h.dot])},null,2),t("span",he,p(h.label),1),t("span",we,p(g),1)],2))),128))])]),t("div",{class:"overflow-auto",style:ee({maxHeight:_.maxHeight})},[t("table",xe,[s[5]||(s[5]=t("thead",{class:"bg-gray-50 sticky top-0 z-10 backdrop-blur border-b"},[t("tr",{class:"text-left text-gray-600"},[t("th",{class:"px-3 py-2 w-10"},"#"),t("th",{class:"px-3 py-2"},"Item"),t("th",{class:"px-3 py-2 w-44"},"Handover"),t("th",{class:"px-3 py-2 w-[20rem]"},"Present Condition"),t("th",{class:"px-3 py-2 w-[18rem]"},"Receiver"),t("th",{class:"px-3 py-2 w-[20rem]"},"Remarks"),t("th",{class:"px-3 py-2 w-44"},"Status")])],-1)),t("tbody",null,[(d(!0),c(P,null,O(_.rows,(a,g)=>{var h,W,z,H,j,Y;return d(),c("tr",{key:a.template_item_id,class:T(["border-t hover:bg-gray-50/70 transition-colors odd:bg-white even:bg-slate-50/40",n(a.status)])},[t("td",ke,p(g+1),1),t("td",Ne,[t("div",Ee,p(a.label),1),t("div",$e,[S(a.template_item_id,"present_condition")?(d(),c("span",Ce,s[1]||(s[1]=[t("span",{class:"h-1.5 w-1.5 rounded-full bg-amber-500"},null,-1),A(" editing condition… ")]))):M("",!0),S(a.template_item_id,"receiver_name")?(d(),c("span",Se,s[2]||(s[2]=[t("span",{class:"h-1.5 w-1.5 rounded-full bg-amber-500"},null,-1),A(" editing receiver… ")]))):M("",!0),S(a.template_item_id,"remarks")?(d(),c("span",Ie,s[3]||(s[3]=[t("span",{class:"h-1.5 w-1.5 rounded-full bg-amber-500"},null,-1),A(" editing remarks… ")]))):M("",!0)])]),t("td",De,[t("div",Re,[q(ue,{disabled:_.disabled,"model-value":a.handover_status,"onUpdate:modelValue":E=>D(a.template_item_id,"handover_status",E)},null,8,["disabled","model-value","onUpdate:modelValue"])]),t("div",Te,p(a.handover_status||"—"),1)]),t("td",Ae,[t("div",Be,[B(t("textarea",{disabled:_.disabled,class:"w-full resize-none bg-white border border-gray-300 rounded-lg px-3 py-2 leading-6 focus:outline-none focus:ring-2 focus:ring-sky-500/20 focus:border-sky-500 disabled:bg-gray-50",value:a.present_condition,placeholder:"e.g., OK / minor scratches / not applicable",maxlength:i.present_condition,rows:"2",spellcheck:"true","aria-label":"Present condition","aria-describedby":`pcounter-${a.template_item_id}`,onInput:E=>m(a.template_item_id,"present_condition",E),onBlur:E=>f(a.template_item_id,"present_condition",E)},null,40,Me),[[C,{maxRows:6}]]),t("div",{class:T(["absolute bottom-1 right-2 text-[10px] select-none",R(((h=a.present_condition)==null?void 0:h.length)||0,i.present_condition)]),id:`pcounter-${a.template_item_id}`},p(((W=a.present_condition)==null?void 0:W.length)||0)+"/"+p(i.present_condition),11,Pe)]),t("div",Oe,p(a.present_condition||"—"),1)]),t("td",Ue,[t("div",Ve,[B(t("textarea",{disabled:_.disabled,class:"w-full resize-none bg-white border border-gray-300 rounded-lg px-3 py-2 leading-6 focus:outline-none focus:ring-2 focus:ring-sky-500/20 focus:border-sky-500 disabled:bg-gray-50",value:a.receiver_name,placeholder:"Receiver name(s), designation — one per line if multiple",maxlength:i.receiver_name,rows:"2",spellcheck:"true","aria-label":"Receiver name","aria-describedby":`rcounter-${a.template_item_id}`,onInput:E=>m(a.template_item_id,"receiver_name",E),onBlur:E=>f(a.template_item_id,"receiver_name",E)},null,40,ze),[[C,{maxRows:4}]]),t("div",{class:T(["absolute bottom-1 right-2 text-[10px] select-none",R(((z=a.receiver_name)==null?void 0:z.length)||0,i.receiver_name)]),id:`rcounter-${a.template_item_id}`},p(((H=a.receiver_name)==null?void 0:H.length)||0)+"/"+p(i.receiver_name),11,Le)]),t("div",Fe,p(a.receiver_name||"—"),1)]),t("td",Ge,[t("div",We,[B(t("textarea",{disabled:_.disabled,class:"w-full resize-none bg-white border border-gray-300 rounded-lg px-3 py-2 leading-6 focus:outline-none focus:ring-2 focus:ring-sky-500/20 focus:border-sky-500 disabled:bg-gray-50",value:a.remarks,placeholder:"Remarks (optional)",maxlength:i.remarks,rows:"2",spellcheck:"true","aria-label":"Remarks","aria-describedby":`rmcounter-${a.template_item_id}`,onInput:E=>m(a.template_item_id,"remarks",E),onBlur:E=>f(a.template_item_id,"remarks",E)},null,40,Ke),[[C,{maxRows:6}]]),t("div",{class:T(["absolute bottom-1 right-2 text-[10px] select-none",R(((j=a.remarks)==null?void 0:j.length)||0,i.remarks)]),id:`rmcounter-${a.template_item_id}`},p(((Y=a.remarks)==null?void 0:Y.length)||0)+"/"+p(i.remarks),11,He)]),t("div",je,p(a.remarks||"—"),1)]),t("td",Ye,[t("div",qe,[q(ve,{disabled:_.disabled,"model-value":a.status,"onUpdate:modelValue":E=>D(a.template_item_id,"status",E)},null,8,["disabled","model-value","onUpdate:modelValue"])]),t("div",Qe,p(a.status||"—"),1)])],2)}),128)),_.rows.length===0?(d(),c("tr",Je,s[4]||(s[4]=[t("td",{colspan:"7",class:"px-3 py-12"},[t("div",{class:"flex flex-col items-center justify-center text-center border border-dashed rounded-xl p-8 bg-slate-50"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8 mb-2",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M3 7h18M3 12h18M3 17h18M7 3v18"})]),t("div",{class:"text-sm text-gray-700 font-medium"},"No items to show"),t("p",{class:"text-xs text-gray-500 mt-1"},"Choose a department & template to load assigned clearance items.")])],-1)]))):M("",!0)])])],4)]))}},Ze=oe(Xe,[["__scopeId","data-v-88a75fa8"]]),et={class:"p-6 space-y-6"},tt={class:"sticky top-0 z-10 bg-white/90 backdrop-blur border-b"},at={class:"flex flex-wrap items-center justify-between gap-4 py-3"},st={class:"flex items-center gap-2"},nt={key:0,class:"hidden md:flex items-center gap-2 text-xs text-gray-600","aria-label":"Summary"},rt={class:"inline-flex items-center gap-1 rounded-full bg-gray-100 px-2 py-1"},lt={class:"inline-flex items-center gap-1 rounded-full bg-gray-100 px-2 py-1"},ot={class:"inline-flex items-center gap-1 rounded-full bg-gray-100 px-2 py-1"},it=["disabled","aria-busy"],dt={key:0},ut={key:1},ct=["disabled","title","aria-busy"],mt={key:0},pt={key:1},vt={class:"card p-4 space-y-4"},_t={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},bt=["value"],gt=["disabled"],ft=["value"],yt={key:0,class:"mt-2 text-sm text-rose-600"},ht={key:0,class:"card p-6 text-gray-600"},wt={key:1},xt={key:0,class:"card p-6"},Et={__name:"UserClearance",setup(_){const b=ie(),N=te(),v=I(null),o=I(2),{userId:r,departments:x,statusFilter:k,users:$,itemsForTable:y,loading:C,saving:D,error:m,dirty:f}=ae(b),i=()=>f.value.size,S=()=>!!v.value&&!!o.value;F(()=>{var n;return(n=N.user)==null?void 0:n.department_id},async n=>{if(n){v.value=n,$.value=[],r.value=null;try{await b.loadUsersByDept(n),S()&&await b.refreshAll(n,o.value)}catch(e){console.error("bootstrap error",e)}}},{immediate:!0}),F(v,async n=>{if($.value=[],r.value=null,n)try{await b.loadUsersByDept(n),o.value&&await b.refreshAll(n,o.value)}catch(e){console.error("dept change error",e)}}),F(o,async n=>{if(v.value&&n)try{await b.refreshAll(v.value,n)}catch(e){console.error("template change error",e)}}),F(r,async()=>{if(S()&&r.value)try{await b.loadClearances(r.value,v.value,o.value)}catch(n){console.error("user change error",n)}});function R(n,e){const s=y.value,a=s.findIndex(g=>g.template_item_id===n);a>=0&&(Object.assign(s[a],e),b.markDirty(n,!0))}async function U(){try{if(!r.value)return;await b.saveBulk(v.value,o.value)}catch(n){console.error(n)}}async function V(){if(S())try{await b.refreshAll(v.value,o.value),r.value&&await b.loadClearances(r.value,v.value,o.value)}catch(n){console.error("refresh error",n)}}const u=G(()=>{if(!r.value)return{pending:0,working:0,completed:0};const n=y.value||[];return{pending:n.filter(e=>e.status==="PENDING").length,working:n.filter(e=>e.status==="WORKING").length,completed:n.filter(e=>e.status==="COMPLETED").length}});function l(n){f.value.size>0&&(n.preventDefault(),n.returnValue="")}return se(async()=>{typeof window<"u"&&window.addEventListener("beforeunload",l);try{await b.fetchDepartments()}catch(n){console.error("fetchDepartments error",n)}}),J(()=>{typeof window<"u"&&window.removeEventListener("beforeunload",l)}),ne((n,e,s)=>{if(f.value.size>0&&typeof window<"u"&&!window.confirm("You have unsaved changes. Leave anyway?"))return s(!1);s()}),(n,e)=>(d(),c("div",et,[t("div",tt,[t("div",at,[e[6]||(e[6]=t("div",{class:"p-2"},[t("h1",{class:"text-2xl font-semibold tracking-tight"},"User Clearance"),t("p",{class:"text-sm text-gray-600"}," Assign করা আইটেম অনুযায়ী ইউজারের ক্লিয়ারেন্স আপডেট করুন ")],-1)),t("div",st,[w(r)?(d(),c("div",nt,[t("span",rt,[e[3]||(e[3]=A(" Pending: ")),t("b",null,p(u.value.pending),1)]),t("span",lt,[e[4]||(e[4]=A(" Working: ")),t("b",null,p(u.value.working),1)]),t("span",ot,[e[5]||(e[5]=A(" Completed: ")),t("b",null,p(u.value.completed),1)])])):M("",!0),t("button",{class:"btn-2",onClick:V,disabled:w(C)||!v.value||!o.value,title:"Reload template bindings and current user's items","aria-busy":w(C)?"true":"false"},[w(C)?(d(),c("span",dt,"Refreshing…")):(d(),c("span",ut,"Refresh"))],8,it),t("button",{class:"btn-1",onClick:U,disabled:w(D)||w(f).size===0||!w(r),title:w(r)?"":"Select a user first","aria-busy":w(D)?"true":"false"},[w(D)?(d(),c("span",mt,"Saving…")):(d(),c("span",pt,"Save Changes ("+p(i())+")",1))],8,ct)])])]),t("div",vt,[t("div",_t,[t("div",null,[e[8]||(e[8]=t("label",{class:"text-sm font-medium"},"Department",-1)),B(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),class:"input-1"},[e[7]||(e[7]=t("option",{value:null},"Select Department",-1)),(d(!0),c(P,null,O(w(x),s=>(d(),c("option",{key:s.id,value:s.id},p(s.name),9,bt))),128))],512),[[K,v.value]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"text-sm font-medium"},"User",-1)),B(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>Q(r)?r.value=s:null),class:"input-1",disabled:!v.value},[e[9]||(e[9]=t("option",{value:null},"Select user",-1)),(d(!0),c(P,null,O(w($),s=>(d(),c("option",{key:s.id,value:s.id},p(s.name),9,ft))),128))],8,gt),[[K,w(r)]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"text-sm font-medium"},"Status Filter",-1)),B(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>Q(k)?k.value=s:null),class:"input-1"},e[11]||(e[11]=[t("option",{value:""},"All",-1),t("option",{value:"PENDING"},"Pending",-1),t("option",{value:"WORKING"},"Working",-1),t("option",{value:"COMPLETED"},"Completed",-1)]),512),[[K,w(k)]])])]),w(m)?(d(),c("div",yt,p(w(m)),1)):M("",!0)]),w(r)?(d(),c("div",wt,[w(C)?(d(),c("div",xt,e[14]||(e[14]=[le('<div class="animate-pulse space-y-3"><div class="h-4 bg-gray-200 rounded w-1/3"></div><div class="h-4 bg-gray-200 rounded w-2/3"></div><div class="h-4 bg-gray-200 rounded"></div><div class="h-4 bg-gray-200 rounded"></div></div>',1)]))):(d(),re(Ze,{rows:w(y),key:w(r),"onUpdate:row":R},null,8,["rows"]))])):(d(),c("div",ht,e[13]||(e[13]=[A(" Select a "),t("b",null,"User",-1),A(" to load clearance items. ")])))]))}};export{Et as default};
