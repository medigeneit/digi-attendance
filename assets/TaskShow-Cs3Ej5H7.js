import{G as ct,r as P,e as kt,H as gt,A as mt,c as l,o as n,g as v,a as t,t as b,I as R,j as T,d as yt,b as ft,q as I,F as E,k as r,w as $,p as g,i as w,E as B,f as D,x as O,y as L,J as _t,K as ut,h as ht,v as Tt,u as $t,n as pt}from"./index-DHz7ni4_.js";import{L as G}from"./LoaderView-uU4GutIQ.js";import{O as A}from"./OverlyModal-CQeon82-.js";import{_ as Ct}from"./TaskAddForm-Bj_q-VLV.js";import{_ as St}from"./TaskEditForm-YW-RpnWR.js";import{_ as wt,a as It,b as Dt,c as Pt}from"./TaskTreeView-C2HfRm9Y.js";import{a as Ut,_ as Et}from"./TaskUserAssignForm-2cAFI_09.js";import{u as Lt,a as Mt}from"./task-priority-Dm3W2JWS.js";import{g as j}from"./datetime-q3Sn87-f.js";import{_ as q}from"./UserChip-MkFo7-y8.js";import{u as At}from"./useTaskStore-CcW_wk16.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./RequiredIcon-CpqxbtXQ.js";import"./company-ykiwKHyR.js";import"./useRequirementStore-CL_4F3AU.js";import"./CompanyDepartmentSelectInput-Df6IRP7p.js";import"./SectionLoading-18BdXaOG.js";import"./TextWithHr-DVa9Aqj4.js";import"./TaskUrgencyInput-DGIc0imv.js";import"./MultiselectDropdown-C-a1oLOo.js";const Nt={key:0},Ot={key:0},Rt={key:1},jt=ct({__name:"CountdownTimer",props:{targetDateTime:{}},setup(o){const e=o,a=P(m());let i;function m(){const c=new Date(e.targetDateTime).getTime()-new Date().getTime(),f=Math.floor(c/1e3%60),d=Math.floor(c/1e3/60%60),p=Math.floor(c/(1e3*60*60)%24),y=Math.floor(c/(1e3*60*60*24));return{total:c,days:y,hours:p,minutes:d,seconds:f}}function k(){a.value=m()}return kt(()=>{i=setInterval(()=>{k(),a.value.total<=0&&clearInterval(i)},1e3)}),gt(()=>clearInterval(i)),mt(()=>e.targetDateTime,()=>{k(),clearInterval(i)}),(c,f)=>a.value.total>0?(n(),l("div",Nt,[a.value.days?(n(),l("span",Ot,b(a.value.days)+"d ",1)):v("",!0),t("span",null,b(a.value.hours.toString().padStart(2,"0"))+"h :",1),t("span",null,b(a.value.minutes.toString().padStart(2,"0"))+"m :",1),t("span",null,b(a.value.seconds.toString().padStart(2,"0"))+"s",1)])):(n(),l("div",Rt,[R(c.$slots,"expired",{},()=>[f[0]||(f[0]=T("Timeâ€™s up!"))])]))}}),Ft={class:"mb-3"},Bt={key:0,class:"flex gap-2 items-center mx-auto justify-center mb-2"},Gt={key:1,class:"text-center py-4 text-gray-500"},qt={key:2,class:"text-center py-4 text-red-500"},Ht={key:3,class:"space-y-4"},Vt={__name:"TaskList",props:{tasks:{default:null,type:Array},loading:{default:!1,type:Boolean},error:{default:"",type:String},parentId:{type:Number,default:0},treeLevel:{type:Number,required:!0}},emits:["commentButtonClick","editClick","addClick","updatePriority"],setup(o,{emit:e}){const a=o,i=yt(),m=ft(),k=I(()=>{var _;return!!(((_=i==null?void 0:i.user)==null?void 0:_.role)!=="employee"&&(i!=null&&i.isAdminMood))}),c=e,f=P(null),{handleItemsPriorityUpdate:d,saveTaskPriority:p,listHasRearranged:y}=Lt(()=>a.tasks,a.parentId),C=async()=>{await p(),c("updatePriority")};return(_,s)=>(n(),l("div",null,[t("div",Ft,[R(_.$slots,"task:header")]),k.value?(n(),l(E,{key:0},[r(y)?(n(),l("div",Bt,[s[4]||(s[4]=t("span",{class:"text-red-500"},"Priority Changed",-1)),t("button",{class:"btn-3",onClick:$(C,["prevent"])},"Save"),t("button",{class:"btn-3",onClick:s[0]||(s[0]=$((...x)=>f.value.resetItems&&f.value.resetItems(...x),["prevent"]))},"Discard")])):v("",!0)],64)):v("",!0),o.loading?(n(),l("div",Gt,"Loading tasks...")):o.error?(n(),l("div",qt,b(o.error),1)):(n(),l("div",Ht,[g(Ut,{items:o.tasks,handle:"handle",onItemsUpdate:r(d),class:"rounded-lg bg-white overflow-hidden space-y-3",ref_key:"draggableTaskList",ref:f},{item:w(({item:x,index:F})=>[g(wt,{isMyTask:r(m).name=="MyTaskShow",index:F,task:x,showDraggableHandle:k.value,"tree-level":o.treeLevel,class:"!border-0",onCommentButtonClick:U=>c("commentButtonClick",x.id),onEditClick:s[1]||(s[1]=U=>c("editClick",U)),onAddClick:s[2]||(s[2]=U=>c("addClick",U)),onEmployeeAssignClick:s[3]||(s[3]=U=>c("employeeAssignClick",U))},null,8,["isMyTask","index","task","showDraggableHandle","tree-level","onCommentButtonClick"])]),_:1},8,["items","onItemsUpdate"])]))]))}},Wt={class:"flex justify-between mt-5"},zt={key:0,class:"flex flex-wrap items-center gap-2 mt-3"},Jt={__name:"SubTaskList",props:{subTasks:Array,parentId:{type:Number,required:!0},treeLevel:{type:Number,required:!0},subTaskIsCreatable:{type:Boolean,default:!0}},emits:["created","error","updatePriority","assignUser"],setup(o,{emit:e}){const a=o,i=B({taskId:0,isOpen:!1}),m=e,k=P(),c=B({show:!1,parentId:a.parentId,requirementId:null}),f=_=>{c.show=!0,c.parentId=_,console.log({addForm:c})};function d(){c.show=!1,c.parentId=a.parentId,m("created")}function p(){m("assignUser")}function y(){k.value=!1,m("updated")}function C(){c.show=!1,c.parentId=a.parentId}return(_,s)=>(n(),l("div",null,[k.value?(n(),D(A,{key:0},{default:w(()=>[g(St,{taskId:k.value,onClose:s[0]||(s[0]=x=>k.value=null),onUpdated:y},null,8,["taskId"])]),_:1})):v("",!0),c.show?(n(),D(A,{key:1},{default:w(()=>[g(Ct,{parentTaskId:c.parentId,requirementId:c.requirementId,onTaskCreated:d,onError:_.handleTaskError,onClose:C},null,8,["parentTaskId","requirementId","onError"])]),_:1})):v("",!0),i.isOpen?(n(),D(A,{key:2},{default:w(()=>[g(Et,{taskId:i.taskId,onCancelClick:s[1]||(s[1]=()=>{i.isOpen=!1,i.taskId=0}),onSuccess:s[2]||(s[2]=()=>{i.isOpen=!1,i.taskId=0,p()})},null,8,["taskId"])]),_:1})):v("",!0),g(Vt,{tasks:o.subTasks,parentId:o.parentId,treeLevel:o.treeLevel,onAddClick:s[4]||(s[4]=x=>f(x)),onEditClick:s[5]||(s[5]=x=>k.value=x),onUpdatePriority:s[6]||(s[6]=x=>m("updatePriority")),onEmployeeAssignClick:s[7]||(s[7]=x=>{i.taskId=x,i.isOpen=!0})},{"task:header":w(()=>[t("div",Wt,[s[8]||(s[8]=t("div",{class:"flex justify-between items-center"},[t("h2",{class:"text-xl font-semibold text-gray-800"},"Sub Tasks")],-1)),o.subTaskIsCreatable?(n(),l("div",zt,[t("button",{class:"btn-1 ml-auto",onClick:s[3]||(s[3]=$(()=>f(o.parentId),["prevent"]))}," Add Sub Task ")])):v("",!0)])]),_:1},8,["tasks","parentId","treeLevel"])]))}},Kt=o=>o==null?void 0:o.reduce((e,a)=>e+a.task_weight,0),bt=(o,e)=>{const a=Kt(o);return o.map(i=>{const m=e.filter(k=>k.user_id===i.id).reduce((k,c)=>k+c.progress,0);return{...i,task_progress:Math.floor(m*(i.task_weight/a)),user_progress:m}})},Qt=(o,e)=>{let a=0;const i=[],m=f=>f.status==="COMPLETED",k=f=>f.users.some(d=>d.id===e),c=(f,d)=>{f.forEach(p=>{const y=k(p);i[d]=i[d]||{user_id:e,total_assigned:0,total_assigned_on_leaf_task:0,completed_count:0};const C=y&&p.children_tasks.length===0;i[d].total_assigned+=y?1:0,i[d].total_assigned_on_leaf_task+=C?1:0,a+=C?1:0,y&&m(p)&&(i[d].completed_count++,p.children_tasks.length),p.children_tasks.length>0&&c(p.children_tasks,d+1)})};return c(o,0),{sub_task_infos:i,assigned_on_any_leaf_task:a>0}},Xt=(o,e)=>o.map(a=>({...a,...Qt(e,a.id)})),Yt={key:0,class:"min-w-full bg-white rounded overflow-hidden"},Zt={class:"py-0.5 text-bg font-semibold"},te={class:"bg-gray-50"},ee={class:"px-2 py-1 border-y"},se={class:"px-2 py-1 border-y"},ae={key:0,class:"text-sm text-gray-400"},ne={key:1},oe={key:1,class:"min-w-full bg-white rounded overflow-hidden"},re={class:"py-0.5 text-bg font-semibold"},le={class:"px-2 py-1 border-y text-center"},ie={class:"px-2 py-1 border-y border-r"},de={class:"px-2 py-1 border-y text-center"},ue={class:"px-2 py-1 border-y text-center"},pe=ct({__name:"TaskProgressTable",props:{task:{},subTasks:{}},setup(o){const e=o,a=I(()=>bt(e.task.users,e.task.task_reports||[])),i=I(()=>Xt(e.task.users,e.subTasks));return(m,k)=>{var c,f;return e.task.children_task_count>0?(n(),l("table",Yt,[t("caption",Zt,[R(m.$slots,"caption",{},()=>[k[0]||(k[0]=T("Progress"))])]),t("thead",te,[t("tr",null,[k[1]||(k[1]=t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-left"},"#",-1)),k[2]||(k[2]=t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-left lg:w-[200px]"}," User ",-1)),(n(!0),l(E,null,O(((f=(c=i.value[0]||{})==null?void 0:c.sub_task_infos)==null?void 0:f.length)||1,d=>(n(),l("th",{key:d,class:"px-2 py-1 border-y font-semibold text-xs uppercase text-center"},b(d===1?"Completed Sub Task":"")+" "+b(d===2?"Completed Sub Sub Task":"")+" "+b(d===3?"Completed Sub Sub Sub Task":""),1))),128))])]),t("tbody",null,[(n(!0),l(E,null,O(i.value,(d,p)=>(n(),l("tr",{key:d.id,class:"border-t hover:bg-gray-50 cursor-pointer"},[t("td",ee,b(p+1),1),t("td",se,[g(q,{user:d},null,8,["user"])]),(n(!0),l(E,null,O(d.sub_task_infos,(y,C)=>(n(),l("td",{class:"px-2 py-1 border-y text-center",key:C},[y.total_assigned===0||!d.assigned_on_any_leaf_task?(n(),l("div",ae," Not Assigned To Any Task ")):(n(),l("div",ne,b(y.completed_count)+" / "+b(y.total_assigned),1))]))),128))]))),128))])])):(n(),l("table",oe,[t("caption",re,[R(m.$slots,"caption",{},()=>[k[3]||(k[3]=T("Progress"))])]),k[4]||(k[4]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase w-[50px] text-center"},"#"),t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-left sm:w-[250px] mx:w-[300px] border-r"}," User "),t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-center"},"Started"),t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-center"},"Finished")])],-1)),t("tbody",null,[(n(!0),l(E,null,O(a.value,(d,p)=>(n(),l("tr",{key:d.id,class:"border-t hover:bg-gray-50 cursor-pointer"},[t("td",le,b(p+1),1),t("td",ie,[g(q,{user:d},null,8,["user"])]),t("td",de,b(r(j)(d.task_started_at)),1),t("td",ue,b(r(j)(d.task_finished_at)),1)]))),128))])]))}}}),ce={class:"flex justify-center items-center"},ke={key:0,class:"flex flex-col justify-center items-center"},me={key:1},ye={key:1},fe={key:2,class:"flex justify-center items-center flex-col"},be={key:3,class:"flex flex-col justify-center items-center"},ve={class:"border-b -mx-4 px-4 border -mt-4 py-2 text-xl bg-gray-50"},xe={class:"my-6"},ge={class:"text-center font-semibold text-blue-800 mb-4"},_e={class:"text-center my-1"},he={class:"border px-2 rounded-md bg-gray-50"},Te={class:"text-red-600 text-center mt-2 text-sm"},$e={class:"flex justify-between mt-3"},Ce={class:"btn-2"},Se={__name:"TaskStatusManager",props:{task:{type:Object}},emits:["updateStatus","error"],setup(o,{emit:e}){const a=o,i=e,m=P(""),k=P(),c=P(),f=I(()=>({"bg-yellow-50":a.task.status==="IN_PROGRESS","bg-green-50":a.task.status==="COMPLETED","bg-red-50":a.task.status==="PENDING","bg-blue-50":a.task.closed_at})),d=I(()=>a.task.status=="PENDING"?"Start":a.task.status=="IN_PROGRESS"?"Finish":a.task.status=="COMPLETED"?"Close":""),p=I(()=>d.value=="Start"?"Start Task":d.value=="Finish"?"Finish Task":d.value=="Close"?"Close Task":"");async function y(){var _,s;k.value="submitting";try{await Mt(a.task.id,{status:m.value}),m.value="",i("updateStatus")}catch(x){c.value=(s=(_=x.response)==null?void 0:_.data)==null?void 0:s.message,i("error")}finally{k.value=""}}const C=I(()=>d.value=="Start"?"fas fa-play-circle text-blue-500":d.value=="Finish"?"fas fa-stop-circle text-blue-500":"");return(_,s)=>o.task.children_task_count>0&&o.task.status!=="PENDING"||o.task.children_task_count===0?(n(),l("div",{key:0,class:L(["border py-8 px-4 rounded",f.value])},[t("div",ce,[o.task.closed_at?(n(),l("div",ke,s[4]||(s[4]=[t("i",{class:"fad fa-lock-alt fa-6x text-blue-500"},null,-1),t("div",{class:"text-blue-700 text-2xl mt-4"},"Task closed",-1)]))):o.task.status==="PENDING"?(n(),l("div",me,[o.task.children_task_count===0?(n(),l("button",{key:0,class:"btn-3",onClick:s[0]||(s[0]=$(x=>m.value="IN_PROGRESS",["prevent"]))}," Start Working ")):(n(),l("div",ye,"Task Pending"))])):o.task.status==="IN_PROGRESS"?(n(),l("div",fe,[s[5]||(s[5]=t("i",{class:"fas fa-circle fa-2x text-red-800 animate-pulse"},null,-1)),s[6]||(s[6]=t("div",{class:"mb-3 text-2xl my-4 text-red-800"},"Task In Progress",-1)),o.task.children_task_count===0?(n(),l("button",{key:0,class:"btn-3",onClick:s[1]||(s[1]=$(x=>m.value="COMPLETED",["prevent"]))}," Finish Task ")):v("",!0)])):o.task.status==="COMPLETED"?(n(),l("div",be,[s[7]||(s[7]=t("i",{class:"fad fa-check-circle fa-6x text-green-500"},null,-1)),s[8]||(s[8]=t("div",{class:"text-green-700 text-2xl"},"Task Has been completed",-1)),t("button",{class:"btn-3 mt-8",onClick:s[2]||(s[2]=$(x=>m.value="CLOSED",["prevent"]))},"Close Task")])):v("",!0)]),m.value?(n(),D(A,{key:0},{default:w(()=>[t("form",{class:"p-4 rounded relative",onSubmit:$(y,["prevent"])},[k.value==="submitting"?(n(),D(G,{key:0,class:"absolute inset-0 flex items-center justify-center bg-opacity-90"},{default:w(()=>s[9]||(s[9]=[T("Submitting!")])),_:1,__:[9]})):v("",!0),t("h3",ve,b(p.value),1),t("div",xe,[t("div",ge,b(o.task.title),1),s[12]||(s[12]=t("div",{class:"text-center my-1 text-lg"},"Are you sure?",-1)),t("div",_e,[s[10]||(s[10]=T(" Want to ")),t("span",he,[t("i",{class:L(["text-sm",C.value])},null,2),T(" "+b(d.value),1)]),s[11]||(s[11]=T(" the task? "))])]),s[13]||(s[13]=t("hr",{class:"mt-3 -mx-4"},null,-1)),t("div",null,[t("div",Te,b(c.value),1),t("div",$e,[t("button",{class:"btn-3",onClick:s[3]||(s[3]=$(x=>m.value="",["prevent"]))},"Cancel"),t("button",Ce,[t("i",{class:L(["text-xl text-white",C.value])},null,2),T(" "+b(d.value)+" Task ",1)])])])],32)]),_:1})):v("",!0)],2)):v("",!0)}},we=_t("task-user",()=>({updateUserStartDate:async(a,i,m)=>await ut.patch(`/task-user/task/${a}/user/${i}/update-start-date/${m}`),updateUserFinishDate:async(a,i,m)=>await ut.patch(`/task-user/task/${a}/user/${i}/update-finish-date/${m}`)})),Ie={class:"border-b text-center"},De={key:0},Pe={key:1},Ue={class:"mb-2 mt-6"},Ee={class:"flex justify-center"},Le={class:"py-6"},Me={class:"mt-2"},Ae={key:0,class:"inline-block text-sm text-orange-700 text-center w-full"},Ne={class:"flex justify-between items-center"},Oe={__name:"TaskUserDateUpdate",props:{task:{type:Object},user:{user:Object},type:{type:String}},emits:["closeClick","updateDate"],setup(o,{emit:e}){const a=o,i=e,m=we(),k=P(""),c=P("");async function f(){var d,p;console.log({date:k.value});try{a.type=="start-date"?await m.updateUserStartDate(a.task.id,a.user.id,k.value||"0"):a.type=="finish-date"&&await m.updateUserFinishDate(a.task.id,a.user.id,k.value||"0"),i("updateDate")}catch(y){c.value=((p=(d=y.response)==null?void 0:d.data)==null?void 0:p.message)||`Failed to update ${a.type}`}}return(d,p)=>(n(),l("form",{class:"p-4",onSubmit:$(f,["prevent"])},[t("div",Ie,[o.type=="start-date"?(n(),l("h2",De,"Edit Start Date")):o.type=="finish-date"?(n(),l("h2",Pe,"Edit Finish Date")):v("",!0)]),t("div",Ue,[p[2]||(p[2]=t("div",{class:"text-xs uppercase text-gray-500 font-semibold"},"Task:",-1)),t("div",null,b(o.task.title),1)]),t("div",null,[p[3]||(p[3]=t("div",{class:"text-xs uppercase text-gray-500 font-semibold"},"User:",-1)),g(q,{user:o.user},null,8,["user"])]),t("div",Ee,[t("div",Le,[p[4]||(p[4]=t("label",{class:"block text-xs font-semibold"},"Date",-1)),ht(t("input",{type:"date","onUpdate:modelValue":p[0]||(p[0]=y=>k.value=y),class:"border py-2 px-4 rounded-md",size:"8"},null,512),[[Tt,k.value]])])]),t("div",Me,[c.value?(n(),l("div",Ae,b(c.value),1)):v("",!0)]),t("div",Ne,[p[5]||(p[5]=t("div",null,[t("button",{class:"btn-2"},"Submit")],-1)),t("button",{class:"btn-3",onClick:p[1]||(p[1]=$(y=>i("closeClick"),["prevent"]))},"Close")])],32))}},Re={class:"container mx-auto p-6"},je={key:2,class:"max-w-8xl min-h-64 mx-auto bg-white shadow-lg rounded-lg p-6 relative"},Fe={class:"grid grid-cols-4"},Be={class:"mb-4 flex col-span-full"},Ge={class:"font-medium text-xl"},qe={class:"flex items-center gap-2 text-xs text-gray-500 mt-2 opacity-80 text-left"},He={key:0,class:"text-xs px-2 py-0.5 rounded-full border bg-yellow-800 text-white"},Ve={key:1,class:"text-xs px-2 py-0.5 rounded-full border bg-red-500 text-white"},We={class:"text-right col-span-full md:col-span-1 ml-auto flex items-start justify-center gap-4 !text-lg"},ze={class:"col-span-full"},Je=["innerHTML"],Ke={class:"mt-4 col-span-full mb-6"},Qe={class:"ml-auto text-right text-sm col-span-full"},Xe={key:1,class:"text-gray-500"},Ye={class:"font-semibold text-green-800"},Ze={key:2,class:"ml-4 text-gray-500"},ts={class:"text-red-500 font-semibold"},es={class:"mt-6 py-2 flex justify-center items-center gap-2 col-span-full"},ss=["disabled"],as={class:"ml-auto flex gap-4"},ns=["disabled"],os=["disabled"],rs={key:0},ls={key:1},is={key:1,class:"text-center py-4 text-red-500"},Ds={__name:"TaskShow",setup(o){const e=At(),a=ft(),i=$t(),m=P(""),k=yt(),c=I(()=>e.tasks),f=P({}),d=P(!0);kt(async()=>{m.value="loading",await y(a.params.id),m.value=""});const p=B({user:null,type:""});async function y(S){await e.fetchTask(S)}const C=I(()=>bt(e.task.users,e.task.task_reports||[])),_=I(()=>j(e.task.started_at)),s=I(()=>j(e.task.deadline));function x(S){p.user=k.user,p.type=S}async function F(){await y(a.params.id),p.user=null,p.type=""}const U=S=>{i.push({name:"TaskEdit",params:{id:S}})},vt=I(()=>{var S,u;return e.task?((S=e.task)==null?void 0:S.parent_id)==0?{name:a.name==="MyTaskShow"?"MyTaskList":"TaskList"}:{params:{id:(u=e.task)==null?void 0:u.parent_id}}:null});return mt(()=>a.params.id,async S=>{m.value="changing",await y(S),m.value=""}),(S,u)=>{var H,V,W,z,J,K,Q,X,Y,Z,tt,et,st,at,nt,ot,rt,lt,it;const N=pt("RouterLink"),xt=pt("router-view");return n(),l("div",Re,[p.user?(n(),D(A,{key:0},{default:w(()=>[g(Oe,{task:r(e).task,user:p.user,type:p.type,onCloseClick:u[0]||(u[0]=h=>p.user=null),onUpdateDate:F},null,8,["task","user","type"])]),_:1})):v("",!0),m.value==="loading"?(n(),D(G,{key:1})):(n(),l("div",je,[r(e).task?(n(),l(E,{key:0},[t("section",Fe,[t("div",Be,[t("div",null,[t("h2",Ge,b(r(e).task.title),1),t("div",qe,[(H=r(e).task)!=null&&H.is_important?(n(),l("span",He,"IMPORTANT")):v("",!0),(V=r(e).task)!=null&&V.is_urgent?(n(),l("span",Ve,"URGENT")):v("",!0)])]),t("div",We,[g(It,{status:(W=r(e).task)==null?void 0:W.status,progressPercent:(z=r(e).task)==null?void 0:z.progress_percent,class:"h-6 !text-lg"},null,8,["status","progressPercent"]),r(e).task?(n(),D(Dt,{key:0,task:r(e).task,ref_key:"progress",ref:f,class:"!text-lg"},null,8,["task"])):v("",!0)])]),t("div",ze,[t("p",{innerHTML:(J=r(e).task)==null?void 0:J.description,class:L(["text-gray-700",{"line-clamp-3":d.value}])},null,10,Je),((Q=(K=r(e).task)==null?void 0:K.description)==null?void 0:Q.length)>=600?(n(),l("button",{key:0,class:"text-blue-500 mt-2",onClick:u[1]||(u[1]=$(h=>d.value=!d.value,["prevent"]))}," Show "+b(d.value?"More":"Less"),1)):v("",!0)]),g(Pt,{task:(X=r(e))==null?void 0:X.task,"tree-level":(Z=(Y=r(e))==null?void 0:Y.task)==null?void 0:Z.level},null,8,["task","tree-level"]),t("section",Ke,[g(pe,{"task-users":((tt=r(e).task)==null?void 0:tt.users)||[],task:r(e).task,"sub-tasks":r(e).tasks,"progress-users":C.value},{caption:w(()=>u[14]||(u[14]=[t("div",{class:"text-sm py-1 text-left uppercase font-semibold text-gray-600"}," Assigned Users ",-1)])),_:1},8,["task-users","task","sub-tasks","progress-users"])]),t("div",Qe,[r(e).task.deadline?(n(),D(jt,{key:0,targetDateTime:r(e).task.deadline,class:"text-lg font-semibold italic text-green-600"},null,8,["targetDateTime"])):v("",!0),_.value?(n(),l("span",Xe,[u[15]||(u[15]=T(" Started: ")),t("span",Ye,b(_.value),1)])):v("",!0),s.value?(n(),l("span",Ze,[u[16]||(u[16]=T(" Deadline: ")),t("span",ts,b(s.value),1)])):v("",!0)]),g(Se,{task:((et=r(e))==null?void 0:et.task)||{},class:"col-span-full",onUpdateStatus:u[2]||(u[2]=h=>{var M,dt;return y((dt=(M=r(e))==null?void 0:M.task)==null?void 0:dt.id)})},null,8,["task"]),t("div",es,[t("button",{onClick:u[3]||(u[3]=$(h=>{var M;return U((M=r(e).task)==null?void 0:M.id)},["stop"])),class:"btn-2 py-0.5 disabled:opacity-30 disabled:pointer-events-none",disabled:!!r(e).task.closed_at}," Edit ",8,ss),g(N,{to:{name:"TaskUserAssign",params:{id:(st=r(e).task)==null?void 0:st.id}},class:L(["bg-indigo-500 hover:bg-indigo-600 text-white font-semibold px-3 py-0.5 rounded-full transition",r(e).task.closed_at?"opacity-30 pointer-events-none":""]),onClick:u[4]||(u[4]=h=>h.stopPropagation())},{default:w(()=>u[17]||(u[17]=[t("i",{class:"fas fa-user-plus"},null,-1),T(" Assign Users ")])),_:1,__:[17]},8,["to","class"]),g(N,{to:vt.value,class:"bg-indigo-500 hover:bg-indigo-600 text-white font-semibold px-3 py-0.5 rounded-full transition disabled:opacity-30 disabled:pointer-events-none",onClick:u[5]||(u[5]=h=>h.stopPropagation())},{default:w(()=>u[18]||(u[18]=[t("i",{class:"fas fa-arrow-left"},null,-1),T(" Back ")])),_:1,__:[18]},8,["to"]),t("div",as,[((at=r(e).task)==null?void 0:at.children_task_count)===0?(n(),l(E,{key:0},[t("button",{class:"btn-3 px-3 py-0.5 text-sm h-8 font-semibold border disabled:opacity-30 disabled:pointer-events-none",onClick:u[6]||(u[6]=$(()=>x("start-date"),["prevent"])),disabled:!!((nt=S.authUserProgress)!=null&&nt.started_at)||!!r(e).task.closed_at}," Set Started Date ",8,ns),t("button",{class:"btn-3 px-3 py-0.5 text-sm h-8 font-semibold border disabled:opacity-30 disabled:pointer-events-none",onClick:u[7]||(u[7]=$(()=>x("finish-date"),["prevent"])),disabled:!!((ot=S.authUserProgress)!=null&&ot.finished_at)||!!r(e).task.closed_at}," Set Finish Date ",8,os)],64)):v("",!0),c.value.length>0?(n(),D(N,{key:1,to:{params:{id:(rt=r(e).task)==null?void 0:rt.id}},onClick:u[8]||(u[8]=h=>h.stopPropagation()),class:L(["py-0.5 btn-3 ml-auto text-sm h-8",{"bg-blue-500 text-white":r(a).name=="TaskShow"||r(a).name==="MyTaskShow"}])},{default:w(()=>u[19]||(u[19]=[t("i",{class:"fal fa-list-ul"},null,-1),T(" Sub Tasks ")])),_:1,__:[19]},8,["to","class"])):v("",!0),g(N,{to:{name:"TaskReports",params:{id:(lt=r(e).task)==null?void 0:lt.id}},onClick:u[9]||(u[9]=h=>h.stopPropagation()),class:L(["py-0.5 btn-3 text-sm h-8",{"bg-blue-500 text-white":r(a).name=="TaskReports"}])},{default:w(()=>u[20]||(u[20]=[t("i",{class:"fal fa-file-alt"},null,-1),T(" Reports ")])),_:1,__:[20]},8,["to","class"])])])]),(r(a).name=="TaskShow"||r(a).name==="MyTaskShow")&&((it=r(e).task)==null?void 0:it.level)<=2?(n(),l("section",rs,[g(Jt,{subTasks:c.value,"parent-id":r(a).params.id,"tree-level":r(e).task.level+1,onCreated:u[10]||(u[10]=h=>y(r(a).params.id)),onUpdated:u[11]||(u[11]=h=>y(r(a).params.id)),onUpdatePriority:u[12]||(u[12]=h=>y(r(a).params.id)),onAssignUser:u[13]||(u[13]=h=>y(r(a).params.id)),"sub-task-is-creatable":!r(e).task.closed_at},null,8,["subTasks","parent-id","tree-level","sub-task-is-creatable"])])):(n(),l("section",ls,[g(xt)]))],64)):(n(),l("div",is,b(r(e).error),1)),m.value==="changing"?(n(),D(G,{key:2,class:"absolute bg-opacity-80 inset-0 z-20"})):v("",!0)]))])}}};export{Ds as default};
