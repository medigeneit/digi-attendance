import{r as f,s as y,b as E,z as _,c as x,a as t,t as n,h as u,d as h,B as S,F as R,q as T,l as q,E as U,v as G,j as J,f as K,o as v,p as k,g as O}from"./index-CBLkaFAF.js";import{L as Q}from"./LoaderView-DJMLl3v_.js";import{_ as P}from"./MultiselectDropdown-BZcHXm8I.js";import{u as X}from"./attendance-Chtyys3s.js";import{u as Y}from"./company-BjbyqG4d.js";import{u as Z}from"./department-BUQV-WwZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue-multiselect.esm-DOCSzDtI.js";const I={class:"px-4 space-y-4"},tt={class:"flex items-center justify-between gap-2"},et={class:"title-md md:title-lg flex-wrap text-center"},st={class:"flex flex-wrap gap-4"},at=["value"],ot={key:1,class:"space-y-4"},lt={class:"overflow-x-auto card-bg"},nt={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},it={class:"text-center text-xs"},rt={class:"border px-1 py-0.5"},dt={class:"border px-1 py-0.5"},ut={class:"border px-1 py-0.5"},pt={class:"border px-1 py-0.5"},ct=["title"],vt=["title"],bt=["title"],ft={class:"border px-1 py-0.5"},xt={class:"border px-1 py-0.5"},_t={class:"border px-1 py-0.5"},wt={__name:"TodayAttendanceReport",setup(ht){var A;const D=O(),b=K(),m=Y(),V=Z(),i=X(),r=f(""),d=f(""),a=f(""),$=f(""),p=f(((A=b==null?void 0:b.query)==null?void 0:A.search)||""),o=f("all"),{companies:N,employees:W}=y(m),{departments:g}=y(V),{dailyLogs:F}=y(i),c=async()=>{(r.value||p.value)&&await i.getTodayAttendanceReport(r.value,d==null?void 0:d.value.id,a==null?void 0:a.value.id,o==null?void 0:o.value,i.selectedDate,p.value)};E(async()=>{await m.fetchCompanies(),await i.getTodayAttendanceReport(r.value,d==null?void 0:d.value.id,a==null?void 0:a.value.id,o==null?void 0:o.value,i.selectedDate,p.value)}),_([r,$],c),_(r,l=>{m.fetchEmployee(l),V.fetchDepartments(l)}),_(d,l=>{l!=null&&l.id&&c()}),_(a,l=>{l!=null&&l.id&&c()});const H=async()=>{await i.attendanceDownloadExcel(r.value,a==null?void 0:a.value.id,o==null?void 0:o.value,i.selectedDate,p.value)},M=async()=>{await i.attendanceDownloadPdf(r.value,a==null?void 0:a.value.id,o==null?void 0:o.value,i.selectedDate,p.value)},j=()=>D.go(-1);return _(p,l=>{D.push({query:{...b.query,search:l}})}),(l,s)=>{var C,w,L,B;return v(),x("div",I,[t("div",tt,[t("button",{class:"btn-3",onClick:j},s[6]||(s[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),t("h1",et," Daily "+n(((w=(C=u(b))==null?void 0:C.query)==null?void 0:w.search)==="all"?"Attendance":(B=(L=u(b))==null?void 0:L.query)==null?void 0:B.search)+" Report ",1),t("div",{class:"flex gap-4"},[t("button",{type:"button",onClick:H,class:"btn-1"},s[7]||(s[7]=[t("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)])),t("button",{type:"button",onClick:M,class:"btn-1"},s[8]||(s[8]=[t("i",{class:"fal fa-file-pdf text-2xl text-red-500"},null,-1)]))])]),t("div",st,[t("div",null,[h(t("select",{id:"userSelect","onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),onChange:c,class:"input-1"},[s[9]||(s[9]=t("option",{value:"",disabled:""},"Select a Company",-1)),(v(!0),x(R,null,T(u(N),e=>(v(),x("option",{key:e==null?void 0:e.id,value:e==null?void 0:e.id},n(e==null?void 0:e.name),9,at))),128))],544),[[S,r.value]])]),t("div",null,[q(P,{modelValue:d.value,"onUpdate:modelValue":s[1]||(s[1]=e=>d.value=e),options:u(g),multiple:!1,placeholder:"Select department"},null,8,["modelValue","options"])]),t("div",null,[q(P,{modelValue:a.value,"onUpdate:modelValue":s[2]||(s[2]=e=>a.value=e),options:u(W),multiple:!1,placeholder:"Select employee"},null,8,["modelValue","options"])]),t("div",null,[h(t("select",{id:"userSelect","onUpdate:modelValue":s[3]||(s[3]=e=>o.value=e),onChange:c,class:"input-1"},s[10]||(s[10]=[U('<option value="all">All Category</option><option value="executive">Executive</option><option value="support_staff">Support Staff</option><option value="doctor">Doctor</option><option value="academy_body">Academy Body</option>',5)]),544),[[S,o.value]])]),t("div",null,[h(t("select",{id:"userSelect","onUpdate:modelValue":s[4]||(s[4]=e=>p.value=e),onChange:c,class:"input-1"},s[11]||(s[11]=[U('<option value="all">All Status</option><option value="Present">Present</option><option value="Absent">Absent</option><option value="Weekend">Weekend</option><option value="Holiday">Holiday</option><option value="Leave">Leave</option>',6)]),544),[[S,p.value]])]),t("div",null,[h(t("input",{type:"date","onUpdate:modelValue":s[5]||(s[5]=e=>u(i).selectedDate=e),onChange:c,class:"input-1"},null,544),[[G,u(i).selectedDate]])])]),u(i).isLoading?(v(),J(Q,{key:0})):(v(),x("div",ot,[t("div",lt,[t("table",nt,[s[12]||(s[12]=t("thead",null,[t("tr",{class:"bg-gray-200 text-xs"},[t("th",{class:"border p-1"},"#"),t("th",{class:"border p-1"},"Emp/Worker Name"),t("th",{class:"border p-1"},"Date"),t("th",{class:"border p-1"},"Day"),t("th",{class:"border p-1"},"Shift"),t("th",{class:"border p-1"},"Entry Time"),t("th",{class:"border p-1"},"Exit Time"),t("th",{class:"border p-1"},"Working Hours"),t("th",{class:"border p-1"},"Late Entry"),t("th",{class:"border p-1"},"Early Leave"),t("th",{class:"border p-1"},"Status")])],-1)),t("tbody",it,[(v(!0),x(R,null,T(u(F),(e,z)=>(v(),x("tr",{key:e==null?void 0:e.date,class:"border-b hover:bg-blue-100"},[t("td",rt,n(z+=1),1),t("td",dt,n(e.user_name),1),t("td",ut,n(e.date),1),t("td",pt,n(e.weekday),1),t("td",{class:"border px-1 py-0.5",title:`${e.shift_start_time} to ${e.shift_end_time}`},n(e.shift_name),9,ct),t("td",{class:k(["border px-1 py-0.5",{"bg-red-200":e.late_duration}]),title:`Device: ${e.entry_device}`},n(e.entry_time),11,vt),t("td",{class:k(["border px-1 py-0.5",{"bg-red-200":e.early_leave_duration}]),title:`Device: ${e.exit_device}`},n(e.exit_time),11,bt),t("td",ft,n(e.working_hours),1),t("td",xt,n(e.late_duration),1),t("td",_t,n(e.early_leave_duration),1),t("td",{class:k(["border px-1 py-0.5",{"text-red-600":e.status==="Absent","text-green-600":e.status==="Present"}])},n(e.status),3)]))),128))])])])]))])}}};export{wt as default};
