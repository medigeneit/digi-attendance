import{u as O,N as U,s as B,r as y,b as V,y as T,o as s,c as _,a as n,d as L,v as q,e as d,t as j,h as A,F as G,x as Z,q as K,l as Q,k as m,n as I,g as W,f as X,p as Y}from"./index-BMjnsKM_.js";import{u as P}from"./leave-application-BHxKkP24.js";import{u as M}from"./exchange-CSrt6qrv.js";import{u as ee}from"./manual-attendance-BRCLNeVI.js";import{u as ae}from"./short-leave-D5X71TvW.js";const te={key:0,class:"text-center space-y-2 print:hidden"},oe={key:0,class:"modal-bg"},ne={class:"modal-card"},re={class:"flex justify-end gap-2 mt-4"},se={key:1,class:"mt-2"},le={class:"flex justify-end gap-2 pt-2"},ie={__name:"ExchangeApplicationApprovalSection",props:{application:Object,notificationId:{type:String,required:!0}},setup(C){const g=O(),f=U(),b=M(),{user:S}=B(g),x=C,r=y(null);V(()=>{r.value=JSON.parse(JSON.stringify(x.application))});const i=y(!1),p=y(""),c=y(!1),t=y("");function u(){c.value=!0,i.value=!1}const h=[{key:"handover",approved_field:"handover_user_id",approved_by_field:null,label:"Handover",action:async a=>{await b.handoverAccept({id:a,note:t.value}),await v(),c.value=!1},condition:()=>{var a,o;return!((a=r.value)!=null&&a.status)&&((o=r.value)==null?void 0:o.handover_user_id)===S.value.id}},{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await b.inChargeAccept({id:a,note:t.value}),await v(),c.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await b.recommendByAccept({id:a,note:t.value}),await v(),c.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await b.approvedByAccept({id:a,note:t.value}),await v(),c.value=!1}}],e=T(()=>h.find(a=>{var o,l,k,w;return r.value?a.key==="handover"?a.condition():((o=r.value)==null?void 0:o.status)!=="Rejected"&&((l=r.value)==null?void 0:l.status)!=="Approved"&&!((k=r.value)!=null&&k[a.approved_field])&&((w=r.value)==null?void 0:w[a.approved_by_field])===S.value.id:!1})),R=()=>{i.value&&p.value?($(),i.value=!1):i.value=!0};async function $(){try{await b.rejectExchange(r.value.id,p.value),alert("Exchange application rejected!"),p.value="",await v(r.value.id)}catch(a){alert(a.message||"Something went wrong!")}}async function v(){await f.markAsRead(x.notificationId)}return(a,o)=>e.value&&r.value?(s(),_("div",te,[c.value?(s(),_("div",oe,[n("div",ne,[o[4]||(o[4]=n("h3",{class:"title-lg"},"Accept Application",-1)),L(n("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,t.value]]),n("div",re,[n("button",{class:"btn-3",onClick:o[1]||(o[1]=l=>c.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:o[2]||(o[2]=l=>e.value.action(r.value.id))}," Confirm ")])])])):d("",!0),i.value?(s(),_("div",se,[L(n("textarea",{"onUpdate:modelValue":o[3]||(o[3]=l=>p.value=l),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter accept note"},null,512),[[q,p.value]])])):d("",!0),n("div",le,[i.value?d("",!0):(s(),_("button",{key:0,class:"btn-2",onClick:u},"Approve")),n("button",{class:"btn-4 bg-red-500 text-white",onClick:R},"Reject")])])):d("",!0)}},ce={class:"text-center space-y-2 print:hidden"},de={key:0,class:"modal-bg"},ue={class:"modal-card"},pe={class:"flex justify-end gap-2 mt-4"},ve={key:1,class:"mt-2"},_e={class:"flex justify-end gap-2 pt-2"},fe={__name:"LeaveApplicationApprovalSection",props:{application:{type:Object,required:!0},notificationId:{type:String,required:!0}},setup(C){const g=O(),f=P(),b=U(),{user:S}=B(g),x=C,r=y(null);V(()=>{r.value=JSON.parse(JSON.stringify(x.application))});const i=y(!1),p=y(""),c=y(!1),t=y("");function u(){i.value=!0,c.value=!1}const h=[{key:"handover",approved_field:"handover_user_id",approved_by_field:null,label:"Handover",action:async a=>{await f.acceptHandover({id:a,note:p.value}),await v(),i.value=!1},condition:()=>{var a,o;return!((a=r.value)!=null&&a.status)&&((o=r.value)==null?void 0:o.handover_user_id)===S.value.id}},{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await f.acceptInCharge({id:a,note:p.value}),await v(),i.value=!1}},{key:"coordinator",approved_field:"coordinator_user_id",approved_by_field:"approval_coordinator_user_id",label:"Coordinator",action:async a=>{await f.acceptCoordinator({id:a,note:p.value}),await v(),i.value=!1}},{key:"operational_admin",approved_field:"operational_admin_user_id",approved_by_field:"approval_operational_admin_user_id",label:"Operational Admin",action:async a=>{await f.acceptOperationalAdmin({id:a,note:p.value}),await v(),i.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await f.acceptRecommendBy({id:a,note:p.value}),await v(),i.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await f.acceptApprovedBy({id:a,note:p.value}),await v(),i.value=!1}}],e=T(()=>h.find(a=>{var k,w,N,E;if(!r.value)return!1;if(a.key==="handover")return a.condition();const o=!!((k=r.value)!=null&&k[a.approved_field]),l=((w=r.value)==null?void 0:w[a.approved_by_field])===S.value.id;return((N=r.value)==null?void 0:N.status)!=="Rejected"&&((E=r.value)==null?void 0:E.status)!=="Approved"&&!o&&l})),R=()=>{c.value&&t.value?($(),c.value=!1):c.value=!0};async function $(){try{await f.rejectLeaveApplication(r.value.id,{rejection_reason:t.value}),alert("Application rejected!"),t.value="",await v()}catch(a){alert(a.message||"Something went wrong!")}}async function v(){await b.markAsRead(x.notificationId)}return(a,o)=>(s(),_("div",ce,[i.value?(s(),_("div",de,[n("div",ue,[o[4]||(o[4]=n("h3",{class:"title-lg"},"Accept Application",-1)),L(n("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>p.value=l),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,p.value]]),n("div",pe,[n("button",{class:"btn-3",onClick:o[1]||(o[1]=l=>i.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:o[2]||(o[2]=l=>e.value.action(r.value.id))}," Confirm ")])])])):d("",!0),c.value?(s(),_("div",ve,[L(n("textarea",{"onUpdate:modelValue":o[3]||(o[3]=l=>t.value=l),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter accept note"},null,512),[[q,t.value]])])):d("",!0),n("div",_e,[c.value?d("",!0):(s(),_("button",{key:0,class:"btn-2",onClick:u},"Approve")),n("button",{class:"btn-1",onClick:R},"Reject")])]))}},ye={key:0,class:"text-center space-y-2 print:hidden"},he={key:0,class:"modal-bg"},ge={class:"modal-card"},be={class:"flex justify-end gap-2 mt-4"},ke={key:1,class:"mt-2"},we={class:"flex justify-end gap-2 pt-2"},xe={__name:"ManualAttendanceApprovalSection",props:{application:{type:Object,required:!0},notificationId:{type:String,required:!0}},setup(C){const g=O(),f=ee(),b=U(),{user:S}=B(g),x=C,r=y(null);V(()=>{r.value=JSON.parse(JSON.stringify(x.application))});const i=y(!1),p=y(""),c=y(!1),t=y("");function u(){c.value=!0,i.value=!1}const h=[{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await f.inChargeAccept({id:a,note:t.value}),await v(),c.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await f.recommendByAccept({id:a,note:t.value}),await v(),c.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await f.approvedByAccept({id:a,note:t.value}),await v(),c.value=!1}}],e=T(()=>h.find(a=>{var k,w,N,E;if(!r.value)return!1;if(a.key==="handover")return a.condition();const o=!!((k=r.value)!=null&&k[a.approved_field]),l=((w=r.value)==null?void 0:w[a.approved_by_field])===S.value.id;return((N=r.value)==null?void 0:N.status)!=="Rejected"&&((E=r.value)==null?void 0:E.status)!=="Approved"&&!o&&l})),R=()=>{i.value&&p.value?($(),i.value=!1):i.value=!0};async function $(){try{await f.rejectLeaveApplication(r.value.id,{rejection_reason:p.value}),alert("Application rejected!"),p.value="",await v(r.value.id)}catch(a){alert(a.message||"Something went wrong!")}}async function v(a){await b.markAsRead(x.notificationId)}return(a,o)=>e.value&&r.value?(s(),_("div",ye,[c.value?(s(),_("div",he,[n("div",ge,[o[4]||(o[4]=n("h3",{class:"title-lg"},"Accept Application",-1)),L(n("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,t.value]]),n("div",be,[n("button",{class:"btn-3",onClick:o[1]||(o[1]=l=>c.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:o[2]||(o[2]=l=>e.value.action(r.value.id))}," Confirm ")])])])):d("",!0),i.value?(s(),_("div",ke,[L(n("textarea",{"onUpdate:modelValue":o[3]||(o[3]=l=>p.value=l),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter accept note"},null,512),[[q,p.value]])])):d("",!0),n("div",we,[i.value?d("",!0):(s(),_("button",{key:0,class:"btn-2",onClick:u},"Approve")),n("button",{class:"btn-1",onClick:R},"Reject")])])):d("",!0)}},Ae={key:0,class:"text-center space-y-2 print:hidden"},Se={key:0,class:"modal-bg"},$e={class:"modal-card"},me={class:"flex justify-end gap-2 mt-4"},je={key:1,class:"mt-2"},Ce={class:"flex justify-end gap-2 pt-2"},Re={__name:"ShortLeaveApplicationApprovalSection",props:{application:{type:Object,required:!0},notificationId:{type:String,required:!0}},setup(C){const g=O(),f=ae(),b=U(),{user:S}=B(g),x=C,r=y(null);V(()=>{r.value=JSON.parse(JSON.stringify(x.application))});const i=y(!1),p=y(""),c=y(!1),t=y("");function u(){c.value=!0,i.value=!1}const h=[{key:"handover",approved_field:"handover_user_id",approved_by_field:null,label:"Handover",action:async a=>{await f.handoverAccept({id:a,note:t.value}),await v(),c.value=!1},condition:()=>{var a,o;return!((a=r.value)!=null&&a.status)&&((o=r.value)==null?void 0:o.handover_user_id)===S.value.id}},{key:"in_charge",approved_field:"in_charge_user_id",approved_by_field:"approval_in_charge_user_id",label:"In-Charge",action:async a=>{await f.inChargeAccept({id:a,note:t.value}),await v(),c.value=!1}},{key:"recommend_by",approved_field:"recommend_by_user_id",approved_by_field:"approval_recommend_by_user_id",label:"Recommend By",action:async a=>{await f.recommendByAccept({id:a,note:t.value}),await v(),c.value=!1}},{key:"approved_by",approved_field:"approved_by_user_id",approved_by_field:"approval_approved_by_user_id",label:"Approved By",action:async a=>{await f.approvedByAccept({id:a,note:t.value}),await v(),c.value=!1}}],e=T(()=>h.find(a=>{var o,l,k,w;return r.value?a.key==="handover"?a.condition():((o=r.value)==null?void 0:o.status)!=="Rejected"&&((l=r.value)==null?void 0:l.status)!=="Approved"&&!((k=r.value)!=null&&k[a.approved_field])&&((w=r.value)==null?void 0:w[a.approved_by_field])===S.value.id:!1})),R=()=>{i.value&&p.value?($(),i.value=!1):i.value=!0};async function $(){try{await f.rejectShortLeave(r.value.id,p.value),alert("Application rejected!"),p.value="",await v(r.value.id)}catch(a){alert(a.message||"Something went wrong!")}}async function v(){await b.markAsRead(x.notificationId)}return(a,o)=>e.value&&r.value?(s(),_("div",Ae,[c.value?(s(),_("div",Se,[n("div",$e,[o[4]||(o[4]=n("h3",{class:"title-lg"},"Accept Application Note",-1)),L(n("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[q,t.value]]),n("div",me,[n("button",{class:"btn-3",onClick:o[1]||(o[1]=l=>c.value=!1)},"Cancel"),n("button",{class:"btn-2 bg-red-500 text-white",onClick:o[2]||(o[2]=l=>e.value.action(r.value.id))}," Confirm ")])])])):d("",!0),i.value?(s(),_("div",je,[L(n("textarea",{"onUpdate:modelValue":o[3]||(o[3]=l=>p.value=l),class:"w-full border rounded-md p-2 text-sm",placeholder:"Enter accept note"},null,512),[[q,p.value]])])):d("",!0),n("div",Ce,[i.value?d("",!0):(s(),_("button",{key:0,class:"btn-2",onClick:u},"Approve")),n("button",{class:"btn-1",onClick:R},j(i.value?"Submit":"Reject"),1)])])):d("",!0)}},Ne={class:"space-y-6 px-4 py-4"},Ee={class:"text-2xl font-semibold capitalize text-gray-700"},Le={key:0,class:"space-y-4"},qe={class:"flex items-start gap-4"},Ie={class:"text-2xl text-blue-500"},Be={class:"flex-1"},Oe={class:"flex items-center gap-8"},Ue={class:"text-gray-800 font-medium"},Ve={key:0,class:"flex gap-2 text-sm btn-4"},Te={key:0,class:"text-gray-800 font-medium"},Je={class:"text-red-600 text-sm font-semibold"},De={key:1,class:"text-xs text-gray-400"},He={key:0,class:"grid gap-1"},ze={class:"flex items-center gap-4"},Fe=["href"],Pe={class:"grow-0 w-full"},Ge={key:0,class:"text-xs font-semibold"},Ze={class:"text-xs text-gray-400"},Ke={key:1,class:"text-center text-red-500 py-10 text-xl italic"},ea={__name:"NotificationList",setup(C){W();const g=X(),f=U(),{notifications:b}=B(f);P();const S=O();B(S),y(!1),y({}),y({}),V(()=>{f.fetchNotifications()});const x=(t,u)=>{if(!t)return"application not found";switch(u){case"leaveApplication":return`Last Office ( ${t.last_working_date} ) → Join Date ( ${t.resumption_date} )`;case"shortLeave":return`Short Leave on ${t.date} form ${c(t.start_time)??"N/A"} to ${t.end_time?c(t.end_time):"N/A"}`;case"shift":return t.exchange_type==="shift"?`Exchange (${t.exchange_type}) on ${t.current_date} (${(t==null?void 0:t.shift_name)??"No Shift"})`:`Exchange (${t.exchange_type})`;case"exchange":return`Exchange (${t.exchange_type}) on ${t.current_date} (${(t==null?void 0:t.shift_name)??"No Shift"})`;case"offday":return t.exchange_type==="offday"?`Exchange (Offday): ${t.current_date} → ${t.exchange_date}`:`Exchange (${t.exchange_type})`;case"manualAttendance":const h=t.check_in?p(t.check_in):null,e=t.check_out?p(t.check_out):null;return h&&e?`${t==null?void 0:t.reason} Checked in (${h}) → Checked out (${e})`:h?`${t==null?void 0:t.reason} Checked in (${h})`:e?`${t==null?void 0:t.reason} Checked out (${e})`:`${t==null?void 0:t.reason} No check-in or check-out data`;default:return"Unknown Event"}},r=t=>{switch(t){case"leaveApplication":return"fas fa-calendar-alt";case"shortLeave":return"fas fa-clock";case"manualAttendance":return"fas fa-clock";case"exchange":return"fas fa-random";case"offday":return"fas fa-random";default:return"fas fa-bell"}},i=t=>new Date(t).toLocaleString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});function p(t){const u={year:"numeric",month:"short",day:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0};return new Date(t).toLocaleString("en-US",u)}const c=t=>{const[u,h]=t.split(":").map(Number),e=new Date;return e.setHours(u,h),e.toLocaleString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};return(t,u)=>{const h=Y("RouterLink");return s(),_("div",Ne,[n("h2",Ee,j(A(g).query.type.replace(/([A-Z])/g," $1")),1),Array.isArray(A(b)[A(g).query.type])&&A(b)[A(g).query.type].length?(s(),_("div",Le,[(s(!0),_(G,null,Z(A(b)[A(g).query.type],(e,R)=>{var $,v,a,o,l,k,w,N,E,J,D,H,z,F;return s(),_("div",{key:e.id,class:"bg-white p-4 rounded-xl shadow border"},[n("div",qe,[n("div",Ie,[n("i",{class:K(r(e.event_type))},null,2)]),n("div",Be,[n("div",Oe,[n("p",Ue,j(($=e.event_model)==null?void 0:$.user_name),1),e!=null&&e.monthly_short_leave_count?(s(),_("p",Ve,[n("strong",null,"Pending: "+j((e==null?void 0:e.monthly_short_leave_count.Pending)||0),1),u[0]||(u[0]=Q("/ ")),n("strong",null,"Approved: "+j((e==null?void 0:e.monthly_short_leave_count.Approved)||0),1)])):d("",!0)]),(v=e.event_model)!=null&&v.reason?(s(),_("p",Te," Reason: "+j((a=e.event_model)==null?void 0:a.reason),1)):d("",!0),n("p",Je,j(x(e.event_model,e.event_type)),1),(o=e==null?void 0:e.event_model)!=null&&o.total_leave_days_without_week?(s(),_("p",De," Total Leave: "+j(e==null?void 0:e.event_model.total_leave_days_without_week)+" days ",1)):d("",!0)]),e!=null&&e.event_model?(s(),_("div",He,[n("div",ze,[e!=null&&e.event_model.attachment?(s(),_("a",{key:0,href:(l=e==null?void 0:e.event_model)==null?void 0:l.attachment,target:"_blank",class:"btn-1"},u[1]||(u[1]=[n("i",{class:"fad fa-link"},null,-1)]),8,Fe)):d("",!0),A(g).query.type==="leaveApplication"?(s(),m(h,{key:1,to:{name:"LeaveApplicationShow",params:{id:(k=e==null?void 0:e.event_model)==null?void 0:k.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[2]||(u[2]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),A(g).query.type==="shortLeave"?(s(),m(h,{key:2,to:{name:"ShortLeaveShow",params:{id:(w=e==null?void 0:e.event_model)==null?void 0:w.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[3]||(u[3]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),A(g).query.type==="exchange"?(s(),m(h,{key:3,to:{name:((N=e==null?void 0:e.event_model)==null?void 0:N.exchange_type)=="offday"?"ExchangeOffdayShow":"ExchangeShiftShow",params:{id:(E=e==null?void 0:e.event_model)==null?void 0:E.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[4]||(u[4]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),A(g).query.type==="offday"?(s(),m(h,{key:4,to:{name:"ExchangeOffdayShow",params:{id:(J=e==null?void 0:e.event_model)==null?void 0:J.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[5]||(u[5]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),A(g).query.type==="shift"?(s(),m(h,{key:5,to:{name:"ExchangeShiftShow",params:{id:(D=e==null?void 0:e.event_model)==null?void 0:D.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[6]||(u[6]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0),A(g).query.type==="manualAttendance"?(s(),m(h,{key:6,to:{name:"ManualAttendanceShow",params:{id:(H=e==null?void 0:e.event_model)==null?void 0:H.id},query:{notifyId:e==null?void 0:e.id}},class:"btn-4"},{default:I(()=>u[7]||(u[7]=[n("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"])):d("",!0)]),n("div",Pe,[(z=e==null?void 0:e.event_model)!=null&&z.type?(s(),_("p",Ge," Type : "+j((F=e==null?void 0:e.event_model)==null?void 0:F.type),1)):d("",!0),n("p",Ze,j(i(e.created_at)),1)])])):d("",!0)]),e!=null&&e.event_model&&e.event_type==="leaveApplication"?(s(),m(fe,{key:0,application:e.event_model,"notification-id":e.id},null,8,["application","notification-id"])):d("",!0),e!=null&&e.event_model&&e.event_type==="manualAttendance"?(s(),m(xe,{key:1,application:e.event_model,"notification-id":e.id},null,8,["application","notification-id"])):d("",!0),e!=null&&e.event_model&&e.event_type==="shortLeave"?(s(),m(Re,{key:2,application:e.event_model,"notification-id":e.id},null,8,["application","notification-id"])):d("",!0),e!=null&&e.event_model&&(e.event_type==="offday"||e.event_type==="shift"||e.event_type==="exchange")?(s(),m(ie,{key:3,application:e.event_model,notificationId:e.id},null,8,["application","notificationId"])):d("",!0)])}),128))])):(s(),_("div",Ke,"notifications not found."))])}}};export{ea as default};
