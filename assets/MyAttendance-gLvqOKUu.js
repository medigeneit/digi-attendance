import{u as R,r as W,x as z,b as I,z as G,c as i,a as t,t as r,d as J,v as K,k as n,h as a,j as c,F as Q,q as X,g as Y,o,l as Z,m as v,e as _,p as h,n as tt}from"./index-BMFUpxpI.js";import{L as et}from"./LoaderView-BjA5IgTC.js";import{u as st}from"./attendance-CClJWpEm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const rt={class:"px-4 space-y-4"},nt={class:"md:flex items-center justify-between gap-2"},at={class:"title-lg md:title-lg flex-wrap text-center"},ot={class:"flex gap-4"},lt={class:"grid md:grid-cols-2 gap-4 text-sm"},dt={class:"card-bg p-4 gap-1"},it={class:"grid md:grid-cols-2"},ut={class:"card-bg p-4 gap-1"},pt={class:"grid md:grid-cols-2"},_t={key:1,class:"space-y-4"},mt={class:"overflow-x-auto card-bg"},yt={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},ct={class:"text-center text-xs"},vt={class:"border px-1 py-0.5"},ht={class:"border px-1 py-0.5"},xt=["title"],bt=["title"],ft=["title"],kt={key:0},wt={class:"border px-1 py-0.5"},At={class:"border px-1 py-0.5"},Dt={class:"border px-1 py-0.5"},St={key:0},gt={class:"border px-1 py-0.5"},Lt={key:0},Pt={__name:"MyAttendance",setup(Mt){const x=Y(),d=R(),l=st(),u=W(l.selectedMonth),$=z(()=>{if(!u.value)return"";const[p,s]=u.value.split("-");return new Date(p,s-1).toLocaleDateString("en-US",{month:"long",year:"numeric"})}),y=async()=>{var p;(p=d.user)!=null&&p.id&&u.value&&await l.getMonthlyAttendanceByShift(d.user.id,u.value)};I(async()=>{d.isAuthenticated?(await d.fetchUser(),y()):x.push("/login")}),G(u,async p=>{l.selectedMonth=p,await y()});const F=()=>x.go(-1);return(p,s)=>{var b,f,k,w,A,D,S,g,L,M,T,C,B,E,P,N,V,j,q,H,O,U;const m=tt("router-link");return o(),i("div",rt,[t("div",nt,[t("button",{class:"btn-3",onClick:F},s[1]||(s[1]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),t("h1",at," My Attendance of "+r($.value),1),t("div",ot,[t("div",null,[J(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),onChange:y,class:"input-1"},null,544),[[K,u.value]])])])]),t("div",lt,[t("div",dt,[s[8]||(s[8]=t("h2",{class:"title-md"},"User Info",-1)),s[9]||(s[9]=t("hr",null,null,-1)),t("div",it,[t("p",null,[s[2]||(s[2]=t("strong",null,"Name:",-1)),n(" "+r((b=a(d).user)==null?void 0:b.name),1)]),t("p",null,[s[3]||(s[3]=t("strong",null,"Designation:",-1)),n(" "+r((k=(f=a(d).user)==null?void 0:f.designation)==null?void 0:k.title),1)]),t("p",null,[s[4]||(s[4]=t("strong",null,"Department:",-1)),n(" "+r((A=(w=a(d).user)==null?void 0:w.department)==null?void 0:A.name),1)]),t("p",null,[s[5]||(s[5]=t("strong",null,"Company:",-1)),n(" "+r((S=(D=a(d).user)==null?void 0:D.company)==null?void 0:S.name),1)]),t("p",null,[s[6]||(s[6]=t("strong",null,"Phone:",-1)),n(" "+r((g=a(d).user)==null?void 0:g.phone),1)]),t("p",null,[s[7]||(s[7]=t("strong",null,"Email:",-1)),n(" "+r((L=a(d).user)==null?void 0:L.email),1)])])]),t("div",ut,[s[16]||(s[16]=t("h2",{class:"title-md"},"Attendance Summary",-1)),s[17]||(s[17]=t("hr",null,null,-1)),t("div",pt,[t("p",null,[s[10]||(s[10]=t("strong",null,"Total Working Days:",-1)),n(" "+r((T=(M=a(l))==null?void 0:M.summary)==null?void 0:T.total_working_days),1)]),t("p",null,[s[11]||(s[11]=t("strong",null,"Present Days:",-1)),n(" "+r((B=(C=a(l))==null?void 0:C.summary)==null?void 0:B.total_present_days),1)]),t("p",null,[s[12]||(s[12]=t("strong",null,"Absent Days:",-1)),n(" "+r((P=(E=a(l))==null?void 0:E.summary)==null?void 0:P.total_absent_days),1)]),t("p",null,[s[13]||(s[13]=t("strong",null,"Late Days:",-1)),n(" "+r((V=(N=a(l))==null?void 0:N.summary)==null?void 0:V.total_late_days),1)]),t("p",null,[s[14]||(s[14]=t("strong",null,"Total Working Hours:",-1)),n(" "+r((q=(j=a(l))==null?void 0:j.summary)==null?void 0:q.total_working_hours),1)]),t("p",null,[s[15]||(s[15]=t("strong",null,"Total Overtime Hours:",-1)),n(" "+r((O=(H=a(l))==null?void 0:H.summary)==null?void 0:O.total_overtime_hours),1)])])])]),a(l).isLoading?(o(),c(et,{key:0})):(o(),i("div",_t,[t("div",mt,[t("table",yt,[s[21]||(s[21]=t("thead",null,[t("tr",{class:"bg-gray-200 text-xs"},[t("th",{class:"border p-1"},"Date"),t("th",{class:"border p-1"},"Day"),t("th",{class:"border p-1"},"Shift"),t("th",{class:"border p-1"},"Entry Time"),t("th",{class:"border p-1"},"Exit Time"),t("th",{class:"border p-1"},"Working Hours"),t("th",{class:"border p-1"},"OT Hours"),t("th",{class:"border p-1"},"Late Entry"),t("th",{class:"border p-1"},"Early Leave"),t("th",{class:"border p-1"},"Status")])],-1)),t("tbody",ct,[(o(!0),i(Q,null,X((U=a(l))==null?void 0:U.monthlyLogs,e=>(o(),i("tr",{key:e==null?void 0:e.date,class:"hover:border-b-2 hover:border-gray-200 hover:bg-blue-200"},[t("td",vt,r(e.date),1),t("td",ht,r(e.weekday),1),t("td",{class:"border px-1 py-0.5",title:`${e.shift_start_time} to ${e.shift_end_time}`},r(e.shift_name),9,xt),t("td",{class:"border px-1 py-0.5",title:`Device: ${e.entry_device}`},r(e.entry_time),9,bt),t("td",{class:"border px-1 py-0.5",title:`Device: ${e.exit_device}`},[n(r(e.exit_time)+" ",1),!e.exit_time&&new Date(e.date)<new Date&&e.status==="Present"?(o(),i("div",kt,[Z(m,{to:{name:"ManualAttendanceAdd",query:{type:"Forget Punch",date:new Date(e.date).toISOString().split("T")[0],entry_time:e.entry_time,exit_time:e.exit_time}},class:"btn-link text-red-600"},{default:v(()=>s[18]||(s[18]=[n(" (Check Out Apply) ")])),_:2},1032,["to"])])):_("",!0)],8,ft),t("td",wt,r(e.working_hours),1),t("td",At,r(e.overtime_hours),1),t("td",Dt,[e.late_duration?(o(),i("div",St,[n(r(e.late_duration)+" ",1),e.first_short_leave?(o(),i("span",{key:0,class:h({"text-green-500":e.first_short_leave==="Approved","text-yellow-500":e.first_short_leave==="Pending","text-red-500":e.first_short_leave==="Rejected"})}," ("+r(e.first_short_leave)+") ",3)):_("",!0),e.late_duration&&!e.first_short_leave?(o(),c(m,{key:1,to:{name:"ShortLeaveAdd",query:{type:"Delay",start_time:e.shift_start_time,end_time:e.entry_time}},class:"btn-link text-red-600"},{default:v(()=>s[19]||(s[19]=[n(" (Apply) ")])),_:2},1032,["to"])):_("",!0)])):_("",!0)]),t("td",gt,[e.early_leave_duration?(o(),i("div",Lt,[n(r(e.early_leave_duration)+" ",1),e.last_short_leave?(o(),i("span",{key:0,class:h(["px-1",{"text-green-500":e.last_short_leave==="Approved","text-yellow-500":e.last_short_leave==="Pending","text-red-500":e.last_short_leave==="Rejected"}])}," ("+r(e.last_short_leave)+") ",3)):_("",!0),e.early_leave_duration&&!e.last_short_leave?(o(),c(m,{key:1,to:{name:"ShortLeaveAdd",query:{type:"Early",start_time:e.exit_time,end_time:e.shift_end_time}},class:"btn-link text-red-600"},{default:v(()=>s[20]||(s[20]=[n(" (Apply) ")])),_:2},1032,["to"])):_("",!0)])):_("",!0)]),t("td",{class:h(["border px-1 py-0.5 font-semibold",{"text-red-600":e.status==="Absent","text-green-600":e.status==="Present","text-yellow-600":e.is_overtime_applicable}])},r(e.status),3)]))),128))])])])]))])}}};export{Pt as default};
