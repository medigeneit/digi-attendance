import{G as pt,r as P,e as ct,H as gt,A as kt,c as u,o as a,g,a as t,t as b,I as R,j as w,d as mt,q as D,F as E,k as r,w as T,p as x,i as C,E as F,f as I,x as N,y as A,J as xt,K as dt,h as _t,v as ht,b as Tt,u as $t,n as ut}from"./index-BjcMy4hq.js";import{L as B}from"./LoaderView-BniDyQda.js";import{O as M}from"./OverlyModal-DlCK7_RI.js";import{a as Ct}from"./TaskAddForm-cLMe1686.js";import{_ as St}from"./TaskEditForm-Chew1ue0.js";import{_ as wt,a as It,b as Dt,c as Pt}from"./TaskTreeView-DvJ-Ja8H.js";import{a as Ut,_ as Et}from"./TaskUserAssignForm-XRd6xEMl.js";import{u as Lt,a as At}from"./task-priority-BPPsHj-t.js";import{g as j}from"./datetime-q3Sn87-f.js";import{_ as q}from"./UserChip-CRzHoLdV.js";import{u as Mt}from"./useTaskStore-CKDL9y9V.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./RequiredIcon-B5tUczQm.js";import"./company-B6mAsx1n.js";import"./useRequirementStore-BAPzDd8Y.js";import"./SectionLoading-qd6XIrqM.js";import"./TaskUrgencyInput-DnJnbHCQ.js";import"./MultiselectDropdown-CEbiNVRP.js";const Ot={key:0},Nt={key:0},Rt={key:1},jt=pt({__name:"CountdownTimer",props:{targetDateTime:{}},setup(i){const e=i,s=P(k());let o;function k(){const m=new Date(e.targetDateTime).getTime()-new Date().getTime(),v=Math.floor(m/1e3%60),d=Math.floor(m/1e3/60%60),c=Math.floor(m/(1e3*60*60)%24),y=Math.floor(m/(1e3*60*60*24));return{total:m,days:y,hours:c,minutes:d,seconds:v}}function p(){s.value=k()}return ct(()=>{o=setInterval(()=>{p(),s.value.total<=0&&clearInterval(o)},1e3)}),gt(()=>clearInterval(o)),kt(()=>e.targetDateTime,()=>{p(),clearInterval(o)}),(m,v)=>s.value.total>0?(a(),u("div",Ot,[s.value.days?(a(),u("span",Nt,b(s.value.days)+"d ",1)):g("",!0),t("span",null,b(s.value.hours.toString().padStart(2,"0"))+"h :",1),t("span",null,b(s.value.minutes.toString().padStart(2,"0"))+"m :",1),t("span",null,b(s.value.seconds.toString().padStart(2,"0"))+"s",1)])):(a(),u("div",Rt,[R(m.$slots,"expired",{},()=>[v[0]||(v[0]=w("Timeâ€™s up!"))])]))}}),Ft={class:"mb-3"},Bt={key:0,class:"flex gap-2 items-center mx-auto justify-center mb-2"},qt={key:1,class:"text-center py-4 text-gray-500"},Gt={key:2,class:"text-center py-4 text-red-500"},Ht={key:3,class:"space-y-4"},Vt={__name:"TaskList",props:{tasks:{default:null,type:Array},loading:{default:!1,type:Boolean},error:{default:"",type:String},parentId:{type:Number,default:0},treeLevel:{type:Number,required:!0}},emits:["commentButtonClick","editClick","addClick","updatePriority"],setup(i,{emit:e}){const s=i,o=mt(),k=D(()=>{var _;return!!(((_=o==null?void 0:o.user)==null?void 0:_.role)!=="employee"&&(o!=null&&o.isAdminMood))}),p=e,m=P(null),{handleItemsPriorityUpdate:v,saveTaskPriority:d,listHasRearranged:c}=Lt(()=>s.tasks,s.parentId),y=async()=>{await d(),p("updatePriority")};return(_,n)=>(a(),u("div",null,[t("div",Ft,[R(_.$slots,"task:header")]),k.value?(a(),u(E,{key:0},[r(c)?(a(),u("div",Bt,[n[4]||(n[4]=t("span",{class:"text-red-500"},"Priority Changed",-1)),t("button",{class:"btn-3",onClick:T(y,["prevent"])},"Save"),t("button",{class:"btn-3",onClick:n[0]||(n[0]=T((...f)=>m.value.resetItems&&m.value.resetItems(...f),["prevent"]))},"Discard")])):g("",!0)],64)):g("",!0),i.loading?(a(),u("div",qt,"Loading tasks...")):i.error?(a(),u("div",Gt,b(i.error),1)):(a(),u("div",Ht,[x(Ut,{items:i.tasks,handle:"handle",onItemsUpdate:r(v),class:"rounded-lg bg-white overflow-hidden space-y-3",ref_key:"draggableTaskList",ref:m},{item:C(({item:f,index:S})=>[x(wt,{index:S,task:f,showDraggableHandle:k.value,"tree-level":i.treeLevel,class:"!border-0",onCommentButtonClick:U=>p("commentButtonClick",f.id),onEditClick:n[1]||(n[1]=U=>p("editClick",U)),onAddClick:n[2]||(n[2]=U=>p("addClick",U)),onEmployeeAssignClick:n[3]||(n[3]=U=>p("employeeAssignClick",U))},null,8,["index","task","showDraggableHandle","tree-level","onCommentButtonClick"])]),_:1},8,["items","onItemsUpdate"])]))]))}},Wt={class:"flex justify-between mt-5"},zt={key:0,class:"flex flex-wrap items-center gap-2 mt-3"},Jt={__name:"SubTaskList",props:{subTasks:Array,parentId:{type:Number,required:!0},treeLevel:{type:Number,required:!0},subTaskIsCreatable:{type:Boolean,default:!0}},emits:["created","error","updatePriority","assignUser"],setup(i,{emit:e}){const s=i,o=F({taskId:0,isOpen:!1}),k=e,p=P(),m=F({show:!1,parentId:s.parentId,requirementId:null}),v=n=>{m.show=!0,m.parentId=n,console.log({addForm:m})};function d(){m.show=!1,m.parentId=s.parentId,k("created")}function c(){k("assignUser")}function y(){p.value=!1,k("updated")}function _(){m.show=!1,m.parentId=s.parentId}return(n,f)=>(a(),u("div",null,[p.value?(a(),I(M,{key:0},{default:C(()=>[x(St,{taskId:p.value,onClose:f[0]||(f[0]=S=>p.value=null),onUpdated:y},null,8,["taskId"])]),_:1})):g("",!0),m.show?(a(),I(M,{key:1},{default:C(()=>[x(Ct,{parentTaskId:m.parentId,requirementId:m.requirementId,onTaskCreated:d,onError:n.handleTaskError,onClose:_},null,8,["parentTaskId","requirementId","onError"])]),_:1})):g("",!0),o.isOpen?(a(),I(M,{key:2},{default:C(()=>[x(Et,{taskId:o.taskId,onCancelClick:f[1]||(f[1]=()=>{o.isOpen=!1,o.taskId=0}),onSuccess:f[2]||(f[2]=()=>{o.isOpen=!1,o.taskId=0,c()})},null,8,["taskId"])]),_:1})):g("",!0),x(Vt,{tasks:i.subTasks,parentId:i.parentId,treeLevel:i.treeLevel,onAddClick:f[4]||(f[4]=S=>v(S)),onEditClick:f[5]||(f[5]=S=>p.value=S),onUpdatePriority:f[6]||(f[6]=S=>k("updatePriority")),onEmployeeAssignClick:f[7]||(f[7]=S=>{o.taskId=S,o.isOpen=!0})},{"task:header":C(()=>[t("div",Wt,[f[8]||(f[8]=t("div",{class:"flex justify-between items-center"},[t("h2",{class:"text-2xl font-bold text-gray-800"},"Sub Tasks")],-1)),i.subTaskIsCreatable?(a(),u("div",zt,[t("button",{class:"btn-1 ml-auto",onClick:f[3]||(f[3]=T(()=>v(i.parentId),["prevent"]))}," Add Sub Task ")])):g("",!0)])]),_:1},8,["tasks","parentId","treeLevel"])]))}},Kt=i=>i==null?void 0:i.reduce((e,s)=>e+s.task_weight,0),ft=(i,e)=>{const s=Kt(i);return i.map(o=>{const k=e.filter(p=>p.user_id===o.id).reduce((p,m)=>p+m.progress,0);return{...o,task_progress:Math.floor(k*(o.task_weight/s)),user_progress:k}})},Qt=(i,e)=>{let s=0;const o=[],k=v=>v.status==="COMPLETED",p=v=>v.users.some(d=>d.id===e),m=(v,d)=>{v.forEach(c=>{const y=p(c);o[d]=o[d]||{user_id:e,total_assigned:0,total_assigned_on_leaf_task:0,completed_count:0};const _=y&&c.children_tasks.length===0;o[d].total_assigned+=y?1:0,o[d].total_assigned_on_leaf_task+=_?1:0,s+=_?1:0,y&&k(c)&&(o[d].completed_count++,c.children_tasks.length),c.children_tasks.length>0&&m(c.children_tasks,d+1)})};return m(i,0),{sub_task_infos:o,assigned_on_any_leaf_task:s>0}},Xt=(i,e)=>i.map(s=>({...s,...Qt(e,s.id)})),Yt={key:0,class:"min-w-full bg-white rounded overflow-hidden"},Zt={class:"py-0.5 text-bg font-semibold"},te={class:"bg-gray-50"},ee={class:"px-2 py-1 border-y"},se={class:"px-2 py-1 border-y"},ae={key:0,class:"text-sm text-gray-400"},ne={key:1},oe={key:1,class:"min-w-full bg-white rounded overflow-hidden"},re={class:"py-0.5 text-bg font-semibold"},le={class:"px-2 py-1 border-y text-center"},ie={class:"px-2 py-1 border-y border-r"},de={class:"px-2 py-1 border-y text-center"},ue={class:"px-2 py-1 border-y text-center"},pe=pt({__name:"TaskProgressTable",props:{task:{},subTasks:{}},setup(i){const e=i,s=D(()=>ft(e.task.users,e.task.task_reports||[])),o=D(()=>Xt(e.task.users,e.subTasks));return(k,p)=>{var m,v;return e.task.children_task_count>0?(a(),u("table",Yt,[t("caption",Zt,[R(k.$slots,"caption",{},()=>[p[0]||(p[0]=w("Progress"))])]),t("thead",te,[t("tr",null,[p[1]||(p[1]=t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-left"},"#",-1)),p[2]||(p[2]=t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-left lg:w-[200px]"}," User ",-1)),(a(!0),u(E,null,N(((v=(m=o.value[0]||{})==null?void 0:m.sub_task_infos)==null?void 0:v.length)||1,d=>(a(),u("th",{key:d,class:"px-2 py-1 border-y font-semibold text-xs uppercase text-center"},b(d===1?"Completed Sub Task":"")+" "+b(d===2?"Completed Sub Sub Task":"")+" "+b(d===3?"Completed Sub Sub Sub Task":""),1))),128))])]),t("tbody",null,[(a(!0),u(E,null,N(o.value,(d,c)=>(a(),u("tr",{key:d.id,class:"border-t hover:bg-gray-50 cursor-pointer"},[t("td",ee,b(c+1),1),t("td",se,[x(q,{user:d},null,8,["user"])]),(a(!0),u(E,null,N(d.sub_task_infos,(y,_)=>(a(),u("td",{class:"px-2 py-1 border-y text-center",key:_},[y.total_assigned===0||!d.assigned_on_any_leaf_task?(a(),u("div",ae," Not Assigned To Any Task ")):(a(),u("div",ne,b(y.completed_count)+" / "+b(y.total_assigned),1))]))),128))]))),128))])])):(a(),u("table",oe,[t("caption",re,[R(k.$slots,"caption",{},()=>[p[3]||(p[3]=w("Progress"))])]),p[4]||(p[4]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase w-[50px] text-center"},"#"),t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-left sm:w-[250px] mx:w-[300px] border-r"}," User "),t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-center"},"Started"),t("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-center"},"Finished")])],-1)),t("tbody",null,[(a(!0),u(E,null,N(s.value,(d,c)=>(a(),u("tr",{key:d.id,class:"border-t hover:bg-gray-50 cursor-pointer"},[t("td",le,b(c+1),1),t("td",ie,[x(q,{user:d},null,8,["user"])]),t("td",de,b(r(j)(d.task_started_at)),1),t("td",ue,b(r(j)(d.task_finished_at)),1)]))),128))])]))}}}),ce={class:"flex justify-center items-center"},ke={key:0,class:"flex flex-col justify-center items-center"},me={key:1},fe={key:2},ye={key:3,class:"flex flex-col justify-center items-center"},be={class:"border-b -mx-4 px-4 border -mt-4 py-2 text-xl bg-gray-50"},ve={class:"my-6"},ge={class:"text-center font-semibold text-blue-800 mb-4"},xe={class:"text-center my-1"},_e={class:"border px-2 rounded-md bg-gray-50 mx-2"},he={class:"text-red-600 text-center mt-2 text-sm"},Te={class:"flex justify-between mt-3"},$e={class:"btn-2"},Ce={__name:"TaskStatusManager",props:{task:{type:Object}},emits:["updateStatus","error"],setup(i,{emit:e}){const s=i,o=e,k=P(""),p=P(),m=P(),v=D(()=>({"bg-yellow-50":s.task.status==="IN_PROGRESS","bg-green-50":s.task.status==="COMPLETED","bg-blue-50":s.task.closed_at})),d=D(()=>s.task.status=="PENDING"?"Start":s.task.status=="IN_PROGRESS"?"Finish":s.task.status=="COMPLETED"?"Close":""),c=D(()=>d.value=="Start"?"Start Task":d.value=="Finish"?"Finish Task":d.value=="Close"?"Close Task":"");async function y(){var _,n;p.value="submitting";try{await At(s.task.id,{status:k.value}),k.value="",o("updateStatus")}catch(f){m.value=(n=(_=f.response)==null?void 0:_.data)==null?void 0:n.message,o("error")}finally{p.value=""}}return(_,n)=>i.task.children_task_count===0?(a(),u("div",{key:0,class:A(["border py-8 px-4 rounded",v.value])},[t("div",ce,[i.task.closed_at?(a(),u("div",ke,n[4]||(n[4]=[t("i",{class:"fad fa-lock-alt fa-6x text-blue-500"},null,-1),t("div",{class:"text-blue-700 text-2xl mt-4"},"Task closed",-1)]))):i.task.status==="PENDING"?(a(),u("div",me,[t("button",{class:"btn-3",onClick:n[0]||(n[0]=T(f=>k.value="IN_PROGRESS",["prevent"]))},"Start Working")])):i.task.status==="IN_PROGRESS"?(a(),u("div",fe,[n[5]||(n[5]=t("div",{class:"mb-3"},"Task In Progress",-1)),t("button",{class:"btn-3",onClick:n[1]||(n[1]=T(f=>k.value="COMPLETED",["prevent"]))},"Finish Task")])):i.task.status==="COMPLETED"?(a(),u("div",ye,[n[6]||(n[6]=t("i",{class:"fad fa-check-circle fa-6x text-green-500"},null,-1)),n[7]||(n[7]=t("div",{class:"text-green-700 text-2xl"},"Task Has been completed",-1)),t("button",{class:"btn-3 mt-8",onClick:n[2]||(n[2]=T(f=>k.value="CLOSED",["prevent"]))},"Close Task")])):g("",!0)]),k.value?(a(),I(M,{key:0},{default:C(()=>[t("form",{class:"p-4 rounded relative",onSubmit:T(y,["prevent"])},[p.value==="submitting"?(a(),I(B,{key:0,class:"absolute inset-0 flex items-center justify-center bg-opacity-90"},{default:C(()=>n[8]||(n[8]=[w("Submitting!")])),_:1,__:[8]})):g("",!0),t("h3",be,b(c.value),1),t("div",ve,[t("div",ge,b(i.task.title),1),n[11]||(n[11]=t("div",{class:"text-center my-1 text-lg"},"Are you sure?",-1)),t("div",xe,[n[9]||(n[9]=w(" Want to ")),t("span",_e,b(d.value),1),n[10]||(n[10]=w(" the task? "))])]),n[12]||(n[12]=t("hr",{class:"mt-3 -mx-4"},null,-1)),t("div",null,[t("div",he,b(m.value),1),t("div",Te,[t("button",{class:"btn-3",onClick:n[3]||(n[3]=T(f=>k.value="",["prevent"]))},"Cancel"),t("button",$e,b(d.value)+" Task",1)])])],32)]),_:1})):g("",!0)],2)):g("",!0)}},Se=xt("task-user",()=>({updateUserStartDate:async(s,o,k)=>await dt.patch(`/task-user/task/${s}/user/${o}/update-start-date/${k}`),updateUserFinishDate:async(s,o,k)=>await dt.patch(`/task-user/task/${s}/user/${o}/update-finish-date/${k}`)})),we={class:"border-b text-center"},Ie={key:0},De={key:1},Pe={class:"mb-2 mt-6"},Ue={class:"flex justify-center"},Ee={class:"py-6"},Le={class:"mt-2"},Ae={key:0,class:"inline-block text-sm text-orange-700 text-center w-full"},Me={class:"flex justify-between items-center"},Oe={__name:"TaskUserDateUpdate",props:{task:{type:Object},user:{user:Object},type:{type:String}},emits:["closeClick","updateDate"],setup(i,{emit:e}){const s=i,o=e,k=Se(),p=P(""),m=P("");async function v(){var d,c;console.log({date:p.value});try{s.type=="start-date"?await k.updateUserStartDate(s.task.id,s.user.id,p.value||"0"):s.type=="finish-date"&&await k.updateUserFinishDate(s.task.id,s.user.id,p.value||"0"),o("updateDate")}catch(y){m.value=((c=(d=y.response)==null?void 0:d.data)==null?void 0:c.message)||`Failed to update ${s.type}`}}return(d,c)=>(a(),u("form",{class:"p-4",onSubmit:T(v,["prevent"])},[t("div",we,[i.type=="start-date"?(a(),u("h2",Ie,"Edit Start Date")):i.type=="finish-date"?(a(),u("h2",De,"Edit Finish Date")):g("",!0)]),t("div",Pe,[c[2]||(c[2]=t("div",{class:"text-xs uppercase text-gray-500 font-semibold"},"Task:",-1)),t("div",null,b(i.task.title),1)]),t("div",null,[c[3]||(c[3]=t("div",{class:"text-xs uppercase text-gray-500 font-semibold"},"User:",-1)),x(q,{user:i.user},null,8,["user"])]),t("div",Ue,[t("div",Ee,[c[4]||(c[4]=t("label",{class:"block text-xs font-semibold"},"Date",-1)),_t(t("input",{type:"date","onUpdate:modelValue":c[0]||(c[0]=y=>p.value=y),class:"border py-2 px-4 rounded-md",size:"8"},null,512),[[ht,p.value]])])]),t("div",Le,[m.value?(a(),u("div",Ae,b(m.value),1)):g("",!0)]),t("div",Me,[c[5]||(c[5]=t("div",null,[t("button",{class:"btn-2"},"Submit")],-1)),t("button",{class:"btn-3",onClick:c[1]||(c[1]=T(y=>o("closeClick"),["prevent"]))},"Close")])],32))}},Ne={class:"container mx-auto p-6"},Re={key:2,class:"max-w-8xl min-h-64 mx-auto bg-white shadow-lg rounded-lg p-6 relative"},je={class:"grid grid-cols-4"},Fe={class:"mb-4 flex col-span-full"},Be={class:"font-medium text-xl"},qe={class:"flex items-center gap-2 text-xs text-gray-500 mt-2 opacity-80 text-left"},Ge={key:0,class:"text-xs px-2 py-0.5 rounded-full border bg-yellow-800 text-white"},He={key:1,class:"text-xs px-2 py-0.5 rounded-full border bg-red-500 text-white"},Ve={class:"text-right col-span-full md:col-span-1 ml-auto flex items-start justify-center gap-4 !text-lg"},We={class:"col-span-full"},ze=["innerHTML"],Je={class:"mt-4 col-span-full mb-6"},Ke={class:"ml-auto text-right text-sm col-span-full"},Qe={key:1,class:"text-gray-500"},Xe={class:"font-semibold text-green-800"},Ye={key:2,class:"ml-4 text-gray-500"},Ze={class:"text-red-500 font-semibold"},ts={class:"mt-6 py-2 flex justify-center items-center gap-2 col-span-full"},es=["disabled"],ss={class:"ml-auto flex gap-4"},as=["disabled"],ns=["disabled"],os={key:0},rs={key:1},ls={key:1,class:"text-center py-4 text-red-500"},Ss={__name:"TaskShow",setup(i){const e=Mt(),s=Tt(),o=$t(),k=P(""),p=mt(),m=D(()=>e.tasks),v=P({}),d=P(!0);ct(async()=>{k.value="loading",await y(s.params.id),k.value=""});const c=F({user:null,type:""});async function y($){await e.fetchTask($)}const _=D(()=>ft(e.task.users,e.task.task_reports||[])),n=D(()=>j(e.task.started_at)),f=D(()=>j(e.task.deadline));function S($){c.user=p.user,c.type=$}async function U(){await y(s.params.id),c.user=null,c.type=""}const yt=$=>{o.push({name:"TaskEdit",params:{id:$}})},bt=D(()=>{var $,l;return e.task?(($=e.task)==null?void 0:$.parent_id)==0?{name:"TaskList"}:{name:"TaskShow",params:{id:(l=e.task)==null?void 0:l.parent_id}}:null});return kt(()=>s.params.id,async $=>{k.value="changing",await y($),k.value=""}),($,l)=>{var G,H,V,W,z,J,K,Q,X,Y,Z,tt,et,st,at,nt,ot,rt,lt;const O=ut("RouterLink"),vt=ut("router-view");return a(),u("div",Ne,[c.user?(a(),I(M,{key:0},{default:C(()=>[x(Oe,{task:r(e).task,user:c.user,type:c.type,onCloseClick:l[0]||(l[0]=h=>c.user=null),onUpdateDate:U},null,8,["task","user","type"])]),_:1})):g("",!0),k.value==="loading"?(a(),I(B,{key:1})):(a(),u("div",Re,[r(e).task?(a(),u(E,{key:0},[t("section",je,[t("div",Fe,[t("div",null,[t("h2",Be,b(r(e).task.title),1),t("div",qe,[(G=r(e).task)!=null&&G.is_important?(a(),u("span",Ge,"IMPORTANT")):g("",!0),(H=r(e).task)!=null&&H.is_urgent?(a(),u("span",He,"URGENT")):g("",!0)])]),t("div",Ve,[x(It,{status:(V=r(e).task)==null?void 0:V.status,progressPercent:(W=r(e).task)==null?void 0:W.progress_percent,class:"h-6 !text-lg"},null,8,["status","progressPercent"]),r(e).task?(a(),I(Dt,{key:0,task:r(e).task,ref_key:"progress",ref:v,class:"!text-lg"},null,8,["task"])):g("",!0)])]),t("div",We,[t("p",{innerHTML:(z=r(e).task)==null?void 0:z.description,class:A(["text-gray-700",{"line-clamp-3":d.value}])},null,10,ze),((K=(J=r(e).task)==null?void 0:J.description)==null?void 0:K.length)>=600?(a(),u("button",{key:0,class:"text-blue-500 mt-2",onClick:l[1]||(l[1]=T(h=>d.value=!d.value,["prevent"]))}," Show "+b(d.value?"More":"Less"),1)):g("",!0)]),x(Pt,{task:(Q=r(e))==null?void 0:Q.task,"tree-level":(Y=(X=r(e))==null?void 0:X.task)==null?void 0:Y.level},null,8,["task","tree-level"]),t("section",Je,[x(pe,{"task-users":((Z=r(e).task)==null?void 0:Z.users)||[],task:r(e).task,"sub-tasks":r(e).tasks,"progress-users":_.value},{caption:C(()=>l[14]||(l[14]=[t("div",{class:"text-sm py-1 text-left uppercase font-semibold text-gray-600"}," Assigned Users ",-1)])),_:1},8,["task-users","task","sub-tasks","progress-users"])]),t("div",Ke,[r(e).task.deadline?(a(),I(jt,{key:0,targetDateTime:r(e).task.deadline,class:"text-lg font-semibold italic text-green-600"},null,8,["targetDateTime"])):g("",!0),n.value?(a(),u("span",Qe,[l[15]||(l[15]=w(" Started: ")),t("span",Xe,b(n.value),1)])):g("",!0),f.value?(a(),u("span",Ye,[l[16]||(l[16]=w(" Deadline: ")),t("span",Ze,b(f.value),1)])):g("",!0)]),x(Ce,{task:((tt=r(e))==null?void 0:tt.task)||{},class:"col-span-full",onUpdateStatus:l[2]||(l[2]=h=>{var L,it;return y((it=(L=r(e))==null?void 0:L.task)==null?void 0:it.id)})},null,8,["task"]),t("div",ts,[t("button",{onClick:l[3]||(l[3]=T(h=>{var L;return yt((L=r(e).task)==null?void 0:L.id)},["stop"])),class:"btn-2 py-0.5 disabled:opacity-30 disabled:pointer-events-none",disabled:!!r(e).task.closed_at}," Edit ",8,es),x(O,{to:{name:"TaskUserAssign",params:{id:(et=r(e).task)==null?void 0:et.id}},class:A(["bg-indigo-500 hover:bg-indigo-600 text-white font-semibold px-3 py-0.5 rounded-full transition",r(e).task.closed_at?"opacity-30 pointer-events-none":""]),onClick:l[4]||(l[4]=h=>h.stopPropagation())},{default:C(()=>l[17]||(l[17]=[t("i",{class:"fas fa-user-plus"},null,-1),w(" Assign Users ")])),_:1,__:[17]},8,["to","class"]),x(O,{to:bt.value,class:"bg-indigo-500 hover:bg-indigo-600 text-white font-semibold px-3 py-0.5 rounded-full transition disabled:opacity-30 disabled:pointer-events-none",onClick:l[5]||(l[5]=h=>h.stopPropagation())},{default:C(()=>l[18]||(l[18]=[t("i",{class:"fas fa-arrow-left"},null,-1),w(" Back ")])),_:1,__:[18]},8,["to"]),t("div",ss,[((st=r(e).task)==null?void 0:st.children_task_count)===0?(a(),u(E,{key:0},[t("button",{class:"btn-3 px-3 py-0.5 text-sm h-8 font-semibold border disabled:opacity-30 disabled:pointer-events-none",onClick:l[6]||(l[6]=T(()=>S("start-date"),["prevent"])),disabled:!!((at=$.authUserProgress)!=null&&at.started_at)||!!r(e).task.closed_at}," Set Started Date ",8,as),t("button",{class:"btn-3 px-3 py-0.5 text-sm h-8 font-semibold border disabled:opacity-30 disabled:pointer-events-none",onClick:l[7]||(l[7]=T(()=>S("finish-date"),["prevent"])),disabled:!!((nt=$.authUserProgress)!=null&&nt.finished_at)||!!r(e).task.closed_at}," Set Finish Date ",8,ns)],64)):g("",!0),m.value.length>0?(a(),I(O,{key:1,to:{name:"TaskShow",params:{id:(ot=r(e).task)==null?void 0:ot.id}},onClick:l[8]||(l[8]=h=>h.stopPropagation()),class:A(["py-0.5 btn-3 ml-auto text-sm h-8",{"bg-blue-500 text-white":r(s).name=="TaskShow"}])},{default:C(()=>l[19]||(l[19]=[t("i",{class:"fal fa-list-ul"},null,-1),w(" Sub Tasks ")])),_:1,__:[19]},8,["to","class"])):g("",!0),x(O,{to:{name:"TaskReports",params:{id:(rt=r(e).task)==null?void 0:rt.id}},onClick:l[9]||(l[9]=h=>h.stopPropagation()),class:A(["py-0.5 btn-3 text-sm h-8",{"bg-blue-500 text-white":r(s).name=="TaskReports"}])},{default:C(()=>l[20]||(l[20]=[t("i",{class:"fal fa-file-alt"},null,-1),w(" Reports ")])),_:1,__:[20]},8,["to","class"])])])]),r(s).name=="TaskShow"&&((lt=r(e).task)==null?void 0:lt.level)<=2?(a(),u("section",os,[x(Jt,{subTasks:m.value,"parent-id":r(s).params.id,"tree-level":r(e).task.level+1,onCreated:l[10]||(l[10]=h=>y(r(s).params.id)),onUpdated:l[11]||(l[11]=h=>y(r(s).params.id)),onUpdatePriority:l[12]||(l[12]=h=>y(r(s).params.id)),onAssignUser:l[13]||(l[13]=h=>y(r(s).params.id)),"sub-task-is-creatable":r(e).task.status!=="COMPLETED"&&!r(e).task.closed_at},null,8,["subTasks","parent-id","tree-level","sub-task-is-creatable"])])):(a(),u("section",rs,[x(vt)]))],64)):(a(),u("div",ls,b(r(e).error),1)),k.value==="changing"?(a(),I(B,{key:2,class:"absolute bg-opacity-80 inset-0 z-20"})):g("",!0)]))])}}};export{Ss as default};
