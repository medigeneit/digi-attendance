import{r as m,e as Y,I as Z,m as g,M as _,x as ee,c as i,o as d,a as c,h as L,G as v,g as j,F as U,n as z,t as y,w as b,v as P,V as h,j as A,p as I,W as te}from"./index-DFN3F9TA.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"w-full h-full"},oe={key:0,class:"flex flex-wrap items-center gap-2 w-full h-full justify-items-stretch"},ae={class:"bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm"},se=["onClick"],re={key:1,class:"text-gray-400"},ue=["placeholder","onKeydown"],ie={key:1,class:"flex items-center h-full"},de={key:0,class:"px-2 pt-2"},ce={class:"max-h-60 overflow-y-auto py-2"},fe=["onClick","onKeydown"],pe={key:1,class:"px-3 py-2 text-gray-500 min-h-24 flex justify-center items-center -mt-2"},ve={__name:"SelectDropdown",props:{options:{type:Array,required:!0},modelValue:{type:[Object,Array,String,Number,null],default:null},placeholder:{type:String,default:null},multiple:{type:Boolean,default:!1},label:{type:String,default:"label"},value:{type:String,default:"id"},clearable:{type:Boolean,default:!0},searchable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},filterBy:{type:Function,default:null},reduce:{type:Function,default:null},position:{type:String,default:"auto",validator:a=>["top","left","right","bottom","auto"].includes(a)},containment:{type:Object,default:()=>window},taggable:{type:Boolean,default:!1},createOption:Function},emits:["update:modelValue","input","open","close","search","search:focus","search:blur","option:selecting","option:selected","option:deselecting","option:deselected"],setup(a,{emit:q}){const l=a,o=q,r=m(!1),s=m(""),K=m(null),M=m(null),w=m(),T=m(),k=m(l.position);function D(e){w.value&&!w.value.contains(e.target)&&r.value&&(r.value=!1,o("close"))}function E(e){return l.options.find(t=>(t==null?void 0:t[l.value])==e)}Y(()=>{var e;document.addEventListener("click",D),(e=l.containment)==null||e.addEventListener("scroll",()=>C(r.value)),setTimeout(()=>{var t;(t=M.value)==null||t.focus()})}),Z(()=>{var e;document.removeEventListener("click",D),(e=l.containment)==null||e.removeEventListener("scroll",()=>C(r.value))});const G=g(()=>l.multiple||l.taggable),W=g(()=>{const e={top:"bottom-[100%] mb-0.5",left:"right-[100%] mr-0.5",right:"left-[100%] ml-0.5",bottom:"top-[100%] mt-0.5"};return e[k.value]||e.bottom}),f=g(()=>l.multiple||l.taggable?Array.isArray(l.modelValue)?l.modelValue:[]:l.modelValue),V=e=>(e==null?void 0:e[l.label])??(e==null?void 0:e.label)??e,F=e=>{const t=l.options.find(n=>typeof n=="string"||typeof n=="number"?String(n)===String(e):(n==null?void 0:n[l.value])==e);return t?(t==null?void 0:t[l.label])??(t==null?void 0:t.label)??t:l.taggable?e:null},u=e=>typeof e=="object"?(e==null?void 0:e[l.value])??(e==null?void 0:e.value)??e:typeof e=="string"||typeof e=="number"?e:"",J=()=>{l.disabled||(r.value=!r.value,o(r.value?"open":"close"),r.value&&setTimeout(()=>{var e;(e=K.value)==null||e.focus()},0))},$=e=>{const t=u(e);return l.multiple||l.taggable?f.value.some(n=>u(n)===t):u(f.value)===t},S=e=>{if(l.multiple||l.taggable)if($(e)){o("option:deselecting",e);const t=f.value.filter(n=>u(n)!==u(e));o("update:modelValue",t),o("option:deselected",e)}else{o("option:selecting",e);const t=[...f.value,u(e)];o("update:modelValue",t),o("option:selected",e)}else o("option:selected",e),typeof l.modelValue=="object"&&l.modelValue?o("update:modelValue",e):o("update:modelValue",u(e));r.value=!1,o("close"),o("input",e),s.value=""},N=e=>{const t=f.value.filter(n=>u(n)!==u(e));o("update:modelValue",t),o("option:deselected",e)},B=g(()=>{const e=s.value.toLowerCase();return!l.searchable||!e?l.options:typeof l.filterBy=="function"?l.filterBy(l.options,e):l.options.filter(t=>V(t).toLowerCase().includes(e))});async function C(e){if(!l.containment)return null;if(e&&l.position==="auto"){await _();const t=w.value,n=T.value;if(t&&n){console.log({cm:l.containment});const p=t.getBoundingClientRect(),x=n.offsetHeight,H=(l.containment.innerHeight||l.containment.clientHeight)-p.bottom,O=p.top;console.log({triggerRect:p,dropdownHeight:x,spaceBelow:H,spaceAbove:O}),O<x?k.value="bottom":k.value=H<x&&O>x?"top":"bottom"}}else k.value=l.position}const R=g(()=>B.value.find(e=>V(e).toLowerCase()===s.value.toLowerCase()));function Q(e){if(s.value.length===0&&l.taggable&&Array.isArray(l.modelValue)){const t=[...l.modelValue];t.pop(),o("update:modelValue",t)}}function X(e){if(e.preventDefault(),!(!l.taggable||!s.value.trim())){if(R.value)S(R.value);else{const t=l.createOption?l.createOption(s.value):s.value.trim();o("option:created",t),o("option:selected",t),o("input",t),o("update:modelValue",[...l.modelValue,t])}s.value="",e.target.focus()}}return ee(r,C),(e,t)=>(d(),i("div",{class:"relative w-full",ref_key:"dropdownRef",ref:w},[c("div",{class:I(["h-full border rounded-md px-2 py-1 cursor-pointer bg-white flex items-center justify-between",{"bg-gray-100":a.disabled}]),onClick:J,tabindex:"0"},[c("div",ne,[G.value?(d(),i("div",oe,[Array.isArray(f.value)&&f.value.length>0?(d(!0),i(U,{key:0},z(f.value,n=>v(e.$slots,"selected-option",{key:u(n),option:E(n),removeItem:p=>N(p)},()=>[c("span",ae,[c("span",null,y(F(n)),1),c("button",{onClick:b(p=>N(n),["prevent","stop"]),type:"button",class:"ml-1 text-xs"}," Ã— ",8,se)])],!0)),128)):a.taggable?j("",!0):(d(),i("span",re,y(a.placeholder||"Select.."),1)),a.taggable?L((d(),i("input",{key:2,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value=n),ref_key:"tagSearchInput",ref:M,type:"text",class:"flex-grow px-2 py-1 rounded outline-none",placeholder:a.placeholder||"Type and enter to add",onKeydown:[h(b(X,["prevent","stop"]),["enter"]),h(Q,["backspace"])],onKeyup:t[1]||(t[1]=()=>r.value=!!s.value),onFocus:t[2]||(t[2]=n=>e.$emit("search:focus")),onBlur:t[3]||(t[3]=n=>e.$emit("search:blur"))},null,40,ue)),[[P,s.value]]):j("",!0)])):(d(),i("div",ie,[v(e.$slots,"selected-option",{option:E(a.modelValue),isSelected:$},()=>[A(y(F(f.value)||a.placeholder||"Select..."),1)],!0)]))]),v(e.$slots,"open-indicator",{},()=>[t[8]||(t[8]=c("svg",{class:"w-4 h-4 ml-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M19 9l-7 7-7-7"})],-1))],!0)],2),L(c("div",{class:I(["absolute w-full border rounded shadow-[0px_0px_10px_0px_rgba(0,0,0,0.25)] z-50 border-teal-500 bg-white",W.value]),ref_key:"dropdownMenuRef",ref:T},[a.searchable&&!a.taggable?(d(),i("div",de,[v(e.$slots,"search",{},()=>[L(c("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=n=>s.value=n),ref_key:"searchInput",ref:K,class:"w-full px-2 py-1 border rounded",placeholder:"Search...",onFocus:t[5]||(t[5]=n=>e.$emit("search:focus")),onBlur:t[6]||(t[6]=n=>e.$emit("search:blur")),onKeydown:t[7]||(t[7]=h(b(n=>n.preventDefault(),["stop"]),["enter"]))},null,544),[[P,s.value]])],!0)])):j("",!0),v(e.$slots,"list-header",{},void 0,!0),c("ul",ce,[B.value.length?(d(!0),i(U,{key:0},z(B.value,n=>(d(),i("li",{tabindex:"0",key:u(n),class:I([{"bg-blue-50":$(n)},"px-3 py-1 my-0.5 hover:bg-blue-100 focus:bg-blue-100 focus:outline-blue-500 cursor-pointer"]),onClick:p=>S(n),onKeydown:[h(b(p=>S(n),["prevent"]),["space"]),h(b(p=>S(n),["prevent"]),["enter"])]},[v(e.$slots,"option",{option:n},()=>[A(y(V(n)),1)],!0)],42,fe))),128)):(d(),i("li",pe,[v(e.$slots,"no-options",{},()=>[A(y(a.taggable?"No option found, Enter to add":"No options found"),1)],!0)]))]),v(e.$slots,"list-footer",{},void 0,!0)],2),[[te,r.value]])],512))}},ye=le(ve,[["__scopeId","data-v-a316a40b"]]);export{ye as S};
