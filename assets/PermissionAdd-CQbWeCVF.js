import{u as D,s as u,r as b,A as V,e as A,c as a,o as l,a as s,f,l as B,h as n,g as m,C as M,F as _,x,t as S,E as g}from"./index-B3AlSP1P.js";import{_ as N}from"./MultiselectDropdown-DqRaXK42.js";import{u as E}from"./company-Chy2C6mK.js";import{u as F}from"./department-DJh1vec2.js";import{u as L}from"./user-CWssIA4R.js";import{u as R}from"./userPermissionStore-8tipQWHb.js";import"./vue-multiselect.esm-CnmxZeLu.js";const T={class:"max-w-xl mx-auto mt-10 p-6 bg-white shadow-md rounded-xl space-y-6"},$=["value"],j={key:0},q={class:"space-y-1 mt-2"},z={class:"flex items-center space-x-2"},G={key:0,class:"grid grid-cols-2 gap-2"},H=["value"],I=["disabled"],J={key:0},K={key:1},te={__name:"PermissionAdd",setup(O){const p=L(),i=R(),k=D(),c=E(),v=F(),{users:h}=u(p),{companies:C}=u(c),{departments:y}=u(v),d=b(null),o=b({user_id:"",company_id:"",department_ids:[]});V(d,r=>{o.value.user_id=(r==null?void 0:r.id)||""});const U=async()=>{o.value.department_ids=[],await v.fetchDepartments(o.value.company_id)},P=async()=>{try{await i.createPermission(o.value),k.push({name:"PermissionList"})}catch{alert(i.error)}};return A(()=>{p.fetchUsers({type:"admin"}),c.fetchCompanies()}),(r,e)=>(l(),a("div",T,[e[9]||(e[9]=s("h2",{class:"text-2xl font-bold text-gray-700"},"Add Permission",-1)),s("div",null,[e[4]||(e[4]=s("label",{class:"block font-medium mb-1"},"Select User",-1)),B(N,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),options:n(h),multiple:!1,label:"label",placeholder:"Select employee"},null,8,["modelValue","options"])]),s("div",null,[e[6]||(e[6]=s("label",{class:"block font-medium mb-1"},"Select Company",-1)),m(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.company_id=t),onChange:U,class:"w-full border rounded px-3 py-2"},[e[5]||(e[5]=s("option",{value:""},"-- Select Company --",-1)),(l(!0),a(_,null,x(n(C),t=>(l(),a("option",{key:t.id,value:t.id},S(t.name),9,$))),128))],544),[[M,o.value.company_id]])]),n(y).length?(l(),a("div",j,[e[8]||(e[8]=s("label",{class:"block font-medium mb-1"},"Select Departments",-1)),s("div",q,[s("label",z,[m(s("input",{type:"checkbox",value:"*","onUpdate:modelValue":e[2]||(e[2]=t=>o.value.department_ids=t)},null,512),[[g,o.value.department_ids]]),e[7]||(e[7]=s("span",null,"All Departments",-1))]),o.value.department_ids.includes("*")?f("",!0):(l(),a("div",G,[(l(!0),a(_,null,x(n(y),t=>(l(),a("label",{key:t.id,class:"flex items-center space-x-2"},[m(s("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":e[3]||(e[3]=w=>o.value.department_ids=w)},null,8,H),[[g,o.value.department_ids]]),s("span",null,S(t.name),1)]))),128))]))])])):f("",!0),s("button",{onClick:P,disabled:n(i).loading,class:"w-full py-2 bg-blue-600 text-white rounded hover:bg-blue-700"},[n(i).loading?(l(),a("span",J,"Saving...")):(l(),a("span",K,"Save Permission"))],8,I)]))}};export{te as default};
