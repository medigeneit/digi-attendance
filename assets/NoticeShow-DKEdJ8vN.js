import{L as W}from"./LoaderView-wbywHZk3.js";import{_ as X}from"./ShareComponent-BtMtADt3.js";import{u as K}from"./notice-BjmjDCib.js";import{r as m,s as Y,x as Z,z as ee,b as O,o,c as a,a as e,d as te,v as se,h as Q,F as w,q as L,t as i,e as F,i as oe,j as ae,l as k,m as G,n as le,k as J,f as ne}from"./index-B4dLulca.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={class:"space-y-6"},re={class:"flex justify-center"},de={class:"bg-white rounded-lg shadow-md p-6 space-y-4"},ce={key:0,class:"text-center text-gray-500"},ue={key:1},ve={key:0,class:"divide-y"},pe={class:"flex-shrink-0"},ye={class:"h-10 w-10 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold"},ge={class:"flex-1"},_e={class:"text-gray-800 font-semibold"},me={class:"text-gray-600 text-sm mt-1"},xe={class:"text-gray-400 text-xs"},fe={key:1,class:"text-center text-gray-400 italic"},he={key:2,class:"flex justify-center mt-6"},be=20,ke={__name:"NoticeFeedbackList",props:{noticeId:{type:[String,Number],required:!0}},setup(D){const b=K();function $(g,r=300){let n;return function(..._){clearTimeout(n),n=setTimeout(()=>{g.apply(this,_)},r)}}const N=D,s=m(""),p=m(1),d=m(!1),{feedbacks:y,totalFeedbacks:A}=Y(b),x=async(g=!1)=>{try{d.value=!0,g&&(y.value=[],p.value=1),console.log("sdf"),await b.fetchFeedbacks(N.noticeId,{params:{page:p.value,per_page:be,search:s.value}})}catch(r){console.error("Error fetching feedbacks:",r)}finally{d.value=!1}},c=Z(()=>y.value.length<A.value),t=()=>{c.value&&(p.value++,x())},v=$(()=>{x(!0)},400);return ee(s,()=>{v()}),O(()=>{x()}),(g,r)=>(o(),a("div",ie,[e("div",re,[te(e("input",{"onUpdate:modelValue":r[0]||(r[0]=n=>s.value=n),type:"text",placeholder:"Search by User Name...",class:"border border-gray-300 rounded-lg p-2 w-full max-w-md focus:outline-none focus:ring-2 focus:ring-blue-400"},null,512),[[se,s.value]])]),e("div",de,[r[1]||(r[1]=e("h3",{class:"title-md text-center mb-4"},"User Feedbacks",-1)),d.value?(o(),a("div",ce,"Loading...")):(o(),a("div",ue,[Q(y).length?(o(),a("div",ve,[(o(!0),a(w,null,L(Q(y),n=>{var _,f;return o(),a("div",{key:n.id,class:"py-4 flex items-start gap-4"},[e("div",pe,[e("div",ye,i(n.user.name.charAt(0)),1)]),e("div",ge,[e("p",_e,i(n.user.name)+" ("+i((f=(_=n==null?void 0:n.user)==null?void 0:_.department)==null?void 0:f.name)+") ",1),e("p",me,i(n.feedback),1)]),e("div",xe,i(new Date(n.created_at).toLocaleDateString()),1)])}),128))])):(o(),a("div",fe,"No feedbacks found.")),c.value&&!d.value?(o(),a("div",he,[e("button",{onClick:t,class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg"}," Load More ")])):F("",!0)]))])]))}},we={class:"my-container space-y-6"},Le={class:"card-bg p-6"},$e={key:1,class:"text-center text-red-500"},Ne={key:2,class:"grid gap-2"},Ae={class:"bg-gray-100 p-4 rounded-lg"},Fe={class:"grid md:grid-cols-2 gap-4"},De={class:"text-sm text-gray-800"},Se={key:0,class:"text-gray-800 text-sm"},Te={key:1,class:"text-lg text-gray-800"},Me={key:0,class:"text-gray-800"},je={key:1,class:"text-gray-800"},Be={key:0,class:"text-gray-800"},Ce={class:"text-gray-800"},Ee={class:"text-gray-800"},Ie={class:"col-span-full"},Ve=["innerHTML"],Re={key:0,class:"divide-y"},Ue={class:"flex-shrink-0"},Pe={class:"h-10 w-10 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold"},qe={class:"flex-1"},He={class:"text-gray-800 font-semibold"},ze={key:1,class:"text-center text-gray-400 italic"},Qe={class:"flex justify-center mt-2 gap-4"},Xe={__name:"NoticeShow",setup(D){const b=K(),$=oe(),N=ne(),s=m(null),p=m(!0),d=m(null),y=c=>new Date(c).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),A=async()=>{var c,t;try{p.value=!0,d.value=null;const v=N.params.id;s.value=await b.fetchNotice(v)}catch(v){d.value=((t=(c=v.response)==null?void 0:c.data)==null?void 0:t.message)||"Failed to load notice details",$.error(d.value)}finally{p.value=!1}};O(async()=>{await A()});const x=async c=>{window.open(c,"_blank")};return(c,t)=>{var g,r,n,_,f,S,T,M,j,B,C,E,I,V,R,U,P,q,H,z;const v=le("RouterLink");return o(),a("div",we,[e("div",Le,[t[13]||(t[13]=e("h2",{class:"title-lg text-center"},"Notice Details",-1)),p.value?(o(),ae(W,{key:0,class:"shadow-none"})):d.value?(o(),a("div",$e,[e("p",null,i(d.value),1)])):(o(),a("div",Ne,[e("div",Ae,[t[9]||(t[9]=e("p",{class:"title-md"},"Notice Info",-1)),t[10]||(t[10]=e("hr",{class:"mb-2"},null,-1)),e("div",Fe,[e("div",null,[t[1]||(t[1]=e("p",{class:"font-bold text-gray-600"},"Title:",-1)),e("p",De,i((g=s.value)==null?void 0:g.title),1)]),e("div",null,[t[2]||(t[2]=e("p",{class:"font-bold text-gray-600"},"Company:",-1)),Array.isArray((r=s.value)==null?void 0:r.companies_notice)&&((_=(n=s.value)==null?void 0:n.companies_notice)!=null&&_.length)?(o(),a("p",Se,[(o(!0),a(w,null,L((f=s.value)==null?void 0:f.companies_notice,(l,u)=>{var h;return o(),a("span",{key:l.id},i(l==null?void 0:l.name)+" "+i(u<((h=s.value)==null?void 0:h.companies_notice.length)-1?", ":""),1)}),128))])):(o(),a("p",Te,"All department"))]),e("div",null,[t[3]||(t[3]=e("p",{class:"font-bold text-gray-600"},"Department:",-1)),Array.isArray((S=s.value)==null?void 0:S.departments)&&((M=(T=s.value)==null?void 0:T.departments)!=null&&M.length)?(o(),a("p",Me,[(o(!0),a(w,null,L((j=s.value)==null?void 0:j.departments,(l,u)=>{var h;return o(),a("span",{key:l.id},i(l==null?void 0:l.name)+" "+i(u<((h=s.value)==null?void 0:h.departments.length)-1?", ":""),1)}),128))])):(o(),a("p",je,"All department"))]),e("div",null,[t[4]||(t[4]=e("p",{class:"font-bold text-gray-600"},"Employee:",-1)),Array.isArray((B=s.value)==null?void 0:B.employees)&&!((E=(C=s.value)==null?void 0:C.employees)!=null&&E.length)?(o(),a("p",Be," All employees ")):F("",!0)]),e("div",null,[t[5]||(t[5]=e("p",{class:"font-bold text-gray-600"},"Published Date:",-1)),e("p",Ce,i(y((I=s.value)==null?void 0:I.published_at)),1)]),e("div",null,[t[6]||(t[6]=e("p",{class:"font-bold text-gray-600"},"Expired Date:",-1)),e("p",Ee,i(y((V=s.value)==null?void 0:V.expired_at)),1)]),e("div",null,[t[7]||(t[7]=e("p",{class:"text-sm font-bold text-gray-600 mb-2"},"File:",-1)),(R=s.value)!=null&&R.file?(o(),a("button",{key:0,onClick:t[0]||(t[0]=l=>{var u;return x((u=s.value)==null?void 0:u.file)}),class:"btn-2"}," Download File ")):F("",!0)]),e("div",Ie,[t[8]||(t[8]=e("p",{class:"font-bold text-gray-600"},"Description / Body:",-1)),e("p",{class:"text-gray-800",innerHTML:(U=s.value)==null?void 0:U.description},null,8,Ve)])])]),k(ke,{noticeId:s.value.id},null,8,["noticeId"]),e("div",null,[Array.isArray((P=s.value)==null?void 0:P.employees)&&((q=s.value)!=null&&q.employees.length)?(o(),a("div",Re,[(o(!0),a(w,null,L((H=s.value)==null?void 0:H.employees,l=>{var u;return o(),a("div",{key:l.id,class:"py-4 flex items-center gap-4"},[e("div",Ue,[e("div",Pe,i((u=l==null?void 0:l.name)==null?void 0:u.charAt(0)),1)]),e("div",qe,[e("p",He,i(l==null?void 0:l.name),1)])])}),128))])):(o(),a("div",ze,"Assign all employees."))]),k(X),e("div",Qe,[k(v,{to:{name:"NoticeList"},type:"button",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:G(()=>t[11]||(t[11]=[J(" Back to List ")])),_:1}),k(v,{to:{name:"NoticeEdit",params:{id:(z=s.value)==null?void 0:z.id}},class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},{default:G(()=>t[12]||(t[12]=[J(" Edit ")])),_:1},8,["to"])])]))])])}}};export{Xe as default};
