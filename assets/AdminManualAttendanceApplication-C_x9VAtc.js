import{u as le,b as se,r as g,e as oe,x as V,m as ae,c as d,o as i,a as t,q as I,h as v,v as f,k as c,g as w,j as y,t as u,p as J,F as re,n as ne,E as K,w as b,y as de}from"./index-DFN3F9TA.js";import{_ as ie}from"./EmployeeFilter-Df8Ce9K3.js";import{L as ue}from"./LoaderView-Bm25Ml6I.js";import{u as pe}from"./manual-attendance-CLlRGyhp.js";import{u as ce}from"./user-VKkcCi_H.js";import"./company-WMxMoEGB.js";import"./department-DkAnO1Db.js";import"./SelectDropdown-ZBR42h8e.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-C5cdFgMr.js";const ye={class:"space-y-2 px-4"},me={class:"flex items-center justify-between gap-2"},ve={class:"flex flex-wrap gap-2"},ge={key:0,class:"text-center py-4"},be={key:1,class:"space-y-4"},_e={key:0,class:"bg-sky-100/30 p-4 rounded-lg shadow mb-6 space-y-4"},ke={class:"grid gap-6"},xe={class:"bg-white border rounded-lg p-4 shadow"},he={class:"grid grid-cols-2 sm:grid-cols-4 gap-y-1 text-sm text-gray-600"},fe={class:"overflow-x-auto"},we={key:0,class:"text-red-500 text-sm text-left"},Ce={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Ue={class:"bg-gray-200"},Ae={class:"border border-gray-300 px-2 text-left py-2"},Ve={class:"flex items-center justify-center gap-2"},Me=["onClick"],Se={class:"border border-gray-300 px-2 cursor-pointer text-center"},qe=["onUpdate:modelValue"],Be={class:"border border-gray-300 px-2"},Fe=["onUpdate:modelValue"],De={class:"border border-gray-300 px-2"},Pe=["onUpdate:modelValue"],$e={class:"border border-gray-300 px-2"},je=["onUpdate:modelValue"],Ne={class:"border border-gray-300 px-2"},Ee=["onUpdate:modelValue"],Re={class:"border border-gray-300 px-2"},Te=["onUpdate:modelValue","disabled"],Le={key:0},Oe={key:1},He={class:"space-y-6"},We={key:0,class:"text-red-500 text-sm text-left"},ze={class:"flex items-center justify-center gap-2 cursor-pointer"},Ge={class:"flex justify-center"},Ie=["disabled"],Je={key:0},Ke={key:1},nt={__name:"AdminManualAttendanceApplication",setup(Qe){const Q=le(),_=se(),a=pe(),M=ce(),X=g(null),h=g(_.query.date||a.selectedMonth),k=g([]),m=g(!1),p=g(null),A=g(!0),s=g({company_id:_.query.company_id||"",department_id:_.query.department_id||"all",type:_.query.type||"all",employee_id:_.query.employee_id||"",category:""}),C=async()=>{const o={company_id:s.value.company_id,department_id:s.value.department_id,selectedMonth:h.value,selectedStatus:a.selectedStatus};s.value.employee_id?(o.user_id=s.value.employee_id,m.value=!0,await a.fetchAdminManualAttendances(o),m.value=!1):a.manualAttendances.value=[]};oe(async()=>{await M.fetchUsers(),X.value=M.users.find(o=>o.id==s.value.employee_id)||null,await C()}),V(()=>[s.value.company_id,s.value.department_id,s.value.employee_id,h.value],async()=>{await C()}),V(h,o=>{Q.replace({query:{..._.query,date:o}})});const Y=ae(()=>a.attendances||[]);V(()=>a.attendances,o=>{k.value=[],o==null||o.forEach(e=>{k.value.push({date:e==null?void 0:e.date,type:"Forget Punch",check_in:e==null?void 0:e.entry_time,check_out:e==null?void 0:e.exit_time,description:"",is_check:!1})})},{immediate:!0,deep:!0});const Z=()=>{const o=k.value.every(e=>e.is_check);k.value.forEach(e=>{e.is_check=!o})},ee=async()=>{var o;if(m.value=!0,p.value=null,!s.value.employee_id){p.value="Please select an employee.",m.value=!1;return}try{const e=k.value.filter(r=>r.is_check&&(r.check_in||r.check_out));if(e.length===0){p.value="Please select at least one row.",m.value=!1;return}const U=e.map(r=>({user_id:s.value.employee_id,type:r.type,check_in:r.check_in?`${r.date} ${r.check_in}:00`:null,check_out:r.check_out?`${r.date} ${r.check_out}:00`:null,description:r.description||""})),x=await a.createBulkManualAttendance({records:U,direct_approve:A.value});(o=x==null?void 0:x.data)!=null&&o.length&&await C()}catch(e){p.value=e.message||"Failed to submit manual attendance requests."}finally{m.value=!1}};return(o,e)=>{var U,x,r,S,q,B,F,D,P,$,j,N,E,R,T,L,O,H,W,z,G;return i(),d("div",ye,[t("div",me,[t("button",{class:"btn-3",onClick:e[0]||(e[0]=(...l)=>o.goBack&&o.goBack(...l))},e[14]||(e[14]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[15]||(e[15]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Admin Bulk Manual Attendance Applications",-1)),e[16]||(e[16]=t("div",null,null,-1))]),t("div",ve,[I(ie,{company_id:s.value.company_id,"onUpdate:company_id":e[1]||(e[1]=l=>s.value.company_id=l),department_id:s.value.department_id,"onUpdate:department_id":e[2]||(e[2]=l=>s.value.department_id=l),employee_id:s.value.employee_id,"onUpdate:employee_id":e[3]||(e[3]=l=>s.value.employee_id=l),category:s.value.category,"onUpdate:category":e[4]||(e[4]=l=>s.value.category=l),"with-type":!0,"initial-value":o.$route.query,onFilterChange:o.handleFilterChange},null,8,["company_id","department_id","employee_id","category","initial-value","onFilterChange"]),t("div",null,[v(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":e[5]||(e[5]=l=>h.value=l),onChange:C,class:"input-1"},null,544),[[f,h.value]])])]),c(a).loading?(i(),d("div",ge,[I(ue)])):(i(),d("div",be,[(U=s.value)!=null&&U.employee_id?(i(),d("div",_e,[t("div",ke,[t("div",xe,[t("div",he,[t("p",null,[e[17]||(e[17]=t("strong",null,"Name:",-1)),y(" "+u((r=(x=c(a))==null?void 0:x.user)==null?void 0:r.name),1)]),t("p",null,[e[18]||(e[18]=t("strong",null,"Data:",-1)),y(" "+u((B=(q=(S=c(a))==null?void 0:S.user)==null?void 0:q.designation)==null?void 0:B.title),1)]),t("p",null,[e[19]||(e[19]=t("strong",null,"Department:",-1)),y(" "+u((P=(D=(F=c(a))==null?void 0:F.user)==null?void 0:D.department)==null?void 0:P.name),1)]),t("p",null,[e[20]||(e[20]=t("strong",null,"Company:",-1)),y(" "+u((N=(j=($=c(a))==null?void 0:$.user)==null?void 0:j.company)==null?void 0:N.name),1)]),t("p",null,[e[21]||(e[21]=t("strong",null,"Phone:",-1)),y(" "+u((R=(E=c(a))==null?void 0:E.user)==null?void 0:R.phone),1)]),t("p",null,[e[22]||(e[22]=t("strong",null,"Email:",-1)),y(" "+u((L=(T=c(a))==null?void 0:T.user)==null?void 0:L.email),1)]),t("p",null,[e[23]||(e[23]=t("strong",null,"Joining Date:",-1)),y(" "+u((H=(O=c(a))==null?void 0:O.user)==null?void 0:H.joining_date),1)]),t("p",null,[e[24]||(e[24]=t("strong",null,"Blood Group:",-1)),y(" "+u(((z=(W=c(a))==null?void 0:W.user)==null?void 0:z.blood)||"N/A"),1)])])])])])):w("",!0),t("div",fe,[t("div",{class:J(p.value?"py-2":"")},[p.value?(i(),d("div",we,u(p.value),1)):w("",!0)],2),t("table",Ce,[t("thead",null,[t("tr",Ue,[t("th",Ae,[t("div",Ve,[t("input",{id:"allCheck",type:"checkbox",onChange:Z,class:"h-5 w-5 accent-blue-600 cursor-pointer"},null,32),e[25]||(e[25]=t("label",{for:"allCheck",class:"text-sm cursor-pointer"},"All Check",-1))])]),e[26]||(e[26]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Date",-1)),e[27]||(e[27]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Type",-1)),e[28]||(e[28]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Check-In",-1)),e[29]||(e[29]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Check-Out",-1)),e[30]||(e[30]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Description",-1))])]),t("tbody",null,[(i(!0),d(re,null,ne(k.value,(l,te)=>(i(),d("tr",{key:te,class:J(["border-b border-gray-200 hover:bg-blue-200 cursor-pointer",l.is_check?"bg-yellow-100":""]),onClick:n=>l.is_check=!l.is_check},[t("td",Se,[v(t("input",{type:"checkbox","onUpdate:modelValue":n=>l.is_check=n,class:"h-5 w-5",onClick:e[6]||(e[6]=b(()=>{},["stop"]))},null,8,qe),[[K,l.is_check]])]),t("td",Be,[v(t("input",{type:"date","onUpdate:modelValue":n=>l.date=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[7]||(e[7]=b(()=>{},["stop"])),disabled:""},null,8,Fe),[[f,l.date]])]),t("td",De,[v(t("select",{"onUpdate:modelValue":n=>l.type=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[8]||(e[8]=b(()=>{},["stop"]))},e[31]||(e[31]=[t("option",{value:""},"Select Type",-1),t("option",{value:"Home Office"},"Home Office",-1),t("option",{value:"Remote Work"},"Remote Work",-1),t("option",{value:"Forget Punch"},"Forget Punch",-1)]),8,Pe),[[de,l.type]])]),t("td",$e,[v(t("input",{type:"time","onUpdate:modelValue":n=>l.check_in=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[9]||(e[9]=b(()=>{},["stop"]))},null,8,je),[[f,l.check_in]])]),t("td",Ne,[v(t("input",{type:"time","onUpdate:modelValue":n=>l.check_out=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[10]||(e[10]=b(()=>{},["stop"]))},null,8,Ee),[[f,l.check_out]])]),t("td",Re,[v(t("textarea",{"onUpdate:modelValue":n=>l.description=n,onKeyup:e[11]||(e[11]=b(()=>{},["stop"])),onClick:e[12]||(e[12]=b(()=>{},["stop"])),disabled:!l.check_in&&!l.check_out,class:"w-full border border-gray-600 py-1 px-2 rounded-sm disabled:bg-gray-300 disabled:cursor-not-allowed",cols:"1"},null,40,Te),[[f,l.description]])])],10,Me))),128)),Y.value.length===0?(i(),d("tr",Le,e[32]||(e[32]=[t("td",{colspan:"6",class:"p-2 text-center text-red-500"},"Please select any employee",-1)]))):w("",!0)])])]),(G=s.value)!=null&&G.employee_id?(i(),d("div",Oe,[t("div",He,[p.value?(i(),d("div",We,u(p.value),1)):w("",!0),t("div",ze,[v(t("input",{id:"directApprove",type:"checkbox","onUpdate:modelValue":e[13]||(e[13]=l=>A.value=l),class:"accent-blue-600 h-6 w-6 cursor-pointer"},null,512),[[K,A.value]]),e[33]||(e[33]=t("label",{for:"directApprove",class:"text-lg cursor-pointer"},"Direct Approve",-1))]),t("div",Ge,[t("button",{type:"button",class:"btn-2",disabled:m.value,onClick:ee},[m.value?(i(),d("span",Je,e[34]||(e[34]=[t("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),y("Submitting... ")]))):(i(),d("span",Ke,"Submit All"))],8,Ie)])])])):w("",!0)]))])}}};export{nt as default};
