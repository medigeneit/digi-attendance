import{d as te,b as le,x as n,r as ae,e as se,A as $,m as oe,c as x,o as r,a as l,f as I,g,F as H,n as h,i as M,t as j,k as c,h as U,B as ne,S as z,v as ue,y as re,j as R,w as de,q as W}from"./index-DBkH8yyG.js";import{g as ie}from"./task-DVwSJewi.js";import{u as me}from"./company-Dt9wELO_.js";import{_ as G}from"./CompanyDepartmentSelectInput-ByDS5Oxb.js";import{_ as pe}from"./EmployeeDropdownInput-BceDnX-W.js";import{_ as K}from"./SearchInput-qBbL7RS5.js";import{S as ve}from"./SelectDropdown-B-DUI2oB.js";const ce={class:"mb-3 task-header"},xe={class:"flex flex-wrap items-center justify-center gap-2 mt-3"},fe={class:"flex flex-wrap gap-x-4 gap-y-3 justify-between"},ye={class:"relative"},be=["title"],ge={key:0},we={key:1,class:"text-gray-500 whitespace-nowrap"},ke={key:1,class:"relative w-full md:w-56 lg:flex-grow"},Ve={class:"relative"},Ce={class:"w-32 relative h-10"},Te={class:"flex gap-4 items-center flex-shrink-0"},he={class:"flex gap-2"},Me={class:"flex gap-2"},Ue={class:"flex gap-2"},Ae={class:"text-gray-600 w-full md:w-32 relative"},De={class:"flex flex-col md:flex-row mb-2 items-end mt-6 gap-6 sticky top-[4.1rem] z-40 bg-white/80"},_e={class:"flex items-center gap-3 flex-grow flex-wrap justify-center"},Le={key:0,class:"text-[9px] text-green-800"},Ee=["onClick"],Se={key:1,class:"flex justify-end gap-5"},Fe={__name:"TaskHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(w,{emit:J}){const A=w,F=te(),f=le(),y=n(p("company-id")),k=n(p("from-department-id")),b=n(p("to-department-id")),D=n(p("user-ids")),_=n(p("month")),L=n(p("status")),E=n(p("is-important")),S=n(p("is-urgent")),N=n(p("is-target")),q=n(p("search")),Q=J,d=me(),V=ae([]);function p(s){return{get:()=>A.modelValue[s]||"",set:e=>{Q("update:modelValue",{...A.modelValue,[s]:e||void 0})}}}const X=n(()=>Y(D.value));async function O(){var s,e,i;if(!A.isMyTask){const m=(s=A.modelValue)==null?void 0:s["company-id"],a=b.value,u={...m?{company_id:m}:{},...a?{department_ids:[a]}:{}};V.value=((i=(e=await ie({params:u}))==null?void 0:e.data)==null?void 0:i.employees)||[]}}se(async()=>{await d.fetchCompanies({with:"departments",ignore_permission:!0}),await d.fetchMyCompanies({with:"departments"}),await O()});function Y(s){return Array.isArray(V.value)&&V.value.find(e=>e.id==s)||null}function Z(){D.value=""}$(()=>b.value,O),$(()=>y.value,()=>{k.value="",b.value=""});function C(s,e,{value:i,id:m,label:a,onCancel:u}={}){if(!s)return[];const o=Array.isArray(e)?e.find(v=>(v==null?void 0:v[m])==s):null;return o?[{label:a,value:typeof i=="function"?i(o):o==null?void 0:o[i],id:o==null?void 0:o[m],onCancel:u}]:[]}const ee=n(()=>{var m;const s=d.companies.reduce((a,u)=>[...a,...u.departments],[]),e=(a,{label:u,value:o,id:v,onCancel:B})=>a?[{label:u,value:o,id:v,onCancel:B}]:[],i=(a,{label:u,onCancel:o})=>{if(!a)return[];const v=new Date(a);return[{label:u,value:v.toLocaleDateString("en-US",{month:"long",year:"numeric"}),id:a,onCancel:o}]};return[...C(y.value,d.companies,{label:"Company",value:"short_name",id:"id",onCancel:()=>{y.value=""}}),...C(k.value,s,{id:"id",label:"From",value:a=>a.short_name||a.name,onCancel:()=>{k.value=""}}),...C(b.value,s,{id:"id",label:"To",value:a=>a.short_name||a.name,onCancel:()=>{b.value=""}}),...C((m=X.value)==null?void 0:m.id,V.value,{label:"Employee",value:"name",id:"id",onCancel:Z}),...C(L.value,[{id:"only-completed",name:"Completed Only"},{id:"not-completed",name:"Not Completed"}],{label:"",value:"name",id:"id",onCancel:()=>{L.value=""}}),...e(E.value,{label:"",value:"Important ",id:!0,onCancel:()=>{E.value=""}}),...e(S.value,{label:"",value:"Urgent ",id:!0,onCancel:()=>{S.value=""}}),...e(N.value,{label:"",value:"Targeted Task",id:!0,onCancel:()=>{N.value=""}}),...i(_.value,{label:"",onCancel:()=>{_.value=""}})]}),P=n(()=>y.value?d==null?void 0:d.companies.filter(s=>s.id==y.value):d==null?void 0:d.companies);return(s,e)=>{var m,a,u,o,v,B;const i=oe("RouterLink");return r(),x("div",null,[l("div",ce,[e[22]||(e[22]=l("div",{class:"flex justify-between items-start"},[l("h2",{class:"text-2xl font-bold text-gray-800 leading-none h-10"},"Task List")],-1)),l("div",xe,[l("div",fe,[w.isMyTask?g("",!0):(r(),x(H,{key:0},[l("div",ye,[h(ve,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),options:((m=c(d))==null?void 0:m.companies)||[],label:"name",id:"id",class:"border-2 border-gray-300 rounded h-[40px] w-full md:w-48 bg-white text-sm",clearable:""},{"selected-option":M(({option:t})=>[l("div",{class:"line-clamp-1 text-sm text-gray-900",title:t==null?void 0:t.name},[t!=null&&t.name?(r(),x("span",ge,j(t==null?void 0:t.name),1)):(r(),x("span",we,"--Select Company--"))],8,be)]),_:1},8,["modelValue","options"]),e[11]||(e[11]=l("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Company ",-1))]),h(G,{modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=t=>k.value=t),companies:P.value||[],class:"relative w-full md:w-40 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:M(()=>e[12]||(e[12]=[l("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),c(f).name!=="MyTaskList"?(r(),I(G,{key:0,modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=t=>b.value=t),companies:P.value||[],class:"relative w-full md:w-40 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:M(()=>e[13]||(e[13]=[l("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):g("",!0),c(F).isAdminMood&&((u=(a=c(F))==null?void 0:a.user)==null?void 0:u.role)!=="employee"?(r(),x("div",ke,[l("div",Ve,[h(pe,{employees:V.value,modelValue:D.value,"onUpdate:modelValue":e[3]||(e[3]=t=>D.value=t),class:"border-2 border-gray-300 rounded h-[40px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),e[14]||(e[14]=l("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Employee ",-1))]),e[15]||(e[15]=l("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Employee ",-1))])):g("",!0)],64)),l("div",Ce,[e[17]||(e[17]=l("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),U(l("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>L.value=t),class:"h-full text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},e[16]||(e[16]=[l("option",{value:""},"--ALL TASKS--",-1),l("option",{value:"not-completed"},"Not Completed",-1),l("option",{value:"only-completed"},"Completed",-1)]),512),[[ne,L.value]])]),l("div",Te,[l("label",he,[U(l("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=t=>E.value=t)},null,512),[[z,E.value]]),e[18]||(e[18]=l("span",null,"Important",-1))]),l("label",Me,[U(l("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=t=>S.value=t)},null,512),[[z,S.value]]),e[19]||(e[19]=l("span",null,"Urgent",-1))]),l("label",Ue,[U(l("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=t=>N.value=t)},null,512),[[z,N.value]]),e[20]||(e[20]=l("span",null,"Is Target",-1))])]),l("div",Ae,[e[21]||(e[21]=l("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),U(l("input",{id:"month-filter","onUpdate:modelValue":e[8]||(e[8]=t=>_.value=t),type:"month",class:"h-10 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[ue,_.value]])])]),w.isMyTask?(r(),I(K,{key:0,modelValue:q.value,"onUpdate:modelValue":e[9]||(e[9]=t=>q.value=t),class:"w-full md:w-64 lg:w-64 md:ml-auto"},null,8,["modelValue"])):g("",!0)])]),l("div",De,[w.isMyTask?g("",!0):(r(),I(K,{key:0,modelValue:q.value,"onUpdate:modelValue":e[10]||(e[10]=t=>q.value=t),class:"w-full md:w-64 md:ml-auto"},null,8,["modelValue"])),l("div",_e,[(r(!0),x(H,null,re(ee.value,t=>(r(),x("div",{key:t.label||t.value,class:"flex-shrink-0 text-xs bg-gray-50 border border-gray-300 rounded-md px-2 flex gap-1"},[l("div",null,[t.label?(r(),x("span",Le,j(t.label)+": ",1)):g("",!0),R(j(t.value),1)]),l("button",{type:"button",class:"text-gray-400 hover:text-red-400",onClick:de(t.onCancel,["prevent"])},e[23]||(e[23]=[l("i",{class:"fas fa-times-circle"},null,-1)]),8,Ee)]))),128))]),w.isMyTask?g("",!0):(r(),x("div",Se,[h(i,{class:W(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((o=c(f).query)==null?void 0:o.view)==="userwise"?"bg-blue-500 text-white":""]),to:{query:{...c(f).query,view:"userwise"}}},{default:M(()=>e[24]||(e[24]=[R(" User Wise List ")])),_:1,__:[24]},8,["class","to"]),h(i,{class:W(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((v=c(f).query)==null?void 0:v.view)!=="userwise"?"bg-blue-500 text-white":""]),to:{query:{...Object.keys(((B=c(f))==null?void 0:B.query)||{}).filter(t=>{var T;return((T=c(f))==null?void 0:T.query[t])!=="userwise"}).reduce((t,T)=>({...t,[T]:c(f).query[T]}),{})}}},{default:M(()=>e[25]||(e[25]=[R(" TaskWise List ")])),_:1,__:[25]},8,["class","to"])]))])])}}};export{Fe as _};
