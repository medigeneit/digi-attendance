import{u as Ot,r as g,p as Ft,b as Pt,c as n,a as e,k as a,j as Et,t as l,F as m,x as k,h as c,e as u,y as Rt,l as Ut,d as zt,v as qt,f as Gt,o as r,g as Jt}from"./index-DADV3kUN.js";import{L as Kt}from"./LoaderView-BBxKn_1l.js";import{_ as Qt}from"./ShareComponent-BNyLUilm.js";import{u as Xt}from"./leave-application-sfk80No2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Yt={class:"my-container max-w-3xl space-y-6"},Zt={key:1,class:"card-bg p-4 md:p-8"},es={class:"title-lg text-center"},ts={class:"text-center text-sm"},ss={class:"space-y-4"},ls={class:"grid md:grid-cols-2 print:grid-cols-2 gap-8"},as={class:""},os={class:"text-sm"},rs={class:"flex justify-end gap-4"},ns={class:"table-auto border border-black bg-white text-xs"},ds={class:"border border-black px-2"},is={class:"border border-black px-2"},us={class:"font-bold"},ps={class:"border border-black px-2"},cs={class:"table-auto border border-black bg-white text-xs"},vs={class:"border border-black"},bs={colspan:"2",class:"border border-black px-2 w-32"},ys={class:"border border-black px-2"},_s={class:"border border-black px-2"},xs={class:"font-bold"},ms={class:"border border-black px-2"},fs={class:"grid print:grid-cols-2 md:grid-cols-2 text-sm"},gs={class:"text-sm"},ks={class:"pt-8 grid grid-cols-2"},As={class:"text-sm"},ws={class:"flex flex-col justify-center items-center text-sm"},js={key:0,class:"print:hidden"},hs={class:"text-xs text-center"},Ls={class:"flex justify-center gap-2"},Cs={class:"font-bold"},Bs={key:0,class:"text-green-600 print:text-black"},Rs={key:1,class:"pl-2 text-yellow-700"},Ds={class:"overflow-x-auto"},Ns={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Is={class:"border border-gray-500 px-4 py-0.5 text-left"},Ts={class:"border border-gray-500 px-4 py-0.5 text-center"},Ws={class:"border border-gray-500 px-4 py-0.5 text-center"},$s={class:"space-y-14"},Ss={class:"font-bold text-center text-lg"},Vs={key:0},Hs={class:"grid md:grid-cols-3 print:grid-cols-3 gap-4 text-sm items-end"},Ms={class:"flex flex-col justify-center items-center"},Os={key:0,class:"print:hidden"},Fs={class:"text-center"},Ps={class:"text-xs text-center text-blue-600"},Es={class:"flex justify-center gap-4"},Us={class:"font-bold"},zs={key:0,class:"text-green-600"},qs={class:"flex flex-col justify-center items-center"},Gs={key:0,class:"print:hidden"},Js={class:"text-center"},Ks={class:"text-xs text-center text-blue-600"},Qs={class:"flex justify-center gap-4"},Xs={class:"font-bold"},Ys={key:0,class:"text-green-600"},Zs={class:"flex flex-col justify-center items-center"},el={key:0,class:"print:hidden"},tl={class:"text-center"},sl={class:"text-xs text-center text-blue-600"},ll={class:"flex justify-center gap-4"},al={class:"font-bold"},ol={key:0,class:"text-green-600"},rl={class:"flex justify-evenly text-sm items-end"},nl={class:"flex flex-col justify-center items-center"},dl={key:0,class:"print:hidden"},il={class:"text-center"},ul={class:"text-xs text-center text-blue-600"},pl={class:"flex justify-center gap-4"},cl={class:"font-bold"},vl={key:0,class:"text-green-600"},bl={class:"flex flex-col justify-center items-center"},yl={key:0,class:"print:hidden"},_l={class:"text-center"},xl={class:"text-xs text-center text-blue-600"},ml={class:"flex justify-center gap-4"},fl={class:"font-bold"},gl={key:0,class:"text-green-600"},kl={key:0,class:"modal-bg"},Al={class:"modal-card"},wl={class:"flex justify-end gap-2 mt-4"},Dl={__name:"LeaveApplicationShow",setup(jl){const v=Ot(),i=Xt(),Dt=Jt(),f=Gt(),A=g(!0),y=g(!1),_=g(""),s=Ft(()=>i.leaveApplication);Pt(async()=>{var t;const{id:d}=f.params;try{await i.fetchLeaveApplicationById(d),await i.fetchLeaveBalance((t=i==null?void 0:i.leaveApplication)==null?void 0:t.user_id)}catch(x){console.error("Failed to load leave application:",x)}finally{A.value=!1}});async function Nt(){try{await i.rejectLeaveApplication(f.params.id,{rejection_reason:_.value}),alert("Leave application rejected successfully!"),y.value=!1,_.value="",await i.fetchLeaveApplicationById(f.params.id)}catch(d){alert(d.message)}}function b(){y.value=!0}async function It(d){try{await i.acceptHandover(d),alert("Handover accepted successfully!"),await i.fetchLeaveApplicationById(d)}catch(t){alert(t.message)}}async function Tt(d){try{await i.acceptInCharge(d),alert("Leave Application Successfully Accepted!"),await i.fetchLeaveApplicationById(d)}catch(t){alert(t.message)}}async function Wt(d){try{await i.acceptCoordinator(d),alert("Coordinator accepted successfully!"),await i.fetchLeaveApplicationById(d)}catch(t){alert(t.message)}}async function $t(d){try{await i.acceptOperationalAdmin(d),alert("Operational Admin accepted successfully!"),await i.fetchLeaveApplicationById(d)}catch(t){alert(t.message)}}async function St(d){try{await i.acceptRecommendBy(d),alert("Recommendation accepted successfully!"),await i.fetchLeaveApplicationById(d)}catch(t){alert(t.message)}}async function Vt(d){try{await i.acceptApprovedBy(d),alert("Leave Application approved successfully!"),await i.fetchLeaveApplicationById(d)}catch(t){alert(t.message)}}function Ht(){window.print()}const Mt=()=>Dt.go(-1);return(d,t)=>{var x,w,j,h,L,C,B,R,D,N,I,T,W,$,S,V,H,M,O,F,P,E,U,z,q,G,J,K,Q,X,Y,Z,ee,te,se,le,ae,oe,re,ne,de,ie,ue,pe,ce,ve,be,ye,_e,xe,me,fe,ge,ke,Ae,we,je,he,Le,Ce,Be,Re,De,Ne,Ie,Te,We,$e,Se,Ve,He,Me,Oe,Fe,Pe,Ee,Ue,ze,qe,Ge,Je,Ke,Qe,Xe,Ye,Ze,et,tt,st,lt,at,ot,rt,nt,dt,it,ut,pt,ct,vt,bt,yt,_t,xt,mt,ft,gt,kt,At,wt,jt,ht,Lt,Ct,Bt;return r(),n(m,null,[e("div",Yt,[e("div",{class:"flex items-center justify-between gap-2 print:hidden"},[e("button",{class:"btn-3",onClick:Mt},t[8]||(t[8]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[10]||(t[10]=e("h1",{class:"title-md md:title-xl flex-wrap text-center"},"Leave Application",-1)),e("div",null,[e("button",{class:"btn-2",onClick:Ht},t[9]||(t[9]=[e("i",{class:"far fa-print"},null,-1),a(" Print ")]))])]),A.value?(r(),Et(Kt,{key:0})):(r(),n("div",Zt,[e("div",null,[e("h1",es,l((j=(w=(x=s.value)==null?void 0:x.user)==null?void 0:w.company)==null?void 0:j.name),1),e("p",ts,l((L=(h=s.value)==null?void 0:h.user)==null?void 0:L.company.address),1)]),e("div",ss,[e("div",ls,[e("div",null,[t[11]||(t[11]=e("p",null,"To",-1)),t[12]||(t[12]=e("p",{class:"font-bold"},"Managing Director",-1)),e("p",as,l((R=(B=(C=s.value)==null?void 0:C.user)==null?void 0:B.company)==null?void 0:R.name),1),e("p",os,l((N=(D=s.value)==null?void 0:D.user)==null?void 0:N.company.address),1),t[13]||(t[13]=e("div",null,[e("p",{class:"pt-6"},[e("b",null,"Subject:"),a(" Leave Application")])],-1))]),e("div",rs,[e("div",null,[t[16]||(t[16]=e("h1",{class:"font-bold"},"Summary",-1)),e("table",ns,[t[15]||(t[15]=e("thead",null,[e("tr",{class:"bg-gray-200 border border-black"},[e("th",{class:"border border-black px-2"},"Type"),e("th",{class:"border border-black px-2"},"Days")])],-1)),e("tbody",null,[(r(!0),n(m,null,k((I=s.value)==null?void 0:I.leave_types,(o,p)=>(r(),n("tr",{key:p,class:"border border-black"},[e("td",ds,l(o.type),1),e("td",is,l(o.days),1)]))),128)),e("tr",us,[t[14]||(t[14]=e("td",{class:"border border-black px-2"},"Total",-1)),e("td",ps,l((T=s.value)==null?void 0:T.total_leave_days),1)])])])]),e("div",null,[t[20]||(t[20]=e("h1",{class:"font-bold"},"Last Leave",-1)),e("div",null,[e("table",cs,[e("thead",null,[t[17]||(t[17]=e("tr",{class:"bg-gray-200 border border-black"},[e("th",{colspan:"2",class:"border border-black px-2"},"Date")],-1)),e("tr",vs,[e("td",bs,l(((W=s.value)==null?void 0:W.last_leave.date)||"N/A"),1)]),t[18]||(t[18]=e("tr",{class:"bg-gray-200 border border-black"},[e("th",{class:"border border-black px-2"},"Type"),e("th",{class:"border border-black px-2"},"Days")],-1))]),e("tbody",null,[(r(!0),n(m,null,k((S=($=s.value)==null?void 0:$.last_leave)==null?void 0:S.types,(o,p)=>(r(),n("tr",{key:p,class:"border border-black"},[e("td",ys,l(o==null?void 0:o.type),1),e("td",_s,l(o==null?void 0:o.days),1)]))),128)),e("tr",xs,[t[19]||(t[19]=e("td",{class:"border border-black px-2"},"Total",-1)),e("td",ms,l((H=(V=s.value)==null?void 0:V.last_leave)!=null&&H.types?s.value.last_leave.types.reduce((o,p)=>o+p.days,0):0),1)])])])])])])]),e("div",null,[t[27]||(t[27]=e("h3",{class:"font-bold"},"Leave Details:",-1)),e("div",fs,[e("li",null,[t[21]||(t[21]=e("strong",null,"Reason: ",-1)),a(l(((M=s.value)==null?void 0:M.reason)||"No reason provided"),1)]),e("li",null,[t[22]||(t[22]=e("strong",null,"Leave Days:",-1)),a(" "+l((O=s.value)==null?void 0:O.leave_period),1)]),e("li",null,[t[23]||(t[23]=e("strong",null,"Total Days:",-1)),a(" "+l((F=s.value)==null?void 0:F.total_leave_days),1)]),e("li",null,[t[24]||(t[24]=e("strong",null,"Weekends:",-1)),a(" "+l((P=s.value)==null?void 0:P.user.weekends.join(", ")),1)]),e("li",null,[t[25]||(t[25]=e("strong",null,"Last Working Date:",-1)),a(" "+l((E=s.value)==null?void 0:E.last_working_date),1)]),e("li",null,[t[26]||(t[26]=e("strong",null,"Resumption Date:",-1)),a(" "+l((U=s.value)==null?void 0:U.resumption_date),1)])])]),e("div",gs,[e("p",null,[t[28]||(t[28]=e("strong",null,"Works in Hand: ",-1)),a(l(((z=s.value)==null?void 0:z.works_in_hand)||"No details provided"),1)])]),e("div",ks,[e("div",null,[e("div",As,[t[33]||(t[33]=e("hr",{class:"w-44 border-black hidden print:block"},null,-1)),e("p",null,[t[29]||(t[29]=e("strong",null,"Applicant:",-1)),a(" "+l((G=(q=s.value)==null?void 0:q.user)==null?void 0:G.name),1)]),e("p",null,[t[30]||(t[30]=e("strong",null,"Designation:",-1)),a(" "+l((Q=(K=(J=s.value)==null?void 0:J.user)==null?void 0:K.designation)==null?void 0:Q.title),1)]),e("p",null,[t[31]||(t[31]=e("strong",null,"Department:",-1)),a(" "+l((Z=(Y=(X=s.value)==null?void 0:X.user)==null?void 0:Y.department)==null?void 0:Z.name),1)]),e("p",null,[t[32]||(t[32]=e("strong",null,"Phone:",-1)),a(" "+l((te=(ee=s.value)==null?void 0:ee.user)==null?void 0:te.phone),1)])])]),e("div",ws,[e("p",null,l(((le=(se=s.value)==null?void 0:se.handover_user)==null?void 0:le.name)||"Not assigned"),1),!((ae=s.value)!=null&&ae.status)&&s.value.handover_user_id===c(v).user.id?(r(),n("div",js,[e("p",hs,[a(l((re=(oe=s.value)==null?void 0:oe.user)==null?void 0:re.name)+" has assigned you for his handover. ",1),t[34]||(t[34]=e("br",null,null,-1)),t[35]||(t[35]=a(" Do you agree? "))]),e("div",Ls,[e("button",{class:"font-bold text-lg text-green-600 px-2",onClick:t[0]||(t[0]=o=>It(s.value.id))}," ✔ "),t[36]||(t[36]=e("button",{class:"px-2"},"❌",-1))])])):u("",!0),t[39]||(t[39]=e("hr",{class:"w-44 border-black"},null,-1)),e("h4",Cs,[t[38]||(t[38]=a(" Handover ")),(ne=s.value)!=null&&ne.handover_user_id&&((de=s.value)!=null&&de.status)?(r(),n("span",Bs," (✔) ")):u("",!0),(ie=s.value)!=null&&ie.handover_user_id&&!((ue=s.value)!=null&&ue.status)?(r(),n("span",Rs,t[37]||(t[37]=[e("i",{class:"fad fa-spinner"},null,-1)]))):u("",!0)])])]),e("div",null,[t[41]||(t[41]=e("h1",{class:"font-bold"},"Leave Balance",-1)),e("div",Ds,[e("table",Ns,[t[40]||(t[40]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-500 px-4 py-0.5 text-left"},"Leave Type"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Total Days"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Used Days"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Remaining Days")])],-1)),e("tbody",null,[(r(!0),n(m,null,k(c(i).leaveBalance,(o,p)=>(r(),n("tr",{key:p,class:"hover:bg-blue-200"},[e("td",Is,l(o.leave_type),1),e("td",Ts,l(o.total_leave_days),1),e("td",Ws,l(o.used_days),1),e("td",{class:Rt(["border border-gray-500 px-4 py-0.5 text-center",{"text-green-600 font-bold":o.remaining_days>0,"text-red-600 font-bold":o.remaining_days===0}])},l(o.remaining_days),3)]))),128))])])])])]),e("div",$s,[e("p",Ss,[t[42]||(t[42]=a(" Leave Approval: ")),e("b",{class:Rt({"text-yellow-600":((pe=s.value)==null?void 0:pe.status)==="Pending","text-green-600":((ce=s.value)==null?void 0:ce.status)==="Approved","text-red-600":((ve=s.value)==null?void 0:ve.status)==="Rejected"})},l(((be=s.value)==null?void 0:be.status)||"N/A"),3)]),((ye=s.value)==null?void 0:ye.status)==="Rejected"?(r(),n("div",Vs,[e("p",null,[t[43]||(t[43]=e("b",null,"Rejected by: ",-1)),a(" "+l((xe=(_e=s.value)==null?void 0:_e.rejected_by_user)==null?void 0:xe.name),1)]),e("p",null,[t[44]||(t[44]=e("b",null,"rejection Reason: ",-1)),a(" "+l(s.value.rejection_reason),1)])])):u("",!0),e("div",Hs,[e("div",Ms,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((me=s.value)!=null&&me.in_charge_user_id)&&((ke=(ge=(fe=s.value)==null?void 0:fe.user)==null?void 0:ge.leave_approval)==null?void 0:ke.in_charge_user_id)===c(v).user.id?(r(),n("div",Os,[e("p",Fs,l(((he=(je=(we=(Ae=s.value)==null?void 0:Ae.user)==null?void 0:we.leave_approval)==null?void 0:je.in_charge_user)==null?void 0:he.name)||"N/A"),1),e("p",Ps,[a(l((Ce=(Le=s.value)==null?void 0:Le.user)==null?void 0:Ce.name)+" has submitted an application. ",1),t[45]||(t[45]=e("br",null,null,-1)),t[46]||(t[46]=a(" Will you forward it? "))]),e("div",Es,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[1]||(t[1]=o=>Tt(s.value.id))}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):u("",!0),e("p",null,l(((Re=(Be=s.value)==null?void 0:Be.in_charge_user)==null?void 0:Re.name)||""),1),t[48]||(t[48]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Us,[t[47]||(t[47]=a(" In-Charge ")),(De=s.value)!=null&&De.in_charge_user_id?(r(),n("span",zs,"(✔)")):u("",!0)])]),e("div",qs,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Ne=s.value)!=null&&Ne.coordinator_user_id)&&((We=(Te=(Ie=s.value)==null?void 0:Ie.user)==null?void 0:Te.leave_approval)==null?void 0:We.coordinator_user_id)===c(v).user.id?(r(),n("div",Gs,[e("p",Js,l(((He=(Ve=(Se=($e=s.value)==null?void 0:$e.user)==null?void 0:Se.leave_approval)==null?void 0:Ve.coordinator_user)==null?void 0:He.name)||"N/A"),1),e("p",Ks,[a(l((Oe=(Me=s.value)==null?void 0:Me.user)==null?void 0:Oe.name)+" has submitted an application. ",1),t[49]||(t[49]=e("br",null,null,-1)),t[50]||(t[50]=a(" Will you recommend it? "))]),e("div",Qs,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[2]||(t[2]=o=>Wt(s.value.id))}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):u("",!0),e("p",null,l(((Pe=(Fe=s.value)==null?void 0:Fe.coordinator_user)==null?void 0:Pe.name)||""),1),t[52]||(t[52]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Xs,[t[51]||(t[51]=a(" Coordinator ")),(Ee=s.value)!=null&&Ee.coordinator_user_id?(r(),n("span",Ys,"(✔)")):u("",!0)])]),e("div",Zs,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Ue=s.value)!=null&&Ue.operational_admin_user_id)&&((Ge=(qe=(ze=s.value)==null?void 0:ze.user)==null?void 0:qe.leave_approval)==null?void 0:Ge.operational_admin_user_id)===c(v).user.id?(r(),n("div",el,[e("p",tl,l(((Xe=(Qe=(Ke=(Je=s.value)==null?void 0:Je.user)==null?void 0:Ke.leave_approval)==null?void 0:Qe.operational_admin_user)==null?void 0:Xe.name)||"N/A"),1),e("p",sl,[a(l((Ze=(Ye=s.value)==null?void 0:Ye.user)==null?void 0:Ze.name)+" has submitted an application.",1),t[53]||(t[53]=e("br",null,null,-1)),t[54]||(t[54]=a(" Will you recommend it? "))]),e("div",ll,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[3]||(t[3]=o=>$t(s.value.id))}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):u("",!0),e("p",null,l(((tt=(et=s.value)==null?void 0:et.operational_admin_user)==null?void 0:tt.name)||""),1),t[56]||(t[56]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",al,[t[55]||(t[55]=a(" Operational Admin ")),(st=s.value)!=null&&st.operational_admin_user_id?(r(),n("span",ol,"(✔)")):u("",!0)])])]),e("div",rl,[e("div",nl,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((lt=s.value)!=null&&lt.recommend_by_user_id)&&((rt=(ot=(at=s.value)==null?void 0:at.user)==null?void 0:ot.leave_approval)==null?void 0:rt.recommend_by_user_id)===c(v).user.id?(r(),n("div",dl,[e("p",il,l(((ut=(it=(dt=(nt=s.value)==null?void 0:nt.user)==null?void 0:dt.leave_approval)==null?void 0:it.recommend_by_user)==null?void 0:ut.name)||"N/A"),1),e("p",ul,[a(l((ct=(pt=s.value)==null?void 0:pt.user)==null?void 0:ct.name)+" has submitted an application.",1),t[57]||(t[57]=e("br",null,null,-1)),t[58]||(t[58]=a(" Will you recommend it? "))]),e("div",pl,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[4]||(t[4]=o=>St(s.value.id))}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):u("",!0),e("p",null,l(((bt=(vt=s.value)==null?void 0:vt.recommend_by_user)==null?void 0:bt.name)||""),1),t[60]||(t[60]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",cl,[t[59]||(t[59]=a(" Recommend By ")),(yt=s.value)!=null&&yt.recommend_by_user_id?(r(),n("span",vl,"(✔)")):u("",!0)])]),e("div",bl,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((_t=s.value)!=null&&_t.approved_by_user_id)&&((ft=(mt=(xt=s.value)==null?void 0:xt.user)==null?void 0:mt.leave_approval)==null?void 0:ft.approved_by_user_id)===c(v).user.id?(r(),n("div",yl,[e("p",_l,l(((wt=(At=(kt=(gt=s.value)==null?void 0:gt.user)==null?void 0:kt.leave_approval)==null?void 0:At.approved_by_user)==null?void 0:wt.name)||"N/A"),1),e("p",xl,[a(l((ht=(jt=s.value)==null?void 0:jt.user)==null?void 0:ht.name)+" has submitted an application.",1),t[61]||(t[61]=e("br",null,null,-1)),t[62]||(t[62]=a(" Will you accept it? "))]),e("div",ml,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[5]||(t[5]=o=>Vt(s.value.id))}," ✔ "),e("button",{class:"",onClick:b},"❌")])])):u("",!0),e("p",null,l(((Ct=(Lt=s.value)==null?void 0:Lt.approved_by_user)==null?void 0:Ct.name)||""),1),t[64]||(t[64]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",fl,[t[63]||(t[63]=a(" Approved By ")),(Bt=s.value)!=null&&Bt.approved_by_user_id?(r(),n("span",gl,"(✔)")):u("",!0)])])])])])),Ut(Qt)]),y.value?(r(),n("div",kl,[e("div",Al,[t[65]||(t[65]=e("h3",{class:"title-lg"},"Reject Application",-1)),zt(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=o=>_.value=o),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[qt,_.value]]),e("div",wl,[e("button",{class:"btn-3",onClick:t[7]||(t[7]=o=>y.value=!1)},"Cancel"),e("button",{class:"btn-2 bg-red-500 text-white",onClick:Nt},"Confirm")])])])):u("",!0)],64)}}};export{Dl as default};
