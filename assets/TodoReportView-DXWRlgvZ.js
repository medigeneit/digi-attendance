import{r as $,G as Le,x as h,q as W,c as d,o,a as e,N as $e,w as J,s as w,d as de,k as Ne,v as Ce,f as Ye,u as Xe,D as Re,h as ae,y as Ae,j as v,i as Ze,l as re,m as P,t as p,F as T,e as U,b as X,M as qe}from"./index-DcjL1Qpg.js";import{L as Ge}from"./LoaderView-DYATgs4r.js";import{_ as et}from"./EmployeeFilter-D97ua-IO.js";import{_ as tt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as Ee,b as H}from"./datetime-BEfC2TVK.js";import{u as st}from"./attendance-BdHxaIKx.js";import{u as nt}from"./company-BKo6FwJe.js";import{u as at}from"./department-DMwNlYDd.js";import{u as rt}from"./useTodoDateStore-BmAY4Lup.js";import"./EmployeeDropdownInput-DDF0_QHo.js";import"./SelectDropdown-gGuHoMl6.js";import"./UserChip-C3K3bcC0.js";import"./url-CePbr-gY.js";const ot={class:"px-4 py-4 md:py-3 bg-white rounded-md border"},dt={class:"flex flex-wrap items-center gap-3"},lt=["disabled"],it={class:"print-hide"},pt={class:"flex flex-col md:flex-row flex-wrap items-end md:ml-auto w-full md:w-auto gap-x-3 gap-y-4 print-hide"},ut={class:"flex items-center justify-between w-full md:w-auto gap-3"},mt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},yt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},ct={__name:"TodoReportHeading",props:{loading:{type:Boolean,default:!1},companyId:{type:[String,Number],default:""},departmentId:{type:[String,Number],default:""},employeeId:{type:[String,Number],default:""},lineType:{type:String,default:"all"},startDate:{type:String,default:""},endDate:{type:String,default:""}},emits:["reloadClick","change"],setup(B,{expose:S,emit:Z}){const u=B,E=$(null),O=Z,i=Le({companyId:String(u.companyId||""),departmentId:u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",employeeId:String(u.employeeId||""),lineType:u.lineType||"all",startDate:u.startDate||"",endDate:u.endDate||""}),z=h(()=>({companyId:i.companyId,departmentId:i.departmentId,employeeId:i.employeeId,lineType:i.lineType,startDate:i.startDate,endDate:i.endDate}));function K(){O("change",{...z.value})}W(()=>[u.companyId,u.departmentId,u.employeeId,u.lineType,u.startDate,u.endDate],()=>{i.companyId=String(u.companyId||""),i.departmentId=u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",i.employeeId=String(u.employeeId||""),i.lineType=u.lineType||"all",i.startDate=u.startDate||"",i.endDate=u.endDate||""});function M(t){const l=new Date(i.startDate);l.setDate(l.getDate()+t),i.startDate=l.toISOString().split("T")[0];const c=new Date(i.endDate);c.setDate(c.getDate()+t),i.endDate=c.toISOString().split("T")[0]}return W(z,K,{deep:!0}),S({employees:h(()=>{var t;return((t=E.value)==null?void 0:t.employees)||[]})}),(t,l)=>(o(),d("div",ot,[e("div",dt,[$e(t.$slots,"before",{},void 0,!0),e("button",{class:w(["btn-icon print-hide",{"animate-spin !bg-opacity-0":B.loading}]),onClick:l[0]||(l[0]=J(c=>O("reloadClick"),["prevent"])),disabled:B.loading,title:"Reload"},[e("i",{class:w(["fas fa-redo",[B.loading?"text-gray-400":"text-gray-500"]])},null,2)],10,lt),e("span",it,[$e(t.$slots,"after",{},void 0,!0)]),e("div",pt,[de(et,{ref_key:"employeeFilterRef",ref:E,company_id:i.companyId,"onUpdate:company_id":l[1]||(l[1]=c=>i.companyId=c),department_id:i.departmentId,"onUpdate:department_id":l[2]||(l[2]=c=>i.departmentId=c),employee_id:i.employeeId,"onUpdate:employee_id":l[3]||(l[3]=c=>i.employeeId=c),line_type:i.lineType,"onUpdate:line_type":l[4]||(l[4]=c=>i.lineType=c),"with-type":!0,class:"flex-1 gap-y-4 md:flex items-center justify-between w-full md:w-auto"},null,8,["company_id","department_id","employee_id","line_type"]),e("div",ut,[e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:l[5]||(l[5]=J(()=>M(-1),["prevent"]))},l[9]||(l[9]=[e("span",{class:"fas fa-arrow-left"},null,-1)])),e("div",mt,[l[10]||(l[10]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Start Date",-1)),Ne(e("input",{type:"date","onUpdate:modelValue":l[6]||(l[6]=c=>i.startDate=c),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ce,i.startDate]])]),e("div",yt,[l[11]||(l[11]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"End Date",-1)),Ne(e("input",{type:"date","onUpdate:modelValue":l[7]||(l[7]=c=>i.endDate=c),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ce,i.endDate]])]),e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:l[8]||(l[8]=J(()=>M(1),["prevent"]))},l[12]||(l[12]=[e("span",{class:"fas fa-arrow-right"},null,-1)]))])])])]))}},gt=tt(ct,[["__scopeId","data-v-c25b1fcb"]]),xt={class:"container print:flex-grow mx-auto print:w-full print:px-0 print:py-0"},ft=["disabled"],bt={key:0,class:"bg-white border rounded-md mb-2 p-4 text-sm print:border-0 print:mb-2 print:px-0 print:w-full relative overflow-visible z-40"},vt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-y-2 gap-x-6"},wt={class:"font-medium text-gray-800"},ht={class:"col-span-2"},Dt={class:"font-medium text-gray-800"},_t={class:"inline-flex items-center gap-5 font-bold"},kt={class:"text-gray-700"},Tt={key:0,class:"mt-2 w-[280px] sm:w-[320px] lg:w-[280px] xl:w-[320px] bg-white border border-gray-200 rounded-md p-3 shadow-lg text-left absolute right-0"},St={class:"flex items-center justify-between mb-2"},It={class:"text-[11px] text-gray-500"},$t={class:"space-y-3 max-h-56 overflow-auto pr-1 z-50"},Nt={class:"pt-2 border-t border-dashed border-gray-200"},Ct={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1 flex items-center justify-between"},Rt={class:"flex items-center gap-2"},At={key:0,class:"bg-red-500 rounded-md px-1.5 text-white text-center"},Et={key:0,class:"flex flex-wrap gap-2"},Lt={key:0,class:"text-xs text-gray-400"},jt=["title"],Ut={class:"block max-w-[160px] truncate"},Bt={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1"},Ot={key:0,class:"bg-green-500 rounded-md px-1.5 text-white text-center"},zt={class:"flex flex-wrap gap-2"},Mt={key:0,class:"text-xs text-gray-400"},Vt=["title"],Ft={class:"block max-w-[160px] truncate"},Pt={key:1,class:"text-center text-gray-500 py-12 border bg-gray-50 rounded-md min-h-[70vh] flex flex-col items-center justify-center space-y-4"},Ht={key:3,class:"overflow-x-auto md:overflow-clip bg-white border border-t-0 rounded-md shadow-sm print:shadow-none print:rounded-none print:border-gray-400"},Wt={class:"min-w-full text-left text-sm border-separate border-spacing-0"},Jt={class:"bg-gray-50 text-gray-600 uppercase tracking-wide text-xs"},Kt={class:"border-y print:border-gray-400 sticky md:top-[123px] z-30 rounded-t-md"},Qt={class:"px-4 py-3 border md:w-[100px] print:w-auto print:border-l print:border-l-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center whitespace-nowrap"},Yt={class:"flex items-center justify-between gap-2"},Xt={class:"ml-1 text-[10px] text-gray-500"},Zt={key:0,class:"px-4 py-3 border bg-white bg-opacity-70 backdrop-blur-sm text-center"},qt={class:"divide-y divide-gray-200"},Gt={key:0},es=["colspan"],ts=["rowspan"],ss={class:"sticky top-[180px] bg-white text-center"},ns=["rowspan"],as={class:"sticky top-[180px] bg-white flex"},rs={key:0,class:"text-xs text-gray-500"},os=["rowspan"],ds={class:"sticky top-[180px] bg-white"},ls={key:0,class:"text-[11px] text-gray-500 mt-2"},is={key:0,class:"grid grid-cols-2 gap-4"},ps={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},us={class:"flex gap-1 items-center justify-between"},ms={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},ys={class:"flex gap-1 items-center justify-between"},cs={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},gs={class:"flex gap-1 items-center justify-between"},xs={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},fs={class:"flex gap-1 items-center justify-between"},bs={key:1,class:"mt-1 text-gray-500"},vs=["rowspan"],ws={class:"sticky top-[180px] bg-white"},hs={class:"font-medium"},Ds={class:"text-gray-400 mr-2"},_s={class:"text-xs text-gray-500"},oe="border-b-2 border-b-blue-200",Bs={__name:"TodoReportView",setup(B){var ye,ce,ge,xe,fe,be;const S=Ye(),Z=Xe(),u=rt(),E=nt(),O=at(),{companies:i}=Re(E),{departments:z}=Re(O),K=$(null),M=Ee(new Date),t=Le({companyId:((ye=S.query)==null?void 0:ye.company_id)||"",departmentId:((ce=S.query)==null?void 0:ce.department_id)||"",employeeId:((ge=S.query)==null?void 0:ge.employee_id)||"",lineType:((xe=S.query)==null?void 0:xe.line_type)||"all",startDate:((fe=S.query)==null?void 0:fe.start_date)||M,endDate:((be=S.query)==null?void 0:be.end_date)||M}),l=h(()=>{if(!t.startDate||!t.endDate)return[];const n=new Date(t.startDate),s=new Date(t.endDate);if(Number.isNaN(n.getTime())||Number.isNaN(s.getTime()))return[];const r=n<=s?1:-1,m=new Date(n),y=[];for(;y.push(Ee(m)),m.getTime()!==s.getTime();)m.setDate(m.getDate()+r);return y}),c=h(()=>{var s;return[...((s=K.value)==null?void 0:s.employees)||[]].filter(r=>t.employeeId?String(r.id)===String(t.employeeId):!0).sort((r,m)=>{var y,f;return(((y=r.user)==null?void 0:y.name)||"").localeCompare(((f=m.user)==null?void 0:f.name)||"")}).map(r=>{const m=u.todo_dates.filter(a=>{var x;return String((x=a.user)==null?void 0:x.id)===String(r.id)});let y=l.value.map(a=>{const x=m.filter(I=>I.date===a);return x.length?{date:a,rowSpan:x.length,todos:x}:{date:a,rowSpan:1,todos:[{id:`empty-${r.id}-${a}`,isPlaceholder:!0,title:"",date:a}]}});y.length||(y=[{date:null,rowSpan:1,todos:[{id:`empty-${r.id}`,isPlaceholder:!0,title:""}]}]);const f=y.reduce((a,x)=>a+x.rowSpan,0);return{user:r,dates:y,rowSpan:Math.max(1,f)}})}),je=h(()=>{if(!t.startDate||!t.endDate)return"";const n=H(t.startDate,{weekDay:"long"}),s=H(t.endDate,{weekDay:"long"});return`${n} ~ ${s}`}),Ue=h(()=>E.employees||[]),Be={all:"All Types",executive:"Executive",support_staff:"Support Staff",doctor:"Doctor",academy_body:"Academy Body"},C=h(()=>{var y,f,a,x,I,R,A,g;const n=t.companyId&&((y=i.value)!=null&&y.length)?(f=i.value.find(b=>String(b.id)===String(t.companyId)))==null?void 0:f.name:null,s=t.departmentId&&((a=z.value)!=null&&a.length)?(x=z.value.find(b=>String(b.id)===String(t.departmentId)))==null?void 0:x.name:null;let r=null;t.employeeId&&(r=((R=(I=Ue.value)==null?void 0:I.find(b=>String(b.id)===String(t.employeeId)))==null?void 0:R.name)||((g=(A=c.value.find(b=>{var L;return String(((L=b.user)==null?void 0:L.id)||"")===String(t.employeeId)}))==null?void 0:A.user)==null?void 0:g.name)||null);const m=t.startDate===t.endDate&&t.startDate?H(t.startDate,{weekDay:"long"}):je.value||"-";return{company:n||(t.companyId?`#${t.companyId}`:"All Companies"),department:s||(t.departmentId?`#${t.departmentId}`:"All Departments"),employee:r||(t.employeeId?`#${t.employeeId}`:"All Employees"),lineType:Be[t.lineType]||t.lineType||"All Types",dateRange:m}}),j=$(!1),q=$(null),G=h(()=>{var n;return((n=c.value)==null?void 0:n.length)||0}),le=h(()=>{var n,s;return Math.max(0,G.value-(((s=(n=_.value)==null?void 0:n.withoutTodos)==null?void 0:s.length)||0))}),Q=$(!0),ee=$(!1),V=$(!1),te=$(null),ie=n=>{j.value&&q.value&&(q.value.contains(n.target)||(j.value=!1))},_=h(()=>{var n;return(n=c.value)!=null&&n.length?c.value.reduce((s,r,m)=>{var a,x,I,R,A,g;const y=r.dates.reduce((b,L)=>b+L.todos.filter(N=>!N.isPlaceholder).length,0),f={id:((a=r.user)==null?void 0:a.id)??((x=r.user)==null?void 0:x.user_id)??((I=r.user)==null?void 0:I.uid)??((R=r.user)==null?void 0:R.email)??`${((A=r.user)==null?void 0:A.name)||"unknown"}-${m}`,name:((g=r.user)==null?void 0:g.name)||"Unknown user"};return y>0?s.withTodos.push(f):s.withoutTodos.push(f),s},{withTodos:[],withoutTodos:[]}):{withTodos:[],withoutTodos:[]}}),pe=h(()=>{if(!V.value)return c.value;const n=new Set((_.value.withoutTodos||[]).map(s=>String(s.id??s.name??"")));return c.value.filter(s=>{var m,y,f,a,x;const r=((m=s.user)==null?void 0:m.id)??((y=s.user)==null?void 0:y.user_id)??((f=s.user)==null?void 0:f.uid)??((a=s.user)==null?void 0:a.email)??((x=s.user)==null?void 0:x.name)??"";return!n.has(String(r))})});function Oe(){V.value=!V.value,ee.value=V.value}const ue=n=>{ee.value&&te.value&&(te.value.contains(n.target)||(ee.value=!1))},ze=n=>n==="COMPLETED"?"bg-green-100 text-green-700 border border-green-200":n==="WORKING"?"bg-blue-100 text-blue-700 border border-blue-200":n==="PENDING"?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-gray-100 text-gray-700 border border-gray-200";function Me(){Z.replace({query:{...S.query,company_id:t.companyId||void 0,department_id:t.departmentId||void 0,employee_id:t.employeeId||void 0,line_type:t.lineType||void 0,start_date:t.startDate||void 0,end_date:t.endDate||void 0}})}async function se(){!t.companyId||!t.startDate||!t.endDate||(await u.fetchTodoDates({"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate}),We())}function Ve(n){t.companyId=n.companyId||"",t.departmentId=n.departmentId||"",t.employeeId=n.employeeId||"",t.lineType=n.lineType||"all",t.startDate=n.startDate||"",t.endDate=n.endDate||""}function Fe(){window.print()}const Y=h(()=>t.startDate===t.endDate);W(()=>t.companyId,n=>{n&&(O.fetchDepartments(n),E.fetchEmployee(n))},{immediate:!0}),W(()=>({...t}),(n,s)=>{JSON.stringify(n)!==JSON.stringify(s)&&(Me(),se())},{deep:!0}),W(()=>S.query,n=>{t.companyId=(n==null?void 0:n.company_id)||t.companyId,t.departmentId=(n==null?void 0:n.department_id)||t.departmentId,t.employeeId=(n==null?void 0:n.employee_id)||t.employeeId,t.lineType=(n==null?void 0:n.line_type)||t.lineType,t.startDate=(n==null?void 0:n.start_date)||t.startDate,t.endDate=(n==null?void 0:n.end_date)||t.endDate}),ae(()=>{E.fetchCompanies({ignore_permission:!0}),se()}),ae(()=>{document.addEventListener("click",ie,!0)}),Ae(()=>{document.removeEventListener("click",ie,!0)}),ae(()=>{document.addEventListener("click",ue,!0)}),Ae(()=>{document.removeEventListener("click",ue,!0)});const Pe=st(),me=$([]),ne=$(!1),He=h(()=>t.startDate===t.endDate),We=async()=>{if(!(!t.companyId||!t.startDate||!t.endDate)){ne.value=!0;try{const n=await Pe.getDateRangeAttendanceSummary(t.startDate,t.endDate,t.companyId,t.lineType,t.employeeId,!0);n&&(me.value=n)}finally{ne.value=!1}}};function Je(n,s){var m;const r=((m=me.value)==null?void 0:m.find(y=>String(y.employee_id)===String(n)))||null;return r?!s&&He.value?(r==null?void 0:r.attendance[t.startDate])||null:(r==null?void 0:r.attendance[s])||null:null}function Ke(n,s){const r=Je(n,s);return r?{hasData:!0,in:r.in||"-",out:r.out||"-",late:r.late||"-",early:r.early||"-",comment:r.comment||"-"}:{hasData:!1,in:"-",out:"-",late:"-",early:"-",comment:"-"}}function Qe(n,s,r,m){const y=r===n.dates.length-1,f=m===s.todos.length-1;return y&&f}function F(n,s,r,m){return Qe(n,s,r,m)?oe:""}return(n,s)=>{var r,m,y,f;return o(),d("div",xt,[de(gt,{ref_key:"headingRef",ref:K,"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate,loading:P(u).loading,class:"mb-4 print:px-0 print:py-0 print:mb-2 print:border-0 print:border-b print:border-gray-400 print:rounded-none print:w-full sticky top-[58px] z-50",onChange:Ve,onReloadClick:se},{before:re(()=>s[3]||(s[3]=[e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-800"},"Todo Report")],-1)])),after:re(()=>[e("button",{type:"button",class:"btn-icon print-hide disabled:opacity-35 cursor-pointer disabled:cursor-not-allowed",onClick:J(Fe,["prevent"]),disabled:P(u).loading},s[4]||(s[4]=[e("i",{class:"fas fa-print"},null,-1)]),8,ft)]),_:1},8,["company-id","department-id","employee-id","line-type","start-date","end-date","loading"]),t.companyId&&t.startDate&&t.endDate?(o(),d("div",bt,[e("div",vt,[e("div",null,[s[5]||(s[5]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Company",-1)),e("div",wt,p(C.value.company),1)]),e("div",null,[s[6]||(s[6]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Department",-1)),e("div",{class:w(["font-medium",[C.value.department=="All Departments"?"text-gray-400":"text-gray-800"]])},p(C.value.department),3)]),e("div",null,[s[7]||(s[7]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Line Type",-1)),e("div",{class:w(["font-medium",[C.value.lineType=="All Types"?"text-gray-400":"text-gray-800"]])},p(C.value.lineType),3)]),e("div",null,[s[8]||(s[8]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Employee",-1)),e("div",{class:w(["font-medium",[C.value.employee=="All Employees"?"text-gray-400":"text-gray-800"]])},p(C.value.employee),3)]),e("div",ht,[s[9]||(s[9]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Date",-1)),e("div",Dt,p(C.value.dateRange),1)]),e("div",{ref_key:"assignmentSummaryRef",ref:q,class:"print-hide relative"},[e("button",{type:"button",class:"px-3 bg-white text-gray-700 hover:bg-gray-50 w-full text-bg text-right",onClick:s[0]||(s[0]=a=>j.value=!j.value)},[s[10]||(s[10]=e("div",{class:"uppercase"},"Todo given",-1)),e("div",_t,[e("div",kt,p(le.value)+" / "+p(G.value),1),e("i",{class:w(["fas",[j.value?"fa-chevron-up":"fa-chevron-down"]])},null,2)])]),j.value?(o(),d("div",Tt,[e("div",St,[s[11]||(s[11]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Todo Status",-1)),e("div",It,p(le.value)+" given / "+p(G.value)+" selected ",1)]),e("div",$t,[e("div",Nt,[e("div",Ct,[e("div",Rt,[s[12]||(s[12]=e("span",null,"Not given todos",-1)),(r=_.value.withoutTodos)!=null&&r.length?(o(),d("span",At,p((m=_.value.withoutTodos)==null?void 0:m.length),1)):v("",!0)]),e("button",{type:"button",class:"text-[10px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:s[1]||(s[1]=a=>Q.value=!Q.value)},p(Q.value?"Hide":"Show"),1)]),Q.value?(o(),d("div",Et,[_.value.withoutTodos.length?v("",!0):(o(),d("span",Lt," Everyone has todos ")),(o(!0),d(T,null,U(_.value.withoutTodos,a=>(o(),d("span",{key:`without-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-red-50 text-red-700 border border-red-100 text-xs max-w-full",title:a.name},[s[13]||(s[13]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",Ut,p(a.name),1)],8,jt))),128))])):v("",!0)]),e("div",null,[e("div",Bt,[s[14]||(s[14]=X(" Given todos ")),(y=_.value.withTodos)!=null&&y.length?(o(),d("span",Ot,p((f=_.value.withTodos)==null?void 0:f.length),1)):v("",!0)]),e("div",zt,[_.value.withTodos.length?v("",!0):(o(),d("span",Mt," No todos assigned ")),(o(!0),d(T,null,U(_.value.withTodos,a=>(o(),d("span",{key:`with-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-50 text-green-700 border border-green-100 text-xs max-w-full",title:a.name},[s[15]||(s[15]=e("i",{class:"fas fa-check-circle"},null,-1)),e("span",Ft,p(a.name),1)],8,Vt))),128))])])])])):v("",!0)],512)])])):v("",!0),!t.companyId||!t.startDate||!t.endDate?(o(),d("div",Pt,s[16]||(s[16]=[e("i",{class:"fad fa-tasks text-4xl"},null,-1),e("div",{class:"empty-state glass-panel"},[e("p",{class:"text-base font-semibold text-rose-500"}," Select company and date range to view the report. "),e("p",{class:"text-sm text-gray-500"},"Use the filter set above to load records.")],-1)]))):P(u).loading?(o(),Ze(Ge,{key:2},{default:re(()=>s[17]||(s[17]=[X("Loading report...")])),_:1,__:[17]})):(o(),d("div",Ht,[e("table",Wt,[e("thead",Jt,[e("tr",Kt,[s[19]||(s[19]=e("th",{class:"px-4 py-3 border w-[10px] bg-white bg-opacity-70 backdrop-blur-sm rounded-tl-md print:rounded-tl-none text-center"}," sl ",-1)),e("th",Qt,[e("div",Yt,[s[18]||(s[18]=e("span",null,"Employee Name",-1)),t.employeeId?v("",!0):(o(),d("div",{key:0,class:"relative hidden md:block print:hidden",ref_key:"tableNoTodosRef",ref:te},[e("button",{type:"button",class:"text-[11px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:s[2]||(s[2]=J(a=>Oe(),["stop"]))},[X(" No Todos ("+p(_.value.withoutTodos.length)+") ",1),e("span",Xt,p(V.value?"Hidden":"Showing"),1)])],512))])]),Y.value?v("",!0):(o(),d("th",Zt," Date ")),s[20]||(s[20]=e("th",{class:"px-4 py-3 border bg-white text-center"},"Todo",-1)),s[21]||(s[21]=e("th",{class:"px-4 py-3 border print:border-r print:border-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center rounded-tr-md print:rounded-tr-none"}," Status ",-1))])]),e("tbody",qt,[pe.value.length===0?(o(),d("tr",Gt,[e("td",{colspan:Y.value?4:5,class:"px-4 py-6 text-center text-gray-500"},s[22]||(s[22]=[e("div",null,[e("i",{class:"fas fa-tasks fa-2x text-gray-300 mb-2"})],-1),e("div",null,"No todos.",-1)]),8,es)])):v("",!0),(o(!0),d(T,null,U(pe.value,(a,x)=>{var I,R,A;return o(),d(T,{key:((I=a.user)==null?void 0:I.id)||(((A=(R=a.dates[0])==null?void 0:R.todos[0])==null?void 0:A.id)??Math.random())},[(o(!0),d(T,null,U(a.dates,(g,b)=>{var L;return o(),d(T,{key:`${((L=a.user)==null?void 0:L.id)||"u"}-${g.date}`},[(o(!0),d(T,null,U(g.todos,(N,k)=>{var ve,we,he,De,_e,ke,Te,Se,Ie;return o(),d("tr",{key:N.id||`${((ve=a.user)==null?void 0:ve.id)||"u"}-${g.date||"empty"}-${k}`,class:"border odd:bg-white even:bg-gray-50 hover:bg-gray-100"},[b===0&&k===0?(o(),d("td",{key:0,rowspan:a.rowSpan||1,class:w(["px-4 py-3 align-top font-bold text-xl text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",oe])},[e("div",ss,p(x+1),1)],8,ts)):v("",!0),b===0&&k===0?(o(),d("td",{key:1,rowspan:a.rowSpan||1,class:w(["px-4 py-3 align-top font-medium text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",oe])},[e("div",as,[de(qe,{size:"medium",user:a.user,class:"inline-block mr-2 align-middle"},null,8,["user"]),e("div",null,[e("div",null,p(((we=a.user)==null?void 0:we.name)||"Unknown user"),1),(De=(he=a.user)==null?void 0:he.department)!=null&&De.name?(o(),d("div",rs,p((ke=(_e=a.user)==null?void 0:_e.department)==null?void 0:ke.name),1)):v("",!0)])])],8,ns)):v("",!0),N.isPlaceholder?(o(),d(T,{key:2},[k===0&&!Y.value?(o(),d("td",{key:0,rowspan:g.rowSpan||1,class:w(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",F(a,g,b,k)])},[e("div",ds,p(P(H)(g.date)||g.date||"-"),1)],10,os)):v("",!0),e("td",{class:w(["border-l border-t border-r bg-white px-3 py-3 text-center",F(a,g,b,k)]),colspan:"2"},[s[27]||(s[27]=e("div",{class:"flex items-center justify-center gap-2 text-red-600 text-sm font-medium opacity-70"},[e("i",{class:"far fa-clipboard-list text-red-400"}),e("span",null,"No todos was provided.")],-1)),ne.value?(o(),d("div",ls," Loading attendanceâ€¦ ")):(o(!0),d(T,{key:1},U([Ke((Te=a==null?void 0:a.user)==null?void 0:Te.id,g==null?void 0:g.date)],D=>(o(),d("div",{key:D.comment,class:"min-w-[180px] mt-3 text-[11px] text-red-600 text-left inline-block align-top"},[D.hasData?(o(),d("div",is,[D.in==="-"&&D.out==="-"?(o(),d("div",{key:0,class:w(["text-center flex items-center justify-center rounded-md bg-slate-50 border text-xs border-dashed px-2 py-1.5 col-span-2",[{"text-red-500 border-red-300":D.comment==="Absent","text-blue-500 border-blue-300":D.comment!=="Absent"}]])},p(D.comment),3)):(o(),d(T,{key:1},[e("div",ps,[e("div",us,[s[23]||(s[23]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," In ",-1)),e("span",ms,p(D.in),1)]),e("div",ys,[s[24]||(s[24]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Late ",-1)),e("div",null,p(D.late),1)])]),e("div",cs,[e("div",gs,[s[25]||(s[25]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Out ",-1)),e("span",xs,p(D.out),1)]),e("div",fs,[s[26]||(s[26]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Early ",-1)),e("div",null,p(D.out!=="-"?D.early:"-"),1)])])],64))])):(o(),d("div",bs,"Attendance data unavailable."))]))),128))],2)],64)):(o(),d(T,{key:3},[k===0&&!Y.value?(o(),d("td",{key:0,rowspan:g.rowSpan||1,class:w(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",F(a,g,b,k)])},[e("div",ws,p(P(H)(g.date)||g.date||"-"),1)],10,vs)):v("",!0),e("td",{class:w(["px-4 py-3 text-gray-800 border-l border-t",F(a,g,b,k)])},[e("div",hs,[e("span",Ds,p(k+1)+".",1),X(" "+p(N.title),1)]),e("div",_s,p(((Se=N.todoable)==null?void 0:Se.title)||((Ie=N.todoable_type)==null?void 0:Ie.split("\\").pop())||""),1)],2),e("td",{class:w(["px-4 py-3 border-l border-t border-r text-center",F(a,g,b,k)])},[e("span",{class:w(["text-xs font-semibold px-2.5 py-1 rounded-full",ze(N.status)])},p(N.status||"N/A"),3)],2)],64))])}),128))],64)}),128))],64)}),128))])])]))])}}};export{Bs as default};
