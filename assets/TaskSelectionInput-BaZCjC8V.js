import{c as o,o as l,a as s,g as S,x as z,t as x,w as v,r as T,m as y,e as N,J as O,K as j,f as I,M as P,h as U,v as V,F as $,y as H,X as Q}from"./index-DXTp_J5-.js";import{u as A}from"./useTaskStore-BV5dcOsi.js";const D={class:"flex items-center py-1"},F={class:z(["line-clamp-2 mr-4 "])},J={__name:"TodoInputTaskItem",props:{task:Object,level:Number,selected:{type:[Number,String],default:null}},emits:["select"],setup(a,{emit:b}){const n=b;return(w,i)=>(l(),o("div",{class:z(["px-2 border-b py-3 over text-sm relative",[a.task.id==a.selected?"text-red-50 bg-sky-500 px-2":"hover:text-blue-500"]])},[s("div",D,[s("div",F,x(a.task.id)+" - "+x(a.task.title),1),a.task.id!=a.selected?(l(),o("button",{key:0,class:"border btn-2 ml-auto",onClick:i[0]||(i[0]=v(()=>n("select",a.task),["prevent"]))}," Select ")):S("",!0)])],2))}},K={key:0,class:"line-clamp-1"},R={key:1,class:"text-gray-500"},X={class:"ml-auto flex items-center justify-center h-full gap-2"},q={class:"flex items-center mb-2"},G={class:"relative"},W={class:"border flex rounded-t-md sticky top-0 bg-white"},Y={class:"h-[250px] overflow-y-auto"},Z={class:"border"},te={__name:"TaskSelectionInput",props:{todoType:{type:String,default:"task"},taskId:{type:[String,Number],default:null},show:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},taskQueryParams:{type:Object,default:()=>{}},isOnlyMyTask:{type:Boolean,default:!0}},emits:["update:todoType","update:taskId","update:show"],setup(a,{emit:b}){const n=a,w=b,i=T(""),r=y({get:()=>n.taskId,set:t=>w("update:taskId",t)}),d=y({get:()=>n.show,set:t=>w("update:show",t)}),u=T(null),C=T({});function c(){if(!(u!=null&&u.value))return;const t=u.value.getBoundingClientRect(),e=window.innerHeight,f=300,k=e-t.bottom<f;C.value={position:"fixed",top:k?t.top-f+"px":t.bottom+"px",left:t.left+"px",width:t.width+"px",zIndex:5e3}}N(async()=>{B(),await O(),window.addEventListener("resize",c),document.addEventListener("scroll",c)});async function B(){n.isOnlyMyTask?await m.fetchAllMyTasks(n.taskQueryParams):await m.fetchAllTasks(n.taskQueryParams)}const m=A();j(()=>{window.removeEventListener("resize",c),document.removeEventListener("scroll",c)});function M(t){r.value=t.id,d.value=!1}function L(){r.value="",d.value=!1}const g=y(()=>[...m.tasks||[]].find(t=>t.id==r.value)),E=y(()=>{const t=i.value.trim().toUpperCase();return t.length?[...m.tasks||[]].filter(e=>String(e.title||"").toUpperCase().includes(t)):m.tasks});return(t,e)=>{var f,h,k;return l(),o("div",{class:"relative border rounded-md shadow-sm flex items-center",ref_key:"anchor",ref:u},[s("div",{class:"w-full px-4 py-2 focus:ring-2 focus:ring-blue-500 cursor-pointer flex items-center",onClick:e[1]||(e[1]=v(()=>{a.readonly||(d.value=!0,c())},["stop"]))},[(f=g.value)!=null&&f.title?(l(),o("div",K,x((h=g.value)==null?void 0:h.id)+" - "+x((k=g.value)==null?void 0:k.title),1)):(l(),o("div",R,"Click to select todo")),s("div",X,[r.value&&!a.readonly?(l(),o("button",{key:0,class:"btn-icon fas fa-times !size-8 text-sm",onClick:e[0]||(e[0]=v(()=>L(),["prevent","stop"]))})):S("",!0),e[5]||(e[5]=s("span",{class:"fas fa-caret-down"},null,-1))])]),(l(),I(Q,{to:"body"},[d.value?(l(),o("div",{key:0,style:P(C.value),class:"fixed bg-white rounded-b-md shadow-lg border z-[5000] p-4"},[s("div",q,[e[7]||(e[7]=s("h2",{class:"text-sky-800 text-sm uppercase"},"Task List",-1)),s("button",{class:"fas fa-redo text-gray-500 text-sm ml-4",onClick:e[2]||(e[2]=v(p=>B(),["prevent"]))}),s("button",{onClick:e[3]||(e[3]=v(()=>d.value=!1,["prevent"])),class:"ml-auto"},e[6]||(e[6]=[s("i",{class:"fas fa-times-circle text-red-700 text-xl hover:text-red-500"},null,-1)]))]),s("div",G,[s("div",W,[U(s("input",{type:"text",placeholder:"Search task",class:"w-full py-2 px-4 rounded-t-md outline-sky-200","onUpdate:modelValue":e[4]||(e[4]=p=>i.value=p)},null,512),[[V,i.value]]),e[8]||(e[8]=s("label",{class:"ml-auto flex w-8 items-center justify-center absolute right-0 top-0 bottom-0"},[s("i",{class:"fas fa-search"})],-1))])]),s("div",Y,[s("div",Z,[(l(!0),o($,null,H(E.value,p=>(l(),I(J,{key:p.id,task:p,onSelect:M,selected:r.value,class:"group/main"},null,8,["task","selected"]))),128))])])],4)):S("",!0)]))],512)}}};export{te as _};
