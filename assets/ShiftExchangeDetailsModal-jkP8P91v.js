import{d as ie,N as oe,r as X,x as de,A as re,f as Y,o,c as r,g as _,a as e,n as d,t as s,j as n,q as ce,k as ue,i as pe,a2 as me,T as fe}from"./index-Dja825th.js";import{_ as f}from"./ApprovalItem-CZ7zCOa4.js";import{L as ve}from"./LoaderView-C9D--Wd3.js";import{_ as he}from"./ScreenshotCapture-B9JmRe4h.js";import{_ as xe}from"./ShareComponent-7_8cKnnn.js";import{u as ge}from"./exchange-Dx5tjQg1.js";import{_ as ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./AcceptAndRejectHandler-D8AN27w8.js";const _e={key:0,class:"fixed inset-0 z-[999] flex items-center justify-center bg-black/50 p-4","aria-modal":"true",role:"dialog","aria-labelledby":"exchange-title"},be={class:"relative w-full max-w-4xl rounded-lg bg-white shadow-xl max-h-[90vh] overflow-y-auto print:overflow-visible print:shadow-none print:max-h-none"},we={class:"p-4"},ke={key:1,class:"bg-white rounded text-sm md:text-base",id:"leave-application"},Ae={class:"flex md:justify-end"},Ne={class:"font-medium"},De={class:"gap-y-1"},je={class:"gap-y-1"},Se={class:"grid md:grid-cols-2 pt-2"},Fe={class:"col-span-2 pt-2"},Ce={class:"grid md:grid-cols-3 gap-x-4 py-1 md:justify-between items-end md:items-start"},Ee={class:"md:col-span-2 print:col-span-2"},Be={class:"text-center"},Re={class:"title-md"},Ve={key:0},Te={class:"grid grid-cols-2 text-sm md:text-base md:grid-cols-3 md:gap-x-4 items-end"},Le={class:"space-y-2 print:hidden"},ze={key:0,class:"mb-2"},Ie=["href"],Ue={key:1,class:"text-center text-lg italic text-gray-400"},$e={key:2},qe={__name:"ShiftExchangeDetailsModal",props:{open:{type:Boolean,default:!1},id:{type:[String,Number],required:!0}},emits:["update:open"],setup(b,{emit:Z}){const c=b,ee=Z,v=ge(),te=ie(),h=oe(),g=X(!1),w=X(null),a=de(()=>v.exchange),x=()=>ee("update:open",!1),y=async()=>{if(c.id){g.value=!0;try{await v.fetchExchange(c.id)}catch(l){console.error("Failed to fetch exchange details:",l),h.error("Failed to load exchange details.")}finally{g.value=!1}}};re(()=>[c.open,c.id],async([l])=>{l&&await y()},{immediate:!0});const ae=async l=>{var m;const t=(m=l.target.files)==null?void 0:m[0];if(!t)return;const p=new FormData;p.append("file",t);const i=await v.fetchFileUpload(p);w.value=(i==null?void 0:i.url)||null,i!=null&&i.url?(await le(),h.success("File uploaded successfully")):h.error("Failed to upload file")},le=async()=>{try{const l={attachment:w.value};await v.uploadAttachmentExchange(c.id,l),await y()}catch(l){console.error("Failed to upload attachment:",l),h.error("Failed to upload attachment.")}},se=l=>l?new Date(l).toISOString().slice(0,10):"N/A",ne=l=>l?new Date(l).toLocaleDateString("en-US",{weekday:"long"}):"N/A",u=async()=>{await y()};return(l,t)=>{var p,i,m,k,A,N,D,j,S,F,C,E,B,R,V,T,L,z,I,U,$,q,K,M,H,O,P,W,G,J,Q;return o(),Y(fe,{to:"body"},[b.open?(o(),r("div",_e,[e("div",{class:"relative max-h-[90vh] w-full max-w-4xl overflow-y-auto rounded-2xl bg-white p-4 md:p-6 shadow-2xl print:static print:overflow-visible",onClick:x}),e("div",{class:"fixed inset-0 flex items-center justify-center p-4",onKeydown:me(x,["esc"])},[e("div",be,[e("div",{class:"sticky top-0 z-10 flex items-center justify-between gap-2 border-b bg-white px-4 py-3 print:hidden"},[e("button",{class:"btn-3",onClick:x},t[0]||(t[0]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[2]||(t[2]=e("h1",{id:"exchange-title",class:"title-lg text-center"},"Shift Exchange Application",-1)),e("div",null,[e("button",{class:"btn-3",onClick:x},t[1]||(t[1]=[e("i",{class:"far fa-times"},null,-1),e("span",{class:"hidden md:inline"},"Close",-1)]))])]),e("div",we,[g.value?(o(),Y(ve,{key:0})):(o(),r("div",ke,[e("div",Ae,[e("div",null,"Date: "+s(se((p=a.value)==null?void 0:p.created_at)),1)]),e("div",null,[e("p",Ne,[t[3]||(t[3]=n(" Name: ")),e("b",null,s((m=(i=a.value)==null?void 0:i.user)==null?void 0:m.name),1)]),e("div",De,[e("p",null,[t[4]||(t[4]=n("Designation: ")),e("b",null,s((N=(A=(k=a.value)==null?void 0:k.user)==null?void 0:A.designation)==null?void 0:N.title),1)])]),e("div",je,[e("p",null,[t[5]||(t[5]=n("Department: ")),e("b",null,s((S=(j=(D=a.value)==null?void 0:D.user)==null?void 0:j.company)==null?void 0:S.name),1)])])]),e("div",Se,[e("div",null,[t[6]||(t[6]=e("b",null,"Exchange Day:",-1)),n(" "+s(ne((F=a.value)==null?void 0:F.exchange_date)),1)]),e("div",null,[t[7]||(t[7]=e("b",null,"Date:",-1)),n(" "+s((C=a.value)==null?void 0:C.exchange_date),1)]),e("div",null,[t[8]||(t[8]=e("b",null,"From:",-1)),n(" "+s((B=(E=a.value)==null?void 0:E.current_shift)==null?void 0:B.name),1)]),e("div",null,[t[9]||(t[9]=e("b",null,"To:",-1)),n(" "+s((V=(R=a.value)==null?void 0:R.shift)==null?void 0:V.name),1)]),e("div",Fe,[t[10]||(t[10]=e("b",null,"Reason:",-1)),n(" "+s(((T=a.value)==null?void 0:T.reason)||"N/A"),1)])]),e("div",Ce,[e("div",Ee,[e("div",null,[t[11]||(t[11]=e("b",null,"Works in Hand:",-1)),n(" "+s(((L=a.value)==null?void 0:L.works_in_hand)||"N/A"),1)])]),d(f,{application:a.value,type:"shift_exchange_applications",item:"handover",onAction:u,class:"pt-10 ml-auto hidden md:block"},null,8,["application"])]),t[17]||(t[17]=e("hr",{class:"my-2"},null,-1)),e("div",Be,[e("h3",Re,[t[12]||(t[12]=n(" Approvals ")),e("span",{class:ce({"text-yellow-500":((z=a.value)==null?void 0:z.status)==="Pending","text-green-500":((I=a.value)==null?void 0:I.status)==="Approved","text-red-500":((U=a.value)==null?void 0:U.status)==="Rejected"})}," ("+s((($=a.value)==null?void 0:$.status)||"N/A")+") ",3)]),((q=a.value)==null?void 0:q.status)==="Rejected"?(o(),r("div",Ve,[e("div",null,[t[13]||(t[13]=e("b",null,"Rejected By:",-1)),n(" "+s(((M=(K=a.value)==null?void 0:K.rejected_by_user)==null?void 0:M.name)||"N/A"),1)]),e("div",null,[t[14]||(t[14]=e("b",null,"Rejection Reason:",-1)),n(" "+s(((H=a.value)==null?void 0:H.rejection_reason)||"N/A"),1)])])):_("",!0)]),e("div",Te,[d(f,{application:a.value,type:"shift_exchange_applications",item:"handover",onAction:u,class:"md:hidden"},null,8,["application"]),d(f,{application:a.value,type:"shift_exchange_applications",item:"in_charge",onAction:u},null,8,["application"]),d(f,{application:a.value,type:"shift_exchange_applications",item:"recommend_by",onAction:u},null,8,["application"]),d(f,{application:a.value,type:"shift_exchange_applications",item:"approved_by",onAction:u},null,8,["application"])]),e("div",Le,[t[16]||(t[16]=e("label",{class:"font-medium"},"Attachment",-1)),(O=a.value)!=null&&O.attachment&&typeof((P=a.value)==null?void 0:P.attachment)=="string"?(o(),r("div",ze,[e("a",{href:(W=a.value)==null?void 0:W.attachment,target:"_blank",class:"text-blue-500 underline"}," View Current File ",8,Ie)])):(o(),r("div",Ue,"No attachment")),((J=(G=ue(te))==null?void 0:G.user)==null?void 0:J.id)===((Q=a.value)==null?void 0:Q.user_id)?(o(),r("div",$e,[e("input",{type:"file",onChange:ae,class:"w-full p-2 border rounded"},null,32),t[15]||(t[15]=e("p",{class:"text-sm text-gray-600 mt-1"},"Selected File",-1))])):_("",!0)]),d(xe,{class:"print:hidden"},{default:pe(()=>[d(he,{targetId:"leave-application",platform:"whatsapp"})]),_:1})]))])])],32)])):_("",!0)])}}},Qe=ye(qe,[["__scopeId","data-v-c12a674f"]]);export{Qe as default};
