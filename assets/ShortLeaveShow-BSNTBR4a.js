import{_ as c}from"./ApprovalItem-C6wI_XWM.js";import{L as at}from"./LoaderView-Q5_POSjP.js";import{_ as lt}from"./ScreenshotCapture-DRfHhlWG.js";import{_ as st}from"./ShareComponent-BkHbnRjy.js";import{S as ot,u as nt,f as it,g as rt,r as O,x as ut,h as dt,c as p,o as u,a as t,j as ct,d as i,b as o,t as n,k as Q,s as pt,n as mt,m as vt}from"./index-CnILmDJV.js";import{u as ft}from"./short-leave-C_ko1LIG.js";import"./AcceptAndRejectHandler-QkdgIn04.js";import"./html2canvas.esm-CBrSDip1.js";const ht={class:"my-container max-w-3xl space-y-6"},_t={key:1,class:"bg-white rounded space-y-2 p-4 md:p-8",id:"leave-application"},yt={class:"flex justify-end"},gt={class:"font-medium"},bt={class:"gap-y-1"},xt={class:"gap-y-1"},wt={class:""},At={class:"grid md:grid-cols-2"},St={class:"grid md:grid-cols-3 gap-x-4 pt-2 md:justify-between items-end md:items-start"},kt={class:"md:col-span-2"},Lt={class:"text-center"},jt={class:"title-md"},Dt={key:0},Nt={class:"grid grid-cols-2 text-sm md:text-base md:grid-cols-3 md:gap-x-4 gap-y-14 pt-14 items-end"},Bt={key:0,class:"mb-2"},Ft=["href"],Rt={key:1,class:"text-center text-lg italic text-gray-400"},Ct={key:2},Gt={__name:"ShortLeaveShow",setup(Vt){const f=ot(),W=nt(),v=it(),m=ft(),X=rt(),h=O(null),_=O(!0),a=ut(()=>m.shortLeave),y=l=>l?new Date(l).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"";dt(async()=>{const{id:l}=v.params;try{await m.fetchShortLeaveById(l)}catch(e){console.error("Failed to fetch short leave details:",e)}finally{_.value=!1}});const Y=async()=>{try{const l={attachment:h.value};await m.uploadShortLeaveAttachment(v.params.id,l)}catch(l){console.error("Failed to reject short leave:",l),alert("Failed to reject short leave.")}},Z=()=>W.go(-1);function tt(){window.print()}const et=async l=>{const e=l.target.files[0];if(e){const r=new FormData;r.append("file",e);const s=await m.fetchFileUpload(r);h.value=s==null?void 0:s.url,s!=null&&s.url?(Y(),f.success("File uploaded successfully!")):f.error("Failed to upload file!")}},g=l=>{if(!l)return"N/A";const[e,r]=l.split(":").map(Number),s=new Date;return s.setHours(e,r),s.toLocaleString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},d=async()=>{await m.fetchShortLeaveById(v.params.id)};return(l,e)=>{var r,s,b,x,w,A,S,k,L,j,D,N,B,F,R,C,V,T,I,U,$,M,P,z,E,G,H,q,J,K;return u(),p("div",ht,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:Z},e[0]||(e[0]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[2]||(e[2]=t("h1",{class:"title-lg flex-wrap text-center"},"Short Leave Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:tt},e[1]||(e[1]=[t("i",{class:"far fa-print"},null,-1),o(" Print ")]))])]),_.value?(u(),ct(at,{key:0})):(u(),p("div",_t,[e[14]||(e[14]=t("div",null,[t("h1",{class:"title-lg text-center"},"Short Leave Application")],-1)),t("div",yt,[t("div",null,"Date: "+n(y((r=a.value)==null?void 0:r.created_at)),1)]),t("div",null,[t("p",gt,[e[3]||(e[3]=o(" Name: ")),t("b",null,n((b=(s=a.value)==null?void 0:s.user)==null?void 0:b.name),1)]),t("div",bt,[t("p",null,[e[4]||(e[4]=o(" Designation: ")),t("b",null,n((A=(w=(x=a.value)==null?void 0:x.user)==null?void 0:w.designation)==null?void 0:A.title),1)])]),t("div",xt,[t("p",null,[e[5]||(e[5]=o(" Department: ")),t("b",null,n((L=(k=(S=a.value)==null?void 0:S.user)==null?void 0:k.company)==null?void 0:L.name),1)])])]),t("div",wt,[t("div",At,[t("div",null,[e[6]||(e[6]=t("b",null,"From:",-1)),o(" "+n((j=a.value)!=null&&j.start_time?g((D=a.value)==null?void 0:D.start_time):""),1)]),t("div",null,[e[7]||(e[7]=t("b",null,"To:",-1)),o(" "+n((N=a.value)!=null&&N.end_time?g((B=a.value)==null?void 0:B.end_time):""),1)]),t("div",null,[e[8]||(e[8]=t("b",null,"Short Leave Date:",-1)),o(" "+n(y((F=a.value)==null?void 0:F.date)),1)]),t("div",null,[e[9]||(e[9]=t("b",null,"Total Minutes:",-1)),o(" "+n((R=a.value)==null?void 0:R.total_minutes),1)])]),t("div",St,[t("div",kt,[e[10]||(e[10]=t("b",null,"Reason:",-1)),o(" "+n(((C=a.value)==null?void 0:C.reason)||"N/A"),1)]),i(c,{application:a.value,type:"short_leave_applications",item:"handover",onAction:d,class:"pt-10 ml-auto hidden md:block"},null,8,["application"])])]),e[15]||(e[15]=t("hr",null,null,-1)),t("div",Lt,[t("h3",jt,[e[11]||(e[11]=o(" Approvals ")),t("span",{class:pt({"text-yellow-500":((V=a.value)==null?void 0:V.status)==="Pending","text-green-500":((T=a.value)==null?void 0:T.status)==="Approved","text-red-500":((I=a.value)==null?void 0:I.status)==="Rejected"})}," ("+n(((U=a.value)==null?void 0:U.status)||"N/A")+") ",3)]),(($=a.value)==null?void 0:$.status)==="Rejected"?(u(),p("div",Dt,[t("div",null,[e[12]||(e[12]=t("b",null,"Rejected By:",-1)),o(" "+n(((P=(M=a.value)==null?void 0:M.rejected_by_user)==null?void 0:P.name)||"N/A"),1)]),t("div",null,[e[13]||(e[13]=t("b",null,"Rejection Reason:",-1)),o(" "+n(((z=a.value)==null?void 0:z.rejection_reason)||"N/A"),1)])])):Q("",!0)]),t("div",Nt,[i(c,{application:a.value,type:"short_leave_applications",item:"handover",onAction:d,class:"md:hidden"},null,8,["application"]),i(c,{application:a.value,type:"short_leave_applications",item:"in_charge",onAction:d},null,8,["application"]),i(c,{application:a.value,type:"short_leave_applications",item:"coordinator",onAction:d},null,8,["application"]),i(c,{application:a.value,type:"short_leave_applications",item:"recommend_by",onAction:d},null,8,["application"]),i(c,{application:a.value,type:"short_leave_applications",item:"approved_by",onAction:d},null,8,["application"])])])),t("div",null,[t("div",null,[(E=a.value)!=null&&E.attachment&&typeof((G=a.value)==null?void 0:G.attachment)=="string"?(u(),p("div",Bt,[t("a",{href:(H=a.value)==null?void 0:H.attachment,target:"_blank",class:"text-blue-500 underline"}," View Current File ",8,Ft)])):(u(),p("div",Rt,"No attachment")),((J=(q=mt(X))==null?void 0:q.user)==null?void 0:J.id)===((K=a.value)==null?void 0:K.user_id)?(u(),p("div",Ct,[t("input",{type:"file",onChange:et,class:"w-full p-2 border rounded"},null,32)])):Q("",!0)])]),i(st,null,{default:vt(()=>[i(lt,{targetId:"leave-application",platform:"whatsapp"})]),_:1})])}}};export{Gt as default};
