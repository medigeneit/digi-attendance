import{r as I,G as Ae,x as h,q as F,c as o,o as r,a as e,N as Se,w as P,s as R,d as oe,k as $e,v as Ce,f as He,u as We,D as Ne,h as ae,y as Re,j as f,i as Je,l as re,m as K,t as p,F as D,e as j,b as Q,M as Ke}from"./index-BUfZVfec.js";import{L as Qe}from"./LoaderView-Z2wXbnPD.js";import{_ as Ye}from"./EmployeeFilter-CZcmJ4bE.js";import{_ as Xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as Ze,b as Y}from"./datetime-BEfC2TVK.js";import{u as qe}from"./attendance-rOc2Z-K9.js";import{u as Ge}from"./company-CFYdUTWs.js";import{u as et}from"./department-Ooehx8bg.js";import{u as tt}from"./useTodoDateStore-DX_dJzH6.js";import"./EmployeeDropdownInput-BX119PA3.js";import"./SelectDropdown-BNdS4v6R.js";import"./UserChip-CHZ5QOj-.js";import"./url-CePbr-gY.js";const nt={class:"px-4 py-4 md:py-3 bg-white rounded-md border"},st={class:"flex flex-wrap items-center gap-3"},at=["disabled"],rt={class:"print-hide"},ot={class:"flex flex-col md:flex-row flex-wrap items-end md:ml-auto w-full md:w-auto gap-x-3 gap-y-4 print-hide"},dt={class:"flex items-center justify-between w-full md:w-auto gap-3"},lt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},it={class:"relative h-[32px] w-[150px] sm:w-[170px]"},pt={__name:"TodoReportHeading",props:{loading:{type:Boolean,default:!1},companyId:{type:[String,Number],default:""},departmentId:{type:[String,Number],default:""},employeeId:{type:[String,Number],default:""},lineType:{type:String,default:"all"},startDate:{type:String,default:""},endDate:{type:String,default:""}},emits:["reloadClick","change"],setup(O,{expose:k,emit:X}){const u=O,A=I(null),U=X,i=Ae({companyId:String(u.companyId||""),departmentId:u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",employeeId:String(u.employeeId||""),lineType:u.lineType||"all",startDate:u.startDate||"",endDate:u.endDate||""}),z=h(()=>({companyId:i.companyId,departmentId:i.departmentId,employeeId:i.employeeId,lineType:i.lineType,startDate:i.startDate,endDate:i.endDate}));function H(){U("change",{...z.value})}F(()=>[u.companyId,u.departmentId,u.employeeId,u.lineType,u.startDate,u.endDate],()=>{i.companyId=String(u.companyId||""),i.departmentId=u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",i.employeeId=String(u.employeeId||""),i.lineType=u.lineType||"all",i.startDate=u.startDate||"",i.endDate=u.endDate||""});function B(t){const d=new Date(i.startDate);d.setDate(d.getDate()+t),i.startDate=d.toISOString().split("T")[0];const g=new Date(i.endDate);g.setDate(g.getDate()+t),i.endDate=g.toISOString().split("T")[0]}return F(z,H,{deep:!0}),k({employees:h(()=>{var t;return((t=A.value)==null?void 0:t.employees)||[]})}),(t,d)=>(r(),o("div",nt,[e("div",st,[Se(t.$slots,"before",{},void 0,!0),e("button",{class:R(["btn-icon print-hide",{"animate-spin !bg-opacity-0":O.loading}]),onClick:d[0]||(d[0]=P(g=>U("reloadClick"),["prevent"])),disabled:O.loading,title:"Reload"},[e("i",{class:R(["fas fa-redo",[O.loading?"text-gray-400":"text-gray-500"]])},null,2)],10,at),e("span",rt,[Se(t.$slots,"after",{},void 0,!0)]),e("div",ot,[oe(Ye,{ref_key:"employeeFilterRef",ref:A,company_id:i.companyId,"onUpdate:company_id":d[1]||(d[1]=g=>i.companyId=g),department_id:i.departmentId,"onUpdate:department_id":d[2]||(d[2]=g=>i.departmentId=g),employee_id:i.employeeId,"onUpdate:employee_id":d[3]||(d[3]=g=>i.employeeId=g),line_type:i.lineType,"onUpdate:line_type":d[4]||(d[4]=g=>i.lineType=g),"with-type":!0,class:"flex-1 gap-y-4 md:flex items-center justify-between w-full md:w-auto"},null,8,["company_id","department_id","employee_id","line_type"]),e("div",dt,[e("button",{class:"btn-3 px-3 rounded size-7",onClick:d[5]||(d[5]=P(()=>B(-1),["prevent"]))},d[9]||(d[9]=[e("span",{class:"fas fa-arrow-left"},null,-1)])),e("div",lt,[d[10]||(d[10]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Start Date",-1)),$e(e("input",{type:"date","onUpdate:modelValue":d[6]||(d[6]=g=>i.startDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ce,i.startDate]])]),e("div",it,[d[11]||(d[11]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"End Date",-1)),$e(e("input",{type:"date","onUpdate:modelValue":d[7]||(d[7]=g=>i.endDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ce,i.endDate]])]),e("button",{class:"btn-3 px-3 rounded size-7",onClick:d[8]||(d[8]=P(()=>B(1),["prevent"]))},d[12]||(d[12]=[e("span",{class:"fas fa-arrow-right"},null,-1)]))])])])]))}},ut=Xe(pt,[["__scopeId","data-v-eac5851c"]]),mt={class:"container print:flex-grow mx-auto print:w-full print:px-0 print:py-0"},yt=["disabled"],ct={key:0,class:"bg-white border rounded-md mb-2 p-4 text-sm print:border-0 print:mb-2 print:px-0 print:w-full relative overflow-visible z-40"},gt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-y-2 gap-x-6"},xt={class:"font-medium text-gray-800"},ft={class:"col-span-2"},bt={class:"font-medium text-gray-800"},vt={class:"inline-flex items-center gap-5 font-bold"},wt={class:"text-gray-700"},ht={key:0,class:"mt-2 w-[280px] sm:w-[320px] lg:w-[280px] xl:w-[320px] bg-white border border-gray-200 rounded-md p-3 shadow-lg text-left absolute right-0"},_t={class:"flex items-center justify-between mb-2"},Dt={class:"text-[11px] text-gray-500"},kt={class:"space-y-3 max-h-56 overflow-auto pr-1 z-50"},It={class:"pt-2 border-t border-dashed border-gray-200"},Tt={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1 flex items-center justify-between"},St={class:"flex items-center gap-2"},$t={key:0,class:"bg-red-500 rounded-md px-1.5 text-white text-center"},Ct={key:0,class:"flex flex-wrap gap-2"},Nt={key:0,class:"text-xs text-gray-400"},Rt=["title"],At={class:"block max-w-[160px] truncate"},Et={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1"},Lt={key:0,class:"bg-green-500 rounded-md px-1.5 text-white text-center"},jt={class:"flex flex-wrap gap-2"},Ot={key:0,class:"text-xs text-gray-400"},Ut=["title"],zt={class:"block max-w-[160px] truncate"},Bt={key:1,class:"text-center text-gray-500 py-12 border bg-gray-50 rounded-md"},Mt={key:3,class:"overflow-x-auto md:overflow-clip bg-white border border-t-0 rounded-md shadow-sm print:shadow-none print:rounded-none print:border-gray-400"},Vt={class:"min-w-full text-left text-sm border-separate border-spacing-0"},Ft={class:"bg-gray-50 text-gray-600 uppercase tracking-wide text-xs"},Pt={class:"border-y print:border-gray-400 sticky md:top-[123px] z-30 rounded-t-md"},Ht={class:"px-4 py-3 border md:w-[100px] print:w-auto print:border-l print:border-l-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center whitespace-nowrap"},Wt={class:"flex items-center justify-between gap-2"},Jt={class:"ml-1 text-[10px] text-gray-500"},Kt={key:0,class:"px-4 py-3 border bg-white bg-opacity-70 backdrop-blur-sm text-center"},Qt={class:"divide-y divide-gray-200"},Yt={key:0},Xt=["colspan"],Zt=["rowspan"],qt={class:"sticky top-[180px] bg-white text-center"},Gt=["rowspan"],en={class:"sticky top-[180px] bg-white flex"},tn={key:0,class:"text-xs text-gray-500"},nn=["colspan"],sn={key:0,class:"text-[11px] text-gray-500 mt-2"},an={key:0,class:"grid grid-cols-2 gap-4"},rn={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},on={class:"flex gap-1 items-center justify-between"},dn={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},ln={class:"flex gap-1 items-center justify-between"},pn={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},un={class:"flex gap-1 items-center justify-between"},mn={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},yn={class:"flex gap-1 items-center justify-between"},cn={key:1,class:"mt-1 text-gray-500"},gn=["rowspan"],xn={class:"sticky top-[180px] bg-white"},fn={class:"px-4 py-3 text-gray-800 border-l border-t"},bn={class:"font-medium"},vn={class:"text-gray-400 mr-2"},wn={class:"text-xs text-gray-500"},hn={class:"px-4 py-3 border-l border-t border-r text-center"},jn={__name:"TodoReportView",setup(O){var me,ye,ce,ge,xe,fe;const k=He(),X=We(),u=tt(),A=Ge(),U=et(),{companies:i}=Ne(A),{departments:z}=Ne(U),H=I(null),B=Ze(new Date),t=Ae({companyId:((me=k.query)==null?void 0:me.company_id)||"",departmentId:((ye=k.query)==null?void 0:ye.department_id)||"",employeeId:((ce=k.query)==null?void 0:ce.employee_id)||"",lineType:((ge=k.query)==null?void 0:ge.line_type)||"all",startDate:((xe=k.query)==null?void 0:xe.start_date)||B,endDate:((fe=k.query)==null?void 0:fe.end_date)||B}),d=h(()=>{var s;return[...((s=H.value)==null?void 0:s.employees)||[]].filter(n=>t.employeeId?String(n.id)===String(t.employeeId):!0).sort((n,l)=>{var y,c;return(((y=n.user)==null?void 0:y.name)||"").localeCompare(((c=l.user)==null?void 0:c.name)||"")}).map(n=>{const l=u.todo_dates.filter(a=>{var m;return String((m=a.user)==null?void 0:m.id)===String(n.id)}),y={};l.forEach(a=>{const m=a.date||"unknown-date";y[m]||(y[m]={date:m,todos:[]}),y[m].todos.push(a)});let c=Object.values(y).map(a=>({...a,rowSpan:a.todos.length})).sort((a,m)=>new Date(a.date)-new Date(m.date));c.length||(c=[{date:null,rowSpan:1,todos:[{id:`empty-${n.id}`,isPlaceholder:!0,title:""}]}]);const b=c.reduce((a,m)=>a+m.rowSpan,0);return{user:n,dates:c,rowSpan:Math.max(1,b)}})}),g=h(()=>{if(!t.startDate||!t.endDate)return"";const s=Y(t.startDate,{weekDay:"long"}),n=Y(t.endDate,{weekDay:"long"});return`${s} ~ ${n}`}),Ee=h(()=>A.employees||[]),Le={all:"All Types",executive:"Executive",support_staff:"Support Staff",doctor:"Doctor",academy_body:"Academy Body"},S=h(()=>{var c,b,a,m,$,C,N,x;const s=t.companyId&&((c=i.value)!=null&&c.length)?(b=i.value.find(v=>String(v.id)===String(t.companyId)))==null?void 0:b.name:null,n=t.departmentId&&((a=z.value)!=null&&a.length)?(m=z.value.find(v=>String(v.id)===String(t.departmentId)))==null?void 0:m.name:null;let l=null;t.employeeId&&(l=((C=($=Ee.value)==null?void 0:$.find(v=>String(v.id)===String(t.employeeId)))==null?void 0:C.name)||((x=(N=d.value.find(v=>{var E;return String(((E=v.user)==null?void 0:E.id)||"")===String(t.employeeId)}))==null?void 0:N.user)==null?void 0:x.name)||null);const y=t.startDate===t.endDate&&t.startDate?Y(t.startDate,{weekDay:"long"}):g.value||"-";return{company:s||(t.companyId?`#${t.companyId}`:"All Companies"),department:n||(t.departmentId?`#${t.departmentId}`:"All Departments"),employee:l||(t.employeeId?`#${t.employeeId}`:"All Employees"),lineType:Le[t.lineType]||t.lineType||"All Types",dateRange:y}}),L=I(!1),Z=I(null),q=h(()=>{var s;return((s=d.value)==null?void 0:s.length)||0}),de=h(()=>{var s,n;return Math.max(0,q.value-(((n=(s=_.value)==null?void 0:s.withoutTodos)==null?void 0:n.length)||0))}),W=I(!0),G=I(!1),M=I(!1),ee=I(null),le=s=>{L.value&&Z.value&&(Z.value.contains(s.target)||(L.value=!1))},_=h(()=>{var s;return(s=d.value)!=null&&s.length?d.value.reduce((n,l,y)=>{var a,m,$,C,N,x;const c=l.dates.reduce((v,E)=>v+E.todos.filter(T=>!T.isPlaceholder).length,0),b={id:((a=l.user)==null?void 0:a.id)??((m=l.user)==null?void 0:m.user_id)??(($=l.user)==null?void 0:$.uid)??((C=l.user)==null?void 0:C.email)??`${((N=l.user)==null?void 0:N.name)||"unknown"}-${y}`,name:((x=l.user)==null?void 0:x.name)||"Unknown user"};return c>0?n.withTodos.push(b):n.withoutTodos.push(b),n},{withTodos:[],withoutTodos:[]}):{withTodos:[],withoutTodos:[]}}),ie=h(()=>{if(!M.value)return d.value;const s=new Set((_.value.withoutTodos||[]).map(n=>String(n.id??n.name??"")));return d.value.filter(n=>{var y,c,b,a,m;const l=((y=n.user)==null?void 0:y.id)??((c=n.user)==null?void 0:c.user_id)??((b=n.user)==null?void 0:b.uid)??((a=n.user)==null?void 0:a.email)??((m=n.user)==null?void 0:m.name)??"";return!s.has(String(l))})});function je(){M.value=!M.value,G.value=M.value}const pe=s=>{G.value&&ee.value&&(ee.value.contains(s.target)||(G.value=!1))},Oe=s=>s==="COMPLETED"?"bg-green-100 text-green-700 border border-green-200":s==="WORKING"?"bg-blue-100 text-blue-700 border border-blue-200":s==="PENDING"?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-gray-100 text-gray-700 border border-gray-200";function Ue(){X.replace({query:{...k.query,company_id:t.companyId||void 0,department_id:t.departmentId||void 0,employee_id:t.employeeId||void 0,line_type:t.lineType||void 0,start_date:t.startDate||void 0,end_date:t.endDate||void 0}})}async function te(){!t.companyId||!t.startDate||!t.endDate||(await u.fetchTodoDates({"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate}),Ve())}function ze(s){t.companyId=s.companyId||"",t.departmentId=s.departmentId||"",t.employeeId=s.employeeId||"",t.lineType=s.lineType||"all",t.startDate=s.startDate||"",t.endDate=s.endDate||""}function Be(){window.print()}const J=h(()=>t.startDate===t.endDate);F(()=>t.companyId,s=>{s&&(U.fetchDepartments(s),A.fetchEmployee(s))},{immediate:!0}),F(()=>({...t}),(s,n)=>{JSON.stringify(s)!==JSON.stringify(n)&&(Ue(),te())},{deep:!0}),F(()=>k.query,s=>{t.companyId=(s==null?void 0:s.company_id)||t.companyId,t.departmentId=(s==null?void 0:s.department_id)||t.departmentId,t.employeeId=(s==null?void 0:s.employee_id)||t.employeeId,t.lineType=(s==null?void 0:s.line_type)||t.lineType,t.startDate=(s==null?void 0:s.start_date)||t.startDate,t.endDate=(s==null?void 0:s.end_date)||t.endDate}),ae(()=>{A.fetchCompanies({ignore_permission:!0}),te()}),ae(()=>{document.addEventListener("click",le,!0)}),Re(()=>{document.removeEventListener("click",le,!0)}),ae(()=>{document.addEventListener("click",pe,!0)}),Re(()=>{document.removeEventListener("click",pe,!0)});const Me=qe(),ue=I([]),ne=I(!1),se=h(()=>t.startDate===t.endDate),Ve=async()=>{if(!(!t.companyId||!t.startDate||!t.endDate||!se.value)){ne.value=!0;try{const s=await Me.getDateRangeAttendanceSummary(t.startDate,t.endDate,t.companyId,t.lineType,t.employeeId,!0);s&&(ue.value=s)}finally{ne.value=!1}}};function Fe(s,n){var y;const l=((y=ue.value)==null?void 0:y.find(c=>String(c.employee_id)===String(s)))||null;return l?!n&&se.value?(l==null?void 0:l.attendance[t.startDate])||null:(l==null?void 0:l.attendance[n])||null:null}function Pe(s,n){const l=Fe(s,n);return l?{hasData:!0,in:l.in||"-",out:l.out||"-",late:l.late||"-",early:l.early||"-",comment:l.comment||"-"}:{hasData:!1,in:"-",out:"-",late:"-",early:"-",comment:"-"}}return(s,n)=>{var l,y,c,b;return r(),o("div",mt,[oe(ut,{ref_key:"headingRef",ref:H,"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate,loading:K(u).loading,class:"mb-4 print:px-0 print:py-0 print:mb-2 print:border-0 print:border-b print:border-gray-400 print:rounded-none print:w-full sticky top-[58px] z-50",onChange:ze,onReloadClick:te},{before:re(()=>n[3]||(n[3]=[e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-800"},"Todo Report")],-1)])),after:re(()=>[e("button",{type:"button",class:"btn-icon print-hide disabled:opacity-35 cursor-pointer disabled:cursor-not-allowed",onClick:P(Be,["prevent"]),disabled:K(u).loading},n[4]||(n[4]=[e("i",{class:"fas fa-print"},null,-1)]),8,yt)]),_:1},8,["company-id","department-id","employee-id","line-type","start-date","end-date","loading"]),t.companyId&&t.startDate&&t.endDate?(r(),o("div",ct,[e("div",gt,[e("div",null,[n[5]||(n[5]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Company",-1)),e("div",xt,p(S.value.company),1)]),e("div",null,[n[6]||(n[6]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Department",-1)),e("div",{class:R(["font-medium",[S.value.department=="All Departments"?"text-gray-400":"text-gray-800"]])},p(S.value.department),3)]),e("div",null,[n[7]||(n[7]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Line Type",-1)),e("div",{class:R(["font-medium",[S.value.lineType=="All Types"?"text-gray-400":"text-gray-800"]])},p(S.value.lineType),3)]),e("div",null,[n[8]||(n[8]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Employee",-1)),e("div",{class:R(["font-medium",[S.value.employee=="All Employees"?"text-gray-400":"text-gray-800"]])},p(S.value.employee),3)]),e("div",ft,[n[9]||(n[9]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Date",-1)),e("div",bt,p(S.value.dateRange),1)]),e("div",{ref_key:"assignmentSummaryRef",ref:Z,class:"print-hide relative"},[e("button",{type:"button",class:"px-3 bg-white text-gray-700 hover:bg-gray-50 w-full text-bg text-right",onClick:n[0]||(n[0]=a=>L.value=!L.value)},[n[10]||(n[10]=e("div",{class:"uppercase"},"Todo given",-1)),e("div",vt,[e("div",wt,p(de.value)+" / "+p(q.value),1),e("i",{class:R(["fas",[L.value?"fa-chevron-up":"fa-chevron-down"]])},null,2)])]),L.value?(r(),o("div",ht,[e("div",_t,[n[11]||(n[11]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Todo Status",-1)),e("div",Dt,p(de.value)+" given / "+p(q.value)+" selected ",1)]),e("div",kt,[e("div",It,[e("div",Tt,[e("div",St,[n[12]||(n[12]=e("span",null,"Not given todos",-1)),(l=_.value.withoutTodos)!=null&&l.length?(r(),o("span",$t,p((y=_.value.withoutTodos)==null?void 0:y.length),1)):f("",!0)]),e("button",{type:"button",class:"text-[10px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:n[1]||(n[1]=a=>W.value=!W.value)},p(W.value?"Hide":"Show"),1)]),W.value?(r(),o("div",Ct,[_.value.withoutTodos.length?f("",!0):(r(),o("span",Nt," Everyone has todos ")),(r(!0),o(D,null,j(_.value.withoutTodos,a=>(r(),o("span",{key:`without-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-red-50 text-red-700 border border-red-100 text-xs max-w-full",title:a.name},[n[13]||(n[13]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",At,p(a.name),1)],8,Rt))),128))])):f("",!0)]),e("div",null,[e("div",Et,[n[14]||(n[14]=Q(" Given todos ")),(c=_.value.withTodos)!=null&&c.length?(r(),o("span",Lt,p((b=_.value.withTodos)==null?void 0:b.length),1)):f("",!0)]),e("div",jt,[_.value.withTodos.length?f("",!0):(r(),o("span",Ot," No todos assigned ")),(r(!0),o(D,null,j(_.value.withTodos,a=>(r(),o("span",{key:`with-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-50 text-green-700 border border-green-100 text-xs max-w-full",title:a.name},[n[15]||(n[15]=e("i",{class:"fas fa-check-circle"},null,-1)),e("span",zt,p(a.name),1)],8,Ut))),128))])])])])):f("",!0)],512)])])):f("",!0),!t.companyId||!t.startDate||!t.endDate?(r(),o("div",Bt,n[16]||(n[16]=[e("p",{class:"text-red-500"},"Select company and date range to view the report.",-1)]))):K(u).loading?(r(),Je(Qe,{key:2},{default:re(()=>n[17]||(n[17]=[Q("Loading report...")])),_:1,__:[17]})):(r(),o("div",Mt,[e("table",Vt,[e("thead",Ft,[e("tr",Pt,[n[19]||(n[19]=e("th",{class:"px-4 py-3 border w-[10px] bg-white bg-opacity-70 backdrop-blur-sm rounded-tl-md print:rounded-tl-none text-center"}," sl ",-1)),e("th",Ht,[e("div",Wt,[n[18]||(n[18]=e("span",null,"Employee Name",-1)),t.employeeId?f("",!0):(r(),o("div",{key:0,class:"relative hidden md:block print:hidden",ref_key:"tableNoTodosRef",ref:ee},[e("button",{type:"button",class:"text-[11px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:n[2]||(n[2]=P(a=>je(),["stop"]))},[Q(" No Todos ("+p(_.value.withoutTodos.length)+") ",1),e("span",Jt,p(M.value?"Hidden":"Showing"),1)])],512))])]),J.value?f("",!0):(r(),o("th",Kt," Date ")),n[20]||(n[20]=e("th",{class:"px-4 py-3 border bg-white text-center"},"Todo",-1)),n[21]||(n[21]=e("th",{class:"px-4 py-3 border print:border-r print:border-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center rounded-tr-md print:rounded-tr-none"}," Status ",-1))])]),e("tbody",Qt,[ie.value.length===0?(r(),o("tr",Yt,[e("td",{colspan:J.value?4:5,class:"px-4 py-6 text-center text-gray-500"},n[22]||(n[22]=[e("div",null,[e("i",{class:"fas fa-tasks fa-2x text-gray-300 mb-2"})],-1),e("div",null,"No todos.",-1)]),8,Xt)])):f("",!0),(r(!0),o(D,null,j(ie.value,(a,m)=>{var $,C,N;return r(),o(D,{key:(($=a.user)==null?void 0:$.id)||(((N=(C=a.dates[0])==null?void 0:C.todos[0])==null?void 0:N.id)??Math.random())},[(r(!0),o(D,null,j(a.dates,(x,v)=>{var E;return r(),o(D,{key:`${((E=a.user)==null?void 0:E.id)||"u"}-${x.date}`},[(r(!0),o(D,null,j(x.todos,(T,V)=>{var be,ve,we,he,_e,De,ke,Ie,Te;return r(),o("tr",{key:T.id||`${((be=a.user)==null?void 0:be.id)||"u"}-${x.date||"empty"}-${V}`,class:"border odd:bg-white even:bg-gray-50 hover:bg-gray-100"},[v===0&&V===0?(r(),o("td",{key:0,rowspan:a.rowSpan||1,class:"px-4 py-3 align-top font-bold text-xl text-gray-800 whitespace-nowrap border-l border-t bg-white"},[e("div",qt,p(m+1),1)],8,Zt)):f("",!0),v===0&&V===0?(r(),o("td",{key:1,rowspan:a.rowSpan||1,class:"px-4 py-3 align-top font-medium text-gray-800 whitespace-nowrap border-l border-t bg-white"},[e("div",en,[oe(Ke,{size:"medium",user:a.user,class:"inline-block mr-2 align-middle"},null,8,["user"]),e("div",null,[e("div",null,p(((ve=a.user)==null?void 0:ve.name)||"Unknown user"),1),(he=(we=a.user)==null?void 0:we.department)!=null&&he.name?(r(),o("div",tn,p((De=(_e=a.user)==null?void 0:_e.department)==null?void 0:De.name),1)):f("",!0)])])],8,Gt)):f("",!0),T.isPlaceholder?(r(),o("td",{key:2,class:"border-l border-t border-r bg-white px-3 py-3 text-center",colspan:J.value?2:3},[n[27]||(n[27]=e("div",{class:"flex items-center justify-center gap-2 text-red-600 text-sm font-medium opacity-70"},[e("i",{class:"far fa-clipboard-list text-red-400"}),e("span",null,"No todos was provided.")],-1)),se.value?(r(),o(D,{key:0},[ne.value?(r(),o("div",sn," Loading attendanceâ€¦ ")):(r(!0),o(D,{key:1},j([Pe((ke=a==null?void 0:a.user)==null?void 0:ke.id,x==null?void 0:x.date)],w=>(r(),o("div",{key:w.comment,class:"min-w-[180px] mt-3 text-[11px] text-red-600 text-left inline-block align-top"},[w.hasData?(r(),o("div",an,[w.in==="-"&&w.out==="-"?(r(),o("div",{key:0,class:R(["text-center flex items-center justify-center rounded-md bg-slate-50 border text-xs border-dashed px-2 py-1.5 col-span-2",[{"text-red-500 border-red-300":w.comment==="Absent","text-blue-500 border-blue-300":w.comment!=="Absent"}]])},p(w.comment),3)):(r(),o(D,{key:1},[e("div",rn,[e("div",on,[n[23]||(n[23]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," In ",-1)),e("span",dn,p(w.in),1)]),e("div",ln,[n[24]||(n[24]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Late ",-1)),e("div",null,p(w.late),1)])]),e("div",pn,[e("div",un,[n[25]||(n[25]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Out ",-1)),e("span",mn,p(w.out),1)]),e("div",yn,[n[26]||(n[26]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Early ",-1)),e("div",null,p(w.out!=="-"?w.early:"-"),1)])])],64))])):(r(),o("div",cn," Attendance data unavailable. "))]))),128))],64)):f("",!0)],8,nn)):(r(),o(D,{key:3},[V===0&&!J.value?(r(),o("td",{key:0,rowspan:x.rowSpan||1,class:"px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white"},[e("div",xn,p(K(Y)(x.date)||x.date||"-"),1)],8,gn)):f("",!0),e("td",fn,[e("div",bn,[e("span",vn,p(V+1)+".",1),Q(" "+p(T.title),1)]),e("div",wn,p(((Ie=T.todoable)==null?void 0:Ie.title)||((Te=T.todoable_type)==null?void 0:Te.split("\\").pop())||""),1)]),e("td",hn,[e("span",{class:R(["text-xs font-semibold px-2.5 py-1 rounded-full",Oe(T.status)])},p(T.status||"N/A"),3)])],64))])}),128))],64)}),128))],64)}),128))])])]))])}}};export{jn as default};
