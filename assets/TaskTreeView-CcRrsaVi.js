import{o as n,c as i,F as _,x as E,k as q,r as A,y as D,p as M,a as t,e as v,m as f,n as h,l as k,t as c,q as x,z as P}from"./index-qOolgoBB.js";const R={class:"mt-3"},V={__name:"TaskTreeChildren",props:{childrenTasks:{type:Array,required:!0,default:[]},hideButtons:{type:Boolean,default:!1},parentTreeLevel:{type:Number}},setup(s){return(S,d)=>(n(),i("div",R,[(n(!0),i(_,null,E(s.childrenTasks,g=>(n(),q(ae,{key:g.id,task:g,class:"mb-3","hide-buttons":s.hideButtons,"tree-level":s.parentTreeLevel+1},null,8,["task","hide-buttons","tree-level"]))),128))]))}},O={class:"flex w-full"},U={key:0,class:"border-l border-gray-200 last:border-l-0"},$={class:"items-start grid grid-cols-3"},H={class:""},I={key:0,class:"text-sm text-gray-500 mt-2"},F={class:"flex items-center gap-2 text-xs text-gray-500 mt-2 opacity-50"},G={class:"px-2 py-0.5 text-xs rounded bg-blue-100 text-blue-800 border border-blue-200"},J={class:"flex items-start flex-wrap gap-3"},K={class:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-xs font-medium text-gray-600"},Q={class:"text-xs text-gray-700 mr-2"},W={class:"flex justify-end items-center"},X={class:"text-sm"},Y={class:"mt-4"},Z={class:"flex items-center"},ee={key:0,class:"fas fa-caret-down text-gray-400 group-hover:text-sky-400"},te={key:1,class:"fas fa-caret-right text-gray-400 group-hover:text-sky-400"},se={key:0,class:"flex gap-2 ml-auto items-center text-xs"},re={class:"ml-0"},ae={__name:"TaskTreeView",props:{task:{type:Object,required:!0},hideButtons:{type:Boolean,default:!1},treeLevel:{type:Number,default:0}},emits:["commentButtonClick"],setup(s,{emit:S}){const d=s,g=A(!1),N=D(()=>{var l,e,r,a;return{"hover:underline hover:text-sky-400 cursor-pointer":((e=(l=d.task)==null?void 0:l.children_tasks)==null?void 0:e.length)>0,"cursor-default pointer-none":((a=(r=d.task)==null?void 0:r.children_tasks)==null?void 0:a.length)===0}}),j=l=>l.split(" ").map(e=>e[0]).join("").toUpperCase(),z=l=>{switch(l){case"HIGH":return"border-red-500 text-red-500";case"MEDIUM":return"border-yellow-500 text-yellow-500";default:return"border-gray-300 text-gray-500"}},p=l=>{const e=m();let r,a,o;return e===100?(r="bg-green-50",a="bg-green-200",o="text-green-600 "):e<100&&(r="bg-red-50",a="bg-red-200",o="text-red-600 "),{container:r,bar:a,text:o}};function w(){if(d.task.children_tasks.length===0)return d.task.status==="COMPLETED"?1:0;const l=e=>{let r=0;for(let a=0;a<e.length;a++){const o=e[a];if(o.children_tasks.length===0)o.status==="COMPLETED"&&(r+=1);else{const b=o.children_tasks.length;l(o.children_tasks)===b&&(r+=1)}}return r};return l(d.task.children_tasks)}function m(){return d.task.children_tasks.length===0?d.task.status==="COMPLETED"?100:0:w()/d.task.children_tasks.length*100}return(l,e)=>{var a,o,b,T,C,B,L;const r=M("RouterLink");return n(),i("div",O,[s.treeLevel>0?(n(),i("div",U,e[2]||(e[2]=[t("div",{class:"border-l border-b w-4 rounded-bl-full border-gray-200 h-4/6 ml-[-1px] mt-[-30px]"},null,-1)]))):v("",!0),t("div",{class:x(["flex-grow border rounded py-3 group px-3",{"bg-green-50 ":m()===100,"bg-gray-50":m()<100,"shadow-sm":s.treeLevel>0}])},[t("div",$,[t("div",H,[f(r,{to:{name:"TaskShow",params:{id:s.task.id}},class:"font-medium text-gray-700 cursor-pointer hover:text-sky-700"},{default:h(()=>[k(c(s.task.title),1)]),_:1},8,["to"]),(a=s.task)!=null&&a.requirement?(n(),i("p",I," Requirement: "+c((b=(o=s.task)==null?void 0:o.requirement)==null?void 0:b.title),1)):v("",!0),t("div",F,[t("span",G,c(s.task.status),1),t("span",{class:x(["text-xs px-2 py-0.5 rounded border",z(s.task.priority)])},c(s.task.priority),3)])]),t("div",J,[(n(!0),i(_,null,E(s.task.users,(u,y)=>(n(),i("div",{class:"flex items-center gap-2 border rounded-full px-1 py-0.5 bg-slate-100 shadow-sm",key:y},[t("div",K,c(j(u==null?void 0:u.name)),1),t("span",Q,c(u==null?void 0:u.name),1)]))),128))]),t("div",W,[t("div",X,[t("div",{class:x(["rounded-full border py-0.5 text-xs relative overflow-hidden h-6",p().container]),style:{width:"180px"}},[t("div",{class:x(["z-10 absolute top-0 bottom-0",p().bar]),style:P(`width: ${m()}%`)},null,6),t("span",{class:x(["z-20 absolute inset-0 gap-1 text-center h-full flex justify-center items-center",p().text])},[t("span",null,[t("span",null,c(w()),1),e[3]||(e[3]=k(" / ")),t("span",null,c(s.task.children_tasks.length||1),1)])],2)],2)])])]),t("div",Y,[t("div",Z,[t("div",{class:"flex gap-3 group items-center",onClick:e[0]||(e[0]=u=>{var y;return((y=s.task.children_tasks)==null?void 0:y.length)>0?g.value=!g.value:null})},[g.value?(n(),i("i",ee)):(n(),i("i",te)),t("span",{class:x([N.value,"text-xs text-gray-500"])}," Sub Tasks ("+c((T=s.task.children_tasks)==null?void 0:T.length)+") ",3)]),s.hideButtons?v("",!0):(n(),i("div",se,[f(r,{to:{name:"TaskEdit",params:{id:s.task.id}},class:"btn-2 py-0.5 text-xs"},{default:h(()=>e[4]||(e[4]=[t("i",{class:"fas fa-edit"},null,-1),k(" Edit ")])),_:1},8,["to"]),f(r,{to:{name:"TaskReports",params:{id:(C=s.task)==null?void 0:C.id}},class:"border-indigo-500 hover:bg-indigo-600 text-indigo-600 hover:text-white font-semibold px-3 py-0.5 rounded-full transition border-2"},{default:h(()=>e[5]||(e[5]=[t("i",{class:"far fa-file-alt"},null,-1),k(" Reports ")])),_:1},8,["to"]),f(r,{to:{name:"TaskUserAssign",params:{id:(B=s.task)==null?void 0:B.id}},class:"border-indigo-500 hover:bg-indigo-600 text-indigo-600 hover:text-white font-semibold px-3 py-0.5 rounded-full transition border-2"},{default:h(()=>e[6]||(e[6]=[t("i",{class:"fas fa-user-plus"},null,-1),k(" Assign Users ")])),_:1},8,["to"]),f(r,{to:{name:"TaskAdd",query:{parent_id:(L=s.task)==null?void 0:L.id}},class:"border-indigo-500 hover:bg-indigo-600 text-indigo-600 hover:text-white font-semibold px-3 py-0.5 rounded-full transition border-2",onClick:e[1]||(e[1]=u=>u.stopPropagation())},{default:h(()=>e[7]||(e[7]=[t("i",{class:"fas fa-plus"},null,-1),k(" Add Sub Task ")])),_:1},8,["to"])]))]),t("div",re,[g.value?(n(),q(V,{key:0,childrenTasks:s.task.children_tasks,"hide-buttons":s.hideButtons,"parent-tree-level":s.treeLevel},null,8,["childrenTasks","hide-buttons","parent-tree-level"])):v("",!0)])])],2)])}}};export{ae as _};
