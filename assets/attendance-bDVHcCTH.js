import{J as x,r as g,D as y}from"./index-BWMy-C83.js";const F=x("attendance",()=>{const p=g([]),w=g([]),v=g([]),f=g([]),h=g([]),b=g(null),D=g(null),S=g(new Date().toISOString().substring(0,7)),L=g(new Date().toISOString().substring(0,10)),l=g(null),c=g(!1),R=async(t,n)=>{const e=$(n);return p.value.find(a=>a.date===e)},$=t=>{const n=new Date(t),e=String(n.getDate()).padStart(2,"0"),a=n.toLocaleString("en-US",{month:"short"}),o=n.getFullYear();return`${e} ${a} ${o}`};return{monthlyLogs:p,dailyLateLogs:f,monthlyLateLogs:h,summary:b,monthly_company_summary:D,selectedMonth:S,selectedDate:L,error:l,isLoading:c,dailyLogs:v,attendanceLogs:w,getUserDailyLogsByDate:R,getMonthlyAttendanceByShift:async(t,n)=>{var e,a;if(!t||!n){l.value="Invalid user ID or month";return}c.value=!0;try{const o=await y.get(`/user/${t}/attendance/monthly/${n}`);p.value=o.data.monthly_logs,b.value=o.data.summary,l.value=null}catch(o){l.value=((a=(e=o.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong",console.error(l.value)}finally{c.value=!1}},getTodayAttendanceReport:async(t={})=>{var n,e;c.value=!0,console.log({filter:t});try{const a=await y.get("/attendance/today",{params:t});v.value=a.data,l.value=null}catch(a){l.value=((e=(n=a.response)==null?void 0:n.data)==null?void 0:e.message)||"Something went wrong",console.error("[Attendance Error]",l.value)}finally{c.value=!1}},getAttendanceLateReport:async(t,n=null,e=null,a=null,o,r)=>{var s,d;c.value=!0;try{const u={company_id:t,department_id:n,category:e,employee_id:a,type:r,...r==="daily"?{date:o}:{month:o}},i=await y.get("/monthly/attendance/late-reports",{params:u});r==="daily"?f.value=i.data:r==="monthly"&&(h.value=i.data),l.value=null}catch(u){l.value=((d=(s=u.response)==null?void 0:s.data)==null?void 0:d.message)||"Something went wrong",console.error(l.value)}finally{c.value=!1}},getMonthlyAttendanceSummaryReport:async(t,n,e,a)=>{var o,r;if(!t||!a){l.value="Invalid user ID or month";return}c.value=!0;try{const s={company_id:t,employee_id:n,category:e,month:a},d=await y.get("/attendance/monthly-summary-reports",{params:s});D.value=d.data,l.value=null}catch(s){l.value=((r=(o=s.response)==null?void 0:o.data)==null?void 0:r.message)||"Something went wrong",console.error(l.value)}finally{c.value=!1}},downloadExcel:async(t,n,e)=>{var a,o;if(!t||!e){l.value="Invalid company ID or month";return}c.value=!0;try{const r={company_id:t,category:n,month:e},s=await y.get("/attendance/monthly-summary-reports?flag=excel",{params:r,responseType:"blob"}),d=window.URL.createObjectURL(new Blob([s.data])),u=document.createElement("a");u.href=d,u.setAttribute("download",`${e} attendance_summary.xlsx`),document.body.appendChild(u),u.click(),document.body.removeChild(u)}catch(r){l.value=((o=(a=r.response)==null?void 0:a.data)==null?void 0:o.message)||"Something went wrong",console.error(l.value)}finally{c.value=!1}},downloadPDF:async(t,n,e,a=0)=>{var o,r;if(!t||!e){l.value="Invalid user ID or month";return}c.value=!0;try{const s={company_id:t,category:n,month:e},d=await y.get("/attendance/monthly-summary-reports?flag=pdf",{params:s,responseType:"blob"}),u=window.URL.createObjectURL(new Blob([d.data])),i=document.createElement("a");i.href=u,i.setAttribute("download",`${e} attendance_summary.pdf`),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(s){l.value=((r=(o=s.response)==null?void 0:o.data)==null?void 0:r.message)||"Something went wrong",console.error(l.value)}finally{c.value=!1}},attendanceDownloadExcel:async(t,n,e,a,o)=>{var r,s;c.value=!0;try{const d={companyId:t,employee_id:n,category:e,month:a,status:o},u=await y.get("/attendance/today?flag=excel",{params:d,responseType:"blob"}),i=window.URL.createObjectURL(new Blob([u.data])),m=document.createElement("a");m.href=i,m.setAttribute("download",`${a} attendance_summary.xlsx`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(d){l.value=((s=(r=d.response)==null?void 0:r.data)==null?void 0:s.message)||"Something went wrong",console.error(l.value)}finally{c.value=!1}},attendanceDownloadPdf:async(t,n,e,a,o)=>{var r,s;c.value=!0;try{const d={companyId:t,employee_id:n,category:e,month:a,status:o},u=await y.get("/attendance/today?flag=pdf",{params:d,responseType:"blob"}),i=window.URL.createObjectURL(new Blob([u.data])),m=document.createElement("a");m.href=i,m.setAttribute("download",`${a} attendance_summary.pdf`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(d){l.value=((s=(r=d.response)==null?void 0:r.data)==null?void 0:s.message)||"Something went wrong",console.error(l.value)}finally{c.value=!1}},lateReportDownloadExcel:async(t,n,e,a)=>{var o,r;if(!t){l.value="Invalid company ID or date/month";return}c.value=!0;try{const s={company_id:t,...n?{employee_id:n}:{},type:a,...a==="daily"?{date:e}:{month:e}},d=await y.get("/monthly/attendance/late-reports?flag=excel",{params:s,responseType:"blob"}),u=window.URL.createObjectURL(new Blob([d.data])),i=document.createElement("a");i.href=u;const m=`${e}-late-attendance.xlsx`;i.setAttribute("download",m),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(s){l.value=((r=(o=s.response)==null?void 0:o.data)==null?void 0:r.message)||"Something went wrong",console.error(l.value)}finally{c.value=!1}},getMonthlyAttendanceLog:async(t,n)=>{var e,a;if(!t||!n){l.value="Invalid user ID or month";return}c.value=!0;try{const o=await y.get(`/user/${t}/attendance/monthly/${n}/log`);w.value=o.data.attendance_logs}catch(o){l.value=((a=(e=o.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong",console.error(l.value)}finally{c.value=!1}},getDateRangeAttendanceSummary:async(t,n,e,a)=>{var o,r;if(!e||!t||!n){l.value="Company, Start Date, and End Date are required";return}c.value=!0;try{return(await y.get("/attendance/date-range-summary",{params:{company_id:e,start_date:t,end_date:n,employee_id:a||void 0}})).data}catch(s){return l.value=((r=(o=s.response)==null?void 0:o.data)==null?void 0:r.message)||"Something went wrong",console.error(l.value),null}finally{c.value=!1}},downloadDateRangeExcel:async(t,n,e,a=null,o="")=>{var u;if(!e||!t||!n){l.value="Company, Start Date, and End Date are required";return}const r=(u=y.defaults.baseURL)==null?void 0:u.replace(/\/$/,"");let s=`flag=excel&company_id=${e}&start_date=${t}&end_date=${n}`;a&&(s+=`&employee_id=${a}`),o&&(s+=`&category=${o}`);const d=`${r}/attendance/date-range-summary?${s}`;console.log("📁 Opening Excel Download URL:",d),window.open(d,"_blank")},downloadDateRangePdf:(t,n,e,a=null,o="")=>{if(!e||!t||!n){l.value="Company, Start Date, and End Date are required";return}const r=new URLSearchParams({flag:"pdf",company_id:e,start_date:t,end_date:n});a&&r.append("employee_id",a),o&&r.append("category",o);const s=`/attendance/date-range-summary?${r.toString()}`;window.open(s,"_blank")}}});export{F as u};
