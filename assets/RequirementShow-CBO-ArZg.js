import{C as N,r as k,m as L,e as U,c,o as r,a as e,f as C,g as f,w,F as V,h,j as I,p as R,v as S,i as E,k as W,B as G,t as g,b as X,D as T,q as P}from"./index-EKyrEZ8j.js";import{L as A}from"./LoaderView-BYump_gI.js";import{O}from"./OverlyModal-CP94cEMm.js";import{R as Q}from"./RequiredIcon-gIxpb2dH.js";import{o as Y}from"./url-CePbr-gY.js";import{u as j}from"./user-9D1ACV-U.js";import{s as H}from"./vue-multiselect.esm-D3e8a45V.js";import{_ as J}from"./UserChip-jQxa3-V8.js";import{_ as Z}from"./TaskUserChip-Ch-19jam.js";import{f as ee}from"./requirement-BOdz7qP6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";async function te(m,x){return N.post(`/requirements/${m}/details`,x)}async function K(m,x,{params:p={}}={}){return N.get(`/requirements/${m}/details/${x}`,{params:p})}async function le(m,x,p){return N.put(`/requirements/${m}/details/${x}`,p)}async function se(m,x,{params:p={}}={}){const d=Y(p);return N.delete(`/requirements/${m}/details/${x}${d?"?"+d:""}`)}const ie={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},oe={class:"sticky top-0 pt-4 bg-white z-10"},re={class:"mb-4"},ne={class:"block text-gray-600 text-sm mb-1 font-medium"},ae={class:"mb-4"},de={class:"mb-4"},ue={class:"relative w-full border rounded lg:flex-grow"},me={key:0,class:"absolute right-8 text-xl top-0 bottom-0 flex items-center"},pe={class:"mb-4"},ve={class:"mb-4"},be={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},ce={key:0,class:"mb-4 text-red-500 font-medium"},fe={key:1,class:"mb-4"},ye={class:"flex items-center justify-between gap-4"},xe=["disabled"],ge={__name:"RequirementDetailAddForm",props:{requirementId:{type:[Number,String],required:!0}},emits:["create","closeClick","error"],setup(m,{emit:x}){const p=m,d=x,n=j(),u=k(""),i=k(),o=k({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),v=k([]),q=L(()=>Array.isArray(v.value)&&v.value.find(y=>{var l;return y.id==((l=o.value)==null?void 0:l.supervisor_id)})||null);function $(y){o.value.supervisor_id=(y==null?void 0:y.id)||""}function a(){o.value.supervisor_id=null}async function s(){var l,t;u.value="submitting";const y={...o.value};console.log({payload:y});try{const b=await te(p.requirementId,y);d("create",b),u.value="create"}catch(b){u.value="error",i.value=((t=(l=b.response)==null?void 0:l.data)==null?void 0:t.message)||"Failed to create requirement detail",d("error",i.value)}}return U(async()=>{v.value=await n.fetchDepartmentWiseEmployees()}),(y,l)=>(r(),c("div",ie,[e("div",oe,[l[6]||(l[6]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add Requirement Details",-1)),l[7]||(l[7]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:l[0]||(l[0]=w(t=>d("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:w(s,["prevent"]),class:"z-0"},[u.value!=="loading"?(r(),c(V,{key:0},[e("div",re,[e("label",ne,[l[8]||(l[8]=I("Title ")),R(Q)]),h(e("input",{"onUpdate:modelValue":l[1]||(l[1]=t=>o.value.title=t),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,o.value.title]])]),e("div",ae,[l[9]||(l[9]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),h(e("textarea",{rows:"10","onUpdate:modelValue":l[2]||(l[2]=t=>o.value.description=t),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,o.value.description]])]),e("div",de,[l[10]||(l[10]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),e("div",ue,[R(W(H),{modelValue:q.value,onSelect:$,onRemove:a,options:v.value,multiple:!1,label:"name","label-prefix":"id",placeholder:"--NO SUPERVISOR--"},{option:E(({option:t})=>[R(J,{user:t,class:"w-full line-clamp-1"},null,8,["user"])]),_:1},8,["modelValue","options"]),q.value?(r(),c("div",me,[e("button",{onClick:w(a,["prevent"]),class:"mt-0.5 text-gray-500 hover:text-red-700"}," Ã— ")])):f("",!0)])]),e("div",pe,[l[12]||(l[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),h(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":l[3]||(l[3]=t=>o.value.priority=t)},l[11]||(l[11]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[G,o.value.priority]])]),e("div",ve,[l[13]||(l[13]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),h(e("input",{type:"date","onUpdate:modelValue":l[4]||(l[4]=t=>o.value.better_to_complete_on=t),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,o.value.better_to_complete_on]])])],64)):f("",!0),e("div",be,[i.value?(r(),c("div",ce,g(i.value),1)):f("",!0),i.value?(r(),c("hr",fe)):f("",!0),e("div",ye,[e("button",{type:"button",onClick:l[5]||(l[5]=w(t=>d("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:u.value=="loading"||u.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},g(u.value=="submitting"?"Saving...":"Add Detail"),9,xe)])])],32),u.value==="loading"||u.value==="submitting"?(r(),C(A,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)]))}},ke={class:"border text-gray-800 py-4 shadow-sm mb-4 px-4 rounded-md hover:bg-blue-50"},we={class:"text-lg font-semibold mb-2"},$e={class:"line-clamp-5 mb-5"},_e={class:"text-justify"},qe={class:"flex items-end"},De={class:"flex items-center gap-1 mb-3"},Ce={class:"text-blue-400 font-semibold"},Re={class:"ml-auto flex gap-6 items-center"},he={__name:"RequirementDetailCard",props:{detail:{type:Object},serial:{type:Number}},emits:["editClick","deleteClick"],setup(m,{emit:x}){const p=x;return(d,n)=>(r(),c("div",ke,[e("div",null,[e("div",we,[e("span",null,g(m.serial)+". "+g(m.detail.title),1)]),n[3]||(n[3]=e("hr",{class:"mb-4 -mx-4"},null,-1)),e("div",$e,[n[2]||(n[2]=e("div",{class:"text-gray-500 mr-2 text-xs uppercase font-semibold"},"Description",-1)),e("p",_e,g(m.detail.description),1)])]),e("div",qe,[e("div",null,[e("div",De,[n[4]||(n[4]=e("span",{class:"text-gray-500 mr-2 text-xs uppercase font-semibold"},"Supervisor:",-1)),m.detail.supervisor?(r(),C(Z,{key:0,user:m.detail.supervisor},null,8,["user"])):f("",!0)]),e("div",null,[n[5]||(n[5]=e("span",{class:"text-gray-500 mr-2 text-xs uppercase font-semibold"},"Priority:",-1)),e("span",Ce,g(m.detail.priority),1)]),e("div",null,[n[6]||(n[6]=e("span",{class:"text-gray-500 mr-2 text-xs uppercase font-semibold"},"Better To Complete:",-1)),e("span",null,g(m.detail.better_to_complete_on),1)])]),e("div",Re,[e("button",{class:"btn-2",onClick:n[0]||(n[0]=w(u=>p("editClick",m.detail),["prevent"]))},n[7]||(n[7]=[e("i",{class:"fas fa-edit"},null,-1),I("Edit ")])),e("button",{class:"btn-2-red",onClick:n[1]||(n[1]=w(u=>p("deleteClick",m.detail),["prevent"]))},n[8]||(n[8]=[e("i",{class:"fas fa-trash-alt"},null,-1),I("Delete ")]))])])]))}},Se={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},Ie={class:"mb-4"},Ee={class:"font-semibold"},Ve={class:"mb-4"},Ne={class:"line-clamp-2"},Ue={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},Ae={key:0,class:"mb-4 text-red-500 font-medium"},Fe={key:1,class:"mb-4"},Te={class:"flex items-center justify-between gap-4"},Oe=["disabled"],je={__name:"RequirementDetailDeleteForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["delete","closeClick","error"],setup(m,{emit:x}){const p=m,d=x,n=j(),u=k(null),i=k(""),o=k(),v=k([]);async function q(){var $,a;i.value="submitting";try{const s=await se(p.requirementId,p.detailId);d("delete",s),i.value="create"}catch(s){i.value="error",o.value=((a=($=s.response)==null?void 0:$.data)==null?void 0:a.message)||"Failed to update requirement detail: "+s,d("error",o.value)}}return U(async()=>{var $,a,s;i.value="loading";try{v.value=await n.fetchDepartmentWiseEmployees(),u.value=($=(await K(p.requirementId,p.detailId)).data)==null?void 0:$.detail}catch(y){o.value=((s=(a=y.response)==null?void 0:a.data)==null?void 0:s.message)||"Failed to fetch requirement detail"}finally{i.value=""}}),($,a)=>{var s,y;return r(),c("div",Se,[a[4]||(a[4]=e("div",{class:"sticky top-0 pt-4 bg-white z-10"},[e("h2",{class:"text-2xl font-semibold text-gray-800"},"Delete Requirement Details"),e("hr",{class:"mb-4"})],-1)),e("form",{onSubmit:w(q,["prevent"]),class:"z-0"},[i.value!=="loading"?(r(),c(V,{key:0},[e("div",Ie,[a[1]||(a[1]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Title",-1)),e("div",Ee,g((s=u.value)==null?void 0:s.title),1)]),e("div",Ve,[a[2]||(a[2]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),e("div",Ne,g((y=u.value)==null?void 0:y.description),1)]),a[3]||(a[3]=e("div",{class:"my-8 text-center text-xl text-red-600"},"Are you sure want to delete?",-1))],64)):f("",!0),e("div",Ue,[o.value?(r(),c("div",Ae,g(o.value),1)):f("",!0),o.value?(r(),c("hr",Fe)):f("",!0),e("div",Te,[e("button",{type:"button",onClick:a[0]||(a[0]=w(l=>d("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:i.value=="loading"||i.value=="submitting",type:"submit",class:"bg-red-700 hover:bg-red-500 text-white font-semibold px-5 py-2 rounded transition"},g(i.value=="submitting"?"Deleting...":"Delete"),9,Oe)])])],32),i.value==="loading"||i.value==="submitting"?(r(),C(A,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)])}}},Me={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},ze={class:"sticky top-0 pt-4 bg-white z-10"},Be={class:"mb-4"},Pe={class:"block text-gray-600 text-sm mb-1 font-medium"},Le={class:"mb-4"},We={class:"mb-4"},Ge={class:"relative w-full border rounded lg:flex-grow"},Qe={key:0,class:"absolute right-8 text-xl top-0 bottom-0 flex items-center"},He={class:"mb-4"},Je={class:"mb-4"},Ke={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},Xe={key:0,class:"mb-4 text-red-500 font-medium"},Ye={key:1,class:"mb-4"},Ze={class:"flex items-center justify-between gap-4"},et=["disabled"],tt={__name:"RequirementDetailEditForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(m,{emit:x}){const p=m,d=x,n=j(),u=k(null),i=k(""),o=k(),v=k({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),q=k([]),$=L(()=>Array.isArray(q.value)&&q.value.find(l=>{var t;return l.id==((t=v.value)==null?void 0:t.supervisor_id)})||null);function a(l){v.value.supervisor_id=(l==null?void 0:l.id)||""}function s(){v.value.supervisor_id=null}async function y(){var t,b;i.value="submitting";const l={...v.value};console.log({payload:l});try{const D=await le(p.requirementId,p.detailId,l);d("update",D),i.value="create"}catch(D){i.value="error",o.value=((b=(t=D.response)==null?void 0:t.data)==null?void 0:b.message)||"Failed to update requirement detail",d("error",o.value)}}return U(async()=>{var l,t,b;i.value="loading";try{q.value=await n.fetchDepartmentWiseEmployees(),u.value=(l=(await K(p.requirementId,p.detailId)).data)==null?void 0:l.detail,v.value=u.value;const D=new Date(u.value.better_to_complete_on);v.value.better_to_complete_on=D.toISOString().split("T")[0]}catch(D){o.value=((b=(t=D.response)==null?void 0:t.data)==null?void 0:b.message)||"Failed to fetch requirement detail"}finally{i.value=""}}),(l,t)=>(r(),c("div",Me,[e("div",ze,[t[6]||(t[6]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add Requirement Details",-1)),t[7]||(t[7]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:t[0]||(t[0]=w(b=>d("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:w(y,["prevent"]),class:"z-0"},[i.value!=="loading"?(r(),c(V,{key:0},[e("div",Be,[e("label",Pe,[t[8]||(t[8]=I("Title ")),R(Q)]),h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=b=>v.value.title=b),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,v.value.title]])]),e("div",Le,[t[9]||(t[9]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),h(e("textarea",{rows:"10","onUpdate:modelValue":t[2]||(t[2]=b=>v.value.description=b),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,v.value.description]])]),e("div",We,[t[10]||(t[10]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),e("div",Ge,[R(W(H),{modelValue:$.value,onSelect:a,onRemove:s,options:q.value,multiple:!1,label:"name","label-prefix":"id",placeholder:"--NO SUPERVISOR--"},{option:E(({option:b})=>[R(J,{user:b,class:"w-full line-clamp-1"},null,8,["user"])]),_:1},8,["modelValue","options"]),$.value?(r(),c("div",Qe,[e("button",{onClick:w(s,["prevent"]),class:"mt-0.5 text-gray-500 hover:text-red-700"}," Ã— ")])):f("",!0)])]),e("div",He,[t[12]||(t[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),h(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[3]||(t[3]=b=>v.value.priority=b)},t[11]||(t[11]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[G,v.value.priority]])]),e("div",Je,[t[13]||(t[13]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),h(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=b=>v.value.better_to_complete_on=b),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,v.value.better_to_complete_on]])])],64)):f("",!0),e("div",Ke,[o.value?(r(),c("div",Xe,g(o.value),1)):f("",!0),o.value?(r(),c("hr",Ye)):f("",!0),e("div",Ze,[e("button",{type:"button",onClick:t[5]||(t[5]=w(b=>d("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:i.value=="loading"||i.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},g(i.value=="submitting"?"Saving...":"Edit Detail"),9,et)])])],32),i.value==="loading"||i.value==="submitting"?(r(),C(A,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)]))}},lt={class:"container mx-auto p-6"},st={class:"bg-white rounded shadow p-4 relative"},it={class:"mb-4"},ot={class:"mb-4"},rt={class:"mb-4"},nt={class:"flex items-center mb-6"},at={class:"ml-auto"},dt={key:0},ut={key:1,class:"border min-h-28 rounded-md flex items-center justify-center"},$t={__name:"RequirementShow",setup(m){const x=X(),p=k(""),d=k(null),n=T({open:!1}),u=T({detail:null,open:!1}),i=T({detail:null,open:!1});U(async()=>{await o()});async function o(){var a;p.value="loading",d.value=(a=(await ee(x.params.id)).data)==null?void 0:a.requirement,p.value=""}function v(){n.open=!0}function q(a){u.open=!0,u.detail=a}function $(a){i.open=!0,i.detail=a}return(a,s)=>{var y,l,t,b,D,M,z,B;return r(),c("div",lt,[n.open?(r(),C(O,{key:0,class:"*:max-w-4xl"},{default:E(()=>[R(ge,{requirementId:d.value.id,onCloseClick:s[0]||(s[0]=_=>n.open=!1),onCreate:s[1]||(s[1]=async()=>{n.open=!1,await o()})},null,8,["requirementId"])]),_:1})):f("",!0),u.open?(r(),C(O,{key:1},{default:E(()=>{var _;return[R(tt,{requirementId:d.value.id,detailId:(_=u.detail)==null?void 0:_.id,onCloseClick:s[2]||(s[2]=F=>u.open=!1),onUpdate:s[3]||(s[3]=async()=>{u.open=!1,await o()})},null,8,["requirementId","detailId"])]}),_:1})):f("",!0),i.open?(r(),C(O,{key:2},{default:E(()=>{var _;return[R(je,{requirementId:d.value.id,detailId:(_=i.detail)==null?void 0:_.id,onCloseClick:s[4]||(s[4]=F=>i.open=!1),onDelete:s[5]||(s[5]=async()=>{i.open=!1,await o()})},null,8,["requirementId","detailId"])]}),_:1})):f("",!0),e("div",st,[s[12]||(s[12]=e("div",{class:"text-center text-xl font-bold mb-2"},"Requirement Form",-1)),s[13]||(s[13]=e("hr",{class:"mb-4"},null,-1)),e("div",it,[s[6]||(s[6]=e("div",{class:"text-gray-500 text-sm"},"Website",-1)),e("div",null,[(r(!0),c(V,null,P(((y=d.value)==null?void 0:y.website_tags)||[],_=>(r(),c("div",{key:_.id},g(_.name),1))),128))])]),e("div",ot,[s[7]||(s[7]=e("div",{class:"text-gray-500 text-sm"},"From Department",-1)),e("div",null,g((t=(l=d.value)==null?void 0:l.from_department)==null?void 0:t.name),1)]),e("div",rt,[s[8]||(s[8]=e("div",{class:"text-gray-500 text-sm"},"To Department",-1)),e("div",null,g((D=(b=d.value)==null?void 0:b.to_department)==null?void 0:D.name),1)]),s[14]||(s[14]=e("hr",{class:"mb-4"},null,-1)),e("div",null,[e("div",nt,[s[10]||(s[10]=e("h2",{class:"text-xl font-semibold"},"Requirement Details",-1)),e("div",at,[(((M=d.value)==null?void 0:M.details)||[]).length>0?(r(),c("button",{key:0,class:"btn-4 font-semibold !pl-2 !pr-4",onClick:w(v,["prevent"])},s[9]||(s[9]=[e("i",{class:"fad fa-plus-circle text-2xl"},null,-1),I("Add More Details ")]))):f("",!0)])]),(((z=d.value)==null?void 0:z.details)||[]).length>0?(r(),c("div",dt,[(r(!0),c(V,null,P(((B=d.value)==null?void 0:B.details)||[],(_,F)=>(r(),C(he,{key:_.id,detail:_,serial:F+1,onEditClick:q,onDeleteClick:$},null,8,["detail","serial"]))),128))])):(r(),c("div",ut,[e("button",{class:"btn-4 font-semibold",onClick:w(v,["prevent"])},s[11]||(s[11]=[e("i",{class:"fad fa-plus-circle text-2xl"},null,-1),I("Add Requirement Details ")]))]))]),p.value==="loading"?(r(),C(A,{key:0,class:"absolute inset-0 bg-opacity-90"})):f("",!0)])])}}};export{$t as default};
