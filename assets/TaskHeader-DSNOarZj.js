import{g as te,f as le,x as n,r as se,h as ae,q as W,p as oe,c as f,o as m,a as t,j as x,t as B,i as R,d as j,l as I,F as G,m as c,k,H as ne,P as S,s as z,v as ue,e as re,b as P,w as de}from"./index-TYafwBxm.js";import{g as ie}from"./task-FCzI6iMP.js";import{u as me}from"./company--OsnddoA.js";import{_ as K}from"./CompanyDepartmentSelectInput-B7NP4mxh.js";import{_ as pe}from"./EmployeeDropdownInput-CapeghD4.js";import{_ as J}from"./SearchInput-CS2zkFtr.js";const ve={class:"mb-3 task-header"},ce={class:"flex justify-between items-start"},fe={class:"text-2xl font-bold text-gray-800 leading-none h-10"},xe={key:0,class:"ml-auto flex gap-6 items-center"},ye={class:"flex flex-wrap items-center justify-center gap-2 mt-3"},be={class:"flex flex-wrap gap-x-4 gap-y-3 justify-between"},ge={key:1,class:"relative w-full md:w-56 lg:flex-grow"},ke={class:"relative"},we={class:"w-32 relative h-10"},Ve={class:"flex gap-4 items-center flex-shrink-0"},Ce={class:"flex gap-2"},Te={class:"flex gap-2"},Me={class:"flex gap-2"},he={class:"text-gray-600 w-full md:w-32 relative"},Ae={class:"flex flex-col md:flex-row mb-2 items-end mt-6 gap-6 sticky top-[4.1rem] z-40 bg-white/80"},Ue={class:"flex items-center gap-3 flex-grow flex-wrap justify-center"},De={key:0,class:"text-[9px] text-green-800"},Le=["onClick"],Ee={key:1,class:"flex justify-end gap-5"},Be={__name:"TaskHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(g,{emit:Q}){const h=g,F=te(),y=le(),w=n(r("company-id")),V=n(r("from-department-id")),b=n(r("to-department-id")),A=n(r("user-ids")),U=n(r("month")),D=n(r("status")),L=n(r("is-important")),E=n(r("is-urgent")),q=n(r("is-target")),N=n(r("is-closed")),_=n(r("search")),O=Q,p=me(),C=se([]);function r(a){return{get:()=>h.modelValue[a]||"",set:e=>{O("update:modelValue",{...h.modelValue,[a]:e||void 0})}}}const X=n(()=>Y(A.value));async function $(){var a,e,d;if(!h.isMyTask){const i=(a=h.modelValue)==null?void 0:a["company-id"],s=b.value,u={...i?{company_id:i}:{},...s?{department_ids:[s]}:{}};C.value=((d=(e=await ie({params:u}))==null?void 0:e.data)==null?void 0:d.employees)||[]}}ae(async()=>{await p.fetchCompanies({with:"departments",ignore_permission:!0}),await p.fetchMyCompanies({with:"departments"}),await $()});function Y(a){return Array.isArray(C.value)&&C.value.find(e=>e.id==a)||null}function Z(){A.value=""}W(()=>b.value,$),W(()=>w.value,()=>{V.value="",b.value=""});function T(a,e,{value:d,id:i,label:s,onCancel:u}={}){if(!a)return[];const o=Array.isArray(e)?e.find(v=>(v==null?void 0:v[i])==a):null;return o?[{label:s,value:typeof d=="function"?d(o):o==null?void 0:o[d],id:o==null?void 0:o[i],onCancel:u}]:[]}const ee=n(()=>{var i;const a=p.companies.reduce((s,u)=>[...s,...u.departments],[]),e=(s,{label:u,value:o,id:v,onCancel:l})=>s?[{label:u,value:o,id:v,onCancel:l}]:[],d=(s,{label:u,onCancel:o})=>{if(!s)return[];const v=new Date(s);return[{label:u,value:v.toLocaleDateString("en-US",{month:"long",year:"numeric"}),id:s,onCancel:o}]};return[...T(w.value,p.companies,{label:"Company",value:"short_name",id:"id",onCancel:()=>{w.value=""}}),...T(V.value,a,{id:"id",label:"From",value:s=>s.short_name||s.name,onCancel:()=>{V.value=""}}),...T(b.value,a,{id:"id",label:"To",value:s=>s.short_name||s.name,onCancel:()=>{b.value=""}}),...T((i=X.value)==null?void 0:i.id,C.value,{label:"Employee",value:"name",id:"id",onCancel:Z}),...T(D.value,[{id:"only-completed",name:"Completed Only"},{id:"not-completed",name:"Not Completed"}],{label:"",value:"name",id:"id",onCancel:()=>{D.value=""}}),...e(L.value,{label:"",value:"Important ",id:!0,onCancel:()=>{L.value=""}}),...e(E.value,{label:"",value:"Urgent ",id:!0,onCancel:()=>{E.value=""}}),...e(q.value,{label:"",value:"Targeted Task",id:!0,onCancel:()=>{q.value=""}}),...d(U.value,{label:"",onCancel:()=>{U.value=""}})]}),H=n(()=>w.value?p==null?void 0:p.companies.filter(a=>a.id==w.value):p==null?void 0:p.companies);return(a,e)=>{var i,s,u,o,v;const d=oe("RouterLink");return m(),f("div",null,[t("div",ve,[t("div",ce,[t("h2",fe,B(N.value?"Closed":"")+" Task List ",1),g.isMyTask?x("",!0):(m(),f("div",xe,[t("button",{onClick:e[0]||(e[0]=l=>O("clickAddTask")),class:"btn-1"},"Add Main Task / Project")]))]),t("div",ye,[t("div",be,[j(K,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=l=>V.value=l),companies:H.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:I(()=>e[12]||(e[12]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),g.isMyTask?x("",!0):(m(),f(G,{key:0},[c(y).name!=="MyRequirementTaskList"?(m(),R(K,{key:0,modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l),companies:H.value||[],class:"relative w-full md:w-40 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:I(()=>e[13]||(e[13]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):x("",!0),c(F).isAdminMood&&((s=(i=c(F))==null?void 0:i.user)==null?void 0:s.role)!=="employee"?(m(),f("div",ge,[t("div",ke,[j(pe,{employees:C.value,modelValue:A.value,"onUpdate:modelValue":e[3]||(e[3]=l=>A.value=l),class:"border-2 border-gray-300 rounded h-[40px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),e[14]||(e[14]=t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Employee ",-1))]),e[15]||(e[15]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Employee ",-1))])):x("",!0)],64)),t("div",we,[e[17]||(e[17]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),k(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>D.value=l),class:"h-full text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},e[16]||(e[16]=[t("option",{value:""},"--ALL TASKS--",-1),t("option",{value:"not-completed"},"Not Completed",-1),t("option",{value:"only-completed"},"Completed",-1)]),512),[[ne,D.value]])]),t("div",Ve,[t("label",Ce,[k(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=l=>L.value=l)},null,512),[[S,L.value]]),e[18]||(e[18]=t("span",null,"Important",-1))]),t("label",Te,[k(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=l=>E.value=l)},null,512),[[S,E.value]]),e[19]||(e[19]=t("span",null,"Urgent",-1))]),t("label",Me,[k(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=l=>q.value=l)},null,512),[[S,q.value]]),e[20]||(e[20]=t("span",null,"Is Target",-1))]),t("label",{class:z(["flex gap-2 border px-2 rounded",[N.value?"bg-sky-800 text-white border-sky-500":"text-sky-800 border-sky-500"]])},[k(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=l=>N.value=l)},null,512),[[S,N.value]]),e[21]||(e[21]=t("span",null,"Closed",-1))],2)]),t("div",he,[e[22]||(e[22]=t("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),k(t("input",{id:"month-filter","onUpdate:modelValue":e[9]||(e[9]=l=>U.value=l),type:"month",class:"h-10 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[ue,U.value]])])]),g.isMyTask?(m(),R(J,{key:0,modelValue:_.value,"onUpdate:modelValue":e[10]||(e[10]=l=>_.value=l),class:"w-full md:w-64 lg:w-64 md:ml-auto"},null,8,["modelValue"])):x("",!0)])]),t("div",Ae,[g.isMyTask?x("",!0):(m(),R(J,{key:0,modelValue:_.value,"onUpdate:modelValue":e[11]||(e[11]=l=>_.value=l),class:"w-full md:w-64 md:ml-auto"},null,8,["modelValue"])),t("div",Ue,[(m(!0),f(G,null,re(ee.value,l=>(m(),f("div",{key:l.label||l.value,class:"flex-shrink-0 text-xs bg-gray-50 border border-gray-300 rounded-md px-2 flex gap-1"},[t("div",null,[l.label?(m(),f("span",De,B(l.label)+": ",1)):x("",!0),P(B(l.value),1)]),t("button",{type:"button",class:"text-gray-400 hover:text-red-400",onClick:de(l.onCancel,["prevent"])},e[23]||(e[23]=[t("i",{class:"fas fa-times-circle"},null,-1)]),8,Le)]))),128))]),g.isMyTask?x("",!0):(m(),f("div",Ee,[j(d,{class:z(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((u=c(y).query)==null?void 0:u.view)==="userwise"?"bg-blue-500 text-white":""]),to:{query:{...c(y).query,view:"userwise"}}},{default:I(()=>e[24]||(e[24]=[P(" User Wise List ")])),_:1,__:[24]},8,["class","to"]),j(d,{class:z(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((o=c(y).query)==null?void 0:o.view)!=="userwise"?"bg-blue-500 text-white":""]),to:{query:{...Object.keys(((v=c(y))==null?void 0:v.query)||{}).filter(l=>{var M;return((M=c(y))==null?void 0:M.query[l])!=="userwise"}).reduce((l,M)=>({...l,[M]:c(y).query[M]}),{})}}},{default:I(()=>e[25]||(e[25]=[P(" Department Wise List ")])),_:1,__:[25]},8,["class","to"])]))])])}}};export{Be as _};
