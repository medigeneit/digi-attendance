import{r as g,e as h,z as D,c as b,o as n,a as e,g as f,F as E,h as w,j as R,p as i,v as S,i as k,w as _,B as A,f as M,k as c,t as U,u as B}from"./index-Db80mu-f.js";import{_ as T}from"./CompanyDepartmentSelectInput-Ch_K6MUK.js";import{R as q}from"./RequiredIcon-DNgIMqio.js";import{a as F}from"./requirement-Di5wATcV.js";import{u as z}from"./company-fpv_GKIf.js";import{u as O}from"./tags-DKYRahZt.js";import{u as j}from"./useTaskStore-BOQ7mVbY.js";import{L}from"./LoaderView-Dnk_pPzn.js";import{S as I}from"./SelectDropdown-Bp469BRg.js";import{u as P}from"./department-CaQEcvvf.js";import{_ as N}from"./UserChip-DSDyPYx5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"mb-4"},G={class:"block text-gray-600 text-sm mb-1 font-medium"},H={class:"mb-4"},J={class:"mb-4"},K={key:0,class:"relative w-full"},Q={key:0,class:"absolute right-1 text-xl top-0 bottom-0 flex items-center"},X={class:"mb-4"},Y={class:"mb-4"},Z={__name:"RequirementFormDetailItem",props:{fromDepartmentId:{type:[Number,String],required:!0}},emits:["update","onRemoveClick"],setup(V,{emit:y}){const a=V,m=y,u=P(),d=g(""),s=g({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:""}),p=g([]);return h(async()=>{p.value=await u.fetchDepartmentEmployee([a.fromDepartmentId])}),D(()=>a.fromDepartmentId,async()=>{p.value=await u.fetchDepartmentEmployee([a.fromDepartmentId])}),D(()=>({...s.value}),l=>{m("update",l)}),(l,o)=>(n(),b("div",null,[e("form",{onSubmit:o[6]||(o[6]=_((...r)=>l.submit&&l.submit(...r),["prevent"])),class:"z-0"},[d.value!=="loading"?(n(),b(E,{key:0},[e("div",W,[e("label",G,[o[7]||(o[7]=R("Title ")),i(q)]),w(e("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>s.value.title=r),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,s.value.title]])]),e("div",H,[o[8]||(o[8]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Details",-1)),w(e("textarea",{rows:"10","onUpdate:modelValue":o[1]||(o[1]=r=>s.value.description=r),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,s.value.description]])]),e("div",J,[o[9]||(o[9]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),i(I,{modelValue:s.value.supervisor_id,"onUpdate:modelValue":o[3]||(o[3]=r=>s.value.supervisor_id=r),options:p.value,placeholder:"--NO SUPERVISOR--"},{option:k(({option:r})=>[i(N,{user:r||{}},null,8,["user"])]),"selected-option":k(({option:r})=>[r?(n(),b("div",K,[i(N,{user:r||{}},null,8,["user"]),s.value.supervisor_id?(n(),b("div",Q,[e("button",{onClick:o[2]||(o[2]=_(x=>s.value.supervisor_id=null,["prevent"])),class:"text-gray-6 font-semibold 00 hover:text-red-700"}," Ã— ")])):f("",!0)])):f("",!0)]),_:1},8,["modelValue","options"])]),e("div",X,[o[11]||(o[11]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),w(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":o[4]||(o[4]=r=>s.value.priority=r)},o[10]||(o[10]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[A,s.value.priority]])]),e("div",Y,[o[12]||(o[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),w(e("input",{type:"date","onUpdate:modelValue":o[5]||(o[5]=r=>s.value.better_to_complete_on=r),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,s.value.better_to_complete_on]])])],64)):f("",!0)],32)]))}},ee={class:"w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},te={class:"sticky top-0 pt-4 bg-white z-10"},oe={class:"block text-gray-600 text-sm mb1 font-medium"},se={class:"block text-gray-600 text-sm mb-1 font-medium"},re={class:"mb-4"},le={class:"mb-8"},ie={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},ae={key:0,class:"mb-4 text-red-500 font-medium"},ne={key:1,class:"mb-4"},me={class:"flex items-center justify-between gap-4"},ue=["disabled"],de={__name:"RequirementAddForm",emits:["create","cancelClick","error"],setup(V,{emit:y}){const a=y,m=j(),u=O(),d=z(),s=g(""),p=g([]),l=g({from_department_id:"",to_department_id:"",website_tags:[],details:[]});h(async()=>{s.value="loading",u.fetchTags("website"),await d.fetchCompanies({with:"departments",ignore_permission:!0}),await d.fetchMyCompanies({with:"departments"}),s.value=""});async function o(){s.value="submitting";const x={...l.value,...p.value&&Array.isArray(p.value)?{website_tags:p.value.map(t=>t.id)}:{}};try{const t=await F(x);a("create",t),s.value="create"}catch{a("error",m.error),s.value="error"}}function r(x){console.log({detailData:x})}return(x,t)=>{var C,$;return n(),b("div",ee,[e("div",te,[t[5]||(t[5]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add New Requirement",-1)),t[6]||(t[6]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:t[0]||(t[0]=_(v=>a("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:_(o,["prevent"]),class:"z-0"},[s.value!=="loading"&&s.value!=="submitting"?(n(),b(E,{key:0},[i(T,{modelValue:l.value.from_department_id,"onUpdate:modelValue":t[1]||(t[1]=v=>l.value.from_department_id=v),companies:((C=c(d))==null?void 0:C.myCompanies)||[],class:"mb-4"},{label:k(()=>[e("label",oe,[t[7]||(t[7]=R(" From ")),i(q)])]),_:1},8,["modelValue","companies"]),i(T,{modelValue:l.value.to_department_id,"onUpdate:modelValue":t[2]||(t[2]=v=>l.value.to_department_id=v),companies:(($=c(d))==null?void 0:$.companies)||[],class:"mb-4"},{label:k(()=>[e("label",se,[t[8]||(t[8]=R(" To ")),i(q)])]),_:1},8,["modelValue","companies"]),e("div",re,[t[9]||(t[9]=e("label",{class:"text-gray-800"},"Websites",-1)),i(I,{options:c(u).tags,modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=v=>p.value=v),multiple:"",label:"name",value:"id"},null,8,["options","modelValue"])])],64)):f("",!0),e("div",le,[t[10]||(t[10]=e("h3",{class:"font-semibold text-xl"},"Requirement details",-1)),t[11]||(t[11]=e("hr",{class:"mb-2"},null,-1)),t[12]||(t[12]=e("div",null,"dsdf",-1)),i(Z,{"from-department-id":l.value.from_department_id,onUpdate:r},null,8,["from-department-id"])]),e("div",ie,[c(m).error?(n(),b("div",ae,U(c(m).error),1)):f("",!0),c(m).error?(n(),b("hr",ne)):f("",!0),e("div",me,[e("button",{type:"button",onClick:t[4]||(t[4]=_(v=>a("cancelClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:s.value=="loading"||s.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},U(s.value=="submitting"?"Saving...":"Save"),9,ue)])])],32),s.value==="loading"||s.value==="submitting"?(n(),M(L,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)])}}},pe={class:"container mx-auto p-6"},Re={__name:"RequirementAdd",setup(V){const y=B();function a(m){var d;const u=((d=m.data)==null?void 0:d.requirement)||null;u&&y.push({name:"RequirementShow",params:{id:u.id}})}return(m,u)=>(n(),b("div",pe,[i(de,{onCreate:a})]))}};export{Re as default};
