import{E as B,r as n,x as v,G as d}from"./index-CMzJOpML.js";const D=B("todo",()=>{const c=n(null),s=n(!1),u=n(null),r=n([]),h=async()=>{var l,a,t;s.value=!0,u.value=null;try{const e=await d.get("/todos");r.value=((l=e.data)==null?void 0:l.todos)||[]}catch(e){throw u.value=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Todos load failed",e}finally{s.value=!1}},T=async()=>{var l,a,t;s.value=!0,u.value=null;try{const e=await d.get("/my-todos");r.value=((l=e.data)==null?void 0:l.todos)||[]}catch(e){throw u.value=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Todos load failed",e}finally{s.value=!1}},w=l=>{var a;return(a=r.value)==null?void 0:a.filter(t=>t.date==l)},g=async l=>{var a,t;s.value=!0,u.value=null;try{const e=await d.get(`/todos/${l}`);c.value=e.data,c.value=r.value.find(o=>o.id==l)}catch(e){throw u.value=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Todo load failed",e}finally{s.value=!1}},m=async l=>{var a,t,e;s.value=!0,u.value=null;try{const o=await d.post("/todos",l);return r.value=[...r.value,(a=o.data)==null?void 0:a.todo],o.data}catch(o){throw u.value=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||"Todo create failed",o}finally{s.value=!1}},$=async(l,a)=>{var t,e;s.value=!0,u.value=null;try{const o=await d.put(`/todos/${l}`,a);return r.value=r.value.map(i=>{var f,p,y;return i.id==((p=(f=o.data)==null?void 0:f.todo)==null?void 0:p.id)?(y=o.data)==null?void 0:y.todo:{...i}}),o.data}catch(o){throw u.value=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||"Todo update failed",o}finally{s.value=!1}},S=async(l,a)=>{var t,e;s.value=!0,u.value=null;try{await d.put(`/todos/status/${l}`,{status:a}),r.value=r.value.map(o=>o.id===l?{...o,status:a}:{...o})}catch(o){throw u.value=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to update todo status",o}finally{s.value=!1}},x=async l=>{var a,t;s.value=!0,u.value=null;try{await d.delete(`/todos/${l}`),r.value=r.value.filter(e=>e.id!==l)}catch(e){throw u.value=((t=(a=e.response)==null?void 0:a.data)==null?void 0:t.message)||"Todo delete failed",e}finally{s.value=!1}};return{todos:v(()=>r.value),todo:v(()=>c.value),loading:v(()=>s.value),error:v(()=>u.value),fetchTodos:h,fetchTodo:g,createTodo:m,updateTodo:$,deleteTodo:x,fetchMyTodos:T,updateTodoStatus:S,getTodosByDate:w}});export{D as u};
