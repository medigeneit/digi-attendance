import{_ as q,a as B}from"./HeaderWithButtons-FSa8q8ZB.js";import{L as I}from"./LoaderView-Chlr8TBt.js";import{r as g,D as G,A as F,c as i,f as N,o as n,a as e,t as f,w as O,g as y,C as V,F as $,x as M,h as S,v as C,j as R,s as z,e as H,l as w}from"./index-jKCwu-vz.js";import{u as J}from"./company-DzEQGWWS.js";import{u as K}from"./designation-CUy6f_kr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const P={key:0,class:"modal-bg"},Q={class:"modal-card"},W={class:"text-lg font-semibold mb-4"},X={class:"mb-4"},Y=["value"],Z={class:"mb-4"},ee={class:"mb-4"},te={class:"mb-4"},se={class:"mb-4"},oe={class:"flex justify-end"},ae={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},le={__name:"DesignationModal",props:{show:{type:Boolean,required:!0},designation:{type:Object,default:null}},emits:["close","save"],setup(k,{emit:c}){const d=k,b=c,x=J(),p=g(!1),D=g(!1),t=G({id:null,company_id:"",title:"",grade:"",description:"",status:"Active"}),m=()=>{p.value=!1,t.id=null,t.company_id="",t.title="",t.grade="",t.description="",t.status="Active"};F(()=>d.designation,a=>{a&&Object.keys(a).length>0?(p.value=!0,t.id=a.id||null,t.company_id=a.company_id||"",t.title=a.title||"",t.grade=a.grade||"",t.description=a.description||"",t.status=a.status||"Active"):m()},{immediate:!0,deep:!0}),F(()=>d.show,async a=>{a&&!D.value&&await _()});const r=()=>{b("save",{...t}),m(),h()},h=()=>{m(),b("close")},_=async()=>{try{await x.fetchCompanies(),D.value=!0}catch(a){console.error("Failed to fetch companies:",a)}};return(a,s)=>k.show?(n(),i("div",P,[e("div",Q,[e("h2",W,f(p.value?"Edit Designation":"Add Designation"),1),e("form",{onSubmit:O(r,["prevent"])},[e("div",X,[s[6]||(s[6]=e("label",{for:"company_id",class:"block text-sm font-medium mb-2"},"Company",-1)),y(e("select",{id:"company_id","onUpdate:modelValue":s[0]||(s[0]=o=>t.company_id=o),class:"w-full border rounded px-3 py-2",required:""},[s[5]||(s[5]=e("option",{value:"",disabled:""},"Select a company",-1)),(n(!0),i($,null,M(S(x).companies,o=>(n(),i("option",{key:o.id,value:o.id},f(o.name),9,Y))),128))],512),[[V,t.company_id]])]),e("div",Z,[s[7]||(s[7]=e("label",{for:"title",class:"block text-sm font-medium mb-2"},"Title",-1)),y(e("input",{id:"title","onUpdate:modelValue":s[1]||(s[1]=o=>t.title=o),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter designation title",required:""},null,512),[[C,t.title]])]),e("div",ee,[s[8]||(s[8]=e("label",{for:"grade",class:"block text-sm font-medium mb-2"},"Grade",-1)),y(e("input",{id:"grade","onUpdate:modelValue":s[2]||(s[2]=o=>t.grade=o),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter grade (optional)"},null,512),[[C,t.grade]])]),e("div",te,[s[9]||(s[9]=e("label",{for:"description",class:"block text-sm font-medium mb-2"},"Description",-1)),y(e("textarea",{id:"description","onUpdate:modelValue":s[3]||(s[3]=o=>t.description=o),class:"w-full border rounded px-3 py-2",placeholder:"Enter description"},null,512),[[C,t.description]])]),e("div",se,[s[11]||(s[11]=e("label",{for:"status",class:"block text-sm font-medium mb-2"},"Status",-1)),y(e("select",{id:"status","onUpdate:modelValue":s[4]||(s[4]=o=>t.status=o),class:"w-full border rounded px-3 py-2",required:""},s[10]||(s[10]=[e("option",{value:"Active"},"Active",-1),e("option",{value:"Inactive"},"Inactive",-1)]),512),[[V,t.status]])]),e("div",oe,[e("button",{type:"button",onClick:h,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2"}," Cancel "),e("button",ae,f(p.value?"Update":"Create"),1)])],32)])])):N("",!0)}},ie={class:"my-container space-y-4"},ne={key:0,class:"text-center py-4"},de={key:1,class:"space-y-4"},re={key:0,class:"space-y-4"},ce={class:"title-md"},ue={class:"overflow-x-auto"},pe={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},me={class:"text-gray-600 text-sm"},fe={class:"py-3 px-2 text-left"},ve={class:"py-3 px-2 text-left whitespace-nowrap"},ye={class:"py-3 px-2 text-center"},ge={class:"py-3 px-2 text-center"},be={class:"flex item-center justify-center gap-4"},xe=["onClick"],he=["onClick"],Me={__name:"DesignationList",setup(k){const c=K(),d=R(),{designations:b,loading:x,message:p,error:D}=z(c),t=g(!1),m=g(!1),r=g(null),h=()=>{r.value=null,t.value=!0},_=()=>{t.value=!1},a=l=>{r.value=l,t.value=!0},s=l=>{r.value=l,m.value=!0},o=()=>{m.value=!1},U=async l=>{try{l.id?(await c.updateDesignation(l.id,l),d.success(p)):(await c.createDesignation(l),d.success(p)),await c.fetchDesignations()}catch(u){d.error("Failed to save designation!"),console.error("Error handling save:",u)}finally{_()}},j=async()=>{if(!r.value||!r.value.id){d.error("Invalid designation selected for deletion!");return}try{await c.deleteDesignation(r.value.id),d.success("Designation deleted successfully!")}catch(l){d.error("Failed to delete designation!"),console.error("Error deleting designation:",l)}finally{o()}};return H(async()=>{try{await c.fetchDesignations()}catch(l){d.error("Failed to fetch designations!"),console.error("Error fetching designations:",l)}}),(l,u)=>{var A;return n(),i("div",ie,[w(q,{title:"Designation List",onAdd:h}),S(x)?(n(),i("div",ne,[w(I)])):(n(),i("div",de,[(n(),i("div",re,[(n(!0),i($,null,M(S(b),(L,E)=>(n(),i("div",{key:E},[e("h2",ce,f(E),1),e("div",ue,[e("table",pe,[u[2]||(u[2]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"Title"),e("th",{class:"py-3 px-2 text-left"},"Grade"),e("th",{class:"py-3 px-2 text-center"},"Status"),e("th",{class:"py-3 px-2 text-center"},"Action")])],-1)),e("tbody",me,[(n(!0),i($,null,M(L,v=>(n(),i("tr",{key:v.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",fe,f(v.title),1),e("td",ve,f(v.grade),1),e("td",ye,f(v.status),1),e("td",ge,[e("div",be,[e("button",{onClick:T=>a(v),class:"text-blue-600 hover:text-blue-800"},u[0]||(u[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,xe),e("button",{onClick:T=>s(v),class:"text-red-600 hover:text-red-800"},u[1]||(u[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,he)])])]))),128))])])])]))),128))]))])),w(le,{show:t.value,designation:r.value,onClose:_,onSave:U},null,8,["show","designation"]),w(B,{show:m.value,title:"Delete Designation",message:`Are you sure you want to delete ${(A=r.value)==null?void 0:A.title}?`,onClose:o,onConfirm:j},null,8,["show","message"])])}}};export{Me as default};
