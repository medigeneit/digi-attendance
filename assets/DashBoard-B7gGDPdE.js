import{O as U}from"./OverlyModal-Cnx8Z8Ga.js";import{m as B,c as r,o as n,g as k,F as D,n as T,f as R,p as L,q as v,i as g,a as e,t as i,k as y,R as V,w as S,s as z,r as A,e as O,x as P,h as F,v as E,d as W,y as q,u as Y,z as H,j as x}from"./index-Dpa0EZ85.js";import{L as I}from"./LoaderView-yWlnDcBf.js";import{o as C,g as M,a as G}from"./datetime-BlGg5F0U.js";import{u as J}from"./useTaskStore-C5I1snr6.js";import{_ as K}from"./TaskTreeView-CUqXV_0E.js";import{u as Q}from"./user-sc2pWuRE.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./url-CePbr-gY.js";import"./UserChip-kHg-RdPy.js";const X=(b,u,l,p)=>{const c=new Date(p,l-1,u);return b.filter(o=>{const m=o.deadline?new Date(o.deadline):null,d=C(new Date);if(o.assigned_at||o.created_at){let w=o.assigned_at?C(new Date(o.assigned_at)):null;!w&&o.created_at&&(w=C(new Date(o.created_at)));let a=null;return!(c<w||(o.completed_at&&(a=C(new Date(o.completed_at))),a&&a<c)||m&&m<c&&c>d)}return!1}).map(o=>{let m=!1;return o.deadline&&(m=new Date(o.deadline)<c),{...o,deadline_crossed:m}})},Z={key:0},ee={key:0,class:"fad fa-folder text-xs mr-2"},te={key:1,class:"fad fa-file-alt text-xs mr-2"},se={key:2,class:"text-center w-full mt-4 text-xs text-gray-600"},ae={__name:"TaskListOnDay",props:{isCurrentMonth:{type:Boolean,default:!1},tasks:{type:Array,default:()=>[]},limit:{type:Number,default:null},tree:{type:Boolean,default:!1}},emits:["clickOnMore"],setup(b,{emit:u}){const l=b,p=u,c=B(()=>{var o;return l.limit?((o=l==null?void 0:l.tasks)==null?void 0:o.slice(0,l.limit))||[]:[...l.tasks]});return(o,m)=>(n(),r("div",null,[b.tree?(n(),r("div",Z,[(n(!0),r(D,null,T(c.value,d=>(n(),R(K,{"hide-buttons":"","hide-assigned-users":"",task:d,key:d.id,class:"mb-6"},null,8,["task"]))),128))])):(n(),r("ul",{key:1,class:L({"text-gray-500 group-hover:text-gray-900":!b.isCurrentMonth})},[(n(!0),r(D,null,T(c.value,d=>(n(),r("li",{class:"mb-2",key:d.id},[v(y(V),{to:`/tasks/${d.id}`,target:"_blank",class:"flex items-center hover:underline hover:text-blue-600"},{default:g(()=>[d.children_task_count>0?(n(),r("i",ee)):k("",!0),d.children_task_count==0?(n(),r("i",te)):k("",!0),e("span",{class:L(["line-clamp-1",{"text-red-800":d.deadline_crossed}])},i(d.title),3)]),_:2},1032,["to"])]))),128))],2)),b.tasks.length-c.value.length>0?(n(),r("div",se,[e("button",{onClick:m[0]||(m[0]=S(d=>p("clickOnMore",d),["prevent"])),class:"text-blue-600 hover:underline"}," +"+i(b.tasks.length-c.value.length)+" More Tasks ",1)])):k("",!0)]))}},oe={class:"border"},ne={class:"px-4 py-2 flex items-center bg-gray-50 group"},le={class:"mx-4"},re={class:"ml-4 md:ml-auto flex items-center gap-2"},ie={class:"bg-gray-300 bg-opacity-90 relative"},de={class:"bg-white border rounded-md z-20"},ue={__name:"DailyTask",setup(b){const u=z({day:null,month:null,year:null}),l=A(),p=A("loading"),c=J();O(()=>{l.value=M(new Date)}),P(l,a=>{const[_,f,t]=a.split("-").map(Number);u.day=t,u.month=f,u.year=_}),P(()=>u.month,async()=>{p.value="loading",await o(),p.value=""});async function o(){await c.fetchMyTasks({status:"not-completed"})}function m(){const a=new Date;l.value=M(a)}function d(){const a=new Date(l.value);a.setDate(a.getDate()+1),l.value=M(a)}function w(){const a=new Date(l.value);a.setDate(a.getDate()-1),l.value=M(a)}return(a,_)=>(n(),r("div",oe,[e("div",ne,[_[1]||(_[1]=e("h2",{class:"leading-none font-semibold text-lg"},"Daily Task",-1)),e("div",le,i(y(G)(l.value)),1),e("button",{class:"btn-3 mx-4 h-7",onClick:S(m,["prevent"])},"Today"),e("div",re,[e("button",{class:"btn-2 h-7",onClick:S(w,["prevent"])},"Previous Day"),e("button",{class:"btn-2 h-7",onClick:S(d,["prevent"])},"Next Day"),F(e("input",{type:"date","onUpdate:modelValue":_[0]||(_[0]=f=>l.value=f),class:"border px-2 rounded"},null,512),[[E,l.value]])])]),e("div",ie,[e("div",de,[_[2]||(_[2]=e("div",{class:"text-md font-semibold mb-4 sticky top-0 border-b px-4 z-30 py-3 bg-white flex items-center"}," Tasks ",-1)),v(ae,{class:"p-4 min-h-[40vh] max-h-[60vh] overflow-y-auto","is-current-month":a.isCurrentMonth,tasks:y(X)(y(c).tasks,u.day,u.month,u.year),tree:!0},null,8,["is-current-month","tasks"])]),p.value==="loading"?(n(),R(I,{key:0,class:"absolute inset-0 flex items-center justify-center z-20 bg-opacity-70"})):k("",!0)])]))}},ce={class:"container px-6 mx-auto"},me={key:0,class:"grid gap-4 md:grid-cols-3 mt-4"},ye={class:"text-3xl"},pe={class:"text-3xl"},fe={class:"text-3xl"},xe={class:"text-3xl"},he={class:"text-3xl"},_e={class:"text-3xl"},ge={key:1,class:"w-full mt-4"},ve={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},be={class:"bg-white shadow-md rounded-lg p-4"},we={class:"space-y-2"},ke={class:"flex justify-between items-center px-4 py-2 rounded hover:bg-gray-50 transition-colors"},De={class:"font-semibold text-gray-800"},Te={key:0},Le={key:1},$e={key:2},Ce={class:"space-y-3"},Me={class:"flex items-center space-x-4"},Se={class:"absolute top-10 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition pointer-events-none z-10 whitespace-nowrap"},Re={class:"text-sm font-medium text-gray-900"},Ae={class:"text-xs text-gray-500 mt-0.5"},Ne={class:"text-xl font-bold text-gray-800 flex items-center gap-2 p-4"},Pe={class:"space-y-5 px-4 md:px-6 py-4"},qe={class:"text-sm text-gray-500 flex items-center gap-2"},Be={class:"flex justify-end gap-3 mt-6"},Oe={class:"bg-white shadow-md rounded-lg"},je={class:"overflow-x-auto shadow-md sm:rounded-lg min-h-max"},Ue={class:"min-w-full text-sm text-left text-gray-500"},Ve={class:"px-6 py-4 font-medium text-gray-900"},ze={class:"px-6 py-4"},Fe={class:"px-6 py-4"},Ee={class:"px-6 py-4"},We={class:"card-bg mt-4 gap-0 shadow-md border border-gray-300"},tt={__name:"DashBoard",setup(b){const u=W(),l=Q(),{dashboardInfo:p,selectedDate:c,userDashboard:o}=q(l),{user:m}=q(u),d=Y(),w=B(()=>{var f;return["admin","super_admin","developer"].includes((f=m==null?void 0:m.value)==null?void 0:f.role)}),a=A(null);O(async()=>{var t,h;m.value||await u.fetchUser(),await l.fetchUserDashboardData(),w.value&&await l.fetchAdminDashboardData();const f=(h=(t=o.value)==null?void 0:t.notices)==null?void 0:h.find($=>!$.user_feedback);f&&(a.value=f)});const _=()=>{if(!a.value)return;const f=a.value.type===1?`/notice-details/${a.value.id}`:`/policy-details/${a.value.id}`;d.push(f)};return(f,t)=>{var $,N;const h=H("RouterLink");return n(),r("div",ce,[w.value&&y(u).isAdminMood?(n(),r("div",me,[v(h,{to:{name:"TodayAttendanceReport",query:{search:"all"}},class:"main-button"},{default:g(()=>{var s;return[e("span",ye,i((s=y(p))==null?void 0:s.totalUsers),1),t[2]||(t[2]=x(" Total Employees "))]}),_:1,__:[2]}),v(h,{to:{name:"TodayAttendanceReport",query:{search:"Present"}},class:"main-button"},{default:g(()=>{var s;return[e("span",pe,i((s=y(p))==null?void 0:s.todayPresents),1),t[3]||(t[3]=x(" Today Present "))]}),_:1,__:[3]}),v(h,{to:{name:"TodayAttendanceReport",query:{search:"Absent"}},class:"main-button"},{default:g(()=>{var s;return[e("span",fe,i((s=y(p))==null?void 0:s.todayAbsents),1),t[4]||(t[4]=x(" Today Absent "))]}),_:1,__:[4]}),v(h,{to:{name:"LeaveApplicationList",query:{search:"today"}},class:"main-button"},{default:g(()=>{var s;return[e("span",xe,i((s=y(p))==null?void 0:s.todayLeaves),1),t[5]||(t[5]=x(" Today Leave "))]}),_:1,__:[5]}),v(h,{to:{name:"LeaveApplicationList",query:{search:"tomorrow"}},class:"main-button"},{default:g(()=>{var s;return[e("span",he,i((s=y(p))==null?void 0:s.tomorrowLeaves),1),t[6]||(t[6]=x(" Tomorrow Leave "))]}),_:1,__:[6]}),v(h,{to:{name:"ShortLeaveList",query:{search:y(c)}},class:"main-button"},{default:g(()=>{var s;return[e("span",_e,i((s=y(p))==null?void 0:s.todayShortLeaves),1),t[7]||(t[7]=x(" Today Short Leaves "))]}),_:1,__:[7]},8,["to"])])):(n(),r("div",ge,[e("div",ve,[e("div",be,[e("div",we,[t[11]||(t[11]=e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Applications")],-1)),(n(!0),r(D,null,T(($=y(o))==null?void 0:$.current_month_leave,s=>(n(),R(h,{to:{name:"MyLeaveApplicationShow",params:{id:s.id}},key:s.id},{default:g(()=>[e("div",ke,[e("h3",De," Leave Application #"+i(s.id),1),e("p",{class:L(["text-sm font-medium flex items-center space-x-2",{"bg-gray-500 py-1.5 rounded-full px-4 text-white":s.status===null,"bg-yellow-500 py-1.5 rounded-full px-4 text-white":s.status==="Pending","bg-green-500 py-1.5 rounded-full px-4 text-white":s.status==="approved"}])},[s.status===null?(n(),r("span",Te,t[8]||(t[8]=[e("i",{class:"fas fa-clock mr-2"},null,-1),x(" Wait for Hanover ")]))):s.status==="Pending"?(n(),r("span",Le,t[9]||(t[9]=[e("i",{class:"fas fa-hourglass-half mr-2"},null,-1),x(" Pending ")]))):(n(),r("span",$e,t[10]||(t[10]=[e("i",{class:"fas fa-check-circle mr-2"},null,-1),x(" Approved ")])))],2)])]),_:2},1032,["to"]))),128))]),t[16]||(t[16]=e("div",{class:"flex justify-between items-start mb-4"},[e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Notices")])],-1)),e("div",Ce,[(n(!0),r(D,null,T(y(o).notices,(s,j)=>(n(),r("div",{key:j,class:"flex items-center justify-between p-4 border rounded-lg shadow-sm hover:shadow transition-all bg-white"},[e("div",Me,[e("div",{class:L([["rounded-full",s.user_feedback?"bg-green-100":"bg-red-100"],"h-8 w-8 flex items-center justify-center rounded-full"])},[e("span",{class:L(["h-3 w-3",s.user_feedback?"bg-green-600":"bg-red-600","rounded-full inline-block"])},null,2),e("div",Se,i(s.user_feedback?"Feedback Submitted":"Feedback Pending"),1)],2),e("div",null,[e("p",Re,i(s.title),1),e("p",Ae,i(s.published_at),1)])]),v(h,{to:s.type===1?`/notice-details/${s.id}`:`/policy-details/${s.id}`,class:"text-blue-600 hover:text-blue-800 font-semibold text-sm"},{default:g(()=>t[12]||(t[12]=[x(" View ")])),_:2,__:[12]},1032,["to"])]))),128)),a.value?(n(),R(U,{key:0,show:!0,onClose:t[1]||(t[1]=s=>a.value=null)},{default:g(()=>[e("div",Ne,[t[13]||(t[13]=e("i",{class:"fas fa-bell text-blue-500"},null,-1)),x(" "+i(a.value.title),1)]),e("div",Pe,[e("p",qe,[t[14]||(t[14]=e("i",{class:"fas fa-calendar-alt text-gray-400"},null,-1)),x(" Published: "+i(a.value.published_at),1)]),t[15]||(t[15]=e("p",{class:"text-base text-gray-700 leading-relaxed"}," You must read this notice before proceeding. ",-1)),e("div",Be,[e("button",{onClick:t[0]||(t[0]=s=>a.value=null),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-5 py-2 rounded-lg transition"}," Cancel "),e("button",{onClick:_,class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2.5 rounded-lg shadow transition"}," Read Details ")])])]),_:1})):k("",!0)])]),e("div",Oe,[t[18]||(t[18]=e("h2",{class:"text-xl font-semibold py-3 px-4"},"Leave Balance",-1)),e("div",je,[e("table",Ue,[t[17]||(t[17]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"Type"),e("th",{scope:"col",class:"px-6 py-3"},"Total Days"),e("th",{scope:"col",class:"px-6 py-3"},"Used Days"),e("th",{scope:"col",class:"px-6 py-3"},"Remaining Days")])],-1)),e("tbody",null,[(n(!0),r(D,null,T((N=y(o))==null?void 0:N.leave_balance,s=>(n(),r("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[e("td",Ve,i(s.leave_type),1),e("td",ze,i(s.annual_quota),1),e("td",Fe,i(s.used_days),1),e("td",Ee,i(s.remaining_days),1)]))),128))])])])])]),e("div",We,[v(ue)])]))])}}};export{tt as default};
