import{u as $,b as F,z as W,r as p,e as H,x as A,A as I,c as _,o as d,a as e,f as x,t as o,k as m,q as j,h as C,y as M,l as z,v as O,F as Q,n as G,p as v,j as J,g as q,i as E}from"./index-D2XudXqW.js";import{L as K}from"./LoaderView-DR-ecsZZ.js";import{_ as X}from"./EmployeeFilter-B01Hl13z.js";import{u as Y}from"./attendance-Z6W3ZJqA.js";import{u as Z}from"./company-OF8UZBhv.js";import{u as ee}from"./department-B5Sb__96.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SelectDropdown-D1VKLKcP.js";import"./UserChip-CuT18WaH.js";const te={class:"px-4 space-y-4"},ae={class:"flex items-center justify-between gap-2"},se={class:"title-md md:title-lg flex-wrap text-center"},oe={class:"flex flex-wrap gap-4"},ne={class:"flex gap-4"},re={key:1,class:"space-y-4"},de={class:"overflow-x-auto card-bg"},ie={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},le={class:"text-center text-xs"},pe={class:"border px-1 py-0.5"},ue={class:"border px-1 py-0.5"},ce={class:"border px-1 py-0.5"},ye={class:"border px-1 py-0.5"},_e={class:"border px-1 py-0.5"},me=["title"],ve=["title"],be=["title"],fe={class:"border px-1 py-0.5"},xe={class:"border px-1 py-0.5"},he={class:"border px-1 py-0.5"},ke={class:"border px-1 py-0.5"},Pe={__name:"TodayAttendanceReport",setup(we){const h=$(),r=F(),L=Z();ee();const u=Y(),{dailyLogs:g}=W(u),V=p(r.query.company_id||""),P=p(r.query.department_id||""),b=p(r.query.employee_id||""),l=p(r.query.date||u.selectedDate||""),i=p(r.query.status||""),T=p(r.query.type||"all"),s=p({company_id:V.value,department_id:P.value,type:T.value,employee_id:b.value}),k=async()=>{const{company_id:n,department_id:a,employee_id:c,type:y}=s.value;(n||i.value)&&await u.getTodayAttendanceReport({companyId:s.value.company_id,departmentId:a,employee_id:c,category:y,month:l.value,status:i.value})},f=()=>{const n={company_id:s.value.company_id,department_id:s.value.department_id,type:s.value.type,employee_id:s.value.employee_id,date:l.value,status:i.value};Object.entries(n).some(([c,y])=>r.query[c]!==String(y))&&h.replace({query:n})},B=()=>{var n;return u.attendanceDownloadExcel(s.value.company_id,(n=b.value)==null?void 0:n.id,s.value.type,l.value,i.value)},N=()=>{var n;return u.attendanceDownloadPdf(s.value.company_id,(n=b.value)==null?void 0:n.id,s.value.type,l.value,i.value)},R=()=>h.go(-1);return H(async()=>{await L.fetchCompanies(),await k()}),A(l,n=>{f()}),A(i,()=>{f()}),(n,a)=>{var y,w,D,S;const c=I("router-link");return d(),_("div",te,[e("div",ae,[e("button",{class:"btn-3",onClick:R},a[6]||(a[6]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),e("h1",se," Daily "+o(((w=(y=m(r))==null?void 0:y.query)==null?void 0:w.status)==="all"?"Attendance":(S=(D=m(r))==null?void 0:D.query)==null?void 0:S.status)+" Report ",1),e("div",{class:"flex gap-4"},[e("button",{type:"button",onClick:B,class:"btn-1"},a[7]||(a[7]=[e("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)])),e("button",{type:"button",onClick:N,class:"btn-1"},a[8]||(a[8]=[e("i",{class:"fal fa-file-pdf text-2xl text-red-500"},null,-1)]))])]),e("div",oe,[j(X,{company_id:s.value.company_id,"onUpdate:company_id":a[0]||(a[0]=t=>s.value.company_id=t),department_id:s.value.department_id,"onUpdate:department_id":a[1]||(a[1]=t=>s.value.department_id=t),employee_id:s.value.employee_id,"onUpdate:employee_id":a[2]||(a[2]=t=>s.value.employee_id=t),category:s.value.category,"onUpdate:category":a[3]||(a[3]=t=>s.value.category=t),"with-type":!0,"initial-value":n.$route.query,onFilterChange:f},null,8,["company_id","department_id","employee_id","category","initial-value"]),e("div",ne,[e("div",null,[C(e("select",{id:"userSelect","onUpdate:modelValue":a[4]||(a[4]=t=>i.value=t),class:"input-1"},a[9]||(a[9]=[z('<option value="all">All Status</option><option value="Present">Present</option><option value="Absent">Absent</option><option value="Weekend">Weekend</option><option value="Holiday">Holiday</option><option value="Leave">Leave</option>',6)]),512),[[M,i.value]])]),e("div",null,[C(e("input",{type:"date","onUpdate:modelValue":a[5]||(a[5]=t=>l.value=t),class:"input-1"},null,512),[[O,l.value]])]),e("button",{type:"button",onClick:k,class:"btn-2"},"Search")])]),m(u).isLoading?(d(),x(K,{key:0})):(d(),_("div",re,[e("div",de,[e("table",ie,[a[12]||(a[12]=e("thead",null,[e("tr",{class:"bg-gray-200 text-xs"},[e("th",{class:"border p-1"},"#"),e("th",{class:"border p-1"},"Emp/Worker Name"),e("th",{class:"border p-1"},"Department"),e("th",{class:"border p-1"},"Date"),e("th",{class:"border p-1"},"Day"),e("th",{class:"border p-1"},"Shift"),e("th",{class:"border p-1"},"Entry Time"),e("th",{class:"border p-1"},"Exit Time"),e("th",{class:"border p-1"},"Working Hours"),e("th",{class:"border p-1"},"Late Entry"),e("th",{class:"border p-1"},"Early Leave"),e("th",{class:"border p-1"},"Status")])],-1)),e("tbody",le,[(d(!0),_(Q,null,G(m(g),(t,U)=>(d(),_("tr",{key:t==null?void 0:t.date,class:"border-b hover:bg-blue-100"},[e("td",pe,o(U+=1),1),e("td",ue,o(t.user_name),1),e("td",ce,o(t.department),1),e("td",ye,o(t.date),1),e("td",_e,o(t.weekday),1),e("td",{class:"border px-1 py-0.5",title:`${t.shift_start_time} to ${t.shift_end_time}`},o(t.shift_name),9,me),e("td",{class:v(["border px-1 py-0.5",{"bg-red-200":t.late_duration}]),title:`Device: ${t.entry_device}`},o(t.entry_time),11,ve),e("td",{class:v(["border px-1 py-0.5",{"bg-red-200":t.early_leave_duration}]),title:`Device: ${t.exit_device}`},o(t.exit_time),11,be),e("td",fe,o(t.working_hours),1),e("td",xe,o(t.late_duration),1),e("td",he,o(t.early_leave_duration),1),e("td",ke,[t.absent_reason?(d(),_("span",{key:0,class:v(["font-medium",{"text-green-600":t.absent_reason.includes("Approved"),"text-orange-500":t.absent_reason.includes("Pending"),"text-gray-600":!t.absent_reason.includes("Approved")&&!t.absent_reason.includes("Pending")}])},[J(o(t.absent_reason)+" ",1),t.application_id?(d(),x(c,{key:0,to:{name:"LeaveApplicationShow",params:{id:t.application_id}}},{default:E(()=>a[10]||(a[10]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[10]},1032,["to"])):q("",!0),t.exchange_application_id?(d(),x(c,{key:1,to:{name:"ExchangeOffdayShow",params:{id:t.exchange_application_id}}},{default:E(()=>a[11]||(a[11]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[11]},1032,["to"])):q("",!0)],2)):(d(),_("span",{key:1,class:v(["font-medium",{"text-red-600":t.status==="Absent","text-blue-600":t.status==="Holiday","text-green-600":t.status==="Present","text-gray-600":t.status==="Weekend"||t.status==="Leave"}])},o(t.status),3))])]))),128))])])])]))])}}};export{Pe as default};
