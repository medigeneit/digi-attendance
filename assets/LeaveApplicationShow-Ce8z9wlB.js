import{_ as v}from"./ApprovalItem-D76deMnb.js";import{L as Ct}from"./LoaderView-W-dPx86d.js";import{_ as Wt}from"./ShareComponent-CFvocBFR.js";import{d as Vt,a3 as Ut,u as $t,b as Mt,r as Dt,p as At,e as Pt,c as n,o as a,a as t,f as Gt,y as c,j as r,t as l,F as m,x as g,g as _,n as Lt,k as Ht}from"./index-U3i6Oj7P.js";import{u as It}from"./leave-application-B30bhcXe.js";import"./AcceptAndRejectHandler-B0NtfQw4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const zt={class:"my-container max-w-3xl space-y-6"},Et={key:1,class:"card-bg p-4 md:p-8 print:text-black"},qt={class:"title-lg text-center"},Jt={class:"text-center text-sm"},Kt={class:"space-y-4"},Ot={class:"grid md:grid-cols-2 print:grid-cols-2 gap-8"},Qt={class:""},Xt={class:"text-sm"},Yt={class:"pt-6"},Zt={key:0},te={key:1,class:"font-semibold"},ee={class:"flex justify-end gap-4"},se={class:"table-auto border border-black bg-white text-xs"},le={class:"border border-black px-2"},oe={class:"border border-black px-2"},ae={class:"border border-black px-2"},re={class:"font-bold"},ne={class:"border border-black px-2"},ie={class:"table-auto border border-black bg-white text-xs"},de={class:"border border-black"},ue={colspan:"2",class:"border border-black px-2 w-32"},pe={class:"border border-black px-2"},ce={class:"border border-black px-2"},be={class:"font-bold"},ve={class:"border border-black px-2"},ye={class:"grid print:grid-cols-2 md:grid-cols-2 text-sm"},me={class:"text-sm"},ge={class:"pt-8 grid grid-cols-2"},_e={class:"text-sm"},xe={class:"font-bold"},fe={class:"text-blue-700 print:text-black"},ke={class:"overflow-x-auto"},he={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},we={class:"border border-gray-500 px-4 py-0.5 text-left"},De={class:"border border-gray-500 px-4 py-0.5 text-center"},Ae={class:"border border-gray-500 px-4 py-0.5 text-center"},Le={class:"space-y-14"},je={class:"font-bold text-center text-lg"},Se={key:0},Te={class:"grid md:grid-cols-3 print:grid-cols-3 gap-4 text-sm items-end"},Be={class:"flex justify-evenly text-sm items-end"},Ne={key:0,class:"mb-2"},Re=["href"],Fe={key:1,class:"text-center text-lg italic text-gray-400"},Ce={key:2},Ie={__name:"LeaveApplicationShow",setup(We){const jt=Vt();Ut();const y=It(),St=$t(),x=Mt(),f=Dt(null),k=Dt(!0),s=At(()=>y.leaveApplication);Pt(async()=>{try{await y.fetchLeaveApplicationById(x.params.id)}catch(i){console.error("Failed to load leave application:",i)}finally{k.value=!1}});function Tt(){window.print()}const b=async()=>{await y.fetchLeaveApplicationById(x.params.id)},Bt=()=>St.go(-1),h=At(()=>{if(!s.value||!s.value.last_working_date||!s.value.resumption_date)return 0;const i=new Date(s==null?void 0:s.value.last_working_date),d=new Date(s==null?void 0:s.value.resumption_date)-i;return Math.ceil(d/(1e3*60*60*24))-1}),Nt=async()=>{try{const i={attachment:f.value};await y.uploadLeaveApplicationAttachment(x.params.id,i)}catch(i){console.error("Failed to reject short leave:",i),alert("Failed to reject short leave.")}},Rt=async i=>{const e=i.target.files[0];if(e){const d=new FormData;d.append("file",e),d.append("folder","leave-application");const p=await y.fetchFileUpload(d);f.value=p==null?void 0:p.url,Nt()}},Ft=i=>{const e=new Date(i),d=e.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),p=e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return`${d} , ${p}`};return(i,e)=>{var d,p,w,D,A,L,j,S,T,B,N,R,F,C,W,V,U,$,M,P,G,H,I,z,E,q,J,K,O,Q,X,Y,Z,tt,et,st,lt,ot,at,rt,nt,it,dt,ut,pt,ct,bt,vt,yt,mt,gt,_t,xt,ft,kt,ht,wt;return a(),n("div",zt,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:Bt},e[0]||(e[0]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[2]||(e[2]=t("h1",{class:"title-md md:title-xl flex-wrap text-center"},"Leave Application",-1)),t("div",null,[t("button",{class:"btn-2",onClick:Tt},e[1]||(e[1]=[t("i",{class:"far fa-print"},null,-1),r(" Print ")]))])]),k.value?(a(),Gt(Ct,{key:0})):(a(),n("div",Et,[t("div",null,[t("h1",qt,l((w=(p=(d=s.value)==null?void 0:d.user)==null?void 0:p.company)==null?void 0:w.name),1),t("p",Jt,l((A=(D=s.value)==null?void 0:D.user)==null?void 0:A.company.address),1)]),t("div",Kt,[t("div",Ot,[t("div",null,[e[5]||(e[5]=t("p",null,"To",-1)),e[6]||(e[6]=t("p",{class:"font-bold"},"Managing Director",-1)),t("p",Qt,l((S=(j=(L=s.value)==null?void 0:L.user)==null?void 0:j.company)==null?void 0:S.name),1),t("p",Xt,l((B=(T=s.value)==null?void 0:T.user)==null?void 0:B.company.address),1),t("div",null,[t("p",Yt,[e[3]||(e[3]=t("b",null,"Subject:",-1)),e[4]||(e[4]=r(" Leave Application for ")),(a(!0),n(m,null,g((N=s.value)==null?void 0:N.leave_types,(o,u)=>(a(),n(m,{key:u},[u&&o.days?(a(),n("span",Zt,",Â ")):_("",!0),o.days?(a(),n("span",te,l(o.type),1)):_("",!0)],64))),128))])])]),t("div",ee,[t("div",null,[e[10]||(e[10]=t("h1",{class:"font-bold"},"Summary",-1)),t("table",se,[e[9]||(e[9]=t("thead",null,[t("tr",{class:"bg-gray-200 border border-black"},[t("th",{class:"border border-black px-2"},"Type"),t("th",{class:"border border-black px-2"},"Days")])],-1)),t("tbody",null,[(a(!0),n(m,null,g((R=s.value)==null?void 0:R.leave_types,(o,u)=>(a(),n("tr",{key:u,class:"border border-black"},[t("td",le,l(o.type),1),t("td",oe,l(o.days),1)]))),128)),t("tr",null,[e[7]||(e[7]=t("td",{class:"border-black px-2"},"WL/GHD",-1)),t("td",ae,l(h.value-((C=(F=s.value)==null?void 0:F.leave_days)==null?void 0:C.length)),1)]),t("tr",re,[e[8]||(e[8]=t("td",{class:"border border-black px-2"},"Total",-1)),t("td",ne,l(h.value),1)])])])]),t("div",null,[e[14]||(e[14]=t("h1",{class:"font-bold"},"Last Leave",-1)),t("div",null,[t("table",ie,[t("thead",null,[e[11]||(e[11]=t("tr",{class:"bg-gray-200 border border-black"},[t("th",{colspan:"2",class:"border border-black px-2"},"Date")],-1)),t("tr",de,[t("td",ue,l(((V=(W=s.value)==null?void 0:W.last_leave)==null?void 0:V.date)||"N/A"),1)]),e[12]||(e[12]=t("tr",{class:"bg-gray-200 border border-black"},[t("th",{class:"border border-black px-2"},"Type"),t("th",{class:"border border-black px-2"},"Days")],-1))]),t("tbody",null,[(a(!0),n(m,null,g(($=(U=s.value)==null?void 0:U.last_leave)==null?void 0:$.types,(o,u)=>(a(),n("tr",{key:u,class:"border border-black"},[t("td",pe,l(o==null?void 0:o.type),1),t("td",ce,l(o==null?void 0:o.days),1)]))),128)),t("tr",be,[e[13]||(e[13]=t("td",{class:"border border-black px-2"},"Total",-1)),t("td",ve,l((P=(M=s.value)==null?void 0:M.last_leave)!=null&&P.types?s.value.last_leave.types.reduce((o,u)=>o+u.days,0):0),1)])])])])])])]),t("div",null,[e[22]||(e[22]=t("h3",{class:"font-bold"},"Leave Details:",-1)),t("div",ye,[t("li",null,[e[15]||(e[15]=t("strong",null,"Reason: ",-1)),r(l(((G=s.value)==null?void 0:G.reason)||"No reason provided"),1)]),t("li",null,[e[16]||(e[16]=t("strong",null,"Leave Days:",-1)),r(" "+l((H=s.value)==null?void 0:H.leave_period),1)]),t("li",null,[e[17]||(e[17]=t("strong",null,"Total Days:",-1)),r(" "+l((I=s.value)==null?void 0:I.total_leave_days),1)]),t("li",null,[e[18]||(e[18]=t("strong",null,"Weekends:",-1)),r(" "+l((J=(q=(E=(z=s.value)==null?void 0:z.user)==null?void 0:E.assign_weekend)==null?void 0:q.weekends)==null?void 0:J.join(", ")),1)]),t("li",null,[e[19]||(e[19]=t("strong",null,"Last Working Date:",-1)),r(" "+l((K=s.value)==null?void 0:K.last_working_date),1)]),t("li",null,[e[20]||(e[20]=t("strong",null,"Resumption Date:",-1)),r(" "+l((O=s.value)==null?void 0:O.resumption_date),1)]),t("li",null,[e[21]||(e[21]=t("strong",null,"Create Date:",-1)),r(" "+l(Ft((Q=s.value)==null?void 0:Q.created_at)),1)])])]),t("div",me,[t("p",null,[e[23]||(e[23]=t("strong",null,"Works in Hand: ",-1)),r(l(((X=s.value)==null?void 0:X.works_in_hand)||"No details provided"),1)])]),t("div",ge,[t("div",null,[t("div",_e,[e[29]||(e[29]=t("hr",{class:"w-44 border-black hidden print:block my-1"},null,-1)),t("p",xe,[e[24]||(e[24]=t("strong",null,"Applicant: ",-1)),t("span",fe,l((Z=(Y=s.value)==null?void 0:Y.user)==null?void 0:Z.name),1)]),t("p",null,[e[25]||(e[25]=t("strong",null,"Designation:",-1)),r(" "+l((st=(et=(tt=s.value)==null?void 0:tt.user)==null?void 0:et.designation)==null?void 0:st.title),1)]),t("p",null,[e[26]||(e[26]=t("strong",null,"Department:",-1)),r(" "+l((at=(ot=(lt=s.value)==null?void 0:lt.user)==null?void 0:ot.department)==null?void 0:at.name),1)]),t("p",null,[e[27]||(e[27]=t("strong",null,"Phone:",-1)),r(" "+l((nt=(rt=s.value)==null?void 0:rt.user)==null?void 0:nt.phone),1)]),t("p",null,[e[28]||(e[28]=t("strong",null,"joining Date:",-1)),r(" "+l((dt=(it=s.value)==null?void 0:it.user)==null?void 0:dt.joining_date),1)])])]),c(v,{application:s.value,type:"leave_applications",item:"handover",onAction:b},null,8,["application"])]),t("div",null,[e[31]||(e[31]=t("h1",{class:"font-bold"},"Leave Balance",-1)),t("div",ke,[t("table",he,[e[30]||(e[30]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border border-gray-500 px-4 py-0.5 text-left"},"Leave Type"),t("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Total Days"),t("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Used Days"),t("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Remaining Days")])],-1)),t("tbody",null,[(a(!0),n(m,null,g((ut=s.value)==null?void 0:ut.leave_balance,(o,u)=>(a(),n("tr",{key:u,class:"hover:bg-blue-200"},[t("td",we,l(o.leave_type),1),t("td",De,l(o==null?void 0:o.total_leave_days),1),t("td",Ae,l(o.used_days),1),t("td",{class:Lt(["border border-gray-500 px-4 py-0.5 text-center",{"text-green-600 font-bold":o.remaining_days>0,"text-red-600 font-bold":o.remaining_days===0}])},l(o.remaining_days),3)]))),128))])])])])]),t("div",Le,[t("p",je,[e[32]||(e[32]=r(" Leave Approval: ")),t("b",{class:Lt({"text-yellow-600":((pt=s.value)==null?void 0:pt.status)==="Pending","text-green-600":((ct=s.value)==null?void 0:ct.status)==="Approved","text-red-600":((bt=s.value)==null?void 0:bt.status)==="Rejected"})},l(((vt=s.value)==null?void 0:vt.status)||"N/A"),3)]),((yt=s.value)==null?void 0:yt.status)==="Rejected"?(a(),n("div",Se,[t("p",null,[e[33]||(e[33]=t("b",null,"Rejected by: ",-1)),r(" "+l((gt=(mt=s.value)==null?void 0:mt.rejected_by_user)==null?void 0:gt.name),1)]),t("p",null,[e[34]||(e[34]=t("b",null,"rejection Reason: ",-1)),r(" "+l(s.value.rejection_reason),1)])])):_("",!0),t("div",Te,[c(v,{application:s.value,type:"leave_applications",item:"in_charge",onAction:b},null,8,["application"]),c(v,{application:s.value,type:"leave_applications",item:"coordinator",onAction:b},null,8,["application"]),c(v,{application:s.value,type:"leave_applications",item:"operational_admin",onAction:b},null,8,["application"])]),t("div",Be,[c(v,{application:s.value,type:"leave_applications",item:"recommend_by",onAction:b},null,8,["application"]),c(v,{application:s.value,type:"leave_applications",item:"approved_by",onAction:b},null,8,["application"])])])])),t("div",null,[e[35]||(e[35]=t("label",null,"Attachment",-1)),(_t=s.value)!=null&&_t.attachment&&typeof((xt=s.value)==null?void 0:xt.attachment)=="string"?(a(),n("div",Ne,[t("a",{href:(ft=s.value)==null?void 0:ft.attachment,target:"_blank",class:"text-blue-500 underline"}," View Current File ",8,Re)])):(a(),n("div",Fe,"No attachment")),((kt=s.value)==null?void 0:kt.user_id)===((wt=(ht=Ht(jt))==null?void 0:ht.user)==null?void 0:wt.id)?(a(),n("div",Ce,[t("input",{type:"file",onChange:Rt,class:"w-full p-2 border rounded"},null,32)])):_("",!0)]),c(Wt)])}}};export{Ie as default};
