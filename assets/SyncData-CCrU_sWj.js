import{D as U,r as b,E as g,b as z,c as p,a as t,d as c,C as _,h as r,F as C,x as S,t as m,e as f,v as y,o as v}from"./index-BiWtekI_.js";import{u as D}from"./device-C5_HhP2N.js";const F=U("sync",()=>{const n=b(!1),l=b(null),u=b(null),o=async d=>{a(),n.value=!0;try{const e=await g.get(`/zk-users/pull/${d}`);l.value=e.data.message}catch(e){i(e)}finally{n.value=!1}},h=async d=>{a(),n.value=!0;try{const e=await g.post(`/zk-users/push/${d}`);l.value=e.data.message}catch(e){i(e)}finally{n.value=!1}},x=async d=>{a(),n.value=!0;try{const e=await g.post(`/zk-fingerprints/pull/${d}`);l.value=e.data.message}catch(e){i(e)}finally{n.value=!1}},w=async d=>{a(),n.value=!0;try{const e=await g.post(`/zk-fingerprints/push/${d}`);l.value=e.data.message}catch(e){i(e)}finally{n.value=!1}},k=async(d,e)=>{a(),n.value=!0;try{const s=await g.post(`/zk-users/create/${d}`,e);l.value=s.data.message}catch(s){i(s)}finally{n.value=!1}},a=()=>{l.value=null,u.value=null},i=d=>{var e,s;u.value=((s=(e=d.response)==null?void 0:e.data)==null?void 0:s.message)||"Something went wrong."};return{loading:n,message:l,error:u,pullUsers:o,pushUsers:h,pullFingerprints:x,pushFingerprints:w,createUser:k,reset:a}}),P={class:"my-container space-y-4"},V={class:"card-bg p-4 md:p-6 space-y-4"},$=["disabled"],N=["value"],B={key:0,class:"text-red-600 text-sm mt-1"},E={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},M=["disabled"],I=["disabled"],A=["disabled"],L=["disabled"],T={key:0,class:"text-blue-600 font-semibold"},j={key:1,class:"text-green-700 font-medium"},q={key:2,class:"text-red-600 font-medium"},G={class:"card-bg p-4 md:p-6 space-y-4"},H={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},J=["disabled"],Q={__name:"SyncData",setup(n){const l=F(),u=D(),o=b("");z(()=>{u.fetchDevices()});const h=()=>{o.value&&l.pullUsers(o.value)},x=()=>{o.value&&l.pushUsers(o.value)},w=()=>{o.value&&l.pullFingerprints(o.value)},k=()=>{o.value&&l.pushFingerprints(o.value)},a=b({zk_uid:"",zk_userid:"",name:"",password:"",role:0,cardno:""}),i=async()=>{o.value&&(await l.createUser(o.value,a.value),l.error.value||(a.value={zk_uid:"",zk_userid:"",name:"",password:"",role:0,cardno:""}))};return(d,e)=>(v(),p("div",P,[e[11]||(e[11]=t("h1",{class:"title-lg"},"🔄 Data Sync",-1)),t("div",V,[t("div",null,[e[8]||(e[8]=t("label",{class:"block text-gray-700 font-medium mb-1"},"Select Device",-1)),c(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.value=s),class:"w-full border rounded px-3 py-2",disabled:r(u).loading},[e[7]||(e[7]=t("option",{disabled:"",value:""},"-- Choose a device --",-1)),(v(!0),p(C,null,S(r(u).devices,s=>(v(),p("option",{key:s.id,value:s.id},m(s.name)+" ("+m(s.ip_address)+") ",9,N))),128))],8,$),[[_,o.value]]),r(u).error?(v(),p("p",B,m(r(u).error),1)):f("",!0)]),t("div",E,[t("button",{class:"bg-blue-600 hover:bg-blue-700 text-white rounded px-4 py-2",onClick:h,disabled:r(l).loading||!o.value}," Pull Users ",8,M),t("button",{class:"bg-green-600 hover:bg-green-700 text-white rounded px-4 py-2",onClick:x,disabled:r(l).loading||!o.value}," Push Users ",8,I),t("button",{class:"bg-purple-600 hover:bg-purple-700 text-white rounded px-4 py-2",onClick:w,disabled:r(l).loading||!o.value}," Pull Fingerprints ",8,A),t("button",{class:"bg-yellow-600 hover:bg-yellow-700 text-white rounded px-4 py-2",onClick:k,disabled:r(l).loading||!o.value}," Push Fingerprints ",8,L)]),r(l).loading?(v(),p("div",T,"Syncing in progress...")):f("",!0),r(l).message?(v(),p("div",j," ✅ "+m(r(l).message),1)):f("",!0),r(l).error?(v(),p("div",q,"❌ "+m(r(l).error),1)):f("",!0)]),t("div",G,[e[10]||(e[10]=t("h2",{class:"text-lg font-semibold"},"👤 Create User on Device",-1)),t("div",H,[c(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>a.value.zk_uid=s),type:"number",placeholder:"UID",class:"border px-3 py-2 rounded w-full"},null,512),[[y,a.value.zk_uid]]),c(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>a.value.zk_userid=s),type:"text",placeholder:"User ID",class:"border px-3 py-2 rounded w-full"},null,512),[[y,a.value.zk_userid]]),c(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>a.value.name=s),type:"text",placeholder:"Name",class:"border px-3 py-2 rounded w-full"},null,512),[[y,a.value.name]]),c(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>a.value.password=s),type:"text",placeholder:"Password (optional)",class:"border px-3 py-2 rounded w-full"},null,512),[[y,a.value.password]]),c(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>a.value.cardno=s),type:"number",placeholder:"Card No (optional)",class:"border px-3 py-2 rounded w-full"},null,512),[[y,a.value.cardno]]),c(t("select",{"onUpdate:modelValue":e[6]||(e[6]=s=>a.value.role=s),class:"border px-3 py-2 rounded w-full"},e[9]||(e[9]=[t("option",{value:0},"User",-1),t("option",{value:14},"Admin",-1)]),512),[[_,a.value.role]])]),t("button",{class:"mt-4 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded",onClick:i,disabled:r(l).loading||!o.value}," ➕ Create User ",8,J)])]))}};export{Q as default};
