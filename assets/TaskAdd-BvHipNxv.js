import{o as c,c as f,s as p,r as _,y as U,A as V,b as A,a as e,w as G,h as l,l as b,t as x,e as k,m as w,d as y,v as C,C as I,f as O,g as h}from"./index-Ds9GWWqv.js";import"./vue-multiselect.esm-BgMkZhIF.js";/* empty css                                                            */import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as P}from"./user-BvxqZGyd.js";import{u as H}from"./useRequirementStore-Cm_zKbUo.js";import{u as $}from"./useTaskStore-BCDi8Vb3.js";const K={},W={class:"font-medium text-red-600 text-sm"};function F(D,r){return c(),f("span",W,"*")}const T=B(K,[["render",F]]),j={class:"container mx-auto p-6"},z={class:"max-w-2xl mx-auto bg-white shadow-lg rounded-lg p-6"},J={key:0,class:"text-center mt-2 mb-6"},Q={class:"text-sky-600"},X={key:1,class:"text-center mt-2 mb-6"},Y={class:"text-sky-600"},Z={class:"mb-4"},tt={class:"block text-gray-600 text-sm mb-1 font-medium"},et={class:"grid grid-cols-2 gap-4 mb-4"},st={class:"block text-gray-600 text-sm mb-1 font-medium"},ot={class:"block text-gray-600 text-sm mb-1 font-medium"},rt={class:"mb-4"},lt={key:2,class:"mb-4 text-red-500 font-medium"},it={class:"flex items-center gap-4"},nt=["disabled"],ft={__name:"TaskAdd",setup(D){const r=$(),q=h(),u=O(),g=H(),L=P(),{requirement:a}=p(g);p(L);const{task:d}=p(r);p(r),p(r);const M=_([]),N=U(()=>M.value.map(o=>o.id)),s=_({title:"",user_ids:[],priority:"MEDIUM",status:"PENDING",description:""});V(N,o=>{s.value.user_ids=o}),A(()=>{var o,t,i,m;g.fetchRequirements(),((o=u.query)==null?void 0:o.parent_id)>0&&r.fetchTask((t=u.query)==null?void 0:t.parent_id),((i=u.query)==null?void 0:i.requirement_id)>0&&g.fetchRequirement((m=u.query)==null?void 0:m.requirement_id)});const v=_(!1),R=async()=>{var t,i;v.value=!0;const o={...s.value,parent_id:((t=d==null?void 0:d.value)==null?void 0:t.id)||0,requirement_id:((i=a==null?void 0:a.value)==null?void 0:i.id)||null};console.log({payload:o}),await r.createTask(o),v.value=!1,r.error||q.push({name:"TaskList"})};return(o,t)=>{var i,m,E,S;return c(),f("div",j,[e("div",z,[t[14]||(t[14]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add New Task",-1)),t[15]||(t[15]=e("hr",{class:"mb-4"},null,-1)),t[16]||(t[16]=e("div",{class:"text-purple-600/60 mb-4 text-xs"}," Fields that must be filled in will be marked with an asterisk. ",-1)),e("form",{onSubmit:G(R,["prevent"])},[(i=l(u).query)!=null&&i.requirement_id&&((m=l(a))!=null&&m.title)?(c(),f("p",J,[t[5]||(t[5]=b(" Task under requirement ")),e("span",Q,x(l(a).title),1)])):k("",!0),(E=l(u).query)!=null&&E.parent_id&&((S=l(d))!=null&&S.title)?(c(),f("p",X,[t[6]||(t[6]=b(" Sub task on ")),e("span",Y,x(l(d).title),1)])):k("",!0),e("div",Z,[e("label",tt,[t[7]||(t[7]=b("Task Title ")),w(T)]),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>s.value.title=n),required:"",placeholder:"Enter task title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[C,s.value.title]])]),e("div",et,[e("div",null,[e("label",st,[t[8]||(t[8]=b("Priority ")),w(T)]),y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=n=>s.value.priority=n),class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},t[9]||(t[9]=[e("option",{value:"LOW"},"LOW",-1),e("option",{value:"MEDIUM"},"MEDIUM",-1),e("option",{value:"HIGH"},"HIGH",-1),e("option",{value:"CRITICAL"},"CRITICAL",-1)]),512),[[I,s.value.priority]])]),e("div",null,[e("label",ot,[t[10]||(t[10]=b("Status ")),w(T)]),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>s.value.status=n),class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},t[11]||(t[11]=[e("option",{value:""},"--select---",-1),e("option",null,"PENDING",-1),e("option",null,"IN_PROGRESS",-1),e("option",null,"COMPLETED",-1),e("option",null,"BLOCKED",-1),e("option",null,"CANCELLED",-1),e("option",null,"BACK_LOG",-1)]),512),[[I,s.value.status]])])]),e("div",rt,[t[12]||(t[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),y(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=n=>s.value.description=n),rows:"4",placeholder:"Enter task description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[C,s.value.description]])]),t[13]||(t[13]=e("hr",{class:"mb-4"},null,-1)),l(r).error?(c(),f("div",lt,x(l(r).error),1)):k("",!0),e("div",it,[e("button",{disabled:v.value,type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},x(v.value?"Saving...":"Save Task"),9,nt),e("button",{type:"button",onClick:t[4]||(t[4]=n=>l(q).push({name:"TaskList"})),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel ")])],32)])])}}};export{ft as default};
