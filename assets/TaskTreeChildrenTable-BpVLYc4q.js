import{c as a,o as s,a as t,j as g,r as D,b as L,x as T,g as r,F as C,y as A,q as $,t as n,n as h,k as i,f as x,w as y}from"./index-CX-quJz4.js";import{d as S,b}from"./datetime-DcVwRp76.js";import{o as M}from"./url-CePbr-gY.js";import{a as j,_ as I}from"./TaskAssignedUsers-BLmQ1l-U.js";import{_ as E,T as N,a as P}from"./TaskUrgentBadge-DiZ8vdd7.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as V}from"./TaskStatus-M-4qqOAD.js";const q={},F={class:"border rounded-full px-2 bg-blue-500/60 text-white flex items-center text-sm"};function R(o,u){return s(),a("div",F,u[0]||(u[0]=[t("i",{class:"fas fa-lock mr-2 text-sm"},null,-1),g("CLOSED ")]))}const U=O(q,[["render",R]]),Q={class:"w-full"},G={key:0,class:"w-full"},H={class:"border-y text-center py-2 px-1 border-gray-200"},J={key:0,class:"text-base font-semibold text-purple-600"},K={class:"border px-3 py-1 border-gray-200 relative"},W={class:"flex items-center justify-between gap-2"},X={class:"flex items-center gap-3"},Y={class:"flex items-center flex-none lg:w-full order-0 lg:order-1"},Z={class:"text-gray-400 text-xs mr-4 whitespace-nowrap"},ee={class:"flex items-center gap-2 text-xs text-gray-500 opacity-80 text-left"},te={class:"text-xs flex items-center gap-1 text-sky-400 ml-2"},se=["href","onClick"],re={class:"border px-3 py-1 border-gray-200"},ae={class:"flex gap-2 justify-between items-center relative w-full"},oe={class:"shrink-0"},le=["href","onClick"],ne={class:"border px-3 py-1 border-gray-200 text-center"},ie={key:0,class:"text-gray-500 text-sm"},de={class:"font-semibold text-blue-800 whitespace-nowrap"},ce={class:"border px-3 py-1 border-gray-200 text-center"},ue={key:0,class:"ml-4 text-gray-500 text-sm"},pe={class:"text-blue-500 font-semibold whitespace-nowrap"},xe={class:"border px-3 py-1 border-gray-200 text-center"},ye={key:0,class:"text-gray-500 text-sm whitespace-nowrap"},ge={class:"font-semibold text-blue-800"},fe={class:"border-y px-3 border-gray-200 sticky right-0 border-l bg-sky-50"},me={class:"flex justify-end flex-wrap gap-2 py-2"},he={class:"flex gap-1 items-center text-sm"},be={key:1,class:"text-red-800 italic"},_e=["href"],De={__name:"TaskTreeChildrenTable",props:{childrenTasks:{type:Array,required:!0,default:()=>[]},parentTask:{type:Object},hideButtons:{type:Boolean,default:!1},parentTreeLevel:{type:Number},maxItem:{Number,default:5},isMyTask:{type:Boolean,default:!1},taskLinkTo:{type:Function,default:null}},emits:["editClick","addClick","employeeAssignClick"],setup(o,{emit:u}){const c=o,d=D(!1),_=L(),B=T(()=>d.value?c.childrenTasks:c.childrenTasks.slice(0,c.maxItem)),p=T(()=>d.value?[]:c.childrenTasks.slice(c.maxItem));function z(){d.value=!d.value}const f=u;return(we,l)=>{var w;return s(),a("div",Q,[((w=o.childrenTasks)==null?void 0:w.length)>0?(s(),a("table",G,[l[5]||(l[5]=t("thead",null,[t("tr",null,[t("td",{class:"border-y text-center text-xs text-gray-400 bg-gray-50/80 w-[30px] sticky -top-4 z-20"}," SL "),t("td",{class:"border text-center text-xs text-gray-400 bg-gray-50/80 sticky -top-4 z-20 px-2 whitespace-nowrap"}," Task "),t("td",{class:"border text-center text-xs text-gray-400 bg-gray-50/80 sticky -top-4 z-20 px-2 whitespace-nowrap"}," Assign Person "),t("td",{class:"border text-center text-xs text-gray-400 bg-gray-50/80 sticky -top-4 z-20 px-2 whitespace-nowrap"}," Assign Date "),t("td",{class:"border text-center text-xs text-gray-400 bg-gray-50/80 sticky -top-4 z-20 px-2 whitespace-nowrap"}," Deadline "),t("td",{class:"border text-center text-xs text-gray-400 bg-gray-50/80 sticky -top-4 z-20 px-2 whitespace-nowrap"}," Started "),t("td",{class:"border-y text-center text-xs text-gray-400 bg-gray-50/80 -top-4 z-20 sticky right-0 border-l bg-sky-50 px-2 whitespace-nowrap"}," Status ")])],-1)),t("tbody",null,[(s(!0),a(C,null,A(B.value,(e,k)=>{var v;return s(),a("tr",{key:e.id,class:$(["group/sub-task-row",{" bg-green-400/20":e.status=="COMPLETED"," bg-white hover:bg-slate-50":e.status!=="COMPLETED"}])},[t("td",H,[k!==void 0?(s(),a("div",J,n(k+1)+". ",1)):r("",!0)]),t("td",K,[t("div",W,[t("div",null,[t("div",X,[h(E,{titleClass:"text-sm",task:e,"sub-tasks-open":!1,isMyTask:o.isMyTask,to:o.taskLinkTo},null,8,["task","isMyTask","to"])]),t("div",Y,[t("div",Z,[l[1]||(l[1]=t("i",{class:"fas fa-clock"},null,-1)),g(" "+n(i(S)(e.created_at)),1)]),t("div",ee,[e!=null&&e.is_important?(s(),x(N,{key:0})):r("",!0),e!=null&&e.is_urgent?(s(),x(P,{key:1})):r("",!0)]),t("div",te,[l[2]||(l[2]=t("i",{class:"fas fa-tasks"},null,-1)),g(" "+n(e==null?void 0:e.todos_count),1)])])]),!e.is_closed&&!o.hideButtons?(s(),a("a",{key:0,href:`/tasks/edit/${e.id}`,onClick:y(m=>f("editClick",e.id),["stop","prevent"]),class:"btn-3 py-1.5 px-1.5 !border-0 size-7 text-sm opacity-40 group-hover/sub-task-row:opacity-100 duration-100"},l[3]||(l[3]=[t("i",{class:"fas fa-edit"},null,-1)]),8,se)):r("",!0)])]),t("td",re,[t("div",ae,[h(j,{class:"flex items-center justify-center gap-x-3 gap-y-2",users:e.users||[],isTargetTask:e.is_target,maxItem:1,"route-to":m=>`/tasks?status=not-completed&view=userwise&user-ids=${m.id}`},null,8,["users","isTargetTask","route-to"]),t("div",oe,[!e.is_closed&&!o.hideButtons?(s(),a("a",{key:0,href:`/tasks/${e.id}/assign-users`,onClick:y(m=>f("employeeAssignClick",e.id),["stop","prevent"]),class:"btn-3 py-1.5 px-1.5 !border-0 size-7 text-sm opacity-40 group-hover/sub-task-row:opacity-100 duration-100 flex-shrink-0"},l[4]||(l[4]=[t("i",{class:"fas fa-users-cog"},null,-1)]),8,le)):r("",!0)])])]),t("td",ne,[e.assigned_at?(s(),a("span",ie,[t("span",de,n(i(b)(e.assigned_at)),1)])):r("",!0)]),t("td",ce,[e.deadline?(s(),a("span",ue,[t("span",pe,n(i(b)(e.deadline)),1)])):r("",!0)]),t("td",xe,[e.started_at?(s(),a("span",ye,[t("span",ge,n(i(b)(e.started_at)),1)])):r("",!0)]),t("td",fe,[t("div",me,[e.closed_at?(s(),x(U,{key:0})):r("",!0),h(V,{status:e==null?void 0:e.status,progressPercent:(e==null?void 0:e.progress_percent)||0,class:"w-full"},null,8,["status","progressPercent"]),((v=e==null?void 0:e.children_tasks)==null?void 0:v.length)>0?(s(),x(I,{key:1,ref_for:!0,ref:"progress",task:e,class:"text-sm w-full"},null,8,["task"])):r("",!0)])])],2)}),128))])])):r("",!0),t("div",he,[o.childrenTasks.length>0?(s(),a(C,{key:0},[p.value.length>0||d.value?(s(),a("button",{key:0,class:"hover:bg-blue-600 hover:text-white text-indigo-600 font-semibold px-3 py-0.5 rounded-full transition border ml-2 mt-2",onClick:y(z,["prevent","stop"])},n(d.value?"Show Less":"Show All"),1)):r("",!0),p.value.length>0?(s(),a("span",be,n(p.value.length)+" More sub task"+n(p.value.length>1?"s":""),1)):r("",!0)],64)):r("",!0),o.parentTask.level<2&&!o.hideButtons?(s(),a("a",{key:1,href:`/tasks/add?parent_id=${o.parentTask.id}&back-to=${encodeURIComponent(i(_).path+"?"+i(M)(i(_).query)).toLowerCase()}`,class:$(["hover:bg-blue-600 hover:text-white text-indigo-600 font-semibold px-3 py-0.5 rounded-full transition border border-indigo-300 mt-2",{"ml-2":o.childrenTasks.length===0,"ml-3":o.childrenTasks.length>0}]),onClick:l[0]||(l[0]=y(e=>f("addClick",o.parentTask.id),["stop","prevent"]))},l[6]||(l[6]=[t("i",{class:"fas fa-plus"},null,-1),g(" Add Sub Task ")]),10,_e)):r("",!0)])])}}};export{U as T,De as _};
