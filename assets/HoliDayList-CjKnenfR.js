import{C as U,r as m,D as g,K as q,z as A,b as S,o as f,c as v,a as e,t as h,w as B,d as _,v as $,B as M,F,q as E,e as I,i as N,l as k,h as D}from"./index-DlEd1BlV.js";import{u as L}from"./company-CEGwwXA2.js";import{_ as j,a as T}from"./HeaderWithButtons-DBlAGRw0.js";import{L as z}from"./LoaderView-U-TKEv4z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O=U("holiday",()=>{const c=m([]),r=m(null),o=m(!1),n=m(null);async function p(d={}){var i,l;o.value=!0,n.value=null;try{const t=await g.get("/holidays",{params:d});c.value=t.data}catch(t){n.value=((l=(i=t.response)==null?void 0:i.data)==null?void 0:l.message)||"Failed to fetch holidays"}finally{o.value=!1}}async function a(d){var i,l;o.value=!0,n.value=null;try{const t=await g.get(`/holidays/${d}`);r.value=t.data}catch(t){n.value=((l=(i=t.response)==null?void 0:i.data)==null?void 0:l.message)||`Failed to fetch holiday with ID ${d}`}finally{o.value=!1}}async function x(d){var i,l;o.value=!0,n.value=null;try{const t=await g.post("/holidays",d);c.value.push(t.data.data)}catch(t){n.value=((l=(i=t.response)==null?void 0:i.data)==null?void 0:l.message)||"Failed to create holiday"}finally{o.value=!1}}async function b(d,i){var l,t;o.value=!0,n.value=null;try{const s=await g.put(`/holidays/${d}`,i),u=c.value.findIndex(H=>H.id===d);u!==-1&&(c.value[u]=s.data.data)}catch(s){n.value=((t=(l=s.response)==null?void 0:l.data)==null?void 0:t.message)||`Failed to update holiday with ID ${d}`}finally{o.value=!1}}async function w(d){var i,l;o.value=!0,n.value=null;try{await g.delete(`/holidays/${d}`),c.value=c.value.filter(t=>t.id!==d)}catch(t){n.value=((l=(i=t.response)==null?void 0:i.data)==null?void 0:l.message)||`Failed to delete holiday with ID ${d}`}finally{o.value=!1}}return{holidays:c,holiday:r,loading:o,error:n,fetchHolidays:p,fetchHolidayById:a,createHoliday:x,updateHoliday:b,deleteHoliday:w}}),Y={key:0,class:"modal-bg"},G={class:"modal-card"},K={class:"text-lg font-semibold"},J={class:""},P={class:""},Q={class:""},R={class:""},W={class:""},X={class:""},Z=["value"],ee={class:""},te={class:"flex justify-end"},ae={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},se={__name:"HolidayModal",props:{show:{type:Boolean,required:!0},holiday:{type:Object,default:null}},emits:["close","save"],setup(c,{emit:r}){const o=c,n=r,p=m(!1),a=q({id:null,year:new Date().getFullYear(),name:"",start_date:"",end_date:"",type:"government",description:"",company_id:null}),x=L(),b=m([]),w=()=>{p.value=!1,a.id=null,a.year=new Date().getFullYear(),a.name="",a.start_date="",a.end_date="",a.type="government",a.description="",a.company_id=null};A(()=>o.holiday,l=>{l?(p.value=!0,Object.assign(a,l)):w()},{immediate:!0,deep:!0});const d=()=>{n("save",{...a}),i()},i=()=>{n("close")};return S(async()=>{await x.fetchCompanies(),b.value=[{id:null,name:"All"},...x.companies]}),(l,t)=>c.show?(f(),v("div",Y,[e("div",G,[e("h2",K,h(p.value?"Edit Holiday":"Add Holiday"),1),e("form",{onSubmit:B(d,["prevent"]),class:"space-y-2"},[e("div",J,[t[7]||(t[7]=e("label",{for:"year",class:"block text-sm font-medium"},"Year",-1)),_(e("input",{id:"year","onUpdate:modelValue":t[0]||(t[0]=s=>a.year=s),type:"number",class:"w-full border rounded px-3 py-2",placeholder:"Enter year",required:""},null,512),[[$,a.year]])]),e("div",P,[t[8]||(t[8]=e("label",{for:"name",class:"block text-sm font-medium"},"Name",-1)),_(e("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=s=>a.name=s),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter holiday name",required:""},null,512),[[$,a.name]])]),e("div",Q,[t[9]||(t[9]=e("label",{for:"start_date",class:"block text-sm font-medium"},"Start Date",-1)),_(e("input",{id:"start_date","onUpdate:modelValue":t[2]||(t[2]=s=>a.start_date=s),type:"date",class:"w-full border rounded px-3 py-2",required:""},null,512),[[$,a.start_date]])]),e("div",R,[t[10]||(t[10]=e("label",{for:"end_date",class:"block text-sm font-medium"},"End Date",-1)),_(e("input",{id:"end_date","onUpdate:modelValue":t[3]||(t[3]=s=>a.end_date=s),type:"date",class:"w-full border rounded px-3 py-2",required:""},null,512),[[$,a.end_date]])]),e("div",W,[t[12]||(t[12]=e("label",{for:"type",class:"block text-sm font-medium"},"Type",-1)),_(e("select",{id:"type","onUpdate:modelValue":t[4]||(t[4]=s=>a.type=s),class:"w-full border rounded px-3 py-2",required:""},t[11]||(t[11]=[e("option",{value:"government"},"Government",-1),e("option",{value:"special"},"Special",-1),e("option",{value:"organizational"},"Organizational",-1)]),512),[[M,a.type]])]),e("div",X,[t[13]||(t[13]=e("label",{for:"company_id",class:"block text-sm font-medium"},"Company",-1)),_(e("select",{id:"company_id","onUpdate:modelValue":t[5]||(t[5]=s=>a.company_id=s),class:"w-full border rounded px-3 py-2"},[(f(!0),v(F,null,E(b.value,s=>(f(),v("option",{key:s.id,value:s.id},h(s.name),9,Z))),128))],512),[[M,a.company_id]])]),e("div",ee,[t[14]||(t[14]=e("label",{for:"description",class:"block text-sm font-medium"},"Description",-1)),_(e("textarea",{id:"description","onUpdate:modelValue":t[6]||(t[6]=s=>a.description=s),class:"w-full border rounded px-3 py-2",placeholder:"Enter holiday description (optional)"},null,512),[[$,a.description]])]),e("div",te,[e("button",{type:"button",onClick:i,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2"}," Cancel "),e("button",ae,h(p.value?"Update":"Create"),1)])],32)])])):I("",!0)}},le={class:"my-container space-y-2"},oe={class:"overflow-x-auto"},ne={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},de={class:"text-gray-600 text-sm"},ie={key:0},re={colspan:"5"},ue={class:"py-3 px-2 text-left"},ce={class:"font-medium"},pe={class:"py-3 px-2 text-left"},ye={class:"font-medium"},me={class:"py-3 px-2 text-center"},fe={class:"font-medium"},ve={class:"py-3 px-2 text-center"},he={class:"font-medium"},_e={class:"py-3 px-2 text-center"},xe={class:"font-medium"},be={class:"py-3 px-2 text-center"},we={class:"flex item-center justify-center gap-4"},ge=["onClick"],$e=["onClick"],He={key:2},Fe={__name:"HoliDayList",setup(c){const r=O(),o=N(),n=m(!1),p=m(!1),a=m(null),x=()=>{a.value=null,n.value=!0},b=s=>{a.value=s,n.value=!0},w=()=>{n.value=!1},d=async s=>{try{s.id?(await r.updateHoliday(s.id,s),o.success("Holiday updated successfully!")):(await r.createHoliday(s),o.success("Holiday added successfully!")),await r.fetchHolidays()}catch(u){o.error("Failed to save holiday!"),console.error("Error handling save:",u)}},i=s=>{a.value=s,p.value=!0},l=()=>{p.value=!1},t=async()=>{if(!a.value||!a.value.id){o.error("Invalid holiday selected for deletion!");return}try{await r.deleteHoliday(a.value.id),o.warning("Holiday deleted successfully!"),await r.fetchHolidays()}catch(s){o.error("Failed to delete holiday!"),console.error("Error deleting holiday:",s)}finally{l()}};return S(async()=>{await r.fetchHolidays()}),(s,u)=>{var H;return f(),v("div",le,[k(T,{title:"Holiday List",onAdd:x}),e("div",oe,[e("table",ne,[u[3]||(u[3]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"Name"),e("th",{class:"py-3 px-2 text-left"},"Company"),e("th",{class:"py-3 px-2 text-center"},"Start Date"),e("th",{class:"py-3 px-2 text-center"},"End Date"),e("th",{class:"py-3 px-2 text-center"},"Type"),e("th",{class:"py-3 px-2 text-center"},"Action")])],-1)),e("tbody",de,[D(r).loading?(f(),v("tr",ie,[e("td",re,[k(z)])])):D(r).holidays&&D(r).holidays.length?(f(!0),v(F,{key:1},E(D(r).holidays,y=>{var C;return f(),v("tr",{key:y.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",ue,[e("p",ce,h(y.name),1)]),e("td",pe,[e("p",ye,h(((C=y==null?void 0:y.company)==null?void 0:C.name)||"All"),1)]),e("td",me,[e("p",fe,h(y.start_date),1)]),e("td",ve,[e("p",he,h(y.end_date),1)]),e("td",_e,[e("p",xe,h(y.type),1)]),e("td",be,[e("div",we,[e("button",{onClick:V=>b(y),class:"text-blue-600 hover:text-blue-800"},u[0]||(u[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ge),e("button",{onClick:V=>i(y),class:"text-red-600 hover:text-red-800"},u[1]||(u[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,$e)])])])}),128)):(f(),v("tr",He,u[2]||(u[2]=[e("td",{colspan:"5",class:"text-center text-red-500 py-4"},"No holidays found",-1)])))])])]),k(se,{show:n.value,holiday:a.value,onClose:w,onSave:d},null,8,["show","holiday"]),k(j,{show:p.value,title:"Delete Holiday",message:`Are you sure you want to delete ${(H=a.value)==null?void 0:H.name}?`,onClose:l,onConfirm:t},null,8,["show","message"])])}}};export{Fe as default};
