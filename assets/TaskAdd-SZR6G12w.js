import{o as u,c as d,s as m,r as f,y as T,A as E,b as A,a as t,w as P,l as n,m as i,d as p,v as S,C as y,F as V,x as O,h as a,t as v,e as U,g as G}from"./index-DiHxzIzU.js";import{_ as C}from"./MultiselectDropdown-DVMp0TYA.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as H}from"./user-BLwoYrLR.js";import{u as $}from"./useRequirementStore-BjaAlGNP.js";import{u as F}from"./useTaskStore-C6EcEzqN.js";import"./vue-multiselect.esm-Dl7luT5j.js";const K={},W={class:"font-medium text-red-600 text-sm"};function h(I,r){return u(),d("span",W,"*")}const c=B(K,[["render",h]]),j={class:"container mx-auto p-6"},z={class:"max-w-2xl mx-auto bg-white shadow-lg rounded-lg p-6"},J={class:"mb-4"},Q={class:"block text-gray-600 text-sm mb-1 font-medium"},X={class:"mb-4"},Y=["value"],Z={class:"mb-4"},ee={class:"mb-4"},te={class:"block text-gray-600 text-sm mb-1 font-medium"},se={class:"grid grid-cols-2 gap-4 mb-4"},oe={class:"block text-gray-600 text-sm mb-1 font-medium"},le={class:"block text-gray-600 text-sm mb-1 font-medium"},re={class:"mb-4"},ne={key:0,class:"mb-4 text-red-500 font-medium"},ie={class:"flex items-center gap-4"},ae=["disabled"],ce={__name:"TaskAdd",setup(I){const r=F(),k=G(),_=$(),w=H(),{requirements:N}=m(_),{users:q}=m(w);m(r),m(r);const{flattenedTasks:L}=m(r),x=f([]),R=T(()=>x.value.map(l=>l.id)),g=f(""),D=T(()=>{var l;return(l=g.value)==null?void 0:l.id}),o=f({title:"",requirement_id:null,parent_id:"0",user_ids:[],priority:"MEDIUM",status:"PENDING",description:""});E(D,async l=>{o.value.requirement_id=l,l&&await r.fetchTasks({requirement_id:l})}),E(R,l=>{o.value.user_ids=l}),A(()=>{_.fetchRequirements(),w.fetchUsers()});const b=f(!1),M=async()=>{b.value=!0;const l={...o.value};await r.createTask(l),b.value=!1,r.error||k.push({name:"TaskList"})};return(l,e)=>(u(),d("div",j,[t("div",z,[e[19]||(e[19]=t("h2",{class:"text-2xl font-semibold text-gray-800"},"Add New Task",-1)),e[20]||(e[20]=t("hr",{class:"mb-4"},null,-1)),e[21]||(e[21]=t("div",{class:"text-purple-600/60 mb-4 text-xs"}," Fields that must be filled in will be marked with an asterisk. ",-1)),t("form",{onSubmit:P(M,["prevent"])},[t("div",J,[t("label",Q,[e[8]||(e[8]=n("Task Title ")),i(c)]),p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.title=s),required:"",placeholder:"Enter task title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,o.value.title]])]),t("div",X,[e[10]||(e[10]=t("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Parent Task: ",-1)),p(t("select",{id:"parent-task",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":e[1]||(e[1]=s=>o.value.parent_id=s)},[e[9]||(e[9]=t("option",{value:"0",class:"font-medium text-sm text-red-200"},"--- NO PARENT---",-1)),(u(!0),d(V,null,O(a(L),s=>(u(),d("option",{key:s.idPath,value:s.id,class:"text-sm"},[s.depth>0?(u(),d(V,{key:0},[n(v("   ".repeat(s.depth))+" ↳ ",1)],64)):U("",!0),n(" "+v(s.title),1)],8,Y))),128))],512),[[y,o.value.parent_id]])]),t("div",Z,[e[11]||(e[11]=t("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Requirement ",-1)),i(C,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=s=>g.value=s),options:a(N),multiple:!1,"track-by":"id",label:"title",placeholder:"Select department"},null,8,["modelValue","options"])]),t("div",ee,[t("label",te,[e[12]||(e[12]=n("User ")),i(c)]),i(C,{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=s=>x.value=s),options:a(q),multiple:!0,"track-by":"id",label:"name",placeholder:"Select users"},null,8,["modelValue","options"])]),t("div",se,[t("div",null,[t("label",oe,[e[13]||(e[13]=n("Priority ")),i(c)]),p(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.priority=s),class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},e[14]||(e[14]=[t("option",{value:"LOW"},"LOW",-1),t("option",{value:"MEDIUM"},"MEDIUM",-1),t("option",{value:"HIGH"},"HIGH",-1),t("option",{value:"CRITICAL"},"CRITICAL",-1)]),512),[[y,o.value.priority]])]),t("div",null,[t("label",le,[e[15]||(e[15]=n("Status ")),i(c)]),p(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.status=s),class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},e[16]||(e[16]=[t("option",null,"PENDING",-1),t("option",null,"IN_PROGRESS",-1),t("option",null,"COMPLETED",-1),t("option",null,"BLOCKED",-1),t("option",null,"CANCELLED",-1),t("option",null,"BACK_LOG",-1)]),512),[[y,o.value.status]])])]),t("div",re,[e[17]||(e[17]=t("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),p(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.description=s),rows:"4",placeholder:"Enter task description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[S,o.value.description]])]),e[18]||(e[18]=t("hr",{class:"mb-4"},null,-1)),a(r).error?(u(),d("div",ne,v(a(r).error),1)):U("",!0),t("div",ie,[t("button",{disabled:b.value,type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},v(b.value?"Saving...":"Save Task"),9,ae),t("button",{type:"button",onClick:e[7]||(e[7]=s=>a(k).push({name:"TaskList"})),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel ")])],32)])]))}};export{ce as default};
