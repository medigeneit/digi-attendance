import{u as yt,r as c,x as ot,b as bt,c as a,a as t,k as o,j as gt,t as n,e as r,p as ft,h as k,l as kt,d as rt,v as ut,F as xt,f as ht,o as l,g as At}from"./index-Dw-AN0sg.js";import{L as wt}from"./LoaderView-C67zHB74.js";import{_ as Ct}from"./ShareComponent-kYpCrz9H.js";import{u as jt}from"./manual-attendance-CsGG_NfB.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Mt={class:"my-container max-w-3xl space-y-6"},Bt={key:1,class:"card-bg p-4 md:p-8"},Rt={class:"grid md:grid-cols-2"},Nt={key:0},Dt={key:1},St={key:2},$t={key:3},Ft={class:"pt-10"},Vt={class:"font-medium"},Lt={class:"text-sm"},It={class:"title-md"},Tt={key:0},qt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Et={class:"pt-10"},Wt={key:0},Gt={key:1},Pt={key:2,class:"print:hidden"},Ut={class:"text-xs text-blue-600"},zt={class:"flex gap-4"},Ot={class:"font-bold"},Ht={key:0,class:"text-green-600"},Jt={key:1,class:"pl-2 text-yellow-700"},Kt={class:"text-xs text-gray-500"},Qt={class:"pt-10"},Xt={key:0},Yt={key:1},Zt={key:2,class:"print:hidden"},es={class:"text-xs text-blue-600"},ts={class:"flex gap-4"},ss={class:"font-bold"},ls={key:0,class:"text-green-600"},as={key:1,class:"pl-2 text-yellow-700"},ns={class:"text-xs text-gray-500"},os={class:"flex flex-col pt-10"},rs={key:0},us={key:1},ds={key:2,class:"print:hidden"},is={class:"text-xs text-blue-600"},ps={class:"flex gap-4"},cs={class:"font-bold"},vs={key:0,class:"text-green-600"},_s={key:1,class:"pl-2 text-yellow-700"},ms={class:"text-xs text-gray-500"},ys={key:0,class:"modal-bg"},bs={class:"modal-card"},gs={class:"flex justify-end gap-2 mt-4"},fs={key:1,class:"modal-bg"},ks={class:"modal-card"},xs={class:"flex justify-end gap-2 mt-4"},Bs={__name:"ManualAttendanceShow",setup(hs){const dt=At(),v=ht(),d=jt(),b=yt(),_=c(!1),p=c(""),m=c(!1),y=c(""),it=ot(()=>d.loading),s=ot(()=>d.manualAttendance);bt(async()=>{const{id:u}=v.params;try{await d.fetchManualAttendanceById(u)}catch(e){console.error("Failed to fetch manual attendance details:",e)}});let x=c("");function g(u){x.value=u,_.value=!0}async function pt(){vt(x.value),_.value=!1}const ct=async()=>{try{await d.rejectManualAttendance(v.params.id,y.value),alert("Manual attendance rejected successfully!"),m.value=!1,y.value="",await d.fetchManualAttendanceById(v.params.id)}catch(u){console.error("Failed to reject manual attendance:",u),alert("Failed to reject manual attendance.")}},f=()=>{m.value=!0},vt=async u=>{try{const{id:e}=v.params;u==="inCharge"&&await d.inChargeAccept({id:e,note:p.value}),u==="recommend"&&await d.recommendByAccept({id:e,note:p.value}),u==="approve"&&await d.approvedByAccept({id:e,note:p.value}),confirm("Are you sure you want to approve?")&&await d.fetchManualAttendanceById(e)}catch(e){console.error(`Failed to accept ${u}:`,e),alert(`Failed to accept ${u}.`)}},_t=()=>dt.go(-1);function mt(){window.print()}return(u,e)=>{var h,A,w,C,j,M,B,R,N,D,S,$,F,V,L,I,T,q,E,W,G,P,U,z,O,H,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ue,de,ie,pe,ce,ve,_e,me,ye,be,ge,fe,ke,xe,he,Ae,we,Ce,je,Me,Be,Re,Ne,De,Se,$e,Fe,Ve,Le,Ie,Te,qe,Ee,We,Ge,Pe,Ue,ze,Oe,He,Je,Ke,Qe,Xe,Ye,Ze,et,tt,st,lt,at,nt;return l(),a(xt,null,[t("div",Mt,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:_t},e[7]||(e[7]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[9]||(e[9]=t("h1",{class:"title-lg text-center"},"Manual Attendance Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:mt},e[8]||(e[8]=[t("i",{class:"far fa-print"},null,-1),o(" Print ")]))])]),it.value?(l(),gt(wt,{key:0})):(l(),a("div",Bt,[e[36]||(e[36]=t("h2",{class:"title-md"},"Manual Attendance Request",-1)),t("div",null,[t("div",Rt,[(h=s.value)!=null&&h.check_in?(l(),a("div",Nt,[e[10]||(e[10]=t("b",null,"Date:",-1)),o(" "+n(new Date((A=s.value)==null?void 0:A.check_in).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})),1)])):r("",!0),(w=s.value)!=null&&w.check_out?(l(),a("div",Dt,[e[11]||(e[11]=t("b",null,"Date:",-1)),o(" "+n(new Date((C=s.value)==null?void 0:C.check_out).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})),1)])):r("",!0),(j=s.value)!=null&&j.check_in?(l(),a("div",St,[e[12]||(e[12]=t("b",null,"Check-In:",-1)),o(" "+n((M=s.value)!=null&&M.check_in?new Date(s.value.check_in).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"),1)])):r("",!0),(B=s.value)!=null&&B.check_out?(l(),a("div",$t,[e[13]||(e[13]=t("b",null,"Check-Out:",-1)),o(" "+n((R=s.value)!=null&&R.check_out?new Date(s.value.check_out).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"),1)])):r("",!0),t("div",null,[e[14]||(e[14]=t("b",null,"Type:",-1)),o(" "+n((N=s.value)==null?void 0:N.type),1)]),t("div",null,[e[15]||(e[15]=t("b",null,"Reason:",-1)),o(" "+n(((D=s.value)==null?void 0:D.description)||"N/A"),1)])]),t("div",Ft,[t("div",null,[e[16]||(e[16]=t("hr",{class:"w-44 border-black"},null,-1)),e[17]||(e[17]=t("div",null,[t("b",null,"Applicant")],-1)),t("p",Vt,n((S=s.value)==null?void 0:S.user.name),1),t("div",Lt,[t("p",null,n((V=(F=($=s.value)==null?void 0:$.user)==null?void 0:F.department)==null?void 0:V.name),1),t("p",null,n((T=(I=(L=s.value)==null?void 0:L.user)==null?void 0:I.designation)==null?void 0:T.title),1)])])])]),e[37]||(e[37]=t("hr",null,null,-1)),t("div",null,[t("h3",It,[e[18]||(e[18]=o(" Approvals ")),t("span",{class:ft({"text-yellow-500":((q=s.value)==null?void 0:q.status)==="Pending","text-green-500":((E=s.value)==null?void 0:E.status)==="Approved","text-red-500":((W=s.value)==null?void 0:W.status)==="Rejected"})}," ("+n(((G=s.value)==null?void 0:G.status)||"N/A")+") ",3)]),((P=s.value)==null?void 0:P.status)==="Rejected"?(l(),a("div",Tt,[t("div",null,[e[19]||(e[19]=t("b",null,"Rejected By:",-1)),o(" "+n(((z=(U=s.value)==null?void 0:U.rejected_by_user)==null?void 0:z.name)||"N/A"),1)]),t("div",null,[e[20]||(e[20]=t("b",null,"Rejection Reason:",-1)),o(" "+n(((O=s.value)==null?void 0:O.rejection_reason)||"N/A"),1)])])):r("",!0)]),t("div",qt,[t("div",Et,[(H=s.value)!=null&&H.in_charge_user?(l(),a("p",Wt,n(((K=(J=s.value)==null?void 0:J.in_charge_user)==null?void 0:K.name)||""),1)):(l(),a("p",Gt,n(((Z=(Y=(X=(Q=s.value)==null?void 0:Q.user)==null?void 0:X.other_approval)==null?void 0:Y.in_charge_user)==null?void 0:Z.name)||"N/A"),1)),((ee=s.value)==null?void 0:ee.status)!=="Rejected"&&((te=s.value)==null?void 0:te.status)!=="Approved"&&!((se=s.value)!=null&&se.in_charge_user_id)&&((ne=(ae=(le=s.value)==null?void 0:le.user)==null?void 0:ae.other_approval)==null?void 0:ne.in_charge_user_id)===((re=(oe=k(b))==null?void 0:oe.user)==null?void 0:re.id)?(l(),a("div",Pt,[t("p",Ut,[o(n((de=(ue=s.value)==null?void 0:ue.user)==null?void 0:de.name)+' has submitted an "attendance request". ',1),e[21]||(e[21]=t("br",null,null,-1)),e[22]||(e[22]=o(" Will you forward it? "))]),t("div",zt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[0]||(e[0]=i=>g("inCharge"))}," ✔ "),t("button",{class:"",onClick:f},"❌")])])):r("",!0),e[25]||(e[25]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Ot,[e[24]||(e[24]=o(" In-Charge ")),(ie=s.value)!=null&&ie.in_charge_user_id?(l(),a("span",Ht,"(✔)")):r("",!0),(ve=(ce=(pe=s.value)==null?void 0:pe.user)==null?void 0:ce.other_approval)!=null&&ve.in_charge_user&&!((_e=s.value)!=null&&_e.in_charge_user_id)?(l(),a("span",Jt,e[23]||(e[23]=[t("i",{class:"fad fa-spinner"},null,-1)]))):r("",!0)]),t("p",Kt,n((me=s.value)==null?void 0:me.in_charge_note),1)]),t("div",Qt,[(ye=s.value)!=null&&ye.recommend_by_user?(l(),a("p",Xt,n(((ge=(be=s.value)==null?void 0:be.recommend_by_user)==null?void 0:ge.name)||""),1)):(l(),a("p",Yt,n(((he=(xe=(ke=(fe=s.value)==null?void 0:fe.user)==null?void 0:ke.other_approval)==null?void 0:xe.recommend_by_user)==null?void 0:he.name)||"N/A"),1)),((Ae=s.value)==null?void 0:Ae.status)!=="Rejected"&&((we=s.value)==null?void 0:we.status)!=="Approved"&&!((Ce=s.value)!=null&&Ce.recommend_by_user_id)&&((Be=(Me=(je=s.value)==null?void 0:je.user)==null?void 0:Me.other_approval)==null?void 0:Be.recommend_by_user_id)===((Re=k(b).user)==null?void 0:Re.id)?(l(),a("div",Zt,[t("p",es,[o(n((De=(Ne=s.value)==null?void 0:Ne.user)==null?void 0:De.name)+' has submitted an "attendance request".',1),e[26]||(e[26]=t("br",null,null,-1)),e[27]||(e[27]=o(" Will you recommend it? "))]),t("div",ts,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=i=>g("recommend"))}," ✔ "),t("button",{class:"",onClick:f},"❌")])])):r("",!0),e[30]||(e[30]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",ss,[e[29]||(e[29]=o(" Recommend By ")),(Se=s.value)!=null&&Se.recommend_by_user_id?(l(),a("span",ls,"(✔)")):r("",!0),(Ve=(Fe=($e=s.value)==null?void 0:$e.user)==null?void 0:Fe.other_approval)!=null&&Ve.recommend_by_user&&!((Le=s.value)!=null&&Le.recommend_by_user_id)?(l(),a("span",as,e[28]||(e[28]=[t("i",{class:"fad fa-spinner"},null,-1)]))):r("",!0)]),t("p",ns,n((Ie=s.value)==null?void 0:Ie.recommend_note),1)])]),t("div",os,[(Te=s.value)!=null&&Te.approved_by_user?(l(),a("p",rs,n(((Ee=(qe=s.value)==null?void 0:qe.approved_by_user)==null?void 0:Ee.name)||""),1)):(l(),a("p",us,n(((Ue=(Pe=(Ge=(We=s.value)==null?void 0:We.user)==null?void 0:Ge.other_approval)==null?void 0:Pe.approved_by_user)==null?void 0:Ue.name)||"N/A"),1)),((ze=s.value)==null?void 0:ze.status)!=="Rejected"&&((Oe=s.value)==null?void 0:Oe.status)!=="Approved"&&!((He=s.value)!=null&&He.approved_by_user_id)&&((Qe=(Ke=(Je=s.value)==null?void 0:Je.user)==null?void 0:Ke.other_approval)==null?void 0:Qe.approved_by_user_id)===((Xe=k(b).user)==null?void 0:Xe.id)?(l(),a("div",ds,[t("p",is,[o(n((Ze=(Ye=s.value)==null?void 0:Ye.user)==null?void 0:Ze.name)+' has submitted an "attendance request".',1),e[31]||(e[31]=t("br",null,null,-1)),e[32]||(e[32]=o(" Will you accept it? "))]),t("div",ps,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=i=>g("approve"))}," ✔ "),t("button",{class:"",onClick:f},"❌")])])):r("",!0),e[35]||(e[35]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",cs,[e[34]||(e[34]=o(" Approved By ")),(et=s.value)!=null&&et.approved_by_user_id?(l(),a("span",vs,"(✔)")):r("",!0),(lt=(st=(tt=s.value)==null?void 0:tt.user)==null?void 0:st.other_approval)!=null&&lt.approved_by_user&&!((at=s.value)!=null&&at.approved_by_user_id)?(l(),a("span",_s,e[33]||(e[33]=[t("i",{class:"fad fa-spinner"},null,-1)]))):r("",!0)]),t("p",ms,n((nt=s.value)==null?void 0:nt.approval_note),1)])])),kt(Ct)]),_.value?(l(),a("div",ys,[t("div",bs,[e[38]||(e[38]=t("h3",{class:"title-lg"},"Accept Application",-1)),rt(t("input",{"onUpdate:modelValue":e[3]||(e[3]=i=>p.value=i),rows:"4",placeholder:"Enter accept note...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[ut,p.value]]),t("div",gs,[t("button",{class:"btn-3",onClick:e[4]||(e[4]=i=>_.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:pt},"Confirm")])])])):r("",!0),m.value?(l(),a("div",fs,[t("div",ks,[e[39]||(e[39]=t("h3",{class:"title-lg"},"Reject Manual Attendance",-1)),rt(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=i=>y.value=i),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[ut,y.value]]),t("div",xs,[t("button",{class:"btn-3",onClick:e[6]||(e[6]=i=>m.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:ct},"Confirm")])])])):r("",!0)],64)}}};export{Bs as default};
