import{r as f,e as U,A as E,c as b,o as d,a as e,h as V,j as q,p as i,v as R,i as y,f as T,g,k as _,B as F,w as h,F as I,t as C,u as O}from"./index-CWlaYKhI.js";import{_ as $}from"./CompanyDepartmentSelectInput-qAjMcVFQ.js";import{R as S}from"./RequiredIcon-BUq5EPcf.js";import{a as j}from"./requirement-BLBrtKHa.js";import{u as z}from"./company-BoLFcuSy.js";import{u as L}from"./tags-CeLiEyeB.js";import{L as P}from"./LoaderView-CaqKSY05.js";import{S as D}from"./SelectDropdown-Bdno624x.js";import{T as W}from"./TextWithHr-DdL_awMz.js";import{u as G}from"./user-CCDi-5oD.js";import{_ as H}from"./TextEditor-C4fkw2Eq.js";import{_ as N}from"./UserChip-Dv7sx8yG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function J(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){const n=Math.random()*16|0;return(c==="x"?n:n&3|8).toString(16)})}const K={class:"border-2 border-gray-800 px-2 pb-2 pt-8 text-gray-800 print:text-black text-base whitespace-nowrap"},Q={class:"mb-4"},X={class:"block text-gray-600 text-sm mb-1 font-medium"},Y={class:""},Z={class:"border-2 border-gray-800 text-gray-800 print:text-black text-base px-3 whitespace-nowrap print:whitespace-normal print:p-0"},ee={class:"mb-4"},te={class:"mb-4"},se={__name:"RequirementFormDetailItem",props:{fromDepartmentId:{type:[Number,String],required:!0},serial:{type:Number,required:!0},uuid:{type:String,required:!0}},emits:["update","removeClick"],setup(c,{emit:n}){const u=c,m=n,l=G(),o=f({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:""});return U(async()=>{await l.fetchTypeWiseEmployees({type:"academy_body,doctor,executive"})}),E(()=>({...o.value}),p=>{m("update",{...p,uuid:u.uuid})}),(p,t)=>(d(),b("tr",null,[e("td",K,[e("div",Q,[e("label",X,[t[5]||(t[5]=q(" Title ")),i(S)]),V(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>o.value.title=r),required:"",placeholder:"Ender Requirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[R,o.value.title]])]),e("div",Y,[t[6]||(t[6]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),i(H,{modelValue:o.value.description,"onUpdate:modelValue":t[1]||(t[1]=r=>o.value.description=r),class:"w-full"},null,8,["modelValue"])]),t[7]||(t[7]=e("div",{class:"flex items-center justify-between h-full"},null,-1))]),e("td",Z,[e("div",ee,[t[8]||(t[8]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),V(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=r=>o.value.better_to_complete_on=r),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[R,o.value.better_to_complete_on]])]),e("div",te,[t[9]||(t[9]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor ",-1)),i(D,{modelValue:o.value.supervisor_id,"onUpdate:modelValue":t[3]||(t[3]=r=>o.value.supervisor_id=r),options:_(l).users,placeholder:"--NO SUPERVISOR--",class:"h-10 w-full",clearable:""},{option:y(({option:r})=>[i(N,{user:r||{},class:"w-full overflow-hidden border relative"},null,8,["user"])]),"selected-option":y(({option:r})=>[r?(d(),T(N,{key:0,user:r||{}},null,8,["user"])):g("",!0)]),_:1},8,["modelValue","options"])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),V(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 h-10","onUpdate:modelValue":t[4]||(t[4]=r=>o.value.priority=r)},t[10]||(t[10]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[F,o.value.priority]])])])]))}},oe={class:"w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},re={class:"sticky top-0 pt-4 bg-white z-10"},le={class:"block text-gray-600 text-sm mb-1 font-medium"},ae={class:"block text-gray-600 text-sm mb-1 font-medium"},ie={class:"mb-4 col-span-4"},ne={class:"col-span-full"},ue={class:"mb-4 mt-5"},de={class:"w-full table-auto print:table-fixed mt-8"},me={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},pe={key:0,class:"mb-4 text-red-500 font-medium"},be={key:1,class:"mb-4"},ce={class:"flex items-center justify-between gap-4"},xe=["disabled"],ve={__name:"RequirementAddForm",emits:["create","cancelClick","error"],setup(c,{emit:n}){const u=n,m=L(),l=z(),o=f(""),p=f(""),t=f({from_department_id:"",to_department_id:"",website_tags:[]}),r=f({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:""});U(async()=>{o.value="loading",m.fetchTags("website"),await l.fetchCompanies({with:"departments",ignore_permission:!0}),await l.fetchMyCompanies({with:"departments"}),o.value="",B()});async function M(){var s,x,v,a;o.value="submitting";const w={...t.value,...r.value};try{const k=await j(w);u("create",k),o.value="create"}catch(k){u("error",(x=(s=k.response)==null?void 0:s.data)==null?void 0:x.message),p.value=(a=(v=k.response)==null?void 0:v.data)==null?void 0:a.message,o.value="error"}}function A(w){r.value=w}function B(){t.value.details=[...t.value.details,{uuid:J(),title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:""}]}return(w,s)=>{var x,v;return d(),b("div",oe,[e("div",re,[s[6]||(s[6]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add New Requirement",-1)),s[7]||(s[7]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:s[0]||(s[0]=h(a=>u("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:h(M,["prevent"]),class:"z-0 grid grid-cols-8 gap-4"},[o.value!=="loading"&&o.value!=="submitting"?(d(),b(I,{key:0},[i($,{modelValue:t.value.from_department_id,"onUpdate:modelValue":s[1]||(s[1]=a=>t.value.from_department_id=a),companies:((x=_(l))==null?void 0:x.myCompanies)||[],class:"mb-4 col-span-2",className:{select:"h-10"}},{label:y(()=>[e("label",le,[s[8]||(s[8]=q(" From ")),i(S)])]),_:1},8,["modelValue","companies"]),i($,{modelValue:t.value.to_department_id,"onUpdate:modelValue":s[2]||(s[2]=a=>t.value.to_department_id=a),companies:((v=_(l))==null?void 0:v.companies)||[],class:"mb-4 col-span-2",className:{select:"h-10"}},{label:y(()=>[e("label",ae,[s[9]||(s[9]=q(" To ")),i(S)])]),_:1},8,["modelValue","companies"]),e("div",ie,[s[10]||(s[10]=e("label",{class:"text-gray-800 text-sm"},"Websites",-1)),i(D,{options:_(m).tags,modelValue:t.value.website_tags,"onUpdate:modelValue":s[3]||(s[3]=a=>t.value.website_tags=a),taggable:"",label:"name",value:"name"},null,8,["options","modelValue"])])],64)):g("",!0),e("div",ne,[e("div",ue,[i(W,{class:"mb-5"},{default:y(()=>s[11]||(s[11]=[e("h3",{class:"font-semibold text-xl text-gray-800 mx-2"},"Requirement details",-1)])),_:1,__:[11]}),e("table",de,[s[12]||(s[12]=e("thead",null,[e("tr",null,[e("th",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap w-[65%]"}," Requirement "),e("th",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base px-3 font-semibold whitespace-nowrap print:whitespace-normal print:p-0 w-[15%]"}," Options ")])],-1)),e("tbody",null,[i(se,{serial:1,uuid:r.value.uuid,"from-department-id":t.value.from_department_id,onUpdate:s[4]||(s[4]=a=>A(a))},null,8,["uuid","from-department-id"])])])]),e("div",me,[p.value?(d(),b("div",pe,C(p.value),1)):g("",!0),p.value?(d(),b("hr",be)):g("",!0),e("div",ce,[e("button",{type:"button",onClick:s[5]||(s[5]=h(a=>u("cancelClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:o.value=="loading"||o.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},C(o.value=="submitting"?"Saving...":"Save"),9,xe)])])])],32),o.value==="loading"||o.value==="submitting"?(d(),T(P,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):g("",!0)])}}},fe={class:"container mx-auto p-6"},Ue={__name:"RequirementAdd",setup(c){const n=O();function u(m){var o;const l=((o=m.data)==null?void 0:o.requirement)||null;l&&n.push({name:"RequirementShow",params:{id:l.id}})}return(m,l)=>(d(),b("div",fe,[i(ve,{onCreate:u,onCancelClick:l[0]||(l[0]=o=>_(n).back())})]))}};export{Ue as default};
