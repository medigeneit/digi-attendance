import{O as G}from"./OverlyModal-Dc_EuzGh.js";import{r as I,m as z,e as Y,n as J,c as d,o as a,p as N,a as e,F as O,q as A,t as m,g as B,f as U,s as P,x as w,i as k,k as _,R as K,w as V,y as Q,h as X,v as Z,j as b,d as tt,z as E,u as et,A as st}from"./index-B_8aCD-G.js";import{o as j}from"./datetime-DWeuW3kx.js";import{u as nt}from"./useTaskStore-7wvgtNcO.js";import{_ as at}from"./TaskTreeView-DTSoL31y.js";import{u as ot}from"./user-JWDUtDya.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./url-CePbr-gY.js";import"./UserChip-DHN_m03l.js";const lt={class:"grid grid-cols-7 *:text-center *:p-2 *:border-r *:border-b *:text-blue-800 *:text-sm"},rt={class:"flex flex-col"},it={class:"p-2 border-r border-t"},dt={__name:"CalenderView",props:{month:{type:String,required:!0,validator:D=>/^\d{4}-(0[1-9]|1[0-2])$/.test(D)}},emits:["change"],setup(D,{emit:M}){const o=D,h=M,C=I(),g=I(),v=I(),p=I(),R=["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];function x(t,i,c,y){const f=[];for(let T=c-1;T>=0;T--){const S=y-T,$=new Date(t,i-1,S);f.push({date:$,day:$.getDate(),month:$.getMonth()+1,year:$.getFullYear(),isCurrentMonth:!1})}return f}function q(t,i,c){const y=[];for(let f=1;f<=c;f++){const S={date:new Date(t,i,f),day:f,month:i+1,year:t,isCurrentMonth:!0};y.push(S)}return y}function u(t,i,c){const y=[...t],f=Math.ceil(y.length/7)*7,T=1;for(let S=0;y.length<f;S++){const $=new Date(i,c+1,T+S);y.push({date:$,day:$.getDate(),month:$.getMonth()+1,year:$.getFullYear(),isCurrentMonth:!1})}return y}function s(t,i){const c=new Date(t,i,1),f=new Date(t,i+1,0).getDate(),S=(c.getDay()+1)%7,H=new Date(t,i,0).getDate();let L=[];L=[...x(t,i,S,H)];const F=q(t,i,f);return v.value=F[0],p.value=F[F.length-1],L=[...L,...F],L=[...u(L,t,i)],C.value=L[0],g.value=L[L.length-1],L}const n=z(()=>{const[t,i]=o.month.split("-"),c=parseInt(t),y=parseInt(i)-1;return s(c,y)}),r=z(()=>{const t=n.value,i=[];for(let c=0;c<t.length;c+=7)i.push(t.slice(c,c+7));return i});function l(){h("change",{gridStartDate:C.value,gridEndDate:g.value,startOfMonth:v.value,endOfMonth:p.value})}return Y(()=>l()),J(()=>o.month,l),(t,i)=>(a(),d("div",null,[N(t.$slots,"calender-top"),e("div",lt,[(a(),d(O,null,A(R,c=>e("div",{key:c},m(c),1)),64))]),e("div",rt,[(a(!0),d(O,null,A(r.value,(c,y)=>(a(),d("div",{class:"week grid grid-cols-7 min-h-28",key:y},[(a(!0),d(O,null,A(c,(f,T)=>N(t.$slots,"date",{key:T,day:f.day,month:f.month,year:f.year,weekday:(f.date.getDay()+1)%7,isCurrentMonth:f.isCurrentMonth},()=>[e("div",it,m(f.getDate()),1)])),128))]))),128))]),N(t.$slots,"calender-bottom")]))}},ut={key:0},ct={key:0,class:"fad fa-folder text-xs mr-2"},mt={key:1,class:"fad fa-file-alt text-xs mr-2"},pt={key:2,class:"text-center w-full mt-4 text-xs text-gray-600"},W={__name:"TaskListOnDay",props:{isCurrentMonth:{type:Boolean,default:!1},tasks:{type:Array,default:()=>[]},limit:{type:Number,default:null},tree:{type:Boolean,default:!1}},emits:["clickOnMore"],setup(D,{emit:M}){const o=D,h=M,C=z(()=>{var g;return o.limit?((g=o==null?void 0:o.tasks)==null?void 0:g.slice(0,o.limit))||[]:[...o.tasks]});return(g,v)=>(a(),d("div",null,[D.tree?(a(),d("div",ut,[(a(!0),d(O,null,A(C.value,p=>(a(),U(at,{task:p,key:p.id,class:"mb-6"},null,8,["task"]))),128))])):(a(),d("ul",{key:1,class:P({"text-gray-500 group-hover:text-gray-900":!D.isCurrentMonth})},[(a(!0),d(O,null,A(C.value,p=>(a(),d("li",{class:"mb-2",key:p.id},[w(_(K),{to:`/tasks/${p.id}`,target:"_blank",class:"flex items-center hover:underline hover:text-blue-600"},{default:k(()=>[p.children_task_count>0?(a(),d("i",ct)):B("",!0),p.children_task_count==0?(a(),d("i",mt)):B("",!0),e("span",{class:P(["line-clamp-1",{"text-red-800":p.deadline_crossed}])},m(p.title),3)]),_:2},1032,["to"])]))),128))],2)),D.tasks.length-C.value.length>0?(a(),d("div",pt,[e("button",{onClick:v[0]||(v[0]=V(p=>h("clickOnMore",p),["prevent"])),class:"text-blue-600 hover:underline"}," +"+m(D.tasks.length-C.value.length)+" More Tasks ",1)])):B("",!0)]))}},yt={class:"relative"},ft={class:"px-4 py-2 flex items-center bg-gray-50 group"},ht={class:"ml-auto"},gt=["onClick"],xt={key:0,class:"absolute inset-0 bg-white bg-opacity-90"},bt={class:"absolute inset-16 bg-white border border-blue-500 rounded-md z-20 overflow-y-auto"},vt={class:"text-lg font-semibold mb-4 sticky top-0 border-b border-blue-200 px-4 z-30 py-3 bg-white flex items-center"},_t={__name:"TaskInMonth",setup(D){const M=I("2025-08"),o=Q({day:null,month:null,year:null}),h=nt();function C(u){u.stopPropagation(),o.day=null,o.month=null,o.year=null}function g(u,s,n,r){u.stopPropagation(),o.day=s,o.month=n,o.year=r}async function v({gridStartDate:u,gridEndDate:s,startOfMonth:n,endOfMonth:r}){await h.fetchMyTasks()}const p=(u,s,n)=>{const r=new Date;return u===r.getDate()&&s===r.getMonth()+1&&n===r.getFullYear()},R=(u,s,n)=>u===o.day&&s===o.month&&n===o.year,x=(u,s,n,r)=>{const l=p(u,s,n);return{"bg-green-100 text-green-900 border-blue-500 border-2 scale-105 z-10":l,"border-r border-t hover:border border-blue-200  hover:scale-105 hover:z-20 hover:bg-blue-50":!l,"bg-gray-50":!r}},q=(u,s,n)=>{const r=new Date(n,s-1,u);return h==null?void 0:h.tasks.filter(l=>{const t=l.deadline?new Date(l.deadline):null,i=j(new Date);if(l.assigned_at||l.created_at){let c=j(new Date(l.assigned_at));!c&&l.created_at&&(c=j(new Date(l.created_at)));let y=null;return console.log(`#${u}-${l.id}`,{assignDate:c,selectedDate:r}),!(r<c||(l.completed_at&&(y=j(new Date(l.completed_at))),y&&y<r)||(console.log(`#${u}-${l.id}`,{assignDate:c,deadline:t,selectedDate:r,todayDate:i}),t&&t<r&&r>i))}return!1}).map(l=>{let t=!1;return l.deadline&&(t=new Date(l.deadline)<r),{...l,deadline_crossed:t}})};return(u,s)=>(a(),d("div",yt,[e("div",ft,[s[1]||(s[1]=e("h2",{class:"leading-none font-semibold text-lg"},"Task List",-1)),X(e("input",{type:"month","onUpdate:modelValue":s[0]||(s[0]=n=>M.value=n),class:"ml-auto border px-2 rounded"},null,512),[[Z,M.value]])]),w(dt,{month:M.value,class:"border-t border-blue-200/50 relative",onChange:v},{date:k(({day:n,month:r,year:l,isCurrentMonth:t})=>[e("div",{tabindex:"0",class:P(["transition origin-center p-2 outline-blue-600 outline-1 cursor-pointer",x(n,r,l,t)])},[e("div",{class:P(["font-bold w-full flex items-center",{"text-gray-300":!t}])},[e("div",null,m(n),1),e("div",ht,[R(n,r,l)?B("",!0):(a(),d("button",{key:0,class:"btn-icon",onClick:V(i=>g(i,n,r,l),["prevent"])},s[2]||(s[2]=[e("i",{class:"fas fa-expand-arrows text-gray-400 hover:text-gray-600"},null,-1)]),8,gt))])],2),w(W,{"is-current-month":t,tasks:q(n,r,l),limit:3,class:"text-xs mt-4",onClickOnMore:i=>g(i,n,r,l)},null,8,["is-current-month","tasks","onClickOnMore"])],2)]),"calender-bottom":k(()=>[o.day?(a(),d("div",xt,[e("div",bt,[e("div",vt,[b(" Tasks for "+m(o.day)+"/"+m(o.month)+"/"+m(o.year)+" ",1),e("button",{class:"ml-auto",type:"button",onClick:V(C,["prevent"])},s[3]||(s[3]=[e("i",{class:"fas fa-times"},null,-1)]))]),w(W,{class:"p-4","is-current-month":u.isCurrentMonth,tasks:q(o.day,o.month,o.year),tree:!0},null,8,["is-current-month","tasks"])])])):B("",!0)]),_:1},8,["month"])]))}},kt={class:"container px-6 mx-auto"},wt={key:0,class:"grid gap-4 md:grid-cols-3 mt-4"},Dt={class:"text-3xl"},Mt={class:"text-3xl"},Ct={class:"text-3xl"},$t={class:"text-3xl"},Tt={class:"text-3xl"},Lt={class:"text-3xl"},St={key:1,class:"w-full mt-4"},Ot={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},At={class:"bg-white shadow-md rounded-lg p-4"},Pt={class:"space-y-2"},Rt={class:"flex justify-between items-center px-4 py-2 rounded hover:bg-gray-50 transition-colors"},qt={class:"font-semibold text-gray-800"},It={key:0},Bt={key:1},Ft={key:2},jt={class:"space-y-3"},zt={class:"flex items-center space-x-4"},Nt={class:"absolute top-10 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition pointer-events-none z-10 whitespace-nowrap"},Ut={class:"text-sm font-medium text-gray-900"},Vt={class:"text-xs text-gray-500 mt-0.5"},Et={class:"text-xl font-bold text-gray-800 flex items-center gap-2 p-4"},Wt={class:"space-y-5 px-4 md:px-6 py-4"},Yt={class:"text-sm text-gray-500 flex items-center gap-2"},Ht={class:"flex justify-end gap-3 mt-6"},Gt={class:"bg-white shadow-md rounded-lg"},Jt={class:"overflow-x-auto shadow-md sm:rounded-lg min-h-max"},Kt={class:"min-w-full text-sm text-left text-gray-500"},Qt={class:"px-6 py-4 font-medium text-gray-900"},Xt={class:"px-6 py-4"},Zt={class:"px-6 py-4"},te={class:"px-6 py-4"},ee={class:"card-bg mt-4 gap-0 shadow-md border border-gray-300"},pe={__name:"DashBoard",setup(D){const M=tt(),o=ot(),{dashboardInfo:h,selectedDate:C,userDashboard:g}=E(o),{user:v}=E(M),p=et(),R=z(()=>{var u;return["admin","super_admin","developer"].includes((u=v==null?void 0:v.value)==null?void 0:u.role)}),x=I(null);Y(async()=>{var s,n;v.value||await M.fetchUser(),await o.fetchUserDashboardData(),R.value&&await o.fetchAdminDashboardData();const u=(n=(s=g.value)==null?void 0:s.notices)==null?void 0:n.find(r=>!r.user_feedback);u&&(x.value=u)});const q=()=>{if(!x.value)return;const u=x.value.type===1?`/notice-details/${x.value.id}`:`/policy-details/${x.value.id}`;p.push(u)};return(u,s)=>{var r,l;const n=st("RouterLink");return a(),d("div",kt,[R.value&&_(M).isAdminMood?(a(),d("div",wt,[w(n,{to:{name:"TodayAttendanceReport",query:{search:"all"}},class:"main-button"},{default:k(()=>{var t;return[e("span",Dt,m((t=_(h))==null?void 0:t.totalUsers),1),s[2]||(s[2]=b(" Total Employees "))]}),_:1,__:[2]}),w(n,{to:{name:"TodayAttendanceReport",query:{search:"Present"}},class:"main-button"},{default:k(()=>{var t;return[e("span",Mt,m((t=_(h))==null?void 0:t.todayPresents),1),s[3]||(s[3]=b(" Today Present "))]}),_:1,__:[3]}),w(n,{to:{name:"TodayAttendanceReport",query:{search:"Absent"}},class:"main-button"},{default:k(()=>{var t;return[e("span",Ct,m((t=_(h))==null?void 0:t.todayAbsents),1),s[4]||(s[4]=b(" Today Absent "))]}),_:1,__:[4]}),w(n,{to:{name:"LeaveApplicationList",query:{search:"today"}},class:"main-button"},{default:k(()=>{var t;return[e("span",$t,m((t=_(h))==null?void 0:t.todayLeaves),1),s[5]||(s[5]=b(" Today Leave "))]}),_:1,__:[5]}),w(n,{to:{name:"LeaveApplicationList",query:{search:"tomorrow"}},class:"main-button"},{default:k(()=>{var t;return[e("span",Tt,m((t=_(h))==null?void 0:t.tomorrowLeaves),1),s[6]||(s[6]=b(" Tomorrow Leave "))]}),_:1,__:[6]}),w(n,{to:{name:"ShortLeaveList",query:{search:_(C)}},class:"main-button"},{default:k(()=>{var t;return[e("span",Lt,m((t=_(h))==null?void 0:t.todayShortLeaves),1),s[7]||(s[7]=b(" Today Short Leaves "))]}),_:1,__:[7]},8,["to"])])):(a(),d("div",St,[e("div",Ot,[e("div",At,[e("div",Pt,[s[11]||(s[11]=e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Applications")],-1)),(a(!0),d(O,null,A((r=_(g))==null?void 0:r.current_month_leave,t=>(a(),U(n,{to:{name:"MyLeaveApplicationShow",params:{id:t.id}},key:t.id},{default:k(()=>[e("div",Rt,[e("h3",qt," Leave Application #"+m(t.id),1),e("p",{class:P(["text-sm font-medium flex items-center space-x-2",{"bg-gray-500 py-1.5 rounded-full px-4 text-white":t.status===null,"bg-yellow-500 py-1.5 rounded-full px-4 text-white":t.status==="Pending","bg-green-500 py-1.5 rounded-full px-4 text-white":t.status==="approved"}])},[t.status===null?(a(),d("span",It,s[8]||(s[8]=[e("i",{class:"fas fa-clock mr-2"},null,-1),b(" Wait for Hanover ")]))):t.status==="Pending"?(a(),d("span",Bt,s[9]||(s[9]=[e("i",{class:"fas fa-hourglass-half mr-2"},null,-1),b(" Pending ")]))):(a(),d("span",Ft,s[10]||(s[10]=[e("i",{class:"fas fa-check-circle mr-2"},null,-1),b(" Approved ")])))],2)])]),_:2},1032,["to"]))),128))]),s[16]||(s[16]=e("div",{class:"flex justify-between items-start mb-4"},[e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Notices")])],-1)),e("div",jt,[(a(!0),d(O,null,A(_(g).notices,(t,i)=>(a(),d("div",{key:i,class:"flex items-center justify-between p-4 border rounded-lg shadow-sm hover:shadow transition-all bg-white"},[e("div",zt,[e("div",{class:P([["rounded-full",t.user_feedback?"bg-green-100":"bg-red-100"],"h-8 w-8 flex items-center justify-center rounded-full"])},[e("span",{class:P(["h-3 w-3",t.user_feedback?"bg-green-600":"bg-red-600","rounded-full inline-block"])},null,2),e("div",Nt,m(t.user_feedback?"Feedback Submitted":"Feedback Pending"),1)],2),e("div",null,[e("p",Ut,m(t.title),1),e("p",Vt,m(t.published_at),1)])]),w(n,{to:t.type===1?`/notice-details/${t.id}`:`/policy-details/${t.id}`,class:"text-blue-600 hover:text-blue-800 font-semibold text-sm"},{default:k(()=>s[12]||(s[12]=[b(" View ")])),_:2,__:[12]},1032,["to"])]))),128)),x.value?(a(),U(G,{key:0,show:!0,onClose:s[1]||(s[1]=t=>x.value=null)},{default:k(()=>[e("div",Et,[s[13]||(s[13]=e("i",{class:"fas fa-bell text-blue-500"},null,-1)),b(" "+m(x.value.title),1)]),e("div",Wt,[e("p",Yt,[s[14]||(s[14]=e("i",{class:"fas fa-calendar-alt text-gray-400"},null,-1)),b(" Published: "+m(x.value.published_at),1)]),s[15]||(s[15]=e("p",{class:"text-base text-gray-700 leading-relaxed"}," You must read this notice before proceeding. ",-1)),e("div",Ht,[e("button",{onClick:s[0]||(s[0]=t=>x.value=null),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-5 py-2 rounded-lg transition"}," Cancel "),e("button",{onClick:q,class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2.5 rounded-lg shadow transition"}," Read Details ")])])]),_:1})):B("",!0)])]),e("div",Gt,[s[18]||(s[18]=e("h2",{class:"text-xl font-semibold py-3 px-4"},"Leave Balance",-1)),e("div",Jt,[e("table",Kt,[s[17]||(s[17]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"Type"),e("th",{scope:"col",class:"px-6 py-3"},"Total Days"),e("th",{scope:"col",class:"px-6 py-3"},"Used Days"),e("th",{scope:"col",class:"px-6 py-3"},"Remaining Days")])],-1)),e("tbody",null,[(a(!0),d(O,null,A((l=_(g))==null?void 0:l.leave_balance,t=>(a(),d("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[e("td",Qt,m(t.leave_type),1),e("td",Xt,m(t.annual_quota),1),e("td",Zt,m(t.used_days),1),e("td",te,m(t.remaining_days),1)]))),128))])])])])]),e("div",ee,[w(_t)])]))])}}};export{pe as default};
