import{o as c,c as f,s as p,r as x,y as R,A as G,b as O,a as t,w as B,h as r,l as b,t as y,e as w,m as g,d as k,v as U,C as D,f as P,g as h}from"./index-BiWtekI_.js";import{_ as H}from"./MultiselectDropdown-55U-iMex.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as K}from"./user-DqG5MXCw.js";import{u as W}from"./useRequirementStore-Ctjsh5Yr.js";import{u as F}from"./useTaskStore-D7mMq-TD.js";import"./vue-multiselect.esm-CLEKtjYB.js";const j={},z={class:"font-medium text-red-600 text-sm"};function J(L,i){return c(),f("span",z,"*")}const T=$(j,[["render",J]]),Q={class:"container mx-auto p-6"},X={class:"max-w-2xl mx-auto bg-white shadow-lg rounded-lg p-6"},Y={key:0,class:"text-center mt-2 mb-6"},Z={class:"text-sky-600"},ee={key:1,class:"text-center mt-2 mb-6"},te={class:"text-sky-600"},se={class:"mb-4"},oe={class:"block text-gray-600 text-sm mb-1 font-medium"},le={class:"mb-4"},re={class:"grid grid-cols-2 gap-4 mb-4"},ie={class:"block text-gray-600 text-sm mb-1 font-medium"},ne={class:"block text-gray-600 text-sm mb-1 font-medium"},ue={class:"mb-4"},ae={key:2,class:"mb-4 text-red-500 font-medium"},de={class:"flex items-center gap-4"},me=["disabled"],_e={__name:"TaskAdd",setup(L){const i=F(),S=h(),u=P(),_=W(),E=K(),{requirements:pe,requirement:a}=p(_),{users:M}=p(E),{tasks:be,task:d}=p(i);p(i),p(i);const q=x([]),N=R(()=>q.value.map(s=>s.id)),V=x("");R(()=>{var s;return(s=V.value)==null?void 0:s.id});const o=x({title:"",user_ids:[],priority:"MEDIUM",status:"PENDING",description:""});G(N,s=>{o.value.user_ids=s}),O(()=>{var s,e,n,m;_.fetchRequirements(),E.fetchUsers(),((s=u.query)==null?void 0:s.parent_id)>0&&i.fetchTask((e=u.query)==null?void 0:e.parent_id),((n=u.query)==null?void 0:n.requirement_id)>0&&_.fetchRequirement((m=u.query)==null?void 0:m.requirement_id)});const v=x(!1),A=async()=>{var e,n;v.value=!0;const s={...o.value,parent_id:((e=d==null?void 0:d.value)==null?void 0:e.id)||0,requirement_id:((n=a==null?void 0:a.value)==null?void 0:n.id)||null};console.log({payload:s}),await i.createTask(s),v.value=!1,i.error||S.push({name:"TaskList"})};return(s,e)=>{var n,m,C,I;return c(),f("div",Q,[t("div",X,[e[16]||(e[16]=t("h2",{class:"text-2xl font-semibold text-gray-800"},"Add New Task",-1)),e[17]||(e[17]=t("hr",{class:"mb-4"},null,-1)),e[18]||(e[18]=t("div",{class:"text-purple-600/60 mb-4 text-xs"}," Fields that must be filled in will be marked with an asterisk. ",-1)),t("form",{onSubmit:B(A,["prevent"])},[(n=r(u).query)!=null&&n.requirement_id&&((m=r(a))!=null&&m.title)?(c(),f("p",Y,[e[6]||(e[6]=b(" Task under requirement ")),t("span",Z,y(r(a).title),1)])):w("",!0),(C=r(u).query)!=null&&C.parent_id&&((I=r(d))!=null&&I.title)?(c(),f("p",ee,[e[7]||(e[7]=b(" Sub task on ")),t("span",te,y(r(d).title),1)])):w("",!0),t("div",se,[t("label",oe,[e[8]||(e[8]=b("Task Title ")),g(T)]),k(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.title=l),required:"",placeholder:"Enter task title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[U,o.value.title]])]),t("div",le,[e[9]||(e[9]=t("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"User",-1)),g(H,{modelValue:q.value,"onUpdate:modelValue":e[1]||(e[1]=l=>q.value=l),options:r(M),multiple:!0,"track-by":"id",label:"label",placeholder:"Select users"},null,8,["modelValue","options"])]),t("div",re,[t("div",null,[t("label",ie,[e[10]||(e[10]=b("Priority ")),g(T)]),k(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.priority=l),class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},e[11]||(e[11]=[t("option",{value:"LOW"},"LOW",-1),t("option",{value:"MEDIUM"},"MEDIUM",-1),t("option",{value:"HIGH"},"HIGH",-1),t("option",{value:"CRITICAL"},"CRITICAL",-1)]),512),[[D,o.value.priority]])]),t("div",null,[t("label",ne,[e[12]||(e[12]=b("Status ")),g(T)]),k(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.status=l),class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},e[13]||(e[13]=[t("option",{value:""},"--select---",-1),t("option",null,"PENDING",-1),t("option",null,"IN_PROGRESS",-1),t("option",null,"COMPLETED",-1),t("option",null,"BLOCKED",-1),t("option",null,"CANCELLED",-1),t("option",null,"BACK_LOG",-1)]),512),[[D,o.value.status]])])]),t("div",ue,[e[14]||(e[14]=t("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),k(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.description=l),rows:"4",placeholder:"Enter task description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[U,o.value.description]])]),e[15]||(e[15]=t("hr",{class:"mb-4"},null,-1)),r(i).error?(c(),f("div",ae,y(r(i).error),1)):w("",!0),t("div",de,[t("button",{disabled:v.value,type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},y(v.value?"Saving...":"Save Task"),9,me),t("button",{type:"button",onClick:e[5]||(e[5]=l=>r(S).push({name:"TaskList"})),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel ")])],32)])])}}};export{_e as default};
