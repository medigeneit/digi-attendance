import{o as l,c,F as q,x as S,k as L,r as M,y as P,p as V,a as s,m as y,n as b,l as x,t as u,e as T,q as g,z as A}from"./index-aoeAgQM1.js";const N={__name:"TaskTreeChildren",props:{childrenTasks:{type:Array,required:!0,default:[]},hideButtons:{type:Boolean,default:!1}},setup(e){return(w,d)=>(l(),c("div",null,[(l(!0),c(q,null,S(e.childrenTasks,h=>(l(),L(et,{key:h.id,task:h,class:"mb-3 shadow-sm","hide-buttons":e.hideButtons},null,8,["task","hide-buttons"]))),128))]))}},O={class:"items-start grid grid-cols-3"},U={class:""},$={key:0,class:"text-sm text-gray-500 mt-2"},H={class:"flex items-center gap-2 text-xs text-gray-500 mt-2 opacity-50"},I={class:"px-2 py-0.5 text-xs rounded bg-blue-100 text-blue-800 border border-blue-200"},R={class:"flex items-start flex-wrap gap-3"},F={class:"w-6 h-6 rounded-full bg-gray-200 flex items-center justify-center text-xs font-medium text-gray-600"},G={class:"text-xs text-gray-700 mr-2"},J={class:"flex justify-end items-center"},K={class:"text-sm"},Q={class:"mt-4"},W={class:"flex items-center"},X={key:0,class:"fas fa-caret-down text-gray-400 group-hover:text-sky-400"},Y={key:1,class:"fas fa-caret-right text-gray-400 group-hover:text-sky-400"},Z={key:0,class:"flex gap-2 ml-auto items-center"},tt={class:"ml-6"},et={__name:"TaskTreeView",props:{task:{type:Object,required:!0},hideButtons:{type:Boolean,default:!1}},emits:["commentButtonClick"],setup(e,{emit:w}){const d=e,h=w,m=M(!1),j=P(()=>{var a,t,n,r;return{"hover:underline hover:text-sky-400 cursor-pointer":((t=(a=d.task)==null?void 0:a.children_tasks)==null?void 0:t.length)>0,"cursor-default pointer-none":((r=(n=d.task)==null?void 0:n.children_tasks)==null?void 0:r.length)===0}}),z=a=>a.split(" ").map(t=>t[0]).join("").toUpperCase(),D=a=>{switch(a){case"HIGH":return"border-red-500 text-red-500";case"MEDIUM":return"border-yellow-500 text-yellow-500";default:return"border-gray-300 text-gray-500"}},p=a=>{const t=v();let n,r,o;return t===100?(n="bg-green-50",r="bg-green-200",o="text-green-600 "):t<100&&(n="bg-red-50",r="bg-red-200",o="text-red-600 "),{container:n,bar:r,text:o}};function B(){if(d.task.children_tasks.length===0)return d.task.status==="COMPLETED"?1:0;const a=t=>{let n=0;for(let r=0;r<t.length;r++){const o=t[r];if(o.children_tasks.length===0)o.status==="COMPLETED"&&(n+=1);else{const f=o.children_tasks.length;a(o.children_tasks)===f&&(n+=1)}}return n};return a(d.task.children_tasks)}function v(){return d.task.children_tasks.length===0?d.task.status==="COMPLETED"?100:0:B()/d.task.children_tasks.length*100}return(a,t)=>{var r,o,f,C,_,E;const n=V("RouterLink");return l(),c("div",{class:g(["border rounded py-3 group px-3",v()===100?"bg-green-50 ":"bg-gray-50"])},[s("div",O,[s("div",U,[y(n,{to:{name:"TaskShow",params:{id:e.task.id}},class:"font-medium text-gray-700 cursor-pointer hover:text-sky-700"},{default:b(()=>[x(u(e.task.title),1)]),_:1},8,["to"]),(r=e.task)!=null&&r.requirement?(l(),c("p",$," Requirement: "+u((f=(o=e.task)==null?void 0:o.requirement)==null?void 0:f.title),1)):T("",!0),s("div",H,[s("span",I,u(e.task.status),1),s("span",{class:g(["text-xs px-2 py-0.5 rounded border",D(e.task.priority)])},u(e.task.priority),3)])]),s("div",R,[(l(!0),c(q,null,S(e.task.users,(i,k)=>(l(),c("div",{class:"flex items-center gap-2 border rounded-full px-1 py-0.5 bg-slate-100 shadow-sm",key:k},[s("div",F,u(z(i==null?void 0:i.name)),1),s("span",G,u(i==null?void 0:i.name),1)]))),128))]),s("div",J,[s("div",K,[s("div",{class:g(["rounded-full border py-0.5 text-xs relative overflow-hidden h-6",p().container]),style:{width:"180px"}},[s("div",{class:g(["z-10 absolute top-0 bottom-0",p().bar]),style:A(`width: ${v()}%`)},null,6),s("span",{class:g(["z-20 absolute inset-0 gap-1 text-center h-full flex justify-center items-center",p().text])},[s("span",null,[s("span",null,u(B()),1),t[3]||(t[3]=x(" / ")),s("span",null,u(e.task.children_tasks.length||1),1)])],2)],2)])])]),s("div",Q,[s("div",W,[s("div",{class:"flex gap-3 group items-center",onClick:t[0]||(t[0]=i=>{var k;return((k=e.task.children_tasks)==null?void 0:k.length)>0?m.value=!m.value:null})},[m.value?(l(),c("i",X)):(l(),c("i",Y)),s("span",{class:g([j.value,"text-xs text-gray-500"])}," Sub Tasks ("+u((C=e.task.children_tasks)==null?void 0:C.length)+") ",3)]),e.hideButtons?T("",!0):(l(),c("div",Z,[y(n,{to:{name:"TaskEdit",params:{id:e.task.id}},class:"btn-2 py-0.5"},{default:b(()=>t[4]||(t[4]=[x("Edit")])),_:1},8,["to"]),y(n,{to:{name:"TaskUserAssign",params:{id:(_=e.task)==null?void 0:_.id}},class:"bg-indigo-500 hover:bg-indigo-600 text-white text-sm font-semibold px-3 py-1 rounded-full transition border-2"},{default:b(()=>t[5]||(t[5]=[x(" Assign Users ")])),_:1},8,["to"]),y(n,{to:{name:"TaskAdd",query:{parent_id:(E=e.task)==null?void 0:E.id}},class:"bg-indigo-500 hover:bg-indigo-600 text-white text-sm font-semibold px-3 py-1 rounded-full transition border-2",onClick:t[1]||(t[1]=i=>i.stopPropagation())},{default:b(()=>t[6]||(t[6]=[x(" + Sub Task ")])),_:1},8,["to"]),s("button",{class:"bg-indigo-500 hover:bg-indigo-600 text-white text-sm font-semibold px-3 py-1 rounded-full transition border-2",onClick:t[2]||(t[2]=i=>{var k;return h("commentButtonClick",(k=e.task)==null?void 0:k.id)})}," + Comment ")]))]),s("div",tt,[m.value?(l(),L(N,{key:0,childrenTasks:e.task.children_tasks,"hide-buttons":e.hideButtons},null,8,["childrenTasks","hide-buttons"])):T("",!0)])])],2)}}};export{et as _};
