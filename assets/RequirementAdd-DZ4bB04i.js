import{r as f,e as E,z as U,c as b,o as m,a as e,g,F as A,h as V,j as q,p as r,v as $,t as y,i as S,w as x,B as M,f as B,k as c,u as F}from"./index-DsySH2c9.js";import{_ as N}from"./CompanyDepartmentSelectInput-RdKdO0p4.js";import{R as C}from"./RequiredIcon-88ZWF6il.js";import{a as z}from"./requirement-BRBmG_ED.js";import{u as O}from"./company-D0txNeU_.js";import{u as P}from"./tags-B5sbZUXv.js";import{u as j}from"./useTaskStore-AzlC_1o1.js";import{L}from"./LoaderView-BJ0vPtRR.js";import{S as h}from"./SelectDropdown-DHWYI_iN.js";import{u as W}from"./department-Cte2_fJW.js";import{_ as I}from"./UserChip-BUHGt5Ul.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"mb-4"},J={class:"block text-gray-600 text-sm mb-1 font-medium"},H={class:"mb-4"},K={class:"mb-4"},Q={class:"block text-gray-600 text-sm mb-1 font-medium"},X={key:0,class:"relative w-full"},Y={key:0,class:"absolute right-1 text-xl top-0 bottom-0 flex items-center"},Z={class:"mb-4"},ee={class:"mb-4"},te={__name:"RequirementFormDetailItem",props:{fromDepartmentId:{type:[Number,String],required:!0}},emits:["update","onRemoveClick"],setup(R,{emit:_}){const i=R,u=_,n=W(),d=f(""),s=f({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:"4"}),v=f([]);return E(async()=>{v.value=await n.fetchDepartmentEmployee([i.fromDepartmentId])}),U(()=>i.fromDepartmentId,async()=>{v.value=await n.fetchDepartmentEmployee([i.fromDepartmentId])}),U(()=>({...s.value}),a=>{u("update",a)}),(a,o)=>(m(),b("div",null,[e("form",{onSubmit:o[6]||(o[6]=x((...l)=>a.submit&&a.submit(...l),["prevent"])),class:"z-0"},[d.value!=="loading"?(m(),b(A,{key:0},[e("div",G,[e("label",J,[o[7]||(o[7]=q("Title ")),r(C)]),V(e("input",{"onUpdate:modelValue":o[0]||(o[0]=l=>s.value.title=l),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[$,s.value.title]])]),e("div",H,[o[8]||(o[8]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Details",-1)),V(e("textarea",{rows:"10","onUpdate:modelValue":o[1]||(o[1]=l=>s.value.description=l),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[$,s.value.description]])]),e("div",K,[e("label",Q,"Supervisor "+y(s.value.supervisor_id),1),r(h,{modelValue:s.value.supervisor_id,"onUpdate:modelValue":o[3]||(o[3]=l=>s.value.supervisor_id=l),options:v.value,placeholder:"--NO SUPERVISOR--"},{option:S(({option:l})=>[r(I,{user:l||{}},null,8,["user"])]),"selected-option":S(({option:l})=>[l?(m(),b("div",X,[r(I,{user:l||{}},null,8,["user"]),s.value.supervisor_id?(m(),b("div",Y,[e("button",{onClick:o[2]||(o[2]=x(w=>s.value.supervisor_id=null,["prevent"])),class:"text-gray-6 font-semibold 00 hover:text-red-700"}," Ã— ")])):g("",!0)])):g("",!0)]),_:1},8,["modelValue","options"])]),e("div",Z,[o[10]||(o[10]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),V(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":o[4]||(o[4]=l=>s.value.priority=l)},o[9]||(o[9]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[M,s.value.priority]])]),e("div",ee,[o[11]||(o[11]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),V(e("input",{type:"date","onUpdate:modelValue":o[5]||(o[5]=l=>s.value.better_to_complete_on=l),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[$,s.value.better_to_complete_on]])])],64)):g("",!0)],32)]))}},se={class:"w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},oe={class:"sticky top-0 pt-4 bg-white z-10"},le={class:"block text-gray-600 text-sm mb1 font-medium"},ae={class:"block text-gray-600 text-sm mb-1 font-medium"},re={class:"mb-4"},ie={class:"text-gray-800"},ne={class:"mb-4"},me={class:"text-gray-800"},ue={class:"mb-8"},de={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},pe={key:0,class:"mb-4 text-red-500 font-medium"},be={key:1,class:"mb-4"},ve={class:"flex items-center justify-between gap-4"},ce=["disabled"],fe={__name:"RequirementAddForm",emits:["create","cancelClick","error"],setup(R,{emit:_}){const i=_,u=j(),n=P(),d=O(),s=f(""),v=f([]),a=f({from_department_id:"1",to_department_id:"",website_tags:[1,4],details:[]});E(async()=>{s.value="loading",n.fetchTags("website"),await d.fetchCompanies({with:"departments",ignore_permission:!0}),await d.fetchMyCompanies({with:"departments"}),s.value=""});async function o(){s.value="submitting";const k={...a.value,...v.value&&Array.isArray(v.value)?{website_tags:v.value.map(t=>t.id)}:{}};try{const t=await z(k);i("create",t),s.value="create"}catch{i("error",u.error),s.value="error"}}function l(k){console.log({detailData:k})}const w=f(["India","Pakistan","Nepal","Japan"]);return(k,t)=>{var D,T;return m(),b("div",se,[e("div",oe,[t[6]||(t[6]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add New Requirement",-1)),t[7]||(t[7]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:t[0]||(t[0]=x(p=>i("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:x(o,["prevent"]),class:"z-0"},[s.value!=="loading"&&s.value!=="submitting"?(m(),b(A,{key:0},[r(N,{modelValue:a.value.from_department_id,"onUpdate:modelValue":t[1]||(t[1]=p=>a.value.from_department_id=p),companies:((D=c(d))==null?void 0:D.myCompanies)||[],class:"mb-4"},{label:S(()=>[e("label",le,[t[8]||(t[8]=q(" From ")),r(C)])]),_:1},8,["modelValue","companies"]),r(N,{modelValue:a.value.to_department_id,"onUpdate:modelValue":t[2]||(t[2]=p=>a.value.to_department_id=p),companies:((T=c(d))==null?void 0:T.companies)||[],class:"mb-4"},{label:S(()=>[e("label",ae,[t[9]||(t[9]=q(" To ")),r(C)])]),_:1},8,["modelValue","companies"]),e("div",re,[e("label",ie,"Websites "+y(a.value.website_tags),1),r(h,{options:c(n).tags,modelValue:a.value.website_tags,"onUpdate:modelValue":t[3]||(t[3]=p=>a.value.website_tags=p),multiple:"",label:"name",value:"id"},null,8,["options","modelValue"])]),e("div",ne,[e("label",me,"Tags "+y(w.value),1),r(h,{options:c(n).tags,modelValue:w.value,"onUpdate:modelValue":t[4]||(t[4]=p=>w.value=p),taggable:"",label:"name",value:"name"},null,8,["options","modelValue"])])],64)):g("",!0),e("div",ue,[t[10]||(t[10]=e("h3",{class:"font-semibold text-xl"},"Requirement details",-1)),t[11]||(t[11]=e("hr",{class:"mb-2"},null,-1)),t[12]||(t[12]=e("div",null,"dsdf",-1)),r(te,{"from-department-id":a.value.from_department_id,onUpdate:l},null,8,["from-department-id"])]),e("div",de,[c(u).error?(m(),b("div",pe,y(c(u).error),1)):g("",!0),c(u).error?(m(),b("hr",be)):g("",!0),e("div",ve,[e("button",{type:"button",onClick:t[5]||(t[5]=x(p=>i("cancelClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:s.value=="loading"||s.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},y(s.value=="submitting"?"Saving...":"Save"),9,ce)])])],32),s.value==="loading"||s.value==="submitting"?(m(),B(L,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):g("",!0)])}}},ge={class:"container mx-auto p-6"},De={__name:"RequirementAdd",setup(R){const _=F();function i(u){var d;const n=((d=u.data)==null?void 0:d.requirement)||null;n&&_.push({name:"RequirementShow",params:{id:n.id}})}return(u,n)=>(m(),b("div",ge,[r(fe,{onCreate:i})]))}};export{De as default};
