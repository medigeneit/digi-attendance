import{O as F}from"./OverlyModal-CnRRusBC.js";import{m as N,c as i,o,g as T,F as A,n as M,f as U,p as S,q as g,i as b,a as e,t as d,k as m,R as W,w as $,s as E,r as C,d as O,e as z,x as V,h as j,v as Y,j as v,y as H,z as B,u as I,A as K}from"./index-BKRuc3xX.js";import{L as G}from"./LoaderView-D7rXjkqI.js";import{m as J,_ as Q}from"./task-tree-GLvyr5Bn.js";import{o as R,g as P,a as X}from"./datetime-DLUp6MRA.js";import{u as Z}from"./useTaskStore-C9lHn01F.js";import{_ as ee}from"./TaskTreeViewWithSubTable-BVQdinnk.js";import{u as te}from"./user-Djoifq-t.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TaskSupervisorAndEmployee-BtIsy2SB.js";import"./UserChip-U1AAOwFq.js";import"./url-CePbr-gY.js";const se=(k,_,n,u)=>{const p=new Date(u,n-1,_);return k.filter(a=>{const y=a.deadline?new Date(a.deadline):null,c=R(new Date);if(a.assigned_at||a.created_at){let D=a.assigned_at?R(new Date(a.assigned_at)):null;!D&&a.created_at&&(D=R(new Date(a.created_at)));let f=null;return!(p<D||(a.completed_at&&(f=R(new Date(a.completed_at))),f&&f<p)||y&&y<p&&p>c)}return!1}).map(a=>{let y=!1;return a.deadline&&(y=new Date(a.deadline)<p),{...a,deadline_crossed:y}})},ae={key:0},oe={key:0,class:"fad fa-folder text-xs mr-2"},le={key:1,class:"fad fa-file-alt text-xs mr-2"},ne={key:2,class:"text-center w-full mt-4 text-xs text-gray-600"},ie={__name:"TaskListOnDay",props:{isCurrentMonth:{type:Boolean,default:!1},tasks:{type:Array,default:()=>[]},limit:{type:Number,default:null},tree:{type:Boolean,default:!1}},emits:["clickOnMore"],setup(k,{emit:_}){const n=k,u=_,p=N(()=>{var a;return n.limit?((a=n==null?void 0:n.tasks)==null?void 0:a.slice(0,n.limit))||[]:[...n.tasks]});return(a,y)=>(o(),i("div",null,[k.tree?(o(),i("div",ae,[(o(!0),i(A,null,M(p.value,c=>(o(),U(ee,{"hide-buttons":"","hide-assigned-users":"",task:c,key:c.id,class:"mb-6 shadow hover:shadow-md"},null,8,["task"]))),128))])):(o(),i("ul",{key:1,class:S({"text-gray-500 group-hover:text-gray-900":!k.isCurrentMonth})},[(o(!0),i(A,null,M(p.value,c=>(o(),i("li",{class:"mb-2",key:c.id},[g(m(W),{to:`/tasks/${c.id}`,target:"_blank",class:"flex items-center hover:underline hover:text-blue-600"},{default:b(()=>[c.children_task_count>0?(o(),i("i",oe)):T("",!0),c.children_task_count==0?(o(),i("i",le)):T("",!0),e("span",{class:S(["line-clamp-1",{"text-red-800":c.deadline_crossed}])},d(c.title),3)]),_:2},1032,["to"])]))),128))],2)),k.tasks.length-p.value.length>0?(o(),i("div",ne,[e("button",{onClick:y[0]||(y[0]=$(c=>u("clickOnMore",c),["prevent"])),class:"text-blue-600 hover:underline"}," +"+d(k.tasks.length-p.value.length)+" More Tasks ",1)])):T("",!0)]))}},re={class:"border"},de={class:"px-4 py-2 flex items-center bg-gray-50 group"},ue={class:"mx-4"},ce=["disabled"],me={class:"ml-4 md:ml-auto flex items-center gap-2"},pe={class:"bg-gray-300 bg-opacity-90 relative"},ye={class:"bg-gray-50 border-y rounded-md z-20"},fe={class:"text-md font-semibold sticky top-0 border-b px-4 z-30 py-3 bg-white flex items-center shadow"},xe={class:"flex justify-between items-center gap-4 ml-auto"},ve={class:"w-32 relative h-8 mx-4"},_e={__name:"DailyTask",setup(k){const _=E({day:null,month:null,year:null}),n=C(),u=C("loading"),p=Z(),a=O(),y=C(""),c=C("not-completed");z(()=>{n.value=P(new Date)}),V(n,r=>{const[l,t,h]=r.split("-").map(Number);_.day=h,_.month=t,_.year=l}),V(()=>_.month,async()=>{u.value="loading",await D(),u.value=""});async function D(){await p.fetchMyTasks({status:"not-completed"})}function f(){const r=new Date;n.value=P(r)}function q(){const r=new Date(n.value);r.setDate(r.getDate()+1),n.value=P(r)}function w(){const r=new Date(n.value);r.setDate(r.getDate()-1),n.value=P(r)}const s=async()=>{u.value="loading",await D(),u.value=""},x=N(()=>{var l;const r=t=>{var h,L;return y.value?(L=t==null?void 0:t.toUpperCase())==null?void 0:L.includes((h=y.value)==null?void 0:h.toUpperCase()):!0};return J(se(p.tasks,_.day,_.month,_.year),{"user-ids":(l=a==null?void 0:a.user)==null?void 0:l.id,status:c.value}).filter(t=>{var h;return r(t.title)||((h=t.children_tasks)==null?void 0:h.some(L=>r(L==null?void 0:L.title)))}).map(t=>({...t,children_tasks:t.children_tasks.filter(h=>r(h.title))}))});return(r,l)=>(o(),i("div",re,[e("div",de,[l[4]||(l[4]=e("h2",{class:"leading-none font-semibold text-lg"},"Daily Task",-1)),e("div",ue,d(m(X)(n.value)),1),e("button",{class:"btn-3 mx-4 h-7",onClick:$(f,["prevent"])},"Today"),e("button",{class:S(["btn-3 px-2 py-2 mx-4 size-7 disabled:text-gray-300 disabled:border-gray-300",{"animate-spin text-gray-300 border-gray-300 !bg-opacity-0":u.value=="loading"}]),onClick:$(s,["prevent"]),disabled:u.value=="loading"},l[3]||(l[3]=[e("i",{class:"fas fa-redo-alt"},null,-1)]),10,ce),e("div",me,[e("button",{class:"btn-2 h-7",onClick:$(w,["prevent"])},"Previous Day"),e("button",{class:"btn-2 h-7",onClick:$(q,["prevent"])},"Next Day"),j(e("input",{type:"date","onUpdate:modelValue":l[0]||(l[0]=t=>n.value=t),class:"border px-2 rounded"},null,512),[[Y,n.value]])])]),e("div",pe,[e("div",ye,[e("div",fe,[l[7]||(l[7]=v(" Tasks ")),e("div",xe,[e("div",ve,[l[6]||(l[6]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),j(e("select",{"onUpdate:modelValue":l[1]||(l[1]=t=>c.value=t),class:"h-8 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},l[5]||(l[5]=[e("option",{value:""},"--ALL TASKS--",-1),e("option",{value:"not-completed"},"Not Completed",-1)]),512),[[H,c.value]])]),g(Q,{modelValue:y.value,"onUpdate:modelValue":l[2]||(l[2]=t=>y.value=t),class:"w-full md:w-48 md:ml-auto h-8","debounce-time":0},null,8,["modelValue"])])]),g(ie,{class:"p-4 min-h-[40vh] max-h-[60vh] overflow-y-auto","is-current-month":r.isCurrentMonth,tasks:x.value,tree:!0},null,8,["is-current-month","tasks"])]),u.value==="loading"?(o(),U(G,{key:0,class:"absolute inset-0 flex items-center justify-center z-20 bg-opacity-70"})):T("",!0)])]))}},ge={class:"container px-6 mx-auto"},be={key:0,class:"grid gap-4 md:grid-cols-3 mt-4"},he={class:"text-3xl"},we={class:"text-3xl"},ke={class:"text-3xl"},De={class:"text-3xl"},Le={class:"text-3xl"},$e={class:"text-3xl"},Ce={class:"text-3xl"},Te={class:"text-3xl"},Ae={class:"text-3xl"},Me={key:1,class:"w-full mt-4"},Se={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Re={class:"bg-white shadow-md rounded-lg p-4"},Pe={class:"space-y-2"},Ue={class:"flex justify-between items-center px-4 py-2 rounded hover:bg-gray-50 transition-colors"},qe={class:"font-semibold text-gray-800"},Ne={key:0},Ve={key:1},je={key:2},Be={class:"space-y-3"},Oe={class:"flex items-center space-x-4"},ze={key:0,class:"h-3 w-3 bg-red-600 rounded-full inline-block"},Fe={key:1,class:"inline-block"},We={class:"absolute top-10 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition pointer-events-none z-10 whitespace-nowrap"},Ee={class:"text-sm font-medium text-gray-900"},Ye={class:"text-xs text-gray-500 mt-0.5"},He={class:"text-xl font-bold text-gray-800 flex items-center gap-2 p-4"},Ie={class:"space-y-5 px-4 md:px-6 py-4"},Ke={class:"text-sm text-gray-500 flex items-center gap-2"},Ge={class:"flex justify-end gap-3 mt-6"},Je={class:"bg-white shadow-md rounded-lg"},Qe={class:"overflow-x-auto shadow-md sm:rounded-lg min-h-max"},Xe={class:"min-w-full text-sm text-left text-gray-500"},Ze={class:"px-6 py-4 font-medium text-gray-900"},et={class:"px-6 py-4"},tt={class:"px-6 py-4"},st={class:"px-6 py-4"},at={class:"card-bg mt-4 gap-0 shadow-md border border-gray-300"},xt={__name:"DashBoard",setup(k){const _=O(),n=te(),{dashboardInfo:u,selectedDate:p,userDashboard:a}=B(n),{user:y}=B(_),c=I(),D=N(()=>{var w;return["admin","super_admin","developer"].includes((w=y==null?void 0:y.value)==null?void 0:w.role)}),f=C(null);z(async()=>{var s,x;y.value||await _.fetchUser(),await n.fetchUserDashboardData(),D.value&&await n.fetchAdminDashboardData();const w=(x=(s=a.value)==null?void 0:s.notices)==null?void 0:x.find(r=>!r.user_feedback);w&&(f.value=w)});const q=()=>{if(!f.value)return;const w=f.value.type===1?`/notice-details/${f.value.id}`:`/policy-details/${f.value.id}`;c.push(w)};return(w,s)=>{var r,l;const x=K("RouterLink");return o(),i("div",ge,[D.value&&m(_).isAdminMood?(o(),i("div",be,[g(x,{to:{name:"TodayAttendanceReport",query:{status:"all"}},class:"main-button"},{default:b(()=>{var t;return[e("span",he,d((t=m(u))==null?void 0:t.totalUsers),1),s[2]||(s[2]=v(" Total Employees "))]}),_:1,__:[2]}),g(x,{to:{name:"TodayAttendanceReport",query:{status:"Present"}},class:"main-button"},{default:b(()=>{var t;return[e("span",we,d((t=m(u))==null?void 0:t.todayPresents),1),s[3]||(s[3]=v(" Today Present "))]}),_:1,__:[3]}),g(x,{to:{name:"TodayAttendanceReport",query:{status:"Absent"}},class:"main-button"},{default:b(()=>{var t;return[e("span",ke,d((t=m(u))==null?void 0:t.todayAbsents),1),s[4]||(s[4]=v(" Today Absent "))]}),_:1,__:[4]}),g(x,{to:{name:"LeaveApplicationList",query:{status:"today"}},class:"main-button"},{default:b(()=>{var t;return[e("span",De,d((t=m(u))==null?void 0:t.todayLeaves),1),s[5]||(s[5]=v(" Today Leave "))]}),_:1,__:[5]}),g(x,{to:{name:"LeaveApplicationList",query:{status:"tomorrow"}},class:"main-button"},{default:b(()=>{var t;return[e("span",Le,d((t=m(u))==null?void 0:t.tomorrowLeaves),1),s[6]||(s[6]=v(" Tomorrow Leave "))]}),_:1,__:[6]}),g(x,{to:{name:"ShortLeaveList",query:{status:m(p)}},class:"main-button"},{default:b(()=>{var t;return[e("span",$e,d((t=m(u))==null?void 0:t.todayShortLeaves),1),s[7]||(s[7]=v(" Today Short Leaves "))]}),_:1,__:[7]},8,["to"]),g(x,{to:{name:"DailyLateAttendanceReport",query:{date:m(p)}},class:"main-button"},{default:b(()=>{var t;return[e("span",Ce,d((t=m(u))==null?void 0:t.todayLateEntries),1),s[8]||(s[8]=v(" Today Late Report "))]}),_:1,__:[8]},8,["to"]),g(x,{to:{name:"PreviousAfterApplicationList",query:{type:"prev",date:m(p)}},class:"main-button"},{default:b(()=>{var t;return[e("span",Te,d((t=m(u))==null?void 0:t.prevWeekLeaves),1),s[9]||(s[9]=v(" Leave history of previous week "))]}),_:1,__:[9]},8,["to"]),g(x,{to:{name:"PreviousAfterApplicationList",query:{type:"after",date:m(p)}},class:"main-button"},{default:b(()=>{var t;return[e("span",Ae,d((t=m(u))==null?void 0:t.nextWeekLeaves),1),s[10]||(s[10]=v(" Upcoming leaves "))]}),_:1,__:[10]},8,["to"])])):(o(),i("div",Me,[e("div",Se,[e("div",Re,[e("div",Pe,[s[14]||(s[14]=e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Applications")],-1)),(o(!0),i(A,null,M((r=m(a))==null?void 0:r.current_month_leave,t=>(o(),U(x,{to:{name:"MyLeaveApplicationShow",params:{id:t.id}},key:t.id},{default:b(()=>[e("div",Ue,[e("h3",qe," Leave Application #"+d(t.id),1),e("p",{class:S(["text-sm font-medium flex items-center space-x-2",{"bg-gray-500 py-1.5 rounded-full px-4 text-white":t.status===null,"bg-yellow-500 py-1.5 rounded-full px-4 text-white":t.status==="Pending","bg-green-500 py-1.5 rounded-full px-4 text-white":t.status==="approved"}])},[t.status===null?(o(),i("span",Ne,s[11]||(s[11]=[e("i",{class:"fas fa-clock mr-2"},null,-1),v(" Wait for Hanover ")]))):t.status==="Pending"?(o(),i("span",Ve,s[12]||(s[12]=[e("i",{class:"fas fa-hourglass-half mr-2"},null,-1),v(" Pending ")]))):(o(),i("span",je,s[13]||(s[13]=[e("i",{class:"fas fa-check-circle mr-2"},null,-1),v(" Approved ")])))],2)])]),_:2},1032,["to"]))),128))]),s[20]||(s[20]=e("div",{class:"flex justify-between items-start mb-4"},[e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Notices")])],-1)),e("div",Be,[(o(!0),i(A,null,M(m(a).notices,(t,h)=>(o(),i("div",{key:h,class:"flex items-center justify-between p-4 border rounded-lg shadow-sm hover:shadow transition-all bg-white"},[e("div",Oe,[e("div",{class:S([["rounded-full",t.user_feedback?"bg-green-100":"bg-red-100"],"h-8 w-8 flex items-center justify-center rounded-full"])},[t.user_feedback?(o(),i("span",Fe,s[15]||(s[15]=[e("i",{class:"far fa-check text-green-600"},null,-1)]))):(o(),i("span",ze)),e("div",We,d(t.user_feedback?"Feedback Submitted":"Feedback Pending"),1)],2),e("div",null,[e("p",Ee,d(t.title),1),e("p",Ye,d(t.published_at),1)])]),g(x,{to:t.type===1?`/notice-details/${t.id}`:`/policy-details/${t.id}`,class:"text-blue-600 hover:text-blue-800 font-semibold text-sm"},{default:b(()=>s[16]||(s[16]=[v(" View ")])),_:2,__:[16]},1032,["to"])]))),128)),f.value?(o(),U(F,{key:0,show:!0,onClose:s[1]||(s[1]=t=>f.value=null)},{default:b(()=>[e("div",He,[s[17]||(s[17]=e("i",{class:"fas fa-bell text-blue-500"},null,-1)),v(" "+d(f.value.title),1)]),e("div",Ie,[e("p",Ke,[s[18]||(s[18]=e("i",{class:"fas fa-calendar-alt text-gray-400"},null,-1)),v(" Published: "+d(f.value.published_at),1)]),s[19]||(s[19]=e("p",{class:"text-base text-gray-700 leading-relaxed"}," You must read this notice before proceeding. ",-1)),e("div",Ge,[e("button",{onClick:s[0]||(s[0]=t=>f.value=null),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-5 py-2 rounded-lg transition"}," Cancel "),e("button",{onClick:q,class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2.5 rounded-lg shadow transition"}," Read Details ")])])]),_:1})):T("",!0)])]),e("div",Je,[s[22]||(s[22]=e("h2",{class:"text-xl font-semibold py-3 px-4"},"Leave Balance",-1)),e("div",Qe,[e("table",Xe,[s[21]||(s[21]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"Type"),e("th",{scope:"col",class:"px-6 py-3"},"Total Days"),e("th",{scope:"col",class:"px-6 py-3"},"Used Days"),e("th",{scope:"col",class:"px-6 py-3"},"Remaining Days")])],-1)),e("tbody",null,[(o(!0),i(A,null,M((l=m(a))==null?void 0:l.leave_balance,t=>(o(),i("tr",{key:t.id,class:"border-b hover:bg-gray-100"},[e("td",Ze,d(t.leave_type),1),e("td",et,d(t.annual_quota),1),e("td",tt,d(t.used_days),1),e("td",st,d(t.remaining_days),1)]))),128))])])])])]),e("div",at,[g(_e)])]))])}}};export{xt as default};
