import{r as w,h as z,y as G,c,o as i,a as t,k as g,t as o,d as x,F as R,A as K,g as X,ad as Y,x as H,p as Z,e as tt,s as L,j as et,m as st}from"./index-DstRERbg.js";import{u as T}from"./overtime-Dvf2hbVv.js";import{_ as nt}from"./AcceptAndRejectHandler-CoRCMBMA.js";import{_ as k}from"./DisplayFormattedWorkingHours-Dnn_ORgy.js";import{_ as at}from"./TimePickerAsFloatHour-0AaPT2As.js";const ot={key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50"},rt={class:"modal-card max-w-sm p-4"},lt={class:"grid grid-cols-3 gap-2 border p-3"},it={class:"border-x"},ct={class:"col-span-full text-xs md:text-sm border-t pt-3"},dt={class:"flex justify-between gap-2 mt-2"},ut={__name:"DeleteOvertime",props:{overtime:Object,onSuccess:{type:Function,default:null}},setup(a){const u=a,D=T(),y=w(null),b=w(null),r=w(!1),_=async()=>{await D.deleteOvertime(u.overtime.id),u.onSuccess&&await u.onSuccess(),S()},v=()=>{r.value=!0,A()},S=()=>{r.value=!1};function A(){K(()=>{var p;(p=y.value)==null||p.focus()})}function B(p){var d,l;r.value&&(p.key==="ArrowLeft"?(d=b.value)==null||d.focus():p.key==="ArrowRight"&&((l=y.value)==null||l.focus()))}return z(()=>{window.addEventListener("keydown",B)}),G(()=>{window.removeEventListener("keydown",B)}),(p,d)=>(i(),c(R,null,[t("i",{onClick:v,class:"fa fa-trash cursor-pointer text-red-600"}),r.value?(i(),c("div",ot,[t("div",rt,[d[0]||(d[0]=t("h3",{class:"title-lg"},"Delete Overtime",-1)),t("div",lt,[t("div",null,[t("b",null,o(new Date(a.overtime.date).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})),1)]),t("div",it,[t("b",null,o(a.overtime.duty_type),1)]),t("div",null,[t("b",null,[x(k,{workingHours:a.overtime.request_overtime_hours},null,8,["workingHours"])])]),t("div",ct,o(a.overtime.work_details),1)]),t("div",dt,[t("button",{type:"button",ref_key:"cancelBtnRef",ref:b,class:"btn-3 focus:ring-2 ring-offset-2",onClick:S}," Cancel ",512),t("button",{type:"button",ref_key:"confirmBtnRef",ref:y,class:"btn-2-red focus:ring-2 ring-offset-2",onClick:_}," Delete ",512)])])])):g("",!0)],64))}},pt={key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50"},yt={class:"modal-card max-w-sm"},ft={class:"flex justify-between gap-2 mt-4"},gt={__name:"UpdateApprovalTime",props:{overtime:Object,onSuccess:{type:Function,default:null}},setup(a){const u=a,D=T(),y=w(null),b=w(null),r=w(!1),_=w(u.overtime.approval_overtime_hours||u.overtime.request_overtime_hours||""),v=async()=>{if(!_.value)return alert("Please set approval time!");await D.updateApprovalTime(u.overtime.id,_.value),u.onSuccess&&await u.onSuccess(),A()},S=()=>{r.value=!0,B()},A=()=>{r.value=!1};function B(){K(()=>{var d;(d=y.value)==null||d.focus()})}function p(d){var l,C;r.value&&(d.key==="ArrowLeft"?(l=b.value)==null||l.focus():d.key==="ArrowRight"&&((C=y.value)==null||C.focus()))}return z(()=>{window.addEventListener("keydown",p)}),G(()=>{window.removeEventListener("keydown",p)}),(d,l)=>(i(),c(R,null,[t("i",{onClick:S,class:"fa fa-edit cursor-pointer text-sky-600"}),r.value?(i(),c("div",pt,[t("div",yt,[l[1]||(l[1]=t("h3",{class:"title-lg"},"Update Approval Time",-1)),l[2]||(l[2]=t("hr",{class:"my-2"},null,-1)),x(at,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=C=>_.value=C),"minute-interval":5,required:!0,"hour-min":1,"hour-max":16},null,8,["modelValue"]),l[3]||(l[3]=t("hr",{class:"my-2"},null,-1)),t("div",ft,[t("button",{type:"button",ref_key:"cancelBtnRef",ref:b,class:"btn-3 focus:ring-2 ring-offset-2",onClick:A}," Cancel ",512),t("button",{type:"button",ref_key:"confirmBtnRef",ref:y,class:"btn-2-green focus:ring-2 ring-offset-2",onClick:v}," Update Time ",512)])])])):g("",!0)],64))}},xt={class:"space-y-4"},_t={class:"card-bg p-4 gap-1"},mt={class:"flex flex-wrap gap-x-8 gap-y-2"},bt={key:0,class:"text-gray-700"},ht={class:"ml-1"},kt={key:1,class:"text-gray-700"},wt={class:"ml-1"},vt={key:2,class:"text-gray-700"},St={class:"ml-1"},At={key:3,class:"text-gray-700"},Bt={class:"ml-1"},Ct={key:4,class:"text-gray-700"},Dt={class:"ml-1"},jt={class:"rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden"},Ht={class:"overflow-x-auto"},Lt={class:"min-w-[1200px] w-full text-sm"},Rt={class:"divide-y divide-gray-100"},Tt={class:"px-3 py-2 text-gray-600"},$t={class:"px-3 py-2"},Nt={class:"text-gray-900"},Ot={class:"px-3 py-2"},Mt={class:"text-gray-900"},Ut={class:"px-3 py-2"},qt={class:"px-3 py-2 text-gray-900"},Vt={class:"px-3 py-2 text-gray-900"},Et={class:"px-3 py-2 text-gray-900"},Ft={class:"px-3 py-2 text-center"},Pt={class:"px-3 py-2 text-center"},It={class:"px-3 py-2 text-center"},zt={class:"px-3 py-2 text-gray-900"},Gt={class:"line-clamp-2"},Kt={class:"px-3 py-2 text-center"},Wt={class:"px-3 py-2"},Jt={class:"flex items-center justify-center gap-2"},Qt={key:0,class:"rounded-xl border border-dashed border-gray-300 bg-gray-50 px-2 py-1"},Xt={key:0},Yt={key:0,class:"bg-gray-50"},Zt={class:"border-t border-gray-200 font-semibold"},te={class:"px-3 py-2 text-center"},ee={class:"px-3 py-2 text-center"},se={class:"px-3 py-2 text-center"},ie={__name:"OvertimeDataList",props:{user:Object,onUpdate:{type:Function,default:null}},setup(a){const u=X(),D=T(),y=Y(),b=a,r=H(()=>D.overtimes||[]),_=async()=>{b.onUpdate?await b.onUpdate():await y.fetchCountNotifications()},v=n=>{if(!n)return"—";try{return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"short",year:"numeric"}).format(new Date(n))}catch{return"—"}};H(()=>{var m,f;const n=((f=(m=b.user)==null?void 0:m.name)==null?void 0:f.trim())||"";return n?n.split(/\s+/).slice(0,2).map(h=>{var j;return(j=h[0])==null?void 0:j.toUpperCase()}).join(""):"U"});const S=n=>n?String(n):"Pending",A=n=>{const e=String(n||"pending").toLowerCase();return e.includes("approved")||e.includes("accept")?"bg-emerald-50 text-emerald-700 ring-emerald-200":e.includes("reject")||e.includes("decline")?"bg-rose-50 text-rose-700 ring-rose-200":e.includes("pending")?"bg-amber-50 text-amber-700 ring-amber-200":"bg-gray-50 text-gray-700 ring-gray-200"},B=n=>{const e=String(n||"").toLowerCase();return e.includes("holiday")?"bg-indigo-50 text-indigo-700 ring-indigo-200":e.includes("weekend")?"bg-violet-50 text-violet-700 ring-violet-200":e.includes("off")?"bg-sky-50 text-sky-700 ring-sky-200":"bg-gray-50 text-gray-700 ring-gray-200"},p=n=>{var e,m,f;return(n==null?void 0:n.recommend_by_user_id)===((e=u.user)==null?void 0:e.id)||!!((f=(m=y.applicationApprovalPermissions)==null?void 0:m[n==null?void 0:n.id])!=null&&f.allow_recommend_by)},d=n=>!(n!=null&&n.approval_overtime_hours)&&p(n),l=n=>{var f,h;const e=((f=y.applicationApprovalPermissions)==null?void 0:f[n==null?void 0:n.id])||{},m=Object.values(e).some(Boolean);return(n==null?void 0:n.recommend_by_user_id)===((h=u.user)==null?void 0:h.id)?((n==null?void 0:n.approval_overtime_hours)??null)&&m:m},C=H(()=>r.value.reduce((n,e)=>n+(Number(e==null?void 0:e.working_hours)||0),0)),W=H(()=>r.value.reduce((n,e)=>n+(Number(e==null?void 0:e.request_overtime_hours)||0),0)),J=H(()=>r.value.reduce((n,e)=>n+(Number(e==null?void 0:e.approval_overtime_hours)||0),0));return(n,e)=>{var f,h,j,$,N,O,M,U,q,V,E,F,P,I;const m=Z("RouterLink");return i(),c("div",xt,[t("div",_t,[t("div",mt,[(f=a.user)!=null&&f.employee_id?(i(),c("p",bt,[e[0]||(e[0]=t("span",{class:"text-gray-400"},"Employee ID:",-1)),t("strong",ht,o(((h=a.user)==null?void 0:h.employee_id)||"N/A"),1)])):g("",!0),(j=a.user)!=null&&j.name?(i(),c("p",kt,[e[1]||(e[1]=t("span",{class:"text-gray-400"},"Name:",-1)),t("strong",wt,o(($=a.user)==null?void 0:$.name),1)])):g("",!0),(O=(N=a.user)==null?void 0:N.designation)!=null&&O.title?(i(),c("p",vt,[e[2]||(e[2]=t("span",{class:"text-gray-400"},"Designation:",-1)),t("strong",St,o(((U=(M=a.user)==null?void 0:M.designation)==null?void 0:U.title)||"N/A"),1)])):g("",!0),(V=(q=a.user)==null?void 0:q.department)!=null&&V.name?(i(),c("p",At,[e[3]||(e[3]=t("span",{class:"text-gray-400"},"Department:",-1)),t("strong",Bt,o(((F=(E=a.user)==null?void 0:E.department)==null?void 0:F.name)||"N/A"),1)])):g("",!0),(P=a.user)!=null&&P.phone?(i(),c("p",Ct,[e[4]||(e[4]=t("span",{class:"text-gray-400"},"Phone:",-1)),t("strong",Dt,o((I=a.user)==null?void 0:I.phone),1)])):g("",!0)])]),t("div",jt,[t("div",Ht,[t("table",Lt,[e[11]||(e[11]=t("thead",{class:"sticky top-0 z-10 bg-gray-50 text-gray-600"},[t("tr",{class:"border-b border-gray-200"},[t("th",{class:"px-3 py-2 text-left font-semibold"},"#"),t("th",{class:"px-3 py-2 text-left font-semibold"},"Applied"),t("th",{class:"px-3 py-2 text-left font-semibold"},"Date"),t("th",{class:"px-3 py-2 text-left font-semibold"},"Type"),t("th",{class:"px-3 py-2 text-left font-semibold"},"Shift"),t("th",{class:"px-3 py-2 text-left font-semibold"},"In"),t("th",{class:"px-3 py-2 text-left font-semibold"},"Out"),t("th",{class:"px-3 py-2 text-center font-semibold"},"Working"),t("th",{class:"px-3 py-2 text-center font-semibold"},"Request"),t("th",{class:"px-3 py-2 text-center font-semibold"},"Approved"),t("th",{class:"px-3 py-2 text-left font-semibold"},"Details"),t("th",{class:"px-3 py-2 text-center font-semibold"},"Status"),t("th",{class:"px-3 py-2 text-center font-semibold"},"Action")])],-1)),t("tbody",Rt,[(i(!0),c(R,null,tt(r.value,(s,Q)=>(i(),c("tr",{key:s==null?void 0:s.id,class:"hover:bg-gray-50"},[t("td",Tt,o(Q+1),1),t("td",$t,[t("span",Nt,o(v(s==null?void 0:s.created_at)),1)]),t("td",Ot,[t("span",Mt,o(v(s==null?void 0:s.date)),1)]),t("td",Ut,[t("span",{class:L(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset",B(s==null?void 0:s.duty_type)])},o((s==null?void 0:s.duty_type)||"—"),3)]),t("td",qt,o((s==null?void 0:s.shift)||"—"),1),t("td",Vt,o((s==null?void 0:s.check_in)||"—"),1),t("td",Et,o((s==null?void 0:s.check_out)||"—"),1),t("td",Ft,[x(k,{workingHours:s==null?void 0:s.working_hours},null,8,["workingHours"])]),t("td",Pt,[x(k,{workingHours:s==null?void 0:s.request_overtime_hours},null,8,["workingHours"])]),t("td",It,[t("div",{class:L(["inline-flex items-center justify-center gap-2 rounded-xl px-2 py-1",d(s)?"bg-amber-50 ring-1 ring-inset ring-amber-200":""])},[x(k,{workingHours:s==null?void 0:s.approval_overtime_hours},null,8,["workingHours"]),p(s)?(i(),et(gt,{key:0,overtime:s,onSuccess:_},null,8,["overtime"])):g("",!0)],2)]),t("td",zt,[t("span",Gt,o((s==null?void 0:s.work_details)||"—"),1)]),t("td",Kt,[t("span",{class:L(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1 ring-inset",A(s==null?void 0:s.status)])},o(S(s==null?void 0:s.status)),3)]),t("td",Wt,[t("div",Jt,[l(s)?(i(),c("div",Qt,[x(nt,{notificationType:"overtime_applications",applicationId:s.id,onSuccess:_,variant:1},null,8,["applicationId"])])):g("",!0),x(m,{to:{name:"MyOvertimeShow",params:{id:s.id}},class:"inline-flex h-9 w-9 items-center justify-center rounded-xl border border-gray-200 text-gray-700 hover:bg-gray-50",title:"View"},{default:st(()=>e[5]||(e[5]=[t("i",{class:"far fa-eye text-base"},null,-1)])),_:2,__:[5]},1032,["to"]),x(ut,{overtime:s,onSuccess:_},null,8,["overtime"])])])]))),128)),r.value.length===0?(i(),c("tr",Xt,e[6]||(e[6]=[t("td",{colspan:"100",class:"px-4 py-10 text-center"},[t("p",{class:"text-sm font-semibold text-gray-900"},"No overtimes found"),t("p",{class:"mt-1 text-xs text-gray-500"},"Try changing filters or date range.")],-1)]))):g("",!0)]),r.value.length?(i(),c("tfoot",Yt,[t("tr",Zt,[e[7]||(e[7]=t("td",{class:"px-3 py-2 text-right text-gray-700",colspan:"7"},"Totals",-1)),t("td",te,[x(k,{workingHours:C.value},null,8,["workingHours"])]),t("td",ee,[x(k,{workingHours:W.value},null,8,["workingHours"])]),t("td",se,[x(k,{workingHours:J.value},null,8,["workingHours"])]),e[8]||(e[8]=t("td",{class:"px-3 py-2 text-center text-gray-500"},"—",-1)),e[9]||(e[9]=t("td",{class:"px-3 py-2 text-center text-gray-500"},"—",-1)),e[10]||(e[10]=t("td",{class:"px-3 py-2 text-center text-gray-500"},"—",-1))])])):g("",!0)])])])])}}};export{ie as _};
