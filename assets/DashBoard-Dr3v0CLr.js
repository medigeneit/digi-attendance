const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LeaveApplicationModal-CGYFV9Rw.js","assets/index-BK8pOcb9.js","assets/index-HNKLGzA6.css","assets/ApprovalItem-UkoPtBif.js","assets/AcceptAndRejectHandler-BCAVxKA5.js","assets/LoaderView-BKEpNcb3.js","assets/ShareComponent-DBRH9sTM.js","assets/leave-application-kVKuBRnq.js","assets/LeaveApplicationModal-B7WJltA7.css","assets/ShortLeaveDetailsModal-WDxyoBIb.js","assets/ScreenshotCapture-BNoJF8h5.js","assets/html2canvas.esm-CBrSDip1.js","assets/short-leave-BaNPpqI3.js","assets/ShortLeaveDetailsModal-D4avNQ1k.css","assets/ManualAttendanceDetailsModal-B415Fhr9.js","assets/manual-attendance-BC1KoEfH.js","assets/ManualAttendanceDetailsModal-MS8n2gFL.css","assets/ShiftExchangeDetailsModal-xpA3Jluw.js","assets/exchange-DURQtff6.js","assets/ShiftExchangeDetailsModal-BlZsJzAI.css","assets/OffdayExchangeDetailsModal-CO2Eliz0.js","assets/OffdayExchangeDetailsModal-jTt80Glg.css"])))=>i.map(i=>d[i]);
import{g as ge,D as X,x as k,p as pe,c as i,o as r,d as _,m as w,a as e,b as $,t as p,n as D,E as Pe,r as R,h as _e,q as G,k as C,l as J,G as be,F as N,e as j,f as he,u as me,j as P,s as A,w as U,H as se,i as Fe,I as ie,J as Ue,K as oe}from"./index-BK8pOcb9.js";import{u as ae}from"./user-DdgTNtpL.js";import{_ as Ve}from"./SearchInput-BhLRZhms.js";import{g as Ye,a as Be}from"./datetime-y2WWmmYq.js";import{u as Ie}from"./useTaskStore-C4SLpED9.js";import{_ as Oe}from"./RequirementTaskList-uOtHvLmS.js";import{_ as We}from"./TodoSection-wXIfKdKU.js";import{O as He}from"./OverlyModal-BIOyVjVJ.js";import"./requirement-CJDzawPC.js";import"./LoaderView-BKEpNcb3.js";import"./DepartmentChip-Dz5iMsKE.js";import"./TaskTableRow-BL5X3yJ9.js";import"./TaskUrgentBadge-BH0WbBOh.js";import"./TaskTitle-RhYDZqTI.js";import"./TaskStatus-DJCOS5bh.js";import"./UserChip-Cxia_zN-.js";import"./TaskIsClosedBadge-ChP8oTAM.js";import"./TaskAddForm-ChF-v2AC.js";import"./RequiredIcon-BpR_ZwIo.js";import"./company-Do09JRBF.js";import"./CompanyDepartmentSelectInput-CzFG2QoM.js";import"./SelectDropdown-5Dh7l1-E.js";import"./SectionLoading-CuNnQvLZ.js";import"./TextEditor-BzLTCXbH.js";import"./TextWithHr-zjhYN8oh.js";import"./TaskUrgencyInput-BOVlq9ym.js";import"./TaskEditForm-DN71VIl_.js";import"./tags-C6wRBX5w.js";import"./TaskUserAssignForm-bE2JvEWC.js";import"./DraggableList.vue_vue_type_script_setup_true_lang-C0kbtJCf.js";import"./task-priority-DZLhLpCY.js";import"./useRequirementStore-Bc1I5NUw.js";import"./useTodoDateStore-D7pJDZuE.js";import"./url-Buz9GlSr.js";import"./TodoStatusIcon-EH2EK41-.js";import"./useTodoStore-CXCcFr2D.js";import"./TodoItemCard-1sf1XhYj.js";import"./TodoCreateEditShow-Cvj8w3j_.js";import"./useTodoProjectStore-BI0w7agZ.js";import"./TaskSelectionInput-BYgXWEUM.js";import"./todos-CHsG8mDp.js";const Ke={class:"grid gap-4 md:grid-cols-3 mt-4 px-4 container mx-auto"},ze={class:"text-3xl"},Ge={class:"text-3xl"},Je={class:"text-3xl"},Xe={class:"text-3xl"},Ze={class:"text-3xl"},Qe={class:"text-3xl"},et={class:"text-3xl"},tt={class:"text-3xl"},st={class:"text-3xl"},ot={class:"text-3xl"},at={class:"text-3xl"},nt={__name:"DashboardAdminView",setup(H){const y=ae();ge();const{dashboardInfo:x,selectedDate:M}=X(y),g=k(()=>new Date);return(b,c)=>{const m=pe("RouterLink");return r(),i("div",Ke,[_(m,{to:{name:"TodayAttendanceReport",query:{status:"all"}},class:"main-button"},{default:w(()=>{var n;return[e("span",ze,p((n=D(x))==null?void 0:n.totalUsers),1),c[0]||(c[0]=$(" Total Employees "))]}),_:1,__:[0]}),_(m,{to:{name:"TodayAttendanceReport",query:{status:"Present"}},class:"main-button"},{default:w(()=>{var n;return[e("span",Ge,p((n=D(x))==null?void 0:n.todayPresents),1),c[1]||(c[1]=$(" Today Present "))]}),_:1,__:[1]}),_(m,{to:{name:"TodayAttendanceReport",query:{status:"Absent"}},class:"main-button"},{default:w(()=>{var n;return[e("span",Je,p((n=D(x))==null?void 0:n.todayAbsents),1),c[2]||(c[2]=$(" Today Absent "))]}),_:1,__:[2]}),_(m,{to:{name:"LeaveApplicationsForDay",query:{applicationType:"today"}},class:"main-button"},{default:w(()=>{var n;return[e("span",Xe,p((n=D(x))==null?void 0:n.todayLeaves),1),c[3]||(c[3]=$(" Today Leave "))]}),_:1,__:[3]}),_(m,{to:{name:"LeaveApplicationsForDay",query:{applicationType:"tomorrow"}},class:"main-button"},{default:w(()=>{var n;return[e("span",Ze,p((n=D(x))==null?void 0:n.tomorrowLeaves),1),c[4]||(c[4]=$(" Tomorrow Leave "))]}),_:1,__:[4]}),_(m,{to:{name:"DateWiseShortLeaveList",query:{date:D(M)}},class:"main-button"},{default:w(()=>{var n;return[e("span",Qe,p((n=D(x))==null?void 0:n.todayShortLeaves),1),c[5]||(c[5]=$(" Today Short Leaves "))]}),_:1,__:[5]},8,["to"]),_(m,{to:{name:"DailyLateAttendanceReport",query:{date:D(M)}},class:"main-button"},{default:w(()=>{var n;return[e("span",et,p((n=D(x))==null?void 0:n.todayLateEntries),1),c[6]||(c[6]=$(" Today Late Report "))]}),_:1,__:[6]},8,["to"]),_(m,{to:{name:"PreviousAfterApplicationList",query:{applicationType:"prev",date:D(M)}},class:"main-button"},{default:w(()=>{var n;return[e("span",tt,p((n=D(x))==null?void 0:n.prevWeekLeaves),1),c[7]||(c[7]=$(" Leave history of previous week "))]}),_:1,__:[7]},8,["to"]),_(m,{to:{name:"PreviousAfterApplicationList",query:{applicationType:"after",date:D(M)}},class:"main-button"},{default:w(()=>{var n;return[e("span",st,p((n=D(x))==null?void 0:n.nextWeekLeaves),1),c[8]||(c[8]=$(" Upcoming leaves "))]}),_:1,__:[8]},8,["to"]),_(m,{to:{name:"TodoList",query:{day:g.value.getDate(),month:g.value.getMonth()+1,year:g.value.getFullYear(),type:"day-view"}},class:"main-button"},{default:w(()=>{var n;return[e("span",ot,p((n=D(x))==null?void 0:n.todayTotalTodos),1),c[9]||(c[9]=$(" Today Todos "))]}),_:1,__:[9]},8,["to"]),_(m,{to:{name:"TodoList",query:{month:g.value.getMonth()+1,year:g.value.getFullYear(),type:"month-view"}},class:"main-button"},{default:w(()=>{var n;return[e("span",at,p((n=D(x))==null?void 0:n.thisMonthTotalTodos),1),c[10]||(c[10]=$(" Todos In This Month "))]}),_:1,__:[10]},8,["to"]),_(m,{to:{name:"WeekLeaveHistories",query:{month:g.value.getMonth()+1,year:g.value.getFullYear(),type:"month-view"}},class:"main-button"},{default:w(()=>c[11]||(c[11]=[$(" Week Leave Histories ")])),_:1,__:[11]},8,["to"])])}}},lt={class:"bg-opacity-90 relative"},rt={class:"rounded-md z-20"},it={class:"flex justify-between items-center gap-6 w-full px-4 mt-4"},dt={class:"ml-auto flex items-center gap-2"},ut={key:0,class:"w-32 relative h-8"},ct={__name:"DailyTask",setup(H){const y=Pe({day:null,month:null,year:null}),x=R(),M=R(),g=R("loading"),b=Ie(),c=R(""),m=R("day-wise"),n=R("not-completed");_e(()=>{x.value=Ye(new Date),M.value=Be(new Date)}),G(x,L=>{const[v,o,s]=L.split("-").map(Number);y.day=s,y.month=o,y.year=v}),G(M,L=>{const[v,o]=L.split("-").map(Number);y.day=1,y.month=o,y.year=v}),G(()=>y.month,async()=>{g.value="loading",await h(),g.value=""}),G(m,L=>{if(L=="month-wise"){const[v,o]=x.value.split("-");M.value=`${v}-${o}`}});async function h(){await b.fetchMyTasks()}return(L,v)=>(r(),i("div",null,[e("div",lt,[e("div",rt,[e("div",it,[v[4]||(v[4]=e("div",{class:"text-blue-800 font-semibold text-lg"},"Task List",-1)),e("div",dt,[m.value=="day-wise"?(r(),i("div",ut,[v[3]||(v[3]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),J(e("select",{"onUpdate:modelValue":v[0]||(v[0]=o=>n.value=o),class:"h-8 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},v[2]||(v[2]=[e("option",{value:""},"--ALL TASKS--",-1),e("option",{value:"not-completed"},"Not Completed",-1),e("option",{value:"only-completed"},"Completed",-1)]),512),[[be,n.value]])])):C("",!0),_(Ve,{modelValue:c.value,"onUpdate:modelValue":v[1]||(v[1]=o=>c.value=o),class:"w-full md:w-48 md:ml-auto h-8","debounce-time":0},null,8,["modelValue"])])])]),_(Oe,{taskFilters:{status:n.value,search:c.value},showOnlyMyTasks:!0,class:"px-4 py-2 pb-4 !mt-0"},null,8,["taskFilters"])])]))}},pt={class:"bg-white shadow-md rounded-lg"},mt={class:"flex flex-wrap items-center justify-between gap-2 py-2 px-4"},yt={key:0,class:"flex items-center gap-2"},vt=["value"],ft={class:"overflow-x-auto shadow-md min-h-max"},xt={class:"min-w-full text-sm text-left text-gray-500 table-fixed"},gt={class:"text-xs"},_t={class:"text-sm font-semibold text-blue-800"},bt={__name:"DashboardLeaveBalance",setup(H){const y=ae(),{userDashboard:x}=X(y),M=R("all"),g=new Date().getFullYear(),b=k(()=>{var o;return((o=x.value)==null?void 0:o.leave_balance)??[]}),c=o=>Number.isInteger(o)&&o>=1990&&o<=g+1,m=o=>{if(!o||typeof o!="object")return null;const s=[o.year,o.leave_year,o.leaveYear];for(const l of s){const u=Number(l);if(c(u))return u}return null},n=o=>!o||typeof o!="object"?null:o.balances||o.items||o.leave_balance||null,h=k(()=>{const o=b.value,s=new Set;return Array.isArray(o)?o.forEach(l=>{const u=m(l);u&&s.add(u);const T=n(l);Array.isArray(T)&&(u&&s.add(u),T.forEach(V=>{const K=m(V);K&&s.add(K)}))}):o&&typeof o=="object"&&Object.keys(o).forEach(l=>{const u=Number(l);c(u)&&s.add(u)}),Array.from(s).sort((l,u)=>u-l)}),L=o=>Array.isArray(o)?o.some(s=>Array.isArray(n(s)))?o.flatMap(s=>n(s)||[]):o:o&&typeof o=="object"?Object.values(o).flatMap(s=>Array.isArray(s)?s:[]):[],v=k(()=>{const o=b.value,s=M.value;if(!o)return[];if(s==="all")return L(o);const l=Number(s);if(!c(l))return L(o);if(Array.isArray(o)){const u=o.find(T=>m(T)===l&&Array.isArray(n(T)));return u?n(u)||[]:o.filter(T=>m(T)===l)}if(typeof o=="object"){const u=o[String(l)];return Array.isArray(u)?u:[]}return[]});return(o,s)=>(r(),i("div",pt,[e("div",mt,[s[3]||(s[3]=e("h2",{class:"text-xl font-semibold"},"Leave Balance",-1)),h.value.length?(r(),i("div",yt,[s[2]||(s[2]=e("span",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wide"},"Year",-1)),J(e("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>M.value=l),class:"input-1 py-1 px-2 rounded text-xs font-semibold uppercase tracking-wide text-slate-500 border-slate-200 bg-slate-50"},[s[1]||(s[1]=e("option",{value:"all"},"All",-1)),(r(!0),i(N,null,j(h.value,l=>(r(),i("option",{key:l,value:l},p(l),9,vt))),128))],512),[[be,M.value]])])):C("",!0)]),e("div",ft,[e("table",xt,[e("thead",null,[e("tr",gt,[s[4]||(s[4]=e("th",{class:"px-2 py-1 font-semibold text-gray-900 border bg-gray-50"},null,-1)),(r(!0),i(N,null,j(v.value,l=>(r(),i("th",{class:"px-4 text-center py-1 font-semibold text-gray-900 border bg-gray-50 w-40",key:l.id||l.name||l.leave_type},p(l.name),1))),128))])]),e("tbody",null,[e("tr",null,[s[5]||(s[5]=e("td",{class:"px-4 py-4 font-medium text-gray-900 border text-xs"},"Total",-1)),(r(!0),i(N,null,j(v.value,l=>(r(),i("td",{class:"px-4 text-center py-3 font-medium text-gray-900 border",key:l.id||l.name||l.leave_type},p(l.annual_quota),1))),128))]),e("tr",null,[s[6]||(s[6]=e("td",{class:"px-4 py-3 font-medium text-gray-900 border text-xs"},"Used",-1)),(r(!0),i(N,null,j(v.value,l=>(r(),i("td",{class:"px-4 text-center py-4 font-medium text-gray-900 border",key:l.id||l.name||l.leave_type},p(l.used_days),1))),128))]),e("tr",_t,[s[7]||(s[7]=e("td",{class:"px-4 py-3 border text-xs"},"Balance",-1)),(r(!0),i(N,null,j(v.value,l=>(r(),i("td",{class:"px-4 text-center py-4 border",key:l.id||l.name||l.leave_type},p(l.remaining_days),1))),128))])])])])]))}},ht={class:"flex items-center gap-2 mr-2"},kt=["onClick"],wt=["onClick"],$t={__name:"DashboardMyTodoList",setup(H){const y=he(),x=me();function M(g){x.push({query:{...y.query,"todos[type]":g.type,"todos[year]":g.year,"todos[month]":g.month,"todos[day]":g.day}})}return(g,b)=>{const c=pe("RouterLink");return r(),P(We,{type:D(y).query["todos[type]"],year:D(y).query["todos[year]"],month:D(y).query["todos[month]"],day:D(y).query["todos[day]"],userRole:"employee",onChangeInput:M},{beforeHeader:w(()=>b[0]||(b[0]=[e("h2",{class:"text-md font-medium"},"Todo List",-1)])),typeSelection:w(({types:m,changeType:n,selected:h})=>{var L,v,o,s;return[e("div",ht,[e("button",{onClick:U(l=>{var u;return n((u=m[0])==null?void 0:u.value)},["prevent"]),class:A(["rounded text-sm h-[32px] w-20",(h==null?void 0:h.type)==((L=m[0])==null?void 0:L.value)?"btn-2":"btn-3"])},p((v=m[0])==null?void 0:v.label),11,kt),e("button",{onClick:U(l=>{var u;return n((u=m[1])==null?void 0:u.value)},["prevent"]),class:A(["rounded text-sm h-[32px] w-20",(h==null?void 0:h.type)==((o=m[1])==null?void 0:o.value)?"btn-2 ":"btn-3"])},p((s=m[1])==null?void 0:s.label),11,wt),_(c,{to:"/my-personal-activity-report",class:"inline-flex items-center gap-2 rounded-md border border-sky-300 px-3 h-[32px] text-sm text-sky-700 bg-sky-50 hover:bg-sky-100 dark:border-sky-800 dark:text-sky-200 dark:bg-sky-900/20 dark:hover:bg-sky-900/40"},{default:w(()=>b[1]||(b[1]=[e("i",{class:"fas fa-tasks"},null,-1),e("span",{class:"hidden lg:inline"},"Personal Activity Report (PAR)",-1),e("span",{class:"inline lg:hidden"},"PAR",-1)])),_:1,__:[1]})])]}),_:1},8,["type","year","month","day"])}}},Lt={class:"bg-white shadow-sm rounded-xl p-3 sm:p-4"},At=["aria-expanded"],Dt={class:"flex items-center gap-2"},Mt={class:"text-[11px] rounded-full bg-yellow-100 text-gray-700 px-2 py-0.5"},Tt={key:0,class:"text-xs italic text-center py-4 text-gray-500"},St={key:1,class:"py-2 space-y-1"},Ct=["onClick"],Rt={class:"min-w-0"},Et={class:"text-[13px] text-gray-900 truncate"},Nt={class:"font-medium"},jt={class:"opacity-70"},qt={class:"truncate max-w-[10rem]"},Pt={key:0,class:"inline-flex items-center gap-1 rounded-md border border-gray-200 bg-gray-50 px-1.5 py-0.5"},Ft={key:0,class:"flex justify-center"},Ut={class:"mt-4"},Vt=["aria-expanded"],Yt={class:"flex items-center gap-2"},Bt={class:"text-[11px] rounded-full bg-yellow-100 text-gray-700 px-2 py-0.5"},It={key:0,class:"text-xs italic text-center py-4 text-gray-500"},Ot={key:1,class:"py-2 space-y-1"},Wt=["onClick"],Ht={class:"min-w-0"},Kt={class:"text-[13px] text-gray-900 truncate"},zt={class:"font-medium"},Gt={class:"opacity-70"},Jt={key:0,class:"flex justify-center"},Xt={class:"mt-4"},Zt=["aria-expanded"],Qt={class:"flex items-center gap-2"},es={class:"text-[11px] rounded-full bg-yellow-100 text-gray-700 px-2 py-0.5"},ts={key:0,class:"text-xs italic text-center py-4 text-gray-500"},ss={key:1,class:"py-2 space-y-1"},os=["onClick"],as={class:"min-w-0"},ns={class:"text-[13px] text-gray-900 truncate"},ls={class:"font-medium"},rs={class:"opacity-70"},is={key:0,class:"flex justify-center"},ds={class:"mt-4"},us=["aria-expanded"],cs={class:"flex items-center gap-2"},ps={class:"text-[11px] rounded-full bg-yellow-100 text-gray-700 px-2 py-0.5"},ms={key:0,class:"text-xs italic text-center py-4 text-gray-500"},ys={key:1,class:"py-2 space-y-1"},vs=["onClick"],fs={class:"min-w-0"},xs={class:"text-[13px] text-gray-900 truncate"},gs={class:"font-medium"},_s={class:"opacity-70"},bs={key:0,class:"flex justify-center"},W=5,de="inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium",ue="flex items-center justify-between gap-2",hs="text-[12px] text-gray-600 flex items-center gap-2 flex-wrap",ce="block w-full text-left rounded-md px-2.5 py-2 hover:bg-slate-50/70 focus:bg-slate-50/90 focus:outline-none transition",ks={__name:"DashboardRecentApplications",setup(H){const y=se(()=>oe(()=>import("./LeaveApplicationModal-CGYFV9Rw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),x=se(()=>oe(()=>import("./ShortLeaveDetailsModal-WDxyoBIb.js"),__vite__mapDeps([9,1,2,3,4,5,10,11,6,12,13]))),M=se(()=>oe(()=>import("./ManualAttendanceDetailsModal-B415Fhr9.js"),__vite__mapDeps([14,1,2,3,4,5,6,15,16]))),g=se(()=>oe(()=>import("./ShiftExchangeDetailsModal-xpA3Jluw.js"),__vite__mapDeps([17,1,2,3,4,5,10,11,6,18,19]))),b=se(()=>oe(()=>import("./OffdayExchangeDetailsModal-CO2Eliz0.js"),__vite__mapDeps([20,1,2,3,4,5,10,11,6,18,21]))),c=ae(),{userDashboard:m}=X(c),n=k(()=>{var a;return((a=m.value)==null?void 0:a.lists)??{}}),h=k(()=>n.value.current_month_leave??[]),L=k(()=>n.value.short_leave??[]),v=k(()=>n.value.exchange??[]),o=k(()=>n.value.manual_attendance??[]),s=a=>a==="Pending"||a===null,l=k(()=>h.value.filter(a=>s(a==null?void 0:a.status)).length),u=k(()=>L.value.filter(a=>s(a==null?void 0:a.status)).length),T=k(()=>v.value.filter(a=>s(a==null?void 0:a.status)).length),V=k(()=>o.value.filter(a=>s(a==null?void 0:a.status)).length),K=k(()=>h.value.slice(0,W)),ne=k(()=>L.value.slice(0,W)),ke=k(()=>v.value.slice(0,W)),we=k(()=>o.value.slice(0,W)),ye=k(()=>Math.max(0,h.value.length-W)),ve=k(()=>Math.max(0,L.value.length-W)),fe=k(()=>Math.max(0,v.value.length-W)),xe=k(()=>Math.max(0,o.value.length-W)),$e={null:{title:"Handover Waiting",cls:"bg-gray-100 text-gray-800 ring-1 ring-gray-200"},Pending:{title:"Pending",cls:"bg-amber-50 text-amber-700 ring-1 ring-amber-200"},Approved:{title:"Approved",cls:"bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200"},Rejected:{title:"Rejected",cls:"bg-rose-50 text-rose-700 ring-1 ring-rose-200"}},Y=a=>$e[a??"null"]??{title:String(a||"Unknown"),cls:"bg-gray-100 text-gray-700 ring-1 ring-gray-200"},Le=a=>Array.isArray(a)?a.filter(t=>t==null?void 0:t.name).map(t=>`${t.name} (${(t==null?void 0:t.days)??0})`).join(", "):"",Z=R({open:!1,id:null}),Q=R({open:!1,id:null}),ee=R({open:!1,id:null}),Ae=a=>{Z.value={open:!0,id:a}},De=a=>{Q.value={open:!0,id:a}},Me=a=>{ee.value={open:!0,id:a}},B=R({open:!1,id:null,type:null}),Te=a=>{const t=(a==null?void 0:a.exchange_type)==="offday"?"offday":"shift";B.value={open:!0,id:a.id,type:t}},Se=k(()=>B.value.type==="offday"?b:g),Ce=k(()=>`${B.value.type||"x"}-${B.value.id||"x"}`);function Re(a){if(!a)return null;const t=String(a).trim();let f=t.match(/^(\d{4})-(\d{2})-(\d{2})$/);return f?new Date(+f[1],+f[2]-1,+f[3],0,0,0):(f=t.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?$/),f?new Date(+f[1],+f[2]-1,+f[3],+f[4],+f[5],+(f[6]||0)):null)}function I(a){const t=Re(a);return t?t.toLocaleDateString(void 0,{day:"2-digit",month:"short",year:"numeric"}):""}function Ee(a){const t=String(a||"").match(/^(\d{4})-(\d{2})-(\d{2})$/);return t?new Date(+t[1],+t[2]-1,+t[3],0,0,0):null}function Ne(a,t){const f=new Date(a);return f.setDate(f.getDate()+t),f}function je(a,t){return a&&t&&a.getFullYear()===t.getFullYear()&&a.getMonth()===t.getMonth()&&a.getDate()===t.getDate()}function le(a){const t=a.getFullYear(),f=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0");return`${t}-${f}-${d}`}function qe(a){const t=Array.isArray(a)?a.slice():[],f=S=>Array.from(new Set(S)).sort(),d=f(t.filter(S=>(S==null?void 0:S.leave_type_id)!=="weekend").map(S=>S.date).filter(Boolean)),q=f(t.filter(S=>(S==null?void 0:S.leave_type_id)==="weekend").map(S=>S.date).filter(Boolean)),F=[];let O=null,z=null;for(const S of d){const te=Ee(S);if(te){if(!O){O=z=te;continue}je(Ne(z,1),te)?z=te:(F.push({from:le(O),to:le(z)}),O=z=te)}}return O&&z&&F.push({from:le(O),to:le(z)}),{ranges:F,weekends:q,leaveCount:d.length}}const E=R({apps:!!l.value,short:!!u.value,exch:!!T.value,manual:!!V.value}),re=a=>{E.value[a]=!E.value[a]};return(a,t)=>{const f=pe("RouterLink");return r(),i("div",Lt,[e("section",null,[e("header",{class:"flex items-center justify-between mb-1 cursor-pointer select-none",role:"button","aria-expanded":E.value.apps,onClick:t[1]||(t[1]=d=>re("apps")),tabindex:"0"},[t[14]||(t[14]=Fe('<div class="flex items-center gap-2"><i class="fas fa-file text-gray-600"></i><h2 class="text-sm font-semibold text-gray-900"> Applications <span class="ml-2 align-middle text-[10px] sm:text-[11px] inline-flex items-center gap-1 rounded-full bg-blue-50 text-blue-700 px-2 py-0.5"><i class="far fa-clock"></i> Latest </span></h2></div>',1)),e("div",Dt,[e("span",Mt,p(l.value),1),_(f,{to:{name:"MyLeaveApplications"},class:"text-[11px] text-blue-700 hover:underline",onClick:t[0]||(t[0]=U(()=>{},["stop"]))},{default:w(()=>t[13]||(t[13]=[$(" See all ")])),_:1,__:[13]}),e("i",{class:A(["fas fa-chevron-down text-gray-600 transition-transform duration-200",E.value.apps?"rotate-180":""])},null,2)])],8,At),J(e("div",null,[t[17]||(t[17]=e("hr",{class:"border-gray-100"},null,-1)),h.value.length===0?(r(),i("div",Tt,"No applications")):(r(),i("div",St,[(r(!0),i(N,null,j(K.value,d=>(r(),i("button",{key:d.id,class:A(ce),onClick:q=>Ae(d.id)},[e("div",{class:A(ue)},[e("div",Rt,[e("div",Et,[e("span",Nt,"#"+p(d.id),1),e("span",jt," – "+p(Le(d.leave_type_counts)||"—"),1)]),e("div",{class:A(hs)},[(r(!0),i(N,null,j([qe(d.json_data)],q=>(r(),i(N,{key:"info-"+d.id},[q.leaveCount>1?(r(!0),i(N,{key:0},j(q.ranges,(F,O)=>(r(),i("span",{key:O,class:"inline-flex items-center gap-1 rounded-md border border-gray-200 bg-gray-50 px-1.5 py-0.5"},[t[15]||(t[15]=e("i",{class:"far fa-calendar-minus"},null,-1)),e("span",qt,p(F.from!==F.to?I(F.from)+" – "+I(F.to):I(F.from)),1)]))),128)):(r(),i(N,{key:1},[q.ranges[0]?(r(),i("span",Pt,[t[16]||(t[16]=e("i",{class:"far fa-calendar-day"},null,-1)),e("span",null,p(I(q.ranges[0].from)),1)])):C("",!0)],64))],64))),128))])]),e("span",{class:A([de,Y(d.status).cls])},p(Y(d.status).title),3)])],8,Ct))),128)),ye.value?(r(),i("div",Ft,[_(f,{to:{name:"MyLeaveApplications"},class:"text-[12px] text-blue-700 hover:underline"},{default:w(()=>[$(" + "+p(ye.value)+" more ",1)]),_:1})])):C("",!0)]))],512),[[ie,E.value.apps]])]),e("section",Ut,[e("header",{class:"flex items-center justify-between mb-1 cursor-pointer select-none",role:"button","aria-expanded":E.value.short,onClick:t[3]||(t[3]=d=>re("short")),tabindex:"0"},[t[19]||(t[19]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-walking text-gray-600"}),e("h2",{class:"text-sm font-semibold text-gray-900"},"Short Leave")],-1)),e("div",Yt,[e("span",Bt,p(u.value),1),_(f,{to:{name:"MyShortLeaves"},class:"text-[11px] text-blue-700 hover:underline",onClick:t[2]||(t[2]=U(()=>{},["stop"]))},{default:w(()=>t[18]||(t[18]=[$(" See all ")])),_:1,__:[18]}),e("i",{class:A(["fas fa-chevron-down text-gray-600 transition-transform duration-200",E.value.short?"rotate-180":""])},null,2)])],8,Vt),J(e("div",null,[t[20]||(t[20]=e("hr",{class:"border-gray-100"},null,-1)),L.value.length===0?(r(),i("div",It,"No short leave")):(r(),i("div",Ot,[(r(!0),i(N,null,j(ne.value,d=>(r(),i("button",{key:d.id,class:A(ce),onClick:q=>De(d.id)},[e("div",{class:A(ue)},[e("div",Ht,[e("div",Kt,[e("span",zt,p(I(d.date)),1),e("span",Gt," – "+p(d.type||"—"),1)])]),e("span",{class:A([de,Y(d.status).cls])},p(Y(d.status).title),3)])],8,Wt))),128)),ve.value?(r(),i("div",Jt,[_(f,{to:{name:"MyShortLeaves"},class:"text-[12px] text-blue-700 hover:underline"},{default:w(()=>[$(" + "+p(ve.value)+" more ",1)]),_:1})])):C("",!0)]))],512),[[ie,E.value.short]])]),e("section",Xt,[e("header",{class:"flex items-center justify-between mb-1 cursor-pointer select-none",role:"button","aria-expanded":E.value.exch,onClick:t[6]||(t[6]=d=>re("exch")),tabindex:"0"},[t[23]||(t[23]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-exchange-alt text-gray-600"}),e("h2",{class:"text-sm font-semibold text-gray-900"},"Exchange")],-1)),e("div",Qt,[e("span",es,p(T.value),1),_(f,{to:{name:"MyShiftExchangeList"},class:"text-[11px] text-blue-700 hover:underline",onClick:t[4]||(t[4]=U(()=>{},["stop"]))},{default:w(()=>t[21]||(t[21]=[$(" Shift ")])),_:1,__:[21]}),_(f,{to:{name:"MyOffdayExchangeList"},class:"text-[11px] text-blue-700 hover:underline",onClick:t[5]||(t[5]=U(()=>{},["stop"]))},{default:w(()=>t[22]||(t[22]=[$(" Offday ")])),_:1,__:[22]}),e("i",{class:A(["fas fa-chevron-down text-gray-600 transition-transform duration-200",E.value.exch?"rotate-180":""])},null,2)])],8,Zt),J(e("div",null,[t[24]||(t[24]=e("hr",{class:"border-gray-100"},null,-1)),v.value.length===0?(r(),i("div",ts,"No exchange")):(r(),i("div",ss,[(r(!0),i(N,null,j(ke.value,d=>(r(),i("button",{key:d.id,class:A(ce),onClick:q=>Te(d)},[e("div",{class:A(ue)},[e("div",as,[e("div",ns,[e("span",ls,p(I(d.current_date)),1),e("span",rs," – "+p(d.exchange_type||"—"),1)])]),e("span",{class:A([de,Y(d.status).cls])},p(Y(d.status).title),3)])],8,os))),128)),fe.value?(r(),i("div",is,[_(f,{to:{name:"MyShiftExchangeList"},class:"text-[12px] text-blue-700 hover:underline"},{default:w(()=>[$(" + "+p(fe.value)+" more ",1)]),_:1})])):C("",!0)]))],512),[[ie,E.value.exch]])]),e("section",ds,[e("header",{class:"flex items-center justify-between mb-1 cursor-pointer select-none",role:"button","aria-expanded":E.value.manual,onClick:t[8]||(t[8]=d=>re("manual")),tabindex:"0"},[t[26]||(t[26]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-user-check text-gray-600"}),e("h2",{class:"text-sm font-semibold text-gray-900"},"Manual Attendance")],-1)),e("div",cs,[e("span",ps,p(V.value),1),_(f,{to:{name:"MyManualAttendanceList"},class:"text-[11px] text-blue-700 hover:underline",onClick:t[7]||(t[7]=U(()=>{},["stop"]))},{default:w(()=>t[25]||(t[25]=[$(" See all ")])),_:1,__:[25]}),e("i",{class:A(["fas fa-chevron-down text-gray-600 transition-transform duration-200",E.value.manual?"rotate-180":""])},null,2)])],8,us),J(e("div",null,[t[27]||(t[27]=e("hr",{class:"border-gray-100"},null,-1)),o.value.length===0?(r(),i("div",ms,"No manual application")):(r(),i("div",ys,[(r(!0),i(N,null,j(we.value,d=>(r(),i("button",{key:d.id,class:A(ce),onClick:q=>Me(d.id)},[e("div",{class:A(ue)},[e("div",fs,[e("div",xs,[e("span",gs,p(d.check_in?I(d.check_in):I(d.check_out)),1),e("span",_s," – "+p(d.type||"—"),1)])]),e("span",{class:A([de,Y(d.status).cls])},p(Y(d.status).title),3)])],8,vs))),128)),xe.value?(r(),i("div",bs,[_(f,{to:{name:"MyManualAttendanceList"},class:"text-[12px] text-blue-700 hover:underline"},{default:w(()=>[$(" + "+p(xe.value)+" more ",1)]),_:1})])):C("",!0)]))],512),[[ie,E.value.manual]])]),Z.value.open?(r(),P(D(y),{key:0,open:Z.value.open,"onUpdate:open":t[9]||(t[9]=d=>Z.value.open=d),id:Z.value.id},null,8,["open","id"])):C("",!0),Q.value.open?(r(),P(D(x),{key:1,open:Q.value.open,"onUpdate:open":t[10]||(t[10]=d=>Q.value.open=d),id:Q.value.id},null,8,["open","id"])):C("",!0),ee.value.open?(r(),P(D(M),{key:2,open:ee.value.open,"onUpdate:open":t[11]||(t[11]=d=>ee.value.open=d),id:ee.value.id},null,8,["open","id"])):C("",!0),B.value.open?(r(),P(Ue(Se.value),{key:Ce.value,open:B.value.open,"onUpdate:open":t[12]||(t[12]=d=>B.value.open=d),id:B.value.id},null,40,["open","id"])):C("",!0)])}}},ws={class:"bg-white shadow-sm rounded-xl p-3"},$s={class:"flex items-center justify-between"},Ls={key:0,class:"text-[11px] text-gray-500"},As={class:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full bg-blue-50 text-blue-700"},Ds={key:0,class:"text-xs italic text-center py-6 text-gray-500"},Ms={key:1,class:"space-y-2"},Ts={class:"flex items-start gap-3 min-w-0"},Ss={class:"min-w-0"},Cs={class:"text-sm font-medium text-gray-900 truncate"},Rs={class:"text-[11px] text-gray-500 mt-0.5"},Es={class:"text-base font-semibold text-gray-800 flex items-center gap-2 p-3"},Ns={class:"space-y-4 px-3 pb-4"},js={class:"text-xs text-gray-500 flex items-center gap-2"},qs={class:"flex justify-end gap-2 mt-2"},Ps={__name:"DashboardRecentNotices",setup(H){const y=ae(),{userDashboard:x}=X(y),M=me(),g=o=>{if(!o)return"—";const s=new Date(o);return isNaN(+s)?o:new Intl.DateTimeFormat(void 0,{day:"2-digit",month:"short",year:"numeric"}).format(s)},b=o=>{if(!o)return"";const s=new Date(o);if(isNaN(+s))return"";const l=(Date.now()-s.getTime())/1e3,u=new Intl.RelativeTimeFormat(void 0,{numeric:"auto"}),T=[["year",60*60*24*365],["month",60*60*24*30],["week",60*60*24*7],["day",60*60*24],["hour",60*60],["minute",60],["second",1]];for(const[V,K]of T){const ne=Math.round(l/K);if(Math.abs(ne)>=1)return u.format(-ne,V)}return u.format(0,"second")},c=o=>{const s=g(o),l=b(o);return l?`${s} · ${l}`:s},m=k(()=>{var o;return((o=x.value)==null?void 0:o.notices)??[]}),n=k(()=>[...m.value].sort((s,l)=>{const u=s!=null&&s.user_feedback?1:0,T=l!=null&&l.user_feedback?1:0;if(u!==T)return u-T;const V=new Date((s==null?void 0:s.published_at)||0).getTime();return new Date((l==null?void 0:l.published_at)||0).getTime()-V})),h=k(()=>n.value.find(o=>!(o!=null&&o.user_feedback))||null),L=R(!!h.value);G(h,o=>{L.value=!!o});const v=o=>{const s=o||h.value;if(!s)return;const l=s.type===1?`/notice-details/${s.id}`:`/policy-details/${s.id}`;M.push(l)};return(o,s)=>{const l=pe("RouterLink");return r(),i("div",ws,[e("div",$s,[s[4]||(s[4]=e("div",{class:"flex items-center gap-1.5"},[e("i",{class:"fas fa-bell"}),e("h2",{class:"text-base font-semibold"},"Notices")],-1)),n.value.length?(r(),i("div",Ls,[e("span",As,[s[3]||(s[3]=e("span",{class:"h-1.5 w-1.5 rounded-full bg-blue-500"},null,-1)),$(" "+p(n.value.filter(u=>!u.user_feedback).length)+" pending ",1)])])):C("",!0)]),s[10]||(s[10]=e("hr",{class:"my-2 border-gray-200"},null,-1)),n.value.length?(r(),i("div",Ms,[(r(!0),i(N,null,j(n.value,u=>(r(),i("article",{key:u.id,class:"group flex items-center justify-between gap-2 p-3 border border-gray-100 rounded-lg hover:border-blue-200 transition"},[e("div",Ts,[e("span",{class:A(["inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full text-[10px] font-medium mt-0.5",u.user_feedback?"bg-emerald-50 text-emerald-700":"bg-rose-50 text-rose-700"])},[e("span",{class:A(["h-2 w-2 rounded-full",u.user_feedback?"bg-emerald-600":"bg-rose-600 animate-pulse"])},null,2)],2),e("div",Ss,[e("h3",Cs,p(u.title||"Untitled notice"),1),e("p",Rs,[s[5]||(s[5]=e("i",{class:"fas fa-calendar-alt text-gray-400 mr-1"},null,-1)),$(" "+p(c(u.published_at)),1)])])]),_(l,{to:u.type===1?`/notice-details/${u.id}`:`/policy-details/${u.id}`,class:"shrink-0 inline-flex items-center gap-1 text-blue-600 hover:text-blue-700 text-xs font-semibold"},{default:w(()=>s[6]||(s[6]=[$(" View "),e("i",{class:"fas fa-arrow-right text-[10px]"},null,-1)])),_:2,__:[6]},1032,["to"])]))),128))])):(r(),i("div",Ds," No pending notice found ")),h.value?(r(),P(He,{key:2,show:L.value,onClose:s[2]||(s[2]=u=>L.value=!1)},{default:w(()=>[e("div",Es,[s[7]||(s[7]=e("i",{class:"fas fa-bell text-blue-600"},null,-1)),$(" "+p(h.value.title||"New notice"),1)]),e("div",Ns,[e("p",js,[s[8]||(s[8]=e("i",{class:"fas fa-calendar-alt text-gray-400"},null,-1)),$(" Published: "+p(c(h.value.published_at)),1)]),s[9]||(s[9]=e("p",{class:"text-sm text-gray-700"}," You must read this notice before proceeding. ",-1)),e("div",qs,[e("button",{onClick:s[0]||(s[0]=u=>L.value=!1),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-3 py-1.5 rounded-md transition text-sm"}," Later "),e("button",{onClick:s[1]||(s[1]=u=>v(h.value)),class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-1.5 rounded-md transition text-sm"}," Read ")])])]),_:1},8,["show"])):C("",!0)])}}},Fs={class:"w-full px-6 py-4"},Us={class:"grid lg:grid-cols-4 gap-6 items-start"},Vs={class:"gap-0 rounded-md bg-white shadow-md border border-gray-300 col-span-full lg:col-span-3 lg:row-span-2"},Ys={class:"flex items-center justify-center gap-4 py-2 border-b bg-gray-50 rounded-t-md"},Bs={class:"col-span-full lg:col-span-1 grid sm:grid-cols-2 lg:grid-cols-1 gap-6 sticky top-[80px]"},Is={class:"card-bg gap-0 shadow-md border border-gray-300"},Os={class:"card-bg gap-0 shadow-md border border-gray-300"},Ws={class:"card-bg gap-0 shadow-md border border-gray-300"},Hs={__name:"DashboardEmployeeView",setup(H){const y=R("todos"),x=he(),M=me();return G(()=>y.value,function(g){g!=="todos"&&M.replace({query:Object.keys(x.query).filter(b=>!b.match(/^todos\[/)).reduce((b,c)=>(b[c]=x.query[c],b),{})})}),(g,b)=>(r(),i("div",Fs,[e("div",Us,[e("div",Vs,[e("div",Ys,[e("button",{onClick:b[0]||(b[0]=U(c=>y.value="todos",["prevent"])),class:A(["!py-0.5 text-sm",{"btn-2":y.value=="todos","btn-3 hover:bg-gray-200 hover:text-blue-500":y.value!="todos"}])}," Todos ",2),e("button",{onClick:b[1]||(b[1]=U(c=>y.value="tasks",["prevent"])),class:A(["!py-0.5 text-sm",{"btn-2":y.value=="tasks","btn-3 hover:bg-gray-200 hover:text-blue-500":y.value!="tasks"}])}," Tasks ",2)]),y.value=="todos"?(r(),P($t,{key:0})):C("",!0),y.value=="tasks"?(r(),P(ct,{key:1})):C("",!0)]),e("div",Bs,[e("div",Is,[_(ks)]),e("div",Os,[_(Ps)]),e("div",Ws,[_(bt)])])])]))}},jo={__name:"DashBoard",setup(H){const y=ge(),x=ae(),{userDashboard:M}=X(x),{user:g}=X(y),b=k(()=>{var m;return["admin","super_admin","developer"].includes((m=g==null?void 0:g.value)==null?void 0:m.role)}),c=R(null);return _e(async()=>{var n,h;g.value||await y.fetchUser(),await x.fetchUserDashboardData(),b.value&&await x.fetchAdminDashboardData();const m=(h=(n=M.value)==null?void 0:n.notices)==null?void 0:h.find(L=>!L.user_feedback);m&&(c.value=m)}),(m,n)=>b.value&&D(y).isAdminMood?(r(),P(nt,{key:0})):(r(),P(Hs,{key:1}))}};export{jo as default};
