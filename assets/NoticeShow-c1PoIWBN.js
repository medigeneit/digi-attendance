import{L as z}from"./LoaderView-D4jYkAUf.js";import{_ as Q}from"./ShareComponent-BPqqsNuy.js";import{u as P}from"./notice-DbQTx7G9.js";import{r as _,s as G,x as J,z as K,b as q,o,c as a,a as e,d as O,v as W,h as E,F as N,q as F,t as l,e as H,i as X,j as Y,l as k,m as R,n as Z,k as U,f as ee}from"./index-gSCgywm9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"space-y-6"},se={class:"flex justify-center"},oe={class:"bg-white rounded-lg shadow-md p-6 space-y-4"},ae={key:0,class:"text-center text-gray-500"},ne={key:1},le={key:0,class:"divide-y"},re={class:"flex-shrink-0"},ie={class:"h-10 w-10 rounded-full bg-blue-500 text-white flex items-center justify-center font-bold"},de={class:"flex-1"},ce={class:"text-gray-800 font-semibold"},ue={class:"text-gray-600 text-sm mt-1"},pe={class:"text-gray-400 text-xs"},ve={key:1,class:"text-center text-gray-400 italic"},ge={key:2,class:"flex justify-center mt-6"},ye=20,me={__name:"NoticeFeedbackList",props:{noticeId:{type:[String,Number],required:!0}},setup(D){const b=P();function w(g,r=300){let n;return function(...y){clearTimeout(n),n=setTimeout(()=>{g.apply(this,y)},r)}}const L=D,s=_(""),p=_(1),i=_(!1),{feedbacks:v,totalFeedbacks:$}=G(b),x=async(g=!1)=>{try{i.value=!0,g&&(v.value=[],p.value=1),console.log("sdf"),await b.fetchFeedbacks(L.noticeId,{params:{page:p.value,per_page:ye,search:s.value}})}catch(r){console.error("Error fetching feedbacks:",r)}finally{i.value=!1}},d=J(()=>v.value.length<$.value),t=()=>{d.value&&(p.value++,x())},u=w(()=>{x(!0)},400);return K(s,()=>{u()}),q(()=>{x()}),(g,r)=>(o(),a("div",te,[e("div",se,[O(e("input",{"onUpdate:modelValue":r[0]||(r[0]=n=>s.value=n),type:"text",placeholder:"Search by User Name...",class:"border border-gray-300 rounded-lg p-2 w-full max-w-md focus:outline-none focus:ring-2 focus:ring-blue-400"},null,512),[[W,s.value]])]),e("div",oe,[r[1]||(r[1]=e("h3",{class:"title-md text-center mb-4"},"User Feedbacks",-1)),i.value?(o(),a("div",ae,"Loading...")):(o(),a("div",ne,[E(v).length?(o(),a("div",le,[(o(!0),a(N,null,F(E(v),n=>{var y,f;return o(),a("div",{key:n.id,class:"py-4 flex items-start gap-4"},[e("div",re,[e("div",ie,l(n.user.name.charAt(0)),1)]),e("div",de,[e("p",ce,l(n.user.name)+" ("+l((f=(y=n==null?void 0:n.user)==null?void 0:y.department)==null?void 0:f.name)+") ",1),e("p",ue,l(n.feedback),1)]),e("div",pe,l(new Date(n.created_at).toLocaleDateString()),1)])}),128))])):(o(),a("div",ve,"No feedbacks found.")),d.value&&!i.value?(o(),a("div",ge,[e("button",{onClick:t,class:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg"}," Load More ")])):H("",!0)]))])]))}},_e={class:"my-container space-y-6"},xe={class:"card-bg p-6"},fe={key:1,class:"text-center text-red-500"},he={key:2,class:"grid gap-2"},be={class:"bg-gray-100 p-4 rounded-lg"},ke={class:"grid md:grid-cols-2 gap-4"},we={class:"text-sm text-gray-800"},Le={key:0,class:"text-gray-800 text-sm"},$e={key:1,class:"text-lg text-gray-800"},Ne={key:0,class:"text-gray-800"},Fe={key:1,class:"text-gray-800"},De={class:"text-gray-800"},Se={class:"text-gray-800"},Te={class:"col-span-full"},Ae=["innerHTML"],Me={class:"flex justify-center mt-2 gap-4"},Ee={__name:"NoticeShow",setup(D){const b=P(),w=X(),L=ee(),s=_(null),p=_(!0),i=_(null),v=d=>new Date(d).toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0}),$=async()=>{var d,t;try{p.value=!0,i.value=null;const u=L.params.id;s.value=await b.fetchNotice(u)}catch(u){i.value=((t=(d=u.response)==null?void 0:d.data)==null?void 0:t.message)||"Failed to load notice details",w.error(i.value)}finally{p.value=!1}};q(async()=>{await $()});const x=async d=>{window.open(d,"_blank")};return(d,t)=>{var g,r,n,y,f,S,T,A,M,B,C,I,V,j;const u=Z("RouterLink");return o(),a("div",_e,[e("div",xe,[t[12]||(t[12]=e("h2",{class:"title-lg text-center"},"Notice Details",-1)),p.value?(o(),Y(z,{key:0,class:"shadow-none"})):i.value?(o(),a("div",fe,[e("p",null,l(i.value),1)])):(o(),a("div",he,[e("div",be,[t[8]||(t[8]=e("p",{class:"title-md"},"Notice Info",-1)),t[9]||(t[9]=e("hr",{class:"mb-2"},null,-1)),e("div",ke,[e("div",null,[t[1]||(t[1]=e("p",{class:"font-bold text-gray-600"},"Title:",-1)),e("p",we,l((g=s.value)==null?void 0:g.title),1)]),e("div",null,[t[2]||(t[2]=e("p",{class:"font-bold text-gray-600"},"Company:",-1)),Array.isArray((r=s.value)==null?void 0:r.companies_notice)&&((y=(n=s.value)==null?void 0:n.companies_notice)!=null&&y.length)?(o(),a("p",Le,[(o(!0),a(N,null,F((f=s.value)==null?void 0:f.companies_notice,(c,m)=>{var h;return o(),a("span",{key:c.id},l(c==null?void 0:c.name)+" "+l(m<((h=s.value)==null?void 0:h.companies_notice.length)-1?", ":""),1)}),128))])):(o(),a("p",$e,"All department"))]),e("div",null,[t[3]||(t[3]=e("p",{class:"font-bold text-gray-600"},"Department:",-1)),Array.isArray((S=s.value)==null?void 0:S.departments)&&((A=(T=s.value)==null?void 0:T.departments)!=null&&A.length)?(o(),a("p",Ne,[(o(!0),a(N,null,F((M=s.value)==null?void 0:M.departments,(c,m)=>{var h;return o(),a("span",{key:c.id},l(c==null?void 0:c.name)+" "+l(m<((h=s.value)==null?void 0:h.departments.length)-1?", ":""),1)}),128))])):(o(),a("p",Fe,"All department"))]),e("div",null,[t[4]||(t[4]=e("p",{class:"font-bold text-gray-600"},"Published Date:",-1)),e("p",De,l(v((B=s.value)==null?void 0:B.published_at)),1)]),e("div",null,[t[5]||(t[5]=e("p",{class:"font-bold text-gray-600"},"Expired Date:",-1)),e("p",Se,l(v((C=s.value)==null?void 0:C.expired_at)),1)]),e("div",null,[t[6]||(t[6]=e("p",{class:"text-sm font-bold text-gray-600 mb-2"},"File:",-1)),(I=s.value)!=null&&I.file?(o(),a("button",{key:0,onClick:t[0]||(t[0]=c=>{var m;return x((m=s.value)==null?void 0:m.file)}),class:"btn-2"}," Download File ")):H("",!0)]),e("div",Te,[t[7]||(t[7]=e("p",{class:"font-bold text-gray-600"},"Description / Body:",-1)),e("p",{class:"text-gray-800",innerHTML:(V=s.value)==null?void 0:V.description},null,8,Ae)])])]),k(me,{noticeId:s.value.id},null,8,["noticeId"]),k(Q),e("div",Me,[k(u,{to:{name:"NoticeList"},type:"button",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:R(()=>t[10]||(t[10]=[U(" Back to List ")])),_:1}),k(u,{to:{name:"NoticeEdit",params:{id:(j=s.value)==null?void 0:j.id}},class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},{default:R(()=>t[11]||(t[11]=[U(" Edit ")])),_:1},8,["to"])])]))])])}}};export{Ee as default};
