import{u as G,f as H,r as m,x as I,D as T,h as Y,q as U,p as z,c as d,o as i,a as t,d as _,l as A,k as J,m as u,H as K,j as M,F as Q,e as W,t as n}from"./index-C3L4IOIC.js";import{_ as X}from"./EmployeeFilter-BSe8J9vo.js";import{L as Z}from"./LoaderView-Cp1TO_QD.js";import{_ as ee}from"./FlexibleDatePicker-DwaqEn4Z.js";import{u as te}from"./exchange-JrjoWMVs.js";import{u as re}from"./user-D9ddlRQz.js";import"./company-CP65sRAO.js";import"./department-DAsYotCg.js";import"./EmployeeDropdownInput-DYG1tSwS.js";import"./SelectDropdown-DrXUPLC2.js";import"./UserChip-B8yDark8.js";const oe={class:"space-y-2 px-4"},se={class:"flex flex-wrap gap-2 p-3 rounded-2xl border border-white/20 bg-white/60 backdrop-blur-md shadow-sm supports-[backdrop-filter]:bg-white/50 sticky top-14"},le={key:0,class:"text-center py-4"},ae={key:1,class:"space-y-4"},de={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},ie={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},pe={class:"border border-gray-300 px-2 text-center"},ue={class:"border border-gray-300 px-2 text-center"},ye={class:"border border-gray-300 px-2"},me={class:"border border-gray-300 px-2"},_e={class:"border border-gray-300 px-2 text-center"},ce=["href"],fe={class:"border border-gray-300 px-2"},be={class:"border border-gray-300 px-2"},ve={class:"flex gap-2"},we=["onClick"],Se={key:0},N="shift",Be={__name:"ShiftExchangeList",setup(ke){const c=G(),a=H(),l=te(),v=re(),V=m(null),f=a.query.date||l.selectedMonth||new Date().toISOString().slice(0,7),b=m(f),w=new Date,B=s=>s.toString().padStart(2,"0"),p=m({year:Number(f.split("-")[0]||w.getFullYear()),month:Number(f.split("-")[1]||w.getMonth()+1),day:1}),L=I(()=>{var s,r;return!((s=p.value)!=null&&s.year)||!((r=p.value)!=null&&r.month)?"":`${p.value.year}-${B(p.value.month)}`}),{loading:R}=T(l),o=m({company_id:a.query.company_id||"",department_id:a.query.department_id||"all",line_type:a.query.line_type||"all",type:a.query.type||"all",employee_id:a.query.employee_id||"",line_type:""});Y(async()=>{R.value=!0,await v.fetchUsers(),V.value=v.users.find(s=>{var r;return s.id==((r=a==null?void 0:a.query)==null?void 0:r.employee_id)}),await y()});const y=async()=>{o.value.employee_id?await l.fetchAllExchanges({company_id:o.value.company_id,department_id:o.value.department_id,user_id:o.value.employee_id,line_type:o.value.line_type,type:N,selectedMonth:b.value,selectedStatus:l.selectedStatus}):await l.fetchAllExchanges({company_id:o.value.company_id,department_id:o.value.department_id,line_type:o.value.line_type,type:N,selectedMonth:b.value,selectedStatus:l.selectedStatus})};U(()=>[o.value.company_id,o.value.department_id,o.value.employee_id,o.value.line_type],async()=>{await y()}),U(L,s=>{s&&(b.value=s,c.replace({query:{...a.query,date:s}}),y())},{immediate:!0});const $=()=>{c.go(-1)},F=async s=>{confirm("Are you sure to delete this application?")&&l.deleteExchange(s)},j=()=>{c.replace({query:{...a.query,company_id:o.value.company_id,department_id:o.value.department_id,line_type:o.value.line_type,employee_id:o.value.employee_id}})},S=s=>s?new Date(s).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"";return(s,r)=>{var k,h,g;const O=z("RouterLink");return i(),d("div",oe,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:$},r[6]||(r[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),r[7]||(r[7]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Shift Exchanges",-1)),r[8]||(r[8]=t("div",null,null,-1))]),t("div",se,[_(X,{company_id:o.value.company_id,"onUpdate:company_id":r[1]||(r[1]=e=>o.value.company_id=e),department_id:o.value.department_id,"onUpdate:department_id":r[2]||(r[2]=e=>o.value.department_id=e),employee_id:o.value.employee_id,"onUpdate:employee_id":r[3]||(r[3]=e=>o.value.employee_id=e),line_type:o.value.line_type,"onUpdate:line_type":r[4]||(r[4]=e=>o.value.line_type=e),"with-type":!0,"initial-value":s.$route.query,onFilterChange:j,class:""},{default:A(()=>[t("div",null,[r[10]||(r[10]=t("label",{for:"",class:"top-label -top-1"},"Status ",-1)),J(t("select",{"onUpdate:modelValue":r[0]||(r[0]=e=>u(l).selectedStatus=e),onChange:y,class:"input-1 py-0.5 text-center"},r[9]||(r[9]=[t("option",{value:"",selected:""},"All",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Rejected"},"Rejected",-1)]),544),[[K,u(l).selectedStatus]])])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"]),_(ee,{modelValue:p.value,"onUpdate:modelValue":r[5]||(r[5]=e=>p.value=e),"show-year":!1,"show-month":!0,"show-date":!1,label:"Month"},null,8,["modelValue"])]),u(l).loading?(i(),d("div",le,[_(Z)])):(i(),d("div",ae,[t("table",de,[r[15]||(r[15]=t("thead",null,[t("tr",{class:"bg-gray-200 sticky top-28"},[t("th",{class:"border border-gray-300 px-2 text-left"},"#"),t("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),t("th",{class:"border border-gray-300 px-2"},"Created Date"),t("th",{class:"border border-gray-300 px-2"},"Exchange Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Current Shift"),t("th",{class:"border border-gray-300 px-2 text-left"},"Exchange Shift"),t("th",{class:"border border-gray-300 px-2 text-left"},"Attachment"),t("th",{class:"border border-gray-300 px-2 text-left"},"Status"),t("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),t("tbody",null,[(i(!0),d(Q,null,W((k=u(l))==null?void 0:k.all_exchanges,(e,P)=>{var q,x,E,C,D;return i(),d("tr",{key:e==null?void 0:e.id,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",ie,n(P+1),1),t("td",ne,n(((q=e==null?void 0:e.user)==null?void 0:q.name)||"Unknown"),1),t("td",pe,n(S(e==null?void 0:e.created_at)),1),t("td",ue,n(S(e==null?void 0:e.exchange_date)),1),t("td",ye,n((C=(E=(x=e==null?void 0:e.user)==null?void 0:x.current_shift)==null?void 0:E.shift)==null?void 0:C.name),1),t("td",me,n((D=e==null?void 0:e.shift)==null?void 0:D.name),1),t("td",_e,[e.attachment?(i(),d("a",{key:0,href:e==null?void 0:e.attachment,target:"_blank",class:"text-blue-500 underline"},r[11]||(r[11]=[t("i",{class:"fad fa-link"},null,-1)]),8,ce)):M("",!0)]),t("td",fe,n((e==null?void 0:e.status)||"N/A"),1),t("td",be,[t("div",ve,[_(O,{to:{name:"ExchangeShiftShow",params:{id:e==null?void 0:e.id}},class:"btn-icon"},{default:A(()=>r[12]||(r[12]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[12]},1032,["to"]),t("button",{onClick:he=>F(e==null?void 0:e.id),class:"btn-icon text-red-500"},r[13]||(r[13]=[t("i",{class:"far fa-trash"},null,-1)]),8,we)])])])}),128)),((g=(h=u(l))==null?void 0:h.all_exchanges)==null?void 0:g.length)===0?(i(),d("tr",Se,r[14]||(r[14]=[t("td",{colspan:"6",class:"p-2 text-center text-red-500"},"No shift exchanges found",-1)]))):M("",!0)])])]))])}}};export{Be as default};
