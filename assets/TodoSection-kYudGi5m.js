import{L as X}from"./LoaderView-YRgdvYMf.js";import{r as P,x as j,e as G,A as Y,c as y,o as c,I as R,a as e,F as W,y as B,t as S,g,w as D,q as V,n as L,f as F,H as de,i as M,k as w,J as ae,j as U,h as J,v as Q,m as ue,S as K,T as H}from"./index-C49pkotK.js";import{f as ce,b as Z,g as le}from"./datetime-l2Vm98rT.js";import{u as z}from"./useTodoStore-hOSQHeCX.js";import{_ as me}from"./DraggableList.vue_vue_type_script_setup_true_lang-CipbEUta.js";import{_ as ye}from"./UserChip-BSclU-_K.js";import{O as te}from"./OverlyModal-C7wmpn2j.js";const ve={class:"grid grid-cols-7 *:text-center *:p-2 *:border-r *:border-b *:text-blue-800 *:text-sm"},pe={class:"flex flex-col"},fe={key:0,class:"p-2 border-r border-t"},ge={__name:"CalenderView",props:{month:{type:String,required:!0,validator:r=>/^\d{4}-(0[1-9]|1[0-2])$/.test(r)}},emits:["change"],setup(r,{emit:$}){const a=r,i=$,u=P(),t=P(),l=P(),m=P(),d=["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];function h(b,s,k,C){const x=[];for(let N=k-1;N>=0;N--){const p=C-N,_=new Date(b,s-1,p);x.push({date:_,day:_.getDate(),month:_.getMonth()+1,year:_.getFullYear(),isCurrentMonth:!1})}return x}function n(b,s,k){const C=[];for(let x=1;x<=k;x++){const p={date:new Date(b,s,x),day:x,month:s+1,year:b,isCurrentMonth:!0};C.push(p)}return C}function o(b,s,k){const C=[...b],x=Math.ceil(C.length/7)*7,N=1;for(let p=0;C.length<x;p++){const _=new Date(s,k+1,N+p);C.push({date:_,day:_.getDate(),month:_.getMonth()+1,year:_.getFullYear(),isCurrentMonth:!1})}return C}function v(b,s){const k=new Date(b,s,1),x=new Date(b,s+1,0).getDate(),p=(k.getDay()+1)%7,I=new Date(b,s,0).getDate();let E=[];E=[...h(b,s,p,I)];const A=n(b,s,x);return l.value=A[0],m.value=A[A.length-1],E=[...E,...A],E=[...o(E,b,s)],u.value=E[0],t.value=E[E.length-1],E}const T=j(()=>{const[b,s]=a.month.split("-"),k=parseInt(b),C=parseInt(s)-1;return console.log({yearStr:b,monthStr:s}),v(k,C)}),f=j(()=>{const b=T.value,s=[];for(let k=0;k<b.length;k+=7)s.push(b.slice(k,k+7));return s});function O(){i("change",{gridStartDate:u.value,gridEndDate:t.value,startOfMonth:l.value,endOfMonth:m.value})}return G(()=>O()),Y(()=>a.month,O),(b,s)=>(c(),y("div",null,[R(b.$slots,"calender-top"),e("div",ve,[(c(),y(W,null,B(d,k=>e("div",{key:k},S(k),1)),64))]),e("div",pe,[(c(!0),y(W,null,B(f.value,(k,C)=>(c(),y("div",{class:"week grid grid-cols-7 min-h-28 items-stretch",key:C},[(c(!0),y(W,null,B(k,(x,N)=>R(b.$slots,"date",{key:N,day:x.day,month:x.month,year:x.year,weekday:(x.date.getDay()+1)%7,isCurrentMonth:x.isCurrentMonth,yearMonthDate:`${x.year}-${String(x.month).padStart(2,"0")}-${String(x.day).padStart(2,"0")}`},()=>{var p;return[x!=null&&x.date?(c(),y("div",fe,S((p=x==null?void 0:x.date)==null?void 0:p.getDate()),1)):g("",!0)]})),128))]))),128))]),R(b.$slots,"calender-bottom")]))}},be={class:"px-4 py-2 flex items-center bg-gray-50 group gap-2"},he=["value"],ke=["value"],xe=["value"],Ce=["value"],we=["disabled"],De={key:4,class:"ml-4 md:ml-auto flex items-center gap-2"},$e={key:5,class:"ml-4 md:ml-auto flex items-center gap-2"},Se={__name:"TodoHeading",props:{selected:{type:Object,default:()=>({type:"month-view",month:"",day:"",year:"",week:""})},loading:{type:Boolean,default:!1}},emits:["reloadClick",,"change"],setup(r,{emit:$}){const a=r,i=[{value:"month-view",label:"Monthly"},{value:"day-view",label:"Daily"}],u=$,t=P();function l(s){t.value=s,u("change",{...a.selected,type:s})}Y(()=>{var s;return(s=a.selected)==null?void 0:s.type},s=>l(s),{immediate:!0});const m=j(()=>t.value=="month-view"&&a.selected.year&&a.selected.month?[a.selected.year,a.selected.month-1,1]:t.value=="day-view"&&a.selected.year&&a.selected.month&&a.selected.day?[a.selected.year,a.selected.month-1,a.selected.day]:[new Date().getFullYear(),new Date().getMonth(),new Date().getDate()]);function d(){t.value=="month-view"&&f(new Date)}function h(){if(t.value=="month-view"){const s=new Date(...m.value);s.setMonth(s.getMonth()+1),f(s)}}function n(){if(t.value=="month-view"){const s=new Date(...m.value);s.setMonth(s.getMonth()-1),f(s)}}function o(){t.value=="day-view"&&f(new Date)}function v(){if(t.value=="day-view"){const s=new Date(...m.value);s.setDate(s.getDate()+1),f(s)}}function T(){if(t.value=="day-view"){const s=new Date(...m.value);s.setDate(s.getDate()-1),f(s)}}function f(s){u("change",{type:t.value,month:s.getMonth()+1,day:s.getDate(),year:s.getFullYear(),week:s.getDay()})}const O=j(()=>t.value=="month-view"?`${a.selected.year}-${a.selected.month.toString().padStart(2,"0")}`:t.value=="day-view"?`${a.selected.year}-${a.selected.month.toString().padStart(2,"0")}-${a.selected.day.toString().padStart(2,"0")}`:a.selected),b=s=>{var k,C;if(t.value=="month-view"){const[x,N]=(k=s.target.value)==null?void 0:k.split("-").map(Number),p=new Date(x,N-1,1);f(p)}if(t.value=="day-view"){const x=new Date((C=s.target)==null?void 0:C.value);f(x)}};return(s,k)=>(c(),y("div",null,[e("div",be,[R(s.$slots,"before",{selected:r.selected}),R(s.$slots,"typeSelection",{selected:r.selected,types:i,changeType:l},()=>[e("select",{class:"px-2 h-7 border rounded",value:t.value,onChange:k[0]||(k[0]=C=>l(C.target.value))},[(c(),y(W,null,B(i,C=>e("option",{value:C.value,key:C.id},S(C.label),9,ke)),64))],40,he)]),t.value=="month-view"?(c(),y("input",{key:0,type:"month",value:O.value,onInput:b,class:"border px-2 rounded"},null,40,xe)):g("",!0),t.value=="day-view"?(c(),y("input",{key:1,type:"date",value:O.value,onInput:b,class:"border px-2 rounded"},null,40,Ce)):g("",!0),t.value=="month-view"?(c(),y("button",{key:2,class:"btn-3 mx-4 h-7",onClick:D(d,["prevent"])}," Current Month ")):g("",!0),t.value=="day-view"?(c(),y("button",{key:3,class:"btn-3 mx-4 h-7",onClick:D(o,["prevent"])}," Today ")):g("",!0),e("button",{class:V(["btn-3 px-2 py-2 mx-4 size-7 disabled:text-gray-300 disabled:border-gray-300",{"animate-spin text-gray-300 border-gray-300 !bg-opacity-0":r.loading}]),onClick:k[1]||(k[1]=D(C=>u("reloadClick"),["prevent"])),disabled:r.loading},k[2]||(k[2]=[e("i",{class:"fas fa-redo-alt"},null,-1)]),10,we),t.value=="month-view"?(c(),y("div",De,[e("button",{class:"btn-2 h-7",onClick:D(n,["prevent"])}," Previous Month "),e("button",{class:"btn-2 h-7",onClick:D(h,["prevent"])},"Next Month")])):g("",!0),t.value=="day-view"?(c(),y("div",$e,[e("button",{class:"btn-2 h-7",onClick:D(T,["prevent"])},"Previous Day"),e("button",{class:"btn-2 h-7",onClick:D(v,["prevent"])},"Next Day")])):g("",!0),R(s.$slots,"after",{selected:r.selected})]),R(s.$slots,"bottom",{selected:r.selected})]))}},Te={key:0,class:"fa fa-exclamation-square",title:"Pending"},_e={key:1,class:"fa fa-circle",title:"Working"},Me={key:2,class:"fa fa-check-square",title:"Completed"},ne={__name:"TodoStatusIcon",props:{todo:{type:Object,required:!0}},setup(r){const $=r,a=j(()=>{switch($.todo.status){case"PENDING":return"text-yellow-500";case"WORKING":return"text-red-500";case"COMPLETED":return"text-green-400"}return""});return(i,u)=>(c(),y("span",{class:V(a.value)},[r.todo.status=="PENDING"?(c(),y("i",Te)):g("",!0),r.todo.status=="WORKING"?(c(),y("i",_e)):g("",!0),r.todo.status=="COMPLETED"?(c(),y("i",Me)):g("",!0)],2))}},Ee=["title","onClick"],Ie={class:"line-clamp-1"},Re={key:0,class:"text-purple-600 text-center"},ie={__name:"TodosInDate",props:{date:{type:String,required:!0},maxItems:{type:[Number,String],default:3}},emits:["clickTodo"],setup(r,{emit:$}){const a=r,i=$,{getTodosByDate:u}=z(),t=j(()=>{let l=[],m=!1,d=[];if(typeof u=="function"){const h=u(a.date);if(d=Array.isArray(h)?h:[],a.maxItems==="all")return{all:d,items:d,moreItemsCount:0};l=d.slice(0,a.maxItems),m=d.length-l.length}return{all:d,items:l,moreItemsCount:m}});return(l,m)=>(c(),y("div",null,[t.value.items.length===0?R(l.$slots,"noTodos",{key:0},()=>[m[0]||(m[0]=e("div",{class:"text-gray-400 text-center"},"No todos",-1))]):(c(),y(W,{key:1},[R(l.$slots,"todoItems",{todos:t.value.items,allTodos:t.value.items,moreItemsCount:t.value.moreItemsCount},()=>[(c(!0),y(W,null,B(t.value.items,d=>R(l.$slots,"todoItem",{key:d.id,todo:d,moreItemsCount:t.value.moreItemsCount},()=>{var h,n,o,v;return[e("div",{title:`${d==null?void 0:d.title} ${d!=null&&d.user?`
by:`:""} ${(h=d==null?void 0:d.user)==null?void 0:h.name} ${(n=d==null?void 0:d.user)!=null&&n.department?`
DEPT:`:""} ${(v=(o=d.user)==null?void 0:o.department)==null?void 0:v.name}`,class:V(["px-1 mb-2 text-sm rounded cursor-pointer flex items-center gap-2",{"bg-sky-50 text-sky-900 hover:bg-sky-700 hover:text-white border border-sky-300":d.status!=="COMPLETED","bg-green-500 text-white":d.status==="COMPLETED"}]),onClick:D(T=>i("clickTodo",d),["prevent","stop"])},[L(ne,{todo:d,class:V(["text-sm",[d.status=="COMPLETED"?"!text-white":""]])},null,8,["todo","class"]),e("div",Ie,S(d.title),1),d.user?(c(),F(de,{key:0,user:d.user,size:"xsmall",class:"ml-auto"},null,8,["user"])):g("",!0)],10,Ee)]})),128))]),t.value.moreItemsCount>0?(c(),y("div",Re," + "+S(t.value.moreItemsCount)+" more todo"+S(t.value.moreItemsCount>1?"s":""),1)):g("",!0)],64))]))}},Oe={class:"relative"},Ne=["onClick","onKeypress"],Pe={class:"flex items-center justify-center"},Le=["onClick"],Fe={__name:"TodosInCalenderView",props:{month:{type:String,required:!0,validator:r=>/^\d{4}-(0[1-9]|1[0-2])$/.test(r)}},emits:["dateClick","clickTodo","clickDateCell"],setup(r,{emit:$}){const a=$;function i(t,l){t.isTrusted&&t.ctrlKey&&t.which==10&&a("dateClick",l)}function u(t){const[l,m,d]=String(t).split("-").map(Number),h=new Date(l,m-1,d);return ce(h)}return(t,l)=>(c(),y("div",Oe,[r.month?(c(),F(ge,{key:0,month:r.month,class:"border-t border-blue-200/50 relative"},{date:M(({day:m,yearMonthDate:d,isCurrentMonth:h})=>[e("div",{tabindex:"0",class:V(["border p-4 cursor-pointer group/date relative focus:outline-slate-400",{"bg-sky-50   border-sky-300 focus:bg-sky-50 focus:outline-sky-400":u(d),"hover:bg-slate-50  hover:border-slate-300 focus:bg-slate-50 ":!u(d)}]),onClick:D(n=>a("dateClick",d),["prevent","stop"]),onKeypress:D(n=>i(n,d),["prevent"])},[e("button",{tabindex:"1",class:V([{"text-gray-300":!h,"text-sky-400":h},"text-center mb-2 font-semibold hover:bg-sky-200 w-full rounded"])},S(m),3),e("div",null,[L(ie,{date:d,onClickTodo:l[0]||(l[0]=n=>a("clickTodo",n))},{noTodos:M(()=>l[1]||(l[1]=[e("span",null,null,-1)])),_:2},1032,["date"])]),e("div",Pe,[e("button",{onClick:D(n=>a("clickDateCell",d),["prevent","stop"]),class:"btn-3 !py-1 invisible group-hover/date:visible text-sm text-red-800/40"},l[2]||(l[2]=[e("i",{class:"fas fa-plus"},null,-1),e("span",{class:"hidden lg:inline whitespace-nowrap"}," Add todo ",-1)]),8,Le)])],42,Ne)]),_:1},8,["month"])):g("",!0)]))}},je={class:"relative bg-white p-4"},Ae={key:0,class:"text-red-500 text-sm border border-red-300 max-w-6xl mx-auto py-2 gap-2 shadow-sm rounded flex items-center px-3"},Ue={class:"max-w-6xl mx-auto border rounded my-5"},Ve={class:"mb-4 text-gray-700 border-b py-2 px-4 flex items-center"},We={class:"text-lg font-semibold"},qe={class:"ml-auto flex items-center gap-2"},ze={key:0,class:"flex items-center gap-3 mr-6"},Be=["disabled"],Ge=["disabled"],Ke=["onClick"],He={class:"ml-4"},Ye={key:0,class:"mt-1 flex items-center gap-2"},Je={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},Qe={key:0,class:"line-clamp-2 ml-4 text-gray-500"},Xe={class:"ml-auto flex items-center gap-2"},Ze=["onClick"],et=["onClick"],tt=["onClick"],nt=["onClick"],ot={__name:"TodosInDailyView",props:{date:{type:String,required:!0},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickAdd","clickEdit","clickDelete","clickChangeStatus","backClick","update"],setup(r,{emit:$}){const a=r,i=P(null),u=$,t=j(()=>new Date(a.date)),l=z();async function m(n){confirm(`Are your sure want to delete todo
'${n==null?void 0:n.title}'`)&&(await l.deleteTodo(n.id),u("update"))}async function d(n,o){confirm(`Are your sure?
want to change status to ${o} 
todo: '${n==null?void 0:n.title}'`)&&(await l.updateTodoStatus(n.id,o),u("update"))}async function h(){var o;const n=(o=i==null?void 0:i.value.items)==null?void 0:o.map(v=>v.id);await l.rearrangeMyTodos(n,{date:a.date}),u("update")}return(n,o)=>{var v;return c(),y("div",je,[w(l).error?(c(),y("div",Ae,[o[4]||(o[4]=e("i",{class:"fad fa-exclamation-circle"},null,-1)),e("div",null,S(w(l).error),1)])):g("",!0),e("div",Ue,[e("div",Ve,[e("button",{class:"fa fa-arrow-left btn-icon mr-2",onClick:o[0]||(o[0]=D(T=>u("backClick"),["prevent"]))}),e("div",We,S(w(Z)(t.value,{weekDay:"long"}))+" "+S(n.type),1),e("div",qe,[(v=i.value)!=null&&v.isItemsChanged?(c(),y("div",ze,[e("button",{onClick:o[1]||(o[1]=D(()=>h(),["prevent"])),class:"btn-2 disabled:opacity-40 disabled:pointer-events-none",disabled:w(l).updatingPriority}," Save Rearranged ",8,Be),e("button",{onClick:o[2]||(o[2]=D(()=>i.value.resetItems(),["prevent"])),class:"btn-3 disabled:opacity-40 disabled:pointer-events-none",disabled:w(l).updatingPriority}," Discard ",8,Ge)])):g("",!0),e("button",{class:"btn btn-icon",onClick:o[3]||(o[3]=D(T=>u("clickAdd",a.date),["prevent"]))},o[5]||(o[5]=[e("i",{class:"fas fa-plus"},null,-1)]))])]),L(ie,{date:r.date,"max-items":"all",class:"my-8 w-full px-4"},{todoItems:M(({allTodos:T})=>[L(me,{items:T,ref_key:"draggableTodos",ref:i,handle:"handle"},{item:M(({item:f})=>{var O,b;return[e("div",{class:V(["border rounded px-4 py-3 my-4 cursor-pointer flex items-center shadow-sm",{"bg-green-100":f.status=="COMPLETED","hover:bg-gray-50":f.status!="COMPLETED"}]),onClick:D(s=>u("clickTodo",f),["prevent"])},[L(ne,{todo:f},null,8,["todo"]),e("div",He,[e("div",{class:V(["line-clamp-1",{"text-green-800":f.status=="COMPLETED","text-blue-800":f.status!="COMPLETED"}])},S(f.id)+" - "+S(f.title),3),f.user?(c(),y("div",Ye,[L(ye,{user:f.user,"avatar-size":"xsmall"},null,8,["user"]),e("div",Je,S((b=(O=f.user)==null?void 0:O.department)==null?void 0:b.name),1)])):g("",!0)]),f.todo_type&&f.todo_type_id?(c(),y("div",Qe,S(f.todo_type)+" id: "+S(f.todo_type_id),1)):g("",!0),e("div",Xe,[f.status==="WORKING"?(c(),y("button",{key:0,title:"Mark as Completed",class:"btn-icon bg-transparent text-green-400 border-green-400 border hover:bg-green-400 hover:text-white",onClick:D(()=>d(f,"COMPLETED"),["prevent","stop"])},o[6]||(o[6]=[e("i",{class:"fas fa-check"},null,-1)]),8,Ze)):g("",!0),f.status==="PENDING"?(c(),y("button",{key:1,title:"Start Working",class:"btn-icon bg-transparent text-red-400 border-red-400 border hover:bg-red-400 hover:text-white",onClick:D(()=>d(f,"WORKING"),["prevent","stop"])},o[7]||(o[7]=[e("i",{class:"fas fa-play ml-[4px]"},null,-1)]),8,et)):g("",!0),e("button",{class:"btn-icon bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:D(s=>u("clickEdit",f),["prevent","stop"])},o[8]||(o[8]=[e("i",{class:"fas fa-pen"},null,-1)]),8,tt),e("button",{class:"btn-icon bg-red-400 text-white hover:bg-red-600 hover:text-white",onClick:D(()=>m(f),["prevent","stop"])},o[9]||(o[9]=[e("i",{class:"fas fa-trash-alt"},null,-1)]),8,nt),r.userRole=="employee"?(c(),y("button",{key:2,onClick:D(()=>null,["stop","prevent"]),class:"btn-icon bg-gray-400 text-white hover:bg-gray-600 hover:text-white handle"},o[10]||(o[10]=[e("i",{class:"fas fa-arrows-alt-v"},null,-1)]))):g("",!0)])],10,Ke)]}),_:2},1032,["items"])]),noTodos:M(()=>o[11]||(o[11]=[e("div",{class:"flex min-h-[38vh] items-center justify-center text-gray-400 text-center rounded-md"}," No Todos ",-1)])),_:1},8,["date"])])])}}},st={class:"bg-white border-t px-4 py-4 sticky bottom-0 rounded-b-md"},at={key:0,class:"mb-4 text-red-500 font-medium"},lt={key:1,class:"mb-4 text-blue-500 font-medium"},it={class:"flex justify-between items-center gap-4"},rt=["disabled"],re={__name:"FormHandler",props:{isSubmitting:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["submit","clickCancel"],setup(r,{emit:$}){const a=$;return(i,u)=>(c(),y("form",{onSubmit:u[1]||(u[1]=D(t=>a("submit"),["prevent"]))},[R(i.$slots,"default"),e("div",st,[r.error?(c(),y("div",at,S(r.error),1)):g("",!0),r.isSubmitting?(c(),y("div",lt,"Saving changes...")):g("",!0),R(i.$slots,"footer",{},()=>[e("div",it,[e("button",{type:"button",onClick:u[0]||(u[0]=t=>a("clickCancel")),class:"btn-3"},"Cancel"),e("button",{disabled:r.isSubmitting||r.isLoading,type:"submit",class:"btn-2"},S(r.isSubmitting?"Saving...":"Save"),9,rt)])])])],32))}},dt={class:""},ut={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},ct={class:"mb-2"},mt={class:"mb-4"},yt={class:"mb-4"},vt={__name:"TodoAddForm",props:{date:{type:String,default:le(new Date)},userRole:{type:String,default:"employee"}},emits:["update","cancelClick"],setup(r,{emit:$}){const a=r,i=P(),u=P(),t=z(),l=$,m=P({title:"",date:a.date||"",task_id:""});async function d(){try{i.value="submitting",await t.createTodo(m.value,{returnWith:a.userRole!=="employee"?"user,department,company":""}),l("update")}finally{i.value=""}}const h=j(()=>new Date(a.date));return G(async()=>{var n;await ae(),(n=u.value)==null||n.focus()}),(n,o)=>(c(),y("div",dt,[w(t).loading?(c(),F(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:M(()=>o[3]||(o[3]=[U(" Loading... ")])),_:1,__:[3]})):g("",!0),L(re,{onSubmit:d,onClickCancel:o[2]||(o[2]=v=>l("cancelClick")),isSubmitting:i.value=="submitting",error:w(t).error,class:"rounded-md relative"},{default:M(()=>[o[7]||(o[7]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Add Todo")],-1)),e("div",ut,[e("div",ct,[o[4]||(o[4]=e("span",{class:"font-semibold"}," Date ",-1)),e("span",null,S(w(Z)(h.value,{weekDay:"long"})),1)]),e("div",mt,[o[5]||(o[5]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),J(e("input",{ref_key:"titleRef",ref:u,"onUpdate:modelValue":o[0]||(o[0]=v=>m.value.title=v),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.title]])]),e("div",yt,[o[6]||(o[6]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),J(e("input",{"onUpdate:modelValue":o[1]||(o[1]=v=>m.value.task_id=v),placeholder:"Enter a task id",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.task_id]])])])]),_:1,__:[7]},8,["isSubmitting","error"])]))}},pt={class:"relative"},ft={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},gt={class:"mb-2"},bt={class:"mb-4"},ht={class:"mb-4"},kt={__name:"TodoEditForm",props:{date:{type:String,default:le(new Date)},todo:{type:Object,default:()=>{}}},emits:["update","cancelClick"],setup(r,{emit:$}){const a=r,i=P(),u=P(),t=z(),l=$,m=P({title:"",todo_type:"task",todo_type_id:""});async function d(){var o,v,T;await t.fetchTodo((o=a.todo)==null?void 0:o.id),m.value.title=(v=t.todo)==null?void 0:v.title,m.value.todo_type_id=(T=t.todo)==null?void 0:T.todoable_id}async function h(){i.value="submitting";try{await t.updateTodo(a.todo.id,m.value),l("update")}finally{i.value=""}}const n=j(()=>new Date(a.todo.date));return G(async()=>{var o;await d(),await ae(),(o=u.value)==null||o.focus()}),(o,v)=>(c(),y("div",pt,[w(t).loading?(c(),F(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:M(()=>v[3]||(v[3]=[U(" Loading... ")])),_:1,__:[3]})):g("",!0),L(re,{onSubmit:h,onClickCancel:v[2]||(v[2]=T=>l("cancelClick")),isSubmitting:i.value=="submitting",isLoading:w(t).loading,error:w(t).error},{default:M(()=>[v[7]||(v[7]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Edit Todo")],-1)),e("div",ft,[e("div",gt,[v[4]||(v[4]=e("span",{class:"font-semibold"}," Date ",-1)),e("span",null,S(w(Z)(n.value,{weekDay:"long"})),1)]),e("div",bt,[v[5]||(v[5]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),J(e("input",{ref_key:"titleRef",ref:u,"onUpdate:modelValue":v[0]||(v[0]=T=>m.value.title=T),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.title]])]),e("div",ht,[v[6]||(v[6]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),J(e("input",{"onUpdate:modelValue":v[1]||(v[1]=T=>m.value.todo_type_id=T),placeholder:"Enter a task id",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.todo_type_id]])])])]),_:1,__:[7]},8,["isSubmitting","isLoading","error"])]))}},xt={class:"relative"},Ct={class:"min-h-[10vh] max-h-[50vh] overflow-y-auto p-4"},wt={class:"mb-4"},Dt={class:"mb-4"},$t={key:0,class:"mt-1 flex items-center gap-2"},St={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},Tt={class:"flex items-center gap-4"},_t={key:0,class:"flex items-center gap-2"},Mt={class:"flex justify-between items-center gap-4 py-4 px-4 border-t"},Et={class:"ml-auto flex items-center gap-2"},It={__name:"TodoShow",props:{todo:{type:Object,default:()=>{}}},emits:["cancelClick","clickEdit","update"],setup(r,{emit:$}){const a=r,i=z(),u=$;async function t(){var h;await i.fetchTodo((h=a.todo)==null?void 0:h.id)}const l=j(()=>{var h,n;return(h=i.todo)!=null&&h.date?new Date((n=i.todo)==null?void 0:n.date):null});async function m(h){var n;confirm(`Are your sure want to delete todo
'${(n=i.todo)==null?void 0:n.title}'`)&&(await i.deleteTodo(h.id),u("update"))}async function d(h,n){var o;confirm(`Are your sure want to compete todo
'${(o=i.todo)==null?void 0:o.title}'`)&&(await i.updateTodoStatus(h.id,n),u("update"))}return G(async()=>{await t()}),(h,n)=>{var v,T,f,O,b,s,k,C;const o=ue("UserChip");return c(),y("div",xt,[w(i).loading?(c(),F(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:M(()=>n[5]||(n[5]=[U(" Loading... ")])),_:1,__:[5]})):g("",!0),e("div",null,[n[11]||(n[11]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Show Todo")],-1)),e("div",Ct,[e("div",wt,[n[6]||(n[6]=e("div",{class:"font-semibold text-xs text-gray-500"},"Date",-1)),e("span",null,S(w(Z)(l.value,{weekDay:"long"})),1)]),e("div",Dt,[n[7]||(n[7]=e("div",{class:"text-xs text-gray-500"},"Todo",-1)),U(" "+S((v=w(i).todo)==null?void 0:v.title),1)]),r.todo.user?(c(),y("div",$t,[L(o,{user:r.todo.user,"avatar-size":"xsmall"},null,8,["user"]),e("div",St,S((f=(T=r.todo.user)==null?void 0:T.department)==null?void 0:f.name),1)])):g("",!0),e("div",null,[n[10]||(n[10]=e("div",{class:"text-xs text-gray-500"},"Status",-1)),e("div",Tt,[e("div",null,[(O=w(i))!=null&&O.todo?(c(),F(ne,{key:0,todo:(b=w(i))==null?void 0:b.todo},null,8,["todo"])):g("",!0),U(" "+S((s=w(i).todo)==null?void 0:s.status),1)]),w(i).loading?g("",!0):(c(),y("div",_t,[((k=w(i).todo)==null?void 0:k.status)==="PENDING"?(c(),y("button",{key:0,class:"btn-2 from-yellow-700 to-yellow-500 text-white hover:bg-green-600 hover:text-white",onClick:n[0]||(n[0]=D(()=>d(w(i).todo,"WORKING"),["prevent","stop"]))},n[8]||(n[8]=[e("i",{class:"fas fa-exclamation-circle"},null,-1),U(" Change to Working ")]))):g("",!0),((C=w(i).todo)==null?void 0:C.status)==="WORKING"?(c(),y("button",{key:1,class:"btn-2 from-green-700 to-green-300 text-white hover:bg-green-600 hover:text-white",onClick:n[1]||(n[1]=D(()=>d(w(i).todo,"COMPLETED"),["prevent","stop"]))},n[9]||(n[9]=[e("i",{class:"fas fa-check"},null,-1),U(" Make Complete ")]))):g("",!0)]))])])])]),e("div",Mt,[e("button",{type:"button",onClick:n[2]||(n[2]=x=>u("cancelClick")),class:"btn-3"},"Cancel"),e("div",Et,[e("button",{class:"btn-2 bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:n[3]||(n[3]=D(x=>u("clickEdit",w(i).todo),["prevent","stop"]))},n[12]||(n[12]=[e("i",{class:"fas fa-pen"},null,-1),U(" Edit ")])),e("button",{class:"btn-2-red",onClick:n[4]||(n[4]=D(()=>m(w(i).todo),["prevent","stop"]))},n[13]||(n[13]=[e("i",{class:"fas fa-trash-alt"},null,-1),U(" Delete ")]))])])])}}},Rt={__name:"TodoCreateEditShow",props:{todoModal:{type:Object,required:!0},userRole:{type:String,required:"employee"}},emits:["cancelClick","update","clickEdit","clickDelete","clickChangeStatus"],setup(r,{emit:$}){const a=$;function i(){a("update")}return(u,t)=>(c(),y(W,null,[r.todoModal.action=="add"?(c(),F(te,{key:0},{default:M(()=>{var l;return[L(vt,{onCancelClick:t[0]||(t[0]=m=>a("cancelClick")),onUpdate:i,date:(l=r.todoModal)==null?void 0:l.date,userRole:r.userRole},null,8,["date","userRole"])]}),_:1})):g("",!0),r.todoModal.action=="edit"?(c(),F(te,{key:1},{default:M(()=>{var l;return[L(kt,{onCancelClick:t[1]||(t[1]=m=>a("cancelClick")),onUpdate:i,todo:(l=r.todoModal)==null?void 0:l.todo,userRole:r.userRole},null,8,["todo","userRole"])]}),_:1})):g("",!0),r.todoModal.action=="show"?(c(),F(te,{key:2},{default:M(()=>{var l;return[L(It,{onCancelClick:t[2]||(t[2]=m=>a("cancelClick")),onUpdate:i,onClickEdit:t[3]||(t[3]=m=>a("clickEdit",m)),onClickDelete:t[4]||(t[4]=m=>a("clickDelete",m)),onClickChangeStatus:t[5]||(t[5]=(m,d)=>a("clickChangeStatus",m,d)),todo:(l=r.todoModal)==null?void 0:l.todo,userRole:r.userRole},null,8,["todo","userRole"])]}),_:1})):g("",!0)],64))}},Ot={class:"border bg-white relative"},Vt={__name:"TodoSection",props:{year:{type:Number,default:()=>new Date().getFullYear()},month:{type:Number,default:()=>new Date().getMonth()+1},day:{type:Number,default:()=>new Date().getDate()},week:{type:Number,default:()=>new Date().getDay()},type:{type:String,default:"month-view"},userRole:{type:String,default:"employee"}},emits:["changeInput"],setup(r,{emit:$}){const a=new Date,i=r,u=P({type:"month-view",month:a.getMonth()+1,day:a.getDate(),year:a.getFullYear(),week:a.getDay()}),t=$;Y(()=>({...u.value}),p=>{t("changeInput",p)}),Y(()=>({year:i.year,month:i.month,day:i.day,week:i.week,type:i.type}),p=>{u.value={...p}},{immediate:!0});const l=P({action:null}),m=z();async function d(){await N()}function h(){l.value={...l.value,action:""}}async function n(p,_){await m.updateTodoStatus(p,_)}async function o(p){await m.deleteTodo(p)}function v(){u.value={...u.value,type:"month-view"}}function T(p){u.value={...u.value,...p}}function f(p){const[_,I,E]=p.split("-").map(Number);u.value={...u.value,type:"day-view",year:_,month:I,day:E}}function O(p){l.value={...l.value,action:"show",todo:p}}function b(p){l.value={...l.value,action:"edit",todo:p}}function s(p){l.value={...l.value,action:"add",date:p}}function k(){l.value={action:null,todo:null}}const C=j(()=>{var E,q,A,ee,oe,se;const p=(q=(E=u.value)==null?void 0:E.year)==null?void 0:q.toString(),_=(ee=(A=u.value)==null?void 0:A.month)==null?void 0:ee.toString().padStart(2,"0"),I=(se=(oe=u.value)==null?void 0:oe.day)==null?void 0:se.toString().padStart(2,"0");return`${p}-${_}-${I}`}),x=j(()=>{var I,E,q,A;const p=(E=(I=u.value)==null?void 0:I.year)==null?void 0:E.toString(),_=(A=(q=u.value)==null?void 0:q.month)==null?void 0:A.toString().padStart(2,"0");return`${p}-${_}`});async function N(){i.userRole=="employee"?await m.fetchMyTodos():await m.fetchTodos()}return G(async()=>{await N()}),(p,_)=>(c(),y("div",null,[e("div",Ot,[w(m).loading?(c(),F(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:M(()=>_[0]||(_[0]=[U(" Loading... ")])),_:1,__:[0]})):g("",!0),L(Se,{selected:u.value,class:"border-b shadow z-20",onChange:T,onReloadClick:d},{before:M(I=>[R(p.$slots,"beforeHeader",K(H(I)))]),after:M(I=>[R(p.$slots,"afterHeader",K(H(I)))]),bottom:M(I=>[R(p.$slots,"bottomHeader",K(H(I)))]),typeSelection:M(I=>[R(p.$slots,"typeSelection",K(H(I)))]),_:3},8,["selected"]),u.value.type=="month-view"?(c(),F(Fe,{key:1,month:x.value,class:"bg-white",onDateClick:f,onClickTodo:O,onClickDateCell:s},null,8,["month"])):g("",!0),u.value.type=="day-view"?(c(),F(ot,{key:2,date:C.value,userRole:r.userRole,onClickTodo:O,onClickEdit:b,onClickAdd:s,onClickDelete:o,onClickChangeStatus:n,onBackClick:v,onUpdate:h},null,8,["date","userRole"])):g("",!0)]),L(Rt,{todoModal:l.value,userRole:r.userRole,onCancelClick:k,onUpdate:h,onClickEdit:b},null,8,["todoModal","userRole"])]))}};export{ge as _,Vt as a};
