import{e as ut,L as Yt,O as nn,P as on,Q as rn,S as dt,T as an,m as ln,U as sn,V as un,q as St,c as R,o as A,F as ft,x as Xt,s as dn,p as ct,f as ze,i as we,y as ve,a as S,n as fn,M as cn,g as fe,w as pt,d as pn,r as ue,t as be,k as Be,h as Dt,v as xt}from"./index-mGcqMfxK.js";import{g as Tt}from"./datetime-C4Yr_jSk.js";import{u as hn}from"./user-CPV1H34l.js";import{u as mn}from"./useTaskStore-DWs03Uy8.js";import{L as gn}from"./LoaderView-Lc8bidDu.js";import{T as vn}from"./TextWithHr-BcZErc8Q.js";import{_ as bn,a as yn}from"./TaskUrgencyInput-uQ31sOCf.js";import{S as _n}from"./SelectDropdown-CHoC3Hch.js";import{_ as Ct}from"./UserChip-CRZQTch_.js";import{_ as wn}from"./TaskUserChip-xJVuGh8L.js";function En(o){return nn()?(on(o),!0):!1}const Sn=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;function Dn(o){return rn()}function xn(o,e=!0,n){Dn()?ut(o,n):e?o():Yt(o)}const Tn=Sn?window.document:void 0;function Cn(o){var e;const n=dt(o);return(e=n==null?void 0:n.$el)!=null?e:n}/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Ot(o,e){var n=Object.keys(o);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(o);e&&(t=t.filter(function(i){return Object.getOwnPropertyDescriptor(o,i).enumerable})),n.push.apply(n,t)}return n}function ne(o){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ot(Object(n),!0).forEach(function(t){On(o,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(n,t))})}return o}function We(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?We=function(e){return typeof e}:We=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(o)}function On(o,e,n){return e in o?Object.defineProperty(o,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[e]=n,o}function ie(){return ie=Object.assign||function(o){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(o[t]=n[t])}return o},ie.apply(this,arguments)}function In(o,e){if(o==null)return{};var n={},t=Object.keys(o),i,r;for(r=0;r<t.length;r++)i=t[r],!(e.indexOf(i)>=0)&&(n[i]=o[i]);return n}function An(o,e){if(o==null)return{};var n=In(o,e),t,i;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(o);for(i=0;i<r.length;i++)t=r[i],!(e.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(o,t)&&(n[t]=o[t])}return n}var kn="1.15.6";function oe(o){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(o)}var re=oe(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Fe=oe(/Edge/i),It=oe(/firefox/i),Ae=oe(/safari/i)&&!oe(/chrome/i)&&!oe(/android/i),bt=oe(/iP(ad|od|hone)/i),Ut=oe(/chrome/i)&&oe(/android/i),Vt={capture:!1,passive:!1};function w(o,e,n){o.addEventListener(e,n,!re&&Vt)}function y(o,e,n){o.removeEventListener(e,n,!re&&Vt)}function $e(o,e){if(e){if(e[0]===">"&&(e=e.substring(1)),o)try{if(o.matches)return o.matches(e);if(o.msMatchesSelector)return o.msMatchesSelector(e);if(o.webkitMatchesSelector)return o.webkitMatchesSelector(e)}catch{return!1}return!1}}function zt(o){return o.host&&o!==document&&o.host.nodeType?o.host:o.parentNode}function J(o,e,n,t){if(o){n=n||document;do{if(e!=null&&(e[0]===">"?o.parentNode===n&&$e(o,e):$e(o,e))||t&&o===n)return o;if(o===n)break}while(o=zt(o))}return null}var At=/\s+/g;function L(o,e,n){if(o&&e)if(o.classList)o.classList[n?"add":"remove"](e);else{var t=(" "+o.className+" ").replace(At," ").replace(" "+e+" "," ");o.className=(t+(n?" "+e:"")).replace(At," ")}}function m(o,e,n){var t=o&&o.style;if(t){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(o,""):o.currentStyle&&(n=o.currentStyle),e===void 0?n:n[e];!(e in t)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),t[e]=n+(typeof n=="string"?"":"px")}}function De(o,e){var n="";if(typeof o=="string")n=o;else do{var t=m(o,"transform");t&&t!=="none"&&(n=t+" "+n)}while(!e&&(o=o.parentNode));var i=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return i&&new i(n)}function Wt(o,e,n){if(o){var t=o.getElementsByTagName(e),i=0,r=t.length;if(n)for(;i<r;i++)n(t[i],i);return t}return[]}function te(){var o=document.scrollingElement;return o||document.documentElement}function N(o,e,n,t,i){if(!(!o.getBoundingClientRect&&o!==window)){var r,a,s,l,u,f,d;if(o!==window&&o.parentNode&&o!==te()?(r=o.getBoundingClientRect(),a=r.top,s=r.left,l=r.bottom,u=r.right,f=r.height,d=r.width):(a=0,s=0,l=window.innerHeight,u=window.innerWidth,f=window.innerHeight,d=window.innerWidth),(e||n)&&o!==window&&(i=i||o.parentNode,!re))do if(i&&i.getBoundingClientRect&&(m(i,"transform")!=="none"||n&&m(i,"position")!=="static")){var p=i.getBoundingClientRect();a-=p.top+parseInt(m(i,"border-top-width")),s-=p.left+parseInt(m(i,"border-left-width")),l=a+r.height,u=s+r.width;break}while(i=i.parentNode);if(t&&o!==window){var _=De(i||o),v=_&&_.a,E=_&&_.d;_&&(a/=E,s/=v,d/=v,f/=E,l=a+f,u=s+d)}return{top:a,left:s,bottom:l,right:u,width:d,height:f}}}function kt(o,e,n){for(var t=pe(o,!0),i=N(o)[e];t;){var r=N(t)[n],a=void 0;if(a=i>=r,!a)return t;if(t===te())break;t=pe(t,!1)}return!1}function xe(o,e,n,t){for(var i=0,r=0,a=o.children;r<a.length;){if(a[r].style.display!=="none"&&a[r]!==g.ghost&&(t||a[r]!==g.dragged)&&J(a[r],n.draggable,o,!1)){if(i===e)return a[r];i++}r++}return null}function yt(o,e){for(var n=o.lastElementChild;n&&(n===g.ghost||m(n,"display")==="none"||e&&!$e(n,e));)n=n.previousElementSibling;return n||null}function $(o,e){var n=0;if(!o||!o.parentNode)return-1;for(;o=o.previousElementSibling;)o.nodeName.toUpperCase()!=="TEMPLATE"&&o!==g.clone&&(!e||$e(o,e))&&n++;return n}function Nt(o){var e=0,n=0,t=te();if(o)do{var i=De(o),r=i.a,a=i.d;e+=o.scrollLeft*r,n+=o.scrollTop*a}while(o!==t&&(o=o.parentNode));return[e,n]}function Nn(o,e){for(var n in o)if(o.hasOwnProperty(n)){for(var t in e)if(e.hasOwnProperty(t)&&e[t]===o[n][t])return Number(n)}return-1}function pe(o,e){if(!o||!o.getBoundingClientRect)return te();var n=o,t=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var i=m(n);if(n.clientWidth<n.scrollWidth&&(i.overflowX=="auto"||i.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(i.overflowY=="auto"||i.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return te();if(t||e)return n;t=!0}}while(n=n.parentNode);return te()}function Pn(o,e){if(o&&e)for(var n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);return o}function et(o,e){return Math.round(o.top)===Math.round(e.top)&&Math.round(o.left)===Math.round(e.left)&&Math.round(o.height)===Math.round(e.height)&&Math.round(o.width)===Math.round(e.width)}var ke;function Ht(o,e){return function(){if(!ke){var n=arguments,t=this;n.length===1?o.call(t,n[0]):o.apply(t,n),ke=setTimeout(function(){ke=void 0},e)}}}function Mn(){clearTimeout(ke),ke=void 0}function Lt(o,e,n){o.scrollLeft+=e,o.scrollTop+=n}function jt(o){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(o).cloneNode(!0):n?n(o).clone(!0)[0]:o.cloneNode(!0)}function Gt(o,e,n){var t={};return Array.from(o.children).forEach(function(i){var r,a,s,l;if(!(!J(i,e.draggable,o,!1)||i.animated||i===n)){var u=N(i);t.left=Math.min((r=t.left)!==null&&r!==void 0?r:1/0,u.left),t.top=Math.min((a=t.top)!==null&&a!==void 0?a:1/0,u.top),t.right=Math.max((s=t.right)!==null&&s!==void 0?s:-1/0,u.right),t.bottom=Math.max((l=t.bottom)!==null&&l!==void 0?l:-1/0,u.bottom)}}),t.width=t.right-t.left,t.height=t.bottom-t.top,t.x=t.left,t.y=t.top,t}var W="Sortable"+new Date().getTime();function Fn(){var o=[],e;return{captureAnimationState:function(){if(o=[],!!this.options.animation){var t=[].slice.call(this.el.children);t.forEach(function(i){if(!(m(i,"display")==="none"||i===g.ghost)){o.push({target:i,rect:N(i)});var r=ne({},o[o.length-1].rect);if(i.thisAnimationDuration){var a=De(i,!0);a&&(r.top-=a.f,r.left-=a.e)}i.fromRect=r}})}},addAnimationState:function(t){o.push(t)},removeAnimationState:function(t){o.splice(Nn(o,{target:t}),1)},animateAll:function(t){var i=this;if(!this.options.animation){clearTimeout(e),typeof t=="function"&&t();return}var r=!1,a=0;o.forEach(function(s){var l=0,u=s.target,f=u.fromRect,d=N(u),p=u.prevFromRect,_=u.prevToRect,v=s.rect,E=De(u,!0);E&&(d.top-=E.f,d.left-=E.e),u.toRect=d,u.thisAnimationDuration&&et(p,d)&&!et(f,d)&&(v.top-d.top)/(v.left-d.left)===(f.top-d.top)/(f.left-d.left)&&(l=Bn(v,p,_,i.options)),et(d,f)||(u.prevFromRect=f,u.prevToRect=d,l||(l=i.options.animation),i.animate(u,v,d,l)),l&&(r=!0,a=Math.max(a,l),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},l),u.thisAnimationDuration=l)}),clearTimeout(e),r?e=setTimeout(function(){typeof t=="function"&&t()},a):typeof t=="function"&&t(),o=[]},animate:function(t,i,r,a){if(a){m(t,"transition",""),m(t,"transform","");var s=De(this.el),l=s&&s.a,u=s&&s.d,f=(i.left-r.left)/(l||1),d=(i.top-r.top)/(u||1);t.animatingX=!!f,t.animatingY=!!d,m(t,"transform","translate3d("+f+"px,"+d+"px,0)"),this.forRepaintDummy=Rn(t),m(t,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),m(t,"transform","translate3d(0,0,0)"),typeof t.animated=="number"&&clearTimeout(t.animated),t.animated=setTimeout(function(){m(t,"transition",""),m(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1},a)}}}}function Rn(o){return o.offsetWidth}function Bn(o,e,n,t){return Math.sqrt(Math.pow(e.top-o.top,2)+Math.pow(e.left-o.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*t.animation}var ye=[],tt={initializeByDefault:!0},Re={mount:function(e){for(var n in tt)tt.hasOwnProperty(n)&&!(n in e)&&(e[n]=tt[n]);ye.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),ye.push(e)},pluginEvent:function(e,n,t){var i=this;this.eventCanceled=!1,t.cancel=function(){i.eventCanceled=!0};var r=e+"Global";ye.forEach(function(a){n[a.pluginName]&&(n[a.pluginName][r]&&n[a.pluginName][r](ne({sortable:n},t)),n.options[a.pluginName]&&n[a.pluginName][e]&&n[a.pluginName][e](ne({sortable:n},t)))})},initializePlugins:function(e,n,t,i){ye.forEach(function(s){var l=s.pluginName;if(!(!e.options[l]&&!s.initializeByDefault)){var u=new s(e,n,e.options);u.sortable=e,u.options=e.options,e[l]=u,ie(t,u.defaults)}});for(var r in e.options)if(e.options.hasOwnProperty(r)){var a=this.modifyOption(e,r,e.options[r]);typeof a<"u"&&(e.options[r]=a)}},getEventProperties:function(e,n){var t={};return ye.forEach(function(i){typeof i.eventProperties=="function"&&ie(t,i.eventProperties.call(n[i.pluginName],e))}),t},modifyOption:function(e,n,t){var i;return ye.forEach(function(r){e[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[n]=="function"&&(i=r.optionListeners[n].call(e[r.pluginName],t))}),i}};function Yn(o){var e=o.sortable,n=o.rootEl,t=o.name,i=o.targetEl,r=o.cloneEl,a=o.toEl,s=o.fromEl,l=o.oldIndex,u=o.newIndex,f=o.oldDraggableIndex,d=o.newDraggableIndex,p=o.originalEvent,_=o.putSortable,v=o.extraEventProperties;if(e=e||n&&n[W],!!e){var E,H=e.options,q="on"+t.charAt(0).toUpperCase()+t.substr(1);window.CustomEvent&&!re&&!Fe?E=new CustomEvent(t,{bubbles:!0,cancelable:!0}):(E=document.createEvent("Event"),E.initEvent(t,!0,!0)),E.to=a||n,E.from=s||n,E.item=i||n,E.clone=r,E.oldIndex=l,E.newIndex=u,E.oldDraggableIndex=f,E.newDraggableIndex=d,E.originalEvent=p,E.pullMode=_?_.lastPutMode:void 0;var M=ne(ne({},v),Re.getEventProperties(t,e));for(var V in M)E[V]=M[V];n&&n.dispatchEvent(E),H[q]&&H[q].call(e,E)}}var Xn=["evt"],z=function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=t.evt,r=An(t,Xn);Re.pluginEvent.bind(g)(e,n,ne({dragEl:c,parentEl:I,ghostEl:b,rootEl:T,nextEl:ge,lastDownEl:He,cloneEl:C,cloneHidden:ce,dragStarted:Ce,putSortable:F,activeSortable:g.active,originalEvent:i,oldIndex:Se,oldDraggableIndex:Ne,newIndex:j,newDraggableIndex:de,hideGhostForTarget:Qt,unhideGhostForTarget:Zt,cloneNowHidden:function(){ce=!0},cloneNowShown:function(){ce=!1},dispatchSortableEvent:function(s){U({sortable:n,name:s,originalEvent:i})}},r))};function U(o){Yn(ne({putSortable:F,cloneEl:C,targetEl:c,rootEl:T,oldIndex:Se,oldDraggableIndex:Ne,newIndex:j,newDraggableIndex:de},o))}var c,I,b,T,ge,He,C,ce,Se,j,Ne,de,Ye,F,Ee=!1,qe=!1,Ke=[],he,Z,nt,ot,Pt,Mt,Ce,_e,Pe,Me=!1,Xe=!1,Le,Y,it=[],ht=!1,Qe=[],Je=typeof document<"u",Ue=bt,Ft=Fe||re?"cssFloat":"float",Un=Je&&!Ut&&!bt&&"draggable"in document.createElement("div"),$t=function(){if(Je){if(re)return!1;var o=document.createElement("x");return o.style.cssText="pointer-events:auto",o.style.pointerEvents==="auto"}}(),qt=function(e,n){var t=m(e),i=parseInt(t.width)-parseInt(t.paddingLeft)-parseInt(t.paddingRight)-parseInt(t.borderLeftWidth)-parseInt(t.borderRightWidth),r=xe(e,0,n),a=xe(e,1,n),s=r&&m(r),l=a&&m(a),u=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+N(r).width,f=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+N(a).width;if(t.display==="flex")return t.flexDirection==="column"||t.flexDirection==="column-reverse"?"vertical":"horizontal";if(t.display==="grid")return t.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&s.float&&s.float!=="none"){var d=s.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===d)?"vertical":"horizontal"}return r&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||u>=i&&t[Ft]==="none"||a&&t[Ft]==="none"&&u+f>i)?"vertical":"horizontal"},Vn=function(e,n,t){var i=t?e.left:e.top,r=t?e.right:e.bottom,a=t?e.width:e.height,s=t?n.left:n.top,l=t?n.right:n.bottom,u=t?n.width:n.height;return i===s||r===l||i+a/2===s+u/2},zn=function(e,n){var t;return Ke.some(function(i){var r=i[W].options.emptyInsertThreshold;if(!(!r||yt(i))){var a=N(i),s=e>=a.left-r&&e<=a.right+r,l=n>=a.top-r&&n<=a.bottom+r;if(s&&l)return t=i}}),t},Kt=function(e){function n(r,a){return function(s,l,u,f){var d=s.options.group.name&&l.options.group.name&&s.options.group.name===l.options.group.name;if(r==null&&(a||d))return!0;if(r==null||r===!1)return!1;if(a&&r==="clone")return r;if(typeof r=="function")return n(r(s,l,u,f),a)(s,l,u,f);var p=(a?s:l).options.group.name;return r===!0||typeof r=="string"&&r===p||r.join&&r.indexOf(p)>-1}}var t={},i=e.group;(!i||We(i)!="object")&&(i={name:i}),t.name=i.name,t.checkPull=n(i.pull,!0),t.checkPut=n(i.put),t.revertClone=i.revertClone,e.group=t},Qt=function(){!$t&&b&&m(b,"display","none")},Zt=function(){!$t&&b&&m(b,"display","")};Je&&!Ut&&document.addEventListener("click",function(o){if(qe)return o.preventDefault(),o.stopPropagation&&o.stopPropagation(),o.stopImmediatePropagation&&o.stopImmediatePropagation(),qe=!1,!1},!0);var me=function(e){if(c){e=e.touches?e.touches[0]:e;var n=zn(e.clientX,e.clientY);if(n){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.target=t.rootEl=n,t.preventDefault=void 0,t.stopPropagation=void 0,n[W]._onDragOver(t)}}},Wn=function(e){c&&c.parentNode[W]._isOutsideThisEl(e.target)};function g(o,e){if(!(o&&o.nodeType&&o.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(o));this.el=o,this.options=e=ie({},e),o[W]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(o.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return qt(o,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,s){a.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:g.supportPointer!==!1&&"PointerEvent"in window&&(!Ae||bt),emptyInsertThreshold:5};Re.initializePlugins(this,o,n);for(var t in n)!(t in e)&&(e[t]=n[t]);Kt(e);for(var i in this)i.charAt(0)==="_"&&typeof this[i]=="function"&&(this[i]=this[i].bind(this));this.nativeDraggable=e.forceFallback?!1:Un,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?w(o,"pointerdown",this._onTapStart):(w(o,"mousedown",this._onTapStart),w(o,"touchstart",this._onTapStart)),this.nativeDraggable&&(w(o,"dragover",this),w(o,"dragenter",this)),Ke.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),ie(this,Fn())}g.prototype={constructor:g,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(_e=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,c):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,t=this.el,i=this.options,r=i.preventOnFilter,a=e.type,s=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(s||e).target,u=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,f=i.filter;if(Qn(t),!c&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||i.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&Ae&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=J(l,i.draggable,t,!1),!(l&&l.animated)&&He!==l)){if(Se=$(l),Ne=$(l,i.draggable),typeof f=="function"){if(f.call(this,e,l,this)){U({sortable:n,rootEl:u,name:"filter",targetEl:l,toEl:t,fromEl:t}),z("filter",n,{evt:e}),r&&e.preventDefault();return}}else if(f&&(f=f.split(",").some(function(d){if(d=J(u,d.trim(),t,!1),d)return U({sortable:n,rootEl:d,name:"filter",targetEl:l,fromEl:t,toEl:t}),z("filter",n,{evt:e}),!0}),f)){r&&e.preventDefault();return}i.handle&&!J(u,i.handle,t,!1)||this._prepareDragStart(e,s,l)}}},_prepareDragStart:function(e,n,t){var i=this,r=i.el,a=i.options,s=r.ownerDocument,l;if(t&&!c&&t.parentNode===r){var u=N(t);if(T=r,c=t,I=c.parentNode,ge=c.nextSibling,He=t,Ye=a.group,g.dragged=c,he={target:c,clientX:(n||e).clientX,clientY:(n||e).clientY},Pt=he.clientX-u.left,Mt=he.clientY-u.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,c.style["will-change"]="all",l=function(){if(z("delayEnded",i,{evt:e}),g.eventCanceled){i._onDrop();return}i._disableDelayedDragEvents(),!It&&i.nativeDraggable&&(c.draggable=!0),i._triggerDragStart(e,n),U({sortable:i,name:"choose",originalEvent:e}),L(c,a.chosenClass,!0)},a.ignore.split(",").forEach(function(f){Wt(c,f.trim(),rt)}),w(s,"dragover",me),w(s,"mousemove",me),w(s,"touchmove",me),a.supportPointer?(w(s,"pointerup",i._onDrop),!this.nativeDraggable&&w(s,"pointercancel",i._onDrop)):(w(s,"mouseup",i._onDrop),w(s,"touchend",i._onDrop),w(s,"touchcancel",i._onDrop)),It&&this.nativeDraggable&&(this.options.touchStartThreshold=4,c.draggable=!0),z("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(Fe||re))){if(g.eventCanceled){this._onDrop();return}a.supportPointer?(w(s,"pointerup",i._disableDelayedDrag),w(s,"pointercancel",i._disableDelayedDrag)):(w(s,"mouseup",i._disableDelayedDrag),w(s,"touchend",i._disableDelayedDrag),w(s,"touchcancel",i._disableDelayedDrag)),w(s,"mousemove",i._delayedDragTouchMoveHandler),w(s,"touchmove",i._delayedDragTouchMoveHandler),a.supportPointer&&w(s,"pointermove",i._delayedDragTouchMoveHandler),i._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){c&&rt(c),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;y(e,"mouseup",this._disableDelayedDrag),y(e,"touchend",this._disableDelayedDrag),y(e,"touchcancel",this._disableDelayedDrag),y(e,"pointerup",this._disableDelayedDrag),y(e,"pointercancel",this._disableDelayedDrag),y(e,"mousemove",this._delayedDragTouchMoveHandler),y(e,"touchmove",this._delayedDragTouchMoveHandler),y(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?w(document,"pointermove",this._onTouchMove):n?w(document,"touchmove",this._onTouchMove):w(document,"mousemove",this._onTouchMove):(w(c,"dragend",this),w(T,"dragstart",this._onDragStart));try{document.selection?je(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(Ee=!1,T&&c){z("dragStarted",this,{evt:n}),this.nativeDraggable&&w(document,"dragover",Wn);var t=this.options;!e&&L(c,t.dragClass,!1),L(c,t.ghostClass,!0),g.active=this,e&&this._appendGhost(),U({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(Z){this._lastX=Z.clientX,this._lastY=Z.clientY,Qt();for(var e=document.elementFromPoint(Z.clientX,Z.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Z.clientX,Z.clientY),e!==n);)n=e;if(c.parentNode[W]._isOutsideThisEl(e),n)do{if(n[W]){var t=void 0;if(t=n[W]._onDragOver({clientX:Z.clientX,clientY:Z.clientY,target:e,rootEl:n}),t&&!this.options.dragoverBubble)break}e=n}while(n=zt(n));Zt()}},_onTouchMove:function(e){if(he){var n=this.options,t=n.fallbackTolerance,i=n.fallbackOffset,r=e.touches?e.touches[0]:e,a=b&&De(b,!0),s=b&&a&&a.a,l=b&&a&&a.d,u=Ue&&Y&&Nt(Y),f=(r.clientX-he.clientX+i.x)/(s||1)+(u?u[0]-it[0]:0)/(s||1),d=(r.clientY-he.clientY+i.y)/(l||1)+(u?u[1]-it[1]:0)/(l||1);if(!g.active&&!Ee){if(t&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<t)return;this._onDragStart(e,!0)}if(b){a?(a.e+=f-(nt||0),a.f+=d-(ot||0)):a={a:1,b:0,c:0,d:1,e:f,f:d};var p="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");m(b,"webkitTransform",p),m(b,"mozTransform",p),m(b,"msTransform",p),m(b,"transform",p),nt=f,ot=d,Z=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!b){var e=this.options.fallbackOnBody?document.body:T,n=N(c,!0,Ue,!0,e),t=this.options;if(Ue){for(Y=e;m(Y,"position")==="static"&&m(Y,"transform")==="none"&&Y!==document;)Y=Y.parentNode;Y!==document.body&&Y!==document.documentElement?(Y===document&&(Y=te()),n.top+=Y.scrollTop,n.left+=Y.scrollLeft):Y=te(),it=Nt(Y)}b=c.cloneNode(!0),L(b,t.ghostClass,!1),L(b,t.fallbackClass,!0),L(b,t.dragClass,!0),m(b,"transition",""),m(b,"transform",""),m(b,"box-sizing","border-box"),m(b,"margin",0),m(b,"top",n.top),m(b,"left",n.left),m(b,"width",n.width),m(b,"height",n.height),m(b,"opacity","0.8"),m(b,"position",Ue?"absolute":"fixed"),m(b,"zIndex","100000"),m(b,"pointerEvents","none"),g.ghost=b,e.appendChild(b),m(b,"transform-origin",Pt/parseInt(b.style.width)*100+"% "+Mt/parseInt(b.style.height)*100+"%")}},_onDragStart:function(e,n){var t=this,i=e.dataTransfer,r=t.options;if(z("dragStart",this,{evt:e}),g.eventCanceled){this._onDrop();return}z("setupClone",this),g.eventCanceled||(C=jt(c),C.removeAttribute("id"),C.draggable=!1,C.style["will-change"]="",this._hideClone(),L(C,this.options.chosenClass,!1),g.clone=C),t.cloneId=je(function(){z("clone",t),!g.eventCanceled&&(t.options.removeCloneOnHide||T.insertBefore(C,c),t._hideClone(),U({sortable:t,name:"clone"}))}),!n&&L(c,r.dragClass,!0),n?(qe=!0,t._loopId=setInterval(t._emulateDragOver,50)):(y(document,"mouseup",t._onDrop),y(document,"touchend",t._onDrop),y(document,"touchcancel",t._onDrop),i&&(i.effectAllowed="move",r.setData&&r.setData.call(t,i,c)),w(document,"drop",t),m(c,"transform","translateZ(0)")),Ee=!0,t._dragStartId=je(t._dragStarted.bind(t,n,e)),w(document,"selectstart",t),Ce=!0,window.getSelection().removeAllRanges(),Ae&&m(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,t=e.target,i,r,a,s=this.options,l=s.group,u=g.active,f=Ye===l,d=s.sort,p=F||u,_,v=this,E=!1;if(ht)return;function H(Te,en){z(Te,v,ne({evt:e,isOwner:f,axis:_?"vertical":"horizontal",revert:a,dragRect:i,targetRect:r,canSort:d,fromSortable:p,target:t,completed:M,onMove:function(Et,tn){return Ve(T,n,c,i,Et,N(Et),e,tn)},changed:V},en))}function q(){H("dragOverAnimationCapture"),v.captureAnimationState(),v!==p&&p.captureAnimationState()}function M(Te){return H("dragOverCompleted",{insertion:Te}),Te&&(f?u._hideClone():u._showClone(v),v!==p&&(L(c,F?F.options.ghostClass:u.options.ghostClass,!1),L(c,s.ghostClass,!0)),F!==v&&v!==g.active?F=v:v===g.active&&F&&(F=null),p===v&&(v._ignoreWhileAnimating=t),v.animateAll(function(){H("dragOverAnimationComplete"),v._ignoreWhileAnimating=null}),v!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(t===c&&!c.animated||t===n&&!t.animated)&&(_e=null),!s.dragoverBubble&&!e.rootEl&&t!==document&&(c.parentNode[W]._isOutsideThisEl(e.target),!Te&&me(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),E=!0}function V(){j=$(c),de=$(c,s.draggable),U({sortable:v,name:"change",toEl:n,newIndex:j,newDraggableIndex:de,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),t=J(t,s.draggable,n,!0),H("dragOver"),g.eventCanceled)return E;if(c.contains(e.target)||t.animated&&t.animatingX&&t.animatingY||v._ignoreWhileAnimating===t)return M(!1);if(qe=!1,u&&!s.disabled&&(f?d||(a=I!==T):F===this||(this.lastPutMode=Ye.checkPull(this,u,c,e))&&l.checkPut(this,u,c,e))){if(_=this._getDirection(e,t)==="vertical",i=N(c),H("dragOverValid"),g.eventCanceled)return E;if(a)return I=T,q(),this._hideClone(),H("revert"),g.eventCanceled||(ge?T.insertBefore(c,ge):T.appendChild(c)),M(!0);var D=yt(n,s.draggable);if(!D||Gn(e,_,this)&&!D.animated){if(D===c)return M(!1);if(D&&n===e.target&&(t=D),t&&(r=N(t)),Ve(T,n,c,i,t,r,e,!!t)!==!1)return q(),D&&D.nextSibling?n.insertBefore(c,D.nextSibling):n.appendChild(c),I=n,V(),M(!0)}else if(D&&jn(e,_,this)){var h=xe(n,0,s,!0);if(h===c)return M(!1);if(t=h,r=N(t),Ve(T,n,c,i,t,r,e,!1)!==!1)return q(),n.insertBefore(c,h),I=n,V(),M(!0)}else if(t.parentNode===n){r=N(t);var x=0,P,X=c.parentNode!==n,B=!Vn(c.animated&&c.toRect||i,t.animated&&t.toRect||r,_),ae=_?"top":"left",K=kt(t,"top","top")||kt(c,"top","top"),le=K?K.scrollTop:void 0;_e!==t&&(P=r[ae],Me=!1,Xe=!B&&s.invertSwap||X),x=$n(e,t,r,_,B?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,Xe,_e===t);var G;if(x!==0){var ee=$(c);do ee-=x,G=I.children[ee];while(G&&(m(G,"display")==="none"||G===b))}if(x===0||G===t)return M(!1);_e=t,Pe=x;var se=t.nextElementSibling,Q=!1;Q=x===1;var O=Ve(T,n,c,i,t,r,e,Q);if(O!==!1)return(O===1||O===-1)&&(Q=O===1),ht=!0,setTimeout(Ln,30),q(),Q&&!se?n.appendChild(c):t.parentNode.insertBefore(c,Q?se:t),K&&Lt(K,0,le-K.scrollTop),I=c.parentNode,P!==void 0&&!Xe&&(Le=Math.abs(P-N(t)[ae])),V(),M(!0)}if(n.contains(c))return M(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){y(document,"mousemove",this._onTouchMove),y(document,"touchmove",this._onTouchMove),y(document,"pointermove",this._onTouchMove),y(document,"dragover",me),y(document,"mousemove",me),y(document,"touchmove",me)},_offUpEvents:function(){var e=this.el.ownerDocument;y(e,"mouseup",this._onDrop),y(e,"touchend",this._onDrop),y(e,"pointerup",this._onDrop),y(e,"pointercancel",this._onDrop),y(e,"touchcancel",this._onDrop),y(document,"selectstart",this)},_onDrop:function(e){var n=this.el,t=this.options;if(j=$(c),de=$(c,t.draggable),z("drop",this,{evt:e}),I=c&&c.parentNode,j=$(c),de=$(c,t.draggable),g.eventCanceled){this._nulling();return}Ee=!1,Xe=!1,Me=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),mt(this.cloneId),mt(this._dragStartId),this.nativeDraggable&&(y(document,"drop",this),y(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ae&&m(document.body,"user-select",""),m(c,"transform",""),e&&(Ce&&(e.cancelable&&e.preventDefault(),!t.dropBubble&&e.stopPropagation()),b&&b.parentNode&&b.parentNode.removeChild(b),(T===I||F&&F.lastPutMode!=="clone")&&C&&C.parentNode&&C.parentNode.removeChild(C),c&&(this.nativeDraggable&&y(c,"dragend",this),rt(c),c.style["will-change"]="",Ce&&!Ee&&L(c,F?F.options.ghostClass:this.options.ghostClass,!1),L(c,this.options.chosenClass,!1),U({sortable:this,name:"unchoose",toEl:I,newIndex:null,newDraggableIndex:null,originalEvent:e}),T!==I?(j>=0&&(U({rootEl:I,name:"add",toEl:I,fromEl:T,originalEvent:e}),U({sortable:this,name:"remove",toEl:I,originalEvent:e}),U({rootEl:I,name:"sort",toEl:I,fromEl:T,originalEvent:e}),U({sortable:this,name:"sort",toEl:I,originalEvent:e})),F&&F.save()):j!==Se&&j>=0&&(U({sortable:this,name:"update",toEl:I,originalEvent:e}),U({sortable:this,name:"sort",toEl:I,originalEvent:e})),g.active&&((j==null||j===-1)&&(j=Se,de=Ne),U({sortable:this,name:"end",toEl:I,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){z("nulling",this),T=c=I=b=ge=C=He=ce=he=Z=Ce=j=de=Se=Ne=_e=Pe=F=Ye=g.dragged=g.ghost=g.clone=g.active=null,Qe.forEach(function(e){e.checked=!0}),Qe.length=nt=ot=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":c&&(this._onDragOver(e),Hn(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,t=this.el.children,i=0,r=t.length,a=this.options;i<r;i++)n=t[i],J(n,a.draggable,this.el,!1)&&e.push(n.getAttribute(a.dataIdAttr)||Kn(n));return e},sort:function(e,n){var t={},i=this.el;this.toArray().forEach(function(r,a){var s=i.children[a];J(s,this.options.draggable,i,!1)&&(t[r]=s)},this),n&&this.captureAnimationState(),e.forEach(function(r){t[r]&&(i.removeChild(t[r]),i.appendChild(t[r]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return J(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var t=this.options;if(n===void 0)return t[e];var i=Re.modifyOption(this,e,n);typeof i<"u"?t[e]=i:t[e]=n,e==="group"&&Kt(t)},destroy:function(){z("destroy",this);var e=this.el;e[W]=null,y(e,"mousedown",this._onTapStart),y(e,"touchstart",this._onTapStart),y(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(y(e,"dragover",this),y(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Ke.splice(Ke.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!ce){if(z("hideClone",this),g.eventCanceled)return;m(C,"display","none"),this.options.removeCloneOnHide&&C.parentNode&&C.parentNode.removeChild(C),ce=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(ce){if(z("showClone",this),g.eventCanceled)return;c.parentNode==T&&!this.options.group.revertClone?T.insertBefore(C,c):ge?T.insertBefore(C,ge):T.appendChild(C),this.options.group.revertClone&&this.animate(c,C),m(C,"display",""),ce=!1}}};function Hn(o){o.dataTransfer&&(o.dataTransfer.dropEffect="move"),o.cancelable&&o.preventDefault()}function Ve(o,e,n,t,i,r,a,s){var l,u=o[W],f=u.options.onMove,d;return window.CustomEvent&&!re&&!Fe?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=o,l.dragged=n,l.draggedRect=t,l.related=i||e,l.relatedRect=r||N(e),l.willInsertAfter=s,l.originalEvent=a,o.dispatchEvent(l),f&&(d=f.call(u,l,a)),d}function rt(o){o.draggable=!1}function Ln(){ht=!1}function jn(o,e,n){var t=N(xe(n.el,0,n.options,!0)),i=Gt(n.el,n.options,b),r=10;return e?o.clientX<i.left-r||o.clientY<t.top&&o.clientX<t.right:o.clientY<i.top-r||o.clientY<t.bottom&&o.clientX<t.left}function Gn(o,e,n){var t=N(yt(n.el,n.options.draggable)),i=Gt(n.el,n.options,b),r=10;return e?o.clientX>i.right+r||o.clientY>t.bottom&&o.clientX>t.left:o.clientY>i.bottom+r||o.clientX>t.right&&o.clientY>t.top}function $n(o,e,n,t,i,r,a,s){var l=t?o.clientY:o.clientX,u=t?n.height:n.width,f=t?n.top:n.left,d=t?n.bottom:n.right,p=!1;if(!a){if(s&&Le<u*i){if(!Me&&(Pe===1?l>f+u*r/2:l<d-u*r/2)&&(Me=!0),Me)p=!0;else if(Pe===1?l<f+Le:l>d-Le)return-Pe}else if(l>f+u*(1-i)/2&&l<d-u*(1-i)/2)return qn(e)}return p=p||a,p&&(l<f+u*r/2||l>d-u*r/2)?l>f+u/2?1:-1:0}function qn(o){return $(c)<$(o)?1:-1}function Kn(o){for(var e=o.tagName+o.className+o.src+o.href+o.textContent,n=e.length,t=0;n--;)t+=e.charCodeAt(n);return t.toString(36)}function Qn(o){Qe.length=0;for(var e=o.getElementsByTagName("input"),n=e.length;n--;){var t=e[n];t.checked&&Qe.push(t)}}function je(o){return setTimeout(o,0)}function mt(o){return clearTimeout(o)}Je&&w(document,"touchmove",function(o){(g.active||Ee)&&o.cancelable&&o.preventDefault()});g.utils={on:w,off:y,css:m,find:Wt,is:function(e,n){return!!J(e,n,e,!1)},extend:Pn,throttle:Ht,closest:J,toggleClass:L,clone:jt,index:$,nextTick:je,cancelNextTick:mt,detectDirection:qt,getChild:xe,expando:W};g.get=function(o){return o[W]};g.mount=function(){for(var o=arguments.length,e=new Array(o),n=0;n<o;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(g.utils=ne(ne({},g.utils),t.utils)),Re.mount(t)})};g.create=function(o,e){return new g(o,e)};g.version=kn;var k=[],Oe,gt,vt=!1,at,lt,Ze,Ie;function Zn(){function o(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return o.prototype={dragStarted:function(n){var t=n.originalEvent;this.sortable.nativeDraggable?w(document,"dragover",this._handleAutoScroll):this.options.supportPointer?w(document,"pointermove",this._handleFallbackAutoScroll):t.touches?w(document,"touchmove",this._handleFallbackAutoScroll):w(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var t=n.originalEvent;!this.options.dragOverBubble&&!t.rootEl&&this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?y(document,"dragover",this._handleAutoScroll):(y(document,"pointermove",this._handleFallbackAutoScroll),y(document,"touchmove",this._handleFallbackAutoScroll),y(document,"mousemove",this._handleFallbackAutoScroll)),Rt(),Ge(),Mn()},nulling:function(){Ze=gt=Oe=vt=Ie=at=lt=null,k.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,t){var i=this,r=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(r,a);if(Ze=n,t||this.options.forceAutoScrollFallback||Fe||re||Ae){st(n,this.options,s,t);var l=pe(s,!0);vt&&(!Ie||r!==at||a!==lt)&&(Ie&&Rt(),Ie=setInterval(function(){var u=pe(document.elementFromPoint(r,a),!0);u!==l&&(l=u,Ge()),st(n,i.options,u,t)},10),at=r,lt=a)}else{if(!this.options.bubbleScroll||pe(s,!0)===te()){Ge();return}st(n,this.options,pe(s,!1),!1)}}},ie(o,{pluginName:"scroll",initializeByDefault:!0})}function Ge(){k.forEach(function(o){clearInterval(o.pid)}),k=[]}function Rt(){clearInterval(Ie)}var st=Ht(function(o,e,n,t){if(e.scroll){var i=(o.touches?o.touches[0]:o).clientX,r=(o.touches?o.touches[0]:o).clientY,a=e.scrollSensitivity,s=e.scrollSpeed,l=te(),u=!1,f;gt!==n&&(gt=n,Ge(),Oe=e.scroll,f=e.scrollFn,Oe===!0&&(Oe=pe(n,!0)));var d=0,p=Oe;do{var _=p,v=N(_),E=v.top,H=v.bottom,q=v.left,M=v.right,V=v.width,D=v.height,h=void 0,x=void 0,P=_.scrollWidth,X=_.scrollHeight,B=m(_),ae=_.scrollLeft,K=_.scrollTop;_===l?(h=V<P&&(B.overflowX==="auto"||B.overflowX==="scroll"||B.overflowX==="visible"),x=D<X&&(B.overflowY==="auto"||B.overflowY==="scroll"||B.overflowY==="visible")):(h=V<P&&(B.overflowX==="auto"||B.overflowX==="scroll"),x=D<X&&(B.overflowY==="auto"||B.overflowY==="scroll"));var le=h&&(Math.abs(M-i)<=a&&ae+V<P)-(Math.abs(q-i)<=a&&!!ae),G=x&&(Math.abs(H-r)<=a&&K+D<X)-(Math.abs(E-r)<=a&&!!K);if(!k[d])for(var ee=0;ee<=d;ee++)k[ee]||(k[ee]={});(k[d].vx!=le||k[d].vy!=G||k[d].el!==_)&&(k[d].el=_,k[d].vx=le,k[d].vy=G,clearInterval(k[d].pid),(le!=0||G!=0)&&(u=!0,k[d].pid=setInterval((function(){t&&this.layer===0&&g.active._onTouchMove(Ze);var se=k[this.layer].vy?k[this.layer].vy*s:0,Q=k[this.layer].vx?k[this.layer].vx*s:0;typeof f=="function"&&f.call(g.dragged.parentNode[W],Q,se,o,Ze,k[this.layer].el)!=="continue"||Lt(k[this.layer].el,Q,se)}).bind({layer:d}),24))),d++}while(e.bubbleScroll&&p!==l&&(p=pe(p,!1)));vt=u}},30),Jt=function(e){var n=e.originalEvent,t=e.putSortable,i=e.dragEl,r=e.activeSortable,a=e.dispatchSortableEvent,s=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(n){var u=t||r;s();var f=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,d=document.elementFromPoint(f.clientX,f.clientY);l(),u&&!u.el.contains(d)&&(a("spill"),this.onSpill({dragEl:i,putSortable:t}))}};function _t(){}_t.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,t=e.putSortable;this.sortable.captureAnimationState(),t&&t.captureAnimationState();var i=xe(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(n,i):this.sortable.el.appendChild(n),this.sortable.animateAll(),t&&t.animateAll()},drop:Jt};ie(_t,{pluginName:"revertOnSpill"});function wt(){}wt.prototype={onSpill:function(e){var n=e.dragEl,t=e.putSortable,i=t||this.sortable;i.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),i.animateAll()},drop:Jt};ie(wt,{pluginName:"removeOnSpill"});g.mount(new Zn);g.mount(wt,_t);function Jn(o,e,n={}){let t;const{document:i=Tn,...r}=n,a={onUpdate:f=>{no(e,f.oldIndex,f.newIndex,f)}},s=()=>{const f=typeof o=="string"?i==null?void 0:i.querySelector(o):Cn(o);!f||t!==void 0||(t=new g(f,{...a,...r}))},l=()=>{t==null||t.destroy(),t=void 0},u=(f,d)=>{if(d!==void 0)t==null||t.option(f,d);else return t==null?void 0:t.option(f)};return xn(s),En(l),{stop:l,start:s,option:u}}function eo(o,e,n){const t=o.children[n];o.insertBefore(e,t)}function to(o){o.parentNode&&o.parentNode.removeChild(o)}function no(o,e,n,t=null){t!=null&&(to(t.item),eo(t.from,t.item,e));const i=an(o),r=i?[...dt(o)]:dt(o);if(n>=0&&n<r.length){const a=r.splice(e,1)[0];Yt(()=>{r.splice(n,0,a),i&&(o.value=r)})}}const oo=ln({__name:"DraggableList",props:{items:{type:Array,default:()=>[]},handle:String,idKey:{type:String,default:"id"}},emits:["itemsUpdate"],setup(o,{expose:e,emit:n}){const t=o,i=n,r=sn("el"),a=un([...t.items]);Jn(r,a,{animation:150,...t.handle?{handle:".handle"}:{}}),St(()=>t.items,l=>{a.value=[...l]}),St(()=>a.value,(l,u)=>{s(l,u)||i("itemsUpdate",[...l])},{deep:!0});function s(l,u){if(l===u)return!0;if(Array.isArray(l)&&Array.isArray(u)){if(l.length!==u.length)return!1;for(let f=0;f<l.length;f++)if(!s(l[f],u[f]))return!1;return!0}if(typeof l=="object"&&l!==null&&u!==null){const f=Object.keys(l),d=Object.keys(u);if(f.length!==d.length)return!1;for(let p of f)if(!d.includes(p)||!s(l[p],u[p]))return!1;return!0}return!1}return e({resetItems:()=>{a.value=[...t.items],i("itemsUpdate",[...t.items])},items:a.value}),(l,u)=>(A(),R("div",{ref_key:"el",ref:r},[(A(!0),R(ft,null,Xt(a.value,(f,d)=>(A(),R("div",{key:(typeof f=="object"?f[o.idKey]:f)||d},[dn(l.$slots,"item",{item:f,index:d})]))),128))],512))}}),io={class:"w-full"},ro=["onClick"],ao={key:2,class:"btn-icon size-6 bg-blue-200 text-blue-800 border-blue-300"},lo={key:3,class:"btn-icon size-8 ml-auto bg-blue-200 text-blue-800 border-blue-300"},Bt={__name:"TaskAssignEmployeeInput",props:{modelValue:{type:Array,default:()=>[]},employees:{type:Array,required:!0},listType:{type:String,default:"employee"},placeholder:{type:String,default:""},isRemovable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(o,{emit:e}){const n=o,t=e,i=ct({get(){return n.modelValue},set(l){t("update:modelValue",l)}});function r(l){i.value=[...l],console.log({newList:l})}function a(){return n.listType==="supervisor"}function s(l){return n.listType==="employee"&&l===0}return(l,u)=>(A(),ze(_n,{modelValue:i.value,"onUpdate:modelValue":u[0]||(u[0]=f=>i.value=f),options:o.employees,placeholder:o.placeholder,class:"border-gray-300 bg-sky-50/10 !rounded-2xl shadow-sm",multiple:"","hide-selected-value":""},{"selected-options":we(({items:f,removeItem:d,getOption:p})=>[S("div",io,[ve(oo,{items:f||[],handle:"handle",class:"flex flex-col gap-x-4 gap-y-2 w-full",onItemsUpdate:r},{item:we(({item:_,index:v})=>[ve(Ct,{user:p(_),isRemovable:v>0,isSortable:v>0,"avatar-size":"large","avatar-class":["transition",s(v)?"!size-8 ":""],class:fn(["w-full flex bg-sky-100/40 !shadow-sm border-sky-200 ",s(v)?"size-10 :size-12":"size-8"]),onRemoveClick:()=>d(_),onClick:E=>s(v)?E.stopPropagation():null},cn({after:we(()=>[!s(v)||a()?(A(),R("button",{key:0,class:"btn-icon size-6 ml-auto font-bold text-base text-red-600/60 hover:text-red-600 border border-red-200 flex items-center justify-center",onClick:pt(E=>d(_),["prevent","stop"])},u[2]||(u[2]=[S("i",{class:"fas fa-times"},null,-1)]),8,ro)):fe("",!0),f.length>1&&!s(v)&&!a()?(A(),R("button",{key:1,type:"button",class:"btn-icon size-6 handle text-gray-500 hover:text-gray-800",onClick:pt(()=>null,["stop"])},u[3]||(u[3]=[S("i",{class:"fas fa-arrows"},null,-1)]))):fe("",!0),a()?(A(),R("div",ao,u[4]||(u[4]=[S("i",{class:"fas fa-user-cowboy text-base"},null,-1)]))):s(v)?(A(),R("div",lo,u[5]||(u[5]=[S("i",{class:"fas fa-user-crown text-xl"},null,-1)]))):fe("",!0)]),_:2},[s(v)?{name:"title-bottom",fn:we(()=>[u[1]||(u[1]=S("span",{class:"text-xs italic text-gray-400"},"Responsible for Task",-1))]),key:"0"}:void 0]),1032,["user","isRemovable","isSortable","avatar-class","class","onRemoveClick","onClick"])]),_:2},1032,["items"])])]),option:we(({option:f})=>[ve(Ct,{user:f,class:"w-full border-gray-300"},null,8,["user"])]),_:1},8,["modelValue","options","placeholder"]))}},so={class:"bg-white z-20 sticky top-0 -mx-4 px-4"},uo={class:"col-span-full mb-2 font-semibold text-gray-800 text-sm line-clamp-3 mb-4"},fo={class:"min-h-[150px]"},co={key:1,class:"grid grid-cols-4 gap-8 mb-4 items-stretch"},po={class:"col-span-2 flex flex-col"},ho={key:0,class:"mb-4"},mo={class:"text-base"},go={key:2,class:"flex gap-x-3 gap-y-4 flex-wrap border p-2 rounded items-center flex-grow justify-center"},vo={key:1,class:"text-center w-full text-sm text-gray-400 py-2"},bo={class:"col-span-2 w-full flex flex-col"},yo={key:0,class:"mb-4"},_o={class:"text-base"},wo={class:"flex items-end col-span-full md:col-span-2 gap-4"},Eo={class:"w-1/2"},So={class:"w-1/2"},Do={class:"block text-gray-600 text-sm mb-1 font-medium"},xo={class:"bg-white border-t px-4 -mx-4 py-3 sticky bottom-0"},To={key:0,class:"mb-4 text-red-500 font-medium"},Co={key:1,class:"mb-4 text-blue-500 font-medium"},Oo={class:"flex justify-between items-center gap-4"},Io=["disabled"],Vo={__name:"TaskUserAssignForm",props:{taskId:{type:[Number,String],required:!0}},emits:["success","cancelClick"],setup(o,{emit:e}){var V;const n=mn(),t=pn(),i=ue([]),r=ue(""),a=ue(null),s=ue([]),l=ue([]),u=o,f=hn(),d=ue(null),p=ue(((V=t.user)==null?void 0:V.role)=="employee"?{}:{is_important:!1,is_urgent:!1,is_target:!1,assigned_at:"",deadline:""}),_=e;ut(async()=>{var h,x,P;r.value="loading";const D=await n.fetchTask(u.taskId,{with_parent:"true",with_department_users:"true"},{loadingBeforeFetch:!1,fetchOnly:!0});d.value=D.task,s.value=(h=d.value)!=null&&h.parent?(x=d.value.parent)==null?void 0:x.users:(D==null?void 0:D.to_department_users)||[],q(d.value),i.value=d.value.users,l.value=((P=d.value)==null?void 0:P.supervisors)||[],r.value=""});const v=ct(()=>{var D,h;return[...s.value,...(h=(D=d.value)==null?void 0:D.users)!=null&&h.length?[...d.value.users]:[]]}),E=ct(()=>{var h,x,P,X;return[...(h=d.value)!=null&&h.parent?(x=d.value.parent)==null?void 0:x.supervisors:f.users,...(X=(P=d.value)==null?void 0:P.supervisors)!=null&&X.length?[...d.value.supervisors]:[]]}),H=async()=>{var D,h;r.value="submitting",a.value=null;try{await n.updateTask(u.taskId,p.value,{loadingBeforeFetch:!1}),_("success")}catch(x){a.value=((h=(D=x.response)==null?void 0:D.data)==null?void 0:h.message)||"Assign users failed"}finally{r.value=""}};function q(D){var h,x,P;p.value=((h=t.user)==null?void 0:h.role)=="employee"?{}:{is_important:D.is_important,is_urgent:D.is_urgent,is_target:D.is_target,assigned_at:Tt(D.assigned_at),deadline:Tt(D.deadline),user_ids:(x=d.value.users)==null?void 0:x.map(X=>X.id),supervisor_ids:(P=d.value.supervisors)==null?void 0:P.map(X=>X.id)}}const M=ue();return ut(async()=>{await f.fetchTypeWiseEmployees({type:"academy_body,doctor,executive"})}),(D,h)=>{var x,P,X,B,ae,K,le,G,ee,se,Q;return A(),R("div",{class:"px-4 rounded border max-h-[98vh] overflow-auto",ref_key:"taskFormContainerRef",ref:M},[S("div",so,[h[8]||(h[8]=S("h2",{class:"text-xl font-semibold text-gray-800 mb-1 mt-4"},"Manage Employee(s) for Task",-1)),h[9]||(h[9]=S("hr",{class:"mb-4 !mt-0"},null,-1)),S("h3",uo,be((x=d.value)==null?void 0:x.title),1)]),S("form",{onSubmit:pt(H,["prevent"]),class:"relative min-h-40"},[S("div",fo,[r.value==="loading"?(A(),ze(gn,{key:0,class:"absolute inset-0 border-0 shadow-none"})):(A(),R("div",co,[S("div",po,[(P=d.value)!=null&&P.from_department?(A(),R("div",ho,[h[10]||(h[10]=S("div",{class:"text-sm text-gray-500"},"Task From Department",-1)),S("div",mo,be((B=(X=d.value)==null?void 0:X.from_department)==null?void 0:B.name),1)])):fe("",!0),h[11]||(h[11]=S("label",{class:"block uppercase text-xs text-gray-600"}," Supervisors ",-1)),((K=(ae=Be(t))==null?void 0:ae.user)==null?void 0:K.role)!=="employee"&&Be(t).isAdminMood?(A(),ze(Bt,{key:1,employees:E.value,"list-type":"supervisor",isRemovable:!0,modelValue:p.value.supervisor_ids,"onUpdate:modelValue":h[0]||(h[0]=O=>p.value.supervisor_ids=O),class:"flex-grow",placeholder:"--No Supervisor assigned--"},null,8,["employees","modelValue"])):(A(),R("div",go,[(l.value||[]).length>0?(A(!0),R(ft,{key:0},Xt(l.value,O=>(A(),ze(wn,{key:O.id,user:O},null,8,["user"]))),128)):(A(),R("div",vo," No Supervisor assigned "))]))]),S("div",bo,[(le=d.value)!=null&&le.to_department?(A(),R("div",yo,[h[12]||(h[12]=S("div",{class:"text-sm text-gray-500"},"Task To Department",-1)),S("div",_o,be((ee=(G=d.value)==null?void 0:G.to_department)==null?void 0:ee.name),1)])):fe("",!0),h[13]||(h[13]=S("label",{class:"block uppercase text-xs text-gray-600"}," Employees ",-1)),ve(Bt,{employees:v.value,modelValue:p.value.user_ids,"onUpdate:modelValue":h[1]||(h[1]=O=>p.value.user_ids=O),class:"flex-grow",placeholder:"--No employee(s) assigned--"},null,8,["employees","modelValue"])]),((Q=(se=Be(t))==null?void 0:se.user)==null?void 0:Q.role)!=="employee"&&Be(t).isAdminMood?(A(),R(ft,{key:0},[ve(vn,{class:"col-span-full"},{default:we(()=>h[14]||(h[14]=[S("div",{class:"px-2"},[S("b",{class:"fas fa-cog text-gray-400"}),S("span",{class:"text-gray-700 ml-2"},"Task Settings for Employee")],-1)])),_:1,__:[14]}),ve(bn,{class:"col-span-full",isImportant:p.value.is_important,"onUpdate:isImportant":h[2]||(h[2]=O=>p.value.is_important=O),isUrgent:p.value.is_urgent,"onUpdate:isUrgent":h[3]||(h[3]=O=>p.value.is_urgent=O)},null,8,["isImportant","isUrgent"]),ve(yn,{modelValue:p.value.is_target,"onUpdate:modelValue":h[4]||(h[4]=O=>p.value.is_target=O),class:"col-span-full md:col-span-2 mt-4"},null,8,["modelValue"]),S("div",wo,[S("div",Eo,[h[15]||(h[15]=S("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Assign Date",-1)),Dt(S("input",{"onUpdate:modelValue":h[5]||(h[5]=O=>p.value.assigned_at=O),type:"date",placeholder:"Enter Start Date",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[xt,p.value.assigned_at]])]),S("div",So,[S("label",Do,be(p.value.is_target?"Target":"")+" Deadline",1),Dt(S("input",{"onUpdate:modelValue":h[6]||(h[6]=O=>p.value.deadline=O),type:"date",placeholder:"Enter Start Date",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[xt,p.value.deadline]])])])],64)):fe("",!0)]))]),S("div",xo,[a.value?(A(),R("div",To,be(a.value),1)):fe("",!0),r.value=="submitting"?(A(),R("div",Co," Saving changes... ")):fe("",!0),S("div",Oo,[S("button",{disabled:r.value=="submitting"||r.value=="loading",type:"submit",class:"bg-indigo-500 hover:bg-indigo-600 text-white font-semibold px-5 py-2 rounded transition"},be(r.value=="submitting"?"Saving...":"Save"),9,Io),S("button",{type:"button",onClick:h[7]||(h[7]=O=>_("cancelClick")),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel ")])])],32)],512)}}};export{Vo as _,oo as a};
