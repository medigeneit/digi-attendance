import{o as h}from"./url-CePbr-gY.js";import{D as l,r as T,m as g}from"./index-BWMy-C83.js";import{u as _}from"./useTaskStore-C-L6IDWd.js";async function S({params:e={}}={}){return l.get("/tasks/employees",{params:e})}async function R(e,r){return l.put(`/my-tasks/${e}/update-status`,r)}async function $(e,{params:r={}}={}){const t=h(r);return l.delete(`/tasks/${e}${t?"?"+t:""}`)}async function C(e){return l.post(`/tasks/${e}/restore`)}function y(e,r){var s;let t=!0;if(r!=null&&r["user-ids"]&&(t=t&&e.users.some(o=>o.id==(r==null?void 0:r["user-ids"]))),r!=null&&r.status){const o={"not-completed":["IN_PROGRESS","PENDING"],"only-completed":["COMPLETED"]},n=o==null?void 0:o[r==null?void 0:r.status];t=t&&n.includes(e==null?void 0:e.status)}return((s=e==null?void 0:e.children_tasks)==null?void 0:s.length)>0?t&&(e==null?void 0:e.children_tasks.filter(o=>y(o,r)).length)>0:t}function P(e,r){var s,o;const t=n=>n.is_urgent&&n.is_important?4:n.is_urgent?3:n.is_important?2:n.is_target?1:0;return((o=(s=e==null?void 0:e.filter(n=>y(n,r)))==null?void 0:s.map(n=>({...n,children_tasks:n.children_tasks.length>0?P(n.children_tasks,r):[]})))==null?void 0:o.sort((n,u)=>{const d=t(n),p=t(u);return p!==d?p-d:u.priority!==n.priority?u.priority-n.priority:u.serial!==n.serial?u.serial-n.serial:u.id-n.id}))||[]}function D(e,r=0){const t=T([]),{updateTaskPriorities:s}=_(),o=g(()=>(console.log({getOldTaskList:e}),e()));function n(a){const c=o.value.map(m=>m.id),i=a.map(m=>m.id);u(c,i)?t.value=i:t.value=[],console.log({reordered:u(c,i)})}function u(a,c){if(a.length!==c.length)return!1;for(let i=0;i<a.length;i++)if(a[i]!==c[i])return!0;return!1}function d(){t.value=[]}async function p(){const a=await s(r,t.value);return t.value=[],a}const f=g(()=>t.value.length>0);return{handleItemsPriorityUpdate:n,saveTaskPriority:p,listHasRearranged:f,discardTaskPriority:d}}export{R as a,$ as d,S as g,P as m,C as r,D as u};
