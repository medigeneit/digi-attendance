import{u as D,b as M,d as N,A as T,r as i,e as V,y as w,p as j,B as F,c as y,o as a,a as t,s as _,h as A,v as E,z as P,k as b,g as k,F as $,q as H,t as n,f as z,i as L}from"./index-Dxc5EEcs.js";import{_ as W}from"./EmployeeFilter-CYDqYjva.js";import{L as G}from"./LoaderView-BcM1hLIT.js";import{u as I}from"./leave-application-C1WpOl2u.js";import{u as J}from"./user-BTAuYpLA.js";import"./company-ED4wwEHa.js";import"./department-DTxlX0oD.js";import"./SelectDropdown-BOLxy_Jy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-EBDAdyaN.js";const K={class:"space-y-2 px-4"},O={class:"flex flex-wrap gap-2"},Q={key:0,class:"text-center py-4"},X={key:1,class:"space-y-4"},Y={class:"overflow-x-auto"},Z={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},ee={class:"border border-gray-300 px-2"},te={class:"border border-gray-300 px-2"},re={class:"border border-gray-300 px-2"},se={class:"border border-gray-300 px-2"},oe={class:"border border-gray-300 px-2"},de={class:"border border-gray-300 px-2"},le=["innerHTML"],ae={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},ue={class:"border border-gray-300 px-2"},ye={class:"flex justify-center gap-2"},me=["onClick"],ie={key:0},Le={__name:"LeaveApplicationList",setup(ve){const v=D(),o=M(),d=I(),c=J();N();const{leaveApplications:S,loading:f}=T(d),q=i(null),m=i(o.query.date||d.selectedMonth),U=i(o.query.search||""),s=i({company_id:o.query.company_id||"",department_id:o.query.department_id||"all",type:o.query.type||"all",employee_id:o.query.employee_id||"",category:""}),u=async()=>{const l={company_id:s.value.company_id,department_id:s.value.department_id,selectedDate:m.value,selectedStatus:d.selectedStatus,query:U.value};s.value.employee_id&&(l.user_id=s.value.employee_id),f.value=!0,await d.fetchLeaveApplications(l),f.value=!1};V(async()=>{s.value.employee_id&&(await c.fetchUser(s.value.employee_id),q.value=c.user||null),await u()}),w(()=>[s.value.company_id,s.value.department_id,s.value.employee_id,m.value],async()=>{await u()}),w(()=>m.value,l=>{v.replace({query:{...o.query,date:l}}),u()});const g=j(()=>S.value||[]),C=async l=>{confirm("Are you sure to delete this application?")&&(await d.deleteLeaveApplication(l),await u())},B=()=>v.go(-1),R=()=>{v.replace({query:{...o.query,company_id:s.value.company_id,department_id:s.value.department_id,type:s.value.type,employee_id:s.value.employee_id}})};return(l,r)=>{const p=F("RouterLink");return a(),y("div",K,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:B},r[6]||(r[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),r[7]||(r[7]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Leave Applications",-1)),r[8]||(r[8]=t("div",null,null,-1))]),t("div",O,[_(W,{company_id:s.value.company_id,"onUpdate:company_id":r[0]||(r[0]=e=>s.value.company_id=e),department_id:s.value.department_id,"onUpdate:department_id":r[1]||(r[1]=e=>s.value.department_id=e),employee_id:s.value.employee_id,"onUpdate:employee_id":r[2]||(r[2]=e=>s.value.employee_id=e),category:s.value.category,"onUpdate:category":r[3]||(r[3]=e=>s.value.category=e),"with-type":!0,"initial-value":l.$route.query,onFilterChange:R},null,8,["company_id","department_id","employee_id","category","initial-value"]),t("div",null,[A(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":r[4]||(r[4]=e=>m.value=e),onChange:u,class:"input-1"},null,544),[[E,m.value]])]),t("div",null,[A(t("select",{"onUpdate:modelValue":r[5]||(r[5]=e=>b(d).selectedStatus=e),onChange:u,class:"input-1"},r[9]||(r[9]=[t("option",{value:"",selected:""},"All",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Rejected"},"Rejected",-1)]),544),[[P,b(d).selectedStatus]])])]),b(d).loading?(a(),y("div",Q,[_(G)])):(a(),y("div",X,[t("div",Y,[t("table",Z,[r[14]||(r[14]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border border-gray-300 px-2 text-left"},"#"),t("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),t("th",{class:"border border-gray-300 px-2 text-left"},"Last Working Day"),t("th",{class:"border border-gray-300 px-2 text-left"},"Resumption Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Leave Period"),t("th",{class:"border border-gray-300 px-2 text-left"},"Total Days"),t("th",{class:"border border-gray-300 px-2 text-left"},"Type"),t("th",{class:"border border-gray-300 px-2 text-left"},"Status"),t("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),t("tbody",null,[(a(!0),y($,null,H(g.value,(e,x)=>{var h;return a(),y("tr",{key:x,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",ee,n(x+1),1),t("td",te,n(((h=e==null?void 0:e.user)==null?void 0:h.name)||"Unknown"),1),t("td",re,n(e==null?void 0:e.last_working_date),1),t("td",se,n(e==null?void 0:e.resumption_date),1),t("td",oe,n(e==null?void 0:e.leave_period),1),t("td",de,[t("div",{innerHTML:e.duration||(e==null?void 0:e.total_leave_days)},null,8,le)]),t("td",ae,n(e==null?void 0:e.application_types),1),t("td",ne,n((e==null?void 0:e.status)||"N/A"),1),t("td",ue,[t("div",ye,[_(p,{to:{name:"LeaveApplicationShow",params:{id:e==null?void 0:e.id}},class:"btn-icon"},{default:L(()=>r[10]||(r[10]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[10]},1032,["to"]),(e==null?void 0:e.status)!=="Approved"?(a(),z(p,{key:0,to:{name:"LeaveApplicationEdit",params:{id:e==null?void 0:e.id}},class:"btn-icon"},{default:L(()=>r[11]||(r[11]=[t("i",{class:"far fa-edit text-orange-600"},null,-1)])),_:2,__:[11]},1032,["to"])):k("",!0),t("button",{onClick:_e=>C(e==null?void 0:e.id),class:"btn-icon text-red-500"},r[12]||(r[12]=[t("i",{class:"far fa-trash"},null,-1)]),8,me)])])])}),128)),g.value.length?k("",!0):(a(),y("tr",ie,r[13]||(r[13]=[t("td",{colspan:"7",class:"p-1 text-center text-red-500"},"No application found",-1)])))])])])]))])}}};export{Le as default};
