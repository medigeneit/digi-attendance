import{u as V,b as D,r as _,z as F,e as j,x as q,A as $,c as d,o as i,a as t,q as c,h as E,v as P,y as T,k as u,g as A,F as z,n as O,t as p,i as G}from"./index-D2XudXqW.js";import{_ as H}from"./EmployeeFilter-B01Hl13z.js";import{L as I}from"./LoaderView-DR-ecsZZ.js";import{u as J}from"./exchange-BEuquV6C.js";import{u as K}from"./user-BpN-B6VT.js";import"./company-OF8UZBhv.js";import"./department-B5Sb__96.js";import"./SelectDropdown-D1VKLKcP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-CuT18WaH.js";const Q={class:"space-y-2 px-4"},W={class:"flex flex-wrap gap-4"},X={key:0,class:"text-center py-4"},Y={key:1,class:"space-y-4"},Z={class:"overflow-x-auto"},tt={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},et={class:"border border-gray-300 px-2"},st={class:"border border-gray-300 px-2"},ot={class:"border border-gray-300 px-2"},rt={class:"border border-gray-300 px-2"},lt={class:"border border-gray-300 px-2"},at={class:"border border-gray-300 px-2 text-center"},dt=["href"],it={class:"border border-gray-300 px-2"},nt={class:"border border-gray-300 px-2"},pt={class:"flex gap-2"},ut=["onClick"],yt={key:0},C="shift",Et={__name:"ShiftExchangeList",setup(mt){const m=V(),l=D(),r=J(),f=K(),U=_(null),n=_(l.query.date||r.selectedMonth),{loading:h}=F(r),o=_({company_id:l.query.company_id||"",department_id:l.query.department_id||"all",type:l.query.type||"all",employee_id:l.query.employee_id||"",category:""});j(async()=>{h.value=!0,await f.fetchUsers(),U.value=f.users.find(a=>{var s;return a.id==((s=l==null?void 0:l.query)==null?void 0:s.employee_id)}),await y()});const y=async()=>{o.value.employee_id?await r.fetchAllExchanges({company_id:o.value.company_id,department_id:o.value.department_id,user_id:o.value.employee_id,type:C,selectedMonth:n.value,selectedStatus:r.selectedStatus}):await r.fetchAllExchanges({company_id:o.value.company_id,department_id:o.value.department_id,type:C,selectedMonth:n.value,selectedStatus:r.selectedStatus})};q(()=>[o.value.company_id,o.value.department_id,o.value.employee_id,n.value],async()=>{await y()}),q(n,a=>{m.replace({query:{...l.query,date:a}})});const M=()=>{m.go(-1)},R=async a=>{confirm("Are you sure to delete this application?")&&r.deleteExchange(a)},B=()=>{m.replace({query:{...l.query,company_id:o.value.company_id,department_id:o.value.department_id,type:o.value.type,employee_id:o.value.employee_id}})};return(a,s)=>{var b,v,S;const L=$("RouterLink");return i(),d("div",Q,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:M},s[6]||(s[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),s[7]||(s[7]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Shift Exchanges",-1)),s[8]||(s[8]=t("div",null,null,-1))]),t("div",W,[c(H,{company_id:o.value.company_id,"onUpdate:company_id":s[0]||(s[0]=e=>o.value.company_id=e),department_id:o.value.department_id,"onUpdate:department_id":s[1]||(s[1]=e=>o.value.department_id=e),employee_id:o.value.employee_id,"onUpdate:employee_id":s[2]||(s[2]=e=>o.value.employee_id=e),category:o.value.category,"onUpdate:category":s[3]||(s[3]=e=>o.value.category=e),"with-type":!0,"initial-value":a.$route.query,onFilterChange:B},null,8,["company_id","department_id","employee_id","category","initial-value"]),t("div",null,[E(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[4]||(s[4]=e=>n.value=e),onChange:y,class:"input-1"},null,544),[[P,n.value]])]),t("div",null,[E(t("select",{"onUpdate:modelValue":s[5]||(s[5]=e=>u(r).selectedStatus=e),onChange:y,class:"input-1"},s[9]||(s[9]=[t("option",{value:"",selected:""},"All",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Rejected"},"Rejected",-1)]),544),[[T,u(r).selectedStatus]])])]),u(r).loading?(i(),d("div",X,[c(I)])):(i(),d("div",Y,[t("div",Z,[t("table",tt,[s[14]||(s[14]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border border-gray-300 px-2 text-left"},"#"),t("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),t("th",{class:"border border-gray-300 px-2 text-left"},"Exchange Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Current Shift"),t("th",{class:"border border-gray-300 px-2 text-left"},"Exchange Shift"),t("th",{class:"border border-gray-300 px-2 text-left"},"Attachment"),t("th",{class:"border border-gray-300 px-2 text-left"},"Status"),t("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),t("tbody",null,[(i(!0),d(z,null,O((b=u(r))==null?void 0:b.all_exchanges,(e,N)=>{var w,k,g,x;return i(),d("tr",{key:e==null?void 0:e.id,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",et,p(N+1),1),t("td",st,p(((w=e==null?void 0:e.user)==null?void 0:w.name)||"Unknown"),1),t("td",ot,p(e==null?void 0:e.exchange_date),1),t("td",rt,p((g=(k=e==null?void 0:e.user)==null?void 0:k.shift)==null?void 0:g.name),1),t("td",lt,p((x=e==null?void 0:e.shift)==null?void 0:x.name),1),t("td",at,[e.attachment?(i(),d("a",{key:0,href:e==null?void 0:e.attachment,target:"_blank",class:"text-blue-500 underline"},s[10]||(s[10]=[t("i",{class:"fad fa-link"},null,-1)]),8,dt)):A("",!0)]),t("td",it,p((e==null?void 0:e.status)||"N/A"),1),t("td",nt,[t("div",pt,[c(L,{to:{name:"ExchangeShiftShow",params:{id:e==null?void 0:e.id}},class:"btn-icon"},{default:G(()=>s[11]||(s[11]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[11]},1032,["to"]),t("button",{onClick:_t=>R(e==null?void 0:e.id),class:"btn-icon text-red-500"},s[12]||(s[12]=[t("i",{class:"far fa-trash"},null,-1)]),8,ut)])])])}),128)),((S=(v=u(r))==null?void 0:v.all_exchanges)==null?void 0:S.length)===0?(i(),d("tr",yt,s[13]||(s[13]=[t("td",{colspan:"6",class:"p-2 text-center text-red-500"},"No shift exchanges found",-1)]))):A("",!0)])])])]))])}}};export{Et as default};
