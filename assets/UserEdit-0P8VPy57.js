import{K as I,i as O,s as C,r as S,b as G,z as W,x as T,c as i,a as o,j as Y,w as $,d as n,v as p,B as a,F as m,q as f,h as y,E as z,k as V,t as v,e as J,l as j,L as K,p as H,m as Q,f as X,g as Z,n as h,o as d}from"./index-BMFUpxpI.js";import{L as c}from"./LoaderView-BjA5IgTC.js";import{S as ee}from"./WeekendAssignModal-DaBMgluX.js";import{u as le}from"./company-B6Rd10_6.js";import{u as oe}from"./department-CxqDR1O-.js";import{u as te}from"./designation-D5hjlwya.js";import{u as se}from"./leave-approval-C0AqUJE5.js";import{u as ne}from"./shift-CaquSHH1.js";import{u as de}from"./user-DC9CwZ_M.js";import{d as re}from"./dayjs.min-Cbbdfn5l.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={class:"my-container space-y-2"},ae={class:"card-bg md:p-8 p-4 mx-4"},ue={class:"grid gap-4"},pe={class:"border p-4 rounded-md bg-gray-100"},ve={class:"grid md:grid-cols-2 gap-4"},me={class:"border p-4 rounded-md bg-gray-100"},fe={class:"grid md:grid-cols-2 gap-4"},ye=["value"],be=["value"],we=["value"],ge={class:""},ke={key:0,class:"flex flex-wrap gap-2 bg-white p-2 border rounded mt-1"},Se=["value"],Ue=["value"],_e={class:"border p-4 rounded-md bg-gray-100"},xe={class:"grid md:grid-cols-3 gap-4"},Ve={class:"relative"},De=["type"],Le={class:"flex justify-center gap-4"},Ie={__name:"UserEdit",setup(Pe){const U=se(),t=I({name:"",phone:"",email:"",password:"",role:"employee",type:"executive",address:"",device_user_id:null,is_active:!0,company_id:"",department_id:"",designation_id:"",shift_id:"",nid:"",date_of_birth:"",joining_date:"",employment_type:"Provisional",weekends:[],leave_approval_id:"",other_approval_id:""}),D=de(),b=le(),L=oe(),P=te(),A=ne(),_=O(),w=X(),M=Z(),{designations:E}=C(P),g=S(!1),k=S(!1),{shifts:N}=C(A),x=S(!1),u=S({weekends:[],start_month:"",end_month:""}),q=s=>{u.value=s};G(async()=>{k.value=!0,await b.fetchCompanies(),await U.fetchLeaveApprovals(),await B(),k.value=!1}),W(()=>t.company_id,async s=>{s&&(await L.fetchDepartments(s),await P.fetchDesignations(s),await A.fetchShifts(s),k.value=!1)});const B=async()=>{var s,e;try{const r=w.params.id,l=await D.fetchUser(r);l.assign_weekend?u.value={weekends:l.assign_weekend.weekends||[],start_month:re(l.assign_weekend.start_month).format("YYYY-MM")||"",end_month:l.assign_weekend.end_month||""}:u.value={weekends:[],start_month:"",end_month:""},t.name=l.name,t.phone=l.phone,t.email=l.email,t.address=l.address,t.nid=l.nid,t.date_of_birth=l.date_of_birth,t.joining_date=l.joining_date,t.employment_type=l.employment_type,t.weekends=l.weekends||[],t.is_active=l.is_active,t.company_id=l.company_id,t.department_id=l.department_id,t.designation_id=l.designation_id,t.shift_id=l.shift_id,t.role=l.role,t.type=l.type,t.device_user_id=l.device_user_id,t.leave_approval_id=l.leave_approval_id,t.other_approval_id=l.other_approval_id}catch(r){const l=((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to load user data";_.error(l),console.error(l),M.push({name:"UserList"})}},R=async()=>{var s,e;try{const r={...t,selected_weekend:u.value};await D.updateUser(w.params.id,r),_.success("User updated successfully"),M.push({name:"UserShow",params:{id:w.params.id}})}catch(r){const l=((e=(s=r.response)==null?void 0:s.data)==null?void 0:e.message)||"Failed to update user";_.error(l),console.error(l)}};T(()=>{var e;const s=(e=b.companies.find(r=>r.id===t.company_id))==null?void 0:e.name;return s?N.value[s]||[]:[]});const F=T(()=>{var e;const s=(e=b.companies.find(r=>r.id===t.company_id))==null?void 0:e.name;return s?E.value[s]||[]:[]});return(s,e)=>{const r=h("RouterLink");return d(),i("div",ie,[o("div",ae,[e[58]||(e[58]=o("h2",{class:"title-lg text-center"},"Edit Employee",-1)),k.value?(d(),Y(c,{key:0,class:"bg-gray-100 border shadow-none"})):(d(),i("form",{key:1,onSubmit:$(R,["prevent"]),class:"space-y-4"},[o("div",ue,[o("div",pe,[e[27]||(e[27]=o("p",{class:"title-md"},"Personal Info",-1)),e[28]||(e[28]=o("hr",{class:"my-2"},null,-1)),o("div",ve,[o("div",null,[e[21]||(e[21]=o("label",null,"Name",-1)),n(o("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>t.name=l),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[p,t.name]])]),o("div",null,[e[22]||(e[22]=o("label",null,"Phone",-1)),n(o("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>t.phone=l),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[p,t.phone]])]),o("div",null,[e[23]||(e[23]=o("label",null,"Email",-1)),n(o("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>t.email=l),type:"email",class:"w-full p-2 border rounded"},null,512),[[p,t.email]])]),o("div",null,[e[24]||(e[24]=o("label",null,"Address",-1)),n(o("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>t.address=l),type:"text",class:"w-full p-2 border rounded"},null,512),[[p,t.address]])]),o("div",null,[e[25]||(e[25]=o("label",null,"NID",-1)),n(o("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>t.nid=l),type:"text",class:"w-full p-2 border rounded"},null,512),[[p,t.nid]])]),o("div",null,[e[26]||(e[26]=o("label",null,"Date of Birth",-1)),n(o("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>t.date_of_birth=l),type:"date",class:"w-full p-2 border rounded"},null,512),[[p,t.date_of_birth]])])])]),o("div",me,[e[48]||(e[48]=o("p",{class:"title-md"},"Professional Info",-1)),e[49]||(e[49]=o("hr",{class:"my-2"},null,-1)),o("div",fe,[o("div",null,[e[30]||(e[30]=o("label",null,"Company",-1)),n(o("select",{id:"company_id","onUpdate:modelValue":e[6]||(e[6]=l=>t.company_id=l),class:"w-full border rounded px-3 py-2",required:""},[e[29]||(e[29]=o("option",{value:"",disabled:""},"Select a company",-1)),(d(!0),i(m,null,f(y(b).companies,l=>(d(),i("option",{key:l==null?void 0:l.id,value:l==null?void 0:l.id},v(l==null?void 0:l.name),9,ye))),128))],512),[[a,t.company_id]])]),o("div",null,[e[32]||(e[32]=o("label",null,"Department",-1)),n(o("select",{"onUpdate:modelValue":e[7]||(e[7]=l=>t.department_id=l),class:"w-full p-2 border rounded"},[e[31]||(e[31]=o("option",{value:"",disabled:""},"Select a department",-1)),(d(!0),i(m,null,f(y(L).departments,l=>(d(),i("option",{key:l==null?void 0:l.id,value:l==null?void 0:l.id},v(l==null?void 0:l.name),9,be))),128))],512),[[a,t.department_id]])]),o("div",null,[e[34]||(e[34]=o("label",null,"Designation",-1)),n(o("select",{"onUpdate:modelValue":e[8]||(e[8]=l=>t.designation_id=l),class:"w-full p-2 border rounded"},[e[33]||(e[33]=o("option",{value:"",disabled:""},"Select a designation",-1)),(d(!0),i(m,null,f(F.value,l=>(d(),i("option",{key:l==null?void 0:l.id,value:l==null?void 0:l.id},v(l==null?void 0:l.title),9,we))),128))],512),[[a,t.designation_id]])]),o("div",null,[e[36]||(e[36]=o("label",null,"Employment Type",-1)),n(o("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>t.employment_type=l),class:"w-full p-2 border rounded"},e[35]||(e[35]=[z('<option value="Provisional">Provisional</option><option value="Permanent">Permanent</option><option value="Part_Time">Part Time</option><option value="Remote">Remote</option><option value="Contract">Contract</option><option value="Freelance">Freelance</option><option value="Intern">Intern</option>',7)]),512),[[a,t.employment_type]])]),o("div",null,[e[38]||(e[38]=o("label",null,"Line Type",-1)),n(o("select",{"onUpdate:modelValue":e[10]||(e[10]=l=>t.type=l),class:"w-full p-2 border rounded",required:""},e[37]||(e[37]=[o("option",{value:"executive"},"Executive",-1),o("option",{value:"support_staff"},"Support Staff",-1),o("option",{value:"doctor"},"Doctor",-1),o("option",{value:"academy_body"},"Academy Body",-1)]),512),[[a,t.type]])]),o("div",null,[e[39]||(e[39]=o("label",null,"Joining Date",-1)),n(o("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>t.joining_date=l),type:"date",class:"w-full p-2 border rounded"},null,512),[[p,t.joining_date]])]),o("div",ge,[o("button",{type:"button",class:"btn-2",onClick:e[12]||(e[12]=l=>x.value=!0)}," Select Weekends "),u.value?(d(),i("div",ke,[o("p",null,[e[40]||(e[40]=o("strong",null,"Weekends:",-1)),V(" "+v(u.value.weekends.join(", ")),1)]),o("p",null,[e[41]||(e[41]=o("strong",null,"Start Month:",-1)),V(" "+v(u.value.start_month),1)])])):J("",!0),j(ee,{isOpen:x.value,assign_weekend:u.value,onClose:e[13]||(e[13]=l=>x.value=!1),onUpdate:q},null,8,["isOpen","assign_weekend"])]),o("div",null,[e[43]||(e[43]=o("label",null,"Leave Approval Group",-1)),n(o("select",{"onUpdate:modelValue":e[14]||(e[14]=l=>t.leave_approval_id=l),class:"w-full p-2 border rounded"},[e[42]||(e[42]=o("option",{value:"",disabled:""},"Select Leave Approval Group",-1)),(d(!0),i(m,null,f(y(U).leaveApprovals,l=>(d(),i("option",{key:l.id,value:l.id},v(l.name),9,Se))),128))],512),[[a,t.leave_approval_id]])]),o("div",null,[e[45]||(e[45]=o("label",null,"Other Approval Group",-1)),n(o("select",{"onUpdate:modelValue":e[15]||(e[15]=l=>t.other_approval_id=l),class:"w-full p-2 border rounded"},[e[44]||(e[44]=o("option",{value:"",disabled:""},"Select Other Approval Group",-1)),(d(!0),i(m,null,f(y(U).leaveApprovals,l=>(d(),i("option",{key:l.id,value:l.id},v(l.name),9,Ue))),128))],512),[[a,t.other_approval_id]])]),o("div",null,[e[47]||(e[47]=o("label",null,"Active Status",-1)),n(o("select",{"onUpdate:modelValue":e[16]||(e[16]=l=>t.is_active=l),class:"w-full p-2 border rounded"},e[46]||(e[46]=[o("option",{value:!0},"Active",-1),o("option",{value:!1},"Inactive",-1)]),512),[[a,t.is_active]])])])]),o("div",_e,[e[54]||(e[54]=o("p",{class:"title-md"},"Technical Info",-1)),e[55]||(e[55]=o("hr",{class:"my-2"},null,-1)),o("div",xe,[o("div",null,[e[51]||(e[51]=o("label",null,"Role",-1)),n(o("select",{"onUpdate:modelValue":e[17]||(e[17]=l=>t.role=l),class:"w-full p-2 border rounded",required:""},e[50]||(e[50]=[o("option",{value:"employee"},"Employee",-1),o("option",{value:"admin"},"Admin",-1),o("option",{value:"super_admin"},"Super Admin",-1),o("option",{value:"developer"},"Developer",-1)]),512),[[a,t.role]])]),o("div",null,[e[52]||(e[52]=o("label",null,"Biometric Device User ID",-1)),n(o("input",{"onUpdate:modelValue":e[18]||(e[18]=l=>t.device_user_id=l),type:"number",class:"w-full p-2 border rounded"},null,512),[[p,t.device_user_id]])]),o("div",null,[e[53]||(e[53]=o("label",null,"Password",-1)),o("div",Ve,[n(o("input",{"onUpdate:modelValue":e[19]||(e[19]=l=>t.password=l),type:g.value?"text":"password",class:"w-full p-2 border rounded"},null,8,De),[[K,t.password]]),o("span",{class:"absolute inset-y-0 right-3 flex items-center cursor-pointer",onClick:e[20]||(e[20]=l=>g.value=!g.value)},[o("i",{class:H(g.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])])])])]),o("div",Le,[j(r,{to:{name:"UserList",query:{company:y(w).query.company}},type:"button",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:Q(()=>e[56]||(e[56]=[V(" Cancel ")])),_:1},8,["to"]),e[57]||(e[57]=o("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"}," Save ",-1))])],32))])])}}};export{Ie as default};
