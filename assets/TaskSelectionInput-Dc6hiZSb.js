import{c as o,o as a,a as s,g as C,t as b,x as M,w as u,r as h,m as x,e as j,J as E,K as O,f as z,M as F,h as P,v as U,F as V,y as A,X as H}from"./index-B4NzZsrh.js";import{u as Q}from"./useTaskStore-sJA9i-Bo.js";const D=["title"],J={class:M(["line-clamp-1 mr-4 "])},K={key:0,class:"border btn-2 ml-auto"},R={__name:"TodoInputTaskItem",props:{task:Object,level:Number,selected:{type:[Number,String],default:null}},emits:["select"],setup(l,{emit:w}){const n=w;return(v,r)=>(a(),o("div",{class:M(["px-2 border-b py-1 h-12 over text-sm relative group/main cursor-pointer flex items-center",[l.task.id==l.selected?"text-red-50 bg-sky-500 px-2":"hover:bg-blue-50 hover:text-blue-500"]]),onClick:r[0]||(r[0]=u(()=>n("select",l.task),["prevent"])),title:l.task.title},[s("div",J,b(l.task.id)+" - "+b(l.task.title),1),l.task.id!=l.selected?(a(),o("button",K,"Select")):C("",!0)],10,D))}},X={key:0,class:"line-clamp-1"},q={key:1,class:"text-gray-500"},G={class:"ml-auto flex items-center justify-center h-full gap-2"},W={class:"flex items-center mb-2"},Y={class:"relative"},Z={class:"border flex rounded-t-md sticky top-0 bg-white"},_={class:"max-h-[200px] min-h-[60px] overflow-y-auto"},ee={key:0,class:"border"},te={key:1,class:"border h-[150px] flex flex-col items-center justify-center italic text-gray-500 text-sm"},ae={__name:"TaskSelectionInput",props:{todoType:{type:String,default:"task"},taskId:{type:[String,Number],default:null},show:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},taskQueryParams:{type:Object,default:()=>{}},isOnlyMyTask:{type:Boolean,default:!0},filterTasks:{type:Function,default:null}},emits:["update:todoType","update:taskId","update:show","addNewTaskClick"],setup(l,{emit:w}){const n=l,v=w,r=h(""),c=x({get:()=>n.taskId,set:t=>v("update:taskId",t)}),f=x({get:()=>n.show,set:t=>v("update:show",t)}),m=h(null),S=h({});function k(){if(!(m!=null&&m.value))return;const t=m.value.getBoundingClientRect(),e=window.innerHeight,i=300,y=e-t.bottom<i;S.value={position:"fixed",top:y?t.top-i+"px":t.bottom+"px",left:t.left+"px",width:t.width+"px",zIndex:5e3}}j(async()=>{B(),await E(),window.addEventListener("resize",k),document.addEventListener("scroll",k)});async function B(){n.isOnlyMyTask?await p.fetchAllMyTasks(n.taskQueryParams):await p.fetchAllTasks(n.taskQueryParams)}const p=Q();O(()=>{window.removeEventListener("resize",k),document.removeEventListener("scroll",k)});function L(t){c.value=t.id,f.value=!1}function $(){c.value="",f.value=!1}const g=x(()=>[...p.tasks||[]].find(t=>t.id==c.value)),I=x(()=>{const t=typeof n.filterTasks=="function"?[...p.tasks||[]].filter(i=>n.filterTasks(i)):p.tasks||[],e=r.value.trim().toUpperCase();return e.length?t.filter(i=>String(i.title||"").toUpperCase().includes(e)):t});return(t,e)=>{var i,T,y,N;return a(),o("div",{class:"relative border rounded-md shadow-sm flex items-center",ref_key:"anchor",ref:m},[s("div",{class:"w-full px-4 py-2 focus:ring-2 focus:ring-blue-500 cursor-pointer flex items-center",onClick:e[1]||(e[1]=u(()=>{l.readonly||(f.value=!0,k())},["stop"]))},[(i=g.value)!=null&&i.title?(a(),o("div",X,b((T=g.value)==null?void 0:T.id)+" - "+b((y=g.value)==null?void 0:y.title),1)):(a(),o("div",q,"Click to select todo")),s("div",G,[c.value&&!l.readonly?(a(),o("button",{key:0,class:"btn-icon fas fa-times !size-8 text-sm",onClick:e[0]||(e[0]=u(()=>$(),["prevent","stop"]))})):C("",!0),e[6]||(e[6]=s("span",{class:"fas fa-caret-down"},null,-1))])]),(a(),z(H,{to:"body"},[f.value?(a(),o("div",{key:0,style:F(S.value),class:"fixed bg-white rounded-b-md shadow-lg border z-[5000] p-4"},[s("div",W,[e[8]||(e[8]=s("h2",{class:"text-sky-800 text-sm uppercase"},"Task List",-1)),s("button",{class:"fas fa-redo text-gray-500 text-sm ml-4",onClick:e[2]||(e[2]=u(d=>B(),["prevent"]))}),s("button",{onClick:e[3]||(e[3]=u(()=>f.value=!1,["prevent"])),class:"ml-auto"},e[7]||(e[7]=[s("i",{class:"fas fa-times-circle text-red-700 text-xl hover:text-red-500"},null,-1)]))]),s("div",Y,[s("div",Z,[P(s("input",{type:"text",placeholder:"Search task",class:"w-full py-2 px-4 rounded-t-md outline-sky-200","onUpdate:modelValue":e[4]||(e[4]=d=>r.value=d)},null,512),[[U,r.value]]),e[9]||(e[9]=s("label",{class:"ml-auto flex w-8 items-center justify-center absolute right-0 top-0 bottom-0"},[s("i",{class:"fas fa-search"})],-1))])]),s("div",_,[((N=I.value)==null?void 0:N.length)>0?(a(),o("div",ee,[(a(!0),o(V,null,A(I.value,d=>(a(),z(R,{key:d.id,task:d,onSelect:L,selected:c.value},null,8,["task","selected"]))),128))])):(a(),o("div",te,[e[10]||(e[10]=s("div",null,"No Tasks Found",-1)),s("button",{onClick:e[5]||(e[5]=u(d=>v("addNewTaskClick"),["prevent"])),class:"btn-3"},"Add New Task")]))])],4)):C("",!0)]))],512)}}};export{ae as _};
