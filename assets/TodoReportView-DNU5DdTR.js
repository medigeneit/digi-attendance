import{_ as Je,r as R,G as Ee,x as D,q as K,c as d,o,a as e,O as Ie,w as J,s as w,d as q,l as Se,v as Ne,f as Qe,u as Ye,D as $e,h as oe,y as Ce,k as v,j as Xe,m as Z,n as U,t as p,F as N,e as j,b as H,N as Ze}from"./index-Ck--8GOP.js";import{L as qe}from"./LoaderView-D7eqSlTh.js";import{_ as Ge}from"./EmployeeFilter-PQgfxrZR.js";import{U as et}from"./UserChip-BHiXRNSK.js";import{g as Re,b as W}from"./datetime-Du_mcDA9.js";import{j as tt}from"./url-Buz9GlSr.js";import{u as st}from"./attendance-TOZPdVH8.js";import{u as nt}from"./company-Cp13ehi2.js";import{u as at}from"./department-BomZ8Cd_.js";import{u as rt}from"./useTodoDateStore-BE9IPhle.js";import"./EmployeeDropdownInput-BvmFYTeI.js";import"./SelectDropdown-BYraj_i4.js";import"./user-jxH749hX.js";const ot={class:"px-4 py-4 md:py-3 bg-white rounded-md border"},dt={class:"flex flex-wrap items-center gap-3"},it=["disabled"],lt={class:"print-hide"},pt={class:"flex flex-col md:flex-row flex-wrap items-end md:ml-auto w-full md:w-auto gap-x-3 gap-y-4 print-hide"},ut={class:"flex items-center justify-between w-full md:w-auto gap-3"},mt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},yt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},ct={__name:"TodoReportHeading",props:{loading:{type:Boolean,default:!1},companyId:{type:[String,Number],default:""},departmentId:{type:[String,Number],default:""},employeeId:{type:[String,Number],default:""},lineType:{type:String,default:"all"},startDate:{type:String,default:""},endDate:{type:String,default:""}},emits:["reloadClick","change"],setup(B,{expose:$,emit:G}){const u=B,A=R(null),P=G,l=Ee({companyId:String(u.companyId||""),departmentId:u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",employeeId:String(u.employeeId||""),lineType:u.lineType||"all",startDate:u.startDate||"",endDate:u.endDate||""}),z=D(()=>({companyId:l.companyId,departmentId:l.departmentId,employeeId:l.employeeId,lineType:l.lineType,startDate:l.startDate,endDate:l.endDate}));function Q(){P("change",{...z.value})}K(()=>[u.companyId,u.departmentId,u.employeeId,u.lineType,u.startDate,u.endDate],()=>{l.companyId=String(u.companyId||""),l.departmentId=u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",l.employeeId=String(u.employeeId||""),l.lineType=u.lineType||"all",l.startDate=u.startDate||"",l.endDate=u.endDate||""});function M(t){const i=new Date(l.startDate);i.setDate(i.getDate()+t),l.startDate=i.toISOString().split("T")[0];const g=new Date(l.endDate);g.setDate(g.getDate()+t),l.endDate=g.toISOString().split("T")[0]}return K(z,Q,{deep:!0}),$({employees:D(()=>{var t;return((t=A.value)==null?void 0:t.employees)||[]})}),(t,i)=>(o(),d("div",ot,[e("div",dt,[Ie(t.$slots,"before",{},void 0,!0),e("button",{class:w(["btn-icon print-hide",{"animate-spin !bg-opacity-0":B.loading}]),onClick:i[0]||(i[0]=J(g=>P("reloadClick"),["prevent"])),disabled:B.loading,title:"Reload"},[e("i",{class:w(["fas fa-redo",[B.loading?"text-gray-400":"text-gray-500"]])},null,2)],10,it),e("span",lt,[Ie(t.$slots,"after",{},void 0,!0)]),e("div",pt,[q(Ge,{ref_key:"employeeFilterRef",ref:A,company_id:l.companyId,"onUpdate:company_id":i[1]||(i[1]=g=>l.companyId=g),department_id:l.departmentId,"onUpdate:department_id":i[2]||(i[2]=g=>l.departmentId=g),employee_id:l.employeeId,"onUpdate:employee_id":i[3]||(i[3]=g=>l.employeeId=g),line_type:l.lineType,"onUpdate:line_type":i[4]||(i[4]=g=>l.lineType=g),"with-type":!0,class:"flex-1 gap-y-4 md:flex items-center justify-between w-full md:w-auto"},null,8,["company_id","department_id","employee_id","line_type"]),e("div",ut,[e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:i[5]||(i[5]=J(()=>M(-1),["prevent"]))},i[9]||(i[9]=[e("span",{class:"fas fa-arrow-left"},null,-1)])),e("div",mt,[i[10]||(i[10]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Start Date",-1)),Se(e("input",{type:"date","onUpdate:modelValue":i[6]||(i[6]=g=>l.startDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ne,l.startDate]])]),e("div",yt,[i[11]||(i[11]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"End Date",-1)),Se(e("input",{type:"date","onUpdate:modelValue":i[7]||(i[7]=g=>l.endDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ne,l.endDate]])]),e("button",{class:"btn-3 px-3 rounded size-[31px]",onClick:i[8]||(i[8]=J(()=>M(1),["prevent"]))},i[12]||(i[12]=[e("span",{class:"fas fa-arrow-right"},null,-1)]))])])])]))}},gt=Je(ct,[["__scopeId","data-v-c25b1fcb"]]),xt={class:"container print:flex-grow mx-auto print:w-full print:px-0 print:py-0"},ft=["disabled"],bt={key:0,class:"bg-white border rounded-md mb-2 p-4 text-sm print:border-0 print:mb-2 print:px-0 print:w-full relative overflow-visible z-40"},vt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-y-2 gap-x-6"},wt={class:"font-medium text-gray-800"},ht={class:"col-span-2"},_t={class:"font-medium text-gray-800"},Dt={class:"inline-flex items-center gap-5 font-bold"},kt={class:"text-gray-700"},Tt={key:0,class:"mt-2 w-[280px] sm:w-[320px] lg:w-[280px] xl:w-[320px] bg-white border border-gray-200 rounded-md p-3 shadow-lg text-left absolute right-0"},It={class:"flex items-center justify-between mb-2"},St={class:"text-[11px] text-gray-500"},Nt={class:"space-y-3 max-h-56 overflow-auto pr-1 z-50"},$t={class:"pt-2 border-t border-dashed border-gray-200"},Ct={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1 flex items-center justify-between"},Rt={class:"flex items-center gap-2"},Et={key:0,class:"bg-red-500 rounded-md px-1.5 text-white text-center"},At={key:0,class:"flex flex-wrap gap-2"},Lt={key:0,class:"text-xs text-gray-400"},Ot=["title"],Ut={class:"block max-w-[160px] truncate"},jt={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1"},Bt={key:0,class:"bg-green-500 rounded-md px-1.5 text-white text-center"},Pt={class:"flex flex-wrap gap-2"},zt={key:0,class:"text-xs text-gray-400"},Mt=["title"],Vt={class:"block max-w-[160px] truncate"},Ft={key:1,class:"text-center text-gray-500 py-12 border bg-gray-50 rounded-md min-h-[70vh] flex flex-col items-center justify-center space-y-4"},Ht={key:3,class:"overflow-x-auto md:overflow-clip bg-white border border-t-0 rounded-md shadow-sm print:shadow-none print:rounded-none print:border-gray-400"},Wt={class:"min-w-full text-left text-sm border-separate border-spacing-0"},Kt={class:"bg-gray-50 text-gray-600 uppercase tracking-wide text-xs"},Jt={class:"border-y print:border-gray-400 sticky md:top-[123px] z-30 rounded-t-md"},Qt={class:"px-4 py-3 border md:w-[100px] print:w-auto print:border-l print:border-l-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center whitespace-nowrap"},Yt={class:"flex items-center justify-between gap-2"},Xt={class:"ml-1 text-[10px] text-gray-500"},Zt={key:0,class:"px-4 py-3 border bg-white bg-opacity-70 backdrop-blur-sm text-center"},qt={class:"divide-y divide-gray-200"},Gt={key:0},es=["colspan"],ts=["rowspan"],ss={class:"sticky top-[180px] bg-white text-center"},ns=["rowspan"],as=["user"],rs={key:0,class:"flex items-center gap-3"},os={class:"font-semibold text-gray-800"},ds=["href"],is={class:"text-xs text-gray-500"},ls=["rowspan"],ps={class:"sticky top-[180px] bg-white"},us={key:0,class:"text-[11px] text-gray-500 mt-2"},ms={key:0,class:"grid grid-cols-2 gap-4"},ys={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},cs={class:"flex gap-1 items-center justify-between"},gs={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},xs={class:"flex gap-1 items-center justify-between"},fs={class:"rounded-md bg-indigo-50 border border-indigo-100 px-2"},bs={class:"flex gap-1 items-center justify-between"},vs={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},ws={class:"flex gap-1 items-center justify-between"},hs={key:1,class:"mt-1 text-gray-500 text-center"},_s=["rowspan"],Ds={class:"sticky top-[180px] bg-white"},ks={class:"font-medium"},Ts={class:"text-gray-400 mr-2"},Is={class:"text-xs text-gray-500"},de="border-b-2 border-b-blue-200",zs={__name:"TodoReportView",setup(B){var ye,ce,ge,xe,fe,be;const $=Qe(),G=Ye(),u=rt(),A=nt(),P=at(),{companies:l}=$e(A),{departments:z}=$e(P),Q=R(null),M=Re(new Date),t=Ee({companyId:((ye=$.query)==null?void 0:ye.company_id)||"",departmentId:((ce=$.query)==null?void 0:ce.department_id)||"",employeeId:((ge=$.query)==null?void 0:ge.employee_id)||"",lineType:((xe=$.query)==null?void 0:xe.line_type)||"all",startDate:((fe=$.query)==null?void 0:fe.start_date)||M,endDate:((be=$.query)==null?void 0:be.end_date)||M}),i=D(()=>{if(!t.startDate||!t.endDate)return[];const n=new Date(t.startDate),s=new Date(t.endDate);if(Number.isNaN(n.getTime())||Number.isNaN(s.getTime()))return[];const r=n<=s?1:-1,y=new Date(n),c=[];for(;c.push(Re(y)),y.getTime()!==s.getTime();)y.setDate(y.getDate()+r);return c}),g=D(()=>{var s;return[...((s=Q.value)==null?void 0:s.employees)||[]].filter(r=>t.employeeId?String(r.id)===String(t.employeeId):!0).sort((r,y)=>{var c,f;return(((c=r.user)==null?void 0:c.name)||"").localeCompare(((f=y.user)==null?void 0:f.name)||"")}).map(r=>{const y=u.todo_dates.filter(a=>{var b;return String((b=a.user)==null?void 0:b.id)===String(r.id)});let c=i.value.map(a=>{const b={WORKING:1,PENDING:2,DEPENDANT:3,COMPLETED:4,BACK_LOG:5},k=y.filter(_=>_.date===a).sort((_,I)=>{const m=b[_.status]||999,x=b[I.status]||999;return m!==x?m-x:(_.priority||0)-(I.priority||0)});return k.length?{date:a,rowSpan:k.length,todos:k}:{date:a,rowSpan:1,todos:[{id:`empty-${r.id}-${a}`,isPlaceholder:!0,title:"",date:a}]}});c.length||(c=[{date:null,rowSpan:1,todos:[{id:`empty-${r.id}`,isPlaceholder:!0,title:""}]}]);const f=c.reduce((a,b)=>a+b.rowSpan,0);return{user:r,dates:c,rowSpan:Math.max(1,f)}})}),Ae=D(()=>{if(!t.startDate||!t.endDate)return"";const n=W(t.startDate,{weekDay:"long"}),s=W(t.endDate,{weekDay:"long"});return`${n} ~ ${s}`}),Le=D(()=>A.employees||[]),Oe={all:"All Types",executive:"Executive",support_staff:"Support Staff",doctor:"Doctor",academy_body:"Academy Body"},E=D(()=>{var c,f,a,b,k,_,I,m;const n=t.companyId&&((c=l.value)!=null&&c.length)?(f=l.value.find(x=>String(x.id)===String(t.companyId)))==null?void 0:f.name:null,s=t.departmentId&&((a=z.value)!=null&&a.length)?(b=z.value.find(x=>String(x.id)===String(t.departmentId)))==null?void 0:b.name:null;let r=null;t.employeeId&&(r=((_=(k=Le.value)==null?void 0:k.find(x=>String(x.id)===String(t.employeeId)))==null?void 0:_.name)||((m=(I=g.value.find(x=>{var L;return String(((L=x.user)==null?void 0:L.id)||"")===String(t.employeeId)}))==null?void 0:I.user)==null?void 0:m.name)||null);const y=t.startDate===t.endDate&&t.startDate?W(t.startDate,{weekDay:"long"}):Ae.value||"-";return{company:n||(t.companyId?`#${t.companyId}`:"All Companies"),department:s||(t.departmentId?`#${t.departmentId}`:"All Departments"),employee:r||(t.employeeId?`#${t.employeeId}`:"All Employees"),lineType:Oe[t.lineType]||t.lineType||"All Types",dateRange:y}}),O=R(!1),ee=R(null),te=D(()=>{var n;return((n=g.value)==null?void 0:n.length)||0}),ie=D(()=>{var n,s;return Math.max(0,te.value-(((s=(n=T.value)==null?void 0:n.withoutTodos)==null?void 0:s.length)||0))}),Y=R(!0),se=R(!1),V=R(!1),ne=R(null),le=n=>{O.value&&ee.value&&(ee.value.contains(n.target)||(O.value=!1))},T=D(()=>{var n;return(n=g.value)!=null&&n.length?g.value.reduce((s,r,y)=>{var a,b,k,_,I,m;const c=r.dates.reduce((x,L)=>x+L.todos.filter(C=>!C.isPlaceholder).length,0),f={id:((a=r.user)==null?void 0:a.id)??((b=r.user)==null?void 0:b.user_id)??((k=r.user)==null?void 0:k.uid)??((_=r.user)==null?void 0:_.email)??`${((I=r.user)==null?void 0:I.name)||"unknown"}-${y}`,name:((m=r.user)==null?void 0:m.name)||"Unknown user"};return c>0?s.withTodos.push(f):s.withoutTodos.push(f),s},{withTodos:[],withoutTodos:[]}):{withTodos:[],withoutTodos:[]}}),pe=D(()=>{if(!V.value)return g.value;const n=new Set((T.value.withoutTodos||[]).map(s=>String(s.id??s.name??"")));return g.value.filter(s=>{var y,c,f,a,b;const r=((y=s.user)==null?void 0:y.id)??((c=s.user)==null?void 0:c.user_id)??((f=s.user)==null?void 0:f.uid)??((a=s.user)==null?void 0:a.email)??((b=s.user)==null?void 0:b.name)??"";return!n.has(String(r))})});function Ue(){V.value=!V.value,se.value=V.value}const ue=n=>{se.value&&ne.value&&(ne.value.contains(n.target)||(se.value=!1))},je=n=>n==="COMPLETED"?"bg-green-100 text-green-700 border border-green-200":n==="WORKING"?"bg-blue-100 text-blue-700 border border-blue-200":n==="PENDING"?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-gray-100 text-gray-700 border border-gray-200";function Be(){G.replace({query:{...$.query,company_id:t.companyId||void 0,department_id:t.departmentId||void 0,employee_id:t.employeeId||void 0,line_type:t.lineType||void 0,start_date:t.startDate||void 0,end_date:t.endDate||void 0}})}async function ae(){!t.companyId||!t.startDate||!t.endDate||(await u.fetchTodoDates({"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate}),Fe())}function Pe(n){t.companyId=n.companyId||"",t.departmentId=n.departmentId||"",t.employeeId=n.employeeId||"",t.lineType=n.lineType||"all",t.startDate=n.startDate||"",t.endDate=n.endDate||""}function ze(){window.print()}const X=D(()=>t.startDate===t.endDate);K(()=>t.companyId,n=>{n&&(P.fetchDepartments(n),A.fetchEmployee(n))},{immediate:!0}),K(()=>({...t}),(n,s)=>{JSON.stringify(n)!==JSON.stringify(s)&&(Be(),ae())},{deep:!0}),K(()=>$.query,n=>{t.companyId=(n==null?void 0:n.company_id)||t.companyId,t.departmentId=(n==null?void 0:n.department_id)||t.departmentId,t.employeeId=(n==null?void 0:n.employee_id)||t.employeeId,t.lineType=(n==null?void 0:n.line_type)||t.lineType,t.startDate=(n==null?void 0:n.start_date)||t.startDate,t.endDate=(n==null?void 0:n.end_date)||t.endDate}),oe(()=>{A.fetchCompanies({ignore_permission:!0}),ae()}),oe(()=>{document.addEventListener("click",le,!0)}),Ce(()=>{document.removeEventListener("click",le,!0)}),oe(()=>{document.addEventListener("click",ue,!0)}),Ce(()=>{document.removeEventListener("click",ue,!0)});const Me=st(),me=R([]),re=R(!1),Ve=D(()=>t.startDate===t.endDate),Fe=async()=>{if(!(!t.companyId||!t.startDate||!t.endDate)){re.value=!0;try{const n=await Me.getDateRangeAttendanceSummary(t.startDate,t.endDate,t.companyId,t.lineType,t.employeeId,!0);n&&(me.value=n)}finally{re.value=!1}}};function He(n,s){var y;const r=((y=me.value)==null?void 0:y.find(c=>String(c.employee_id)===String(n)))||null;return r?!s&&Ve.value?(r==null?void 0:r.attendance[t.startDate])||null:(r==null?void 0:r.attendance[s])||null:null}function We(n,s){const r=He(n,s);return r?{hasData:!0,in:r.in||"-",out:r.out||"-",late:r.late||"-",early:r.early||"-",comment:r.comment||"-"}:{hasData:!1,in:"-",out:"-",late:"-",early:"-",comment:"-"}}function Ke(n,s,r,y){const c=r===n.dates.length-1,f=y===s.todos.length-1;return c&&f}function F(n,s,r,y){return Ke(n,s,r,y)?de:""}return(n,s)=>{var r,y,c,f;return o(),d("div",xt,[q(gt,{ref_key:"headingRef",ref:Q,"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate,loading:U(u).loading,class:"mb-4 print:px-0 print:py-0 print:mb-2 print:border-0 print:border-b print:border-gray-400 print:rounded-none print:w-full sticky top-[58px] z-50",onChange:Pe,onReloadClick:ae},{before:Z(()=>s[3]||(s[3]=[e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-800"},"Todo Report")],-1)])),after:Z(()=>[e("button",{type:"button",class:"btn-icon print-hide disabled:opacity-35 cursor-pointer disabled:cursor-not-allowed",onClick:J(ze,["prevent"]),disabled:U(u).loading},s[4]||(s[4]=[e("i",{class:"fas fa-print"},null,-1)]),8,ft)]),_:1},8,["company-id","department-id","employee-id","line-type","start-date","end-date","loading"]),t.companyId&&t.startDate&&t.endDate?(o(),d("div",bt,[e("div",vt,[e("div",null,[s[5]||(s[5]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Company",-1)),e("div",wt,p(E.value.company),1)]),e("div",null,[s[6]||(s[6]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Department",-1)),e("div",{class:w(["font-medium",[E.value.department=="All Departments"?"text-gray-400":"text-gray-800"]])},p(E.value.department),3)]),e("div",null,[s[7]||(s[7]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Line Type",-1)),e("div",{class:w(["font-medium",[E.value.lineType=="All Types"?"text-gray-400":"text-gray-800"]])},p(E.value.lineType),3)]),e("div",null,[s[8]||(s[8]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Employee",-1)),e("div",{class:w(["font-medium",[E.value.employee=="All Employees"?"text-gray-400":"text-gray-800"]])},p(E.value.employee),3)]),e("div",ht,[s[9]||(s[9]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Date",-1)),e("div",_t,p(E.value.dateRange),1)]),e("div",{ref_key:"assignmentSummaryRef",ref:ee,class:"print-hide relative"},[e("button",{type:"button",class:"px-3 bg-white text-gray-700 hover:bg-gray-50 w-full text-bg text-right",onClick:s[0]||(s[0]=a=>O.value=!O.value)},[s[10]||(s[10]=e("div",{class:"uppercase"},"Todo given",-1)),e("div",Dt,[e("div",kt,p(ie.value)+" / "+p(te.value),1),e("i",{class:w(["fas",[O.value?"fa-chevron-up":"fa-chevron-down"]])},null,2)])]),O.value?(o(),d("div",Tt,[e("div",It,[s[11]||(s[11]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Todo Status",-1)),e("div",St,p(ie.value)+" given / "+p(te.value)+" selected ",1)]),e("div",Nt,[e("div",$t,[e("div",Ct,[e("div",Rt,[s[12]||(s[12]=e("span",null,"Not given todos",-1)),(r=T.value.withoutTodos)!=null&&r.length?(o(),d("span",Et,p((y=T.value.withoutTodos)==null?void 0:y.length),1)):v("",!0)]),e("button",{type:"button",class:"text-[10px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:s[1]||(s[1]=a=>Y.value=!Y.value)},p(Y.value?"Hide":"Show"),1)]),Y.value?(o(),d("div",At,[T.value.withoutTodos.length?v("",!0):(o(),d("span",Lt," Everyone has todos ")),(o(!0),d(N,null,j(T.value.withoutTodos,a=>(o(),d("span",{key:`without-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-red-50 text-red-700 border border-red-100 text-xs max-w-full",title:a.name},[s[13]||(s[13]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",Ut,p(a.name),1)],8,Ot))),128))])):v("",!0)]),e("div",null,[e("div",jt,[s[14]||(s[14]=H(" Given todos ")),(c=T.value.withTodos)!=null&&c.length?(o(),d("span",Bt,p((f=T.value.withTodos)==null?void 0:f.length),1)):v("",!0)]),e("div",Pt,[T.value.withTodos.length?v("",!0):(o(),d("span",zt," No todos assigned ")),(o(!0),d(N,null,j(T.value.withTodos,a=>(o(),d("span",{key:`with-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-50 text-green-700 border border-green-100 text-xs max-w-full",title:a.name},[s[15]||(s[15]=e("i",{class:"fas fa-check-circle"},null,-1)),e("span",Vt,p(a.name),1)],8,Mt))),128))])])])])):v("",!0)],512)])])):v("",!0),!t.companyId||!t.startDate||!t.endDate?(o(),d("div",Ft,s[16]||(s[16]=[e("i",{class:"fad fa-tasks text-4xl"},null,-1),e("div",{class:"empty-state glass-panel"},[e("p",{class:"text-base font-semibold text-rose-500"}," Select company and date range to view the report. "),e("p",{class:"text-sm text-gray-500"},"Use the filter set above to load records.")],-1)]))):U(u).loading?(o(),Xe(qe,{key:2},{default:Z(()=>s[17]||(s[17]=[H("Loading report...")])),_:1,__:[17]})):(o(),d("div",Ht,[e("table",Wt,[e("thead",Kt,[e("tr",Jt,[s[19]||(s[19]=e("th",{class:"px-4 py-3 border w-[10px] bg-white bg-opacity-70 backdrop-blur-sm rounded-tl-md print:rounded-tl-none text-center"}," sl ",-1)),e("th",Qt,[e("div",Yt,[s[18]||(s[18]=e("span",null,"Employee Name",-1)),t.employeeId?v("",!0):(o(),d("div",{key:0,class:"relative hidden md:block print:hidden",ref_key:"tableNoTodosRef",ref:ne},[e("button",{type:"button",class:"text-[11px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:s[2]||(s[2]=J(a=>Ue(),["stop"]))},[H(" No Todos ("+p(T.value.withoutTodos.length)+") ",1),e("span",Xt,p(V.value?"Hidden":"Showing"),1)])],512))])]),X.value?v("",!0):(o(),d("th",Zt," Date ")),s[20]||(s[20]=e("th",{class:"px-4 py-3 border bg-white text-center"},"Todo",-1)),s[21]||(s[21]=e("th",{class:"px-4 py-3 border print:border-r print:border-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center rounded-tr-md print:rounded-tr-none"}," Status ",-1))])]),e("tbody",qt,[pe.value.length===0?(o(),d("tr",Gt,[e("td",{colspan:X.value?4:5,class:"px-4 py-6 text-center text-gray-500"},s[22]||(s[22]=[e("div",null,[e("i",{class:"fas fa-tasks fa-2x text-gray-300 mb-2"})],-1),e("div",null,"No todos.",-1)]),8,es)])):v("",!0),(o(!0),d(N,null,j(pe.value,(a,b)=>{var k,_,I;return o(),d(N,{key:((k=a.user)==null?void 0:k.id)||(((I=(_=a.dates[0])==null?void 0:_.todos[0])==null?void 0:I.id)??Math.random())},[(o(!0),d(N,null,j(a.dates,(m,x)=>{var L;return o(),d(N,{key:`${((L=a.user)==null?void 0:L.id)||"u"}-${m.date}`},[(o(!0),d(N,null,j(m.todos,(C,S)=>{var ve,we,he,_e,De,ke,Te;return o(),d("tr",{key:C.id||`${((ve=a.user)==null?void 0:ve.id)||"u"}-${m.date||"empty"}-${S}`,class:"border odd:bg-white even:bg-gray-50 hover:bg-gray-100"},[x===0&&S===0?(o(),d("td",{key:0,rowspan:a.rowSpan||1,class:w(["px-4 py-3 align-top font-bold text-xl text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",de])},[e("div",ss,p(b+1),1)],8,ts)):v("",!0),x===0&&S===0?(o(),d("td",{key:1,rowspan:a.rowSpan||1,class:w(["px-4 py-3 align-top font-medium text-gray-800 whitespace-nowrap border-l border-t border-b bg-white",de])},[e("div",{user:a.user,class:"sticky top-[180px] bg-white"},[n.selfOnly?v("",!0):(o(),d("div",rs,[q(et,{user:a.user},{trigger:Z(({user:h})=>[q(Ze,{user:h,size:"medium"},null,8,["user"])]),_:2},1032,["user"]),e("div",null,[e("div",os,[e("a",{href:U(tt)(a.user),target:"_blank",rel:"noopener",class:"inline-flex hover:underline"},[e("div",null,[H(p(((we=a.user)==null?void 0:we.name)||"Unknown user")+" ",1),s[23]||(s[23]=e("i",{class:"far fa-external-link-alt print:hidden"},null,-1))])],8,ds)]),e("div",is,p(((_e=(he=a.user)==null?void 0:he.department)==null?void 0:_e.name)||"-"),1)])]))],8,as)],8,ns)):v("",!0),C.isPlaceholder?(o(),d(N,{key:2},[S===0&&!X.value?(o(),d("td",{key:0,rowspan:m.rowSpan||1,class:w(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",F(a,m,x,S)])},[e("div",ps,p(U(W)(m.date)||m.date||"-"),1)],10,ls)):v("",!0),e("td",{class:w(["border-l border-t border-r bg-white px-3 py-3 text-center",F(a,m,x,S)]),colspan:"2"},[s[28]||(s[28]=e("div",{class:"flex items-center justify-center gap-2 text-red-600 text-sm font-medium opacity-70"},[e("i",{class:"far fa-clipboard-list text-red-400"}),e("span",null,"No todos was provided.")],-1)),re.value?(o(),d("div",us," Loading attendanceâ€¦ ")):(o(!0),d(N,{key:1},j([We((De=a==null?void 0:a.user)==null?void 0:De.id,m==null?void 0:m.date)],h=>(o(),d("div",{key:h.comment,class:"min-w-[180px] mt-3 text-[11px] text-red-600 text-left inline-block align-top"},[h.hasData?(o(),d("div",ms,[h.in==="-"&&h.out==="-"?(o(),d("div",{key:0,class:w(["text-center flex items-center justify-center rounded-md bg-slate-50 border text-xs border-dashed px-2 py-1.5 col-span-2",[{"text-red-500 border-red-300":h.comment==="Absent","text-blue-500 border-blue-300":h.comment!=="Absent"}]])},p(h.comment),3)):(o(),d(N,{key:1},[e("div",ys,[e("div",cs,[s[24]||(s[24]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," In ",-1)),e("span",gs,p(h.in),1)]),e("div",xs,[s[25]||(s[25]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Late ",-1)),e("div",null,p(h.late),1)])]),e("div",fs,[e("div",bs,[s[26]||(s[26]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Out ",-1)),e("span",vs,p(h.out),1)]),e("div",ws,[s[27]||(s[27]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"}," Early ",-1)),e("div",null,p(h.out!=="-"?h.early:"-"),1)])])],64))])):(o(),d("div",hs," Attendance data unavailable. "))]))),128))],2)],64)):(o(),d(N,{key:3},[S===0&&!X.value?(o(),d("td",{key:0,rowspan:m.rowSpan||1,class:w(["px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white",F(a,m,x,S)])},[e("div",Ds,p(U(W)(m.date)||m.date||"-"),1)],10,_s)):v("",!0),e("td",{class:w(["px-4 py-3 text-gray-800 border-l border-t",F(a,m,x,S)])},[e("div",ks,[e("span",Ts,p(S+1)+".",1),H(" "+p(C.title),1)]),e("div",Is,p(((ke=C.todoable)==null?void 0:ke.title)||((Te=C.todoable_type)==null?void 0:Te.split("\\").pop())||""),1)],2),e("td",{class:w(["px-4 py-3 border-l border-t border-r text-center",F(a,m,x,S)])},[e("div",{class:w(["inline-block text-xs font-semibold px-2.5 py-1 rounded-full whitespace-nowrap",je(C.status)])},p(C.status==="WORKING"?"IN PROGRESS":C.status||"N/A"),3)],2)],64))])}),128))],64)}),128))],64)}),128))])])]))])}}};export{zs as default};
