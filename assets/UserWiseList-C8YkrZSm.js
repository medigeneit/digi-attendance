import{q as c,s as N,A as L,e as R,c as p,o as m,a as t,f as U,w as A,g as y,C as $,F as V,x as _,t as z,h as B,l as T,p as H,E as h,v as j,y as F}from"./index-CUUNTXsO.js";import{_ as G}from"./MultiselectDropdown-CRNmjI8r.js";import{u as q}from"./company-4TEzPl0a.js";import{_ as D}from"./UserChip-DnGEdzkj.js";import{_ as O}from"./TaskTreeView-GorUnDw7.js";import{g as W}from"./task-priority-DFDfrara.js";const J={class:"mb-3 task-header"},K={class:"flex justify-between items-center"},Q={class:"ml-auto flex gap-6 items-center"},X={key:0,class:"flex gap-2 items-center"},Y={class:"flex flex-wrap items-center gap-2 mt-3"},Z={class:"flex flex-wrap gap-4 w-full"},ee={class:"text-gray-600 w-full md:w-64 relative"},te=["value"],se={class:"relative w-full md:w-72"},le={key:0,class:"absolute right-8 text-xl top-0 bottom-0 flex items-center"},oe={class:"text-gray-600 w-40 relative"},ae={class:"flex gap-4 items-center flex-shrink-0"},ne={class:"flex gap-2"},ie={class:"flex gap-2"},re={class:"flex gap-2"},de={class:"text-gray-600 w-full md:w-40 md:ml-auto relative"},ye={__name:"TaskHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(k,{emit:S}){const f=k,b=c(n("company-id")),g=c(n("user-ids")),w=c(n("month")),C=c(n("status")),a=c(n("is-important")),l=c(n("is-urgent")),i=c(n("is-target")),r=S,u=q(),{companies:v,employees:d}=N(u);function n(o){return{get:()=>f.modelValue[o]||"",set:e=>{console.log("---SETTING modelValue: ",{key:o,value:e}),r("update:modelValue",{...f.modelValue,[o]:e||void 0})}}}const x=c(()=>I(g.value));async function E(o){o&&await u.fetchEmployee(o)}L(()=>b.value,E),R(async()=>{var o,e;await u.fetchCompanies(),(o=f.modelValue)!=null&&o["company-id"]&&await E((e=f.modelValue)==null?void 0:e["company-id"])});function I(o){return Array.isArray(d.value)&&d.value.find(e=>e.id==o)||null}function P(o){g.value=(o==null?void 0:o.id)||""}function M(){g.value=""}return(o,e)=>(m(),p("div",J,[t("div",K,[e[10]||(e[10]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Task List",-1)),t("div",Q,[k.listHasRearranged?(m(),p("div",X,[e[9]||(e[9]=t("span",{class:"text-red-500"},"Priority Changed",-1)),t("button",{class:"btn-3",onClick:e[0]||(e[0]=A(s=>r("clickPrioritySave"),["prevent"]))},"Save"),t("button",{class:"btn-3",onClick:e[1]||(e[1]=A(s=>r("clickPriorityDiscard"),["prevent"]))},"Discard")])):U("",!0),t("button",{onClick:e[2]||(e[2]=s=>r("clickAddTask")),class:"btn-1"},"Add Task")])]),t("div",Y,[t("div",Z,[t("div",ee,[e[12]||(e[12]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Company",-1)),y(t("select",{id:"company-filter","onUpdate:modelValue":e[3]||(e[3]=s=>b.value=s),class:"input-1"},[e[11]||(e[11]=t("option",{value:""},"All Company",-1)),(m(!0),p(V,null,_(B(v),s=>(m(),p("option",{key:s.id,value:s.id},z(s.name),9,te))),128))],512),[[$,b.value]])]),t("div",se,[T(G,{modelValue:x.value,onSelect:P,onRemove:M,options:B(d),multiple:!1,label:"name","label-prefix":"id",placeholder:"All Employees",class:"text-gray-600 w-full"},{option:H(({option:s})=>[T(D,{user:s,class:"w-full line-clamp-1"},null,8,["user"])]),_:1},8,["modelValue","options"]),x.value?(m(),p("div",le,[t("button",{onClick:A(M,["prevent"]),class:"mt-0.5 text-gray-500 hover:text-red-700"}," Ã— ")])):U("",!0),e[13]||(e[13]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"},"Employee",-1))]),t("div",oe,[e[15]||(e[15]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),y(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>C.value=s),class:"input-1"},e[14]||(e[14]=[t("option",{value:""},"All Tasks",-1),t("option",{value:"not-completed"},"Not Completed",-1),t("option",{value:"only-completed"},"Completed",-1)]),512),[[$,C.value]])]),t("div",ae,[t("label",ne,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=s=>a.value=s)},null,512),[[h,a.value]]),e[16]||(e[16]=t("span",null,"Important",-1))]),t("label",ie,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=s=>l.value=s)},null,512),[[h,l.value]]),e[17]||(e[17]=t("span",null,"Urgent",-1))]),t("label",re,[y(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=s=>i.value=s)},null,512),[[h,i.value]]),e[18]||(e[18]=t("span",null,"Is Target",-1))])]),t("div",de,[e[19]||(e[19]=t("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),y(t("input",{id:"month-filter","onUpdate:modelValue":e[8]||(e[8]=s=>w.value=s),type:"month",class:"input-1",placeholder:"All month"},null,512),[[j,w.value]])])])])]))}},ue={class:"w-full bg-white rounded"},pe=["rowspan"],ge={__name:"UserWiseList",props:{tasks:Array,selectedUserId:{type:String,default:null}},emits:["commentButtonClick","editClick","addClick","updatePriority"],setup(k,{emit:S}){const f=k,b=S,g=c(()=>f.tasks.reduce((a,l)=>(a.push(...l.users.filter(i=>!a.find(r=>r.id==i.id&&i.id))),a),[]).filter(a=>f.selectedUserId?a.id==f.selectedUserId:!0)),w=a=>{const l=f.tasks,i=new Map(l.map(d=>[d.id,d])),r=new Set,u=[],v=l.filter(d=>d.users.some(n=>n.id===a));for(const d of v){r.has(d.id)||(r.add(d.id),u.push(d));let n=d.parent_id;for(;n&&i.has(n)&&!r.has(n);){const x=i.get(n);r.add(x.id),u.push(x),n=x.parent_id}}return u},C=c(()=>g.value.map(a=>{const l=W(w(a.id),0);return{...a,tasks:l}}));return(a,l)=>(m(),p("div",null,[t("table",ue,[t("tbody",null,[(m(!0),p(V,null,_(C.value,i=>(m(),p(V,{key:i.id},[(m(!0),p(V,null,_(i.tasks,(r,u)=>(m(),p("tr",{key:r.id},[u==0?(m(),p("td",{key:0,class:"border p-4 align-top border-green-300 bg-blue-50",rowspan:Math.max(i.tasks.length,1)},[T(D,{user:i,class:"sticky top-[80px]"},null,8,["user"])],8,pe)):U("",!0),t("td",{class:F(["py-4 px-4 border-x border-green-300 bg-blue-50",{"border-t":u==0,"border-b":i.tasks.length-1===u}])},[T(O,{task:r,class:"!border-0 my-0",index:u,onCommentButtonClick:l[0]||(l[0]=v=>b("commentButtonClick",a.item.id)),onEditClick:l[1]||(l[1]=v=>b("editClick",v)),onAddClick:l[2]||(l[2]=v=>b("addClick",v))},null,8,["task","index"])],2)]))),128))],64))),128))])])]))}};export{ye as _,ge as a};
