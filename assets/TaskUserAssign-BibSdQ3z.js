import{b as V,u as A,r as d,q as B,e as L,c as i,o as n,a as s,t as m,h,w as k,f as $,l as x,p,F as N,x as F,m as M}from"./index-BR0eu99c.js";import{_ as R}from"./MultiselectDropdown-BNTeRtv6.js";import{_ as y}from"./UserChip-DqsET12Z.js";import{u as q}from"./useTaskStore-BT6mWdg5.js";import{u as z}from"./user-B52CLbOn.js";import"./vue-multiselect.esm-0uj4zGBC.js";const D={class:"container mx-auto p-6"},E={class:"max-w-xl mx-auto bg-white shadow-lg rounded-lg p-6"},I={class:"text-xl font-semibold text-gray-800 mb-4"},j={key:0,class:"text-center text-gray-500 py-4"},G={class:"mb-4"},H={class:"mb-2 flex flex-wrap gap-2"},J=["onClick"],K={key:0,class:"mb-4 text-red-500 font-medium"},O={class:"flex items-center gap-4"},P=["disabled"],ae={__name:"TaskUserAssign",setup(Q){const r=q(),v=z(),w=V(),f=A(),l=d([]),U=B(()=>l.value.map(o=>o.id)),_=w.params.id,a=d(!1),u=d(null),c=d([]);L(async()=>{var o,e;a.value=!0,await r.fetchTask(_,{with_parent:"true"}),r.task.parent?c.value=((e=(o=r.task)==null?void 0:o.parent)==null?void 0:e.users)||[]:(await v.fetchUsers(),c.value=v.users),l.value=r.task.users,a.value=!1});const S=async()=>{a.value=!0,u.value=null;try{await r.assignUsers(_,U.value),f.push({name:"TaskList"})}catch(o){u.value=o.message||"Assign users failed"}finally{a.value=!1}};return(o,e)=>{var g;return n(),i("div",D,[s("div",E,[s("h2",I,' Assign Users to Task: "'+m((g=h(r).task)==null?void 0:g.title)+'" ',1),a.value?(n(),i("div",j,"Loading users...")):(n(),i("form",{key:1,onSubmit:k(S,["prevent"])},[s("div",G,[e[2]||(e[2]=s("label",{class:"block text-gray-700 font-medium"},"Select Users",-1)),x(R,{modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value=t),options:c.value,multiple:!0,"track-by":"id",label:"label",placeholder:"Select users"},{selection:p(({...t})=>[s("div",H,[(n(!0),i(N,null,F((t==null?void 0:t.values)||[],b=>(n(),M(y,{key:b.id,user:b},{after:p(({user:C})=>[s("button",{class:"size-6 border rounded-full hover:bg-red-400 hover:text-white",onClick:k(W=>l.value=l.value.filter(T=>T.id!==C.id),["prevent"])}," Ã— ",8,J)]),_:2},1032,["user"]))),128))])]),option:p(({option:t})=>[x(y,{user:t},null,8,["user"])]),_:1},8,["modelValue","options"])]),u.value?(n(),i("div",K,m(u.value),1)):$("",!0),s("div",O,[s("button",{disabled:a.value,type:"submit",class:"bg-indigo-500 hover:bg-indigo-600 text-white font-semibold px-5 py-2 rounded transition"},m(a.value?"Assigning...":"Assign Users"),9,P),s("button",{type:"button",onClick:e[1]||(e[1]=t=>h(f).push({name:"TaskList"})),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel ")])],32))])])}}};export{ae as default};
