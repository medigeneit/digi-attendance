import{r as _,z as N,A as D,c as i,g as B,o as u,a as e,t as r,w as F,h as x,B as U,F as q,y as $,k as V,v as k,N as j,x as P,e as z,n as C}from"./index-BcM04Yjj.js";import{u as Q}from"./company-DPFP5p_9.js";import{_ as I}from"./DeleteModal-QrFsNQMY.js";import{_ as O}from"./HeaderWithButtons-BxtuVRcI.js";import{L as G}from"./LoaderView-DX_nKyhl.js";import{u as H}from"./leave-type-D8HF7BpY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50"},K={class:"bg-white rounded-lg shadow-lg w-full max-w-lg"},R={class:"px-6 py-4 border-b"},W={class:"text-lg font-bold"},X=["value"],Y={class:"flex justify-end space-x-4"},Z={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},T={__name:"LeaveTypeModal",props:{show:{type:Boolean,required:!0},leaveType:{type:Object,default:null}},emits:["close","save"],setup(M,{emit:p}){const y=M,m=p,f=Q(),l=_(!1),b=_(!1),o=N({id:null,company_id:"",name:"",annual_quota:0,type:"Paid",max_consecutive_days:null,description:""}),v=()=>{l.value=!1,o.id=null,o.company_id="",o.name="",o.annual_quota=0,o.type="Paid",o.max_consecutive_days=null,o.description=""};D(()=>y.leaveType,a=>{a?(l.value=!0,o.id=a.id,o.company_id=a.company_id,o.name=a.name,o.annual_quota=a.annual_quota,o.type=a.type,o.max_consecutive_days=a.max_consecutive_days,o.description=a.description):v()},{immediate:!0,deep:!0}),D(()=>y.show,async a=>{a&&!b.value&&await L()});const L=async()=>{try{await f.fetchCompanies(),b.value=!0}catch(a){console.error("Failed to fetch companies:",a)}},h=()=>{m("save",{...o}),g()},g=()=>{v(),m("close")};return(a,s)=>M.show?(u(),i("div",J,[e("div",K,[e("div",R,[e("h3",W,r(l.value?"Edit Leave Type":"Add Leave Type"),1)]),e("form",{onSubmit:F(h,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[s[7]||(s[7]=e("label",{for:"company_id",class:"block text-sm font-medium"},"Company",-1)),x(e("select",{id:"company_id","onUpdate:modelValue":s[0]||(s[0]=t=>o.company_id=t),class:"w-full border rounded px-3 py-2",required:""},[s[6]||(s[6]=e("option",{value:"",disabled:""},"Select a company",-1)),(u(!0),i(q,null,$(V(f).companies,t=>(u(),i("option",{key:t.id,value:t.id},r(t.name),9,X))),128))],512),[[U,o.company_id]])]),e("div",null,[s[8]||(s[8]=e("label",{for:"name",class:"block text-sm font-medium"},"Name",-1)),x(e("input",{id:"name","onUpdate:modelValue":s[1]||(s[1]=t=>o.name=t),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter leave type name",required:""},null,512),[[k,o.name]])]),e("div",null,[s[9]||(s[9]=e("label",{for:"annual_quota",class:"block text-sm font-medium"},"Annual Quota",-1)),x(e("input",{id:"annual_quota","onUpdate:modelValue":s[2]||(s[2]=t=>o.annual_quota=t),type:"number",class:"w-full border rounded px-3 py-2",placeholder:"Enter annual quota",required:""},null,512),[[k,o.annual_quota]])]),e("div",null,[s[11]||(s[11]=e("label",{for:"type",class:"block text-sm font-medium"},"Type",-1)),x(e("select",{id:"type","onUpdate:modelValue":s[3]||(s[3]=t=>o.type=t),class:"w-full border rounded px-3 py-2",required:""},s[10]||(s[10]=[e("option",{value:"Paid"},"Paid",-1),e("option",{value:"Unpaid"},"Unpaid",-1)]),512),[[U,o.type]])]),e("div",null,[s[12]||(s[12]=e("label",{for:"max_consecutive_days",class:"block text-sm font-medium"},"Max Consecutive Days",-1)),x(e("input",{id:"max_consecutive_days","onUpdate:modelValue":s[4]||(s[4]=t=>o.max_consecutive_days=t),type:"number",class:"w-full border rounded px-3 py-2",placeholder:"Enter max consecutive days (optional)"},null,512),[[k,o.max_consecutive_days]])]),e("div",null,[s[13]||(s[13]=e("label",{for:"description",class:"block text-sm font-medium"},"Description",-1)),x(e("textarea",{id:"description","onUpdate:modelValue":s[5]||(s[5]=t=>o.description=t),class:"w-full border rounded px-3 py-2",placeholder:"Enter description (optional)"},null,512),[[k,o.description]])]),e("div",Y,[e("button",{type:"button",onClick:g,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400"}," Cancel "),e("button",Z,r(l.value?"Update":"Create"),1)])],32)])])):B("",!0)}},ee={class:"my-container space-y-2"},te={key:0,class:"text-center py-4"},se={key:1,class:"space-y-4"},oe={class:"title-md"},ae={class:"overflow-x-auto"},ne={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},le={class:"text-gray-600 text-sm"},de={class:"py-3 px-2 text-left"},ie={class:"py-3 px-2 text-left"},ue={class:"py-3 px-2 text-left"},re={class:"py-3 px-2 text-center"},ce={class:"py-3 px-2 text-center"},pe={class:"py-3 px-2 text-center"},me={class:"flex justify-center gap-4"},ye=["onClick"],fe=["onClick"],ke={__name:"LeaveTypeList",setup(M){const p=H(),y=j(),m=_(!1),f=_(!1),l=_(null),b=()=>{l.value=null,m.value=!0},o=t=>{l.value=t,m.value=!0},v=()=>{m.value=!1},L=t=>{l.value=t,f.value=!0},h=()=>{f.value=!1},g=async()=>{var t;if(!((t=l.value)!=null&&t.id)){y.error("Invalid leave type selected for deletion!");return}await p.deleteLeaveType(l.value.id),y.success("Leave Type deleted successfully!"),h()},a=async t=>{const d=t.id?"updateLeaveType":"createLeaveType",c=t.id?"Leave Type updated successfully!":"Leave Type added successfully!";try{await p[d](t.id||t,t),y.success(c)}finally{v()}},s=P(()=>{const t={};return p.leaveTypes.forEach(d=>{var w;const c=((w=d.company)==null?void 0:w.name)||"Unknown Company";t[c]||(t[c]=[]),t[c].push(d)}),t});return z(()=>{p.fetchAdminLeaveTypes()}),(t,d)=>{var c;return u(),i("div",ee,[C(O,{title:"Leave Types",onAdd:b}),V(p).loading?(u(),i("div",te,[C(G)])):(u(),i("div",se,[(u(!0),i(q,null,$(s.value,(w,S)=>(u(),i("div",{key:S},[e("h2",oe,r(S),1),e("div",ae,[e("table",ne,[d[2]||(d[2]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"#"),e("th",{class:"py-3 px-2 text-left"},"Leave Name"),e("th",{class:"py-3 px-2 text-left"},"Annual Quota"),e("th",{class:"py-3 px-2 text-center"},"Type"),e("th",{class:"py-3 px-2 text-center"},"Max Consecutive Days"),e("th",{class:"py-3 px-2 text-center"},"Actions")])],-1)),e("tbody",le,[(u(!0),i(q,null,$(w,(n,A)=>(u(),i("tr",{key:A,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",de,r(A+=1),1),e("td",ie,r(n==null?void 0:n.name),1),e("td",ue,r(n==null?void 0:n.annual_quota),1),e("td",re,r(n==null?void 0:n.type),1),e("td",ce,r((n==null?void 0:n.max_consecutive_days)||"N/A"),1),e("td",pe,[e("div",me,[e("button",{onClick:E=>o(n),class:"text-blue-600 hover:text-blue-800"},d[0]||(d[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ye),e("button",{onClick:E=>L(n),class:"text-red-600 hover:text-red-800"},d[1]||(d[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,fe)])])]))),128))])])])]))),128))])),C(T,{show:m.value,leaveType:l.value,onClose:v,onSave:a},null,8,["show","leaveType"]),C(I,{show:f.value,title:"Delete Leave Type",message:`Are you sure you want to delete ${(c=l.value)==null?void 0:c.name}?`,onClose:h,onConfirm:g},null,8,["show","message"])])}}};export{ke as default};
