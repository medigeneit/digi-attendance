import{r as g,s as F,K as V,A as N,b as E,o as h,c as x,a as t,t as d,w as R,d as q,v as I,m as b,h as v,F as U,x as O,e as T,j as z}from"./index-CWgyQWdy.js";import{_ as B}from"./MultiselectDropdown-DxSBYtgF.js";import{u as K}from"./department-qipq3drT.js";import{u as G}from"./user-DLxy1Tsn.js";import{_ as H,a as J}from"./HeaderWithButtons-CnwZJNgP.js";import{L as P}from"./LoaderView-DxU-Mb2f.js";import{u as Q}from"./leave-approval-tLE9lbyq.js";import"./vue-multiselect.esm-Djq3TBhJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W={key:0,class:"fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50"},X={class:"bg-white rounded-lg shadow-lg w-full max-w-lg"},Y={class:"px-6 py-4 border-b"},Z={class:"text-lg font-bold"},A=["for"],ee={class:"flex justify-end space-x-4"},te={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},se={__name:"LeaveApprovalModal",props:{show:{type:Boolean,required:!0},leaveApproval:{type:Object,default:null}},emits:["close","save"],setup(C,{emit:i}){const _=C,m=i,p=g(null),r=G(),w=K(),{departments:M}=F(w),c=g(!1),n=V({id:null,name:"",department_id:"",in_charge_user_id:"",coordinator_user_id:"",operational_admin_user_id:"",recommend_by_user_id:"",approved_by_user_id:""}),l=V({in_charge_user_id:null,coordinator_user_id:null,operational_admin_user_id:null,recommend_by_user_id:null,approved_by_user_id:null}),$=()=>{Object.keys(l).forEach(e=>{l[e]=r.users.find(o=>o.id===n[e])||null})};Object.keys(l).forEach(e=>{N(()=>l[e],o=>{console.log(o),n[e]=o?o.id:null})});const L=()=>{Object.assign(n,{id:null,name:"",department_id:"",in_charge_user_id:"",coordinator_user_id:"",operational_admin_user_id:"",recommend_by_user_id:"",approved_by_user_id:""}),c.value=!1},s=()=>{Object.assign(l,{in_charge_user_id:"",coordinator_user_id:"",operational_admin_user_id:"",recommend_by_user_id:"",approved_by_user_id:""}),c.value=!1};N(()=>_.leaveApproval,e=>{e?(c.value=!0,Object.assign(n,e),$()):(L(),s())},{immediate:!0,deep:!0}),N(()=>p.value,e=>{n.department_id=(e==null?void 0:e.id)||null});const a=()=>{if(!n.name||!n.approved_by_user_id){alert("Name and Approved By are required!");return}m("save",{...n}),y()},y=()=>{L(),m("close")};return E(()=>{r.fetchUsers(),w.fetchDepartments()}),(e,o)=>C.show?(h(),x("div",W,[t("div",X,[t("div",Y,[t("h3",Z,d(c.value?"Edit Leave Approval":"Add Leave Approval"),1)]),t("form",{onSubmit:R(a,["prevent"]),class:"p-6 space-y-4"},[t("div",null,[o[2]||(o[2]=t("label",{for:"name",class:"block text-sm font-medium"},"Approval Name",-1)),q(t("input",{id:"name","onUpdate:modelValue":o[0]||(o[0]=u=>n.name=u),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter approval name",required:""},null,512),[[I,n.name]])]),b(B,{modelValue:p.value,"onUpdate:modelValue":o[1]||(o[1]=u=>p.value=u),multiple:!1,label:"name",options:v(M),placeholder:"Choose department"},null,8,["modelValue","options"]),(h(),x(U,null,O({in_charge_user_id:"In-Charge",coordinator_user_id:"Coordinator",operational_admin_user_id:"Operational Admin",recommend_by_user_id:"Recommend By",approved_by_user_id:"Approved By"},(u,f)=>t("div",{key:f},[t("label",{for:f,class:"block text-sm font-medium"},d(u),9,A),b(B,{modelValue:l[f],"onUpdate:modelValue":k=>l[f]=k,multiple:!1,label:"name",options:v(r).users},null,8,["modelValue","onUpdate:modelValue","options"])])),64)),t("div",ee,[t("button",{type:"button",onClick:y,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400"}," Cancel "),t("button",te,d(c.value?"Update":"Create"),1)])],32)])])):T("",!0)}},oe={class:"my-container space-y-2"},ae={class:"overflow-x-auto"},ne={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},re={class:"text-gray-600 text-sm"},de={key:0},le={colspan:"8"},ie={class:"py-3 px-2 text-left"},ce={class:"py-3 px-2 text-left"},ue={class:"py-3 px-2 text-left"},_e={class:"py-3 px-2 text-left"},me={class:"py-3 px-2 text-left"},pe={class:"py-3 px-2 text-left"},ye={class:"py-3 px-2 text-left"},fe={class:"py-3 px-2 text-left"},he={class:"py-3 px-2 text-center"},xe={class:"flex justify-center gap-4"},be=["onClick"],ge=["onClick"],ve={key:2},Ve={__name:"LeaveApprovalList",setup(C){const i=Q(),_=z(),m=g(!1),p=g(!1),r=g(null),w=()=>{r.value=null,m.value=!0},M=s=>{r.value={...s},m.value=!0},c=()=>{m.value=!1},n=s=>{r.value=s,p.value=!0},l=()=>{p.value=!1},$=async()=>{var s;if(!((s=r.value)!=null&&s.id)){_.error("Invalid leave approval selected for deletion!");return}try{await i.deleteLeaveApproval(r.value.id),_.success("Leave approval deleted successfully!")}catch(a){_.error("Failed to delete leave approval!"),console.error("Error deleting leave approval:",a)}finally{l()}},L=async s=>{const a=s.id?"updateLeaveApproval":"createLeaveApproval",y=s.id?"Leave approval updated successfully!":"Leave approval added successfully!";try{await i[a](s.id||s,s),_.success(y)}catch(e){_.error("Failed to save leave approval!"),console.error("Error saving leave approval:",e)}finally{c()}};return E(()=>{i.fetchLeaveApprovals()}),(s,a)=>{var y;return h(),x("div",oe,[b(J,{title:"Leave Approvals",onAdd:w}),t("div",ae,[t("table",ne,[a[3]||(a[3]=t("thead",null,[t("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[t("th",{class:"py-3 px-2 text-left"},"#"),t("th",{class:"py-3 px-2 text-left"},"Name"),t("th",{class:"py-3 px-2 text-left"},"Department"),t("th",{class:"py-3 px-2 text-left"},"In-Charge"),t("th",{class:"py-3 px-2 text-left"},"Coordinator"),t("th",{class:"py-3 px-2 text-left"},"Operational Admin"),t("th",{class:"py-3 px-2 text-left"},"Recommend By"),t("th",{class:"py-3 px-2 text-left"},"Approved By"),t("th",{class:"py-3 px-2 text-center"},"Actions")])],-1)),t("tbody",re,[v(i).loading?(h(),x("tr",de,[t("td",le,[b(P,{class:"shadow-none"})])])):v(i).leaveApprovals.length?(h(!0),x(U,{key:1},O(v(i).leaveApprovals,e=>{var o,u,f,k,S,j;return h(),x("tr",{key:e.id,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",ie,d(e==null?void 0:e.id),1),t("td",ce,d(e==null?void 0:e.name),1),t("td",ue,d((o=e==null?void 0:e.department)==null?void 0:o.name),1),t("td",_e,d(((u=e==null?void 0:e.in_charge_user)==null?void 0:u.name)||"N/A"),1),t("td",me,d(((f=e==null?void 0:e.coordinator_user)==null?void 0:f.name)||"N/A"),1),t("td",pe,d(((k=e==null?void 0:e.operational_admin_user)==null?void 0:k.name)||"N/A"),1),t("td",ye,d(((S=e==null?void 0:e.recommend_by_user)==null?void 0:S.name)||"N/A"),1),t("td",fe,d(((j=e==null?void 0:e.approved_by_user)==null?void 0:j.name)||"N/A"),1),t("td",he,[t("div",xe,[t("button",{onClick:D=>M(e),class:"text-blue-600 hover:text-blue-800"},a[0]||(a[0]=[t("i",{class:"fas fa-edit"},null,-1)]),8,be),t("button",{onClick:D=>n(e),class:"text-red-600 hover:text-red-800"},a[1]||(a[1]=[t("i",{class:"fas fa-trash"},null,-1)]),8,ge)])])])}),128)):(h(),x("tr",ve,a[2]||(a[2]=[t("td",{colspan:"8",class:"text-center text-red-500 py-4"},"No leave approvals found",-1)])))])])]),b(se,{show:m.value,leaveApproval:r.value,onClose:c,onSave:L},null,8,["show","leaveApproval"]),b(H,{show:p.value,title:"Delete Leave Approval",message:`Are you sure you want to delete ${(y=r.value)==null?void 0:y.name}?`,onClose:l,onConfirm:$},null,8,["show","message"])])}}};export{Ve as default};
