import{_ as v}from"./ApprovalItem-DMBftX3t.js";import{L as Dt}from"./LoaderView-B_t-XiGj.js";import{_ as Lt}from"./ShareComponent-Bq_oNnwY.js";import{u as At,N as jt,r as yt,y as mt,b as Nt,c as d,a as t,l as o,k as Tt,t as s,F as g,x,m as c,q as gt,e as xt,f as Bt,o as n,g as Rt}from"./index-BMjnsKM_.js";import{u as Ft}from"./leave-application-BHxKkP24.js";import"./AcceptAndRejectHandler-B5VISZIr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const St={class:"my-container max-w-3xl space-y-6"},Wt={key:1,class:"card-bg p-4 md:p-8"},Ct={class:"title-lg text-center"},Vt={class:"text-center text-sm"},Mt={class:"space-y-4"},Pt={class:"grid md:grid-cols-2 print:grid-cols-2 gap-8"},Ut={class:""},Ht={class:"text-sm"},It={class:"flex justify-end gap-4"},$t={class:"table-auto border border-black bg-white text-xs"},qt={class:"border border-black px-2"},zt={class:"border border-black px-2"},Et={class:"border border-black px-2"},Gt={class:"font-bold"},Jt={class:"border border-black px-2"},Kt={class:"table-auto border border-black bg-white text-xs"},Ot={class:"border border-black"},Qt={colspan:"2",class:"border border-black px-2 w-32"},Xt={class:"border border-black px-2"},Yt={class:"border border-black px-2"},Zt={class:"font-bold"},te={class:"border border-black px-2"},ee={class:"grid print:grid-cols-2 md:grid-cols-2 text-sm"},le={class:"text-sm"},se={class:"pt-8 grid grid-cols-2"},ae={class:"text-sm"},oe={class:"overflow-x-auto"},re={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},ne={class:"border border-gray-500 px-4 py-0.5 text-left"},de={class:"border border-gray-500 px-4 py-0.5 text-center"},ie={class:"border border-gray-500 px-4 py-0.5 text-center"},pe={class:"space-y-14"},ue={class:"font-bold text-center text-lg"},ce={key:0},be={class:"grid md:grid-cols-3 print:grid-cols-3 gap-4 text-sm items-end"},ve={class:"flex justify-evenly text-sm items-end"},ye={key:0,class:"mb-2"},me=["href"],Le={__name:"LeaveApplicationShow",setup(ge){At(),jt();const y=Ft(),ft=Rt(),m=Bt(),f=yt(null),_=yt(!0),l=mt(()=>y.leaveApplication);Nt(async()=>{try{await y.fetchLeaveApplicationById(m.params.id)}catch(r){console.error("Failed to load leave application:",r)}finally{_.value=!1}});function _t(){window.print()}const b=async()=>{await y.fetchLeaveApplicationById(m.params.id)},kt=()=>ft.go(-1),k=mt(()=>{if(!l.value||!l.value.last_working_date||!l.value.resumption_date)return 0;const r=new Date(l==null?void 0:l.value.last_working_date),i=new Date(l==null?void 0:l.value.resumption_date)-r;return Math.ceil(i/(1e3*60*60*24))-1}),ht=async()=>{try{const r={attachment:f.value};await y.uploadLeaveApplicationAttachment(m.params.id,r)}catch(r){console.error("Failed to reject short leave:",r),alert("Failed to reject short leave.")}},wt=async r=>{const e=r.target.files[0];if(e){const i=new FormData;i.append("file",e),i.append("folder","leave-application");const p=await y.fetchFileUpload(i);f.value=p==null?void 0:p.url,ht()}};return(r,e)=>{var i,p,h,w,D,L,A,j,N,T,B,R,F,S,W,C,V,M,P,U,H,I,$,q,z,E,G,J,K,O,Q,X,Y,Z,tt,et,lt,st,at,ot,rt,nt,dt,it,pt,ut,ct,bt,vt;return n(),d("div",St,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:kt},e[0]||(e[0]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[2]||(e[2]=t("h1",{class:"title-md md:title-xl flex-wrap text-center"},"Leave Application",-1)),t("div",null,[t("button",{class:"btn-2",onClick:_t},e[1]||(e[1]=[t("i",{class:"far fa-print"},null,-1),o(" Print ")]))])]),_.value?(n(),Tt(Dt,{key:0})):(n(),d("div",Wt,[t("div",null,[t("h1",Ct,s((h=(p=(i=l.value)==null?void 0:i.user)==null?void 0:p.company)==null?void 0:h.name),1),t("p",Vt,s((D=(w=l.value)==null?void 0:w.user)==null?void 0:D.company.address),1)]),t("div",Mt,[t("div",Pt,[t("div",null,[e[3]||(e[3]=t("p",null,"To",-1)),e[4]||(e[4]=t("p",{class:"font-bold"},"Managing Director",-1)),t("p",Ut,s((j=(A=(L=l.value)==null?void 0:L.user)==null?void 0:A.company)==null?void 0:j.name),1),t("p",Ht,s((T=(N=l.value)==null?void 0:N.user)==null?void 0:T.company.address),1),e[5]||(e[5]=t("div",null,[t("p",{class:"pt-6"},[t("b",null,"Subject:"),o(" Leave Application")])],-1))]),t("div",It,[t("div",null,[e[9]||(e[9]=t("h1",{class:"font-bold"},"Summary",-1)),t("table",$t,[e[8]||(e[8]=t("thead",null,[t("tr",{class:"bg-gray-200 border border-black"},[t("th",{class:"border border-black px-2"},"Type"),t("th",{class:"border border-black px-2"},"Days")])],-1)),t("tbody",null,[(n(!0),d(g,null,x((B=l.value)==null?void 0:B.leave_types,(a,u)=>(n(),d("tr",{key:u,class:"border border-black"},[t("td",qt,s(a.type),1),t("td",zt,s(a.days),1)]))),128)),t("tr",null,[e[6]||(e[6]=t("td",{class:"border-black px-2"},"WL/GHD",-1)),t("td",Et,s(k.value-((F=(R=l.value)==null?void 0:R.leave_days)==null?void 0:F.length)),1)]),t("tr",Gt,[e[7]||(e[7]=t("td",{class:"border border-black px-2"},"Total",-1)),t("td",Jt,s(k.value),1)])])])]),t("div",null,[e[13]||(e[13]=t("h1",{class:"font-bold"},"Last Leave",-1)),t("div",null,[t("table",Kt,[t("thead",null,[e[10]||(e[10]=t("tr",{class:"bg-gray-200 border border-black"},[t("th",{colspan:"2",class:"border border-black px-2"},"Date")],-1)),t("tr",Ot,[t("td",Qt,s(((W=(S=l.value)==null?void 0:S.last_leave)==null?void 0:W.date)||"N/A"),1)]),e[11]||(e[11]=t("tr",{class:"bg-gray-200 border border-black"},[t("th",{class:"border border-black px-2"},"Type"),t("th",{class:"border border-black px-2"},"Days")],-1))]),t("tbody",null,[(n(!0),d(g,null,x((V=(C=l.value)==null?void 0:C.last_leave)==null?void 0:V.types,(a,u)=>(n(),d("tr",{key:u,class:"border border-black"},[t("td",Xt,s(a==null?void 0:a.type),1),t("td",Yt,s(a==null?void 0:a.days),1)]))),128)),t("tr",Zt,[e[12]||(e[12]=t("td",{class:"border border-black px-2"},"Total",-1)),t("td",te,s((P=(M=l.value)==null?void 0:M.last_leave)!=null&&P.types?l.value.last_leave.types.reduce((a,u)=>a+u.days,0):0),1)])])])])])])]),t("div",null,[e[20]||(e[20]=t("h3",{class:"font-bold"},"Leave Details:",-1)),t("div",ee,[t("li",null,[e[14]||(e[14]=t("strong",null,"Reason: ",-1)),o(s(((U=l.value)==null?void 0:U.reason)||"No reason provided"),1)]),t("li",null,[e[15]||(e[15]=t("strong",null,"Leave Days:",-1)),o(" "+s((H=l.value)==null?void 0:H.leave_period),1)]),t("li",null,[e[16]||(e[16]=t("strong",null,"Total Days:",-1)),o(" "+s((I=l.value)==null?void 0:I.total_leave_days),1)]),t("li",null,[e[17]||(e[17]=t("strong",null,"Weekends:",-1)),o(" "+s((z=(q=($=l.value)==null?void 0:$.user)==null?void 0:q.weekends)==null?void 0:z.join(", ")),1)]),t("li",null,[e[18]||(e[18]=t("strong",null,"Last Working Date:",-1)),o(" "+s((E=l.value)==null?void 0:E.last_working_date),1)]),t("li",null,[e[19]||(e[19]=t("strong",null,"Resumption Date:",-1)),o(" "+s((G=l.value)==null?void 0:G.resumption_date),1)])])]),t("div",le,[t("p",null,[e[21]||(e[21]=t("strong",null,"Works in Hand: ",-1)),o(s(((J=l.value)==null?void 0:J.works_in_hand)||"No details provided"),1)])]),t("div",se,[t("div",null,[t("div",ae,[e[26]||(e[26]=t("hr",{class:"w-44 border-black hidden print:block"},null,-1)),t("p",null,[e[22]||(e[22]=t("strong",null,"Applicant:",-1)),o(" "+s((O=(K=l.value)==null?void 0:K.user)==null?void 0:O.name),1)]),t("p",null,[e[23]||(e[23]=t("strong",null,"Designation:",-1)),o(" "+s((Y=(X=(Q=l.value)==null?void 0:Q.user)==null?void 0:X.designation)==null?void 0:Y.title),1)]),t("p",null,[e[24]||(e[24]=t("strong",null,"Department:",-1)),o(" "+s((et=(tt=(Z=l.value)==null?void 0:Z.user)==null?void 0:tt.department)==null?void 0:et.name),1)]),t("p",null,[e[25]||(e[25]=t("strong",null,"Phone:",-1)),o(" "+s((st=(lt=l.value)==null?void 0:lt.user)==null?void 0:st.phone),1)])])]),c(v,{application:l.value,type:"leave_applications",item:"handover",onAction:b},null,8,["application"])]),t("div",null,[e[28]||(e[28]=t("h1",{class:"font-bold"},"Leave Balance",-1)),t("div",oe,[t("table",re,[e[27]||(e[27]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border border-gray-500 px-4 py-0.5 text-left"},"Leave Type"),t("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Total Days"),t("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Used Days"),t("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Remaining Days")])],-1)),t("tbody",null,[(n(!0),d(g,null,x((at=l.value)==null?void 0:at.leave_balance,(a,u)=>(n(),d("tr",{key:u,class:"hover:bg-blue-200"},[t("td",ne,s(a.leave_type),1),t("td",de,s(a.total_leave_days),1),t("td",ie,s(a.used_days),1),t("td",{class:gt(["border border-gray-500 px-4 py-0.5 text-center",{"text-green-600 font-bold":a.remaining_days>0,"text-red-600 font-bold":a.remaining_days===0}])},s(a.remaining_days),3)]))),128))])])])])]),t("div",pe,[t("p",ue,[e[29]||(e[29]=o(" Leave Approval: ")),t("b",{class:gt({"text-yellow-600":((ot=l.value)==null?void 0:ot.status)==="Pending","text-green-600":((rt=l.value)==null?void 0:rt.status)==="Approved","text-red-600":((nt=l.value)==null?void 0:nt.status)==="Rejected"})},s(((dt=l.value)==null?void 0:dt.status)||"N/A"),3)]),((it=l.value)==null?void 0:it.status)==="Rejected"?(n(),d("div",ce,[t("p",null,[e[30]||(e[30]=t("b",null,"Rejected by: ",-1)),o(" "+s((ut=(pt=l.value)==null?void 0:pt.rejected_by_user)==null?void 0:ut.name),1)]),t("p",null,[e[31]||(e[31]=t("b",null,"rejection Reason: ",-1)),o(" "+s(l.value.rejection_reason),1)])])):xt("",!0),t("div",be,[c(v,{application:l.value,type:"leave_applications",item:"in_charge",onAction:b},null,8,["application"]),c(v,{application:l.value,type:"leave_applications",item:"coordinator",onAction:b},null,8,["application"]),c(v,{application:l.value,type:"leave_applications",item:"operational_admin",onAction:b},null,8,["application"])]),t("div",ve,[c(v,{application:l.value,type:"leave_applications",item:"recommend_by",onAction:b},null,8,["application"]),c(v,{application:l.value,type:"leave_applications",item:"approved_by",onAction:b},null,8,["application"])])])])),t("div",null,[e[32]||(e[32]=t("label",null,"Attachment",-1)),(ct=r.shortLeave)!=null&&ct.attachment&&typeof((bt=r.shortLeave)==null?void 0:bt.attachment)=="string"?(n(),d("div",ye,[t("a",{href:(vt=r.shortLeave)==null?void 0:vt.attachment,target:"_blank",class:"text-blue-500 underline"}," View Current File ",8,me)])):xt("",!0),t("input",{type:"file",onChange:wt,class:"w-full p-2 border rounded"},null,32)]),c(Lt)])}}};export{Le as default};
