import{S as Te,r as S,q as U,h as oe,x,y as Le,i as Ee,o as p,d as v,l as A,c as f,j as P,a as t,T as ze,t as l,F,e as H,b as R,k as le,H as Be,v as Me,Z as Ke,A as je,u as Re,f as Pe,D as B,G as Fe,p as He,m as O,w as K,s as k}from"./index-97A5Hncs.js";import{_ as Ye}from"./EmployeeFilter-D6-OISk6.js";import{L as Qe}from"./LoaderView-D1EjMxlI.js";import{d as Ve}from"./dayjs.min-CQMDRj-N.js";import{u as De}from"./shift-B0k9QPq9.js";import{S as Ge}from"./WeekendAssignModal-BF5SNTX-.js";import{C as Je}from"./CriteriaAssignModal-Dmv6MwNJ.js";import{u as Ze}from"./company-0kjoHLeR.js";import{u as Xe}from"./department-D_v2yz7Y.js";import{u as et}from"./user-CRgGiuVc.js";import{u as tt}from"./userClearance-DUzD_Ews.js";import"./EmployeeDropdownInput-DNJ8d1id.js";import"./SelectDropdown-CTmqFfXb.js";import"./UserChip-Bbpnubsi.js";import"./monthly-kpi-assignments-BNaIJnd_.js";const nt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},st={class:"relative w-full max-w-xl rounded-2xl bg-white shadow-xl ring-1 ring-black/5 p-5"},it={class:"flex items-start justify-between mb-4"},at={class:"flex items-center gap-3"},ot={class:"h-10 w-10 rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center font-semibold"},lt={class:"text-base font-semibold text-gray-900"},dt={class:"text-xs text-gray-500"},rt={class:"flex flex-col gap-2"},ct={class:"md:col-span-5"},pt={class:"rounded-lg border bg-white p-2"},mt={class:"flex items-center justify-between mb-2"},ft={class:"text-xs text-gray-500"},_t={key:0,class:"text-sm text-gray-500"},yt={key:1},ht=["checked"],ut={class:"flex-1"},gt={class:"flex items-center gap-2"},bt={class:"text-sm text-gray-900"},vt={key:0,class:"inline-flex items-center text-xs font-medium rounded-full bg-green-100 text-green-700 px-2 py-0.5"},xt={key:1,class:"inline-flex items-center text-xs font-medium rounded-full bg-gray-100 text-gray-700 px-2 py-0.5"},wt={class:"mt-0.5 text-xs text-gray-600"},kt={key:0,class:"ml-2 text-gray-400"},St={class:"rounded-lg border bg-white p-4"},$t={class:"grid gap-4 md:grid-cols-12"},Ct={class:"md:col-span-12"},qt=["disabled"],At=["value"],Ut={key:0,class:"mt-1 text-xs text-gray-500"},zt={class:"md:col-span-6"},jt={class:"mt-4 flex justify-end gap-2"},Vt=["disabled"],Mt=["disabled"],Dt={key:0},Wt={key:1},Nt={__name:"ShiftAssignmentModal",props:{modelValue:{type:Boolean,default:!1},isOpen:{type:Boolean,default:!1},employee:{type:Object,default:()=>({id:0,name:""})},shifts:{type:[Array,Object],default:()=>[]},hasShift:{type:Object,default:null},current_shift:{type:Object,default:null},shift_history:{type:[Object,Array,null],default:null}},emits:["update:modelValue","saved","close"],setup(Y,{emit:Q}){var L;const d=Y,D=Q,w=Te(),z=De(),u=S(!1);U(()=>d.modelValue,n=>{n!==u.value&&(u.value=n)}),U(()=>d.isOpen,n=>{n!==u.value&&(u.value=n)}),oe(()=>{u.value=!!(d.modelValue||d.isOpen)});function j(){u.value&&(u.value=!1,D("update:modelValue",!1),D("close",!1))}const y=S({shift_id:"",employee_id:((L=d.employee)==null?void 0:L.id)||0,start_date:"",end_date:""});U(()=>d.employee,n=>{y.value.employee_id=(n==null?void 0:n.id)||0},{immediate:!0,deep:!0});const de=x(()=>{var h,r,V,Z;const n=((h=d.employee)==null?void 0:h.name)||String(((r=d.employee)==null?void 0:r.id)||""),o=n.trim().split(/\s+/);return((((V=o[0])==null?void 0:V[0])||"")+(((Z=o[1])==null?void 0:Z[0])||"")||n[0]||"#").toUpperCase().slice(0,2)});function C(n){return n?typeof n=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(n)?n:Ve(n).isValid()?Ve(n).format("YYYY-MM-DD"):"":""}const W=x(()=>{const n=d.shifts;return Array.isArray(n)?n:n&&typeof n=="object"?Object.values(n).flat().filter(Boolean):[]}),ne=x(()=>{const n=d.shift_history;return n&&typeof n=="object"&&Array.isArray(n.history)?n.history:Array.isArray(n)?n:n?[n]:[]}),T=x(()=>ne.value.map(n=>{var o,_;return{id:n.id??null,name:((o=n==null?void 0:n.shift)==null?void 0:o.name)||(n==null?void 0:n.name)||`#${(n==null?void 0:n.shift_id)||(n==null?void 0:n.id)||"—"}`,shift_id:((_=n==null?void 0:n.shift)==null?void 0:_.id)??(n==null?void 0:n.shift_id)??null,start_date:C(n.start_date),end_date:C(n.end_date),status:n.status||(n.end_date?"ended":"active"),days:n.days??null,active:!n.end_date||n.status==="active",created_at:n.created_at?new Date(n.created_at).getTime():0}}).sort((n,o)=>n.active!==o.active?n.active?-1:1:(o.start_date||"").localeCompare(n.start_date||""))),re=x(()=>{const n=d.shift_history;return n&&typeof n=="object"&&typeof n.count=="number"?n.count:T.value.length}),N=x(()=>{var _,h;const n=T.value.find(r=>r.active);if(n)return n;const o=d.current_shift||d.hasShift;return o?{id:o.id??null,name:((_=o==null?void 0:o.shift)==null?void 0:_.name)||(o==null?void 0:o.name)||`#${(o==null?void 0:o.shift_id)||(o==null?void 0:o.id)||"—"}`,shift_id:((h=o==null?void 0:o.shift)==null?void 0:h.id)??(o==null?void 0:o.shift_id)??null,start_date:C(o.start_date),end_date:C(o.end_date),active:!o.end_date}:null});async function se(){const n=N.value;n?(y.value.shift_id=String(n.shift_id||""),y.value.start_date=C(n.start_date)||"",y.value.end_date=C(n.end_date)||""):(y.value.shift_id="",y.value.start_date="",y.value.end_date="")}U(u,(n,o)=>{n&&!o&&je(se)}),U([N,()=>d.shift_history],()=>{u.value&&je(se)});const a=S(!1),I=x(()=>!!y.value.employee_id&&!!y.value.shift_id&&!!y.value.start_date&&!a.value);async function G(){var n,o;try{if(!I.value){w.error("All required fields must be filled");return}a.value=!0;const _={employee_id:Number(y.value.employee_id),shift_id:Number(y.value.shift_id),start_date:y.value.start_date,end_date:y.value.end_date||null},h=await z.shiftAssign(_);w.success(N.value?"Shift updated":"Shift assigned"),D("saved",h),j()}catch(_){const h=((o=(n=_==null?void 0:_.response)==null?void 0:n.data)==null?void 0:o.message)||"Failed to assign shift";w.error(h)}finally{a.value=!1}}function J(n){u.value&&(n.key==="Escape"&&j(),(n.ctrlKey||n.metaKey)&&n.key.toLowerCase()==="enter"&&I.value&&G())}return oe(()=>window.addEventListener("keydown",J)),Le(()=>window.removeEventListener("keydown",J)),(n,o)=>(p(),Ee(Ke,{to:"body"},[v(ze,{name:"fade"},{default:A(()=>[u.value?(p(),f("div",nt,[t("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:j}),v(ze,{name:"pop"},{default:A(()=>{var _,h;return[t("div",st,[t("div",it,[t("div",at,[t("div",ot,l(de.value),1),t("div",null,[t("h3",lt,l(N.value?"Update Shift":"Assign Shift"),1),t("p",dt,l(((_=Y.employee)==null?void 0:_.name)||"#"+(((h=Y.employee)==null?void 0:h.id)||"")),1)])]),t("button",{class:"btn-icon",onClick:j,"aria-label":"Close"},"✕")]),t("div",rt,[t("div",ct,[t("div",pt,[t("div",mt,[o[2]||(o[2]=t("h4",{class:"text-sm font-semibold text-gray-800"},"Shift history",-1)),t("span",ft,l(re.value)+" item(s)",1)]),T.value.length?(p(),f("ul",yt,[(p(!0),f(F,null,H(T.value,(r,V)=>(p(),f("li",{key:r.id??V,class:"flex items-start gap-3"},[t("input",{type:"checkbox",class:"mt-1 rounded border-gray-300",checked:r.active,disabled:""},null,8,ht),t("div",ut,[t("div",gt,[t("span",bt,l(r.name),1),r.active?(p(),f("span",vt,"Active")):(p(),f("span",xt,"Closed"))]),t("div",wt,[R(" Period: "+l(r.start_date||"—")+" → "+l(r.end_date||"present")+" ",1),r.days?(p(),f("span",kt,"("+l(r.days)+" days)",1)):P("",!0)])])]))),128))])):(p(),f("div",_t," No history found "))])]),t("div",St,[t("div",$t,[t("div",Ct,[o[4]||(o[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select Shift",-1)),le(t("select",{"onUpdate:modelValue":o[0]||(o[0]=r=>y.value.shift_id=r),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200",disabled:!W.value.length},[o[3]||(o[3]=t("option",{value:""},"Choose a shift…",-1)),(p(!0),f(F,null,H(W.value,r=>(p(),f("option",{key:r==null?void 0:r.id,value:r==null?void 0:r.id},l(r==null?void 0:r.name),9,At))),128))],8,qt),[[Be,y.value.shift_id]]),W.value.length?P("",!0):(p(),f("p",Ut,"No shifts found"))]),t("div",zt,[o[5]||(o[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),le(t("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>y.value.start_date=r),type:"date",class:"mt-1 w-full rounded-md border px-3 py-2"},null,512),[[Me,y.value.start_date]])])]),t("div",jt,[t("button",{class:"btn-3",onClick:j,disabled:a.value},"Cancel",8,Vt),t("button",{class:"btn-2",onClick:G,disabled:!I.value},[a.value?(p(),f("span",Wt,"Processing…")):(p(),f("span",Dt,l(N.value?"Update":"Assign"),1))],8,Mt)])])])])]}),_:1})])):P("",!0)]),_:1})]))}},It={class:"space-y-3 p-5"},Ot={class:"flex items-center justify-between gap-2"},Tt={class:"flex gap-3"},Lt={key:0,class:"rounded-md border border-indigo-200 bg-indigo-50 p-3 text-sm text-indigo-800"},Et={class:"sticky top-14 z-40 -mx-5 px-5 py-3 bg-white/90 supports-[backdrop-filter]:bg-white/70 backdrop-blur border-b border-zinc-200"},Bt={class:"flex flex-col md:flex-row md:items-end gap-2"},Kt={class:"flex items-center gap-1"},Rt={class:"flex items-center gap-2 w-full md:w-auto"},Pt={class:"mt-2 flex flex-wrap gap-2 text-[12px]"},Ft={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Ht={class:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700"},Yt={class:"px-2 py-1 rounded-full bg-rose-100 text-rose-700"},Qt={class:"px-2 py-1 rounded-full bg-amber-100 text-amber-800"},Gt={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Jt={class:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-800"},Zt={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Xt={key:1,class:"text-center py-6"},en={key:2,class:"space-y-4"},tn={key:0,class:"text-center py-6 text-lg italic text-gray-500"},nn={class:"flex items-center justify-between"},sn={class:"title-md"},an={class:"grid grid-cols-1 gap-2 md:hidden"},on={class:"flex items-start gap-3"},ln={class:"h-10 w-10 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},dn={class:"min-w-0"},rn={class:"font-medium leading-5 truncate"},cn={class:"text-[12px] text-zinc-500"},pn={class:"mt-1 text-[12px] text-zinc-600"},mn={class:"text-[12px] text-zinc-600"},fn={class:"mt-1 text-[12px]"},_n=["href"],yn=["href"],hn={class:"mt-2 flex gap-1"},un=["onClick"],gn=["onClick"],bn=["onClick"],vn={class:"overflow-x-auto hidden md:block"},xn={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},wn={class:"border border-gray-100 px-2 py-2"},kn={class:"border border-gray-100 px-3 py-2"},Sn={class:"flex items-start gap-2"},$n={key:0,class:"h-8 w-8 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},Cn=["src","alt"],qn={key:1,class:"h-8 w-8 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},An={class:"min-w-0"},Un={class:"font-medium truncate max-w-[220px]"},zn={class:"text-[11px] text-zinc-500"},jn={class:"text-[11px] text-zinc-500"},Vn={class:"text-[11px] text-zinc-500"},Mn={class:"border border-gray-100 px-2 py-2"},Dn={class:"flex items-center gap-2"},Wn=["href"],Nn={class:"flex items-center gap-2"},In=["href"],On={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},Tn={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},Ln={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},En={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Bn=["onClick","title"],Kn={class:"ml-1 hidden lg:inline"},Rn={class:"mt-1 text-[11px] text-gray-500"},Pn={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Fn=["onClick","title"],Hn={class:"ml-1 hidden lg:inline"},Yn={class:"mt-1 text-[11px] text-gray-500"},Qn={class:"border border-gray-100 px-2 py-2"},Gn={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Jn=["onClick","title"],Zn={class:"ml-1 hidden lg:inline"},Xn={class:"border border-gray-100 px-2 py-2"},es={class:"flex gap-2"},hs={__name:"UserList",setup(Y){const Q=Re(),d=Pe(),D=Ze(),w=Xe(),z=et(),u=De(),j=tt(),{companies:y}=B(D),{departments:de}=B(w),{shifts:C}=B(u),{users:W,isLoading:ne}=B(z),{items:T,loading:re,error:N,currentUserInfo:se}=B(j),a=Fe({company:String(d.query.company??"all"),department:String(d.query.department??"all"),line_type:String(d.query.line_type??"all"),status:String(d.query.status??"active"),employee_id:String(d.query.employee_id??""),q:String(d.query.q??"")});let I=null;const G=x(()=>{const i={};return a.company&&a.company!=="all"&&(i.company=a.company),a.department&&a.department!=="all"&&(i.department=a.department),a.line_type&&a.line_type!=="all"&&(i.line_type=a.line_type),a.status&&a.status!=="all"&&(i.status=a.status),a.employee_id&&(i.employee_id=a.employee_id),a.q&&(i.q=a.q),d.query.action&&(i.action=d.query.action),i});function J(){clearTimeout(I),I=setTimeout(()=>{Q.replace({query:{...G.value}})},250)}U(a,J,{deep:!0}),oe(async()=>{await D.fetchCompanies(),a.company&&a.company!=="all"&&await w.fetchDepartments(a.company),L()}),U(()=>d.query,()=>L(),{deep:!0});function L(){z.fetchUsers({company_id:d.query.company,department_id:d.query.department,line_type:d.query.line_type,status:d.query.status,user_id:d.query.employee_id,q:d.query.q})}U(()=>a.company,async(i,s)=>{var c;i!==s&&(i&&i!=="all"?await w.fetchDepartments(i):(c=w.$reset)==null||c.call(w))});const n=()=>Q.go(-1),o=x(()=>d.query.action==="clearance"),_=i=>{var s,c;return!!((c=(s=i==null?void 0:i.current_shift)==null?void 0:s.shift)!=null&&c.name)},h=i=>{var s,c;return((c=(s=i==null?void 0:i.current_shift)==null?void 0:s.shift)==null?void 0:c.name)||"Not Assigned"},r=i=>{var s;return Array.isArray((s=i==null?void 0:i.assign_weekend)==null?void 0:s.weekends)&&i.assign_weekend.weekends.length>0},V=i=>r(i)?i.assign_weekend.weekends.join(", "):"Not Assigned",Z=(i,s)=>{var m,q,b;if(!s)return!0;const c=s.toLowerCase();return[i==null?void 0:i.name,i==null?void 0:i.phone,i==null?void 0:i.employee_id,(m=i==null?void 0:i.company)==null?void 0:m.name,(q=i==null?void 0:i.department)==null?void 0:q.name,(b=i==null?void 0:i.designation)==null?void 0:b.title].some(te=>String(te||"").toLowerCase().includes(c))},We=i=>{if(a.status==="all")return!0;const s=a.status==="active"?1:0;return Number((i==null?void 0:i.is_active)??0)===s},ce=x(()=>(Array.isArray(W.value)?W.value:[]).filter(s=>{var c;return!(a.company!=="all"&&String((c=s==null?void 0:s.company)==null?void 0:c.id)!==String(a.company)||a.line_type!=="all"&&String(s==null?void 0:s.type)!==String(a.line_type)||a.employee_id&&String(s==null?void 0:s.id)!==String(a.employee_id)||!We(s)||!Z(s,a.q))})),M=x(()=>{const i=ce.value,s=i.length,c=i.filter(b=>Number((b==null?void 0:b.is_active)??0)===1).length,m=i.filter(b=>_(b)).length,q=i.filter(b=>r(b)).length;return{total:s,active:c,inactive:s-c,withShift:m,withoutShift:s-m,withWeekend:q,withoutWeekend:s-q}}),pe=x(()=>{var s;const i={};for(const c of ce.value){const m=((s=c==null?void 0:c.company)==null?void 0:s.name)||"Unknown Company";(i[m]??(i[m]=[])).push(c)}return i});S(null);const g=S(null),ie=S(null),me=S(null),X=S(!1),ae=S(!1),ee=S(!1);async function fe(i){if(g.value=i,i!=null&&i.company_id){const s=await z.fetchUserShifts(i.id);me.value=s,await u.fetchShifts(i.company_id)}X.value=!0}async function _e(i){g.value=i,ae.value=!0;try{const s=await z.fetchUserWeekends(i.id);ie.value=s}catch{ie.value={history:[],current:null}}}function ye(i){g.value=i,ee.value=!0}async function Ne(){await z.fetchUsersExcelExport({data:{company_id:a.company!=="all"?a.company:void 0,department_id:a.department!=="all"?a.department:void 0,line_type:a.line_type!=="all"?a.line_type:void 0,status:a.status!=="all"?a.status:void 0,employee_id:a.employee_id||void 0,q:a.q||void 0}})}function Ie(){ee.value=!1}function Oe(){a.company="all",a.department="all",a.line_type="all",a.status="active",a.employee_id="",a.q=""}return(i,s)=>{const c=He("RouterLink");return p(),f("div",It,[t("div",Ot,[t("button",{class:"btn-3",onClick:n},s[15]||(s[15]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),s[18]||(s[18]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Employee List",-1)),t("div",Tt,[v(c,{to:{name:"UserAdd",query:{company:O(d).query.company}},class:"btn-2"},{default:A(()=>s[16]||(s[16]=[t("span",{class:"hidden md:flex"},"Add New",-1),t("i",{class:"far fa-plus"},null,-1)])),_:1,__:[16]},8,["to"]),t("button",{type:"button",onClick:Ne,class:"btn-3"},s[17]||(s[17]=[t("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1),R("Excel ")]))])]),o.value?(p(),f("div",Lt," Select a user to view clearance & print. ")):P("",!0),t("div",Et,[t("div",Bt,[v(Ye,{company_id:a.company,"onUpdate:company_id":s[3]||(s[3]=m=>a.company=m),department_id:a.department,"onUpdate:department_id":s[4]||(s[4]=m=>a.department=m),employee_id:a.employee_id,"onUpdate:employee_id":s[5]||(s[5]=m=>a.employee_id=m),line_type:a.line_type,"onUpdate:line_type":s[6]||(s[6]=m=>a.line_type=m),"with-type":!0,"initial-value":i.$route.query,class:"w-full"},{default:A(()=>[t("div",Kt,[t("button",{class:k(["h-8 px-3 text-xs rounded-l-md border transition",a.status==="all"?"bg-zinc-800 text-white border-zinc-800":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:s[0]||(s[0]=K(m=>a.status="all",["prevent"]))},"All",2),t("button",{class:k(["h-8 px-3 text-xs border-y transition",a.status==="active"?"bg-emerald-600 text-white border-emerald-600":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:s[1]||(s[1]=K(m=>a.status="active",["prevent"]))},"Active",2),t("button",{class:k(["h-8 px-3 text-xs rounded-r-md border transition",a.status==="in_active"?"bg-rose-600 text-white border-rose-600":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:s[2]||(s[2]=K(m=>a.status="in_active",["prevent"]))},"Inactive",2)])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"]),t("div",Rt,[le(t("input",{"onUpdate:modelValue":s[7]||(s[7]=m=>a.q=m),type:"text",placeholder:"Search name / phone / ID",class:"input-1 h-8 text-sm w-full md:w-64"},null,512),[[Me,a.q,void 0,{trim:!0}]]),t("button",{type:"button",onClick:Oe,class:"inline-flex h-8 items-center rounded-md border border-zinc-300 bg-zinc-50 px-3 text-[12px] font-medium text-zinc-700 hover:bg-white active:scale-[.99]",title:"Reset filters"},s[19]||(s[19]=[t("i",{class:"far fa-undo mr-1"},null,-1),R(" Reset ")]))])]),t("div",Pt,[t("span",Ft,"Total: "+l(M.value.total),1),t("span",Ht,"Active: "+l(M.value.active),1),t("span",Yt,"Inactive: "+l(M.value.inactive),1),t("span",Qt,"With Shift: "+l(M.value.withShift),1),t("span",Gt,"No Shift: "+l(M.value.withoutShift),1),t("span",Jt,"With Weekend: "+l(M.value.withWeekend),1),t("span",Zt,"No Weekend: "+l(M.value.withoutWeekend),1)])]),O(ne)?(p(),f("div",Xt,[v(Qe)])):(p(),f("div",en,[Object.keys(pe.value).length===0?(p(),f("div",tn," No users found ")):P("",!0),(p(!0),f(F,null,H(pe.value,(m,q)=>{var b,te,he,ue,ge,be,ve,xe;return p(),f("div",{key:q,class:"space-y-2"},[t("div",nn,[t("h2",sn,l(q)+" ("+l(m.length)+")",1)]),t("div",an,[(p(!0),f(F,null,H(m,e=>{var $;return p(),f("div",{key:e.id,class:"rounded-lg border border-zinc-200 bg-white p-3 shadow-sm"},[t("div",on,[t("div",ln,l(((e==null?void 0:e.name)||"?").charAt(0).toUpperCase()),1),t("div",dn,[t("div",rn,l(e==null?void 0:e.name),1),t("div",cn,"ID: "+l(e==null?void 0:e.employee_id)+" • "+l((($=e==null?void 0:e.designation)==null?void 0:$.title)||"—"),1),t("div",pn,"Shift: "+l(h(e)),1),t("div",mn,"Weekend: "+l(V(e)),1),t("div",fn,[t("a",{class:"underline",href:"tel:"+(e==null?void 0:e.phone),onClick:s[8]||(s[8]=K(()=>{},["stop"]))},l((e==null?void 0:e.phone)||"—"),9,_n),s[20]||(s[20]=t("span",{class:"mx-1"},"•",-1)),t("a",{class:"underline",href:"mailto:"+((e==null?void 0:e.email)||""),onClick:s[9]||(s[9]=K(()=>{},["stop"]))},l((e==null?void 0:e.email)||"নেই"),9,yn)]),t("div",hn,[t("button",{class:"btn-3 !px-2 !py-1",onClick:E=>fe(e)},"Shift",8,un),t("button",{class:"btn-3 !px-2 !py-1",onClick:E=>_e(e)},"Weekend",8,gn),t("button",{class:"btn-3 !px-2 !py-1",onClick:E=>ye(e)},"KPI",8,bn),v(c,{to:{name:"UserShow",params:{id:e.id},query:{company:O(d).query.company}},class:"btn-3 !px-2 !py-1"},{default:A(()=>s[21]||(s[21]=[R("View")])),_:2,__:[21]},1032,["to"])])])])])}),128))]),t("div",vn,[t("table",xn,[s[25]||(s[25]=t("thead",null,[t("tr",{class:"bg-gray-100 text-sm font-medium text-gray-700"},[t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"#"),t("th",{class:"border border-gray-200 px-3 py-2 text-left"},"Name"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Phone & Email"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Finger ID"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Joining"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Role"),t("th",{class:"border border-gray-200 px-3 py-2 text-left"},"Shift"),t("th",{class:"border border-gray-200 px-3 py-2 text-left"},"Weekend"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Status"),t("th",{class:"border border-gray-200 px-3 py-2 text-left"},"KPI Criteria"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Action")])],-1)),t("tbody",null,[(p(!0),f(F,null,H(m,(e,$)=>{var E,we,ke,Se,$e,Ce,qe,Ae;return p(),f("tr",{key:e.id,class:"border-b text-sm border-gray-100 hover:bg-indigo-50/50"},[t("td",wn,l($+1),1),t("td",kn,[t("div",Sn,[e.photo?(p(),f("div",$n,[t("img",{src:e.photo,alt:e==null?void 0:e.name,class:"h-8 w-8 rounded-full object-cover"},null,8,Cn)])):(p(),f("div",qn,l(((e==null?void 0:e.name)||"?").charAt(0).toUpperCase()),1)),t("div",An,[t("div",Un,l(e==null?void 0:e.name),1),t("div",zn,l(e==null?void 0:e.bn_name),1),t("div",jn,l(((E=e==null?void 0:e.designation)==null?void 0:E.title)||"—"),1),t("div",Vn,"ID: "+l(e==null?void 0:e.employee_id),1)])])]),t("td",Mn,[t("div",Dn,[t("a",{class:"underline",href:"tel:"+(e==null?void 0:e.phone)},l((e==null?void 0:e.phone)||"—"),9,Wn)]),t("div",Nn,[t("a",{class:"underline",href:"mailto:"+((e==null?void 0:e.email)||"")},l((e==null?void 0:e.email)||"নেই"),9,In)])]),t("td",On,l(e==null?void 0:e.device_user_id),1),t("td",Tn,l(e==null?void 0:e.joining_date),1),t("td",Ln,l(e==null?void 0:e.role),1),t("td",En,[t("button",{onClick:Ue=>fe(e),title:_(e)?"Manage Shift":"Assign Shift",class:k(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",_(e)?"border-amber-200 bg-amber-50 text-amber-700 hover:bg-amber-100 focus:ring-amber-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"])},[t("span",Kn,l(_(e)?"Manage":"Assign"),1),t("span",{class:k(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",_(e)?"bg-amber-600 text-white":"bg-slate-200 text-slate-700"])},l((e==null?void 0:e.shifts_count)||(_(e)?1:0)),3)],10,Bn),t("div",Rn,l(h(e)),1)]),t("td",Pn,[t("button",{onClick:Ue=>_e(e),title:r(e)?"Manage Weekend":"Assign Weekend",class:k(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",r(e)?"border-emerald-200 bg-emerald-50 text-emerald-700 hover:bg-emerald-100 focus:ring-emerald-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"])},[t("span",Hn,l(r(e)?"Manage":"Assign"),1),t("span",{class:k(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",r(e)?"bg-emerald-600 text-white":"bg-slate-200 text-slate-700"])},l((e==null?void 0:e.assign_weekends_count)||r(e)&&((ke=(we=e==null?void 0:e.assign_weekend)==null?void 0:we.weekends)==null?void 0:ke.length)||0),3)],10,Fn),t("div",Yn,l(V(e)),1)]),t("td",Qn,[t("span",{class:k(e!=null&&e.is_active?"text-emerald-600":"text-rose-500")},l(e!=null&&e.is_active?"Active":"Inactive"),3)]),t("td",Gn,[t("button",{onClick:Ue=>ye(e),title:(((Se=e==null?void 0:e.criteria_assignments)==null?void 0:Se.length)||0)>0?"Manage KPI criteria":"Assign KPI criteria",class:k(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",((($e=e==null?void 0:e.criteria_assignments)==null?void 0:$e.length)||0)>0?"border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 focus:ring-indigo-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"])},[t("span",Zn,l((((Ce=e==null?void 0:e.criteria_assignments)==null?void 0:Ce.length)||0)>0?"Manage":"Assign"),1),t("span",{class:k(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",(((qe=e==null?void 0:e.criteria_assignments)==null?void 0:qe.length)||0)>0?"bg-indigo-600 text-white":"bg-slate-200 text-slate-700"])},l(((Ae=e==null?void 0:e.criteria_assignments)==null?void 0:Ae.length)||0),3)],10,Jn)]),t("td",Xn,[t("div",es,[v(c,{to:{name:"UserShow",params:{id:e.id},query:{company:O(d).query.company}},class:"btn-icon",title:"View"},{default:A(()=>s[22]||(s[22]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[22]},1032,["to"]),v(c,{to:{name:"UserEdit",params:{id:e.id},query:{company:O(d).query.company}},class:"btn-icon",title:"Edit"},{default:A(()=>s[23]||(s[23]=[t("i",{class:"far fa-edit"},null,-1)])),_:2,__:[23]},1032,["to"]),v(c,{to:{name:"KpiReview",params:{employeeId:e.id}},class:"btn-icon",title:"KPI"},{default:A(()=>s[24]||(s[24]=[R(" KPI ")])),_:2,__:[24]},1032,["to"])])])])}),128))])])]),v(Je,{modelValue:ee.value,"onUpdate:modelValue":s[10]||(s[10]=e=>ee.value=e),"user-id":(b=g.value)==null?void 0:b.id,"user-label":(te=g.value)==null?void 0:te.name,criteria_assignments:(he=g.value)==null?void 0:he.criteria_assignments,onAssigned:Ie},null,8,["modelValue","user-id","user-label","criteria_assignments"]),v(Ge,{modelValue:ae.value,"onUpdate:modelValue":s[11]||(s[11]=e=>ae.value=e),"user-id":(ue=g.value)==null?void 0:ue.id,"user-label":(ge=g.value)==null?void 0:ge.name,assign_weekends:ie.value,onSaved:s[12]||(s[12]=e=>{const $=e==null?void 0:e.current;$&&g.value&&(g.value.assign_weekend={weekends:$.weekends||[],start_month:$.start_month,end_month:$.end_month})})},null,8,["modelValue","user-id","user-label","assign_weekends"]),v(Nt,{modelValue:X.value,"onUpdate:modelValue":s[13]||(s[13]=e=>X.value=e),shifts:O(C),employee:{id:(be=g.value)==null?void 0:be.id,name:(ve=g.value)==null?void 0:ve.name},"has-shift":(xe=g.value)==null?void 0:xe.current_shift,shift_history:me.value,onClose:s[14]||(s[14]=e=>X.value=!1)},null,8,["modelValue","shifts","employee","has-shift","shift_history"])])}),128))]))])}}};export{hs as default};
