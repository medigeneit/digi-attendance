import{u as It,r as x,p as St,b as Wt,c as r,a as e,k as a,j as $t,t as l,B as Tt,h as p,e as u,F as ft,x as Vt,y as gt,l as Ht,d as Mt,v as Ot,f as Ft,o,g as Pt}from"./index-xXJHQ6f4.js";import{L as Et}from"./LoaderView-DHQGN_z6.js";import{_ as Ut}from"./ShareComponent-DIIqWiOX.js";import{u as zt}from"./leave-application-DSs_mZ9v.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const qt={class:"my-container max-w-3xl space-y-6"},Gt={key:1,class:"card-bg p-4 md:p-8"},Jt={class:"title-lg text-center"},Kt={class:"text-center text-sm"},Qt={class:"space-y-4"},Xt={class:"grid md:grid-cols-2 print:grid-cols-2 gap-8"},Yt={class:""},Zt={class:"text-sm"},es={class:"grid print:grid-cols-2 md:grid-cols-2 text-sm"},ts={class:"text-sm"},ss={class:"pt-8 grid grid-cols-2"},ls={class:"text-sm"},as={class:"flex flex-col justify-center items-center text-sm"},ns={key:0,class:"print:hidden"},os={class:"text-xs text-center"},rs={class:"flex justify-center gap-2"},is={class:"font-bold"},ds={key:0,class:"text-green-600 print:text-black"},us={key:1,class:"pl-2 text-yellow-700"},ps={class:"overflow-x-auto"},cs={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},vs={class:"border border-gray-500 px-4 py-0.5 text-left"},bs={class:"border border-gray-500 px-4 py-0.5 text-center"},ys={class:"border border-gray-500 px-4 py-0.5 text-center"},ms={class:"space-y-14"},xs={class:"font-bold text-center text-lg"},_s={key:0},fs={class:"grid md:grid-cols-3 print:grid-cols-3 gap-4 text-sm items-end"},gs={class:"flex flex-col justify-center items-center"},ks={key:0,class:"print:hidden"},As={class:"text-center"},ws={class:"text-xs text-center text-blue-600"},js={class:"flex justify-center gap-4"},hs={class:"font-bold"},Cs={key:0,class:"text-green-600"},Ls={class:"flex flex-col justify-center items-center"},Bs={key:0,class:"print:hidden"},Rs={class:"text-center"},Ds={class:"text-xs text-center text-blue-600"},Ns={class:"flex justify-center gap-4"},Is={class:"font-bold"},Ss={key:0,class:"text-green-600"},Ws={class:"flex flex-col justify-center items-center"},$s={key:0,class:"print:hidden"},Ts={class:"text-center"},Vs={class:"text-xs text-center text-blue-600"},Hs={class:"flex justify-center gap-4"},Ms={class:"font-bold"},Os={key:0,class:"text-green-600"},Fs={class:"flex justify-evenly text-sm items-end"},Ps={class:"flex flex-col justify-center items-center"},Es={key:0,class:"print:hidden"},Us={class:"text-center"},zs={class:"text-xs text-center text-blue-600"},qs={class:"flex justify-center gap-4"},Gs={class:"font-bold"},Js={key:0,class:"text-green-600"},Ks={class:"flex flex-col justify-center items-center"},Qs={key:0,class:"print:hidden"},Xs={class:"text-center"},Ys={class:"text-xs text-center text-blue-600"},Zs={class:"flex justify-center gap-4"},el={class:"font-bold"},tl={key:0,class:"text-green-600"},sl={key:0,class:"modal-bg"},ll={class:"modal-card"},al={class:"flex justify-end gap-2 mt-4"},pl={__name:"LeaveApplicationShow",setup(nl){const c=It(),i=zt(),kt=Pt(),m=Ft(),_=x(!0),b=x(!1),y=x(""),s=St(()=>i.leaveApplication);Wt(async()=>{const{id:n}=m.params;try{await i.fetchLeaveApplicationById(n)}catch(t){console.error("Failed to load leave application:",t)}finally{_.value=!1}});async function At(){try{await i.rejectLeaveApplication(m.params.id,{rejection_reason:y.value}),alert("Leave application rejected successfully!"),b.value=!1,y.value="",await i.fetchLeaveApplicationById(m.params.id)}catch(n){alert(n.message)}}function v(){b.value=!0}async function wt(n){try{await i.acceptHandover(n),alert("Handover accepted successfully!"),await i.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function jt(n){try{await i.acceptInCharge(n),alert("Leave Application Successfully Accepted!"),await i.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function ht(n){try{await i.acceptCoordinator(n),alert("Coordinator accepted successfully!"),await i.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function Ct(n){try{await i.acceptOperationalAdmin(n),alert("Operational Admin accepted successfully!"),await i.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function Lt(n){try{await i.acceptRecommendBy(n),alert("Recommendation accepted successfully!"),await i.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function Bt(n){try{await i.acceptApprovedBy(n),alert("Leave Application approved successfully!"),await i.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}function Rt(){window.print()}const Dt=()=>kt.go(-1);return(n,t)=>{var f,g,k,A,w,j,h,C,L,B,R,D,N,I,S,W,$,T,V,H,M,O,F,P,E,U,z,q,G,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ie,de,ue,pe,ce,ve,be,ye,me,xe,_e,fe,ge,ke,Ae,we,je,he,Ce,Le,Be,Re,De,Ne,Ie,Se,We,$e,Te,Ve,He,Me,Oe,Fe,Pe,Ee,Ue,ze,qe,Ge,Je,Ke,Qe,Xe,Ye,Ze,et,tt,st,lt,at,nt,ot,rt,it,dt,ut,pt,ct,vt,bt,yt,mt,xt,_t;return o(),r(ft,null,[e("div",qt,[e("div",{class:"flex items-center justify-between gap-2 print:hidden"},[e("button",{class:"btn-3",onClick:Dt},t[8]||(t[8]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[10]||(t[10]=e("h1",{class:"title-md md:title-xl flex-wrap text-center"},"Leave Application",-1)),e("div",null,[e("button",{class:"btn-2",onClick:Rt},t[9]||(t[9]=[e("i",{class:"far fa-print"},null,-1),a(" Print ")]))])]),_.value?(o(),$t(Et,{key:0})):(o(),r("div",Gt,[e("div",null,[e("h1",Jt,l((k=(g=(f=s.value)==null?void 0:f.user)==null?void 0:g.company)==null?void 0:k.name),1),e("p",Kt,l((w=(A=s.value)==null?void 0:A.user)==null?void 0:w.company.address),1)]),e("div",Qt,[e("div",Xt,[e("div",null,[t[11]||(t[11]=e("p",null,"To",-1)),t[12]||(t[12]=e("p",{class:"font-bold"},"Managing Director",-1)),e("p",Yt,l((C=(h=(j=s.value)==null?void 0:j.user)==null?void 0:h.company)==null?void 0:C.name),1),e("p",Zt,l((B=(L=s.value)==null?void 0:L.user)==null?void 0:B.company.address),1)]),t[13]||(t[13]=Tt('<div class="flex justify-end items-center"><table class="table-auto border border-black bg-white text-xs"><thead><tr class="bg-gray-200 border border-black"><th class="border border-black px-2">Type</th><th class="border border-black px-2">Days</th></tr></thead><tbody><tr class="border border-black"><td class="border border-black px-2">CL</td><td class="border border-black px-2">1</td></tr></tbody></table></div>',1))]),t[35]||(t[35]=e("div",null,[e("p",{class:""},[e("b",null,"Subject:"),a(" Leave Application")])],-1)),t[36]||(t[36]=e("div",null,null,-1)),e("div",null,[t[20]||(t[20]=e("h3",{class:"font-bold"},"Leave Details:",-1)),e("div",es,[e("li",null,[t[14]||(t[14]=e("strong",null,"Reason: ",-1)),a(l(((R=s.value)==null?void 0:R.reason)||"No reason provided"),1)]),e("li",null,[t[15]||(t[15]=e("strong",null,"Leave Days:",-1)),a(" "+l((D=s.value)==null?void 0:D.leave_period),1)]),e("li",null,[t[16]||(t[16]=e("strong",null,"Total Days:",-1)),a(" "+l((N=s.value)==null?void 0:N.total_leave_days),1)]),e("li",null,[t[17]||(t[17]=e("strong",null,"Weekends:",-1)),a(" "+l((I=s.value)==null?void 0:I.user.weekends.join(", ")),1)]),e("li",null,[t[18]||(t[18]=e("strong",null,"Last Working Date:",-1)),a(" "+l((S=s.value)==null?void 0:S.last_working_date),1)]),e("li",null,[t[19]||(t[19]=e("strong",null,"Resumption Date:",-1)),a(" "+l((W=s.value)==null?void 0:W.resumption_date),1)])])]),e("div",ts,[e("p",null,[t[21]||(t[21]=e("strong",null,"Works in Hand: ",-1)),a(l((($=s.value)==null?void 0:$.works_in_hand)||"No details provided"),1)])]),e("div",ss,[e("div",null,[e("div",ls,[t[26]||(t[26]=e("hr",{class:"w-44 border-black hidden print:block"},null,-1)),e("p",null,[t[22]||(t[22]=e("strong",null,"Applicant:",-1)),a(" "+l((V=(T=s.value)==null?void 0:T.user)==null?void 0:V.name),1)]),e("p",null,[t[23]||(t[23]=e("strong",null,"Designation:",-1)),a(" "+l((O=(M=(H=s.value)==null?void 0:H.user)==null?void 0:M.designation)==null?void 0:O.title),1)]),e("p",null,[t[24]||(t[24]=e("strong",null,"Department:",-1)),a(" "+l((E=(P=(F=s.value)==null?void 0:F.user)==null?void 0:P.department)==null?void 0:E.name),1)]),e("p",null,[t[25]||(t[25]=e("strong",null,"Phone:",-1)),a(" "+l((z=(U=s.value)==null?void 0:U.user)==null?void 0:z.phone),1)])])]),e("div",as,[e("p",null,l(((G=(q=s.value)==null?void 0:q.handover_user)==null?void 0:G.name)||"Not assigned"),1),!((J=s.value)!=null&&J.status)&&s.value.handover_user_id===p(c).user.id?(o(),r("div",ns,[e("p",os,[a(l((Q=(K=s.value)==null?void 0:K.user)==null?void 0:Q.name)+" has assigned you for his handover. ",1),t[27]||(t[27]=e("br",null,null,-1)),t[28]||(t[28]=a(" Do you agree? "))]),e("div",rs,[e("button",{class:"font-bold text-lg text-green-600 px-2",onClick:t[0]||(t[0]=d=>wt(s.value.id))}," ✔ "),t[29]||(t[29]=e("button",{class:"px-2"},"❌",-1))])])):u("",!0),t[32]||(t[32]=e("hr",{class:"w-44 border-black"},null,-1)),e("h4",is,[t[31]||(t[31]=a(" Handover ")),(X=s.value)!=null&&X.handover_user_id&&((Y=s.value)!=null&&Y.status)?(o(),r("span",ds," (✔) ")):u("",!0),(Z=s.value)!=null&&Z.handover_user_id&&!((ee=s.value)!=null&&ee.status)?(o(),r("span",us,t[30]||(t[30]=[e("i",{class:"fad fa-spinner"},null,-1)]))):u("",!0)])])]),e("div",null,[t[34]||(t[34]=e("h1",{class:"font-bold"},"Leave Balance",-1)),e("div",ps,[e("table",cs,[t[33]||(t[33]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-500 px-4 py-0.5 text-left"},"Leave Type"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Total Days"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Used Days"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Remaining Days")])],-1)),e("tbody",null,[(o(!0),r(ft,null,Vt(p(i).leaveBalance,(d,Nt)=>(o(),r("tr",{key:Nt,class:"hover:bg-blue-200"},[e("td",vs,l(d.leave_type),1),e("td",bs,l(d.total_days),1),e("td",ys,l(d.used_days),1),e("td",{class:gt(["border border-gray-500 px-4 py-0.5 text-center",{"text-green-600 font-bold":d.remaining_days>0,"text-red-600 font-bold":d.remaining_days===0}])},l(d.remaining_days),3)]))),128))])])])])]),e("div",ms,[e("p",xs,[t[37]||(t[37]=a(" Leave Approval: ")),e("b",{class:gt({"text-yellow-600":((te=s.value)==null?void 0:te.status)==="Pending","text-green-600":((se=s.value)==null?void 0:se.status)==="Approved","text-red-600":((le=s.value)==null?void 0:le.status)==="Rejected"})},l(((ae=s.value)==null?void 0:ae.status)||"N/A"),3)]),((ne=s.value)==null?void 0:ne.status)==="Rejected"?(o(),r("div",_s,[e("p",null,[t[38]||(t[38]=e("b",null,"Rejected by: ",-1)),a(" "+l((re=(oe=s.value)==null?void 0:oe.rejected_by_user)==null?void 0:re.name),1)]),e("p",null,[t[39]||(t[39]=e("b",null,"rejection Reason: ",-1)),a(" "+l(s.value.rejection_reason),1)])])):u("",!0),e("div",fs,[e("div",gs,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ie=s.value)!=null&&ie.in_charge_user_id)&&((pe=(ue=(de=s.value)==null?void 0:de.user)==null?void 0:ue.leave_approval)==null?void 0:pe.in_charge_user_id)===p(c).user.id?(o(),r("div",ks,[e("p",As,l(((ye=(be=(ve=(ce=s.value)==null?void 0:ce.user)==null?void 0:ve.leave_approval)==null?void 0:be.in_charge_user)==null?void 0:ye.name)||"N/A"),1),e("p",ws,[a(l((xe=(me=s.value)==null?void 0:me.user)==null?void 0:xe.name)+" has submitted an application. ",1),t[40]||(t[40]=e("br",null,null,-1)),t[41]||(t[41]=a(" Will you forward it? "))]),e("div",js,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[1]||(t[1]=d=>jt(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((fe=(_e=s.value)==null?void 0:_e.in_charge_user)==null?void 0:fe.name)||""),1),t[43]||(t[43]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",hs,[t[42]||(t[42]=a(" In-Charge ")),(ge=s.value)!=null&&ge.in_charge_user_id?(o(),r("span",Cs,"(✔)")):u("",!0)])]),e("div",Ls,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ke=s.value)!=null&&ke.coordinator_user_id)&&((je=(we=(Ae=s.value)==null?void 0:Ae.user)==null?void 0:we.leave_approval)==null?void 0:je.coordinator_user_id)===p(c).user.id?(o(),r("div",Bs,[e("p",Rs,l(((Be=(Le=(Ce=(he=s.value)==null?void 0:he.user)==null?void 0:Ce.leave_approval)==null?void 0:Le.coordinator_user)==null?void 0:Be.name)||"N/A"),1),e("p",Ds,[a(l((De=(Re=s.value)==null?void 0:Re.user)==null?void 0:De.name)+" has submitted an application. ",1),t[44]||(t[44]=e("br",null,null,-1)),t[45]||(t[45]=a(" Will you recommend it? "))]),e("div",Ns,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[2]||(t[2]=d=>ht(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((Ie=(Ne=s.value)==null?void 0:Ne.coordinator_user)==null?void 0:Ie.name)||""),1),t[47]||(t[47]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Is,[t[46]||(t[46]=a(" Coordinator ")),(Se=s.value)!=null&&Se.coordinator_user_id?(o(),r("span",Ss,"(✔)")):u("",!0)])]),e("div",Ws,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((We=s.value)!=null&&We.operational_admin_user_id)&&((Ve=(Te=($e=s.value)==null?void 0:$e.user)==null?void 0:Te.leave_approval)==null?void 0:Ve.operational_admin_user_id)===p(c).user.id?(o(),r("div",$s,[e("p",Ts,l(((Fe=(Oe=(Me=(He=s.value)==null?void 0:He.user)==null?void 0:Me.leave_approval)==null?void 0:Oe.operational_admin_user)==null?void 0:Fe.name)||"N/A"),1),e("p",Vs,[a(l((Ee=(Pe=s.value)==null?void 0:Pe.user)==null?void 0:Ee.name)+" has submitted an application.",1),t[48]||(t[48]=e("br",null,null,-1)),t[49]||(t[49]=a(" Will you recommend it? "))]),e("div",Hs,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[3]||(t[3]=d=>Ct(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((ze=(Ue=s.value)==null?void 0:Ue.operational_admin_user)==null?void 0:ze.name)||""),1),t[51]||(t[51]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Ms,[t[50]||(t[50]=a(" Operational Admin ")),(qe=s.value)!=null&&qe.operational_admin_user_id?(o(),r("span",Os,"(✔)")):u("",!0)])])]),e("div",Fs,[e("div",Ps,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Ge=s.value)!=null&&Ge.recommend_by_user_id)&&((Qe=(Ke=(Je=s.value)==null?void 0:Je.user)==null?void 0:Ke.leave_approval)==null?void 0:Qe.recommend_by_user_id)===p(c).user.id?(o(),r("div",Es,[e("p",Us,l(((et=(Ze=(Ye=(Xe=s.value)==null?void 0:Xe.user)==null?void 0:Ye.leave_approval)==null?void 0:Ze.recommend_by_user)==null?void 0:et.name)||"N/A"),1),e("p",zs,[a(l((st=(tt=s.value)==null?void 0:tt.user)==null?void 0:st.name)+" has submitted an application.",1),t[52]||(t[52]=e("br",null,null,-1)),t[53]||(t[53]=a(" Will you recommend it? "))]),e("div",qs,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[4]||(t[4]=d=>Lt(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((at=(lt=s.value)==null?void 0:lt.recommend_by_user)==null?void 0:at.name)||""),1),t[55]||(t[55]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Gs,[t[54]||(t[54]=a(" Recommend By ")),(nt=s.value)!=null&&nt.recommend_by_user_id?(o(),r("span",Js,"(✔)")):u("",!0)])]),e("div",Ks,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ot=s.value)!=null&&ot.approved_by_user_id)&&((dt=(it=(rt=s.value)==null?void 0:rt.user)==null?void 0:it.leave_approval)==null?void 0:dt.approved_by_user_id)===p(c).user.id?(o(),r("div",Qs,[e("p",Xs,l(((vt=(ct=(pt=(ut=s.value)==null?void 0:ut.user)==null?void 0:pt.leave_approval)==null?void 0:ct.approved_by_user)==null?void 0:vt.name)||"N/A"),1),e("p",Ys,[a(l((yt=(bt=s.value)==null?void 0:bt.user)==null?void 0:yt.name)+" has submitted an application.",1),t[56]||(t[56]=e("br",null,null,-1)),t[57]||(t[57]=a(" Will you accept it? "))]),e("div",Zs,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[5]||(t[5]=d=>Bt(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((xt=(mt=s.value)==null?void 0:mt.approved_by_user)==null?void 0:xt.name)||""),1),t[59]||(t[59]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",el,[t[58]||(t[58]=a(" Approved By ")),(_t=s.value)!=null&&_t.approved_by_user_id?(o(),r("span",tl,"(✔)")):u("",!0)])])])])])),Ht(Ut)]),b.value?(o(),r("div",sl,[e("div",ll,[t[60]||(t[60]=e("h3",{class:"title-lg"},"Reject Application",-1)),Mt(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=d=>y.value=d),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[Ot,y.value]]),e("div",al,[e("button",{class:"btn-3",onClick:t[7]||(t[7]=d=>b.value=!1)},"Cancel"),e("button",{class:"btn-2 bg-red-500 text-white",onClick:At},"Confirm")])])])):u("",!0)],64)}}};export{pl as default};
