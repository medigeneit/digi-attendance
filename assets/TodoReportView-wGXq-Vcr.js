import{r as k,G as Ee,x as w,q as F,c as d,o,a as e,N as Se,w as P,s as A,d as oe,k as $e,v as Ce,f as He,u as We,D as Ne,h as ae,y as Re,j as f,i as Je,l as re,m as K,t as p,F as D,e as j,b as Q,M as Ke}from"./index-BNhe2lqp.js";import{L as Qe}from"./LoaderView-BTYRiTrH.js";import{_ as Ye}from"./EmployeeFilter-BVsRWJVu.js";import{_ as Xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{g as Ze,b as Y}from"./datetime-BEfC2TVK.js";import{u as qe}from"./attendance-Dgy1MCOq.js";import{u as Ge}from"./company-BVKy56Kd.js";import{u as et}from"./department-2pRLMYHF.js";import{u as tt}from"./useTodoDateStore-Bnyt9MSn.js";import"./EmployeeDropdownInput-Yhbwe4rk.js";import"./SelectDropdown-Bgsgpmvk.js";import"./UserChip-CbUZBgIq.js";import"./url-CePbr-gY.js";const nt={class:"px-4 py-4 md:py-3 bg-white rounded-md border"},st={class:"flex flex-wrap items-center gap-3"},at=["disabled"],rt={class:"print-hide"},ot={class:"flex flex-col md:flex-row flex-wrap items-end md:ml-auto w-full md:w-auto gap-x-3 gap-y-4 print-hide"},dt={class:"flex items-center justify-between w-full md:w-auto gap-3"},lt={class:"relative h-[32px] w-[150px] sm:w-[170px]"},it={class:"relative h-[32px] w-[150px] sm:w-[170px]"},pt={__name:"TodoReportHeading",props:{loading:{type:Boolean,default:!1},companyId:{type:[String,Number],default:""},departmentId:{type:[String,Number],default:""},employeeId:{type:[String,Number],default:""},lineType:{type:String,default:"all"},startDate:{type:String,default:""},endDate:{type:String,default:""}},emits:["reloadClick","change"],setup(O,{expose:_,emit:X}){const u=O,N=k(null),U=X,i=Ee({companyId:String(u.companyId||""),departmentId:u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",employeeId:String(u.employeeId||""),lineType:u.lineType||"all",startDate:u.startDate||"",endDate:u.endDate||""}),z=w(()=>({companyId:i.companyId,departmentId:i.departmentId,employeeId:i.employeeId,lineType:i.lineType,startDate:i.startDate,endDate:i.endDate}));function H(){U("change",{...z.value})}F(()=>[u.companyId,u.departmentId,u.employeeId,u.lineType,u.startDate,u.endDate],()=>{i.companyId=String(u.companyId||""),i.departmentId=u.departmentId!==""&&u.departmentId!=null?String(u.departmentId):"",i.employeeId=String(u.employeeId||""),i.lineType=u.lineType||"all",i.startDate=u.startDate||"",i.endDate=u.endDate||""});function B(t){const r=new Date(i.startDate);r.setDate(r.getDate()+t),i.startDate=r.toISOString().split("T")[0];const g=new Date(i.endDate);g.setDate(g.getDate()+t),i.endDate=g.toISOString().split("T")[0]}return F(z,H,{deep:!0}),_({employees:w(()=>{var t;return((t=N.value)==null?void 0:t.employees)||[]})}),(t,r)=>(o(),d("div",nt,[e("div",st,[Se(t.$slots,"before",{},void 0,!0),e("button",{class:A(["btn-icon print-hide",{"animate-spin !bg-opacity-0":O.loading}]),onClick:r[0]||(r[0]=P(g=>U("reloadClick"),["prevent"])),disabled:O.loading,title:"Reload"},[e("i",{class:A(["fas fa-redo",[O.loading?"text-gray-400":"text-gray-500"]])},null,2)],10,at),e("span",rt,[Se(t.$slots,"after",{},void 0,!0)]),e("div",ot,[oe(Ye,{ref_key:"employeeFilterRef",ref:N,company_id:i.companyId,"onUpdate:company_id":r[1]||(r[1]=g=>i.companyId=g),department_id:i.departmentId,"onUpdate:department_id":r[2]||(r[2]=g=>i.departmentId=g),employee_id:i.employeeId,"onUpdate:employee_id":r[3]||(r[3]=g=>i.employeeId=g),line_type:i.lineType,"onUpdate:line_type":r[4]||(r[4]=g=>i.lineType=g),"with-type":!0,class:"flex-1 gap-y-4 md:flex items-center justify-between w-full md:w-auto"},null,8,["company_id","department_id","employee_id","line_type"]),e("div",dt,[e("button",{class:"btn-3 px-3 rounded size-7",onClick:r[5]||(r[5]=P(()=>B(-1),["prevent"]))},r[9]||(r[9]=[e("span",{class:"fas fa-arrow-left"},null,-1)])),e("div",lt,[r[10]||(r[10]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Start Date",-1)),$e(e("input",{type:"date","onUpdate:modelValue":r[6]||(r[6]=g=>i.startDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ce,i.startDate]])]),e("div",it,[r[11]||(r[11]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"End Date",-1)),$e(e("input",{type:"date","onUpdate:modelValue":r[7]||(r[7]=g=>i.endDate=g),class:"border-2 border-gray-300 rounded px-3 h-[32px] text-sm w-full bg-white"},null,512),[[Ce,i.endDate]])]),e("button",{class:"btn-3 px-3 rounded size-7",onClick:r[8]||(r[8]=P(()=>B(1),["prevent"]))},r[12]||(r[12]=[e("span",{class:"fas fa-arrow-right"},null,-1)]))])])])]))}},ut=Xe(pt,[["__scopeId","data-v-eac5851c"]]),mt={class:"container print:flex-grow mx-auto print:w-full print:px-0 print:py-0"},yt=["disabled"],ct={key:0,class:"bg-white border rounded-md mb-2 p-4 text-sm print:border-0 print:mb-2 print:px-0 print:w-full relative overflow-visible z-40"},gt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-7 gap-y-2 gap-x-6"},xt={class:"font-medium text-gray-800"},ft={class:"col-span-2"},bt={class:"font-medium text-gray-800"},vt={class:"inline-flex items-center gap-5 font-bold"},wt={class:"text-gray-700"},ht={key:0,class:"mt-2 w-[280px] sm:w-[320px] lg:w-[280px] xl:w-[320px] bg-white border border-gray-200 rounded-md p-3 shadow-lg text-left absolute right-0"},_t={class:"flex items-center justify-between mb-2"},Dt={class:"text-[11px] text-gray-500"},kt={class:"space-y-3 max-h-56 overflow-auto pr-1 z-50"},It={class:"pt-2 border-t border-dashed border-gray-200"},Tt={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1 flex items-center justify-between"},St={class:"flex items-center gap-2"},$t={key:0,class:"bg-red-500 rounded-md px-1.5 text-white text-center"},Ct={key:0,class:"flex flex-wrap gap-2"},Nt={key:0,class:"text-xs text-gray-400"},Rt=["title"],Et={class:"block max-w-[160px] truncate"},At={class:"text-[11px] text-gray-500 uppercase tracking-wide mb-1"},Lt={key:0,class:"bg-green-500 rounded-md px-1.5 text-white text-center"},jt={class:"flex flex-wrap gap-2"},Ot={key:0,class:"text-xs text-gray-400"},Ut=["title"],zt={class:"block max-w-[160px] truncate"},Bt={key:1,class:"text-center text-gray-500 py-12 border bg-gray-50 rounded-md"},Mt={key:3,class:"overflow-x-auto md:overflow-clip bg-white border border-t-0 rounded-md shadow-sm print:shadow-none print:rounded-none print:border-gray-400"},Vt={class:"min-w-full text-left text-sm border-separate border-spacing-0"},Ft={class:"bg-gray-50 text-gray-600 uppercase tracking-wide text-xs"},Pt={class:"border-y print:border-gray-400 sticky md:top-[123px] z-30 rounded-t-md"},Ht={class:"px-4 py-3 border md:w-[100px] print:w-auto print:border-l print:border-l-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center whitespace-nowrap"},Wt={class:"flex items-center justify-between gap-2"},Jt={class:"ml-1 text-[10px] text-gray-500"},Kt={key:0,class:"px-4 py-3 border bg-white bg-opacity-70 backdrop-blur-sm text-center"},Qt={class:"divide-y divide-gray-200"},Yt={key:0},Xt=["colspan"],Zt=["rowspan"],qt={class:"sticky top-[180px] bg-white text-center"},Gt=["rowspan"],en={class:"sticky top-[180px] bg-white flex"},tn={key:0,class:"text-xs text-gray-500"},nn=["colspan"],sn={key:0,class:"text-[11px] text-gray-500 mt-2"},an={key:0,class:"mt-2 grid grid-cols-2 md:grid-cols-5 gap-1.5"},rn={class:"gap-1 flex items-center justify-between rounded-full bg-indigo-50 border border-indigo-100 px-2 py-1.5"},on={class:"font-semibold text-indigo-700 text-xs whitespace-nowrap"},dn={class:"gap-1 flex items-center justify-between rounded-full bg-sky-50 border border-sky-100 px-2 py-1.5"},ln={class:"font-semibold text-sky-700 text-xs whitespace-nowrap"},pn={class:"gap-1 flex items-center justify-between rounded-full bg-amber-50 border border-amber-100 px-2 py-1.5"},un={class:"font-semibold text-amber-700 text-xs whitespace-nowrap"},mn={class:"gap-1 flex items-center justify-between rounded-full bg-emerald-50 border border-emerald-100 px-2 py-1.5"},yn={class:"font-semibold text-emerald-700 text-xs whitespace-nowrap"},cn={class:"text-center flex items-center justify-center rounded-full bg-slate-50 border border-slate-200 px-2 py-1.5 md:col-span-1 col-span-2"},gn={class:"font-semibold text-slate-800 text-xs text-right whitespace-nowrap"},xn={key:1,class:"mt-1 text-gray-500"},fn=["rowspan"],bn={class:"sticky top-[180px] bg-white"},vn={class:"px-4 py-3 text-gray-800 border-l border-t"},wn={class:"font-medium"},hn={class:"text-gray-400 mr-2"},_n={class:"text-xs text-gray-500"},Dn={class:"px-4 py-3 border-l border-t border-r text-center"},Un={__name:"TodoReportView",setup(O){var me,ye,ce,ge,xe,fe;const _=He(),X=We(),u=tt(),N=Ge(),U=et(),{companies:i}=Ne(N),{departments:z}=Ne(U),H=k(null),B=Ze(new Date),t=Ee({companyId:((me=_.query)==null?void 0:me.company_id)||"",departmentId:((ye=_.query)==null?void 0:ye.department_id)||"",employeeId:((ce=_.query)==null?void 0:ce.employee_id)||"",lineType:((ge=_.query)==null?void 0:ge.line_type)||"all",startDate:((xe=_.query)==null?void 0:xe.start_date)||B,endDate:((fe=_.query)==null?void 0:fe.end_date)||B}),r=w(()=>{var s;return[...((s=H.value)==null?void 0:s.employees)||[]].filter(n=>t.employeeId?String(n.id)===String(t.employeeId):!0).sort((n,l)=>{var y,c;return(((y=n.user)==null?void 0:y.name)||"").localeCompare(((c=l.user)==null?void 0:c.name)||"")}).map(n=>{const l=u.todo_dates.filter(a=>{var m;return String((m=a.user)==null?void 0:m.id)===String(n.id)}),y={};l.forEach(a=>{const m=a.date||"unknown-date";y[m]||(y[m]={date:m,todos:[]}),y[m].todos.push(a)});let c=Object.values(y).map(a=>({...a,rowSpan:a.todos.length})).sort((a,m)=>new Date(a.date)-new Date(m.date));c.length||(c=[{date:null,rowSpan:1,todos:[{id:`empty-${n.id}`,isPlaceholder:!0,title:""}]}]);const b=c.reduce((a,m)=>a+m.rowSpan,0);return{user:n,dates:c,rowSpan:Math.max(1,b)}})}),g=w(()=>{if(!t.startDate||!t.endDate)return"";const s=Y(t.startDate,{weekDay:"long"}),n=Y(t.endDate,{weekDay:"long"});return`${s} ~ ${n}`}),Ae=w(()=>N.employees||[]),Le={all:"All Types",executive:"Executive",support_staff:"Support Staff",doctor:"Doctor",academy_body:"Academy Body"},T=w(()=>{var c,b,a,m,S,$,C,x;const s=t.companyId&&((c=i.value)!=null&&c.length)?(b=i.value.find(v=>String(v.id)===String(t.companyId)))==null?void 0:b.name:null,n=t.departmentId&&((a=z.value)!=null&&a.length)?(m=z.value.find(v=>String(v.id)===String(t.departmentId)))==null?void 0:m.name:null;let l=null;t.employeeId&&(l=(($=(S=Ae.value)==null?void 0:S.find(v=>String(v.id)===String(t.employeeId)))==null?void 0:$.name)||((x=(C=r.value.find(v=>{var R;return String(((R=v.user)==null?void 0:R.id)||"")===String(t.employeeId)}))==null?void 0:C.user)==null?void 0:x.name)||null);const y=t.startDate===t.endDate&&t.startDate?Y(t.startDate,{weekDay:"long"}):g.value||"-";return{company:s||(t.companyId?`#${t.companyId}`:"All Companies"),department:n||(t.departmentId?`#${t.departmentId}`:"All Departments"),employee:l||(t.employeeId?`#${t.employeeId}`:"All Employees"),lineType:Le[t.lineType]||t.lineType||"All Types",dateRange:y}}),L=k(!1),Z=k(null),q=w(()=>{var s;return((s=r.value)==null?void 0:s.length)||0}),de=w(()=>{var s,n;return Math.max(0,q.value-(((n=(s=h.value)==null?void 0:s.withoutTodos)==null?void 0:n.length)||0))}),W=k(!0),G=k(!1),M=k(!1),ee=k(null),le=s=>{L.value&&Z.value&&(Z.value.contains(s.target)||(L.value=!1))},h=w(()=>{var s;return(s=r.value)!=null&&s.length?r.value.reduce((n,l,y)=>{var a,m,S,$,C,x;const c=l.dates.reduce((v,R)=>v+R.todos.filter(I=>!I.isPlaceholder).length,0),b={id:((a=l.user)==null?void 0:a.id)??((m=l.user)==null?void 0:m.user_id)??((S=l.user)==null?void 0:S.uid)??(($=l.user)==null?void 0:$.email)??`${((C=l.user)==null?void 0:C.name)||"unknown"}-${y}`,name:((x=l.user)==null?void 0:x.name)||"Unknown user"};return c>0?n.withTodos.push(b):n.withoutTodos.push(b),n},{withTodos:[],withoutTodos:[]}):{withTodos:[],withoutTodos:[]}}),ie=w(()=>{if(!M.value)return r.value;const s=new Set((h.value.withoutTodos||[]).map(n=>String(n.id??n.name??"")));return r.value.filter(n=>{var y,c,b,a,m;const l=((y=n.user)==null?void 0:y.id)??((c=n.user)==null?void 0:c.user_id)??((b=n.user)==null?void 0:b.uid)??((a=n.user)==null?void 0:a.email)??((m=n.user)==null?void 0:m.name)??"";return!s.has(String(l))})});function je(){M.value=!M.value,G.value=M.value}const pe=s=>{G.value&&ee.value&&(ee.value.contains(s.target)||(G.value=!1))},Oe=s=>s==="COMPLETED"?"bg-green-100 text-green-700 border border-green-200":s==="WORKING"?"bg-blue-100 text-blue-700 border border-blue-200":s==="PENDING"?"bg-yellow-100 text-yellow-700 border border-yellow-200":"bg-gray-100 text-gray-700 border border-gray-200";function Ue(){X.replace({query:{..._.query,company_id:t.companyId||void 0,department_id:t.departmentId||void 0,employee_id:t.employeeId||void 0,line_type:t.lineType||void 0,start_date:t.startDate||void 0,end_date:t.endDate||void 0}})}async function te(){!t.companyId||!t.startDate||!t.endDate||(await u.fetchTodoDates({"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate}),Ve())}function ze(s){t.companyId=s.companyId||"",t.departmentId=s.departmentId||"",t.employeeId=s.employeeId||"",t.lineType=s.lineType||"all",t.startDate=s.startDate||"",t.endDate=s.endDate||""}function Be(){window.print()}const J=w(()=>t.startDate===t.endDate);F(()=>t.companyId,s=>{s&&(U.fetchDepartments(s),N.fetchEmployee(s))},{immediate:!0}),F(()=>({...t}),(s,n)=>{JSON.stringify(s)!==JSON.stringify(n)&&(Ue(),te())},{deep:!0}),F(()=>_.query,s=>{t.companyId=(s==null?void 0:s.company_id)||t.companyId,t.departmentId=(s==null?void 0:s.department_id)||t.departmentId,t.employeeId=(s==null?void 0:s.employee_id)||t.employeeId,t.lineType=(s==null?void 0:s.line_type)||t.lineType,t.startDate=(s==null?void 0:s.start_date)||t.startDate,t.endDate=(s==null?void 0:s.end_date)||t.endDate}),ae(()=>{N.fetchCompanies({ignore_permission:!0}),te()}),ae(()=>{document.addEventListener("click",le,!0)}),Re(()=>{document.removeEventListener("click",le,!0)}),ae(()=>{document.addEventListener("click",pe,!0)}),Re(()=>{document.removeEventListener("click",pe,!0)});const Me=qe(),ue=k([]),ne=k(!1),se=w(()=>t.startDate===t.endDate),Ve=async()=>{if(!(!t.companyId||!t.startDate||!t.endDate||!se.value)){ne.value=!0;try{const s=await Me.getDateRangeAttendanceSummary(t.startDate,t.endDate,t.companyId,t.lineType,t.employeeId,!0);s&&(ue.value=s)}finally{ne.value=!1}}};function Fe(s,n){var y;const l=((y=ue.value)==null?void 0:y.find(c=>String(c.employee_id)===String(s)))||null;return l?!n&&se.value?(l==null?void 0:l.attendance[t.startDate])||null:(l==null?void 0:l.attendance[n])||null:null}function Pe(s,n){const l=Fe(s,n);return l?{hasData:!0,in:l.in||"-",out:l.out||"-",late:l.late||"-",early:l.early||"-",comment:l.comment||"-"}:{hasData:!1,in:"-",out:"-",late:"-",early:"-",comment:"-"}}return(s,n)=>{var l,y,c,b;return o(),d("div",mt,[oe(ut,{ref_key:"headingRef",ref:H,"company-id":t.companyId,"department-id":t.departmentId,"employee-id":t.employeeId,"line-type":t.lineType,"start-date":t.startDate,"end-date":t.endDate,loading:K(u).loading,class:"mb-4 print:px-0 print:py-0 print:mb-2 print:border-0 print:border-b print:border-gray-400 print:rounded-none print:w-full sticky top-[58px] z-50",onChange:ze,onReloadClick:te},{before:re(()=>n[3]||(n[3]=[e("div",null,[e("h1",{class:"text-xl font-semibold text-gray-800"},"Todo Report")],-1)])),after:re(()=>[e("button",{type:"button",class:"btn-icon print-hide disabled:opacity-35 cursor-pointer disabled:cursor-not-allowed",onClick:P(Be,["prevent"]),disabled:K(u).loading},n[4]||(n[4]=[e("i",{class:"fas fa-print"},null,-1)]),8,yt)]),_:1},8,["company-id","department-id","employee-id","line-type","start-date","end-date","loading"]),t.companyId&&t.startDate&&t.endDate?(o(),d("div",ct,[e("div",gt,[e("div",null,[n[5]||(n[5]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Company",-1)),e("div",xt,p(T.value.company),1)]),e("div",null,[n[6]||(n[6]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Department",-1)),e("div",{class:A(["font-medium",[T.value.department=="All Departments"?"text-gray-400":"text-gray-800"]])},p(T.value.department),3)]),e("div",null,[n[7]||(n[7]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Line Type",-1)),e("div",{class:A(["font-medium",[T.value.lineType=="All Types"?"text-gray-400":"text-gray-800"]])},p(T.value.lineType),3)]),e("div",null,[n[8]||(n[8]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Employee",-1)),e("div",{class:A(["font-medium",[T.value.employee=="All Employees"?"text-gray-400":"text-gray-800"]])},p(T.value.employee),3)]),e("div",ft,[n[9]||(n[9]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Date",-1)),e("div",bt,p(T.value.dateRange),1)]),e("div",{ref_key:"assignmentSummaryRef",ref:Z,class:"print-hide relative"},[e("button",{type:"button",class:"px-3 bg-white text-gray-700 hover:bg-gray-50 w-full text-bg text-right",onClick:n[0]||(n[0]=a=>L.value=!L.value)},[n[10]||(n[10]=e("div",{class:"uppercase"},"Todo given",-1)),e("div",vt,[e("div",wt,p(de.value)+" / "+p(q.value),1),e("i",{class:A(["fas",[L.value?"fa-chevron-up":"fa-chevron-down"]])},null,2)])]),L.value?(o(),d("div",ht,[e("div",_t,[n[11]||(n[11]=e("div",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Todo Status",-1)),e("div",Dt,p(de.value)+" given / "+p(q.value)+" selected ",1)]),e("div",kt,[e("div",It,[e("div",Tt,[e("div",St,[n[12]||(n[12]=e("span",null,"Not given todos",-1)),(l=h.value.withoutTodos)!=null&&l.length?(o(),d("span",$t,p((y=h.value.withoutTodos)==null?void 0:y.length),1)):f("",!0)]),e("button",{type:"button",class:"text-[10px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:n[1]||(n[1]=a=>W.value=!W.value)},p(W.value?"Hide":"Show"),1)]),W.value?(o(),d("div",Ct,[h.value.withoutTodos.length?f("",!0):(o(),d("span",Nt," Everyone has todos ")),(o(!0),d(D,null,j(h.value.withoutTodos,a=>(o(),d("span",{key:`without-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-red-50 text-red-700 border border-red-100 text-xs max-w-full",title:a.name},[n[13]||(n[13]=e("i",{class:"fas fa-exclamation-circle"},null,-1)),e("span",Et,p(a.name),1)],8,Rt))),128))])):f("",!0)]),e("div",null,[e("div",At,[n[14]||(n[14]=Q(" Given todos ")),(c=h.value.withTodos)!=null&&c.length?(o(),d("span",Lt,p((b=h.value.withTodos)==null?void 0:b.length),1)):f("",!0)]),e("div",jt,[h.value.withTodos.length?f("",!0):(o(),d("span",Ot," No todos assigned ")),(o(!0),d(D,null,j(h.value.withTodos,a=>(o(),d("span",{key:`with-${a.id}`,class:"inline-flex items-center gap-1 px-2 py-1 rounded-full bg-green-50 text-green-700 border border-green-100 text-xs max-w-full",title:a.name},[n[15]||(n[15]=e("i",{class:"fas fa-check-circle"},null,-1)),e("span",zt,p(a.name),1)],8,Ut))),128))])])])])):f("",!0)],512)])])):f("",!0),!t.companyId||!t.startDate||!t.endDate?(o(),d("div",Bt,n[16]||(n[16]=[e("p",{class:"text-red-500"},"Select company and date range to view the report.",-1)]))):K(u).loading?(o(),Je(Qe,{key:2},{default:re(()=>n[17]||(n[17]=[Q("Loading report...")])),_:1,__:[17]})):(o(),d("div",Mt,[e("table",Vt,[e("thead",Ft,[e("tr",Pt,[n[19]||(n[19]=e("th",{class:"px-4 py-3 border w-[10px] bg-white bg-opacity-70 backdrop-blur-sm rounded-tl-md print:rounded-tl-none text-center"}," sl ",-1)),e("th",Ht,[e("div",Wt,[n[18]||(n[18]=e("span",null,"Employee Name",-1)),t.employeeId?f("",!0):(o(),d("div",{key:0,class:"relative hidden md:block print:hidden",ref_key:"tableNoTodosRef",ref:ee},[e("button",{type:"button",class:"text-[11px] px-2 py-1 rounded border border-gray-200 text-gray-600 hover:bg-gray-50",onClick:n[2]||(n[2]=P(a=>je(),["stop"]))},[Q(" No Todos ("+p(h.value.withoutTodos.length)+") ",1),e("span",Jt,p(M.value?"Hidden":"Showing"),1)])],512))])]),J.value?f("",!0):(o(),d("th",Kt," Date ")),n[20]||(n[20]=e("th",{class:"px-4 py-3 border bg-white text-center"},"Todo",-1)),n[21]||(n[21]=e("th",{class:"px-4 py-3 border print:border-r print:border-gray-400 bg-white bg-opacity-70 backdrop-blur-sm text-center rounded-tr-md print:rounded-tr-none"}," Status ",-1))])]),e("tbody",Qt,[ie.value.length===0?(o(),d("tr",Yt,[e("td",{colspan:J.value?4:5,class:"px-4 py-6 text-center text-gray-500"},n[22]||(n[22]=[e("div",null,[e("i",{class:"fas fa-tasks fa-2x text-gray-300 mb-2"})],-1),e("div",null,"No todos.",-1)]),8,Xt)])):f("",!0),(o(!0),d(D,null,j(ie.value,(a,m)=>{var S,$,C;return o(),d(D,{key:((S=a.user)==null?void 0:S.id)||(((C=($=a.dates[0])==null?void 0:$.todos[0])==null?void 0:C.id)??Math.random())},[(o(!0),d(D,null,j(a.dates,(x,v)=>{var R;return o(),d(D,{key:`${((R=a.user)==null?void 0:R.id)||"u"}-${x.date}`},[(o(!0),d(D,null,j(x.todos,(I,V)=>{var be,ve,we,he,_e,De,ke,Ie,Te;return o(),d("tr",{key:I.id||`${((be=a.user)==null?void 0:be.id)||"u"}-${x.date||"empty"}-${V}`,class:"border odd:bg-white even:bg-gray-50 hover:bg-gray-100"},[v===0&&V===0?(o(),d("td",{key:0,rowspan:a.rowSpan||1,class:"px-4 py-3 align-top font-bold text-xl text-gray-800 whitespace-nowrap border-l border-t bg-white"},[e("div",qt,p(m+1),1)],8,Zt)):f("",!0),v===0&&V===0?(o(),d("td",{key:1,rowspan:a.rowSpan||1,class:"px-4 py-3 align-top font-medium text-gray-800 whitespace-nowrap border-l border-t bg-white"},[e("div",en,[oe(Ke,{size:"medium",user:a.user,class:"inline-block mr-2 align-middle"},null,8,["user"]),e("div",null,[e("div",null,p(((ve=a.user)==null?void 0:ve.name)||"Unknown user"),1),(he=(we=a.user)==null?void 0:we.department)!=null&&he.name?(o(),d("div",tn,p((De=(_e=a.user)==null?void 0:_e.department)==null?void 0:De.name),1)):f("",!0)])])],8,Gt)):f("",!0),I.isPlaceholder?(o(),d("td",{key:2,class:"border-l border-t border-r bg-white px-3 py-3 text-center",colspan:J.value?2:3},[n[28]||(n[28]=e("div",{class:"flex items-center justify-center gap-2 text-red-600 text-sm font-medium"},[e("i",{class:"far fa-clipboard-list text-red-400"}),e("span",null,"No todos assigned.")],-1)),se.value?(o(),d(D,{key:0},[ne.value?(o(),d("div",sn," Loading attendanceâ€¦ ")):(o(!0),d(D,{key:1},j([Pe((ke=a==null?void 0:a.user)==null?void 0:ke.id,x==null?void 0:x.date)],E=>(o(),d("div",{key:E.comment,class:"md:w-[360px] lg:w-[500px] mt-3 text-[11px] text-red-600 bg-gray-50 border border-dashed border-red-200 rounded-lg p-2.5 text-left inline-block min-w-[220px] align-top"},[n[27]||(n[27]=e("div",{class:"flex items-center gap-1.5 text-gray-700 font-semibold text-xs"},[e("i",{class:"far fa-user-clock text-indigo-500 text-sm"}),e("span",null,"Attendance")],-1)),E.hasData?(o(),d("div",an,[e("div",rn,[n[23]||(n[23]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"},"In",-1)),e("span",on,p(E.in),1)]),e("div",dn,[n[24]||(n[24]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"},"Out",-1)),e("span",ln,p(E.out),1)]),e("div",pn,[n[25]||(n[25]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"},"Late",-1)),e("span",un,p(E.late),1)]),e("div",mn,[n[26]||(n[26]=e("span",{class:"text-[10px] uppercase text-gray-500 tracking-wide"},"Early",-1)),e("span",yn,p(E.early),1)]),e("div",cn,[e("span",gn,p(E.comment),1)])])):(o(),d("div",xn," Attendance data unavailable. "))]))),128))],64)):f("",!0)],8,nn)):(o(),d(D,{key:3},[V===0&&!J.value?(o(),d("td",{key:0,rowspan:x.rowSpan||1,class:"px-4 py-3 align-top text-xs text-gray-700 whitespace-nowrap border-l border-t bg-white"},[e("div",bn,p(K(Y)(x.date)||x.date||"-"),1)],8,fn)):f("",!0),e("td",vn,[e("div",wn,[e("span",hn,p(V+1)+".",1),Q(" "+p(I.title),1)]),e("div",_n,p(((Ie=I.todoable)==null?void 0:Ie.title)||((Te=I.todoable_type)==null?void 0:Te.split("\\").pop())||""),1)]),e("td",Dn,[e("span",{class:A(["text-xs font-semibold px-2.5 py-1 rounded-full",Oe(I.status)])},p(I.status||"N/A"),3)])],64))])}),128))],64)}),128))],64)}),128))])])]))])}}};export{Un as default};
