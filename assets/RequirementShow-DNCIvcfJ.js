import{N as Se,r as x,e as ee,c as o,o as n,a as e,f as N,g as u,F as V,t as g,w as A,d as Ne,m as ne,n as Be,y as J,p as w,i as q,j as B,x as Q,k as Y,h as De,v as Ae,O as Ee,K as je,J as Le,b as Oe,u as Me,z as X}from"./index-N5qm6zD4.js";import{L as le}from"./LoaderView-lEtf3S4b.js";import{O as K}from"./OverlyModal-DB-Ehdxf.js";import{_ as Pe}from"./ShareComponent-DnFhWgRb.js";import{_ as Ie}from"./DepartmentChip-Bf4PVBBS.js";import{_ as Z}from"./DescriptionView-CV0UmMHX.js";import{o as Ue}from"./url-CePbr-gY.js";import{u as Fe}from"./user-BzCHCJVU.js";import{_ as Bs,a as Ve}from"./TaskUserAssignForm-DoP2Y_lc.js";import{f as ae,b as ze,s as He}from"./requirement-Xshz1jF2.js";import{u as Ge}from"./useTaskStore-CYtczNEl.js";import{_ as Qe}from"./TaskSelectionInput-B25pBhKc.js";import{_ as We}from"./TaskAddForm-0itBb99J.js";import{_ as Ke}from"./TaskEditForm-xvG8o1JJ.js";import{_ as Ye}from"./TaskTableRow-DxlYXpIx.js";import{T as se}from"./TextWithHr-_Gk50MHv.js";import{_ as ie}from"./UserChip-CCV4uuBL.js";import{d as re}from"./datetime-BEfC2TVK.js";import{_ as Je}from"./ApproveAndReject-UL8ma3HC.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TaskUrgencyInput-92XUDzgA.js";import"./DraggableList.vue_vue_type_script_setup_true_lang-DIdH_zMy.js";import"./SelectDropdown-DgVwy3fs.js";import"./TaskTitle-g-SwgjOa.js";import"./RequiredIcon-Ca6OFI22.js";import"./company-y43Ahk5c.js";import"./CompanyDepartmentSelectInput-PLO2PGWt.js";import"./SectionLoading-CG2LQp8q.js";import"./tags-BX3MaH7t.js";import"./MultiselectDropdown-RHvcA2sV.js";import"./MultiselectDropdown.vue_vue_type_style_index_0_lang-CeiS-Yqp.js";import"./TaskUrgentBadge-DrhYdntW.js";import"./TaskAssignedUsers-BHy0Zplh.js";import"./TaskIsClosedBadge-Durp9wMj.js";async function Xe(I,R,{params:a={}}={}){return Se.get(`/requirements/${I}/details/${R}`,{params:a})}async function Ze(I,R,{params:a={}}={}){const m=Ue(a);return Se.delete(`/requirements/${I}/details/${R}${m?"?"+m:""}`)}const et={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},tt={class:"mb-4"},st={class:"font-semibold"},rt={class:"mb-4"},nt={class:"line-clamp-2"},at={key:1,class:"min-h-40"},it={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},lt={key:0,class:"mb-4 text-red-500 font-medium"},ot={key:1,class:"mb-4"},dt={class:"flex items-center justify-between gap-4"},ut=["disabled"],mt={__name:"RequirementDetailDeleteForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["delete","closeClick","error"],setup(I,{emit:R}){const a=I,m=R,$=Fe(),p=x(null),d=x(""),s=x(),v=x([]);async function c(){var i,r;d.value="submitting";try{const l=await Ze(a.requirementId,a.detailId);m("delete",l),d.value="create"}catch(l){d.value="error",s.value=((r=(i=l.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update requirement detail: "+l,m("error",s.value)}}return ee(async()=>{var i,r,l;d.value="loading";try{v.value=await $.fetchDepartmentWiseEmployees(),p.value=(i=(await Xe(a.requirementId,a.detailId)).data)==null?void 0:i.detail}catch(y){s.value=((l=(r=y.response)==null?void 0:r.data)==null?void 0:l.message)||"Failed to fetch requirement detail"}finally{d.value=""}}),(i,r)=>{var l,y;return n(),o("div",et,[r[4]||(r[4]=e("div",{class:"sticky top-0 -mx-6 px-6 z-10 bg-gray-50"},[e("h2",{class:"text-xl font-semibold text-gray-800 py-2"},"Delete Requirement Details"),e("hr",{class:"mb-4 -mx-6"})],-1)),e("form",{onSubmit:A(c,["prevent"]),class:"z-0"},[d.value!=="loading"?(n(),o(V,{key:0},[e("div",tt,[r[1]||(r[1]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Title",-1)),e("div",st,g((l=p.value)==null?void 0:l.title),1)]),e("div",rt,[r[2]||(r[2]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),e("div",nt,g((y=p.value)==null?void 0:y.description),1)]),r[3]||(r[3]=e("div",{class:"my-8 text-center text-xl text-red-600"},"Are you sure want to delete?",-1))],64)):(n(),o("div",at)),e("div",it,[s.value?(n(),o("div",lt,g(s.value),1)):u("",!0),s.value?(n(),o("hr",ot)):u("",!0),e("div",dt,[e("button",{type:"button",onClick:r[0]||(r[0]=A(h=>m("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:d.value=="loading"||d.value=="submitting",type:"submit",class:"bg-red-700 hover:bg-red-500 text-white font-semibold px-5 py-2 rounded transition"},g(d.value=="submitting"?"Deleting...":"Delete"),9,ut)])])],32),d.value==="loading"||d.value==="submitting"?(n(),N(le,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):u("",!0)])}}};const pt={class:"sticky top-0 pt-4 bg-white z-10"},ct={class:"mb-4"},vt={class:"mb-4"},ft={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},bt={key:0,class:"mb-4 text-red-500 font-medium"},xt={key:1,class:"mb-4"},yt={class:"flex items-center justify-between gap-4"},gt=["disabled"],_t={__name:"RequirementFeedbackEditForm",props:{requirementId:{type:[Number,String],required:!0},requirementId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(I,{emit:R}){const a=I,m=R,$=x(),p=x(null),d=x(""),s=x(),v=x({feedback:""});async function c(){var i,r;d.value="submitting";try{const l=await ze(a.requirementId,v.value.feedback);m("update",l),d.value="create"}catch(l){d.value="error",s.value=((r=(i=l.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to update requirement requirement",m("error",s.value)}}return ee(async()=>{var i,r,l,y;d.value="loading";try{await ae(a.requirementId),p.value=(i=(await ae(a.requirementId)).data)==null?void 0:i.requirement,v.value={feedback:(r=p.value)==null?void 0:r.feedback}}catch(h){s.value=((y=(l=h.response)==null?void 0:l.data)==null?void 0:y.message)||"Failed to fetch requirement requirement"}finally{d.value=""}}),(i,r)=>{var l;return n(),o("div",{ref_key:"formContainerRef",ref:$,class:"max-h-[90vh] w-full mx-auto overflow-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},[e("div",pt,[r[3]||(r[3]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Requirement Feedback",-1)),r[4]||(r[4]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:r[0]||(r[0]=A(y=>m("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:A(c,["prevent"]),class:"z-0"},[d.value!=="loading"?(n(),o(V,{key:0},[e("div",ct,[r[5]||(r[5]=e("label",{class:"block text-gray-600 text-sm font-medium"},"Title ",-1)),w(Z,{"line-clamp":"1",className:{paragraph:"whitespace-pre-wrap text-justify ",button:"mt-0"}},{default:q(()=>{var y;return[B(g((y=p.value)==null?void 0:y.title),1)]}),_:1})]),e("div",vt,[r[6]||(r[6]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Feedback",-1)),De(e("textarea",{rows:"5","onUpdate:modelValue":r[1]||(r[1]=y=>v.value.feedback=y),placeholder:"Enter requirement feedback",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Ae,v.value.feedback]])])],64)):u("",!0),e("div",ft,[s.value?(n(),o("div",bt,g(s.value),1)):u("",!0),s.value?(n(),o("hr",xt)):u("",!0),e("div",yt,[e("button",{type:"button",onClick:r[2]||(r[2]=A(y=>m("closeClick"),["prevent"])),class:"btn-3"},"Cancel"),e("button",{disabled:d.value=="loading"||d.value=="submitting",type:"submit",class:"btn-2"},g(d.value=="submitting"?"Saving...":(l=p.value)!=null&&l.feedback?"Update Feedback":"Add Feedback"),9,gt)])])],32),d.value==="loading"||d.value==="submitting"?(n(),N(le,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):u("",!0)],512)}}},kt={class:"flex justify-center items-center"},wt={class:"modal-card"},ht=["required"],qt={class:"flex"},$t={class:"flex justify-between gap-2 mt-4"},Ct=["disabled"],Tt=["disabled"],It={__name:"RequirementSubmissionHandler",props:{requirementId:{type:[String,Number],required:!0}},emits:["loading","success","error"],setup(I,{emit:R}){const a=I,m=R,$=x(255),p=ne(()=>$.value-i.value.length),d=Ee(),s=x(null),v=x(null),c=x(null),i=x(""),r=x(!1),l=ne(()=>c.value!==null);function y(T){c.value=T,i.value="",D()}function h(){c.value=null,i.value=""}async function C(){var T,k;if(c.value==="reject"&&!i.value)return d.error("Rejection Reason is required!");if(typeof a.onSubmit=="function")return a.onSubmit({note:i.value,action:c.value});m("loading",!0),r.value=!0;try{await He(a.requirementId,{note:i.value}),m("success"),h()}catch(S){return m("error",S),d.error(((k=(T=S==null?void 0:S.response)==null?void 0:T.data)==null?void 0:k.message)||"Submission failed!")}finally{m("loading",!1),r.value=!1}}function L(T){var k,S;l.value&&(T.key==="ArrowLeft"?(k=v.value)==null||k.focus():T.key==="ArrowRight"&&((S=s.value)==null||S.focus()))}function D(){Le(()=>{var T;(T=s.value)==null||T.focus()})}return ee(()=>{window.addEventListener("keydown",L)}),je(()=>{window.removeEventListener("keydown",L)}),(T,k)=>(n(),o("div",null,[e("div",kt,[e("button",{onClick:k[0]||(k[0]=S=>y("accept"))},k[3]||(k[3]=[e("span",{class:"btn-2"},[e("span",{class:"fas fa-paper-plane"}),e("span",{class:"hidden md:inline"},"Submit Requirement")],-1)]))]),l.value?(n(),o("div",{key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50",onClick:A(h,["self"])},[e("div",wt,[k[4]||(k[4]=e("h3",{class:"title-lg"},"Requirement Submission",-1)),e("div",null,[De(e("textarea",{"onUpdate:modelValue":k[1]||(k[1]=S=>i.value=S),rows:"4",placeholder:"Note...",class:"w-full border rounded-lg p-2 text-gray-700",required:c.value==="reject",onInput:k[2]||(k[2]=S=>i.value.length>$.value?i.value=i.value.slice(0,$.value):null)},null,40,ht),[[Ae,i.value]]),e("div",qt,[e("div",{class:Q(["ml-auto inline-block text-sm text-gray-500",i.value.length>=$.value?"text-red-500":""])}," left "+g(p.value)+"/"+g($.value)+" words ",3)])]),e("div",$t,[e("button",{ref_key:"cancelBtnRef",ref:v,class:"btn-3 focus:ring-2 ring-offset-2 disabled:opacity-30",onClick:h,disabled:r.value}," Cancel ",8,Ct),e("button",{ref_key:"confirmBtnRef",ref:s,class:Q(["focus:ring-2 ring-offset-2 disabled:opacity-30",c.value==="reject"?"btn-2-red":"btn-2-green"]),onClick:C,disabled:r.value}," Confirm Submission ",10,Tt)])])])):u("",!0)]))}},Rt={class:"flex items-center gap-6 justify-center my-16"},St={key:0,class:"border rounded-md"},Nt={__name:"RequirementTaskCreateOrAssign",props:{fromDepartmentId:{type:Number},requirement:{type:Object}},emits:["addNewTaskClick","cancelClick","assignTask"],setup(I,{emit:R}){const a=I,m=R,$=Ge(),p=x(""),d=x(null),s=x(""),v=x(!1);async function c(){await $.setTaskRequirement(s.value,a.requirement.id),m("assignTask")}return(i,r)=>(n(),o("div",{class:Q(["text-left p-4",[p.value&&!d.value?"min-h-[400px]":""]])},[e("div",Rt,[e("button",{onClick:r[0]||(r[0]=A(l=>m("addNewTaskClick"),["prevent"])),class:"btn-3"},"Add New Task"),r[5]||(r[5]=e("span",null,"or",-1)),e("button",{class:Q({"btn-3":p.value!=="direct-assign","btn-2":p.value=="direct-assign"}),onClick:r[1]||(r[1]=A(()=>p.value="direct-assign",["prevent"]))}," Assign Task ",2)]),p.value&&!d.value?(n(),o("div",St,[e("form",{onSubmit:A(c,["prevent"]),class:"p-4 flex items-end"},[w(Qe,{class:"flex-grow mr-4 h-12",taskId:s.value,"onUpdate:taskId":r[2]||(r[2]=l=>s.value=l),show:v.value,"onUpdate:show":r[3]||(r[3]=l=>v.value=l),isOnlyMyTask:!1,taskQueryParams:{"from-department-id":I.fromDepartmentId},filterTasks:l=>!l.requirement_id,onAddNewTaskClick:r[4]||(r[4]=l=>m("addNewTaskClick")),showAddBtnIfNotFound:!0},null,8,["taskId","show","taskQueryParams","filterTasks"]),r[6]||(r[6]=e("div",{class:"flex justify-center"},[e("button",{class:"btn-2 h-12 rounded-md"},"Save")],-1))],32)])):u("",!0)],2))}},Dt={class:"flex flex-col items-center gax-x-1 justify-between"},At={key:0},jt={key:1},Lt={class:"text-base text-gray-900 font-semibold"},Bt={class:"ml-2"},Et={key:0,class:"text-green-600 ml-2"},Ot={key:1,class:"ml-2 text-yellow-700"},Re={__name:"RequirementApprovalItem",props:{requirement:{type:Object,required:!0},approvalType:{type:String,required:!0}},emits:["updateApproval"],setup(I,{emit:R}){const a=I,m=R,$=Ne(),p=ne(()=>{var l,y,h,C,L,D,T,k,S,f,z,H,_,t,j,E,O,M,P,U,F,W;let s=null,v=null,c=null,i="",r=!1;return a.approvalType==="from_in_charge"&&(s=(l=a.requirement)==null?void 0:l.from_department,v=(h=(y=a.requirement)==null?void 0:y.from_department)==null?void 0:h.in_charge,c=(L=(C=a.requirement)==null?void 0:C.from_department)==null?void 0:L.in_charge,i="In Charge",r=!!((D=a.requirement)!=null&&D.status&&((T=a.requirement)!=null&&T.submission_date))),a.approvalType==="from_coordinator"&&(s=(k=a.requirement)==null?void 0:k.from_department,v=(f=(S=a.requirement)==null?void 0:S.from_department)==null?void 0:f.coordinator,c=(z=a.requirement)==null?void 0:z.from_coordinator,r=!!((H=a.requirement)!=null&&H.from_coordinator),i="Coordinator"),a.approvalType==="to_in_charge"&&(s=(_=a.requirement)==null?void 0:_.to_department,v=(j=(t=a.requirement)==null?void 0:t.to_department)==null?void 0:j.in_charge,c=(E=a.requirement)==null?void 0:E.to_in_charge,r=!!((O=a.requirement)!=null&&O.to_incharge),i="In Charge"),a.approvalType==="to_coordinator"&&(s=(M=a.requirement)==null?void 0:M.to_department,v=(U=(P=a.requirement)==null?void 0:P.to_department)==null?void 0:U.coordinator,c=(F=a.requirement)==null?void 0:F.to_coordinator,r=!!((W=a.requirement)!=null&&W.to_coordinator),i="Coordinator"),{department:s,department_user:v,approval_user:c,userType:i,approved:r}});function d(){m("updateApproval")}return(s,v)=>{var c,i,r,l,y,h,C;return n(),o("div",Dt,[p.value.department_user?(n(),o("div",At,[w(ie,{user:p.value.department_user,"avatar-size":"xsmall"},null,8,["user"])])):(n(),o("div",jt,v[0]||(v[0]=[e("span",{class:"italic text-xs text-gray-400"},"N/A",-1)]))),v[2]||(v[2]=e("hr",{class:"my-2 border-gray-600 w-64"},null,-1)),e("div",Lt,[e("span",null,g(((c=p.value.department)==null?void 0:c.short_name)||((i=p.value.department)==null?void 0:i.name)),1),e("span",Bt,g(p.value.userType),1),p.value.department_user?(n(),o(V,{key:0},[p.value.approved?(n(),o("span",Et,"(âœ”)")):(n(),o("span",Ot,v[1]||(v[1]=[e("i",{class:"fad fa-spinner"},null,-1)])))],64)):u("",!0),((r=a.requirement)==null?void 0:r.status)!=="approved"&&p.value.department_user&&!p.value.approved&&((l=Y($).user)==null?void 0:l.id)==((h=(y=p.value)==null?void 0:y.department_user)==null?void 0:h.id)?(n(),N(Je,{key:1,class:"ml-auto z-[5000000]",notificationType:"pending-requirements",applicationId:(C=a.requirement)==null?void 0:C.id,onSuccess:d,variant:1},null,8,["applicationId"])):u("",!0)])])}}},Mt={class:"container mx-auto print:p-0 w-full print:max-w-full"},Pt={class:"print:shadow-none print:p-0 relative min-h-[50vh] mx-4"},Ut={key:0,class:"grid grid-cols-12 gap-x-4 gap-y-3"},Ft={class:"col-span-full md:col-span-8 xl:col-span-8 2xl:col-span-9 row-span-10 bg-white shadow rounded-lg p-6"},Vt={class:"text-center text-xl font-bold mb-2 flex items-center"},zt={class:"mb-8"},Ht={class:"text-lg font-semibold mb-2"},Gt={class:"flex gap-4 items-center text-gray-500"},Qt={class:"text-sm"},Wt={key:0,class:"flex items-center gap-1"},Kt={key:0,class:"mb-5"},Yt=["innerHTML"],Jt={class:"mb-8"},Xt={class:"w-full border rounded-lg border-gray-300 overflow-y-auto"},Zt={class:"w-full border-collapse"},es={key:0},ts={class:"mb-8"},ss={class:"p-3 border border-dashed rounded-lg border-sky-600",colspan:"5"},rs={class:"font-semibold text-gray-500 print:text-gray-800 text-sm mb-1"},ns={key:0},as=["innerHTML"];const is={key:1,class:"mt-8 border rounded-md p-8 flex items-start justify-between bg-gray-50 print:hidden"},ls={class:"flex flex-col items-end"},os={key:2,class:"mt-6 mb-8 break-before-avoid-page"},ds={class:"whitespace-nowrap border-gray-200 grid grid-cols-2 items-center"},us={key:0,class:"whitespace-nowrap border-gray-200 grid grid-cols-2 gap-2 items-center"},ms={class:"border col-span-3 p-3 rounded-md"},ps={class:"flex items-center gap-2 mb-4"},cs={class:"flex items-center gap-x-3 gap-y-2 flex-wrap"},vs={class:"flex items-center gap-2 mb-4"},fs={class:"mb-4 flex items-center justify-between gap-1 print:mb-1"},bs={class:"font-bold print:text-gray-900"},xs={key:0,class:"mb-3 flex items-start gap-3 print:mb-1"},ys={class:"flex items-center gap-2 print:text-gray-900 flex-wrap"},gs={key:1,class:"mb-3 flex items-center justify-between gap-3 print:mb-1"},_s={class:"print:text-gray-900"},ks={key:2,class:"mb-3 flex items-center justify-between gap-3 print:mb-1"},ws={class:"print:text-gray-900"},hs={class:"flex justify-between items-center mb-4"},qs={class:"mb-6"},$s={class:"flex justify-between items-center"},Cs={class:"print:hidden flex gap-2 items-center justify-between w-full text-sm"},or={__name:"RequirementShow",setup(I){const R=Oe(),a=Me(),m=x(""),$=Ne(),p=x(),d=x(),s=x(null),v=X({detail:null,open:!1}),c=X({detail:null,open:!1}),i=X({detail:null,open:!1}),r=x(!1),l=()=>r.value=!0,y=()=>r.value=!1,h=x(),C=x({isOpen:!1,taskId:null});ee(async()=>{await D(),window.addEventListener("beforeprint",l),window.addEventListener("afterprint",y),window.addEventListener("resize",L),await Le(),L()});function L(){var j;const _=p.value,t=(j=d.value)==null?void 0:j.$el;_&&t&&(_!=null&&_.offsetHeight)&&(t.style.top=`${(_==null?void 0:_.offsetHeight)+90}px`)}je(()=>{window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",y),window.removeEventListener("resize",L)});async function D(){var _;m.value="loading",s.value=(_=(await ae(R.params.id)).data)==null?void 0:_.requirement,m.value=""}function T(){var _,t,j,E,O,M,P,U,F;if($.user.role!=="super_admin"&&((_=$.user)==null?void 0:_.id)!==((j=(t=s.value)==null?void 0:t.to_department)==null?void 0:j.incharge_id))return alert(`You can't create or assign task for this requirement. 
Only ${(O=(E=s.value)==null?void 0:E.to_department)==null?void 0:O.name}'s In charge can create or assign.`);console.log({requirement:s}),f.modalShown=!0,f.from_department_id=s.value.from_department_id,f.to_department_id=s.value.to_department_id,f.taskDefaultValues={title:"",description:"",from_department_id:s.value.from_department_id,to_department_id:s.value.to_department_id,is_important:((M=s.value)==null?void 0:M.priority)=="IMPORTANT",is_urgent:((P=s.value)==null?void 0:P.priority)=="URGENT",supervisor_ids:(U=s.value)!=null&&U.supervisor_id?[(F=s.value)==null?void 0:F.supervisor_id]:[]},f.requirement=s.value}function k(_){v.open=!0,v.detail=_}function S(_){i.open=!0,i.detail=_}const f=X({modalShown:!1,requirementId:0,taskDefaultValues:{},requirement:null,creating:!1});async function z(){h.value=null,await D()}async function H(){f.modalShown=!1,f.requirement=null,f.creating=!1}return(_,t)=>{var E,O,M,P,U,F,W,oe,de,ue,me,pe,ce,ve,fe,be,xe,ye,ge,_e,ke,we,he,qe,$e,Ce,Te;const j=Be("RouterLink");return n(),o("div",Mt,[c.open?(n(),N(K,{key:0},{default:q(()=>{var b;return[w(_t,{requirementId:s.value.id,detailId:(b=c.requirement.value)==null?void 0:b.id,onCloseClick:t[0]||(t[0]=G=>c.open=!1),onUpdate:t[1]||(t[1]=async()=>{c.open=!1,await D()})},null,8,["requirementId","detailId"])]}),_:1})):u("",!0),i.open?(n(),N(K,{key:1},{default:q(()=>{var b;return[w(mt,{requirementId:s.value.id,detailId:(b=i.requirement.value)==null?void 0:b.id,onCloseClick:t[2]||(t[2]=G=>i.open=!1),onDelete:t[3]||(t[3]=async()=>{i.open=!1,await D()})},null,8,["requirementId","detailId"])]}),_:1})):u("",!0),f.modalShown?(n(),N(K,{key:2,class:"*:relative"},{default:q(()=>{var b,G;return[e("button",{onClick:A(H,["prevent"]),class:"absolute right-3 top-2 text-xl text-red-500 hover:text-red-400"},t[14]||(t[14]=[e("i",{class:"fas fa-times-circle"},null,-1)])),f!=null&&f.creating?u("",!0):(n(),N(Nt,{key:0,"from-department-id":(b=s.value)==null?void 0:b.from_department_id,requirement:f==null?void 0:f.requirement,onCancelClick:H,onAddNewTaskClick:t[4]||(t[4]=()=>{f.modalShown=!0,f.creating=!0}),onAssignTask:z},null,8,["from-department-id","requirement"])),f!=null&&f.creating?(n(),N(We,{key:1,requirementDetailId:(G=f==null?void 0:f.requirement.value)==null?void 0:G.id,requirementId:s.value.id,onClose:H,onTaskCreated:z,defaultValues:f.taskDefaultValues,readonlyFields:{from_department_id:!0,to_department_id:!0}},null,8,["requirementDetailId","requirementId","defaultValues"])):u("",!0)]}),_:1})):u("",!0),h.value?(n(),N(K,{key:3},{default:q(()=>[w(Ke,{taskId:h.value,onClose:t[5]||(t[5]=b=>h.value=null),onUpdated:z},null,8,["taskId"])]),_:1})):u("",!0),C.value.isOpen?(n(),N(K,{key:4,class:"*:max-w-4xl"},{default:q(()=>[w(Ve,{taskId:C.value.taskId,onCancelClick:t[6]||(t[6]=()=>{C.value.isOpen=!1,C.value.taskId=0}),onSuccess:t[7]||(t[7]=()=>{C.value.isOpen=!1,C.value.taskId=0,m.value="loading",D()})},null,8,["taskId"])]),_:1})):u("",!0),e("div",Pt,[s.value?(n(),o("div",Ut,[e("div",Ft,[e("div",Vt,[e("button",{class:"btn-3 h-8 px-4",onClick:t[8]||(t[8]=A(()=>Y(a).back(),["prevent"]))},"Back"),t[15]||(t[15]=e("div",{class:"text-2xl ml-4"},"Requirement Form",-1))]),t[30]||(t[30]=e("hr",{class:"mb-4"},null,-1)),e("div",null,[e("div",zt,[e("div",null,[e("div",Ht,[w(Z,{"line-clamp":"3",class:"mb-2"},{default:q(()=>[B(g(s.value.title),1)]),btnText:q(({lineClampClass:b})=>[B(g(b?"More":"Less"),1)]),_:1}),e("div",Gt,[e("div",Qt,[t[16]||(t[16]=e("span",{class:"fas fa-calendar text-sm text-gray-400"},null,-1)),B(" "+g(Y(re)(s.value.created_at)),1)]),s.value.created_by?(n(),o("div",Wt,[t[17]||(t[17]=e("span",{class:"text-gray-400 text-sm"},"By",-1)),w(ie,{"avatar-size":"xsmall",user:s.value.created_by,class:"border-sky-300"},null,8,["user"])])):u("",!0)])]),s.value.description?(n(),o("div",Kt,[t[18]||(t[18]=e("div",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Description",-1)),w(Z,{"line-clamp":4,"class-name":{button:"group-hover/item:underline"},class:"text-sm"},{default:q(()=>[e("p",{innerHTML:s.value.description,class:"text-justify"},null,8,Yt)]),_:1})])):u("",!0)])]),e("div",Jt,[w(se,{class:"mb-4"},{default:q(()=>t[19]||(t[19]=[e("h2",{class:"font-semibold text-lg px-2"},"Task List",-1)])),_:1,__:[19]}),e("div",Xt,[e("table",Zt,[t[21]||(t[21]=e("thead",null,[e("tr",null,[e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"SL"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Task"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Assigns"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400"},"Deadline"),e("th",{class:"border-x px-1 font-medium text-xs text-gray-400 sticky right-0 bg-gray-50"}," Status ")])],-1)),e("tbody",null,[m.value!="loading"&&((O=(E=s.value)==null?void 0:E.tasks)==null?void 0:O.length)===0?(n(),o("tr",es,t[20]||(t[20]=[e("td",{class:"py-4 px-3 border-t text-center text-gray-400 text-sm",colspan:"10"}," No Task ",-1)]))):(n(!0),o(V,{key:1},J(((M=s.value)==null?void 0:M.tasks)||[],(b,G)=>(n(),N(Ye,{key:b.id,task:b,indexing:G+1,class:"*:py-3 *:border-b-0",onEditClick:t[9]||(t[9]=te=>h.value=te),onEmployeeAssignClick:t[10]||(t[10]=te=>{C.value.isOpen=!0,C.value.taskId=te})},null,8,["task","indexing"]))),128))])])])]),e("div",ts,[w(se,{class:"mb-4"},{default:q(()=>t[22]||(t[22]=[e("h2",{class:"font-semibold text-lg px-2"},"Feedback",-1)])),_:1,__:[22]}),e("div",ss,[e("div",rs," '"+g(((U=(P=s.value)==null?void 0:P.to_department)==null?void 0:U.short_name)||((W=(F=s.value)==null?void 0:F.to_department)==null?void 0:W.name))+"' Feedback ",1),m.value!="loading"&&((oe=s.value)!=null&&oe.status)?(n(),o("div",ns,[(de=s.value)!=null&&de.feedback?(n(),N(Z,{key:0,lineClamp:"2",className:{button:"  underline"},class:"mb-4 print:mb-0"},{default:q(()=>{var b;return[e("p",{class:"text-sky-800 text-sm text-justify",innerHTML:(b=s.value)==null?void 0:b.feedback},null,8,as)]}),_:1})):u("",!0),e("div",null,[e("button",{class:"btn-3 print:hidden",onClick:t[11]||(t[11]=A(()=>{c.open=!0,c.requirement=s.value},["prevent"]))},g(s.value.feedback?"Update Feedback":"Add feedback"),1)])])):u("",!0)])]),(s.value,u("",!0)),m.value!="loading"&&!((ue=s.value)!=null&&ue.status)?(n(),o("div",is,[e("div",ls,[w(It,{"requirement-id":(me=s.value)==null?void 0:me.id,onSuccess:D},{heading:q(()=>t[26]||(t[26]=[B(" Requirement Submission ")])),acceptButtonLabel:q(()=>t[27]||(t[27]=[e("span",{class:"btn-2 pl-2 text-base"},[e("i",{class:"fad fa-paper-plane text-lg mr-2"}),B("Submit Requirement ")],-1)])),submitButtonLabel:q(()=>t[28]||(t[28]=[B(" Submit Requirement ")])),_:1},8,["requirement-id"])])])):u("",!0),(pe=s.value)!=null&&pe.status?(n(),o("div",os,[w(se,null,{default:q(()=>t[29]||(t[29]=[e("h2",{class:"font-semibold text-lg px-2"},"Approvals",-1)])),_:1,__:[29]}),e("div",ds,[(n(),o(V,null,J(["from_in_charge","from_coordinator"],b=>w(Re,{class:"pt-12",key:b,requirement:s.value,"approval-type":b,onUpdateApproval:t[12]||(t[12]=()=>D())},null,8,["requirement","approval-type"])),64))]),((ce=s.value)==null?void 0:ce.from_department_id)!==((ve=s.value)==null?void 0:ve.to_department_id)?(n(),o("div",us,[(n(),o(V,null,J(["to_in_charge","to_coordinator"],b=>w(Re,{class:"pt-12",key:b,requirement:s.value,"approval-type":b,onUpdateApproval:t[13]||(t[13]=()=>D())},null,8,["requirement","approval-type"])),64))])):u("",!0)])):u("",!0)])]),e("div",{class:"col-span-full md:col-span-4 xl:col-span-4 2xl:col-span-3 space-y-4 sticky top-[74px] bg-white shadow rounded-lg p-4 break-before-avoid-page",ref_key:"sidebarTop",ref:p},[e("div",ms,[e("div",null,[e("div",ps,[t[31]||(t[31]=e("div",{class:"text-gray-500 text-sm"},"From",-1)),w(Ie,{department:(fe=s.value)==null?void 0:fe.from_department,"short-name":!0},null,8,["department"])]),t[32]||(t[32]=e("div",{class:"text-gray-600 text-sm mb-2 border-b border-dashed"},"Supervisor",-1)),e("div",cs,[(be=s.value)!=null&&be.supervisor?(n(),N(ie,{key:0,user:(xe=s.value)==null?void 0:xe.supervisor},null,8,["user"])):u("",!0)])]),t[34]||(t[34]=e("hr",{class:"my-4"},null,-1)),e("div",null,[e("div",vs,[t[33]||(t[33]=e("div",{class:"text-gray-500 text-sm"},"To",-1)),w(Ie,{department:(ye=s.value)==null?void 0:ye.to_department,"short-name":!0},null,8,["department"])])])]),e("div",fs,[t[35]||(t[35]=e("div",{class:"text-gray-500 text-sm"},"Requirement ID:",-1)),e("div",bs,g((ge=s.value)==null?void 0:ge.id),1)]),((ke=(_e=s.value)==null?void 0:_e.website_tags)==null?void 0:ke.length)>0?(n(),o("div",xs,[t[36]||(t[36]=e("div",{class:"text-gray-500 text-sm"},"Website",-1)),e("div",ys,[(n(!0),o(V,null,J(((we=s.value)==null?void 0:we.website_tags)||[],b=>(n(),o("div",{key:b.id,class:"border px-1 rounded-md bg-sky-100 border-sky-400 text-sky-700 whitespace-nowrap text-xs"},g(b.name),1))),128))])])):u("",!0),(he=s.value)!=null&&he.submission_date?(n(),o("div",gs,[t[37]||(t[37]=e("div",{class:"text-gray-500 text-sm"},"Submission Date",-1)),e("div",_s,g(Y(re)((qe=s.value)==null?void 0:qe.submission_date)),1)])):u("",!0),($e=s.value)!=null&&$e.better_to_complete_on?(n(),o("div",ks,[t[38]||(t[38]=e("div",{class:"text-gray-500 text-sm"},"Better To Complete",-1)),e("div",ws,g(Y(re)((Ce=s.value)==null?void 0:Ce.better_to_complete_on)),1)])):u("",!0),e("div",null,[e("div",hs,[t[39]||(t[39]=e("span",{class:"text-gray-500 text-sm"},"Priority:",-1)),e("div",null,[e("span",{class:Q(["font-semibold text-sm",{"text-yellow-600 ":s.value.priority=="IMPORTANT","text-red-700 ":s.value.priority=="URGENT"}])},g(s.value.priority||"NORMAL"),3)])]),e("div",qs,[e("div",$s,[t[40]||(t[40]=e("span",{class:"text-gray-500 text-sm"},"Status:",-1)),e("span",{class:Q(["border rounded-lg px-2 text-sm py-0.5",{"bg-red-300 text-red-700 border-red-400":s.value.status!="approved","bg-green-300 text-green-700 border-green-400":s.value.status=="approved"}])},g(String(s.value.status).toUpperCase()),3)])]),t[43]||(t[43]=e("hr",{class:"mb-3"},null,-1)),e("div",Cs,[e("button",{class:"btn-3 font-semibold h-8 !pl-2 !pr-4",onClick:A(T,["prevent"])},t[41]||(t[41]=[e("i",{class:"fas fa-plus text-sm"},null,-1),B(" Add/Assign Task ")])),w(j,{class:"btn-2 h-8",to:`/requirements/edit/${(Te=s.value)==null?void 0:Te.id}`},{default:q(()=>t[42]||(t[42]=[B(" Edit ")])),_:1,__:[42]},8,["to"])])])],512),w(Pe,{class:"col-span-full md:col-span-4 xl:col-span-4 2xl:col-span-3 md:sticky",ref_key:"shareComponent",ref:d},null,512)])):u("",!0),m.value==="loading"?(n(),N(le,{key:1,class:"absolute inset-0 bg-opacity-90"})):u("",!0)])])}}};export{or as default};
