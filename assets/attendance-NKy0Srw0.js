import{Q as D,r as g,R as y}from"./index-D7bpHmyD.js";const j=D("attendance",()=>{const p=g([]),w=g([]),v=g([]),f=g([]),h=g([]),b=g(null),R=g(null),S=g(new Date().toISOString().substring(0,7)),L=g(new Date().toISOString().substring(0,10)),n=g(null),d=g(!1);return{monthlyLogs:p,dailyLateLogs:f,monthlyLateLogs:h,summary:b,monthly_company_summary:R,selectedMonth:S,selectedDate:L,error:n,isLoading:d,dailyLogs:v,attendanceLogs:w,getMonthlyAttendanceByShift:async(l,s)=>{var e,t;if(!l||!s){n.value="Invalid user ID or month";return}d.value=!0;try{const a=await y.get(`/user/${l}/attendance/monthly/${s}`);p.value=a.data.monthly_logs,b.value=a.data.summary,n.value=null}catch(a){n.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},getTodayAttendanceReport:async(l,s,e,t,a,r)=>{var o,c;d.value=!0;try{const u={companyId:l,departmentId:s,employee_id:e,category:t,month:a,status:r},i=await y.get("/attendance/today",{params:u});v.value=i.data,n.value=null}catch(u){n.value=((c=(o=u.response)==null?void 0:o.data)==null?void 0:c.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},getAttendanceLateReport:async(l,s,e,t)=>{var a,r;d.value=!0;try{const o={company_id:l,employee_id:s,type:t,...t==="daily"?{date:e}:{month:e}},c=await y.get("/monthly/attendance/late-reports",{params:o});t==="daily"?f.value=c.data:t==="monthly"&&(h.value=c.data),n.value=null}catch(o){n.value=((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},getMonthlyAttendanceSummaryReport:async(l,s,e,t)=>{var a,r;if(!l||!t){n.value="Invalid user ID or month";return}d.value=!0;try{const o={company_id:l,employee_id:s,category:e,month:t},c=await y.get("/attendance/monthly-summary-reports",{params:o});R.value=c.data,n.value=null}catch(o){n.value=((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},downloadExcel:async(l,s,e)=>{var t,a;if(!l||!e){n.value="Invalid company ID or month";return}d.value=!0;try{const r={company_id:l,category:s,month:e},o=await y.get("/attendance/monthly-summary-reports?flag=excel",{params:r,responseType:"blob"}),c=window.URL.createObjectURL(new Blob([o.data])),u=document.createElement("a");u.href=c,u.setAttribute("download",`${e} attendance_summary.xlsx`),document.body.appendChild(u),u.click(),document.body.removeChild(u)}catch(r){n.value=((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},downloadPDF:async(l,s,e,t=0)=>{var a,r;if(!l||!e){n.value="Invalid user ID or month";return}d.value=!0;try{const o={company_id:l,category:s,month:e},c=await y.get("/attendance/monthly-summary-reports?flag=pdf",{params:o,responseType:"blob"}),u=window.URL.createObjectURL(new Blob([c.data])),i=document.createElement("a");i.href=u,i.setAttribute("download",`${e} attendance_summary.pdf`),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(o){n.value=((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},attendanceDownloadExcel:async(l,s,e,t,a)=>{var r,o;d.value=!0;try{const c={companyId:l,employee_id:s,category:e,month:t,status:a},u=await y.get("/attendance/today?flag=excel",{params:c,responseType:"blob"}),i=window.URL.createObjectURL(new Blob([u.data])),m=document.createElement("a");m.href=i,m.setAttribute("download",`${t} attendance_summary.xlsx`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(c){n.value=((o=(r=c.response)==null?void 0:r.data)==null?void 0:o.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},attendanceDownloadPdf:async(l,s,e,t,a)=>{var r,o;d.value=!0;try{const c={companyId:l,employee_id:s,category:e,month:t,status:a},u=await y.get("/attendance/today?flag=pdf",{params:c,responseType:"blob"}),i=window.URL.createObjectURL(new Blob([u.data])),m=document.createElement("a");m.href=i,m.setAttribute("download",`${t} attendance_summary.pdf`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(c){n.value=((o=(r=c.response)==null?void 0:r.data)==null?void 0:o.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},lateReportDownloadExcel:async(l,s,e,t)=>{var a,r;if(!l){n.value="Invalid company ID or date/month";return}d.value=!0;try{const o={company_id:l,...s?{employee_id:s}:{},type:t,...t==="daily"?{date:e}:{month:e}},c=await y.get("/monthly/attendance/late-reports?flag=excel",{params:o,responseType:"blob"}),u=window.URL.createObjectURL(new Blob([c.data])),i=document.createElement("a");i.href=u;const m=`${e}-late-attendance.xlsx`;i.setAttribute("download",m),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(o){n.value=((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},getMonthlyAttendanceLog:async(l,s)=>{var e,t;if(!l||!s){n.value="Invalid user ID or month";return}d.value=!0;try{const a=await y.get(`/user/${l}/attendance/monthly/${s}/log`);w.value=a.data.attendance_logs}catch(a){n.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong",console.error(n.value)}finally{d.value=!1}},getDateRangeAttendanceSummary:async(l,s,e,t)=>{var a,r;if(!e||!l||!s){n.value="Company, Start Date, and End Date are required";return}d.value=!0;try{return(await y.get("/attendance/date-range-summary",{params:{company_id:e,start_date:l,end_date:s,employee_id:t||void 0}})).data}catch(o){return n.value=((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.message)||"Something went wrong",console.error(n.value),null}finally{d.value=!1}},downloadDateRangeExcel:async(l,s,e,t=null,a="")=>{var u;if(!e||!l||!s){n.value="Company, Start Date, and End Date are required";return}const r=(u=y.defaults.baseURL)==null?void 0:u.replace(/\/$/,"");let o=`flag=excel&company_id=${e}&start_date=${l}&end_date=${s}`;t&&(o+=`&employee_id=${t}`),a&&(o+=`&category=${a}`);const c=`${r}/attendance/date-range-summary?${o}`;console.log("📁 Opening Excel Download URL:",c),window.open(c,"_blank")},downloadDateRangePdf:(l,s,e,t=null,a="")=>{if(!e||!l||!s){n.value="Company, Start Date, and End Date are required";return}const r=new URLSearchParams({flag:"pdf",company_id:e,start_date:l,end_date:s});t&&r.append("employee_id",t),a&&r.append("category",a);const o=`/attendance/date-range-summary?${r.toString()}`;window.open(o,"_blank")}}});export{j as u};
