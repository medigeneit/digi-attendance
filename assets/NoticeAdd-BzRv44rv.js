import{i as D,s as U,z as k,b as C,q as F,c as d,a as l,w as T,d as r,A as v,F as c,x as g,h as y,v as p,l as x,m as L,n as M,o as n,t as w,k as R,g as A}from"./index-b79Cgc5B.js";import{_ as B}from"./TextEditor-x1ObDar5.js";import{u as q}from"./company-CuMCqlgp.js";import{u as E}from"./department-B1EHRKjk.js";import{u as j}from"./notice-QunsnQJP.js";const z={class:"my-container space-y-2"},P={class:"card-bg md:p-8 p-4 mx-4"},$={class:"grid gap-4"},G={class:"border p-4 rounded-md bg-gray-100"},H={class:"grid md:grid-cols-2 gap-4"},I=["value"],J=["value"],K={class:"col-span-full"},O={class:"flex justify-center gap-4"},ee={__name:"NoticeAdd",setup(Q){const f=D(),_=A(),a=j(),m=q(),b=E(),{companies:S}=U(m),s=k({title:"",description:"",published_at:"",expired_at:"",company_id:"",department_id:"",file:""});C(async()=>{await m.fetchCompanies()}),F(()=>s.company_id,async o=>{o&&(await b.fetchDepartments(o),s.department_id="")});const N=async o=>{var i;const e=o.target.files[0];if(e){const t=new FormData;t.append("file",e),console.log({file:e});const u=await a.fetchFileUpload(t);s.file=(i=u==null?void 0:u.data)==null?void 0:i.url}},V=async()=>{var o,e;try{const i={title:s.title,description:s.description,published_at:s.published_at,expired_at:s.expired_at,company_id:s.company_id,department_id:s.department_id,file:s.file};await a.createNotice(i),f.success("Notice created successfully"),await a.fetchNotices(),_.replace("/hrd/notice")}catch(i){const t=((e=(o=i.response)==null?void 0:o.data)==null?void 0:e.message)||"Failed to save user";f.error(t),console.error(t)}};return(o,e)=>{const i=M("RouterLink");return n(),d("div",z,[l("div",P,[e[19]||(e[19]=l("h2",{class:"title-lg text-center"},"Add Notice",-1)),l("form",{onSubmit:T(V,["prevent"]),class:"space-y-4"},[l("div",$,[l("div",G,[e[15]||(e[15]=l("p",{class:"title-md"},"Notice Info",-1)),e[16]||(e[16]=l("hr",{class:"my-2"},null,-1)),l("div",H,[l("div",null,[e[7]||(e[7]=l("label",null,"Company *",-1)),r(l("select",{id:"company_id","onUpdate:modelValue":e[0]||(e[0]=t=>s.company_id=t),class:"w-full border rounded px-3 py-2",required:""},[e[6]||(e[6]=l("option",{value:"",disabled:""},"Select a company",-1)),(n(!0),d(c,null,g(y(S),t=>(n(),d("option",{key:t==null?void 0:t.id,value:t==null?void 0:t.id},w(t==null?void 0:t.name),9,I))),128))],512),[[v,s.company_id]])]),l("div",null,[e[9]||(e[9]=l("label",null,"Department",-1)),r(l("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.department_id=t),class:"w-full p-2 border rounded"},[e[8]||(e[8]=l("option",{value:"",disabled:""},"Select a department",-1)),(n(!0),d(c,null,g(y(b).departments,t=>(n(),d("option",{key:t==null?void 0:t.id,value:t==null?void 0:t.id},w(t==null?void 0:t.name),9,J))),128))],512),[[v,s.department_id]])]),l("div",null,[e[10]||(e[10]=l("label",null,"Publish Date*",-1)),r(l("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.published_at=t),type:"date",class:"w-full p-2 border rounded"},null,512),[[p,s.published_at]])]),l("div",null,[e[11]||(e[11]=l("label",null,"Expired Date*",-1)),r(l("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.expired_at=t),type:"date",class:"w-full p-2 border rounded"},null,512),[[p,s.expired_at]])]),l("div",null,[e[12]||(e[12]=l("label",null,"Title*",-1)),r(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.title=t),type:"text",class:"w-full p-2 border rounded"},null,512),[[p,s.title]])]),l("div",null,[e[13]||(e[13]=l("label",null,"File",-1)),l("input",{onChange:N,type:"file",class:"w-full p-2 border rounded"},null,32)]),l("div",K,[e[14]||(e[14]=l("label",null,"Description",-1)),x(B,{modelValue:s.description,"onUpdate:modelValue":e[5]||(e[5]=t=>s.description=t),cols:"30",rows:"10",class:"w-full"},null,8,["modelValue"])])])])]),l("div",O,[x(i,{to:{name:"UserList"},type:"button",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:L(()=>e[17]||(e[17]=[R(" Cancel ")])),_:1}),e[18]||(e[18]=l("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"}," Save ",-1))])],32)])])}}};export{ee as default};
