import{L as Z}from"./LoaderView-DakX_HNW.js";import{d as Q,b as W,p as g,r as q,e as X,q as $,c as o,o as a,a as e,y as h,f as b,g as S,i as v,t as u,k as d,h as tt,v as et,u as st,C as at,j as M,F as ot,x as lt,n as J}from"./index-BUC_hShk.js";import{g as nt}from"./task-BNsB4R8Q.js";import{u as it}from"./company-DWe6IFiQ.js";import{_ as K}from"./CompanyDepartmentSelectInput-lVvhdrmO.js";import{_ as dt}from"./EmployeeDropdownInput-DPJN17Sz.js";import{S as rt}from"./SelectDropdown-Dvk9VgOo.js";import{_ as T}from"./UserChip-DsMc6QxM.js";import{u as mt}from"./useRequirementStore-Bse7KIF9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./url-CePbr-gY.js";import"./requirement-I4QmFilJ.js";const ut={class:"mb-3 task-header"},pt={class:"flex flex-wrap items-center justify-center gap-2 mt-3"},ct={class:"flex flex-wrap gap-x-4 gap-y-3 justify-between"},xt={class:"relative"},yt=["title"],_t={key:0},ft={key:1,class:"text-gray-500 whitespace-nowrap"},gt={key:1,class:"relative w-full md:w-56 lg:flex-grow"},bt={class:"text-gray-600 w-full md:w-32 relative"},ht={__name:"RequirementHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(z,{emit:p}){const f=z,C=Q(),L=W(),r=g(c("company-id")),R=g(c("from-department-id")),m=g(c("to-department-id")),s=g(c("created-by")),w=g(c("month")),D=p,t=it(),N=q([]);function c(i){return{get:()=>f.modelValue[i]||"",set:l=>{D("update:modelValue",{...f.modelValue,[i]:l||void 0})}}}async function k(){var i,l,x;if(!f.isMyTask){const y=(i=f.modelValue)==null?void 0:i["company-id"],_=m.value,n={...y?{company_id:y}:{},..._?{department_ids:[_]}:{}};N.value=((x=(l=await nt({params:n}))==null?void 0:l.data)==null?void 0:x.employees)||[]}}X(async()=>{await t.fetchCompanies({with:"departments",ignore_permission:!0}),await t.fetchMyCompanies({with:"departments"}),await k()}),$(()=>m.value,k),$(()=>r.value,()=>{R.value="",m.value="",s.value="",k()});const A=g(()=>r.value?t==null?void 0:t.companies.filter(i=>i.id==r.value):t==null?void 0:t.companies);return(i,l)=>{var x,y,_;return a(),o("div",null,[e("div",ut,[e("div",pt,[e("div",ct,[e("div",xt,[h(rt,{modelValue:r.value,"onUpdate:modelValue":l[0]||(l[0]=n=>r.value=n),options:((x=d(t))==null?void 0:x.companies)||[],label:"name",id:"id",class:"border-2 border-gray-300 rounded h-[40px] w-full md:w-48 bg-white text-sm",clearable:""},{"selected-option":v(({option:n})=>[e("div",{class:"line-clamp-1 text-sm text-gray-900",title:n==null?void 0:n.name},[n!=null&&n.name?(a(),o("span",_t,u(n==null?void 0:n.name),1)):(a(),o("span",ft,"--ALL COMPANY--"))],8,yt)]),_:1},8,["modelValue","options"]),l[5]||(l[5]=e("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Company ",-1))]),h(K,{modelValue:R.value,"onUpdate:modelValue":l[1]||(l[1]=n=>R.value=n),companies:A.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:v(()=>l[6]||(l[6]=[e("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),d(L).name!=="MyTaskList"?(a(),b(K,{key:0,modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=n=>m.value=n),companies:A.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:v(()=>l[7]||(l[7]=[e("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):S("",!0),d(C).isAdminMood&&((_=(y=d(C))==null?void 0:y.user)==null?void 0:_.role)!=="employee"?(a(),o("div",gt,[h(dt,{employees:N.value,modelValue:s.value,"onUpdate:modelValue":l[3]||(l[3]=n=>s.value=n),class:"border-2 border-gray-300 rounded h-[40px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),l[8]||(l[8]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Created By ",-1))])):S("",!0),e("div",bt,[l[9]||(l[9]=e("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),tt(e("input",{id:"month-filter","onUpdate:modelValue":l[4]||(l[4]=n=>w.value=n),type:"month",class:"h-10 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[et,w.value]])])])])])])}}},vt={class:"container mx-auto p-6"},wt={class:"bg-white shadow-md rounded-lg p-4"},kt={key:1,class:"text-center py-4 text-red-500"},Vt={key:2,class:"overflow-x-auto border-x xl:border-x-0"},Rt={class:"min-w-full bg-white border overflow-hidden table table-fixed"},At={key:0},Tt={class:"px-4 py-4 font-semibold text-xl text-gray-700 border border-gray-200 text-center"},Ct={class:"px-4 py-4 min-w-[300px] md:min-w-[400px] border border-gray-200"},Lt={class:"flex flex-col lg:flex-row items-start lg:items-center lg:flex-wrap gap-2 text-sm mb-3"},Dt=["title"],Nt=["title"],St={class:"space-y-4"},Mt={key:0,class:"text-blue-800"},$t=["title"],zt={key:1,class:"text-gray-400 text-sm italic"},Et={key:0},Bt={key:1,class:""},Ft={class:"flex gap-2 items-center mt-4"},Ut={key:0,class:"text-gray-600 text-xs flex items-center gap-2"},jt={class:"flex items-center gap-2"},Pt={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},It={class:"flex items-center gap-2 mt-2"},Ot={key:1},Ht={key:0},Gt={key:1,class:"italic text-xs text-gray-400"},Yt={class:"flex items-center gap-2 mt-2"},Jt={key:1},Kt={key:0},Qt={key:1,class:"italic text-xs text-gray-400"},Wt={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},Xt={class:"flex items-center gap-2 mt-2"},Zt={key:1},qt={key:0},te={key:1,class:"italic text-xs text-gray-400"},ee={class:"flex items-center gap-2 mt-2"},se={key:1},ae={key:0},oe={key:1,class:"italic text-xs text-gray-400"},le={class:"px-4 py-4 text-center whitespace-nowrap border border-gray-200"},ne={key:0,class:"text-gray-600"},ie={key:1},de={class:"px-4 py-4 text-center border border-gray-200"},re={class:"flex gap-4 items-center justify-center"},we={__name:"RequirementList",setup(z){const p=mt(),f=st(),C=W(),L=Q(),r=g({get(){return{...C.query}},set(m){f.push({query:{...m}})}});X(()=>{console.log("Requirement List Mounted"),p.fetchRequirements(r.value)}),$(()=>({...r.value}),async function(m){p.fetchRequirements(m)});const R=()=>{f.push({name:"RequirementAdd"})};return(m,s)=>{var D;const w=at("RouterLink");return a(),o("div",vt,[e("div",{class:"flex justify-between items-center mb-6"},[s[3]||(s[3]=e("h2",{class:"text-2xl font-bold text-gray-800"},"Requirements",-1)),e("button",{onClick:R,class:"btn-1"},"Add Requirement")]),e("div",wt,[h(ht,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=t=>r.value=t),class:"mt-2 mb-6"},null,8,["modelValue"]),d(p).loading?(a(),b(Z,{key:0,class:"sm:min-h-64 lg:min-h-96 shadow-none flex items-center justify-center"},{default:v(()=>s[4]||(s[4]=[M(" Loading requirements... ")])),_:1,__:[4]})):d(p).error?(a(),o("div",kt,u(d(p).error),1)):(a(),o("div",Vt,[e("table",Rt,[s[16]||(s[16]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"px-4 py-2 text-center whitespace-nowrap border w-[4%]"},"#"),e("th",{class:"px-4 py-2 text-left whitespace-nowrap border w-[60%]"},"Requirement"),e("th",{class:"px-4 py-2 text-center whitespace-nowrap w-[12%] border"},"From"),e("th",{class:"px-4 py-2 text-center whitespace-nowrap w-[12%] border"},"To"),e("th",{class:"px-4 py-2 text-center whitespace-nowrap w-[12%] border"},"Submitted At"),e("th",{class:"px-4 py-2 text-center whitespace-nowrap w-[12%] border"},"Actions")])],-1)),e("tbody",null,[((D=d(p).requirements)==null?void 0:D.length)===0?(a(),o("tr",At,s[5]||(s[5]=[e("td",{colspan:"10",class:"p-4"},[e("div",{class:"text-gray-500 italic w-full h-64 flex items-center justify-center"}," No Requirement Found ")],-1)]))):(a(!0),o(ot,{key:1},lt(d(p).requirements,(t,N)=>{var c,k,A,i,l,x,y,_,n,E,B,F,U,j,P,I,O,H,G;return a(),o("tr",{key:t.id,class:"border-t hover:bg-blue-50 odd:bg-gray-50 group/item"},[e("td",Tt,u(N+1),1),e("td",Ct,[e("div",Lt,[s[6]||(s[6]=e("span",{class:"text-gray-400"},"From ",-1)),e("span",{title:(c=t==null?void 0:t.from_department)==null?void 0:c.name,class:J([{"bg-green-500 text-white group-hover/item:text-white":((k=t==null?void 0:t.from_department)==null?void 0:k.id)==((i=(A=d(L))==null?void 0:A.user)==null?void 0:i.department_id)},"text-blue-500 font-semibold flex-shrink-0 border border-blue-500 bg-blue-50 rounded-full px-2 text-xs"])},u(((l=t==null?void 0:t.from_department)==null?void 0:l.short_name)||((x=t==null?void 0:t.from_department)==null?void 0:x.name)),11,Dt),s[7]||(s[7]=e("span",{class:"text-gray-400"},"To ",-1)),e("span",{title:(y=t==null?void 0:t.to_department)==null?void 0:y.name,class:J([{"bg-sky-500 !text-white  ":((_=t==null?void 0:t.to_department)==null?void 0:_.id)==((E=(n=d(L))==null?void 0:n.user)==null?void 0:E.department_id)},"text-sky-500 font-semibold flex-shrink-0 border border-sky-500 bg-blue-50 rounded-full px-2 text-xs"])},u(((B=t==null?void 0:t.to_department)==null?void 0:B.short_name)||((F=t==null?void 0:t.to_department)==null?void 0:F.name)),11,Nt)]),e("div",St,[((U=t==null?void 0:t.details)==null?void 0:U.length)>0&&Array.isArray(t==null?void 0:t.details)?(a(),o("div",Mt,[e("div",{class:"line-clamp-1 font-semibold",title:t==null?void 0:t.details[0].title},u(t==null?void 0:t.details[0].title),9,$t)])):(a(),o("div",zt,"No Requirement added")),h(w,{to:{name:"RequirementShow",params:{id:t==null?void 0:t.id}},class:"text-blue-600 text-sm hover:underline hover:text-blue-800"},{default:v(()=>{var V,Y;return[((V=t==null?void 0:t.details)==null?void 0:V.length)-1>0?(a(),o("span",Et,u(((Y=t==null?void 0:t.details)==null?void 0:Y.length)-1)+" More Requirement ",1)):(a(),o("span",Bt,"Show Form"))]}),_:2},1032,["to"])]),e("div",Ft,[t.created_at?(a(),o("div",Ut,[s[8]||(s[8]=e("i",{class:"fas fa-clock text-blue-400"},null,-1)),e("div",null,u(new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})),1)])):S("",!0),e("div",jt,[s[9]||(s[9]=e("span",{class:"text-xs text-gray-500"},"By:",-1)),t.created_by?(a(),b(T,{key:0,user:t.created_by,"avatar-size":"xsmall"},null,8,["user"])):S("",!0)])])]),e("td",Pt,[e("div",It,[s[10]||(s[10]=e("div",{class:"text-xs text-gray-500"},"From In Charge:",-1)),(j=t==null?void 0:t.from_department)!=null&&j.in_charge?(a(),b(T,{key:0,user:(P=t==null?void 0:t.from_department)==null?void 0:P.in_charge,"avatar-size":"xsmall"},null,8,["user"])):(a(),o("div",Ot,[(I=t==null?void 0:t.from_department)!=null&&I.incharge_id?(a(),o("span",Ht,"-")):(a(),o("span",Gt,"N/A"))]))]),e("div",Yt,[s[11]||(s[11]=e("div",{class:"text-xs text-gray-500"},"From Coordinator:",-1)),t.from_coordinator?(a(),b(T,{key:0,user:t.from_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(a(),o("div",Jt,[(O=t==null?void 0:t.from_department)!=null&&O.coordinator_id?(a(),o("span",Kt,"-")):(a(),o("span",Qt,"N/A"))]))])]),e("td",Wt,[e("div",Xt,[s[12]||(s[12]=e("div",{class:"text-xs text-gray-500"},"To In Charge:",-1)),t.to_incharge?(a(),b(T,{key:0,user:t.to_incharge,"avatar-size":"xsmall"},null,8,["user"])):(a(),o("div",Zt,[(H=t==null?void 0:t.to_department)!=null&&H.incharge_id?(a(),o("span",qt,"-")):(a(),o("span",te,"N/A"))]))]),e("div",ee,[s[13]||(s[13]=e("div",{class:"text-xs text-gray-500"},"To Coordinator:",-1)),t.to_coordinator?(a(),b(T,{key:0,user:t.to_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(a(),o("div",se,[(G=t==null?void 0:t.to_department)!=null&&G.coordinator_id?(a(),o("span",ae,"-")):(a(),o("span",oe,"N/A"))]))])]),e("td",le,[t.submission_date?(a(),o("div",ne,[e("div",null,u(new Date(t.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),1),e("div",null,u(new Date(t.submission_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})),1)])):(a(),o("div",ie,"-"))]),e("td",de,[e("div",re,[h(w,{to:{name:"RequirementShow",params:{id:t==null?void 0:t.id}},class:"btn-2",onClick:s[1]||(s[1]=V=>V.stopPropagation())},{default:v(()=>s[14]||(s[14]=[e("i",{class:"fad fa-eye"},null,-1),M(" Show ")])),_:2,__:[14]},1032,["to"]),h(w,{to:{name:"RequirementEdit",params:{id:t==null?void 0:t.id}},class:"btn-4 border border-blue-500 hover:bg-blue-500 hover:text-white",onClick:s[2]||(s[2]=V=>V.stopPropagation())},{default:v(()=>s[15]||(s[15]=[e("i",{class:"fad fa-edit"},null,-1),M(" Edit ")])),_:2,__:[15]},1032,["to"])])])])}),128))])])]))])])}}};export{we as default};
