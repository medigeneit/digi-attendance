import{u as $,f as F,r as y,x as O,D as j,h as P,q as D,p as G,c as i,o as n,a as e,d as c,l as C,k as H,m as u,H as I,j as T,F as Y,e as z,t as p}from"./index-DKFurYER.js";import{_ as J}from"./EmployeeFilter-BqIPCkF0.js";import{_ as K}from"./FlexibleDatePicker-D-NFpGtT.js";import{L as Q}from"./LoaderView-BqbLnZzZ.js";import{u as W}from"./exchange-fkCnYf0q.js";import{u as X}from"./user-oMqoLY_P.js";import"./company-BvddoaDa.js";import"./department-BZayW342.js";import"./EmployeeDropdownInput-C_Q3hFEM.js";import"./SelectDropdown-CHv5qqc9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-YQ-vnrxx.js";const Z={class:"space-y-2 px-4"},ee={class:"grid md:flex gap-4 p-2"},te={class:"relative"},oe={key:0,class:"text-center py-4"},re={key:1,class:"space-y-4"},se={class:"overflow-x-auto"},ae={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},le={class:"border border-gray-300 px-2"},de={class:"border border-gray-300 px-2"},ie={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},pe={class:"border border-gray-300 px-2"},ue={class:"border border-gray-300 px-2"},me={class:"border border-gray-300 px-2"},ye={class:"flex gap-2"},ce=["onClick"],_e={key:0},E="offday",Ae={__name:"OffdayExchangeList",setup(fe){const _=$(),l=F(),a=W(),w=X(),U=y(null),f=l.query.date||a.selectedMonth||new Date().toISOString().slice(0,7),v=y(f),g=new Date,M=s=>s.toString().padStart(2,"0"),d=y({year:Number(f.split("-")[0]||g.getFullYear()),month:Number(f.split("-")[1]||g.getMonth()+1),day:1}),A=O(()=>{var s,t;return!((s=d.value)!=null&&s.year)||!((t=d.value)!=null&&t.month)?"":`${d.value.year}-${M(d.value.month)}`}),{loading:N}=j(a),r=y({company_id:l.query.company_id||"",department_id:l.query.department_id||"all",type:l.query.type||"all",employee_id:l.query.employee_id||"",category:""});P(async()=>{N.value=!0,await w.fetchUsers(),U.value=w.users.find(s=>{var t;return s.id==((t=l==null?void 0:l.query)==null?void 0:t.company_id)}),await m()});const m=async()=>{r.value.employee_id?await a.fetchAllExchanges({company_id:r.value.company_id,department_id:r.value.department_id,user_id:r.value.employee_id,type:E,selectedMonth:v.value,selectedStatus:a.selectedStatus}):await a.fetchAllExchanges({company_id:r.value.company_id,department_id:r.value.department_id,type:E,selectedMonth:v.value,selectedStatus:a.selectedStatus})};D(()=>[r.value.company_id,r.value.department_id,r.value.employee_id],async()=>{await m()}),D(A,s=>{s&&(v.value=s,_.replace({query:{...l.query,date:s}}),m())},{immediate:!0});const V=()=>{_.go(-1)},h=async s=>{confirm("Are you sure to delete this application?")&&a.deleteExchange(s)},B=()=>{_.replace({query:{...l.query,company_id:r.value.company_id,department_id:r.value.department_id,type:r.value.type,employee_id:r.value.employee_id}})},b=s=>s?new Date(s).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"";return(s,t)=>{var S,k,q;const L=G("RouterLink");return n(),i("div",Z,[e("div",{class:"flex items-center justify-between gap-2"},[e("button",{class:"btn-3",onClick:V},t[6]||(t[6]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[7]||(t[7]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Offday Exchanges",-1)),t[8]||(t[8]=e("div",null,null,-1))]),e("div",ee,[c(J,{company_id:r.value.company_id,"onUpdate:company_id":t[1]||(t[1]=o=>r.value.company_id=o),department_id:r.value.department_id,"onUpdate:department_id":t[2]||(t[2]=o=>r.value.department_id=o),employee_id:r.value.employee_id,"onUpdate:employee_id":t[3]||(t[3]=o=>r.value.employee_id=o),category:r.value.category,"onUpdate:category":t[4]||(t[4]=o=>r.value.category=o),"with-type":!0,"initial-value":s.$route.query,onFilterChange:B},{default:C(()=>[e("div",null,[t[10]||(t[10]=e("label",{for:"",class:"top-label -top-1"},"Status ",-1)),H(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>u(a).selectedStatus=o),onChange:m,class:"input-1 py-0.5"},t[9]||(t[9]=[e("option",{value:"",selected:""},"All",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Approved"},"Approved",-1),e("option",{value:"Rejected"},"Rejected",-1)]),544),[[I,u(a).selectedStatus]])])]),_:1},8,["company_id","department_id","employee_id","category","initial-value"]),e("div",te,[t[11]||(t[11]=e("label",{for:"",class:"top-label -top-1"},"Month ",-1)),c(K,{modelValue:d.value,"onUpdate:modelValue":t[5]||(t[5]=o=>d.value=o),"show-year":!1,"show-month":!0,"show-date":!1},null,8,["modelValue"])])]),u(a).loading?(n(),i("div",oe,[c(Q)])):(n(),i("div",re,[e("div",se,[e("table",ae,[t[15]||(t[15]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-300 px-2 text-left"},"#"),e("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),e("th",{class:"border border-gray-300 px-2 text-left"},"Created Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Current Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Exchange Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Status"),e("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),e("tbody",null,[(n(!0),i(Y,null,z((S=u(a))==null?void 0:S.all_exchanges,(o,R)=>{var x;return n(),i("tr",{key:o==null?void 0:o.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",le,p(R+1),1),e("td",de,p(((x=o==null?void 0:o.user)==null?void 0:x.name)||"Unknown"),1),e("td",ie,p(b(o==null?void 0:o.created_at)),1),e("td",ne,p(b(o==null?void 0:o.current_date)),1),e("td",pe,p(b(o==null?void 0:o.exchange_date)),1),e("td",ue,p((o==null?void 0:o.status)||"N/A"),1),e("td",me,[e("div",ye,[c(L,{to:{name:"ExchangeOffdayShow",params:{id:o==null?void 0:o.id}},class:"btn-icon"},{default:C(()=>t[12]||(t[12]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[12]},1032,["to"]),e("button",{onClick:ve=>h(o==null?void 0:o.id),class:"btn-icon text-red-500"},t[13]||(t[13]=[e("i",{class:"far fa-trash"},null,-1)]),8,ce)])])])}),128)),((q=(k=u(a))==null?void 0:k.all_exchanges)==null?void 0:q.length)===0?(n(),i("tr",_e,t[14]||(t[14]=[e("td",{colspan:"6",class:"p-2 text-center text-red-500"},"No exchanges found",-1)]))):T("",!0)])])])]))])}}};export{Ae as default};
