import{z as E,i as F,r as P,b as N,q as R,c as n,a as o,j,w as B,d as t,v as u,A as i,F as v,x as b,h as f,B as I,C as m,k as p,D as q,y as G,l as _,m as O,f as W,g as z,n as H,o as d,t as y}from"./index-CK_A_oVz.js";import{u as J}from"./user-C8zhzpHG.js";import{u as $}from"./company-oQl-Q5rp.js";import{u as K}from"./department-Dc7vu3R9.js";import{u as Q}from"./designation-BevHwzel.js";import{u as X}from"./leave-approval-Dnxy63l5.js";import{u as Y}from"./shift-BIXVapat.js";import{L as Z}from"./LoaderView-BgomZ1kq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const c={class:"my-container space-y-2"},h={class:"card-bg md:p-8 p-4 mx-4"},ee={class:"grid gap-4"},le={class:"border p-4 rounded-md bg-gray-100"},oe={class:"grid md:grid-cols-2 gap-4"},se={class:"border p-4 rounded-md bg-gray-100"},te={class:"grid md:grid-cols-2 gap-4"},de=["value"],ne=["value"],re=["value"],ae=["value"],ie={class:""},ue={class:"flex flex-wrap gap-2 md:gap-4 bg-white p-2 border rounded"},pe={class:"flex items-center gap-1.5 md:gap-2"},me={class:"flex items-center gap-1.5 md:gap-2"},ve={class:"flex items-center gap-1.5 md:gap-2"},be={class:"flex items-center gap-1.5 md:gap-2"},fe={class:"flex items-center gap-1.5 md:gap-2"},ye={class:"flex items-center gap-1.5 md:gap-2"},we={class:"flex items-center gap-1.5 md:gap-2"},ge=["value"],ke=["value"],xe={class:"border p-4 rounded-md bg-gray-100"},Ue={class:"grid md:grid-cols-3 gap-4"},Se={class:"relative"},Ve=["type"],De={class:"flex justify-center gap-4"},je={__name:"UserEdit",setup(Te){const k=X(),s=E({name:"",phone:"",email:"",password:"",role:"employee",address:"",device_user_id:null,is_active:!0,company_id:"",department_id:"",designation_id:"",shift_id:"",nid:"",date_of_birth:"",joining_date:"",employment_type:"Provisional",weekends:[],leave_approval_id:"",other_approval_id:""}),S=J(),V=$(),D=K(),T=Q(),A=Y(),x=F(),U=W(),L=z(),w=P(!1),g=P(!1);N(async()=>{g.value=!0,await V.fetchCompanies(),await k.fetchLeaveApprovals(),await M(),g.value=!1}),R(()=>s.company_id,async r=>{r&&(await D.fetchDepartments(r),await T.fetchDesignations(r),await A.fetchShifts(r),g.value=!1)});const M=async()=>{var r,e;try{const a=U.params.id,l=await S.fetchUser(a);s.name=l.name,s.phone=l.phone,s.email=l.email,s.address=l.address,s.nid=l.nid,s.date_of_birth=l.date_of_birth,s.joining_date=l.joining_date,s.employment_type=l.employment_type,s.weekends=l.weekends||[],s.is_active=l.is_active,s.company_id=l.company_id,s.department_id=l.department_id,s.designation_id=l.designation_id,s.shift_id=l.shift_id,s.role=l.role,s.device_user_id=l.device_user_id,s.leave_approval_id=l.leave_approval_id,s.other_approval_id=l.other_approval_id}catch(a){const l=((e=(r=a.response)==null?void 0:r.data)==null?void 0:e.message)||"Failed to load user data";x.error(l),console.error(l),L.push({name:"UserList"})}},C=async()=>{var r,e;try{const a={...s};await S.updateUser(U.params.id,a),x.success("User updated successfully"),L.push({name:"UserShow",params:{id:U.params.id}})}catch(a){const l=((e=(r=a.response)==null?void 0:r.data)==null?void 0:e.message)||"Failed to update user";x.error(l),console.error(l)}};return(r,e)=>{const a=H("RouterLink");return d(),n("div",c,[o("div",h,[e[69]||(e[69]=o("h2",{class:"title-lg text-center"},"Edit Employee",-1)),g.value?(d(),j(Z,{key:0,class:"bg-gray-100 border shadow-none"})):(d(),n("form",{key:1,onSubmit:B(C,["prevent"]),class:"space-y-4"},[o("div",ee,[o("div",le,[e[32]||(e[32]=o("p",{class:"title-md"},"Personal Info",-1)),e[33]||(e[33]=o("hr",{class:"my-2"},null,-1)),o("div",oe,[o("div",null,[e[26]||(e[26]=o("label",null,"Name",-1)),t(o("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.name=l),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[u,s.name]])]),o("div",null,[e[27]||(e[27]=o("label",null,"Phone",-1)),t(o("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.phone=l),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[u,s.phone]])]),o("div",null,[e[28]||(e[28]=o("label",null,"Email",-1)),t(o("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.email=l),type:"email",class:"w-full p-2 border rounded"},null,512),[[u,s.email]])]),o("div",null,[e[29]||(e[29]=o("label",null,"Address",-1)),t(o("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.address=l),type:"text",class:"w-full p-2 border rounded"},null,512),[[u,s.address]])]),o("div",null,[e[30]||(e[30]=o("label",null,"NID",-1)),t(o("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.nid=l),type:"text",class:"w-full p-2 border rounded"},null,512),[[u,s.nid]])]),o("div",null,[e[31]||(e[31]=o("label",null,"Date of Birth",-1)),t(o("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>s.date_of_birth=l),type:"date",class:"w-full p-2 border rounded"},null,512),[[u,s.date_of_birth]])])])]),o("div",se,[e[59]||(e[59]=o("p",{class:"title-md"},"Professional Info",-1)),e[60]||(e[60]=o("hr",{class:"my-2"},null,-1)),o("div",te,[o("div",null,[e[35]||(e[35]=o("label",null,"Company",-1)),t(o("select",{id:"company_id","onUpdate:modelValue":e[6]||(e[6]=l=>s.company_id=l),class:"w-full border rounded px-3 py-2",required:""},[e[34]||(e[34]=o("option",{value:"",disabled:""},"Select a company",-1)),(d(!0),n(v,null,b(f(V).companies,l=>(d(),n("option",{key:l==null?void 0:l.id,value:l==null?void 0:l.id},y(l==null?void 0:l.name),9,de))),128))],512),[[i,s.company_id]])]),o("div",null,[e[37]||(e[37]=o("label",null,"Department",-1)),t(o("select",{"onUpdate:modelValue":e[7]||(e[7]=l=>s.department_id=l),class:"w-full p-2 border rounded"},[e[36]||(e[36]=o("option",{value:"",disabled:""},"Select a department",-1)),(d(!0),n(v,null,b(f(D).departments,l=>(d(),n("option",{key:l==null?void 0:l.id,value:l==null?void 0:l.id},y(l==null?void 0:l.name),9,ne))),128))],512),[[i,s.department_id]])]),o("div",null,[e[39]||(e[39]=o("label",null,"Designation",-1)),t(o("select",{"onUpdate:modelValue":e[8]||(e[8]=l=>s.designation_id=l),class:"w-full p-2 border rounded"},[e[38]||(e[38]=o("option",{value:"",disabled:""},"Select a designation",-1)),(d(!0),n(v,null,b(f(T).designations,l=>(d(),n("option",{key:l==null?void 0:l.id,value:l==null?void 0:l.id},y(l==null?void 0:l.title),9,re))),128))],512),[[i,s.designation_id]])]),o("div",null,[e[41]||(e[41]=o("label",null,"Shift",-1)),t(o("select",{"onUpdate:modelValue":e[9]||(e[9]=l=>s.shift_id=l),class:"w-full p-2 border rounded"},[e[40]||(e[40]=o("option",{value:"",disabled:""},"Select a shift",-1)),(d(!0),n(v,null,b(f(A).shifts,l=>(d(),n("option",{key:l==null?void 0:l.id,value:l==null?void 0:l.id},y(l==null?void 0:l.name),9,ae))),128))],512),[[i,s.shift_id]])]),o("div",null,[e[43]||(e[43]=o("label",null,"Employment Type",-1)),t(o("select",{"onUpdate:modelValue":e[10]||(e[10]=l=>s.employment_type=l),class:"w-full p-2 border rounded"},e[42]||(e[42]=[I('<option value="Provisional">Provisional</option><option value="Permanent">Permanent</option><option value="Part_Time">Part Time</option><option value="Remote">Remote</option><option value="Contract">Contract</option><option value="Freelance">Freelance</option><option value="Intern">Intern</option>',7)]),512),[[i,s.employment_type]])]),o("div",null,[e[44]||(e[44]=o("label",null,"Joining Date",-1)),t(o("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>s.joining_date=l),type:"date",class:"w-full p-2 border rounded"},null,512),[[u,s.joining_date]])]),o("div",ie,[e[52]||(e[52]=o("p",{class:""},"Select Weekends",-1)),o("div",ue,[o("label",pe,[t(o("input",{type:"checkbox",value:"Saturday","onUpdate:modelValue":e[12]||(e[12]=l=>s.weekends=l),class:"form-checkbox"},null,512),[[m,s.weekends]]),e[45]||(e[45]=p(" SAT "))]),o("label",me,[t(o("input",{type:"checkbox",value:"Sunday","onUpdate:modelValue":e[13]||(e[13]=l=>s.weekends=l),class:"form-checkbox"},null,512),[[m,s.weekends]]),e[46]||(e[46]=p(" SUN "))]),o("label",ve,[t(o("input",{type:"checkbox",value:"Monday","onUpdate:modelValue":e[14]||(e[14]=l=>s.weekends=l),class:"form-checkbox"},null,512),[[m,s.weekends]]),e[47]||(e[47]=p(" MON "))]),o("label",be,[t(o("input",{type:"checkbox",value:"Tuesday","onUpdate:modelValue":e[15]||(e[15]=l=>s.weekends=l),class:"form-checkbox"},null,512),[[m,s.weekends]]),e[48]||(e[48]=p(" TUE "))]),o("label",fe,[t(o("input",{type:"checkbox",value:"Wednesday","onUpdate:modelValue":e[16]||(e[16]=l=>s.weekends=l),class:"form-checkbox"},null,512),[[m,s.weekends]]),e[49]||(e[49]=p(" WED "))]),o("label",ye,[t(o("input",{type:"checkbox",value:"Thursday","onUpdate:modelValue":e[17]||(e[17]=l=>s.weekends=l),class:"form-checkbox"},null,512),[[m,s.weekends]]),e[50]||(e[50]=p(" THU "))]),o("label",we,[t(o("input",{type:"checkbox",value:"Friday","onUpdate:modelValue":e[18]||(e[18]=l=>s.weekends=l),class:"form-checkbox"},null,512),[[m,s.weekends]]),e[51]||(e[51]=p(" FRI "))])])]),o("div",null,[e[54]||(e[54]=o("label",null,"Leave Approval Group",-1)),t(o("select",{"onUpdate:modelValue":e[19]||(e[19]=l=>s.leave_approval_id=l),class:"w-full p-2 border rounded"},[e[53]||(e[53]=o("option",{value:"",disabled:""},"Select Leave Approval Group",-1)),(d(!0),n(v,null,b(f(k).leaveApprovals,l=>(d(),n("option",{key:l.id,value:l.id},y(l.name),9,ge))),128))],512),[[i,s.leave_approval_id]])]),o("div",null,[e[56]||(e[56]=o("label",null,"Other Approval Group",-1)),t(o("select",{"onUpdate:modelValue":e[20]||(e[20]=l=>s.other_approval_id=l),class:"w-full p-2 border rounded"},[e[55]||(e[55]=o("option",{value:"",disabled:""},"Select Other Approval Group",-1)),(d(!0),n(v,null,b(f(k).leaveApprovals,l=>(d(),n("option",{key:l.id,value:l.id},y(l.name),9,ke))),128))],512),[[i,s.other_approval_id]])]),o("div",null,[e[58]||(e[58]=o("label",null,"Active Status",-1)),t(o("select",{"onUpdate:modelValue":e[21]||(e[21]=l=>s.is_active=l),class:"w-full p-2 border rounded"},e[57]||(e[57]=[o("option",{value:!0},"Active",-1),o("option",{value:!1},"Inactive",-1)]),512),[[i,s.is_active]])])])]),o("div",xe,[e[65]||(e[65]=o("p",{class:"title-md"},"Technical Info",-1)),e[66]||(e[66]=o("hr",{class:"my-2"},null,-1)),o("div",Ue,[o("div",null,[e[62]||(e[62]=o("label",null,"Role",-1)),t(o("select",{"onUpdate:modelValue":e[22]||(e[22]=l=>s.role=l),class:"w-full p-2 border rounded",required:""},e[61]||(e[61]=[o("option",{value:"employee"},"Employee",-1),o("option",{value:"admin"},"Admin",-1),o("option",{value:"super_admin"},"Super Admin",-1),o("option",{value:"developer"},"Developer",-1)]),512),[[i,s.role]])]),o("div",null,[e[63]||(e[63]=o("label",null,"Biometric Device User ID",-1)),t(o("input",{"onUpdate:modelValue":e[23]||(e[23]=l=>s.device_user_id=l),type:"number",class:"w-full p-2 border rounded"},null,512),[[u,s.device_user_id]])]),o("div",null,[e[64]||(e[64]=o("label",null,"Password",-1)),o("div",Se,[t(o("input",{"onUpdate:modelValue":e[24]||(e[24]=l=>s.password=l),type:w.value?"text":"password",class:"w-full p-2 border rounded"},null,8,Ve),[[q,s.password]]),o("span",{class:"absolute inset-y-0 right-3 flex items-center cursor-pointer",onClick:e[25]||(e[25]=l=>w.value=!w.value)},[o("i",{class:G(w.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])])])])]),o("div",De,[_(a,{to:{name:"UserList"},type:"button",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:O(()=>e[67]||(e[67]=[p(" Cancel ")])),_:1}),e[68]||(e[68]=o("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"}," Save ",-1))])],32))])])}}};export{je as default};
