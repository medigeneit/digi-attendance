import{L as ue}from"./LoaderView-HnCLL6xR.js";import{r as W,x as q,e as oe,A as J,c as g,o as d,L as S,a as o,F as U,y as K,t as I,g as k,w,q as H,n as A,f as V,I as ae,i as j,k as L,d as se,m as ce,j as Q,V as Y,W as G}from"./index-3qC0V9yO.js";import{f as me,h as le,b as ye,g as ne,i as ve,j as ge}from"./datetime-DcVwRp76.js";import{a as X,u as Z}from"./useTodoStore-Den3VPHO.js";import{_ as re,a as pe}from"./TodoCreateEditShow-Bwepq3KS.js";import{_ as fe}from"./DraggableList.vue_vue_type_script_setup_true_lang-BbP0u82D.js";import{_ as ie}from"./DepartmentChip-bxIfcjAc.js";import{_ as he}from"./UserChip-BkqBYVza.js";const ke={class:"grid grid-cols-7 *:text-center *:p-2 *:border-r *:border-b *:text-blue-800 *:text-sm"},be={class:"flex flex-col"},De={key:0,class:"p-2 border-r border-t"},Ce={__name:"CalenderView",props:{month:{type:String,required:!0,validator:t=>/^\d{4}-(0[1-9]|1[0-2])$/.test(t)}},emits:["change"],setup(t,{emit:M}){const u=t,s=M,c=W(),e=W(),l=W(),b=W(),a=["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];function r(f,n,v,h){const p=[];for(let R=v-1;R>=0;R--){const E=h-R,N=new Date(f,n-1,E);p.push({date:N,day:N.getDate(),month:N.getMonth()+1,year:N.getFullYear(),isCurrentMonth:!1})}return p}function m(f,n,v){const h=[];for(let p=1;p<=v;p++){const E={date:new Date(f,n,p),day:p,month:n+1,year:f,isCurrentMonth:!0};h.push(E)}return h}function y(f,n,v){const h=[...f],p=Math.ceil(h.length/7)*7,R=1;for(let E=0;h.length<p;E++){const N=new Date(n,v+1,R+E);h.push({date:N,day:N.getDate(),month:N.getMonth()+1,year:N.getFullYear(),isCurrentMonth:!1})}return h}function D(f,n){const v=new Date(f,n,1),p=new Date(f,n+1,0).getDate(),E=(v.getDay()+1)%7,z=new Date(f,n,0).getDate();let i=[];i=[...r(f,n,E,z)];const C=m(f,n,p);return l.value=C[0],b.value=C[C.length-1],i=[...i,...C],i=[...y(i,f,n)],c.value=i[0],e.value=i[i.length-1],i}const O=q(()=>{const[f,n]=u.month.split("-"),v=parseInt(f),h=parseInt(n)-1;return console.log({yearStr:f,monthStr:n}),D(v,h)}),$=q(()=>{const f=O.value,n=[];for(let v=0;v<f.length;v+=7)n.push(f.slice(v,v+7));return n});function T(){s("change",{gridStartDate:c.value,gridEndDate:e.value,startOfMonth:l.value,endOfMonth:b.value})}return oe(()=>T()),J(()=>u.month,T),(f,n)=>(d(),g("div",null,[S(f.$slots,"calender-top"),o("div",ke,[(d(),g(U,null,K(a,v=>o("div",{key:v},I(v),1)),64))]),o("div",be,[(d(!0),g(U,null,K($.value,(v,h)=>(d(),g("div",{class:"week grid grid-cols-7 min-h-28 items-stretch",key:h},[(d(!0),g(U,null,K(v,(p,R)=>S(f.$slots,"date",{key:R,day:p.day,month:p.month,year:p.year,weekday:(p.date.getDay()+1)%7,isCurrentMonth:p.isCurrentMonth,yearMonthDate:`${p.year}-${String(p.month).padStart(2,"0")}-${String(p.day).padStart(2,"0")}`},()=>{var E;return[p!=null&&p.date?(d(),g("div",De,I((E=p==null?void 0:p.date)==null?void 0:E.getDate()),1)):k("",!0)]})),128))]))),128))]),S(f.$slots,"calender-bottom")]))}},we={class:"px-4 py-2 flex items-center lg:justify-start flex-wrap bg-gray-50 group md:gap-x-2 gap-y-4"},xe=["disabled"],$e=["value"],Te=["value"],Se={key:2,class:"md:ml-auto flex items-center justify-between md:justify-start gap-2 w-full lg:w-auto"},Ie=["value"],Me={key:3,class:"md:ml-auto flex items-center justify-between md:justify-start gap-2 w-full lg:w-auto"},Ee=["value"],Re={__name:"TodoHeading",props:{selected:{type:Object,default:()=>({type:"month-view",month:"",day:"",year:"",week:""})},loading:{type:Boolean,default:!1}},emits:["reloadClick",,"change"],setup(t,{emit:M}){const u=t,s=[{value:"month-view",label:"Monthly"},{value:"day-view",label:"Daily"}],c=M,e=W();function l(n){e.value=n,c("change",{...u.selected,type:n})}J(()=>{var n;return(n=u.selected)==null?void 0:n.type},n=>l(n),{immediate:!0});const b=q(()=>e.value=="month-view"&&u.selected.year&&u.selected.month?[u.selected.year,u.selected.month-1,1]:e.value=="day-view"&&u.selected.year&&u.selected.month&&u.selected.day?[u.selected.year,u.selected.month-1,u.selected.day]:[new Date().getFullYear(),new Date().getMonth(),new Date().getDate()]);function a(){e.value=="month-view"&&$(new Date)}function r(){if(e.value=="month-view"){const n=new Date(...b.value);n.setMonth(n.getMonth()+1),$(n)}}function m(){if(e.value=="month-view"){const n=new Date(...b.value);n.setMonth(n.getMonth()-1),$(n)}}function y(){e.value=="day-view"&&$(new Date)}function D(){if(e.value=="day-view"){const n=new Date(...b.value);n.setDate(n.getDate()+1),$(n)}}function O(){if(e.value=="day-view"){const n=new Date(...b.value);n.setDate(n.getDate()-1),$(n)}}function $(n){c("change",{type:e.value,month:n.getMonth()+1,day:n.getDate(),year:n.getFullYear(),week:n.getDay()})}const T=q(()=>e.value=="month-view"?`${u.selected.year}-${u.selected.month.toString().padStart(2,"0")}`:e.value=="day-view"?`${u.selected.year}-${u.selected.month.toString().padStart(2,"0")}-${u.selected.day.toString().padStart(2,"0")}`:u.selected),f=n=>{var v,h;if(e.value=="month-view"){const[p,R]=(v=n.target.value)==null?void 0:v.split("-").map(Number),E=new Date(p,R-1,1);$(E)}if(e.value=="day-view"){const p=new Date((h=n.target)==null?void 0:h.value);$(p)}};return(n,v)=>(d(),g("div",null,[o("div",we,[S(n.$slots,"before",{selected:t.selected}),o("button",{class:H(["px-2 py-2 disabled:text-gray-300 border size-[32px] flex items-center justify-center rounded-full",{"animate-spin !bg-opacity-0":t.loading}]),onClick:v[0]||(v[0]=w(h=>c("reloadClick"),["prevent"])),disabled:t.loading},[o("i",{class:H(["fas fa-redo",[t.loading?"text-gray-400":"text-gray-500"]])},null,2)],10,xe),S(n.$slots,"typeSelection",{selected:t.selected,types:s,changeType:l},()=>[o("select",{class:"px-2 h-7 border rounded",value:e.value,onChange:v[1]||(v[1]=h=>l(h.target.value))},[(d(),g(U,null,K(s,h=>o("option",{value:h.value,key:h.id},I(h.label),9,Te)),64))],40,$e)]),e.value=="month-view"?(d(),g("button",{key:0,class:"h-7",onClick:w(a,["prevent"])})):k("",!0),e.value=="day-view"?(d(),g("button",{key:1,class:"h-7",onClick:w(y,["prevent"])})):k("",!0),S(n.$slots,"inner",{selected:t.selected}),e.value=="month-view"?(d(),g("div",Se,[o("button",{class:"btn-3 px-3 rounded h-7",onClick:w(m,["prevent"])},v[2]||(v[2]=[o("span",{class:"fas fa-arrow-left"},null,-1)])),e.value=="month-view"?(d(),g("input",{key:0,type:"month",value:T.value,onInput:f,class:"border-2 px-2 rounded border-blue-900"},null,40,Ie)):k("",!0),o("button",{class:"btn-3 px-3 rounded h-7 md:ml-0",onClick:w(r,["prevent"])},v[3]||(v[3]=[o("span",{class:"fas fa-arrow-right"},null,-1)]))])):k("",!0),e.value=="day-view"?(d(),g("div",Me,[o("button",{class:"btn-3 px-3 rounded h-7",onClick:w(O,["prevent"])},v[4]||(v[4]=[o("span",{class:"fas fa-arrow-left"},null,-1)])),e.value=="day-view"?(d(),g("input",{key:0,type:"date",value:T.value,onInput:f,class:"border-2 px-2 rounded border-blue-900 w-28"},null,40,Ee)):k("",!0),o("button",{class:"btn-3 px-3 rounded h-7 md:ml-0",onClick:w(D,["prevent"])},v[5]||(v[5]=[o("span",{class:"fas fa-arrow-right"},null,-1)]))])):k("",!0),S(n.$slots,"after",{selected:t.selected})]),S(n.$slots,"bottom",{selected:t.selected})]))}},Oe=["title","onClick"],Ne={class:"line-clamp-1"},je={key:0,class:"text-purple-600 text-center"},de={__name:"TodosInDate",props:{date:{type:String,required:!0},maxItems:{type:[Number,String],default:3}},emits:["clickTodo"],setup(t,{emit:M}){const u=t,s=M,{getTodoDatesByDate:c}=X(),e=q(()=>{let l=[],b=!1,a=[];if(typeof c=="function"){const r=c(u.date);if(a=Array.isArray(r)?r:[],u.maxItems==="all")return{all:a,items:a,moreItemsCount:0};l=a.slice(0,u.maxItems),b=a.length-l.length}return{all:a,items:l,moreItemsCount:b}});return(l,b)=>(d(),g("div",null,[e.value.items.length===0?S(l.$slots,"noTodos",{key:0},()=>[b[0]||(b[0]=o("div",{class:"text-gray-400 text-center"},"No todos",-1))]):(d(),g(U,{key:1},[S(l.$slots,"todoItems",{todos:e.value.items,allTodos:e.value.items,moreItemsCount:e.value.moreItemsCount},()=>[(d(!0),g(U,null,K(e.value.items,a=>S(l.$slots,"todoItem",{key:a.id,todoDate:a,moreItemsCount:e.value.moreItemsCount},()=>{var r,m,y,D;return[o("div",{title:`${a==null?void 0:a.title} ${a!=null&&a.user?`
by:`:""} ${(r=a==null?void 0:a.user)==null?void 0:r.name} ${(m=a==null?void 0:a.user)!=null&&m.department?`
DEPT:`:""} ${(D=(y=a.user)==null?void 0:y.department)==null?void 0:D.name}`,class:H(["px-1 mb-2 text-xs rounded cursor-pointer flex items-center gap-2",{"bg-sky-50 text-sky-900 hover:bg-sky-700 hover:text-white border border-sky-300":a.status!=="COMPLETED","bg-green-500 text-white":a.status==="COMPLETED"}]),onClick:w(O=>s("clickTodo",a),["prevent","stop"])},[A(re,{todoDate:a,class:H(["text-sm",[a.status=="COMPLETED"?"!text-white":""]])},null,8,["todoDate","class"]),o("div",Ne,I(a.title),1),a.user?(d(),V(ae,{key:0,user:a.user,size:"xsmall",class:"ml-auto"},null,8,["user"])):k("",!0)],10,Oe)]})),128))]),e.value.moreItemsCount>0?(d(),g("div",je," + "+I(e.value.moreItemsCount)+" more todo"+I(e.value.moreItemsCount>1?"s":""),1)):k("",!0)],64))]))}},Le={class:"relative"},Pe=["onClick","onKeypress"],Ae={class:"flex items-center justify-center"},Fe=["onClick"],Be={__name:"TodosInCalenderView",props:{month:{type:String,required:!0,validator:t=>/^\d{4}-(0[1-9]|1[0-2])$/.test(t)}},emits:["dateClick","clickTodo","clickDateCell"],setup(t,{emit:M}){const u=M;function s(e,l){e.isTrusted&&e.ctrlKey&&e.which==10&&u("dateClick",l)}function c(e){const[l,b,a]=String(e).split("-").map(Number),r=new Date(l,b-1,a);return le(r)}return(e,l)=>(d(),g("div",Le,[t.month?(d(),V(Ce,{key:0,month:t.month,class:"border-t border-blue-200/50 relative"},{date:j(({day:b,month:a,yearMonthDate:r,isCurrentMonth:m})=>[o("div",{tabindex:"0",class:H(["border p-4 cursor-pointer group/date relative focus:outline-slate-400",{"bg-sky-50   border-sky-300 focus:bg-sky-50 focus:outline-sky-400":c(r),"hover:bg-slate-50  hover:border-slate-300 focus:bg-slate-50 ":!c(r)}]),onClick:w(y=>u("dateClick",r),["prevent","stop"]),onKeypress:w(y=>s(y,r),["prevent"])},[o("button",{tabindex:"1",class:H([{"text-gray-300 hover:bg-sky-200  hover:text-white":!m,"text-sky-400 hover:bg-sky-200":m},"text-center mb-2 font-semibold w-full rounded"])},I(b)+" "+I(m?"":L(me)(a-1)),3),o("div",null,[A(de,{date:r,onClickTodo:l[0]||(l[0]=y=>u("clickTodo",y))},{noTodos:j(()=>l[1]||(l[1]=[o("span",null,null,-1)])),_:2},1032,["date"])]),o("div",Ae,[o("button",{onClick:w(y=>u("clickDateCell",r),["prevent","stop"]),class:"btn-3 !py-1 invisible group-hover/date:visible text-sm text-red-800/40"},l[2]||(l[2]=[o("i",{class:"fas fa-plus"},null,-1),o("span",{class:"hidden lg:inline whitespace-nowrap"}," Add todo ",-1)]),8,Fe)])],42,Pe)]),_:1},8,["month"])):k("",!0)]))}},Ve={class:""},We={key:0,class:"mt-1 flex items-center gap-2"},Ue={key:0,class:"line-clamp-2 text-gray-500 whitespace-nowrap mr-2"},qe={class:"md:ml-auto w-full md:w-auto flex items-center justify-center gap-2"},He={key:0,class:"flex items-center gap-1 text-red-600"},ze={__name:"TodoItemCard",props:{todoDate:{type:Object,required:!0},hideDepartment:{type:Boolean,default:!1},hideUser:{type:Boolean,default:!1},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickEdit","clickDelete","clickChangeStatus","clickDelete"],setup(t,{emit:M}){const u=se(),s=M;return(c,e)=>{var b,a,r,m,y,D,O;const l=ce("RouterLink");return d(),g("div",{class:H(["px-4 py-4 md:py-2 cursor-pointer flex flex-wrap items-center gap-y-2 gap-x-4 text-sm",{"bg-green-100":t.todoDate.status=="COMPLETED","hover:bg-gray-50":t.todoDate.status!="COMPLETED"}]),onClick:e[4]||(e[4]=w($=>s("clickTodo",t.todoDate),["prevent"]))},[A(re,{todoDate:t.todoDate},null,8,["todoDate"]),o("div",Ve,[o("div",{class:H(["line-clamp-1",{"text-green-800":t.todoDate.status=="COMPLETED","text-blue-800":t.todoDate.status!="COMPLETED"}])},I(t.todoDate.id)+" - "+I(t.todoDate.title),3),t.todoDate.user?(d(),g("div",We,[t.hideUser?k("",!0):(d(),V(he,{key:0,user:t.todoDate.user,"avatar-size":"xsmall"},null,8,["user"])),t.hideDepartment?k("",!0):(d(),V(ie,{key:1,department:(a=(b=t.todoDate)==null?void 0:b.user)==null?void 0:a.department},null,8,["department"]))])):k("",!0)]),(r=t.todoDate.todo)!=null&&r.todo_type&&((m=t.todoDate.todo)!=null&&m.todo_type_id)?(d(),g("div",Ue,[Q(I((y=t.todoDate.todo)==null?void 0:y.todo_type)+" ",1),A(l,{class:"text-blue-600 font-semibold underline hover:text-sky-400",onClick:w($=>null,["stop"]),to:{name:t.userRole=="employee"?"MyTaskShow":"TaskShow",params:{id:(D=t.todoDate.todo)==null?void 0:D.todo_type_id}}},{default:j(()=>{var $;return[e[5]||(e[5]=o("i",{class:"fas fa-link"},null,-1)),Q(" "+I(($=t.todoDate.todo)==null?void 0:$.todo_type_id),1)]}),_:1,__:[5]},8,["to"])])):k("",!0),o("div",qe,[t.todoDate.status=="WORKING"?(d(),g("div",He,e[6]||(e[6]=[o("span",{class:"fas fa-circle animate-pulse text-xs"},null,-1),o("span",{class:"text-xs"},"Working",-1)]))):k("",!0),t.todoDate.user_id===((O=L(u).user)==null?void 0:O.id)?(d(),g(U,{key:1},[t.todoDate.status==="WORKING"?(d(),g("button",{key:0,title:"Mark as Completed",class:"btn-icon bg-transparent text-green-400 border-green-400 border hover:bg-green-400 hover:text-white",onClick:e[0]||(e[0]=w(()=>s("clickChangeStatus",t.todoDate,"COMPLETED"),["prevent","stop"]))},e[7]||(e[7]=[o("i",{class:"fas fa-check"},null,-1)]))):k("",!0),t.todoDate.status==="PENDING"?(d(),g("button",{key:1,title:"Start Working",class:"btn-icon bg-transparent text-red-400 border-red-400 border hover:bg-red-400 hover:text-white",onClick:e[1]||(e[1]=w(()=>s("clickChangeStatus",t.todoDate,"WORKING"),["prevent","stop"]))},e[8]||(e[8]=[o("i",{class:"fas fa-play ml-[4px]"},null,-1)]))):k("",!0),o("button",{class:"btn-icon bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:e[2]||(e[2]=w($=>{var T;return s("clickEdit",(T=t.todoDate)==null?void 0:T.todo)},["prevent","stop"]))},e[9]||(e[9]=[o("i",{class:"fas fa-pen"},null,-1)])),o("button",{class:"btn-icon bg-red-400 text-white hover:bg-red-600 hover:text-white",onClick:e[3]||(e[3]=w(()=>s("clickDelete",t.todoDate),["prevent","stop"]))},e[10]||(e[10]=[o("i",{class:"fas fa-trash-alt"},null,-1)]))],64)):k("",!0),o("button",{onClick:w(()=>null,["stop","prevent"]),class:"btn-icon bg-gray-400 text-white hover:bg-gray-600 hover:text-white handle"},e[11]||(e[11]=[o("i",{class:"fas fa-arrows-alt-v"},null,-1)]))])],2)}}},Ke={class:"border rounded-md"},Ye={class:"text-gray-700 bg-gradient-to-tl from-sky-400/60 to-sky-400 border-b py-2 px-4 flex items-center"},Ge={class:"font-semibold flex items-center gap-2"},Je={class:"text-white text-base"},Qe={class:"ml-auto flex items-center gap-2"},Xe={key:0,class:"flex items-center gap-3 mr-6"},Ze=["disabled"],_e=["disabled"],et=["date"],tt={key:1,class:"flex min-h-[38vh] items-center justify-center text-gray-400 text-center rounded-md"},nt={__name:"UserTodos",props:{todosDates:{type:Array,required:!0},user:{type:Object,required:!0},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickEdit","addCarryClick","update"],setup(t,{emit:M}){const u=t,s=W(null),c=M,e=Z(),l=X();async function b(m){confirm(`Are your sure want to delete todo
'${m==null?void 0:m.title}'`)&&(await l.deleteTodoDate(m.id),c("update"))}async function a(m,y){confirm(`Are your sure?
want to change status to ${y} 
todo: '${m==null?void 0:m.title}'`)&&(await l.updateStatus(m.id,y),c("update"))}async function r(){var y;const m=(y=s==null?void 0:s.value.items)==null?void 0:y.map(D=>D.id);await e.rearrangeMyTodos(m,{date:u.date}),c("update")}return(m,y)=>{var D,O;return d(),g("div",Ke,[o("div",Ye,[o("div",Ge,[A(ae,{user:t.user},null,8,["user"]),o("div",Je,I(t.user.label),1)]),o("div",Qe,[(D=s.value)!=null&&D.isItemsChanged?(d(),g("div",Xe,[o("button",{onClick:y[0]||(y[0]=w(()=>r(),["prevent"])),class:"btn-2 disabled:opacity-40 disabled:pointer-events-none",disabled:L(e).updatingPriority}," Save Rearranged ",8,Ze),o("button",{onClick:y[1]||(y[1]=w(()=>s.value.resetItems(),["prevent"])),class:"btn-3 disabled:opacity-40 disabled:pointer-events-none",disabled:L(e).updatingPriority}," Discard ",8,_e)])):k("",!0),A(ie,{department:(O=t.user)==null?void 0:O.department,class:"px-2"},null,8,["department"])])]),o("div",{date:m.date,"max-items":"all",class:"w-full"},[t.todosDates.length>0?(d(),V(fe,{key:0,items:t.todosDates,ref_key:"draggableTodos",ref:s,handle:"handle"},{item:j(({item:$})=>[A(ze,{todoDate:$,onClickTodo:T=>c("clickTodo",T),onClickEdit:T=>c("clickEdit",T),onClickDelete:T=>b(T),onClickChangeStatus:(T,f)=>a(T,f),"hide-department":"","hide-user":"",class:"border-b border-sky-200",userRole:t.userRole},null,8,["todoDate","onClickTodo","onClickEdit","onClickDelete","onClickChangeStatus","userRole"])]),_:1},8,["items"])):k("",!0),t.todosDates.length===0?(d(),g("div",tt," No Todos ")):k("",!0)],8,et)])}}},ot={class:"relative bg-white p-4"},at={key:0,class:"text-red-500 text-sm border border-red-300 max-w-6xl mx-auto py-2 gap-2 shadow-sm rounded flex items-center px-3"},st={class:"max-w-6xl mx-auto border rounded my-5"},lt={class:"text-gray-700 border-b py-2 px-4 flex items-center"},rt={class:"text-lg font-semibold flex items-center gap-2"},it={key:0,class:"rounded-md border text-xs px-2 py-[1px] text-red-500 border-red-500 bg-red-50"},dt={key:0,class:"ml-auto flex items-center gap-2"},ut={__name:"TodosInDailyView",props:{date:{type:String,required:!0},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickAdd","clickEdit","addCarryClick","clickDelete","clickChangeStatus","backClick","update"],setup(t,{emit:M}){const u=t,s=M,c=se(),e=Z(),l=q(()=>new Date(u.date)),b=a=>{if(u.userRole=="employee")return[{...c.user,todos:a}];const r={};return a.forEach(m=>{var D;const y=(D=m.user)==null?void 0:D.id;r[y]||(r[y]={...m.user,todos:[]}),r[y].todos.push(m)}),Object.values(r)};return(a,r)=>(d(),g("div",ot,[L(e).error?(d(),g("div",at,[r[5]||(r[5]=o("i",{class:"fad fa-exclamation-circle"},null,-1)),o("div",null,I(L(e).error),1)])):k("",!0),o("div",st,[o("div",lt,[o("button",{class:"fa fa-arrow-left btn-icon mr-2",onClick:r[0]||(r[0]=w(m=>s("backClick"),["prevent"]))}),o("div",rt,[Q(I(L(ye)(l.value,{weekDay:"long"}))+" ",1),L(le)(t.date)?(d(),g("span",it," Today ")):k("",!0)]),t.userRole=="employee"?(d(),g("div",dt,[o("button",{class:"btn btn-icon",onClick:r[1]||(r[1]=w(m=>s("clickAdd",u.date),["prevent"]))},r[6]||(r[6]=[o("i",{class:"fas fa-plus"},null,-1)]))])):k("",!0)]),A(de,{date:t.date,"max-items":"all",class:"w-full space-y-4 p-2"},{todoItems:j(({allTodos:m})=>[(d(!0),g(U,null,K(b(m),y=>(d(),V(nt,{key:y.id,todosDates:(y==null?void 0:y.todos)||[],user:y,onClickTodo:r[2]||(r[2]=D=>s("clickTodo",D)),onClickEdit:r[3]||(r[3]=D=>s("clickEdit",D)),onUpdate:r[4]||(r[4]=D=>s("update")),"user-role":t.userRole},null,8,["todosDates","user","user-role"]))),128))]),noTodos:j(()=>r[7]||(r[7]=[o("div",{class:"flex min-h-[38vh] items-center justify-center text-gray-400 text-center rounded-md"}," No Todos ",-1)])),_:1},8,["date"])])]))}},ct={class:"border bg-white relative"},mt={key:0,class:"text-red-600 py-4 text-semibold text-center text-xl min-h-[50vh] flex items-center justify-center"},Dt={__name:"TodoSection",props:{year:{type:Number,default:()=>new Date().getFullYear()},month:{type:Number,default:()=>new Date().getMonth()+1},day:{type:Number,default:()=>new Date().getDate()},week:{type:Number,default:()=>new Date().getDay()},type:{type:String,default:"month-view"},companyId:{type:String,default:""},departmentId:{type:String,default:""},employeeId:{type:String,default:""},lineType:{type:String,default:""},status:{type:String,default:""},userRole:{type:String,default:"employee"}},emits:["changeInput"],setup(t,{emit:M}){const u=new Date,s=t,c=W({type:"month-view",month:u.getMonth()+1,day:u.getDate(),year:u.getFullYear(),week:u.getDay()}),e=M;J(()=>({...c.value}),i=>{e("changeInput",i)}),J(()=>({year:s.year,month:s.month,day:s.day,week:s.week,type:s.type}),i=>{c.value={...i}},{immediate:!0});const l=W({action:null}),b=Z(),a=X();async function r(){await z()}function m(){l.value={...l.value,action:""},z()}function y(){l.value={...l.value,action:""}}async function D(i,x){await b.updateTodoStatus(i,x)}async function O(i){await b.deleteTodo(i)}function $(){c.value={...c.value,type:"month-view"}}function T(i){c.value={...c.value,...i}}function f(i){const[x,C,P]=i.split("-").map(Number);c.value={...c.value,type:"day-view",year:x,month:C,day:P}}function n(i){console.log({todo:i}),l.value={...l.value,action:"show",todo:i}}function v(i){l.value={...l.value,action:"edit",todo:i}}function h(i,x){console.log({yearMonthDay:i,mainTodoId:x}),l.value={...l.value,action:"add",date:i,todo_id:x}}function p(i,x){console.log({yearMonthDay:x,todoId:i}),l.value={...l.value,action:"addDate",date:x,todo_id:i}}function R(){l.value={action:null,todo:null}}const E=q(()=>{var P,F,B,_,ee,te;const i=(F=(P=c.value)==null?void 0:P.year)==null?void 0:F.toString(),x=(_=(B=c.value)==null?void 0:B.month)==null?void 0:_.toString().padStart(2,"0"),C=(te=(ee=c.value)==null?void 0:ee.day)==null?void 0:te.toString().padStart(2,"0");return`${i}-${x}-${C}`}),N=q(()=>{var C,P,F,B;const i=(P=(C=c.value)==null?void 0:C.year)==null?void 0:P.toString(),x=(B=(F=c.value)==null?void 0:F.month)==null?void 0:B.toString().padStart(2,"0");return`${i}-${x}`});async function z(){const[i,x]=[Number(s.year),Number(s.month)],C=ne(new Date(i,x-1,1)),P=ne(ve(i,x-1));console.log("FETCHING...",{startDate1:C,endDate1:P});const[F,B]=ge(i,x-1);console.log("FETCHING...",{startDate:F,endDate:B}),s.userRole=="employee"?await a.fetchMyTodoDates({"start-date":F,"end-date":B}):await a.fetchTodoDates({"company-id":s.companyId,"department-id":s.departmentId,"employee-id":s.employeeId,"line-type":s.lineType,"start-date":F,"end-date":B,status:s.status})}return oe(()=>{a.emptyTodoDates(),z()}),J(()=>({"company-id":s.companyId,"department-id":s.departmentId,"employee-id":s.employeeId,"line-type":s.lineType,status:s.status,month:s.month}),()=>z()),(i,x)=>(d(),g("div",null,[o("div",ct,[L(a).loading?(d(),V(ue,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:j(()=>x[0]||(x[0]=[Q(" Loading... ")])),_:1,__:[0]})):k("",!0),A(Re,{selected:c.value,class:"border-b shadow z-20",onChange:T,onReloadClick:r},{before:j(C=>[S(i.$slots,"beforeHeader",Y(G(C)))]),inner:j(C=>[S(i.$slots,"innerHeader",Y(G(C)))]),after:j(C=>[S(i.$slots,"afterHeader",Y(G(C)))]),bottom:j(C=>[o("div",null,[S(i.$slots,"bottomHeader",Y(G(C))),L(a).error?(d(),g("div",mt,I(L(a).error),1)):k("",!0)])]),typeSelection:j(C=>[S(i.$slots,"typeSelection",Y(G(C)))]),_:3},8,["selected"]),c.value.type=="month-view"&&(t.companyId||t.userRole=="employee")?(d(),V(Be,{key:1,month:N.value,class:"bg-white",onDateClick:f,onClickTodo:n,onClickDateCell:h},null,8,["month"])):k("",!0),c.value.type=="day-view"&&(t.companyId||t.userRole=="employee")?(d(),V(ut,{key:2,date:E.value,userRole:t.userRole,onClickTodo:n,onClickEdit:v,onClickAdd:h,onClickDelete:O,onClickChangeStatus:D,onBackClick:$,onUpdate:m,onAddCarryClick:h},null,8,["date","userRole"])):k("",!0)]),A(pe,{todoModal:l.value,userRole:t.userRole,onCancelClick:R,onTodoUpdate:m,onTodoDateUpdate:y,onClickEdit:v,onClickAddTodoDate:p},null,8,["todoModal","userRole"])]))}};export{Ce as _,Dt as a};
