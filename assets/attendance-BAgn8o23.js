import{K as x,r as g,C as y}from"./index-DAz2JruQ.js";const F=x("attendance",()=>{const p=g([]),w=g([]),f=g([]),v=g([]),h=g([]),b=g(null),S=g(null),D=g(new Date().toISOString().substring(0,7)),L=g(new Date().toISOString().substring(0,10)),l=g(null),u=g(!1),R=async(n,o)=>{const e=$(o);return p.value.find(t=>t.date===e)},$=n=>{const o=new Date(n),e=String(o.getDate()).padStart(2,"0"),t=o.toLocaleString("en-US",{month:"short"}),a=o.getFullYear();return`${e} ${t} ${a}`};return{monthlyLogs:p,dailyLateLogs:v,monthlyLateLogs:h,summary:b,monthly_company_summary:S,selectedMonth:D,selectedDate:L,error:l,isLoading:u,dailyLogs:f,attendanceLogs:w,getUserDailyLogsByDate:R,getMonthlyAttendanceByShift:async(n,o)=>{var e,t;if(!n||!o){l.value="Invalid user ID or month";return}u.value=!0;try{const a=await y.get(`/user/${n}/attendance/monthly/${o}`);p.value=a.data.monthly_logs,b.value=a.data.summary,l.value=null}catch(a){l.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},getTodayAttendanceReport:async(n,o,e,t,a,r)=>{var s,c;u.value=!0;try{const d={companyId:n,departmentId:o,employee_id:e,category:t,month:a,status:r},i=await y.get("/attendance/today",{params:d});f.value=i.data,l.value=null}catch(d){l.value=((c=(s=d.response)==null?void 0:s.data)==null?void 0:c.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},getAttendanceLateReport:async(n,o=null,e=null,t=null,a,r)=>{var s,c;u.value=!0;try{const d={company_id:n,department_id:o,category:e,employee_id:t,type:r,...r==="daily"?{date:a}:{month:a}},i=await y.get("/monthly/attendance/late-reports",{params:d});r==="daily"?v.value=i.data:r==="monthly"&&(h.value=i.data),l.value=null}catch(d){l.value=((c=(s=d.response)==null?void 0:s.data)==null?void 0:c.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},getMonthlyAttendanceSummaryReport:async(n,o,e,t)=>{var a,r;if(!n||!t){l.value="Invalid user ID or month";return}u.value=!0;try{const s={company_id:n,employee_id:o,category:e,month:t},c=await y.get("/attendance/monthly-summary-reports",{params:s});S.value=c.data,l.value=null}catch(s){l.value=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},downloadExcel:async(n,o,e)=>{var t,a;if(!n||!e){l.value="Invalid company ID or month";return}u.value=!0;try{const r={company_id:n,category:o,month:e},s=await y.get("/attendance/monthly-summary-reports?flag=excel",{params:r,responseType:"blob"}),c=window.URL.createObjectURL(new Blob([s.data])),d=document.createElement("a");d.href=c,d.setAttribute("download",`${e} attendance_summary.xlsx`),document.body.appendChild(d),d.click(),document.body.removeChild(d)}catch(r){l.value=((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},downloadPDF:async(n,o,e,t=0)=>{var a,r;if(!n||!e){l.value="Invalid user ID or month";return}u.value=!0;try{const s={company_id:n,category:o,month:e},c=await y.get("/attendance/monthly-summary-reports?flag=pdf",{params:s,responseType:"blob"}),d=window.URL.createObjectURL(new Blob([c.data])),i=document.createElement("a");i.href=d,i.setAttribute("download",`${e} attendance_summary.pdf`),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(s){l.value=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},attendanceDownloadExcel:async(n,o,e,t,a)=>{var r,s;u.value=!0;try{const c={companyId:n,employee_id:o,category:e,month:t,status:a},d=await y.get("/attendance/today?flag=excel",{params:c,responseType:"blob"}),i=window.URL.createObjectURL(new Blob([d.data])),m=document.createElement("a");m.href=i,m.setAttribute("download",`${t} attendance_summary.xlsx`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(c){l.value=((s=(r=c.response)==null?void 0:r.data)==null?void 0:s.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},attendanceDownloadPdf:async(n,o,e,t,a)=>{var r,s;u.value=!0;try{const c={companyId:n,employee_id:o,category:e,month:t,status:a},d=await y.get("/attendance/today?flag=pdf",{params:c,responseType:"blob"}),i=window.URL.createObjectURL(new Blob([d.data])),m=document.createElement("a");m.href=i,m.setAttribute("download",`${t} attendance_summary.pdf`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(c){l.value=((s=(r=c.response)==null?void 0:r.data)==null?void 0:s.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},lateReportDownloadExcel:async(n,o,e,t)=>{var a,r;if(!n){l.value="Invalid company ID or date/month";return}u.value=!0;try{const s={company_id:n,...o?{employee_id:o}:{},type:t,...t==="daily"?{date:e}:{month:e}},c=await y.get("/monthly/attendance/late-reports?flag=excel",{params:s,responseType:"blob"}),d=window.URL.createObjectURL(new Blob([c.data])),i=document.createElement("a");i.href=d;const m=`${e}-late-attendance.xlsx`;i.setAttribute("download",m),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(s){l.value=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},getMonthlyAttendanceLog:async(n,o)=>{var e,t;if(!n||!o){l.value="Invalid user ID or month";return}u.value=!0;try{const a=await y.get(`/user/${n}/attendance/monthly/${o}/log`);w.value=a.data.attendance_logs}catch(a){l.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong",console.error(l.value)}finally{u.value=!1}},getDateRangeAttendanceSummary:async(n,o,e,t)=>{var a,r;if(!e||!n||!o){l.value="Company, Start Date, and End Date are required";return}u.value=!0;try{return(await y.get("/attendance/date-range-summary",{params:{company_id:e,start_date:n,end_date:o,employee_id:t||void 0}})).data}catch(s){return l.value=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Something went wrong",console.error(l.value),null}finally{u.value=!1}},downloadDateRangeExcel:async(n,o,e,t=null,a="")=>{var d;if(!e||!n||!o){l.value="Company, Start Date, and End Date are required";return}const r=(d=y.defaults.baseURL)==null?void 0:d.replace(/\/$/,"");let s=`flag=excel&company_id=${e}&start_date=${n}&end_date=${o}`;t&&(s+=`&employee_id=${t}`),a&&(s+=`&category=${a}`);const c=`${r}/attendance/date-range-summary?${s}`;console.log("ðŸ“ Opening Excel Download URL:",c),window.open(c,"_blank")},downloadDateRangePdf:(n,o,e,t=null,a="")=>{if(!e||!n||!o){l.value="Company, Start Date, and End Date are required";return}const r=new URLSearchParams({flag:"pdf",company_id:e,start_date:n,end_date:o});t&&r.append("employee_id",t),a&&r.append("category",a);const s=`/attendance/date-range-summary?${r.toString()}`;window.open(s,"_blank")}}});export{F as u};
