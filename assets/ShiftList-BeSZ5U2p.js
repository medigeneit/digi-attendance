import{_ as L,a as B}from"./HeaderWithButtons-CRl9o9vk.js";import{L as N}from"./LoaderView-tnCXQklQ.js";import{r as b,z as I,q as F,o as d,c,a as e,t as u,w as O,d as _,A as D,F as C,x as M,h as A,v as S,e as z,s as R,i as G,b as H,l as k}from"./index-B8mSMKDk.js";import{u as J}from"./company-wCYEeYru.js";import{u as K}from"./shift-C5r6GT9m.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const P={key:0,class:"modal-bg"},Q={class:"modal-card"},W={class:"text-lg font-semibold mb-4"},X={class:"mb-4"},Y=["value"],Z={class:"mb-4"},ee={class:"mb-4"},te={class:"mb-4"},se={class:"mb-4"},oe={class:"mb-4"},le={class:"flex justify-end"},ae={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},ie={__name:"ShiftModal",props:{show:{type:Boolean,required:!0},shift:{type:Object,default:null}},emits:["close","save"],setup($,{emit:m}){const h=$,x=m,y=J();y.companies;const p=b(!1),i=b(!1),t=I({id:null,company_id:"",name:"",start_time:"",end_time:"",description:"",status:"Active"}),f=()=>{p.value=!1,t.id=null,t.company_id="",t.name="",t.start_time="",t.end_time="",t.description="",t.status="Active"};F(()=>h.shift,l=>{l&&typeof l=="object"&&Object.keys(l).length>0?(p.value=!0,t.id=l.id||null,t.company_id=l.company_id||"",t.name=l.name||"",t.start_time=l.start_time||"",t.end_time=l.end_time||"",t.description=l.description||"",t.status=l.status||"Active"):f()},{immediate:!0,deep:!0}),F(()=>h.show,async l=>{l&&!i.value&&await w()});const n=()=>{x("save",{...t}),f(),g()},g=()=>{f(),x("close")},w=async()=>{try{await y.fetchCompanies(),i.value=!0}catch(l){console.error("Failed to fetch companies:",l)}};return(l,s)=>$.show?(d(),c("div",P,[e("div",Q,[e("h2",W,u(p.value?"Edit Shift":"Add Shift"),1),e("form",{onSubmit:O(n,["prevent"])},[e("div",X,[s[7]||(s[7]=e("label",{for:"company_id",class:"block text-sm font-medium mb-2"},"Company",-1)),_(e("select",{id:"company_id","onUpdate:modelValue":s[0]||(s[0]=o=>t.company_id=o),class:"w-full border rounded px-3 py-2",required:""},[s[6]||(s[6]=e("option",{value:"",disabled:""},"Select a company",-1)),(d(!0),c(C,null,M(A(y).companies,o=>(d(),c("option",{key:o.id,value:o.id},u(o.name),9,Y))),128))],512),[[D,t.company_id]])]),e("div",Z,[s[8]||(s[8]=e("label",{for:"name",class:"block text-sm font-medium mb-2"},"Name",-1)),_(e("input",{id:"name","onUpdate:modelValue":s[1]||(s[1]=o=>t.name=o),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter shift name",required:""},null,512),[[S,t.name]])]),e("div",ee,[s[9]||(s[9]=e("label",{for:"start_time",class:"block text-sm font-medium mb-2"},"Start Time",-1)),_(e("input",{id:"start_time","onUpdate:modelValue":s[2]||(s[2]=o=>t.start_time=o),type:"time",class:"w-full border rounded px-3 py-2",required:""},null,512),[[S,t.start_time]])]),e("div",te,[s[10]||(s[10]=e("label",{for:"end_time",class:"block text-sm font-medium mb-2"},"End Time",-1)),_(e("input",{id:"end_time","onUpdate:modelValue":s[3]||(s[3]=o=>t.end_time=o),type:"time",class:"w-full border rounded px-3 py-2",required:""},null,512),[[S,t.end_time]])]),e("div",se,[s[11]||(s[11]=e("label",{for:"description",class:"block text-sm font-medium mb-2"},"Description",-1)),_(e("textarea",{id:"description","onUpdate:modelValue":s[4]||(s[4]=o=>t.description=o),class:"w-full border rounded px-3 py-2",placeholder:"Enter description (optional)"},null,512),[[S,t.description]])]),e("div",oe,[s[13]||(s[13]=e("label",{for:"status",class:"block text-sm font-medium mb-2"},"Status",-1)),_(e("select",{id:"status","onUpdate:modelValue":s[5]||(s[5]=o=>t.status=o),class:"w-full border rounded px-3 py-2",required:""},s[12]||(s[12]=[e("option",{value:"Active"},"Active",-1),e("option",{value:"Inactive"},"Inactive",-1)]),512),[[D,t.status]])]),e("div",le,[e("button",{type:"button",onClick:g,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2"}," Cancel "),e("button",ae,u(p.value?"Update":"Create"),1)])],32)])])):z("",!0)}},ne={class:"my-container space-y-4"},re={key:0,class:"text-center py-4"},de={key:1,class:"space-y-4"},ce={class:"title-md"},ue={class:"overflow-x-auto"},me={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},pe={class:"text-gray-600 text-sm"},fe={class:"py-3 px-2 text-left"},ve={class:"py-3 px-2 text-left"},ye={class:"py-3 px-2 text-left"},_e={class:"py-3 px-2 text-center"},be={class:"py-3 px-2 text-center"},he={class:"flex item-center justify-center gap-4"},xe=["onClick"],ge=["onClick"],Ae={__name:"ShiftList",setup($){const m=K(),{shifts:h,loading:x,error:y,message:p}=R(m),i=G(),t=b(!1),f=b(!1),n=b(null),g=()=>{n.value=null,t.value=!0},w=()=>{t.value=!1},l=a=>{n.value=a,t.value=!0},s=a=>{n.value=a,f.value=!0},o=()=>{f.value=!1},q=async a=>{try{a.id?await m.updateShift(a.id,a)?i.success(p.value):i.error(y.value):await m.createShift(a)?i.success(p.value):i.error(y.value)}catch(r){i.error("Failed to save shift!"),console.error("Error handling save:",r)}finally{w()}},T=async()=>{if(!n.value||!n.value.id){i.error("Invalid shift selected for deletion!");return}try{await m.deleteShift(n.value.id),i.success("Shift deleted successfully!")}catch(a){i.error("Failed to delete shift!"),console.error("Error deleting shift:",a)}finally{o()}};return H(async()=>{try{await m.fetchShifts()}catch(a){i.error("Failed to fetch shifts!"),console.error("Error fetching shifts:",a)}}),(a,r)=>{var E;return d(),c("div",ne,[k(B,{title:"Shift List",onAdd:g}),A(x)?(d(),c("div",re,[k(N)])):(d(),c("div",de,[(d(!0),c(C,null,M(A(h),(U,V)=>(d(),c("div",{key:V},[e("h2",ce,u(V),1),e("div",ue,[e("table",me,[r[2]||(r[2]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"Name"),e("th",{class:"py-3 px-2 text-left"},"Start Time"),e("th",{class:"py-3 px-2 text-left"},"End Time"),e("th",{class:"py-3 px-2 text-center"},"Status"),e("th",{class:"py-3 px-2 text-center"},"Action")])],-1)),e("tbody",pe,[(d(!0),c(C,null,M(U,v=>(d(),c("tr",{key:v.id,class:"border-b border-gray-200 hover:bg-gray-100"},[e("td",fe,u(v.name),1),e("td",ve,u(v.start_time),1),e("td",ye,u(v.end_time),1),e("td",_e,u(v.status),1),e("td",be,[e("div",he,[e("button",{onClick:j=>l(v),class:"text-blue-600 hover:text-blue-800"},r[0]||(r[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,xe),e("button",{onClick:j=>s(v),class:"text-red-600 hover:text-red-800"},r[1]||(r[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,ge)])])]))),128))])])])]))),128))])),k(ie,{show:t.value,shift:n.value,onClose:w,onSave:q},null,8,["show","shift"]),k(L,{show:f.value,title:"Delete Shift",message:`Are you sure you want to delete ${(E=n.value)==null?void 0:E.name}?`,onClose:o,onConfirm:T},null,8,["show","message"])])}}};export{Ae as default};
