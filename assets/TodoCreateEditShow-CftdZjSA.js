import{m as U,c as m,o as d,g as p,x as j,d as tt,n as it,p as R,a as e,t as S,f as M,j as I,i as L,w as $,k as x,F as X,L as J,r as T,e as P,J as G,A as Y,K as et,M as rt,h as q,v as F,y as ut,X as ct}from"./index-BOxZs2SM.js";import{_ as mt}from"./DepartmentChip-Ch2U8ACD.js";import{_ as ot}from"./UserChip-BbHRFvLx.js";import{O as _}from"./OverlyModal-BcMds_q5.js";import{g as W,b as lt}from"./datetime-DcVwRp76.js";import{u as Q,a as st,f as yt,d as ft,b as vt}from"./useTodoStore-Dm7nzFxI.js";import{L as H}from"./LoaderView-BOFHaCun.js";import{u as at}from"./useTaskStore-CKflHiz6.js";const pt={key:0,class:"fa fa-exclamation-square",title:"Pending"},bt={key:1,class:"fa fa-pause",title:"Working"},gt={key:2,class:"fa fa-check-square",title:"Completed"},dt={__name:"TodoStatusIcon",props:{todoDate:{type:Object,required:!0}},setup(o){const D=o,n=U(()=>{switch(D.todoDate.status){case"PENDING":return"text-red-400";case"WORKING":return"text-yellow-600";case"COMPLETED":return"text-green-400"}return""});return(s,g)=>(d(),m("span",{class:j(n.value)},[o.todoDate.status=="PENDING"?(d(),m("i",pt)):p("",!0),o.todoDate.status=="WORKING"?(d(),m("i",bt)):p("",!0),o.todoDate.status=="COMPLETED"?(d(),m("i",gt)):p("",!0)],2))}},kt={class:""},xt={key:0,class:"mt-1 flex items-center gap-2"},wt={key:0,class:"line-clamp-2 text-gray-500 whitespace-nowrap mr-2"},Tt={class:"md:ml-auto w-full md:w-auto flex items-center justify-center gap-2"},Dt={key:0,class:"flex items-center gap-1 text-red-600"},De={__name:"TodoItemCard",props:{todoDate:{type:Object,required:!0},hideDepartment:{type:Boolean,default:!1},hideUser:{type:Boolean,default:!1},hideSortingBtn:{type:Boolean,default:!1},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickEdit","clickDelete","clickChangeStatus","clickDelete"],setup(o,{emit:D}){const n=tt(),s=D;return(g,a)=>{var f,l,b,y,r,t,k;const i=it("RouterLink");return d(),m("div",{class:j(["px-4 py-4 md:py-2 cursor-pointer flex flex-wrap items-center gap-y-2 gap-x-4 text-sm",{"bg-green-100":o.todoDate.status=="COMPLETED","hover:bg-gray-50":o.todoDate.status!="COMPLETED"}]),onClick:a[4]||(a[4]=$(h=>s("clickTodo",o.todoDate),["prevent"]))},[R(dt,{todoDate:o.todoDate},null,8,["todoDate"]),e("div",kt,[e("div",{class:j(["line-clamp-1",{"text-green-800":o.todoDate.status=="COMPLETED","text-blue-800":o.todoDate.status!="COMPLETED"}])},S(o.todoDate.id)+" - "+S(o.todoDate.title),3),o.todoDate.user?(d(),m("div",xt,[o.hideUser?p("",!0):(d(),M(ot,{key:0,user:o.todoDate.user,"avatar-size":"xsmall"},null,8,["user"])),o.hideDepartment?p("",!0):(d(),M(mt,{key:1,department:(l=(f=o.todoDate)==null?void 0:f.user)==null?void 0:l.department},null,8,["department"]))])):p("",!0)]),(b=o.todoDate.todo)!=null&&b.todo_type&&((y=o.todoDate.todo)!=null&&y.todo_type_id)?(d(),m("div",wt,[I(S((r=o.todoDate.todo)==null?void 0:r.todo_type)+" ",1),R(i,{class:"text-blue-600 font-semibold underline hover:text-sky-400",onClick:$(h=>null,["stop"]),to:{name:o.userRole=="employee"?"MyTaskShow":"TaskShow",params:{id:(t=o.todoDate.todo)==null?void 0:t.todo_type_id}}},{default:L(()=>{var h;return[a[5]||(a[5]=e("i",{class:"fas fa-link"},null,-1)),I(" "+S((h=o.todoDate.todo)==null?void 0:h.todo_type_id),1)]}),_:1,__:[5]},8,["to"])])):p("",!0),e("div",Tt,[o.todoDate.status=="WORKING"?(d(),m("div",Dt,a[6]||(a[6]=[e("span",{class:"fas fa-circle animate-pulse text-xs"},null,-1),e("span",{class:"text-xs"},"Working",-1)]))):p("",!0),o.todoDate.user_id===((k=x(n).user)==null?void 0:k.id)?(d(),m(X,{key:1},[o.todoDate.status==="WORKING"?(d(),m("button",{key:0,title:"Mark as Completed",class:"btn-icon bg-transparent text-green-400 border-green-400 border hover:bg-green-400 hover:text-white",onClick:a[0]||(a[0]=$(()=>s("clickChangeStatus",o.todoDate,"COMPLETED"),["prevent","stop"]))},a[7]||(a[7]=[e("i",{class:"fas fa-check"},null,-1)]))):p("",!0),o.todoDate.status==="PENDING"?(d(),m("button",{key:1,title:"Start Working",class:"btn-icon bg-transparent text-red-400 border-red-400 border hover:bg-red-400 hover:text-white",onClick:a[1]||(a[1]=$(()=>s("clickChangeStatus",o.todoDate,"WORKING"),["prevent","stop"]))},a[8]||(a[8]=[e("i",{class:"fas fa-play ml-[4px]"},null,-1)]))):p("",!0),e("button",{class:"btn-icon bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:a[2]||(a[2]=$(h=>{var u;return s("clickEdit",(u=o.todoDate)==null?void 0:u.todo)},["prevent","stop"]))},a[9]||(a[9]=[e("i",{class:"fas fa-pen"},null,-1)])),e("button",{class:"btn-icon bg-red-400 text-white hover:bg-red-600 hover:text-white",onClick:a[3]||(a[3]=$(()=>s("clickDelete",o.todoDate),["prevent","stop"]))},a[10]||(a[10]=[e("i",{class:"fas fa-trash-alt"},null,-1)]))],64)):p("",!0),o.hideSortingBtn?p("",!0):(d(),m("button",{key:2,onClick:$(()=>null,["stop","prevent"]),class:"btn-icon bg-gray-400 text-white hover:bg-gray-600 hover:text-white handle"},a[11]||(a[11]=[e("i",{class:"fas fa-arrows-alt-v"},null,-1)])))])],2)}}},Ct={class:"bg-white border-t px-4 py-4 sticky bottom-0 rounded-b-md"},ht={key:0,class:"mb-4 text-red-500 font-medium"},St={key:0,class:"mb-4 text-blue-500 font-medium"},$t={class:"flex justify-between items-center gap-4"},It=["disabled"],Z={__name:"FormHandler",props:{isSubmitting:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["submit","clickCancel"],setup(o,{emit:D}){const n=D;return(s,g)=>(d(),m("form",{onSubmit:g[1]||(g[1]=$(a=>n("submit"),["prevent"]))},[J(s.$slots,"default"),e("div",Ct,[J(s.$slots,"error",{},()=>[o.error?(d(),m("div",ht,S(o.error),1)):p("",!0)]),o.isSubmitting?(d(),m("div",St,"Saving changes...")):p("",!0),J(s.$slots,"footer",{},()=>[e("div",$t,[e("button",{type:"button",onClick:g[0]||(g[0]=a=>n("clickCancel")),class:"btn-3"},"Cancel"),e("button",{disabled:o.isSubmitting||o.isLoading,type:"submit",class:"btn-2"},S(o.isSubmitting?"Saving...":"Save"),9,It)])])])],32))}},Et={class:"flex items-center py-1"},Rt={class:j(["line-clamp-2 mr-4 "])},Mt={__name:"TodoInputTaskItem",props:{task:Object,level:Number,selected:Number},emits:["select"],setup(o,{emit:D}){const n=D;return(s,g)=>(d(),m("div",{class:j(["px-2 border-b py-3 over text-sm relative",[o.task.id==o.selected?"text-red-50 bg-sky-500 px-2":"hover:text-blue-500"]])},[e("div",Et,[e("div",Rt,S(o.task.id)+" - "+S(o.task.title),1),o.task.id!=o.selected?(d(),m("button",{key:0,class:"border btn-2 ml-auto",onClick:g[0]||(g[0]=$(()=>n("select",o.task),["prevent"]))}," Select ")):p("",!0)])],2))}},Lt={key:0,class:"line-clamp-1"},Ot={key:1},Ut={class:"flex items-center mb-2"},Nt={class:"relative"},Vt={class:"border flex rounded-t-md sticky top-0 bg-white"},Bt={class:"h-[250px] overflow-y-auto"},jt={class:"border"},Pt={__name:"TaskSelectionInput",props:{todoType:{type:String,default:"task"},taskId:{type:[String,Number],default:null},show:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["update:todoType","update:taskId","update:show"],setup(o,{emit:D}){const n=o,s=D,g=T(""),a=U({get:()=>n.taskId,set:u=>s("update:taskId",u)}),i=U({get:()=>n.show,set:u=>s("update:show",u)}),f=T(null),l=T({});function b(){if(!(f!=null&&f.value))return;const u=f.value.getBoundingClientRect(),C=window.innerHeight,O=300,N=C-u.bottom<O;l.value={position:"fixed",top:N?u.top-O+"px":u.bottom+"px",left:u.left+"px",width:u.width+"px",zIndex:5e3}}P(async()=>{await G(),window.addEventListener("resize",b),document.addEventListener("scroll",b)});const y=at();Y(()=>i.value,async u=>{u&&await y.fetchAllMyTasks()}),et(()=>{window.removeEventListener("resize",b),document.removeEventListener("scroll",b)});function r(u){a.value=u.id,i.value=!1}function t(u){a.value="",i.value=!1}const k=U(()=>[...y.tasks||[]].find(u=>u.id==a.value)),h=U(()=>{const u=g.value.trim().toUpperCase();return u.length?[...y.tasks||[]].filter(C=>String(C.title||"").toUpperCase().includes(u)):y.tasks});return(u,C)=>(d(),m("div",{class:"relative",ref_key:"anchor",ref:f},[e("div",{class:j(["w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 cursor-pointer flex items-center shadow-sm",a.value?"":"text-gray-400"]),onClick:C[0]||(C[0]=$(()=>{o.readonly||(i.value=!0,b())},["stop"]))},[k.value.title?(d(),m("div",Lt,S(k.value.id)+" - "+S(k.value.title),1)):(d(),m("div",Ot,"Click to select todo")),a.value&&!o.readonly?(d(),m("button",{key:2,class:"btn-icon fas fa-times !size-8 text-sm ml-auto",onClick:$(t,["prevent","stop"])})):p("",!0)],2),(d(),M(ct,{to:"body"},[i.value?(d(),m("div",{key:0,style:rt(l.value),class:"fixed bg-white rounded-b-md shadow-lg border z-[5000] p-4"},[e("div",Ut,[C[4]||(C[4]=e("h2",{class:"text-sky-800 text-sm uppercase"},"Task List",-1)),e("button",{onClick:C[1]||(C[1]=$(()=>i.value=!1,["prevent"])),class:"ml-auto"},C[3]||(C[3]=[e("i",{class:"fas fa-times-circle text-red-700 text-xl hover:text-red-500"},null,-1)]))]),e("div",Nt,[e("div",Vt,[q(e("input",{type:"text",placeholder:"Search task",class:"w-full py-2 px-4 rounded-t-md outline-sky-200","onUpdate:modelValue":C[2]||(C[2]=O=>g.value=O)},null,512),[[F,g.value]]),C[5]||(C[5]=e("label",{class:"ml-auto flex w-8 items-center justify-center absolute right-0 top-0 bottom-0"},[e("i",{class:"fas fa-search"})],-1))])]),e("div",Bt,[e("div",jt,[(d(!0),m(X,null,ut(h.value,O=>(d(),M(Mt,{key:O.id,task:O,onSelect:r,selected:a.value,class:"group/main"},null,8,["task","selected"]))),128))])])],4)):p("",!0)]))],512))}},nt={__name:"TodoTypeInput",props:{todoType:{type:String,default:"task"},todoTypeId:{type:[String,Number],default:null},show:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},emits:["update:todoType","update:todoTypeId","update:show"],setup(o,{emit:D}){const n=o,s=D,g=U({get:()=>n.todoTypeId,set:y=>s("update:todoTypeId",y)}),a=U({get:()=>n.show,set:y=>s("update:show",y)}),i=T(null),f=T({});function l(){if(!(i!=null&&i.value))return;const y=i.value.getBoundingClientRect(),r=window.innerHeight,t=300,h=r-y.bottom<t;f.value={position:"fixed",top:h?y.top-t+"px":y.bottom+"px",left:y.left+"px",width:y.width+"px",zIndex:5e3}}P(async()=>{await G(),window.addEventListener("resize",l),document.addEventListener("scroll",l)});const b=at();return Y(()=>a.value,async y=>{y&&await b.fetchAllMyTasks()}),et(()=>{window.removeEventListener("resize",l),document.removeEventListener("scroll",l)}),(y,r)=>(d(),m("div",null,[R(Pt,{show:a.value,"onUpdate:show":r[0]||(r[0]=t=>a.value=t),taskId:g.value,"onUpdate:taskId":r[1]||(r[1]=t=>g.value=t)},null,8,["show","taskId"])]))}},zt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},At={class:"mb-2"},Wt={class:"mb-4"},qt={class:"mb-4"},Ft=["readonly"],Gt={class:"mb-4"},Kt={__name:"TodoAddForm",props:{date:{type:String,default:W(new Date)},userRole:{type:String,default:"employee"},todoType:{type:String,default:null},todoTypeId:{type:String,default:null},readonlyValues:{type:Object,default:()=>({date:!1,todo_type_id:!1})}},emits:["update","cancelClick"],setup(o,{emit:D}){const n=o,s=T(),g=T(!1),a=T(),i=Q(),f=D,l=T({title:"",date:n.date||"",todo_type:"",todo_type_id:""});async function b(){var r;try{s.value="submitting",(r=l.value)!=null&&r.todo_type_id||(l.value={title:l.value.title,date:l.value.date}),await i.createTodo(l.value,{returnWith:n.userRole!=="employee"?"user,department,company":""}),f("update")}finally{s.value=""}}Y(()=>({date:n.date,todo_type:n.todoType,todo_type_id:n.todoTypeId}),r=>{l.value=r},{immediate:!0});const y=U(()=>new Date(n.date));return P(async()=>{var r;await G(),(r=a.value)==null||r.focus()}),(r,t)=>(d(),m("div",{onClick:t[6]||(t[6]=k=>g.value=!1)},[x(i).loading?(d(),M(H,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:L(()=>t[7]||(t[7]=[I(" Loading... ")])),_:1,__:[7]})):p("",!0),R(Z,{onSubmit:b,onClickCancel:t[5]||(t[5]=k=>f("cancelClick")),isSubmitting:s.value=="submitting",error:x(i).error,class:"rounded-md relative"},{default:L(()=>{var k,h;return[t[12]||(t[12]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Add Todo")],-1)),e("div",zt,[e("div",At,[t[8]||(t[8]=e("span",{class:"font-semibold"}," Date ",-1)),e("span",null,S(x(lt)(y.value,{weekDay:"long"})),1)]),e("div",Wt,[t[9]||(t[9]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),q(e("input",{ref_key:"titleRef",ref:a,"onUpdate:modelValue":t[0]||(t[0]=u=>l.value.title=u),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,l.value.title]])]),e("div",qt,[t[10]||(t[10]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Date",-1)),q(e("input",{readonly:(k=o.readonlyValues)==null?void 0:k.date,"onUpdate:modelValue":t[1]||(t[1]=u=>l.value.date=u),type:"date",required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,8,Ft),[[F,l.value.date]])]),e("div",Gt,[t[11]||(t[11]=e("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),R(nt,{show:g.value,"onUpdate:show":t[2]||(t[2]=u=>g.value=u),todoType:l.value.todo_type,"onUpdate:todoType":t[3]||(t[3]=u=>l.value.todo_type=u),todoTypeId:l.value.todo_type_id,"onUpdate:todoTypeId":t[4]||(t[4]=u=>l.value.todo_type_id=u),readonly:(h=o.readonlyValues)==null?void 0:h.todo_type_id},null,8,["show","todoType","todoTypeId","readonly"])])])]}),_:1,__:[12]},8,["isSubmitting","error"])]))}},_t={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},Ht={class:"mb-4 text-md"},Jt={class:"font-semibold"},Xt={class:"mb-2"},Yt={__name:"TodoDateAddForm",props:{date:{type:[String,Number],default:W(new Date)},todoId:{type:[String,Number],required:!0},userRole:{type:String,default:"employee"}},emits:["update","cancelClick"],setup(o,{emit:D}){const n=o,s=T(),g=T(!1),a=T(),i=Q(),f=st(),l=D,b=T({date:n.date||"",todo_id:n.todoId});async function y(){try{s.value="submitting",await f.createTodoDate(b.value),l("update")}finally{s.value=""}}return P(async()=>{var r;await G(),await i.fetchTodo(n.todoId),(r=a.value)==null||r.focus()}),(r,t)=>(d(),m("div",{onClick:t[2]||(t[2]=k=>g.value=!1)},[x(i).loading?(d(),M(H,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:L(()=>t[3]||(t[3]=[I(" Loading... ")])),_:1,__:[3]})):p("",!0),R(Z,{onSubmit:y,onClickCancel:t[1]||(t[1]=k=>l("cancelClick")),isSubmitting:s.value=="submitting",error:x(f).error,class:"rounded-md relative"},{default:L(()=>{var k;return[t[6]||(t[6]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Carry Todo To Date")],-1)),e("div",_t,[e("div",Ht,[t[4]||(t[4]=I(" TODO: ")),e("span",Jt,S((k=x(i).todo)==null?void 0:k.title),1)]),e("div",Xt,[t[5]||(t[5]=e("span",{class:"font-semibold"}," Date ",-1)),q(e("input",{"onUpdate:modelValue":t[0]||(t[0]=h=>b.value.date=h),type:"date",multiple:"",required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,b.value.date]])])])]}),_:1,__:[6]},8,["isSubmitting","error"])]))}},Qt={key:0,class:"mb-4 text-red-500 font-medium"},Zt={key:1,class:"mb-4 text-red-500 font-medium"},te={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},ee={class:"mb-4"},oe={class:"mb-4"},le={__name:"TodoEditForm",props:{date:{type:String,default:W(new Date)},todo:{type:Object,default:()=>({})}},emits:["update","cancelClick"],setup(o,{emit:D}){var V;const n=o,s=T(),g=T(!1),a=T(),i=Q(),f=D,l=T({title:"",todo_type:"task",todo_type_id:""}),b=T({id:null,repeat_type:"daily",start_date:((V=n.todo)==null?void 0:V.date)||n.date||W(new Date),end_date:null,weekly_day:null,monthly_mode:null,monthly_value:null,monthly_week:null,yearly_month:null,yearly_day:null}),y=T(!1),r=T({});async function t(){var w,c,v;await i.fetchTodo((w=n.todo)==null?void 0:w.id),l.value.title=(c=i.todo)==null?void 0:c.title,l.value.todo_type_id=(v=i.todo)==null?void 0:v.todoable_id}const k=T(null);async function h(){var w,c;try{const{data:v}=await yt(n.todo.id),E=v==null?void 0:v.setting;E?(y.value=!0,k.value=E.id,b.value={repeat_type:E.repeat_type??"daily",start_date:E.start_date??b.value.start_date,end_date:E.end_date??null,weekly_day:E.weekly_day??null,monthly_mode:E.monthly_mode??null,monthly_value:E.monthly_value??null,monthly_week:E.monthly_week??null,yearly_month:E.yearly_month??null,yearly_day:E.yearly_day??null}):b.value.id=null}catch(v){B.value=(c=(w=v==null?void 0:v.response)==null?void 0:w.data)==null?void 0:c.message,console.error("Load setting failed:",(v==null?void 0:v.message)||v)}}async function u(){await i.updateTodo(n.todo.id,{title:l.value.title,todo_type:l.value.todo_type,todo_type_id:l.value.todo_type_id})}async function C(){var w,c;if(!y.value)k.value&&await ft(n.todo.id,k.value);else{const v=(w=r.value)!=null&&w.buildPayload?r.value.buildPayload():{...b.value};v.start_date||(v.start_date=((c=n.todo)==null?void 0:c.date)||n.date||W(new Date)),await vt(n.todo.id,v)}}const O=w=>{var c,v;return((v=(c=w==null?void 0:w.response)==null?void 0:c.data)==null?void 0:v.message)||(w==null?void 0:w.message)||"Something went wrong"};async function z(){const[w,c]=await Promise.allSettled([u(),C()]),v=w.status==="fulfilled",E=c.status==="fulfilled";E||(B.value=O(c.reason)),v&&E&&f("update")}const N=T(!1),B=T(!1);async function K(){var w;await t(),N.value=!0,await h(),N.value=!1,await G(),(w=a.value)==null||w.focus()}const A=U(()=>i.loading||N.value);return P(()=>{K()}),(w,c)=>(d(),m("div",{class:"relative",onClick:c[5]||(c[5]=v=>g.value=!1)},[A.value?(d(),M(H,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:L(()=>c[6]||(c[6]=[I(" Loading... ")])),_:1,__:[6]})):p("",!0),R(Z,{onSubmit:z,onClickCancel:c[4]||(c[4]=v=>f("cancelClick")),isSubmitting:s.value=="submitting",isLoading:A.value,id:"todoEditForm"},{error:L(()=>[e("div",null,[x(i).error?(d(),m("div",Qt,S(x(i).error),1)):p("",!0),B.value?(d(),m("div",Zt,S(B.value),1)):p("",!0)])]),default:L(()=>[c[10]||(c[10]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Edit Todo")],-1)),e("div",te,[c[9]||(c[9]=e("div",{class:"text-xs text-red-800 mb-6"},[e("strong",null,"Tips:"),I(" If you change the todo, it will change to all the concurrent dates ")],-1)),e("div",ee,[c[7]||(c[7]=e("label",{class:"block text-gray-500 font-medium text-sm"},"Title",-1)),q(e("input",{ref_key:"titleRef",ref:a,"onUpdate:modelValue":c[0]||(c[0]=v=>l.value.title=v),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 shadow-sm"},null,512),[[F,l.value.title]])]),e("div",oe,[c[8]||(c[8]=e("label",{class:"block text-gray-500 font-medium text-sm"},"Task ID (optional)",-1)),R(nt,{show:g.value,"onUpdate:show":c[1]||(c[1]=v=>g.value=v),todoType:l.value.todo_type,"onUpdate:todoType":c[2]||(c[2]=v=>l.value.todo_type=v),todoTypeId:l.value.todo_type_id,"onUpdate:todoTypeId":c[3]||(c[3]=v=>l.value.todo_type_id=v)},null,8,["show","todoType","todoTypeId"])])])]),_:1,__:[10]},8,["isSubmitting","isLoading"])]))}},se={class:"relative"},ae={class:"min-h-[10vh] max-h-[50vh] overflow-y-auto p-4"},de={class:"mb-4"},ne={class:"mb-4 flex justify-between items-end"},ie={key:0,class:"mt-1 flex items-center gap-2 mb-4"},re={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},ue={class:"flex items-center justify-between gap-4"},ce={key:0,class:"flex items-center gap-2"},me={class:"flex justify-between items-center gap-4 py-4 px-4 border-t"},ye={key:0,class:"ml-auto flex items-center gap-2"},fe={__name:"TodoShow",props:{todoDate:{type:Object,default:()=>{}}},emits:["cancelClick","clickEdit","update","clickAddTodoDate"],setup(o,{emit:D}){const n=o,s=st(),g=tt(),a=D;async function i(){var r;console.log({todo_date:"dd"}),await s.fetchTodoDate((r=n.todoDate)==null?void 0:r.id)}const f=U(()=>{var r,t;return(r=s.todo_date)!=null&&r.date?new Date((t=s.todo_date)==null?void 0:t.date):null}),l=U(()=>{var r,t,k;return((t=(r=s.todo_date)==null?void 0:r.user)==null?void 0:t.id)===((k=g.user)==null?void 0:k.id)});async function b(r){var t;confirm(`Are your sure want to delete todo
'${(t=s.todo_date)==null?void 0:t.title}'`)&&(await s.deleteTodoDate(r.id),a("update"))}async function y(r,t){var k;confirm(`Are your sure want to compete todo
'${(k=s.todo_date)==null?void 0:k.title}'`)&&(await s.updateStatus(r.id,t),a("update"))}return P(async()=>{await i()}),(r,t)=>{var k,h,u,C,O,z,N,B,K;return d(),m("div",se,[x(s).loading?(d(),M(H,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:L(()=>t[6]||(t[6]=[I(" Loading... ")])),_:1,__:[6]})):p("",!0),e("div",null,[t[13]||(t[13]=e("div",{class:"border-b py-2 px-4"},[e("h2",{class:"text-xl font-semibold"},"Show Todo")],-1)),e("div",ae,[e("div",de,[t[7]||(t[7]=e("div",{class:"font-semibold text-xs text-gray-500"},"Date",-1)),e("span",null,S(x(lt)(f.value,{weekDay:"long"})),1)]),e("div",ne,[e("div",null,[t[8]||(t[8]=e("div",{class:"text-xs text-gray-500"},"Todo",-1)),I(" "+S((k=x(s).todo_date)==null?void 0:k.title),1)]),e("button",{class:"btn-2 bg-sky-400 text-white hover:bg-sky-600 hover:text-white bg-none",onClick:t[0]||(t[0]=$(A=>{var V;return a("clickEdit",(V=x(s).todo_date)==null?void 0:V.todo)},["prevent","stop"]))},t[9]||(t[9]=[e("i",{class:"fas fa-pen"},null,-1),I(" Edit Todo ")]))]),(h=o.todoDate)!=null&&h.user?(d(),m("div",ie,[R(ot,{user:o.todoDate.user,"avatar-size":"xsmall"},null,8,["user"]),e("div",re,S((C=(u=o.todoDate.user)==null?void 0:u.department)==null?void 0:C.name),1)])):p("",!0),e("div",null,[t[12]||(t[12]=e("div",{class:"text-xs text-gray-500"},"Status",-1)),e("div",ue,[e("div",null,[(O=x(s))!=null&&O.todo_date?(d(),M(dt,{key:0,todoDate:(z=x(s))==null?void 0:z.todo_date},null,8,["todoDate"])):p("",!0),I(" "+S((N=x(s).todo_date)==null?void 0:N.status),1)]),l.value&&!x(s).loading?(d(),m("div",ce,[((B=x(s).todo_date)==null?void 0:B.status)==="PENDING"?(d(),m("button",{key:0,class:"btn-2 from-yellow-700 to-yellow-500 text-white hover:bg-green-600 hover:text-white",onClick:t[1]||(t[1]=$(()=>y(x(s).todo_date,"WORKING"),["prevent","stop"]))},t[10]||(t[10]=[e("i",{class:"fas fa-exclamation-circle"},null,-1),I(" Change to Working ")]))):p("",!0),((K=x(s).todo_date)==null?void 0:K.status)==="WORKING"?(d(),m("button",{key:1,class:"btn-2 from-green-700 to-green-300 text-white hover:bg-green-600 hover:text-white",onClick:t[2]||(t[2]=$(()=>y(x(s).todo_date,"COMPLETED"),["prevent","stop"]))},t[11]||(t[11]=[e("i",{class:"fas fa-check"},null,-1),I(" Make Complete ")]))):p("",!0)])):p("",!0)])])])]),e("div",me,[e("button",{type:"button",onClick:t[3]||(t[3]=A=>a("cancelClick")),class:"btn-3"},"Cancel"),l.value&&!x(s).loading?(d(),m("div",ye,[e("button",{class:"btn-2 bg-green-600 text-white hover:bg-green-700 hover:text-white bg-none",onClick:t[4]||(t[4]=$(A=>{var V,w;return a("clickAddTodoDate",(V=x(s).todo_date)==null?void 0:V.todo_id,(w=x(s).todo_date)==null?void 0:w.date)},["prevent","stop"]))},t[14]||(t[14]=[e("i",{class:"fas fa-plus"},null,-1),I(" Add To another date ")])),e("button",{class:"btn-2-red",onClick:t[5]||(t[5]=$(()=>b(x(s).todo_date),["prevent","stop"]))},t[15]||(t[15]=[e("i",{class:"fas fa-trash-alt"},null,-1),I(" Delete ")]))])):p("",!0)])])}}},Ce={__name:"TodoCreateEditShow",props:{todoModal:{type:Object,required:!0},userRole:{type:String,required:"employee"}},emits:["cancelClick","todoUpdate","todoDateUpdate","clickEdit","clickDelete","clickChangeStatus","clickAddTodoDate"],setup(o,{emit:D}){const n=D;function s(){n("todoUpdate")}function g(){n("todoDateUpdate")}return(a,i)=>(d(),m(X,null,[o.todoModal.action=="add"?(d(),M(_,{key:0},{default:L(()=>{var f,l,b,y;return[R(Kt,{onCancelClick:i[0]||(i[0]=r=>n("cancelClick")),onUpdate:s,date:(f=o.todoModal)==null?void 0:f.date,todoType:(l=o.todoModal)==null?void 0:l.todoType,todoTypeId:(b=o.todoModal)==null?void 0:b.todoTypeId,readonlyValues:((y=o.todoModal)==null?void 0:y.formReadonlyValues)||{},userRole:o.userRole},null,8,["date","todoType","todoTypeId","readonlyValues","userRole"])]}),_:1})):p("",!0),o.todoModal.action=="addDate"?(d(),M(_,{key:1},{default:L(()=>{var f,l,b;return[R(Yt,{onCancelClick:i[1]||(i[1]=y=>n("cancelClick")),onUpdate:g,date:(f=o.todoModal)==null?void 0:f.date,todoId:(l=o.todoModal)==null?void 0:l.todo_id,userRole:o.userRole,readonlyValues:((b=o.todoModal)==null?void 0:b.formReadonlyValues)||{}},null,8,["date","todoId","userRole","readonlyValues"])]}),_:1})):p("",!0),o.todoModal.action=="edit"?(d(),M(_,{key:2},{default:L(()=>{var f,l;return[R(le,{onCancelClick:i[2]||(i[2]=b=>n("cancelClick")),onUpdate:s,todo:(f=o.todoModal)==null?void 0:f.todo,userRole:o.userRole,readonlyValues:((l=o.todoModal)==null?void 0:l.formReadonlyValues)||{}},null,8,["todo","userRole","readonlyValues"])]}),_:1})):p("",!0),o.todoModal.action=="show"?(d(),M(_,{key:3},{default:L(()=>{var f;return[R(fe,{onCancelClick:i[3]||(i[3]=l=>n("cancelClick")),onUpdate:g,onClickEdit:i[4]||(i[4]=l=>n("clickEdit",l)),onClickAddTodoDate:i[5]||(i[5]=(...l)=>n("clickAddTodoDate",...l)),onClickDelete:i[6]||(i[6]=l=>n("clickDelete",l)),onClickChangeStatus:i[7]||(i[7]=(l,b)=>n("clickChangeStatus",l,b)),todoDate:(f=o.todoModal)==null?void 0:f.todo,userRole:o.userRole},null,8,["todoDate","userRole"])]}),_:1})):p("",!0)],64))}};export{De as _,Ce as a,dt as b};
