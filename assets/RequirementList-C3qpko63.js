import{L as Q}from"./LoaderView-BOE938Nu.js";import{_ as I}from"./DepartmentChip-CsQYiG0b.js";import{d as O,n as W,c as l,o,a as e,F as H,y as K,t as m,p,i as _,g as D,f as S,x as j,k as g,j as M,b as Y,m as A,r as X,e as J,A as E,h as Z,v as G,u as q}from"./index-Cyu8r00X.js";import{_ as C}from"./UserChip-KRy7AoyK.js";import{g as tt}from"./task-6pg35pI0.js";import{u as et}from"./company-Dl_P_6bu.js";import{_ as F}from"./CompanyDepartmentSelectInput-C8pigp_d.js";import{_ as st}from"./EmployeeDropdownInput-i01rPk28.js";import{S as ot}from"./SelectDropdown-BXA6PIO8.js";import{u as at}from"./useRequirementStore-DTjBe9d9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./url-CePbr-gY.js";import"./requirement-CLV27nrX.js";const lt={class:"min-w-full bg-white border overflow-hidden table table-fixed"},nt={key:0},it={class:"px-4 py-4 font-semibold text-xl text-gray-700 border border-gray-200 text-center"},dt={class:"px-4 py-4 min-w-[300px] md:min-w-[400px] border border-gray-200"},rt={class:"space-y-4"},mt={class:"text-blue-800"},ut=["title"],pt={key:0},ct={class:"flex gap-6 items-center mt-6"},xt={key:0,class:"text-gray-600 text-xs flex items-center gap-2 whitespace-nowrap"},yt={class:"flex items-center gap-2 whitespace-nowrap"},ft={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},bt=["title"],_t={class:"flex items-center gap-2 mt-4"},gt={key:1},vt={class:"flex items-center gap-2 mt-1"},wt={key:1},ht={key:0,class:"text-xs text-red-300"},kt={key:1,class:"italic text-xs text-gray-400"},Vt={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},Rt=["title"],At={class:"flex items-center gap-2 mt-4"},Dt={key:1},St={key:0,class:"text-xs text-red-300"},Tt={key:1,class:"italic text-xs text-gray-400"},Ct={class:"flex items-center gap-2 mt-2"},$t={key:1},Lt={key:0,class:"text-xs text-red-300"},Nt={key:1,class:"italic text-xs text-gray-400"},Mt={class:"px-4 py-4 text-center whitespace-nowrap border border-gray-200"},jt={key:0,class:"text-gray-600 text-sm"},Et={class:"mb-2 w-full flex flex-col justify-between items-start"},Ut={class:"mb-2 w-full flex flex-col justify-between items-start"},zt={class:"flex justify-between items-center gap-1"},Pt={key:1},Bt={class:"px-4 py-4 text-center border border-gray-200"},It={class:"flex gap-4 items-center justify-center"},Ft={key:0,class:"absolute inset-0 flex flex-col items-center justify-center bg-white bg-opacity-50"},Ot={class:"flex flex-col gap-2 items-center justify-center bg-gray-50 bg-opacity-70 hover:bg-opacity-90 p-6 border border-gray-100 rounded-md"},Ht={class:"text-sm flex items-center gap-2 text-red-400 font-semibold"},Kt={class:"mt-[2px]"},Yt={class:"text-gray-800 flex items-center gap-2"},Jt={class:"flex gap-4 items-center justify-center"},Qt={__name:"RequirementTable",props:{requirements:{type:Array,default:()=>[]}},setup($){const x=O();return(v,s)=>{var f;const c=W("RouterLink");return o(),l("table",lt,[s[22]||(s[22]=e("thead",{class:"bg-gray-100 text-gray-400 text-xs"},[e("tr",null,[e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap border w-[4%]"},"#"),e("th",{class:"px-4 py-0.5 text-left whitespace-nowrap border w-[60%]"},"Requirement"),e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"},"From Department"),e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"},"To Department"),e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"}),e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"},"Actions")])],-1)),e("tbody",null,[((f=$.requirements)==null?void 0:f.length)===0?(o(),l("tr",nt,s[4]||(s[4]=[e("td",{colspan:"10",class:"p-4"},[e("div",{class:"text-gray-500 italic w-full h-64 flex items-center justify-center"}," No Requirement Found ")],-1)]))):(o(!0),l(H,{key:1},K($.requirements,(t,d)=>{var n,r,w,u,L,h,T,N,y,a,k,V,R,i,U,z,P;return o(),l("tr",{key:t.id,class:"border-t hover:bg-blue-50 odd:bg-gray-50 group/item relative"},[e("td",it,m(d+1),1),e("td",dt,[e("div",rt,[p(c,{to:{name:"RequirementShow",params:{id:t==null?void 0:t.id}},class:"text-blue-600 text-sm hover:underline hover:text-blue-800 z-20"},{default:_(()=>{var b,B;return[e("div",mt,[e("div",{class:"line-clamp-1 font-semibold",title:t==null?void 0:t.title},m(t==null?void 0:t.title),9,ut)]),((b=t==null?void 0:t.details)==null?void 0:b.length)-1>0?(o(),l("span",pt,m(((B=t==null?void 0:t.details)==null?void 0:B.length)-1)+" More Requirement ",1)):D("",!0)]}),_:2},1032,["to"])]),e("div",ct,[t.created_at?(o(),l("div",xt,[s[5]||(s[5]=e("i",{class:"fas fa-clock text-sky-800/50"},null,-1)),e("div",null,m(new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})),1)])):D("",!0),e("div",yt,[s[6]||(s[6]=e("span",{class:"text-xs text-gray-500"},"By:",-1)),t.created_by?(o(),S(C,{key:0,user:t.created_by,"avatar-size":"xsmall"},null,8,["user"])):D("",!0)]),t.priority?(o(),l("span",{key:1,class:j(["font-semibold text-sm border rounded-full px-2",{"bg-yellow-50 text-yellow-700 border-yellow-700 ":t.priority=="IMPORTANT","bg-red-700 text-red-50 ":t.priority=="URGENT"}])},m(t.priority),3)):D("",!0)])]),e("td",ft,[e("span",{title:(n=t==null?void 0:t.from_department)==null?void 0:n.name,class:j([{"bg-green-500 text-white group-hover/item:text-white":((r=t==null?void 0:t.from_department)==null?void 0:r.id)==((u=(w=g(x))==null?void 0:w.user)==null?void 0:u.department_id)},"text-blue-500 font-semibold flex-shrink-0 border border-blue-500 bg-blue-50 rounded-full px-2 text-xs"])},m(((L=t==null?void 0:t.from_department)==null?void 0:L.short_name)||((h=t==null?void 0:t.from_department)==null?void 0:h.name)),11,bt),e("div",_t,[s[8]||(s[8]=e("div",{class:"text-xs text-gray-500"},"In Charge:",-1)),(T=t==null?void 0:t.from_department)!=null&&T.in_charge?(o(),S(C,{key:0,user:(N=t==null?void 0:t.from_department)==null?void 0:N.in_charge,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",gt,s[7]||(s[7]=[e("span",{class:"italic text-xs text-gray-400"},"N/A",-1)])))]),e("div",vt,[s[9]||(s[9]=e("div",{class:"text-xs text-gray-500"},"Coordinator:",-1)),t.from_coordinator?(o(),S(C,{key:0,user:t.from_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",wt,[(y=t==null?void 0:t.from_department)!=null&&y.coordinator_id?(o(),l("div",ht," Approval Pending ")):(o(),l("div",kt,"N/A"))]))])]),e("td",Vt,[e("span",{title:(a=t==null?void 0:t.to_department)==null?void 0:a.name,class:j([{"bg-sky-500 !text-white  ":((k=t==null?void 0:t.to_department)==null?void 0:k.id)==((R=(V=g(x))==null?void 0:V.user)==null?void 0:R.department_id)},"text-sky-500 font-semibold flex-shrink-0 border border-sky-500 bg-blue-50 rounded-full px-2 text-xs"])},m(((i=t==null?void 0:t.to_department)==null?void 0:i.short_name)||((U=t==null?void 0:t.to_department)==null?void 0:U.name)),11,Rt),e("div",At,[s[10]||(s[10]=e("div",{class:"text-xs text-gray-500"},"In Charge:",-1)),t.to_incharge?(o(),S(C,{key:0,user:t.to_incharge,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",Dt,[(z=t==null?void 0:t.to_department)!=null&&z.incharge_id?(o(),l("div",St," Approval Pending ")):(o(),l("div",Tt,"N/A"))]))]),e("div",Ct,[s[11]||(s[11]=e("div",{class:"text-xs text-gray-500"},"Coordinator:",-1)),t.to_coordinator?(o(),S(C,{key:0,user:t.to_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",$t,[(P=t==null?void 0:t.to_department)!=null&&P.coordinator_id?(o(),l("div",Lt," Approval Pending ")):(o(),l("div",Nt,"N/A"))]))])]),e("td",Mt,[t.submission_date?(o(),l("div",jt,[e("div",Et,[s[12]||(s[12]=e("span",{class:"text-xs font-bold"},"Submitted:",-1)),e("div",null,m(new Date(t.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))+" "+m(new Date(t.submission_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),e("div",Ut,[s[13]||(s[13]=e("span",{class:"text-xs font-bold"},"Better To Complete:",-1)),e("div",null,m(new Date(t.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))+" "+m(new Date(t.submission_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),e("div",zt,[s[14]||(s[14]=e("span",{class:"text-xs font-bold"},"Status:",-1)),e("span",{class:j(["border rounded-lg px-2 py-0.5 text-xs",{"bg-red-300 text-red-700 border-red-400":t.status!="approved","bg-green-300 text-green-700 border-green-400":t.status=="approved"}])},m(String(t.status).toUpperCase()),3)])])):(o(),l("div",Pt,"-"))]),e("td",Bt,[e("div",It,[p(c,{to:{name:"RequirementShow",params:{id:t==null?void 0:t.id}},class:"btn-2",onClick:s[0]||(s[0]=b=>b.stopPropagation())},{default:_(()=>s[15]||(s[15]=[e("i",{class:"fad fa-eye"},null,-1),M(" Show ")])),_:2,__:[15]},1032,["to"]),p(c,{to:{name:"RequirementEdit",params:{id:t==null?void 0:t.id}},class:"btn-4 border border-blue-500 hover:bg-blue-500 hover:text-white",onClick:s[1]||(s[1]=b=>b.stopPropagation())},{default:_(()=>s[16]||(s[16]=[e("i",{class:"fad fa-edit"},null,-1),M(" Edit ")])),_:2,__:[16]},1032,["to"])]),t.closed_at?(o(),l("div",Ft,[e("div",Ot,[e("div",Ht,[s[17]||(s[17]=e("span",{class:"fad fa-lock"},null,-1)),s[18]||(s[18]=e("span",{class:"mt-[2px]"},"CLOSED AT",-1)),e("span",Kt,m(new Date(t.closed_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),e("div",Yt,[s[19]||(s[19]=e("span",{class:"text-sm"},"Closed by",-1)),p(C,{user:t.closed_by_user,"avatar-size":"xsmall"},null,8,["user"])]),e("div",Jt,[p(c,{to:{name:"RequirementShow",params:{id:t==null?void 0:t.id}},class:"btn-2 h-6",onClick:s[2]||(s[2]=b=>b.stopPropagation())},{default:_(()=>s[20]||(s[20]=[e("i",{class:"fad fa-eye"},null,-1),M(" Show ")])),_:2,__:[20]},1032,["to"]),p(c,{to:{name:"RequirementEdit",params:{id:t==null?void 0:t.id}},class:"btn-4 h-6 border border-blue-500 hover:bg-blue-500 hover:text-white",onClick:s[3]||(s[3]=b=>b.stopPropagation())},{default:_(()=>s[21]||(s[21]=[e("i",{class:"fad fa-edit"},null,-1),M(" Edit ")])),_:2,__:[21]},1032,["to"])])])])):D("",!0)])])}),128))])])}}},Wt={class:"mb-3 task-header"},Xt={class:"flex flex-wrap items-center justify-center gap-2 mt-3"},Zt={class:"flex flex-wrap gap-x-4 gap-y-3 justify-between"},Gt={class:"relative"},qt=["title"],te={key:0},ee={key:1,class:"text-gray-500 whitespace-nowrap"},se={key:1,class:"relative w-full md:w-56 lg:flex-grow"},oe={class:"text-gray-600 w-full md:w-32 relative"},ae={__name:"RequirementHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup($,{emit:x}){const v=$,s=O(),c=Y(),f=A(h("company-id")),t=A(h("from-department-id")),d=A(h("to-department-id")),n=A(h("created-by")),r=A(h("month")),w=x,u=et(),L=X([]);function h(y){return{get:()=>v.modelValue[y]||"",set:a=>{w("update:modelValue",{...v.modelValue,[y]:a||void 0})}}}async function T(){var y,a,k;if(!v.isMyTask){const V=(y=v.modelValue)==null?void 0:y["company-id"],R=d.value,i={...V?{company_id:V}:{},...R?{department_ids:[R]}:{}};L.value=((k=(a=await tt({params:i}))==null?void 0:a.data)==null?void 0:k.employees)||[]}}J(async()=>{await u.fetchCompanies({with:"departments",ignore_permission:!0}),await u.fetchMyCompanies({with:"departments"}),await T()}),E(()=>d.value,T),E(()=>f.value,()=>{t.value="",d.value="",n.value="",T()});const N=A(()=>f.value?u==null?void 0:u.companies.filter(y=>y.id==f.value):u==null?void 0:u.companies);return(y,a)=>{var k,V,R;return o(),l("div",null,[e("div",Wt,[e("div",Xt,[e("div",Zt,[e("div",Gt,[p(ot,{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=i=>f.value=i),options:((k=g(u))==null?void 0:k.companies)||[],label:"name",id:"id",class:"border-2 border-gray-300 rounded h-[40px] w-full md:w-48 bg-white text-sm",clearable:""},{"selected-option":_(({option:i})=>[e("div",{class:"line-clamp-1 text-sm text-gray-900",title:i==null?void 0:i.name},[i!=null&&i.name?(o(),l("span",te,m(i==null?void 0:i.name),1)):(o(),l("span",ee,"--ALL COMPANY--"))],8,qt)]),_:1},8,["modelValue","options"]),a[5]||(a[5]=e("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Company ",-1))]),p(F,{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=i=>t.value=i),companies:N.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:_(()=>a[6]||(a[6]=[e("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),g(c).name!=="MyTaskList"?(o(),S(F,{key:0,modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=i=>d.value=i),companies:N.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:_(()=>a[7]||(a[7]=[e("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):D("",!0),g(s).isAdminMood&&((R=(V=g(s))==null?void 0:V.user)==null?void 0:R.role)!=="employee"?(o(),l("div",se,[p(st,{employees:L.value,modelValue:n.value,"onUpdate:modelValue":a[3]||(a[3]=i=>n.value=i),class:"border-2 border-gray-300 rounded h-[40px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),a[8]||(a[8]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Created By ",-1))])):D("",!0),e("div",oe,[a[9]||(a[9]=e("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),Z(e("input",{id:"month-filter","onUpdate:modelValue":a[4]||(a[4]=i=>r.value=i),type:"month",class:"h-10 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[G,r.value]])])])])])])}}},le={class:"container mx-auto"},ne={class:"bg-white shadow-md rounded-lg p-4"},ie={key:1,class:"text-center py-4 text-red-500"},de={class:"sticky top-14 z-40 text-gray-700 bg-gradient-to-tl from-sky-400/60 to-sky-400 py-2 px-4 flex items-center"},re={class:"font-semibold flex items-center gap-2"},me={class:"rounded-b-md overflow-x-auto border-x xl:border-x-0"},Ve={__name:"RequirementList",setup($){const x=at(),v=q(),s=Y(),c=A({get(){return{...s.query}},set(d){v.push({query:{...d}})}});J(()=>{console.log("Requirement List Mounted"),x.fetchRequirements(c.value)}),E(()=>({...c.value}),async function(d){x.fetchRequirements(d)});const f=()=>{v.push({name:"RequirementAdd"})},t=A(()=>(x.requirements||[]).reduce((d,n)=>{const r=`${n.from_department_id}-${n.to_department_id}`,w=d.find(u=>u.key==r);return w?w.requirements=[...w.requirements,n]:d.push({key:r,from_department:n.from_department,to_department:n.to_department,requirements:[n]}),d},[]));return(d,n)=>(o(),l("div",le,[e("div",{class:"flex justify-between items-center mb-6"},[n[1]||(n[1]=e("h2",{class:"text-2xl font-bold text-gray-800"},"Requirements",-1)),e("button",{onClick:f,class:"btn-1"},"Add Requirement")]),e("div",ne,[p(ae,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=r=>c.value=r),class:"mt-2 mb-6"},null,8,["modelValue"]),g(x).loading?(o(),S(Q,{key:0,class:"sm:min-h-64 lg:min-h-96 shadow-none flex items-center justify-center"},{default:_(()=>n[2]||(n[2]=[M(" Loading requirements... ")])),_:1,__:[2]})):g(x).error?(o(),l("div",ie,m(g(x).error),1)):(o(!0),l(H,{key:2},K(t.value,r=>(o(),l("div",{key:r.key,class:"mt-8 rounded-md border-2 border-sky-300"},[e("div",de,[e("div",re,[n[3]||(n[3]=e("span",{class:"text-white text-sm"},"From",-1)),p(I,{department:r.from_department},null,8,["department"]),n[4]||(n[4]=e("span",{class:"text-white text-sm"},"To",-1)),p(I,{department:r.to_department},null,8,["department"])])]),e("div",me,[p(Qt,{requirements:r.requirements},null,8,["requirements"])])]))),128))])]))}};export{Ve as default};
