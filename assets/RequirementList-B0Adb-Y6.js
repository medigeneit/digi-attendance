import{L as q}from"./LoaderView-y7dXlN9V.js";import{_ as H}from"./DepartmentChip-2OOemKLn.js";import{g as J,p as ee,c as o,o as a,a as e,F as E,e as z,s as k,t as r,k as h,d as b,m as v,b as B,j,n as _,f as Q,x as f,r as X,h as Z,q as F,w as te,l as G,P as se,v as ae,u as oe,A as le}from"./index-D75smV2Z.js";import{_ as U}from"./UserChip-DCYTYTge.js";import{g as ne}from"./task-Di7Z61ZN.js";import{u as W}from"./company-CA7p4VY7.js";import{_ as K}from"./CompanyDepartmentSelectInput-D53FPkJ-.js";import{_ as ie}from"./EmployeeDropdownInput-BeeMK6aa.js";import{_ as de}from"./SearchInput-ipKMkzIb.js";import{S as I}from"./SelectDropdown-GfrweoYk.js";import{b as Y}from"./datetime-y2WWmmYq.js";import{u as re}from"./useRequirementStore-dbBBHqkQ.js";import"./user-DtwxLauY.js";import"./url-Buz9GlSr.js";import"./requirement-DoRJz7Rj.js";const me={class:"min-w-full bg-white border table table-fixed"},ce={key:0},ue={class:"px-4 py-4 font-semibold text-xl text-gray-700 border border-gray-200 text-center"},pe={class:"px-4 py-4 min-w-[300px] md:min-w-[400px] border border-gray-200"},xe={class:"space-y-4"},_e={class:"text-xl mb-4 flex gap-4 md:justify-between items-center"},ye={class:"text-sky-800 font-bold hover:underline md:mr-auto"},be={key:0,class:"flex justify-center items-center gap-1 text-gray-600 mt-1",title:"Comments"},ge={class:"relative"},fe={class:"text-xs absolute top-1 left-1/2 -translate-x-1/2 font-semibold"},ve={class:"hidden md:inline"},he={class:"flex justify-center items-center gap-1"},we={class:"text-blue-800"},ke=["title"],$e={class:"text-gray-400 text-xs mt-4"},Ve=["title","innerHTML"],Te={key:0},De={class:"flex gap-6 items-center mt-4"},Ne={key:0,class:"text-gray-600 text-xs flex items-center gap-2 whitespace-nowrap"},Re={class:"flex items-center gap-2 whitespace-nowrap"},Ae={key:0,class:"flex gap-2 items-center bg-gray-50 bg-opacity-70 hover:bg-opacity-90 border-gray-100 rounded-md mt-1"},Ce={class:"text-sm flex items-center gap-2 text-red-400 font-semibold"},Se={class:"mt-[2px] whitespace-nowrap"},Le={class:"text-gray-800 flex items-center gap-2"},Me={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},Ue=["title"],je={class:"flex items-center gap-2 mt-4"},Be={key:1},Pe={class:"flex items-center gap-2 mt-3"},Ee={key:1},ze={key:0,class:"text-xs text-red-300"},Ie={key:1,class:"italic text-xs text-gray-400"},Fe={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},Oe=["title"],He={class:"flex items-center gap-2 mt-4"},Ge={key:1},Ke={key:0,class:"text-xs text-red-300"},Ye={key:1,class:"italic text-xs text-gray-400"},Je={class:"flex items-center gap-2 mt-3"},Qe={key:1},Xe={key:0,class:"text-xs text-red-300"},Ze={key:1,class:"italic text-xs text-gray-400"},We={class:"px-4 py-4 text-center whitespace-nowrap border border-gray-200"},qe={key:0,class:"text-gray-600 text-sm"},et={class:"mb-4 w-full flex flex-col justify-between items-start"},tt={class:"w-full flex flex-col justify-between items-start"},st={key:1},at={class:"px-4 py-2 md:py-4 text-center border border-gray-200 bg-sky-50 sm:sticky right-0"},ot={class:"flex gap-2 md:gap-4 items-center justify-center mt-3"};const lt={__name:"RequirementTable",props:{requirements:{type:Array,default:()=>[]}},setup(P){const u=J();return(C,l)=>{var x;const S=ee("RouterLink");return a(),o("table",me,[l[26]||(l[26]=e("thead",{class:"bg-gray-100 text-gray-400 text-xs"},[e("tr",null,[e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap border w-[4%]"},"#"),e("th",{class:"px-4 py-0.5 text-left whitespace-nowrap border w-[60%]"},"Requirement"),e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"},"From Department"),e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"},"To Department"),e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border"}),e("th",{class:"px-4 py-0.5 text-center whitespace-nowrap w-[12%] border bg-sky-50 sm:sticky right-0"})])],-1)),e("tbody",null,[((x=P.requirements)==null?void 0:x.length)===0?(a(),o("tr",ce,l[4]||(l[4]=[e("td",{colspan:"10",class:"p-4"},[e("div",{class:"text-gray-500 italic w-full h-64 flex items-center justify-center"}," No Requirement Found ")],-1)]))):(a(!0),o(E,{key:1},z(P.requirements,(t,$)=>{var T,L,M,c,n,g,y,m,i,p,V,D,w,d,N,R,A;return a(),o("tr",{key:t.id,class:k(["border-t hover:bg-blue-50 odd:bg-gray-50 group/item relative",{"*:bg-green-100":t.tasks_count>0&&t.completed_tasks_count===t.tasks_count}])},[e("td",ue,r($+1),1),e("td",pe,[e("div",xe,[b(S,{to:{name:"RequirementShow",params:{id:t==null?void 0:t.id}},class:"text-blue-600 hover:text-blue-800 z-20"},{default:v(()=>{var s,O;return[e("div",_e,[e("span",ye,r(t==null?void 0:t.id),1),t.comments_count>0?(a(),o("div",be,[e("div",ge,[l[5]||(l[5]=e("i",{class:"far fa-comment-alt"},null,-1)),e("span",fe,r(t.comments_count),1)])])):h("",!0),e("div",{class:k(["whitespace-nowrap text-sm",[{"text-green-700 font-semibold":t.tasks_count>0&&t.completed_tasks_count==t.tasks_count,"text-red-700 font-semibold":t.tasks_count==0||t.completed_tasks_count!=t.tasks_count}]])},[B(r(t.completed_tasks_count)+"/"+r(t.tasks_count)+" ",1),e("span",ve," task"+r(t.completed_tasks_count!==1?"s":""),1),l[6]||(l[6]=e("span",null," done",-1))],2),e("div",he,[e("span",{class:k(["border rounded-lg px-2 py-0.5 text-xs",{"bg-red-300 text-red-700 border-red-400":t.status!="approved","bg-green-300 text-green-700 border-green-400":t.status=="approved"}])},r(String(t.status).toUpperCase()),3)])]),e("div",we,[e("div",{class:"line-clamp-2 font-semibold hover:underline",title:t==null?void 0:t.title},r(t==null?void 0:t.title),9,ke)]),e("div",$e,[e("div",{class:"line-clamp-2",title:t==null?void 0:t.description,innerHTML:t==null?void 0:t.description},null,8,Ve)]),((s=t==null?void 0:t.details)==null?void 0:s.length)-1>0?(a(),o("span",Te,r(((O=t==null?void 0:t.details)==null?void 0:O.length)-1)+" More Requirement ",1)):h("",!0)]}),_:2},1032,["to"])]),e("div",De,[t.created_at?(a(),o("div",Ne,[l[7]||(l[7]=e("i",{class:"fas fa-clock text-sky-800/50"},null,-1)),e("div",null,r(new Date(t.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})),1)])):h("",!0),e("div",Re,[l[8]||(l[8]=e("span",{class:"text-xs text-gray-500"},"By:",-1)),t.created_by?(a(),j(U,{key:0,"show-details-on-avatar-hover":_(u).isAdminMood,user:t.created_by,"avatar-size":"xsmall"},null,8,["show-details-on-avatar-hover","user"])):h("",!0)]),t.priority?(a(),o("span",{key:1,class:k(["font-semibold text-sm border rounded-full px-2",{"bg-yellow-50 text-yellow-700 border-yellow-700 ":t.priority=="IMPORTANT","bg-red-700 text-red-50 ":t.priority=="URGENT"}])},r(t.priority),3)):h("",!0)]),t.closed_at?(a(),o("div",Ae,[e("div",Ce,[l[9]||(l[9]=e("span",{class:"fad fa-lock"},null,-1)),l[10]||(l[10]=e("span",{class:"mt-[2px] whitespace-nowrap mr-2"},"CLOSED AT",-1)),e("span",Se,r(new Date(t.closed_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),e("div",Le,[l[11]||(l[11]=e("span",{class:"text-sm whitespace-nowrap"},"Closed by",-1)),b(U,{user:t.closed_by_user,"avatar-size":"xsmall"},null,8,["user"])])])):h("",!0)]),e("td",Me,[e("span",{title:(T=t==null?void 0:t.from_department)==null?void 0:T.name,class:k([{"bg-green-500 text-white group-hover/item:text-white":((L=t==null?void 0:t.from_department)==null?void 0:L.id)==((c=(M=_(u))==null?void 0:M.user)==null?void 0:c.department_id)},"text-blue-500 font-semibold flex-shrink-0 border border-blue-500 bg-blue-50 rounded-full px-2 text-xs"])},r(((n=t==null?void 0:t.from_department)==null?void 0:n.short_name)||((g=t==null?void 0:t.from_department)==null?void 0:g.name)),11,Ue),e("div",je,[l[13]||(l[13]=e("div",{class:"text-xs text-gray-500 w-16 mr-1"},"In Charge:",-1)),(y=t==null?void 0:t.from_department)!=null&&y.in_charge?(a(),j(U,{key:0,"show-details-on-avatar-hover":_(u).isAdminMood,user:(m=t==null?void 0:t.from_department)==null?void 0:m.in_charge,"avatar-size":"xsmall"},null,8,["show-details-on-avatar-hover","user"])):(a(),o("div",Be,l[12]||(l[12]=[e("span",{class:"italic text-xs text-gray-400"},"N/A",-1)])))]),e("div",Pe,[l[14]||(l[14]=e("div",{class:"text-xs text-gray-500 w-16 mr-1"},"Coordinator:",-1)),t.from_coordinator?(a(),j(U,{key:0,"show-details-on-avatar-hover":_(u).isAdminMood,user:t.from_coordinator,"avatar-size":"xsmall"},null,8,["show-details-on-avatar-hover","user"])):(a(),o("div",Ee,[(i=t==null?void 0:t.from_department)!=null&&i.coordinator_id?(a(),o("div",ze," Approval Pending ")):(a(),o("div",Ie,"N/A"))]))])]),e("td",Fe,[e("span",{title:(p=t==null?void 0:t.to_department)==null?void 0:p.name,class:k([{"bg-sky-500 !text-white  ":((V=t==null?void 0:t.to_department)==null?void 0:V.id)==((w=(D=_(u))==null?void 0:D.user)==null?void 0:w.department_id)},"text-sky-500 font-semibold flex-shrink-0 border border-sky-500 bg-blue-50 rounded-full px-2 text-xs"])},r(((d=t==null?void 0:t.to_department)==null?void 0:d.short_name)||((N=t==null?void 0:t.to_department)==null?void 0:N.name)),11,Oe),e("div",He,[l[15]||(l[15]=e("div",{class:"text-xs text-gray-500 w-16 mr-1"},"In Charge:",-1)),t.to_incharge?(a(),j(U,{key:0,"show-details-on-avatar-hover":_(u).isAdminMood,user:t.to_incharge,"avatar-size":"xsmall"},null,8,["show-details-on-avatar-hover","user"])):(a(),o("div",Ge,[(R=t==null?void 0:t.to_department)!=null&&R.incharge_id?(a(),o("div",Ke," Approval Pending ")):(a(),o("div",Ye,"N/A"))]))]),e("div",Je,[l[16]||(l[16]=e("div",{class:"text-xs text-gray-500 w-16 mr-1"},"Coordinator:",-1)),t.to_coordinator?(a(),j(U,{key:0,"show-details-on-avatar-hover":_(u).isAdminMood,user:t.to_coordinator,"avatar-size":"xsmall"},null,8,["show-details-on-avatar-hover","user"])):(a(),o("div",Qe,[(A=t==null?void 0:t.to_department)!=null&&A.coordinator_id?(a(),o("div",Xe," Approval Pending ")):(a(),o("div",Ze,"N/A"))]))])]),e("td",We,[t.submission_date?(a(),o("div",qe,[e("div",et,[l[17]||(l[17]=e("span",{class:"text-xs font-bold"},"Submitted:",-1)),e("div",null,r(new Date(t.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))+" "+r(new Date(t.submission_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})),1)]),e("div",tt,[l[18]||(l[18]=e("span",{class:"text-xs font-bold"},"Better To Complete:",-1)),e("div",null,r(new Date(t.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),1)])])):(a(),o("div",st,"-"))]),e("td",at,[e("div",ot,[b(S,{to:{name:"RequirementShow",params:{id:t==null?void 0:t.id}},class:"btn-2 px-4",onClick:l[0]||(l[0]=s=>s.stopPropagation())},{default:v(()=>l[19]||(l[19]=[e("i",{class:"fad fa-eye"},null,-1)])),_:2,__:[19]},1032,["to"]),b(S,{to:{name:"RequirementEdit",params:{id:t==null?void 0:t.id}},class:"btn-4 px-4 border border-blue-500 hover:bg-blue-500 hover:text-white",onClick:l[1]||(l[1]=s=>s.stopPropagation())},{default:v(()=>l[20]||(l[20]=[e("i",{class:"fad fa-edit"},null,-1)])),_:2,__:[20]},1032,["to"])]),(t.closed_at,h("",!0))])],2)}),128))])])}}},nt={class:"flex flex-col sm:flex-row flex-wrap items-start w-full gap-2"},it={class:"w-full sm:w-auto flex items-center gap-4"},dt={class:"grid xl:flex grid-cols-1 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-4 md:ml-auto flex-wrap items-center justify-center gap-x-4 gap-y-3 w-full lg:w-auto"},rt={class:"relative"},mt={class:"text-xs"},ct=["title"],ut={key:1},pt={class:"w-36 my-0.5"},xt={class:"text-xs"},_t=["user","title"],yt={class:"text-sky-500 font-semibold mr-1"},bt={key:1,class:"text-gray-600"},gt={class:"text-xs"},ft=["user","title"],vt={class:"text-sky-500 font-semibold"},ht={key:1,class:"text-gray-600"},wt={key:1,class:"relative"},kt={class:"text-xs"},$t={key:0,class:"flex items-center gap-1 overflow-hidden text-xs"},Vt={key:1,class:"text-gray-600"},Tt={class:"relative"},Dt={class:"text-xs"},Nt=["user"],Rt={key:1},At={class:"relative"},Ct={class:"text-xs"},St=["user"],Lt={key:1},Mt={class:"flex items-center text-xs gap-1 text-gray-600 relative rounded h-8 border border-gray-300 bg-white px-2"},Ut={class:"!text-sm flex text-gray-600 relative rounded h-8 border border-gray-300 bg-white pl-2 md:col-span-2 lg:col-span-1"},jt={class:"mt-4 flex-col lg:flex-row flex lg:items-end"},Bt={__name:"RequirementHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask","clickAdd"],setup(P,{emit:u}){const C=P,l=J(),S=Q(),x=f(p("company-id")),t=f(p("from-department-id")),$=f(p("to-department-id")),T=f(p("created-by")),L=f(p("month")),M=f(p("priority")),c=f(p("status")),n=f(p("is-closed")),g=f(p("search")),y=u,m=W(),i=X([]);function p(w){return{get:()=>C.modelValue[w]||"",set:d=>{y("update:modelValue",{...C.modelValue,[w]:d||void 0})}}}async function V(){var w,d,N;if(!C.isMyTask){const R=(w=C.modelValue)==null?void 0:w["company-id"],A=$.value,s={...R?{company_id:R}:{},...A?{department_ids:[A]}:{}};i.value=((N=(d=await ne({params:s}))==null?void 0:d.data)==null?void 0:N.employees)||[]}}Z(async()=>{await m.fetchCompanies({with:"departments",ignore_permission:!0}),await m.fetchMyCompanies({with:"departments"}),await V()}),F(()=>$.value,V),F(()=>x.value,()=>{t.value="",$.value="",T.value="",V()});const D=f(()=>x.value?m==null?void 0:m.companies.filter(w=>w.id==x.value):m==null?void 0:m.companies);return(w,d)=>{var N,R,A;return a(),o("div",null,[e("div",nt,[e("div",it,[d[11]||(d[11]=e("h2",{class:"text-lg 2xl:text-2xl font-bold text-gray-800"},"Requirements",-1)),e("button",{onClick:d[0]||(d[0]=te(s=>y("clickAdd"),["prevent"])),class:"btn-icon size-7 border-gray-400"},d[10]||(d[10]=[e("i",{class:"fas fa-plus text-sm"},null,-1)]))]),e("div",dt,[e("div",rt,[b(I,{modelValue:x.value,"onUpdate:modelValue":d[1]||(d[1]=s=>x.value=s),options:((N=_(m))==null?void 0:N.companies)||[],label:"name",id:"id",class:"border border-gray-300 rounded h-8 bg-white !text-sm",clearable:""},{"selected-option":v(({option:s})=>[e("span",mt,[s?(a(),o("span",{key:0,title:s==null?void 0:s.name,class:"max-w-28 line-clamp-1 text-sky-500 font-semibold"},r(s==null?void 0:s.name),9,ct)):(a(),o("span",ut,"Company"))])]),option:v(({option:s})=>[e("div",pt,r(s.name),1)]),_:1},8,["modelValue","options"])]),b(K,{modelValue:t.value,"onUpdate:modelValue":d[2]||(d[2]=s=>t.value=s),companies:D.value||[],class:"relative",className:{select:"border border-gray-300 rounded h-8 bg-white !text-sm"},defaultOption:"--ALL DEPARTMENT--"},{label:v(()=>d[12]||(d[12]=[e("span",null,null,-1)])),selectedOption:v(({option:s})=>[e("span",xt,[s?(a(),o("span",{key:0,user:s,"avatar-size":"xsmall",class:"max-w-28 line-clamp-1",title:s==null?void 0:s.name},[d[13]||(d[13]=e("span",{class:"text-gray-400"},"From:",-1)),e("span",yt,r((s==null?void 0:s.short_name)||(s==null?void 0:s.name)),1)],8,_t)):(a(),o("span",bt,"--From Department--"))])]),_:1},8,["modelValue","companies"]),_(S).name!=="MyTaskList"?(a(),j(K,{key:0,modelValue:$.value,"onUpdate:modelValue":d[3]||(d[3]=s=>$.value=s),companies:D.value||[],class:"relative",className:{select:"border border-gray-300 rounded h-8 bg-white !text-sm"},defaultOption:"--ALL DEPARTMENT--"},{label:v(()=>d[14]||(d[14]=[e("span",null,null,-1)])),selectedOption:v(({option:s})=>[e("span",gt,[s?(a(),o("span",{key:0,user:s,"avatar-size":"xsmall",class:"max-w-28 line-clamp-1",title:s==null?void 0:s.name},[d[15]||(d[15]=e("span",{class:"text-gray-400 mr-1"},"To:",-1)),e("span",vt,r((s==null?void 0:s.short_name)||(s==null?void 0:s.name)),1)],8,ft)):(a(),o("span",ht,"--To Department--"))])]),_:1},8,["modelValue","companies"])):h("",!0),_(l).isAdminMood&&((A=(R=_(l))==null?void 0:R.user)==null?void 0:A.role)!=="employee"?(a(),o("div",wt,[b(ie,{employees:i.value,modelValue:T.value,"onUpdate:modelValue":d[4]||(d[4]=s=>T.value=s),class:"border border-gray-300 rounded h-8 bg-white w-full lg:max-w-64 !text-sm"},{selectedOption:v(({option:s})=>[e("span",kt,[s?(a(),o("span",$t,[d[16]||(d[16]=e("span",{class:"text-gray-400"},"User: ",-1)),b(U,{user:s,"avatar-size":"xsmall",class:"inline"},null,8,["user"])])):(a(),o("span",Vt,"--All Employee--"))])]),_:1},8,["employees","modelValue"])])):h("",!0),e("div",Tt,[b(I,{modelValue:M.value,"onUpdate:modelValue":d[5]||(d[5]=s=>M.value=s),searchable:!1,clearable:!0,options:[{label:"Normal",id:"normal"},{label:"IMPORTANT",id:"IMPORTANT"},{label:"URGENT",id:"URGENT"}],class:"border border-gray-300 rounded h-8 bg-white !text-sm"},{"selected-option":v(({option:s})=>[e("span",Dt,[s?(a(),o("span",{key:0,user:s,"avatar-size":"xsmall",class:"max-w-28 line-clamp-1 text-sky-500 font-semibold"},r(s==null?void 0:s.label),9,Nt)):(a(),o("span",Rt,"--Any Priority--"))])]),_:1},8,["modelValue"])]),e("div",At,[b(I,{modelValue:c.value,"onUpdate:modelValue":d[6]||(d[6]=s=>c.value=s),searchable:!1,clearable:!0,options:[{label:"Pending",id:"pending"},{label:"Approved",id:"approved"},{label:"Rejected",id:"rejected"}],class:"border border-gray-300 rounded h-8 bg-white !text-sm"},{"selected-option":v(({option:s})=>[e("span",Ct,[s?(a(),o("span",{key:0,user:s,"avatar-size":"xsmall",class:"max-w-28 line-clamp-1 text-sky-500 font-semibold"},r(s==null?void 0:s.label),9,St)):(a(),o("span",Lt,"--ALL Status--"))])]),_:1},8,["modelValue"])]),e("div",null,[e("label",Mt,[G(e("input",{type:"checkbox",class:"size-[15px]","onUpdate:modelValue":d[7]||(d[7]=s=>n.value=s)},null,512),[[se,n.value]]),e("span",{class:k(["font-semibold",[n.value?"text-sky-500 font-semibold":""]])},"Is Closed",2)])]),e("div",Ut,[d[17]||(d[17]=e("label",{class:"top-2 bottom-2 left-2 flex items-center text-xs text-gray-500 mr-1",for:"month-filter"}," Month: ",-1)),G(e("input",{id:"month-filter","onUpdate:modelValue":d[8]||(d[8]=s=>L.value=s),type:"month",class:k(["rounded h-full !text-xs w-full appearance-none text-gray-800 font-semibold outline-none pr-1",[n.value?"text-sky-500 font-semibold":""]]),placeholder:"All month"},null,2),[[ae,L.value]])])])]),e("div",jt,[d[18]||(d[18]=e("div",{class:"text-sm text-gray-700 mb-4 lg:mb-0"},"Showing requirements",-1)),b(de,{modelValue:g.value,"onUpdate:modelValue":d[9]||(d[9]=s=>g.value=s),class:"lg:ml-auto !border !border-gray-300 w-full lg:w-96 h-[40px] px-4",placeholder:"Search requirements ",label:null},null,8,["modelValue"])])])}}},Pt={class:"bg-white shadow-md rounded-lg p-4"},Et={key:1,class:"text-center py-4 text-red-500"},zt={key:2,class:"text-center py-4 text-gray-500 min-h-[50vh] flex items-center justify-center border rounded-md"},It={key:3,class:"space-y-6"},Ft={class:"sticky top-14 z-40 text-gray-700 bg-gradient-to-tl from-sky-400/60 to-sky-400 py-2 px-4 flex items-center"},Ot={class:"font-semibold flex items-center gap-2"},Ht={class:"flex items-center gap-2 ml-auto"},Gt=["onClick"],Kt={class:"border rounded text-sm px-2 text-white bg-sky-600"},Yt={class:"hidden md:inline"},Jt={class:"rounded-b-md overflow-x-auto border-x xl:border-x-0"},Qt={key:0,class:"hidden print:block bg-white text-black p-8 font-serif leading-relaxed"},Xt={class:"border-b-2 border-gray-800 pb-4 mb-6"},Zt={class:"flex justify-between items-start"},Wt={class:"text-sm text-gray-600 mt-1"},qt={class:"font-semibold"},es={class:"text-right"},ts={class:"bg-gray-100 px-3 py-1 rounded text-xl"},ss={class:"grid grid-cols-2 gap-x-12 gap-y-4 mb-4 text-sm border-b pb-4"},as={class:"flex justify-between border-b border-gray-100 pb-1"},os={class:"font-medium text-right"},ls={class:"flex justify-between border-b border-gray-100 pb-1"},ns={class:"font-medium text-right"},is={key:0,class:"flex flex-wrap gap-x-8 gap-y-2 mb-8 text-xs bg-gray-50 p-2 rounded border border-dashed border-gray-300"},ds={class:"text-gray-500 font-bold uppercase"},rs={class:"font-semibold"},ms={class:"space-y-12"},cs={class:"flex justify-between items-start gap-4 mb-6"},us={class:"flex items-start gap-4"},ps={class:"flex flex-col items-center"},xs={class:"text-2xl font-bold text-gray-800 leading-none mb-1"},_s={class:"text-xs font-mono text-indigo-700 bg-indigo-50 px-1 rounded"},ys={class:"text-xl font-bold leading-tight"},bs={class:"flex gap-4 mt-1 text-sm text-gray-500"},gs={class:"flex flex-col items-end gap-2"},fs={class:"grid grid-cols-2 gap-x-12 gap-y-4 mb-6 text-sm"},vs={class:"space-y-2"},hs={class:"flex justify-between border-b border-gray-100 pb-1"},ws={class:"font-medium text-right"},ks={class:"space-y-2"},$s={class:"flex justify-between border-b border-gray-100 pb-1"},Vs={class:"font-bold"},Ts={class:"text-indigo-700"},Ds={key:0,class:"mt-4"},Ns=["innerHTML"],Hs={__name:"RequirementList",setup(P){const u=re(),C=W(),l=oe(),S=Q(),x=X(null),t=f({get(){return{...S.query}},set(c){l.push({query:{...c}})}}),$=f(()=>{var n,g,y;const c=[];if(t.value.status&&c.push({label:"Status",value:t.value.status.toUpperCase()}),t.value.priority&&c.push({label:"Priority",value:t.value.priority.toUpperCase()}),t.value.month){const[m,i]=t.value.month.split("-"),p=new Date(m,i-1);c.push({label:"Month",value:p.toLocaleDateString("en-US",{month:"short",year:"numeric"})})}if(t.value["company-id"]){const m=C.companies.find(i=>i.id==t.value["company-id"]);c.push({label:"Company",value:(m==null?void 0:m.name)||t.value["company-id"]})}if(t.value["created-by"]){const m=u.requirements.find(i=>{var p;return((p=i.created_by)==null?void 0:p.id)==t.value["created-by"]});c.push({label:"Created By",value:((n=m==null?void 0:m.created_by)==null?void 0:n.name)||`User ID: ${t.value["created-by"]}`})}if(t.value["from-department-id"]){const m=(g=u.requirements.find(i=>i.from_department_id==t.value["from-department-id"]))==null?void 0:g.from_department;m&&c.push({label:"Filter From Dept",value:m.name})}if(t.value["to-department-id"]){const m=(y=u.requirements.find(i=>i.to_department_id==t.value["to-department-id"]))==null?void 0:y.to_department;m&&c.push({label:"Filter To Dept",value:m.name})}return t.value["is-closed"]&&c.push({label:"Include Closed",value:"Yes"}),t.value.search&&c.push({label:"Keywords",value:t.value.search}),c});Z(()=>{console.log("Requirement List Mounted"),u.fetchRequirements(t.value)}),F(()=>({...t.value}),async function(c){u.fetchRequirements(c)});const T=()=>{l.push({name:"RequirementAdd"})},L=async c=>{x.value=c,await le(),window.print(),x.value=null},M=f(()=>(u.requirements||[]).reduce((c,n)=>{const g=`${n.from_department_id}-${n.to_department_id}`,y=c.find(m=>m.key==g);return y?y.requirements=[...y.requirements,n]:c.push({key:g,from_department:n.from_department,to_department:n.to_department,requirements:[n]}),c},[]));return(c,n)=>{var g,y,m;return a(),o(E,null,[e("div",{class:k(["container mx-auto",{"print:hidden":!!x.value}])},[e("div",Pt,[b(Bt,{modelValue:t.value,"onUpdate:modelValue":n[0]||(n[0]=i=>t.value=i),onClickAdd:T,class:"mb-2"},null,8,["modelValue"]),_(u).loading?(a(),j(q,{key:0,class:"sm:min-h-64 lg:min-h-96 shadow-none flex items-center justify-center"},{default:v(()=>n[1]||(n[1]=[B(" Loading requirements... ")])),_:1,__:[1]})):_(u).error?(a(),o("div",Et,r(_(u).error),1)):((g=_(u).requirements)==null?void 0:g.length)===0?(a(),o("div",zt," No Requirements ")):(a(),o("div",It,[(a(!0),o(E,null,z(M.value,i=>(a(),o("div",{key:i.key,class:"rounded-md border-2 border-sky-300"},[e("div",Ft,[e("div",Ot,[n[2]||(n[2]=e("span",{class:"text-white text-sm"},"From",-1)),b(H,{department:i.from_department,shortName:!0},null,8,["department"]),n[3]||(n[3]=e("span",{class:"text-white text-sm"},"To",-1)),b(H,{department:i.to_department,shortName:!0},null,8,["department"])]),e("div",Ht,[e("button",{onClick:p=>L(i),class:"border rounded text-sm px-2 py-0.5 text-white bg-sky-700 hover:bg-sky-800 transition-colors",title:"Print Group"},n[4]||(n[4]=[e("i",{class:"fas fa-print mr-1"},null,-1),B(" PRINT ")]),8,Gt),e("div",Kt,[B(r(i.requirements.length)+" ",1),e("span",Yt," requirement"+r(i.requirements.length>1?"s":""),1)])])]),e("div",Jt,[b(lt,{requirements:i.requirements},null,8,["requirements"])])]))),128))]))])],2),x.value?(a(),o("div",Qt,[e("div",Xt,[e("div",Zt,[e("div",null,[n[6]||(n[6]=e("h1",{class:"text-xl font-bold uppercase tracking-wider"},"Requirement Report",-1)),e("p",Wt,[n[5]||(n[5]=B(" Generated on ")),e("span",qt,r(_(Y)(new Date)),1)])]),e("div",es,[e("div",ts,[n[7]||(n[7]=e("span",{class:"font-bold"},"Total Requirements:",-1)),B(" "+r(x.value.requirements.length),1)])])])]),e("div",ss,[e("div",as,[n[8]||(n[8]=e("span",{class:"text-gray-500 font-semibold whitespace-nowrap"},"From Department:",-1)),e("span",os,r((y=x.value.from_department)==null?void 0:y.name),1)]),e("div",ls,[n[9]||(n[9]=e("span",{class:"text-gray-500 font-semibold whitespace-nowrap"},"To Department:",-1)),e("span",ns,r((m=x.value.to_department)==null?void 0:m.name),1)])]),$.value.length>0?(a(),o("div",is,[(a(!0),o(E,null,z($.value,i=>(a(),o("div",{key:i.label,class:"flex gap-2"},[e("span",ds,r(i.label)+":",1),e("span",rs,r(i.value),1)]))),128))])):h("",!0),e("div",ms,[(a(!0),o(E,null,z(x.value.requirements,(i,p)=>{var V,D;return a(),o("div",{key:i.id,class:"border-b-2 border-dashed border-gray-300 pb-12 last:border-0 break-inside-avoid"},[e("div",cs,[e("div",us,[e("div",ps,[e("div",xs,r(String(p+1).padStart(2,"0")),1),e("div",_s," #"+r(i.id),1)]),e("div",null,[e("h2",ys,r(i.title),1),e("div",bs,[e("span",null,"By: "+r((V=i.created_by)==null?void 0:V.name),1),e("span",null,"At: "+r(_(Y)(i.created_at)),1)])])]),e("div",gs,[e("div",{class:k(["text-sm font-semibold uppercase px-2 py-0.5 rounded border",i.status==="approved"?"bg-green-100 border-green-400 text-green-800":"bg-yellow-100 border-yellow-400 text-yellow-800"])},r(i.status||"PENDING"),3),i.priority?(a(),o("div",{key:0,class:k(["px-2 py-0.5 rounded text-xs font-bold border uppercase",{"bg-red-600 text-white border-red-700":i.priority==="URGENT","bg-yellow-100 text-yellow-800 border-yellow-300":i.priority==="IMPORTANT"}])},r(i.priority),3)):h("",!0)])]),e("div",fs,[e("div",vs,[e("div",hs,[n[10]||(n[10]=e("span",{class:"text-gray-500 font-semibold uppercase text-xs"},"Supervisor:",-1)),e("span",ws,r(((D=i.supervisor)==null?void 0:D.name)||"N/A"),1)])]),e("div",ks,[e("div",$s,[n[12]||(n[12]=e("span",{class:"text-gray-500 font-semibold uppercase text-xs"},"Tasks Done:",-1)),e("div",Vs,[e("span",Ts,r(i.completed_tasks_count),1),n[11]||(n[11]=e("span",{class:"text-gray-400 mx-1"},"/",-1)),e("span",null,r(i.tasks_count),1)])])])]),i.description?(a(),o("div",Ds,[n[13]||(n[13]=e("h3",{class:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-2 border-b"}," Detailed Description ",-1)),e("div",{innerHTML:i.description,class:"prose prose-sm max-w-none text-gray-800 text-sm"},null,8,Ns)])):h("",!0)])}),128))])])):h("",!0)],64)}}};export{Hs as default};
