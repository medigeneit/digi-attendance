import{u as S}from"./holiday-DU_dSZX4.js";import{r as f,G as V,x as E,q as F,h as D,c as m,j as U,o as y,a as e,t as c,w as q,k as p,v as x,H as A,d as b,Q as N,m as w,F as j,e as L}from"./index-BkGzuPlq.js";import{_ as B}from"./MultiselectDropdown-BT1SNRYK.js";import{u as T}from"./company-C1FeCLAF.js";import{_ as O}from"./DeleteModal-D7TSEHIQ.js";import{_ as Y}from"./HeaderWithButtons-GWNJ4uuU.js";import{L as z}from"./LoaderView-C3NdoaC7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G={key:0,class:"modal-bg"},I={class:"modal-card"},Q={class:"text-lg font-semibold"},J={class:""},K={class:""},P={class:""},R={class:""},W={class:""},X={class:""},Z={class:"flex justify-end"},ee={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},te={__name:"HolidayModal",props:{show:{type:Boolean,required:!0},holiday:{type:Object,default:null}},emits:["close","save"],setup(g,{emit:a}){const r=g,u=a,i=f([]),l=f(!1),s=V({id:null,year:new Date().getFullYear(),name:"",start_date:"",end_date:"",type:"government",description:"",company_id:null,company_ids:[]});s.company_ids=E(()=>i.value.filter(d=>d==null?void 0:d.id).map(d=>d.id));const h=T(),v=f([]),k=()=>{l.value=!1,s.id=null,s.year=new Date().getFullYear(),s.name="",s.start_date="",s.end_date="",s.type="government",s.description="",s.company_id=null};F(()=>r.holiday,d=>{d?(l.value=!0,Object.assign(s,d),i.value=v.value.find(t=>t.id==d.company_id)):k()},{immediate:!0,deep:!0});const H=()=>{u("save",{...s}),_()},_=()=>{u("close")};return D(async()=>{await h.fetchCompanies(),v.value=[{id:null,name:"All"},...h.companies]}),(d,t)=>g.show?(y(),m("div",G,[e("div",I,[e("h2",Q,c(l.value?"Edit Holiday":"Add Holiday"),1),e("form",{onSubmit:q(H,["prevent"]),class:"space-y-2"},[e("div",J,[t[7]||(t[7]=e("label",{for:"year",class:"block text-sm font-medium"},"Year",-1)),p(e("input",{id:"year","onUpdate:modelValue":t[0]||(t[0]=o=>s.year=o),type:"number",class:"w-full border rounded px-3 py-2",placeholder:"Enter year",required:""},null,512),[[x,s.year]])]),e("div",K,[t[8]||(t[8]=e("label",{for:"name",class:"block text-sm font-medium"},"Name",-1)),p(e("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=o=>s.name=o),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter holiday name",required:""},null,512),[[x,s.name]])]),e("div",P,[t[9]||(t[9]=e("label",{for:"start_date",class:"block text-sm font-medium"},"Start Date",-1)),p(e("input",{id:"start_date","onUpdate:modelValue":t[2]||(t[2]=o=>s.start_date=o),type:"date",class:"w-full border rounded px-3 py-2",required:""},null,512),[[x,s.start_date]])]),e("div",R,[t[10]||(t[10]=e("label",{for:"end_date",class:"block text-sm font-medium"},"End Date",-1)),p(e("input",{id:"end_date","onUpdate:modelValue":t[3]||(t[3]=o=>s.end_date=o),type:"date",class:"w-full border rounded px-3 py-2",required:""},null,512),[[x,s.end_date]])]),e("div",W,[t[12]||(t[12]=e("label",{for:"type",class:"block text-sm font-medium"},"Type",-1)),p(e("select",{id:"type","onUpdate:modelValue":t[4]||(t[4]=o=>s.type=o),class:"w-full border rounded px-3 py-2",required:""},t[11]||(t[11]=[e("option",{value:"government"},"Government",-1),e("option",{value:"special"},"Special",-1),e("option",{value:"organizational"},"Organizational",-1)]),512),[[A,s.type]])]),e("div",null,[t[13]||(t[13]=e("label",{for:"company_id",class:"block text-sm font-medium"},"Company",-1)),b(B,{modelValue:i.value,"onUpdate:modelValue":t[5]||(t[5]=o=>i.value=o),options:v.value,multiple:!l.value,searchable:!0,placeholder:"Select companies","track-by":"id",label:"name"},null,8,["modelValue","options","multiple"])]),e("div",X,[t[14]||(t[14]=e("label",{for:"description",class:"block text-sm font-medium"},"Description",-1)),p(e("textarea",{id:"description","onUpdate:modelValue":t[6]||(t[6]=o=>s.description=o),class:"w-full border rounded px-3 py-2",placeholder:"Enter holiday description (optional)"},null,512),[[x,s.description]])]),e("div",Z,[e("button",{type:"button",onClick:_,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2"}," Cancel "),e("button",ee,c(l.value?"Update":"Create"),1)])],32)])])):U("",!0)}},se={class:"my-container space-y-2"},oe={class:"overflow-x-auto"},le={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},ae={class:"text-gray-600 text-sm"},de={key:0},ne={colspan:"5"},re={class:"py-3 px-2 text-left"},ie={class:"font-medium"},ue={class:"py-3 px-2 text-left"},ce={class:"font-medium"},pe={class:"py-3 px-2 text-center"},me={class:"font-medium"},ye={class:"py-3 px-2 text-center"},fe={class:"font-medium"},ve={class:"py-3 px-2 text-center"},_e={class:"font-medium"},xe={class:"py-3 px-2 text-center"},be={class:"flex item-center justify-center gap-4"},he=["onClick"],we=["onClick"],ge={key:2},Ee={__name:"HoliDayList",setup(g){const a=S(),r=N(),u=f(!1),i=f(!1),l=f(null),s=()=>{l.value=null,u.value=!0},h=t=>{l.value=t,u.value=!0},v=()=>{u.value=!1},k=async t=>{try{t.id?(await a.updateHoliday(t.id,t),r.success("Holiday updated successfully!")):(await a.createHoliday(t),r.success("Holiday added successfully!")),await a.fetchHolidays()}catch(o){r.error("Failed to save holiday!"),console.error("Error handling save:",o)}},H=t=>{l.value=t,i.value=!0},_=()=>{i.value=!1},d=async()=>{if(!l.value||!l.value.id){r.error("Invalid holiday selected for deletion!");return}try{await a.deleteHoliday(l.value.id),r.warning("Holiday deleted successfully!"),await a.fetchHolidays()}catch(t){r.error("Failed to delete holiday!"),console.error("Error deleting holiday:",t)}finally{_()}};return D(async()=>{await a.fetchHolidays()}),(t,o)=>{var $;return y(),m("div",se,[b(Y,{title:"Holiday List",onAdd:s}),e("div",oe,[e("table",le,[o[3]||(o[3]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"Name"),e("th",{class:"py-3 px-2 text-left"},"Company"),e("th",{class:"py-3 px-2 text-center"},"Start Date"),e("th",{class:"py-3 px-2 text-center"},"End Date"),e("th",{class:"py-3 px-2 text-center"},"Type"),e("th",{class:"py-3 px-2 text-center"},"Action")])],-1)),e("tbody",ae,[w(a).loading?(y(),m("tr",de,[e("td",ne,[b(z)])])):w(a).holidays&&w(a).holidays.length?(y(!0),m(j,{key:1},L(w(a).holidays,n=>{var C;return y(),m("tr",{key:n.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",re,[e("p",ie,c(n.name),1)]),e("td",ue,[e("p",ce,c(((C=n==null?void 0:n.company)==null?void 0:C.name)||"All"),1)]),e("td",pe,[e("p",me,c(n.start_date),1)]),e("td",ye,[e("p",fe,c(n.end_date),1)]),e("td",ve,[e("p",_e,c(n.type),1)]),e("td",xe,[e("div",be,[e("button",{onClick:M=>h(n),class:"text-blue-600 hover:text-blue-800"},o[0]||(o[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,he),e("button",{onClick:M=>H(n),class:"text-red-600 hover:text-red-800"},o[1]||(o[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,we)])])])}),128)):(y(),m("tr",ge,o[2]||(o[2]=[e("td",{colspan:"5",class:"text-center text-red-500 py-4"},"No holidays found",-1)])))])])]),b(te,{show:u.value,holiday:l.value,onClose:v,onSave:k},null,8,["show","holiday"]),b(O,{show:i.value,title:"Delete Holiday",message:`Are you sure you want to delete ${($=l.value)==null?void 0:$.name}?`,onClose:_,onConfirm:d},null,8,["show","message"])])}}};export{Ee as default};
