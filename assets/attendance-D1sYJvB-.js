import{J as D,r as g,K as y}from"./index-DOiu8dJm.js";const j=D("attendance",()=>{const p=g([]),w=g([]),v=g([]),f=g([]),h=g([]),b=g(null),R=g(null),S=g(new Date().toISOString().substring(0,7)),L=g(new Date().toISOString().substring(0,10)),t=g(null),u=g(!1);return{monthlyLogs:p,dailyLateLogs:f,monthlyLateLogs:h,summary:b,monthly_company_summary:R,selectedMonth:S,selectedDate:L,error:t,isLoading:u,dailyLogs:v,attendanceLogs:w,getMonthlyAttendanceByShift:async(n,s)=>{var a,o;if(!n||!s){t.value="Invalid user ID or month";return}u.value=!0;try{const e=await y.get(`/user/${n}/attendance/monthly/${s}`);p.value=e.data.monthly_logs,b.value=e.data.summary,t.value=null}catch(e){t.value=((o=(a=e.response)==null?void 0:a.data)==null?void 0:o.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},getTodayAttendanceReport:async(n,s,a,o,e,l)=>{var r,c;u.value=!0;try{const d={companyId:n,departmentId:s,employee_id:a,category:o,month:e,status:l},i=await y.get("/attendance/today",{params:d});v.value=i.data,t.value=null}catch(d){t.value=((c=(r=d.response)==null?void 0:r.data)==null?void 0:c.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},getAttendanceLateReport:async(n,s=null,a=null,o=null,e,l)=>{var r,c;u.value=!0;try{const d={company_id:n,department_id:s,category:a,employee_id:o,type:l,...l==="daily"?{date:e}:{month:e}},i=await y.get("/monthly/attendance/late-reports",{params:d});l==="daily"?f.value=i.data:l==="monthly"&&(h.value=i.data),t.value=null}catch(d){t.value=((c=(r=d.response)==null?void 0:r.data)==null?void 0:c.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},getMonthlyAttendanceSummaryReport:async(n,s,a,o)=>{var e,l;if(!n||!o){t.value="Invalid user ID or month";return}u.value=!0;try{const r={company_id:n,employee_id:s,category:a,month:o},c=await y.get("/attendance/monthly-summary-reports",{params:r});R.value=c.data,t.value=null}catch(r){t.value=((l=(e=r.response)==null?void 0:e.data)==null?void 0:l.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},downloadExcel:async(n,s,a)=>{var o,e;if(!n||!a){t.value="Invalid company ID or month";return}u.value=!0;try{const l={company_id:n,category:s,month:a},r=await y.get("/attendance/monthly-summary-reports?flag=excel",{params:l,responseType:"blob"}),c=window.URL.createObjectURL(new Blob([r.data])),d=document.createElement("a");d.href=c,d.setAttribute("download",`${a} attendance_summary.xlsx`),document.body.appendChild(d),d.click(),document.body.removeChild(d)}catch(l){t.value=((e=(o=l.response)==null?void 0:o.data)==null?void 0:e.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},downloadPDF:async(n,s,a,o=0)=>{var e,l;if(!n||!a){t.value="Invalid user ID or month";return}u.value=!0;try{const r={company_id:n,category:s,month:a},c=await y.get("/attendance/monthly-summary-reports?flag=pdf",{params:r,responseType:"blob"}),d=window.URL.createObjectURL(new Blob([c.data])),i=document.createElement("a");i.href=d,i.setAttribute("download",`${a} attendance_summary.pdf`),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(r){t.value=((l=(e=r.response)==null?void 0:e.data)==null?void 0:l.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},attendanceDownloadExcel:async(n,s,a,o,e)=>{var l,r;u.value=!0;try{const c={companyId:n,employee_id:s,category:a,month:o,status:e},d=await y.get("/attendance/today?flag=excel",{params:c,responseType:"blob"}),i=window.URL.createObjectURL(new Blob([d.data])),m=document.createElement("a");m.href=i,m.setAttribute("download",`${o} attendance_summary.xlsx`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(c){t.value=((r=(l=c.response)==null?void 0:l.data)==null?void 0:r.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},attendanceDownloadPdf:async(n,s,a,o,e)=>{var l,r;u.value=!0;try{const c={companyId:n,employee_id:s,category:a,month:o,status:e},d=await y.get("/attendance/today?flag=pdf",{params:c,responseType:"blob"}),i=window.URL.createObjectURL(new Blob([d.data])),m=document.createElement("a");m.href=i,m.setAttribute("download",`${o} attendance_summary.pdf`),document.body.appendChild(m),m.click(),document.body.removeChild(m)}catch(c){t.value=((r=(l=c.response)==null?void 0:l.data)==null?void 0:r.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},lateReportDownloadExcel:async(n,s,a,o)=>{var e,l;if(!n){t.value="Invalid company ID or date/month";return}u.value=!0;try{const r={company_id:n,...s?{employee_id:s}:{},type:o,...o==="daily"?{date:a}:{month:a}},c=await y.get("/monthly/attendance/late-reports?flag=excel",{params:r,responseType:"blob"}),d=window.URL.createObjectURL(new Blob([c.data])),i=document.createElement("a");i.href=d;const m=`${a}-late-attendance.xlsx`;i.setAttribute("download",m),document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(r){t.value=((l=(e=r.response)==null?void 0:e.data)==null?void 0:l.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},getMonthlyAttendanceLog:async(n,s)=>{var a,o;if(!n||!s){t.value="Invalid user ID or month";return}u.value=!0;try{const e=await y.get(`/user/${n}/attendance/monthly/${s}/log`);w.value=e.data.attendance_logs}catch(e){t.value=((o=(a=e.response)==null?void 0:a.data)==null?void 0:o.message)||"Something went wrong",console.error(t.value)}finally{u.value=!1}},getDateRangeAttendanceSummary:async(n,s,a,o)=>{var e,l;if(!a||!n||!s){t.value="Company, Start Date, and End Date are required";return}u.value=!0;try{return(await y.get("/attendance/date-range-summary",{params:{company_id:a,start_date:n,end_date:s,employee_id:o||void 0}})).data}catch(r){return t.value=((l=(e=r.response)==null?void 0:e.data)==null?void 0:l.message)||"Something went wrong",console.error(t.value),null}finally{u.value=!1}},downloadDateRangeExcel:async(n,s,a,o=null,e="")=>{var d;if(!a||!n||!s){t.value="Company, Start Date, and End Date are required";return}const l=(d=y.defaults.baseURL)==null?void 0:d.replace(/\/$/,"");let r=`flag=excel&company_id=${a}&start_date=${n}&end_date=${s}`;o&&(r+=`&employee_id=${o}`),e&&(r+=`&category=${e}`);const c=`${l}/attendance/date-range-summary?${r}`;console.log("ðŸ“ Opening Excel Download URL:",c),window.open(c,"_blank")},downloadDateRangePdf:(n,s,a,o=null,e="")=>{if(!a||!n||!s){t.value="Company, Start Date, and End Date are required";return}const l=new URLSearchParams({flag:"pdf",company_id:a,start_date:n,end_date:s});o&&l.append("employee_id",o),e&&l.append("category",e);const r=`/attendance/date-range-summary?${l.toString()}`;window.open(r,"_blank")}}});export{j as u};
