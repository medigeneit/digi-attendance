import{f as Te,g as Pe,r as f,x as p,h as Ve,c as n,o,a as e,j as v,t as a,m as z,b as A,F as g,e as y,k as B,v as D,O as be,s as _e}from"./index-DUG-Uvq3.js";import{u as Ie}from"./kpi-DERsn73B.js";const Ke={class:"max-w-7xl mx-auto px-4 py-6 space-y-6"},Ue={class:"border rounded-2xl bg-white/80 backdrop-blur px-4 py-3 shadow-sm"},ze={class:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between"},Be={class:"space-y-1"},De={class:"inline-flex items-center gap-2 rounded-full bg-indigo-50 px-3 py-1"},Oe={class:"text-xs text-indigo-900"},Ye={class:"text-sm text-slate-600"},qe={class:"font-medium text-slate-800"},Qe={class:"flex flex-wrap gap-2 text-xs mt-0.5"},We={key:0,class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},Je={class:"ml-1 font-medium text-slate-800"},Xe={key:1,class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},Ze={class:"ml-1 font-medium text-slate-800"},et={class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},tt={key:0,class:"ml-1 inline-flex items-center gap-1"},st={key:1,class:"ml-1 font-semibold text-slate-800"},lt={class:"flex items-end gap-4"},nt={class:"text-right"},ot={class:"text-lg font-bold text-slate-900"},at={class:"text-slate-400"},it={class:"text-xs text-slate-500"},rt={key:0,class:"border rounded-2xl bg-white shadow-sm overflow-hidden"},dt={class:"overflow-auto"},ut={class:"min-w-[980px] w-full text-sm"},ct={class:"bg-slate-50 sticky top-0 z-10"},xt={class:"text-slate-700"},pt={class:"font-medium"},mt={class:"text-[11px] text-slate-500 flex flex-col items-center"},vt={key:0,class:"mt-0.5 inline-flex items-center rounded-full bg-blue-50 px-2 py-0.5 text-[10px] font-medium text-blue-700 border border-blue-200"},bt={class:"bg-slate-100/80 border-t"},_t=["colspan"],ft={class:"px-3 py-2 text-center text-slate-500"},ht={class:"px-3 py-2 align-top"},gt={class:"font-medium text-slate-800"},yt={class:"mt-1 flex gap-1 text-[11px] text-slate-500"},kt=["disabled","onClick"],wt=["disabled","onClick"],Ct=["disabled","onClick"],Nt={class:"px-3 py-2 text-center text-slate-700"},Ft={key:0,class:"flex items-center justify-center"},jt=["max","onUpdate:modelValue","onChange"],$t={key:1,class:"text-slate-700 text-sm"},Ht={key:2,class:"text-slate-300 text-sm"},St={class:"bg-slate-50 border-t"},At={class:"px-3 py-2 text-center font-semibold text-slate-800"},Lt=["colspan"],Rt={class:"font-semibold text-slate-900"},Mt={class:"text-slate-500"},Et={key:1,class:"mt-2"},Gt={class:"grid gap-4 lg:grid-cols-5"},Tt={class:"space-y-4 lg:col-span-3"},Pt={class:"flex items-center justify-between border-b bg-slate-50 px-4 py-2.5"},Vt={class:"text-sm font-semibold text-slate-800"},It={class:"flex items-center gap-2 text-[11px] text-slate-500"},Kt=["onClick","disabled"],Ut=["onClick","disabled"],zt=["onClick","disabled"],Bt={class:"overflow-auto"},Dt={class:"w-full text-sm"},Ot={class:"px-3 py-2 text-center text-slate-500"},Yt={class:"px-3 py-2"},qt={class:"font-medium text-slate-800"},Qt={class:"px-3 py-2 text-center text-slate-700"},Wt={class:"px-3 py-2 text-center"},Jt=["max","onUpdate:modelValue","onChange"],Xt={key:1,class:"text-slate-700"},Zt={class:"bg-slate-50 border-t"},es={class:"px-3 py-2 text-center font-semibold text-slate-800"},ts={class:"px-3 py-2 text-center text-sm"},ss={class:"lg:col-span-2 space-y-4"},ls={key:0,class:"border rounded-2xl bg-white shadow-sm"},ns={class:"flex items-center justify-between border-b px-4 py-3 text-sm font-semibold text-slate-800"},os={class:"flex items-center gap-1 text-[11px] text-slate-500"},as={key:0,class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},is={class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},rs={class:"p-4 space-y-3"},ds={class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},us={class:"rounded-xl border bg-slate-50 p-3"},cs={class:"flex items-center justify-between"},xs={class:"text-[11px] px-1.5 py-0.5 rounded bg-blue-50 text-blue-700 border border-blue-200"},ps={class:"mt-1 text-sm font-semibold text-slate-900"},ms={class:"text-xs text-slate-500"},vs={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},bs={class:"rounded-xl border bg-slate-50 p-3"},_s={class:"flex items-center justify-between"},fs={class:"text-[11px] px-1.5 py-0.5 rounded bg-violet-50 text-violet-700 border border-violet-200"},hs={class:"mt-1 text-sm font-semibold text-slate-900"},gs={class:"text-xs text-slate-500"},ys={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},ks={class:"rounded-xl border bg-slate-50 p-3 sm:col-span-2"},ws={class:"flex items-center justify-between"},Cs={class:"text-[11px] px-1.5 py-0.5 rounded bg-emerald-50 text-emerald-700 border border-emerald-200"},Ns={class:"mt-1 text-sm font-semibold text-slate-900"},Fs={class:"text-xs text-slate-500"},js={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},$s={class:"border-t pt-2 text-xs"},Hs={key:0,class:"mt-3 rounded-xl border bg-slate-50 p-3 text-xs space-y-1"},Ss={class:"flex justify-between"},As={class:"font-medium"},Ls={class:"flex justify-between"},Rs={class:"font-medium"},Ms={class:"flex justify-between"},Es={class:"font-medium"},Gs={class:"flex justify-between"},Ts={class:"font-medium"},Ps={class:"flex justify-between"},Vs={class:"font-medium"},Is={class:"flex justify-between"},Ks={class:"font-medium"},Us={class:"flex justify-between"},zs={class:"font-medium"},Bs={class:"flex justify-between"},Ds={class:"font-medium"},Os={key:1,class:"border rounded-2xl bg-white shadow-sm"},Ys={class:"flex items-center justify-between border-b px-4 py-3 text-sm font-semibold text-slate-800"},qs={class:"text-[11px] text-slate-500"},Qs={class:"p-4 space-y-3"},Ws={class:"max-h-96 overflow-auto border rounded-xl"},Js={class:"min-w-full text-xs text-left"},Xs={class:"px-2 py-2"},Zs={class:"font-semibold text-slate-700"},el={key:0,class:"mt-0.5 text-[11px] text-slate-400"},tl={class:"px-2 py-2"},sl={key:0,class:"flex flex-wrap gap-1"},ll={key:1,class:"text-slate-400"},nl={class:"px-2 py-2"},ol={key:0,class:"flex flex-wrap gap-1"},al={key:1,class:"text-slate-400"},il={class:"px-2 py-2"},rl={key:0,class:"flex flex-wrap gap-1"},dl={key:1,class:"text-slate-400"},ul={key:2,class:"grid gap-4 rounded-2xl bg-white border shadow-sm px-4 py-4 md:grid-cols-3"},cl={class:"space-y-3"},xl={class:"flex items-center justify-between text-xs font-semibold text-slate-500"},pl={class:"flex items-center gap-2"},ml={key:0,class:"text-[11px] text-indigo-600"},vl={class:"space-y-2"},bl={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/80 p-3 max-h-36 overflow-y-auto"},_l={class:"flex flex-wrap gap-2"},fl=["onClick","aria-pressed"],hl={key:1,class:"text-[11px] text-slate-400"},gl=["disabled"],yl={class:"space-y-3"},kl={class:"flex items-center justify-between text-xs font-semibold text-slate-500"},wl={class:"flex items-center gap-2"},Cl={key:0,class:"text-[11px] text-amber-600"},Nl={class:"space-y-2"},Fl={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/80 p-3 max-h-36 overflow-y-auto"},jl={class:"flex flex-wrap gap-2"},$l=["onClick","aria-pressed"],Hl={key:1,class:"text-[11px] text-slate-400"},Sl=["disabled"],Al={class:"space-y-3"},Ll={class:"flex items-center justify-between text-xs font-semibold text-slate-500"},Rl={class:"flex items-center gap-2"},Ml={key:0,class:"text-[11px] text-emerald-600"},El={class:"space-y-2"},Gl={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/80 p-3 max-h-36 overflow-y-auto"},Tl={class:"flex flex-wrap gap-2"},Pl=["onClick","aria-pressed"],Vl={key:1,class:"text-[11px] text-slate-400"},Il=["disabled"],Kl={class:"mt-2 flex flex-col gap-3 border-t pt-3 md:flex-row md:items-center md:justify-between"},Ul={class:"text-sm text-slate-600"},zl={class:"text-slate-900"},Bl={class:"text-slate-400"},Dl=["disabled"],Ql={__name:"KpiReviewForm",setup(Ol){const O=Te(),k=Ie(),te=Pe(),b=f({}),L=f({}),Y=f(""),q=f(""),Q=f(""),R=f(null),W=f(!1),fe=f([]),J=f({}),N=f(null),se=f(!1),le=p(()=>{var s;return((s=k.cycle)==null?void 0:s.groups_json)||[]}),he=s=>(s==null?void 0:s.id)==="personal"||/personal/i.test((s==null?void 0:s.label)||""),$=p(()=>le.value.find(he)||null),ne=p(()=>le.value.filter(s=>!he(s))),Fe=(s,t)=>(s==null?void 0:s.label)||`Group ${t+1}`,je=s=>/^hr\d*$/i.test(s)||s==="hr",ge=s=>je((s==null?void 0:s.key)||"")||(s==null?void 0:s.is_hr_lane)===!0,ye=p(()=>[...fe.value||[]].sort((s,t)=>(s.rank??999)-(t.rank??999))),oe=p(()=>ye.value.filter(ge)),H=p(()=>ye.value.filter(s=>!ge(s))),$e=p(()=>H.value.find(s=>s.key===N.value)||null),He=p(()=>{var s;return((s=$e.value)==null?void 0:s.rank)??null}),Se=p(()=>{var s;return Number(((s=te==null?void 0:te.user)==null?void 0:s.id)||0)}),ae=p(()=>{const s=Se.value;if(!s)return null;const t=oe.value.find(i=>Number(i.assigned_user_id)===s);return t||oe.value.find(i=>i.can_current_user_review)||null}),F=p(()=>{var s;return((s=ae.value)==null?void 0:s.key)||null}),Ae=p(()=>!!(ae.value&&ae.value.can_current_user_review)),w=p(()=>!!(se.value||Ae.value)),S=p(()=>!!N.value&&H.value.some(s=>s.key===N.value&&s.can_current_user_review)),X=p(()=>w.value&&F.value?F.value:N.value),ke=p(()=>!!(X.value&&F.value&&X.value===F.value));function ie(s){var i;return(((i=J.value)==null?void 0:i[s])||[])[0]||null}function we(s,t){var r;const i=ie(s);return((r=i==null?void 0:i.marks)==null?void 0:r[t])??""}function Ce(s){var i,r,c,x;if(F.value){const _=ie(F.value),C=(i=_==null?void 0:_.marks)==null?void 0:i[s];if(C!=null)return C}let t=null;for(const _ of oe.value){const l=(((r=J.value)==null?void 0:r[_.key])||[])[0];if(!(!l||((c=l==null?void 0:l.marks)==null?void 0:c[s])==null)){if(!t){t=l;continue}l.submitted_at&&t.submitted_at&&l.submitted_at>t.submitted_at&&(t=l)}}return((x=t==null?void 0:t.marks)==null?void 0:x[s])??""}function re(s,t){const i=Number(b.value[s]??0);i<0&&(b.value[s]=0),i>Number(t)&&(b.value[s]=Number(t))}function Z(s,t,i){i==="zero"?b.value[s]=0:i==="half"?b.value[s]=Number(t)/2:i==="full"&&(b.value[s]=Number(t)),re(s,t)}function de(s,t){s.items.forEach(i=>Z(i.id,i.max,t))}const E=p(()=>{let s=0,t=0;const i=$.value;i&&i.items.forEach(c=>{s+=Number(c.max||0);const x=Number(b.value[c.id]||0);t+=Math.min(Math.max(x,0),Number(c.max||0))});const r=s>0?t/s*100:0;return{max:Number(s.toFixed(2)),got:Number(t.toFixed(2)),percent:Number(r.toFixed(2))}}),Le=p(()=>!!R.value&&typeof R.value=="object"),m=p(()=>{var s;return((s=R.value)==null?void 0:s.avg)||{max:0,incharge:0,coordinator:0,final:0,percent_simple:0,percent_weighted:0}}),ue=p(()=>{var s;return((s=R.value)==null?void 0:s.year)??null}),Ne=p(()=>{var s;return((s=R.value)==null?void 0:s.months_total_form)??0}),ee=p(()=>{const s=J.value||{},t=H.value||[],i=[],r=ke.value||w.value?1/0:He.value??null,c=x=>x?Array.isArray(x)?x.filter(Boolean):typeof x=="string"&&x.trim()!==""?[x.trim()]:[]:[];return t.forEach(x=>{const _=x.key;if(!_||r!=null&&(x.rank??999)>r)return;const C=s[_]||[];if(!Array.isArray(C)||!C.length)return;const l=C[0],d=c(l.strengths),u=c(l.gaps),j=c(l.suggestions);!d.length&&!u.length&&!j.length||i.push({key:_,lane:_,label:x.label||(l==null?void 0:l.lane_label)||_,reviewer_id:l.reviewer_id,reviewer_name:l.reviewer_name,strengths:d,gaps:u,suggestions:j,submitted_at:l.submitted_at??null})}),i}),ce=s=>{const t=new Set;return ee.value.forEach(i=>{(Array.isArray(i[s])?i[s]:[]).forEach(c=>{const x=typeof c=="string"?c.trim():"";x&&t.add(x)})}),Array.from(t)},G=p(()=>ce("strengths")),T=p(()=>ce("gaps")),P=p(()=>ce("suggestions")),V=f([]),I=f([]),K=f([]),xe={strengths:V,gaps:I,suggestions:K},Re={strengths:Y,gaps:q,suggestions:Q};function Me(s,t){const i=(t||"").trim();return i?s!=null&&s.trim()?`${s.trim()}
${i}`:i:s}function pe(s){const t=xe[s],i=Re[s];if(!t||!i)return;const r=(t.value||[]).filter(Boolean);if(!r.length)return;const c=r.join(`
`);i.value=Me(i.value,c),t.value=[]}function me(s,t){const i=xe[s];if(!i)return;const r=Array.isArray(i.value)?[...i.value]:[],c=r.indexOf(t);c>-1?r.splice(c,1):r.push(t),i.value=r}function ve(s){const t=xe[s];t&&(t.value=[])}const Ee=p(()=>{const s={};let t=1;const i=$.value;return i&&i.items.forEach(r=>{s[r.id]=t++}),s});Ve(async()=>{var t,i;k.cycle||await k.fetchActiveCycle(Number(O.params.employeeId));const s=await k.fetchLanes(k.cycle.id,Number(O.params.employeeId));if(L.value=s.employee,R.value=(s==null?void 0:s.annual_target_avg_marks)||null,fe.value=s.lanes||[],J.value=s.reviews_by_lane||{},se.value=!!(((t=s==null?void 0:s.meta)==null?void 0:t.is_hr)??(s==null?void 0:s.hr)??!1),N.value=((i=H.value.find(r=>r.can_current_user_review))==null?void 0:i.key)||null,le.value.forEach(r=>r.items.forEach(c=>{b.value[c.id]==null&&(b.value[c.id]=0)})),N.value){const r=ie(N.value);r!=null&&r.marks&&Object.assign(b.value,r.marks)}w.value&&ne.value.forEach(r=>{r.items.forEach(c=>{let x=F.value?we(F.value,c.id):"";(x===""||x==null)&&(x=Ce(c.id)),x!==""&&x!=null&&(b.value[c.id]=Number(x))})})});async function Ge(){const s=X.value;if(!s){alert("Unable to determine reviewer lane.");return}F.value,await k.submitReview({cycle_id:k.cycle.id,employee_id:Number(O.params.employeeId),reviewer_lane:s,marks:b.value,strengths:Y.value,gaps:q.value,suggestions:Q.value}),alert("Submitted")}function h(s){const t=Number(s??0);return isNaN(t)?"0.00":t.toFixed(2)}function M(s,t){const i=Number(s??0),r=Number(t??0);return r>0?Math.round(i/r*100):0}return(s,t)=>{var i,r,c,x,_,C;return o(),n("div",Ke,[e("header",Ue,[e("div",ze,[e("div",Be,[e("div",De,[t[11]||(t[11]=e("span",{class:"text-xs font-semibold text-indigo-700"},"KPI Cycle",-1)),e("span",Oe,a((i=z(k).cycle)==null?void 0:i.title),1)]),e("div",Ye,[e("div",qe,a(((r=L.value)==null?void 0:r.name)||"Employee"),1),e("div",Qe,[(x=(c=L.value)==null?void 0:c.designation)!=null&&x.title?(o(),n("span",We,[t[12]||(t[12]=A(" Designation: ")),e("span",Je,a(L.value.designation.title),1)])):v("",!0),(C=(_=L.value)==null?void 0:_.department)!=null&&C.name?(o(),n("span",Xe,[t[13]||(t[13]=A(" Department: ")),e("span",Ze,a(L.value.department.name),1)])):v("",!0),e("span",et,[t[15]||(t[15]=A(" Reviewing as: ")),ke.value?(o(),n("span",tt,t[14]||(t[14]=[e("span",{class:"font-semibold text-emerald-700"},"HR",-1),e("span",{class:"text-[10px] rounded bg-emerald-50 border border-emerald-200 px-1.5 py-0.5 text-emerald-700"}," HR mode ",-1)]))):(o(),n("span",st,a(X.value||"No lane"),1))])])])]),e("div",lt,[e("div",nt,[t[16]||(t[16]=e("div",{class:"text-[11px] uppercase tracking-wide text-slate-500"}," Personal group total ",-1)),e("div",ot,[A(a(E.value.got.toFixed(2))+" ",1),e("span",at,"/ "+a(E.value.max.toFixed(2)),1)]),e("div",it,a(E.value.percent.toFixed(2))+"% achieved ",1)]),se.value?(o(),n("button",{key:0,onClick:t[0]||(t[0]=l=>z(k).submitFinalResult(z(k).cycle.id,z(O).params.employeeId)),class:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-4 py-2.5 text-sm font-medium text-white shadow hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-300 focus:outline-none"},t[17]||(t[17]=[e("span",null,"Finalize & Lock",-1)]))):v("",!0)])])]),z(k).cycle&&$.value?(o(),n("section",rt,[t[23]||(t[23]=e("div",{class:"flex items-center justify-between border-b bg-slate-50 px-4 py-2"},[e("div",{class:"text-sm font-semibold text-slate-800"}," Personal Evaluation "),e("div",{class:"text-xs text-slate-500"}," Fill only your lane; others appear as read-only. ")],-1)),e("div",dt,[e("table",ut,[e("thead",ct,[e("tr",xt,[t[18]||(t[18]=e("th",{class:"px-3 py-2 w-[40px] text-center font-medium"},"#",-1)),t[19]||(t[19]=e("th",{class:"text-left px-3 py-2 w-[20%] font-medium"},"মূল্যায়নের বিষয় (Personal)",-1)),t[20]||(t[20]=e("th",{class:"px-3 py-2 text-center font-medium"},"Max",-1)),(o(!0),n(g,null,y(H.value,l=>(o(),n("th",{key:l.key,class:"px-3 py-2 text-center font-medium"},[e("div",pt,a(l.label||l.key),1),e("div",mt,[e("span",null,a(l.assigned_user_name||"-"),1),l.key===N.value&&l.can_current_user_review?(o(),n("span",vt," You can edit ")):v("",!0)])]))),128))])]),e("tbody",null,[e("tr",bt,[e("td",{colspan:3+H.value.length,class:"px-3 py-2 font-medium text-slate-800"},a($.value.label||"Personal"),9,_t)]),(o(!0),n(g,null,y($.value.items,l=>(o(),n("tr",{key:l.id,class:"border-t hover:bg-slate-50/60"},[e("td",ft,a(Ee.value[l.id]),1),e("td",ht,[e("div",gt,a(l.label),1),e("div",yt,[e("button",{class:"border rounded px-1.5 py-0.5 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!S.value,onClick:d=>S.value&&Z(l.id,l.max,"zero")}," 0 ",8,kt),e("button",{class:"border rounded px-1.5 py-0.5 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!S.value,onClick:d=>S.value&&Z(l.id,l.max,"half")}," ½ ",8,wt),e("button",{class:"border rounded px-1.5 py-0.5 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!S.value,onClick:d=>S.value&&Z(l.id,l.max,"full")}," Full ",8,Ct)])]),e("td",Nt,a(l.max),1),(o(!0),n(g,null,y(H.value,d=>(o(),n("td",{key:d.key,class:"px-3 py-2 text-center"},[d.key===N.value&&d.can_current_user_review?(o(),n("div",Ft,[B(e("input",{type:"number",step:"0.1",min:"0",max:l.max,"onUpdate:modelValue":u=>b.value[l.id]=u,onChange:u=>re(l.id,l.max),inputmode:"decimal",class:"w-24 text-right rounded-lg border px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"},null,40,jt),[[D,b.value[l.id],void 0,{number:!0}]])])):d.can_view_marks?(o(),n("div",$t,a(we(d.key,l.id)),1)):(o(),n("div",Ht," — "))]))),128))]))),128)),e("tr",St,[t[21]||(t[21]=e("td",null,null,-1)),t[22]||(t[22]=e("td",{class:"px-3 py-2 text-right font-medium text-slate-700"}," Group Total ",-1)),e("td",At,a($.value.items.reduce((l,d)=>l+Number(d.max||0),0).toFixed(2)),1),e("td",{colspan:H.value.length,class:"px-3 py-2 text-center text-sm"},[e("span",Rt,a($.value.items.reduce((l,d)=>{const u=Number(b.value[d.id]||0);return l+Math.min(Math.max(u,0),Number(d.max||0))},0).toFixed(2)),1),e("span",Mt," / "+a($.value.items.reduce((l,d)=>l+Number(d.max||0),0).toFixed(2)),1)],8,Lt)])])])])])):v("",!0),ne.value.length?(o(),n("section",Et,[e("div",Gt,[e("div",Tt,[(o(!0),n(g,null,y(ne.value,(l,d)=>(o(),n("div",{key:d,class:"overflow-hidden border rounded-2xl bg-white shadow-sm"},[e("div",Pt,[e("div",Vt," Group "+a(d+1)+" — "+a(Fe(l,d)),1),e("div",It,[t[24]||(t[24]=e("span",null,"Quick fill:",-1)),e("button",{class:"rounded border px-1.5 py-0.5 hover:bg-slate-100 disabled:opacity-40",onClick:u=>de(l,"zero"),disabled:!w.value}," All 0 ",8,Kt),e("button",{class:"rounded border px-1.5 py-0.5 hover:bg-slate-100 disabled:opacity-40",onClick:u=>de(l,"half"),disabled:!w.value}," All ½ ",8,Ut),e("button",{class:"rounded border px-1.5 py-0.5 hover:bg-slate-100 disabled:opacity-40",onClick:u=>de(l,"full"),disabled:!w.value}," All Full ",8,zt)])]),e("div",Bt,[e("table",Dt,[t[27]||(t[27]=e("thead",{class:"sticky top-0 bg-white z-10"},[e("tr",{class:"bg-slate-100 text-slate-700"},[e("th",{class:"px-3 py-2 w-[40px] text-center font-medium"},"#"),e("th",{class:"text-left px-3 py-2 w-[30%] font-medium"},"Item"),e("th",{class:"px-3 py-2 text-center w-[40px] font-medium"},"Max"),e("th",{class:"px-3 py-2 text-center w-[80px] font-medium"}," HR Score ")])],-1)),e("tbody",null,[(o(!0),n(g,null,y(l.items,(u,j)=>(o(),n("tr",{key:u.id,class:"border-t hover:bg-slate-50/60"},[e("td",Ot,a(j+1),1),e("td",Yt,[e("div",qt,a(u.label),1)]),e("td",Qt,a(u.max),1),e("td",Wt,[w.value?B((o(),n("input",{key:0,type:"number",step:"0.1",min:"0",max:u.max,"onUpdate:modelValue":U=>b.value[u.id]=U,onChange:U=>re(u.id,u.max),inputmode:"decimal",class:"w-24 text-right rounded-lg border px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"},null,40,Jt)),[[D,b.value[u.id],void 0,{number:!0}]]):(o(),n("span",Xt,a(Ce(u.id)),1))])]))),128)),e("tr",Zt,[t[25]||(t[25]=e("td",null,null,-1)),t[26]||(t[26]=e("td",{class:"px-3 py-2 text-right font-medium text-slate-700"}," Group Total ",-1)),e("td",es,a(l.items.reduce((u,j)=>u+Number(j.max||0),0).toFixed(2)),1),e("td",ts,a(l.items.reduce((u,j)=>{const U=Number(b.value[j.id]||0);return u+Math.min(Math.max(U,0),Number(j.max||0))},0).toFixed(2)),1)])])])])]))),128))]),e("aside",ss,[Le.value&&w.value?(o(),n("section",ls,[e("header",ns,[t[28]||(t[28]=e("span",null,"Annual Target",-1)),e("div",os,[ue.value?(o(),n("span",as," Year "+a(ue.value),1)):v("",!0),e("span",is,a(Ne.value)+" form(s) ",1)])]),e("div",rs,[e("div",ds,[e("div",us,[e("div",cs,[t[29]||(t[29]=e("span",{class:"text-xs font-medium text-slate-600"},"Incharge",-1)),e("span",xs,a(M(m.value.incharge,m.value.max))+"% ",1)]),e("div",ps,[A(a(h(m.value.incharge))+" ",1),e("span",ms,"/ "+a(h(m.value.max)),1)]),e("div",vs,[e("div",{class:"h-2 bg-blue-500",style:be({width:M(m.value.incharge,m.value.max)+"%"})},null,4)])]),e("div",bs,[e("div",_s,[t[30]||(t[30]=e("span",{class:"text-xs font-medium text-slate-600"},"Coordinator",-1)),e("span",fs,a(M(m.value.coordinator,m.value.max))+"% ",1)]),e("div",hs,[A(a(h(m.value.coordinator))+" ",1),e("span",gs,"/ "+a(h(m.value.max)),1)]),e("div",ys,[e("div",{class:"h-2 bg-violet-500",style:be({width:M(m.value.coordinator,m.value.max)+"%"})},null,4)])]),e("div",ks,[e("div",ws,[t[31]||(t[31]=e("span",{class:"text-xs font-medium text-slate-600"},"Final",-1)),e("span",Cs,a(M(m.value.final,m.value.max))+"% ",1)]),e("div",Ns,[A(a(h(m.value.final))+" ",1),e("span",Fs,"/ "+a(h(m.value.max)),1)]),e("div",js,[e("div",{class:"h-2 bg-emerald-500",style:be({width:M(m.value.final,m.value.max)+"%"})},null,4)])])]),e("div",$s,[e("button",{class:"text-xs px-3 py-1.5 rounded-md border hover:bg-slate-50",onClick:t[1]||(t[1]=l=>W.value=!W.value)},a(W.value?"Hide details":"Show details"),1),W.value?(o(),n("div",Hs,[e("div",Ss,[t[32]||(t[32]=e("span",{class:"text-slate-500"},"Year",-1)),e("span",As,a(ue.value||"-"),1)]),e("div",Ls,[t[33]||(t[33]=e("span",{class:"text-slate-500"},"Forms counted",-1)),e("span",Rs,a(Ne.value),1)]),e("div",Ms,[t[34]||(t[34]=e("span",{class:"text-slate-500"},"Max (denominator)",-1)),e("span",Es,a(h(m.value.max)),1)]),e("div",Gs,[t[35]||(t[35]=e("span",{class:"text-slate-500"},"Incharge avg",-1)),e("span",Ts,a(h(m.value.incharge)),1)]),e("div",Ps,[t[36]||(t[36]=e("span",{class:"text-slate-500"},"Coordinator avg",-1)),e("span",Vs,a(h(m.value.coordinator)),1)]),e("div",Is,[t[37]||(t[37]=e("span",{class:"text-slate-500"},"Final avg",-1)),e("span",Ks,a(h(m.value.final)),1)]),e("div",Us,[t[38]||(t[38]=e("span",{class:"text-slate-500"},"Percent (simple)",-1)),e("span",zs,a(h(m.value.percent_simple))+"%",1)]),e("div",Bs,[t[39]||(t[39]=e("span",{class:"text-slate-500"},"Percent (weighted)",-1)),e("span",Ds,a(h(m.value.percent_weighted))+"%",1)])])):v("",!0)])])])):v("",!0),ee.value.length?(o(),n("section",Os,[e("header",Ys,[t[40]||(t[40]=e("span",null,"Review Comments",-1)),e("span",qs,a(ee.value.length)+" lane(s) ",1)]),e("div",Qs,[e("div",Ws,[e("table",Js,[t[41]||(t[41]=e("thead",{class:"text-[11px] text-slate-600 uppercase tracking-wide bg-slate-50"},[e("tr",null,[e("th",{class:"px-2 py-2 w-[90px]"},"Lane"),e("th",{class:"px-2 py-2"},"Strengths"),e("th",{class:"px-2 py-2"},"Gaps"),e("th",{class:"px-2 py-2"},"Suggestions")])],-1)),e("tbody",null,[(o(!0),n(g,null,y(ee.value,l=>(o(),n("tr",{key:l.key,class:"border-t hover:bg-slate-50/60 align-top"},[e("td",Xs,[e("div",Zs,a(l.label),1),l.submitted_at?(o(),n("div",el,a(new Date(l.submitted_at).toLocaleDateString()),1)):v("",!0)]),e("td",tl,[l.strengths&&l.strengths.length?(o(),n("div",sl,[(o(!0),n(g,null,y(l.strengths,(d,u)=>(o(),n("span",{key:"s-"+u,class:"inline-flex items-center rounded-full bg-emerald-50 border border-emerald-100 px-2 py-0.5 text-[11px] text-emerald-700"},a(d),1))),128))])):(o(),n("span",ll,"—"))]),e("td",nl,[l.gaps&&l.gaps.length?(o(),n("div",ol,[(o(!0),n(g,null,y(l.gaps,(d,u)=>(o(),n("span",{key:"g-"+u,class:"inline-flex items-center rounded-full bg-amber-50 border border-amber-100 px-2 py-0.5 text-[11px] text-amber-800"},a(d),1))),128))])):(o(),n("span",al,"—"))]),e("td",il,[l.suggestions&&l.suggestions.length?(o(),n("div",rl,[(o(!0),n(g,null,y(l.suggestions,(d,u)=>(o(),n("span",{key:"su-"+u,class:"inline-flex items-center rounded-full bg-sky-50 border border-sky-100 px-2 py-0.5 text-[11px] text-sky-800"},a(d),1))),128))])):(o(),n("span",dl,"—"))])]))),128))])])])])])):v("",!0)])])])):v("",!0),S.value||w.value?(o(),n("section",ul,[e("div",cl,[e("div",xl,[t[42]||(t[42]=e("span",null,"Strengths (pick from history)",-1)),e("div",pl,[G.value.length?(o(),n("span",ml,a(G.value.length)+" hint(s) ",1)):v("",!0),V.value.length?(o(),n("button",{key:1,type:"button",onClick:t[2]||(t[2]=l=>ve("strengths")),class:"text-[11px] text-slate-400 hover:text-slate-600"}," Clear ")):v("",!0)])]),e("div",vl,[G.value.length?(o(),n("div",bl,[e("div",_l,[(o(!0),n(g,null,y(G.value,l=>(o(),n("button",{key:l,type:"button",onClick:d=>me("strengths",l),"aria-pressed":V.value.includes(l),class:_e(["rounded-full border px-3 py-1 text-[11px] font-medium transition duration-150",V.value.includes(l)?"bg-indigo-600 border-indigo-600 text-white shadow":"bg-white border-slate-200 text-slate-700 hover:border-indigo-300"])},a(l),11,fl))),128))])])):(o(),n("div",hl," No historical strengths yet. ")),G.value.length?(o(),n("button",{key:2,type:"button",onClick:t[3]||(t[3]=l=>pe("strengths")),class:"text-[11px] font-medium text-indigo-600 hover:text-indigo-800 disabled:text-slate-400",disabled:!V.value.length}," Insert selected hints ",8,gl)):v("",!0)]),B(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>Y.value=l),placeholder:"Key Strength(s)",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-indigo-200"},null,512),[[D,Y.value]])]),e("div",yl,[e("div",kl,[t[43]||(t[43]=e("span",null,"Gaps",-1)),e("div",wl,[T.value.length?(o(),n("span",Cl,a(T.value.length)+" hint(s) ",1)):v("",!0),I.value.length?(o(),n("button",{key:1,type:"button",onClick:t[5]||(t[5]=l=>ve("gaps")),class:"text-[11px] text-slate-400 hover:text-slate-600"}," Clear ")):v("",!0)])]),e("div",Nl,[T.value.length?(o(),n("div",Fl,[e("div",jl,[(o(!0),n(g,null,y(T.value,l=>(o(),n("button",{key:l,type:"button",onClick:d=>me("gaps",l),"aria-pressed":I.value.includes(l),class:_e(["rounded-full border px-3 py-1 text-[11px] font-medium transition duration-150",I.value.includes(l)?"bg-amber-500 border-amber-500 text-white shadow":"bg-white border-slate-200 text-slate-700 hover:border-amber-300"])},a(l),11,$l))),128))])])):(o(),n("div",Hl," No historical gaps yet. ")),T.value.length?(o(),n("button",{key:2,type:"button",onClick:t[6]||(t[6]=l=>pe("gaps")),class:"text-[11px] font-medium text-amber-600 hover:text-amber-800 disabled:text-slate-400",disabled:!I.value.length}," Insert selected hints ",8,Sl)):v("",!0)]),B(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=l=>q.value=l),placeholder:"GAP(s)",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-amber-200"},null,512),[[D,q.value]])]),e("div",Al,[e("div",Ll,[t[44]||(t[44]=e("span",null,"Suggestions / Training",-1)),e("div",Rl,[P.value.length?(o(),n("span",Ml,a(P.value.length)+" hint(s) ",1)):v("",!0),K.value.length?(o(),n("button",{key:1,type:"button",onClick:t[8]||(t[8]=l=>ve("suggestions")),class:"text-[11px] text-slate-400 hover:text-slate-600"}," Clear ")):v("",!0)])]),e("div",El,[P.value.length?(o(),n("div",Gl,[e("div",Tl,[(o(!0),n(g,null,y(P.value,l=>(o(),n("button",{key:l,type:"button",onClick:d=>me("suggestions",l),"aria-pressed":K.value.includes(l),class:_e(["rounded-full border px-3 py-1 text-[11px] font-medium transition duration-150",K.value.includes(l)?"bg-emerald-600 border-emerald-600 text-white shadow":"bg-white border-slate-200 text-slate-700 hover:border-emerald-300"])},a(l),11,Pl))),128))])])):(o(),n("div",Vl," No historical suggestions yet. ")),P.value.length?(o(),n("button",{key:2,type:"button",onClick:t[9]||(t[9]=l=>pe("suggestions")),class:"text-[11px] font-medium text-emerald-600 hover:text-emerald-800 disabled:text-slate-400",disabled:!K.value.length}," Insert selected hints ",8,Il)):v("",!0)]),B(e("textarea",{"onUpdate:modelValue":t[10]||(t[10]=l=>Q.value=l),placeholder:"Suggestions / Training",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[D,Q.value]])])])):v("",!0),e("div",Kl,[e("div",Ul,[t[45]||(t[45]=A(" My (Personal) Total: ")),e("b",zl,a(E.value.got.toFixed(2)),1),e("span",Bl,"/ "+a(E.value.max.toFixed(2)),1)]),e("button",{onClick:Ge,disabled:!(w.value||S.value),class:"inline-flex items-center justify-center rounded-xl bg-emerald-600 px-5 py-2.5 text-sm font-medium text-white shadow hover:bg-emerald-700 disabled:opacity-40 focus:outline-none focus:ring-2 focus:ring-emerald-300"}," Submit ",8,Dl)])])}}};export{Ql as default};
