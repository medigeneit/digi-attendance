import{o as b}from"./url-CePbr-gY.js";import{D as y,r as v,m as h,c as g,o as T,h as x,a as m,v as I,g as S,w as P}from"./index-9JcvkUhe.js";import{u as E}from"./useTaskStore-D_diiuQi.js";async function M({params:e={}}={}){return y.get("/tasks/employees",{params:e})}async function U(e,r){return y.put(`/my-tasks/${e}/update-status`,r)}async function F(e,{params:r={}}={}){const n=b(r);return y.delete(`/tasks/${e}${n?"?"+n:""}`)}async function G(e){return y.post(`/tasks/${e}/restore`)}const N={class:"text-gray-600 relative"},V=["placeholder"],w={class:"absolute right-2 top-[50%] translate-y-[-50%] flex gap-1"},j={__name:"SearchInput",props:{modelValue:String,placeholder:{type:String,default:"Type to search..."},debounceTime:{type:Number,default:500}},emits:["update:modelValue"],setup(e,{emit:r}){const n=e,a=v(),o=r,t=u=>{o("update:modelValue",u||void 0)};let s=0;const c=h({get(){return n.modelValue},set(u){n.debounceTime>0?(clearTimeout(s),s=setTimeout(t,n.debounceTime,u)):t(u)}});return(u,i)=>(T(),g("div",N,[x(m("input",{ref_key:"searchInput",ref:a,id:"search","onUpdate:modelValue":i[0]||(i[0]=l=>c.value=l),type:"text",class:"!pr-7 w-full rounded-md px-2 py-1 border-2 border-gray-400 placeholder:text-sm focus:outline-gray-400 h-full",placeholder:e.placeholder},null,8,V),[[I,c.value]]),i[3]||(i[3]=m("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Search",-1)),m("div",w,[c.value?(T(),g("i",{key:0,class:"fas fa-times opacity-35 hover:opacity-60 cursor-pointer",onClick:i[1]||(i[1]=P(()=>{t(""),a.value.focus()},["prevent"]))})):S("",!0),i[2]||(i[2]=m("i",{class:"fas fa-search opacity-80"},null,-1))])]))}};function _(e,r){var a;let n=!0;if(r!=null&&r["user-ids"]&&(n=n&&e.users.some(o=>o.id==(r==null?void 0:r["user-ids"]))),r!=null&&r.status){const o={"not-completed":["IN_PROGRESS","PENDING"],"only-completed":["COMPLETED"]},t=o==null?void 0:o[r==null?void 0:r.status];n=n&&t.includes(e==null?void 0:e.status)}return((a=e==null?void 0:e.children_tasks)==null?void 0:a.length)>0?n&&(e==null?void 0:e.children_tasks.filter(o=>_(o,r)).length)>0:n}function C(e,r){var a,o;const n=t=>t.is_urgent&&t.is_important?4:t.is_urgent?3:t.is_important?2:t.is_target?1:0;return((o=(a=e==null?void 0:e.filter(t=>_(t,r)))==null?void 0:a.map(t=>({...t,children_tasks:t.children_tasks.length>0?C(t.children_tasks,r):[]})))==null?void 0:o.sort((t,s)=>{const c=n(t),u=n(s);return u!==c?u-c:s.priority!==t.priority?s.priority-t.priority:s.serial!==t.serial?s.serial-t.serial:s.id-t.id}))||[]}function q(e,r=0){const n=v([]),{updateTaskPriorities:a}=E(),o=h(()=>(console.log({getOldTaskList:e}),e()));function t(l){const p=o.value.map(f=>f.id),d=l.map(f=>f.id);s(p,d)?n.value=d:n.value=[],console.log({reordered:s(p,d)})}function s(l,p){if(l.length!==p.length)return!1;for(let d=0;d<l.length;d++)if(l[d]!==p[d])return!0;return!1}function c(){n.value=[]}async function u(){const l=await a(r,n.value);return n.value=[],l}const i=h(()=>n.value.length>0);return{handleItemsPriorityUpdate:t,saveTaskPriority:u,listHasRearranged:i,discardTaskPriority:c}}export{j as _,U as a,F as d,M as g,C as m,G as r,q as u};
