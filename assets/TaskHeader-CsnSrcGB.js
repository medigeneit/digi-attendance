import{d as te,b as le,m as n,r as ae,e as se,A as H,n as oe,c,o as u,a as l,g as y,f as B,F as W,p as M,i as h,t as I,k as x,h as A,B as ne,T as z,v as ue,y as re,j as R,w as de,x as G}from"./index-CmYiCXOi.js";import{g as ie}from"./task-DkvoeVXE.js";import{u as me}from"./company-CYfH-6Ad.js";import{_ as K}from"./CompanyDepartmentSelectInput-BY_jr43f.js";import{_ as pe}from"./EmployeeDropdownInput-DjbjljgC.js";import{_ as J}from"./SearchInput-L9QgNdcQ.js";import{S as ve}from"./SelectDropdown-DkAmmBiR.js";const ce={class:"mb-3 task-header"},xe={class:"flex justify-between items-start"},ye={key:0,class:"ml-auto flex gap-6 items-center"},fe={class:"flex flex-wrap items-center justify-center gap-2 mt-3"},be={class:"flex flex-wrap gap-x-4 gap-y-3 justify-between"},ge={class:"relative"},we=["title"],ke={key:0},Ve={key:1,class:"text-gray-500 whitespace-nowrap"},Te={key:1,class:"relative w-full md:w-56 lg:flex-grow"},Ce={class:"relative"},Me={class:"w-32 relative h-10"},he={class:"flex gap-4 items-center flex-shrink-0"},Ae={class:"flex gap-2"},Ue={class:"flex gap-2"},De={class:"flex gap-2"},_e={class:"text-gray-600 w-full md:w-32 relative"},Le={class:"flex flex-col md:flex-row mb-2 items-end mt-6 gap-6 sticky top-[4.1rem] z-40 bg-white/80"},Ee={class:"flex items-center gap-3 flex-grow flex-wrap justify-center"},Se={key:0,class:"text-[9px] text-green-800"},Ne=["onClick"],je={key:1,class:"flex justify-end gap-5"},Pe={__name:"TaskHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(w,{emit:Q}){const U=w,F=te(),f=le(),b=n(p("company-id")),k=n(p("from-department-id")),g=n(p("to-department-id")),D=n(p("user-ids")),_=n(p("month")),L=n(p("status")),E=n(p("is-important")),S=n(p("is-urgent")),N=n(p("is-target")),j=n(p("search")),O=Q,d=me(),V=ae([]);function p(s){return{get:()=>U.modelValue[s]||"",set:e=>{O("update:modelValue",{...U.modelValue,[s]:e||void 0})}}}const X=n(()=>Y(D.value));async function P(){var s,e,i;if(!U.isMyTask){const m=(s=U.modelValue)==null?void 0:s["company-id"],a=g.value,r={...m?{company_id:m}:{},...a?{department_ids:[a]}:{}};V.value=((i=(e=await ie({params:r}))==null?void 0:e.data)==null?void 0:i.employees)||[]}}se(async()=>{await d.fetchCompanies({with:"departments",ignore_permission:!0}),await d.fetchMyCompanies({with:"departments"}),await P()});function Y(s){return Array.isArray(V.value)&&V.value.find(e=>e.id==s)||null}function Z(){D.value=""}H(()=>g.value,P),H(()=>b.value,()=>{k.value="",g.value=""});function T(s,e,{value:i,id:m,label:a,onCancel:r}={}){if(!s)return[];const o=Array.isArray(e)?e.find(v=>(v==null?void 0:v[m])==s):null;return o?[{label:a,value:typeof i=="function"?i(o):o==null?void 0:o[i],id:o==null?void 0:o[m],onCancel:r}]:[]}const ee=n(()=>{var m;const s=d.companies.reduce((a,r)=>[...a,...r.departments],[]),e=(a,{label:r,value:o,id:v,onCancel:q})=>a?[{label:r,value:o,id:v,onCancel:q}]:[],i=(a,{label:r,onCancel:o})=>{if(!a)return[];const v=new Date(a);return[{label:r,value:v.toLocaleDateString("en-US",{month:"long",year:"numeric"}),id:a,onCancel:o}]};return[...T(b.value,d.companies,{label:"Company",value:"short_name",id:"id",onCancel:()=>{b.value=""}}),...T(k.value,s,{id:"id",label:"From",value:a=>a.short_name||a.name,onCancel:()=>{k.value=""}}),...T(g.value,s,{id:"id",label:"To",value:a=>a.short_name||a.name,onCancel:()=>{g.value=""}}),...T((m=X.value)==null?void 0:m.id,V.value,{label:"Employee",value:"name",id:"id",onCancel:Z}),...T(L.value,[{id:"only-completed",name:"Completed Only"},{id:"not-completed",name:"Not Completed"}],{label:"",value:"name",id:"id",onCancel:()=>{L.value=""}}),...e(E.value,{label:"",value:"Important ",id:!0,onCancel:()=>{E.value=""}}),...e(S.value,{label:"",value:"Urgent ",id:!0,onCancel:()=>{S.value=""}}),...e(N.value,{label:"",value:"Targeted Task",id:!0,onCancel:()=>{N.value=""}}),...i(_.value,{label:"",onCancel:()=>{_.value=""}})]}),$=n(()=>b.value?d==null?void 0:d.companies.filter(s=>s.id==b.value):d==null?void 0:d.companies);return(s,e)=>{var m,a,r,o,v,q;const i=oe("RouterLink");return u(),c("div",null,[l("div",ce,[l("div",xe,[e[12]||(e[12]=l("h2",{class:"text-2xl font-bold text-gray-800 leading-none h-10"},"Task List",-1)),w.isMyTask?y("",!0):(u(),c("div",ye,[l("button",{onClick:e[0]||(e[0]=t=>O("clickAddTask")),class:"btn-1"},"Add Main Task / Project")]))]),l("div",fe,[l("div",be,[w.isMyTask?y("",!0):(u(),c(W,{key:0},[l("div",ge,[M(ve,{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=t=>b.value=t),options:((m=x(d))==null?void 0:m.companies)||[],label:"name",id:"id",class:"border-2 border-gray-300 rounded h-[40px] w-full md:w-48 bg-white text-sm",clearable:""},{"selected-option":h(({option:t})=>[l("div",{class:"line-clamp-1 text-sm text-gray-900",title:t==null?void 0:t.name},[t!=null&&t.name?(u(),c("span",ke,I(t==null?void 0:t.name),1)):(u(),c("span",Ve,"--Select Company--"))],8,we)]),_:1},8,["modelValue","options"]),e[13]||(e[13]=l("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Company ",-1))]),M(K,{modelValue:k.value,"onUpdate:modelValue":e[2]||(e[2]=t=>k.value=t),companies:$.value||[],class:"relative w-full md:w-40 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:h(()=>e[14]||(e[14]=[l("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),x(f).name!=="MyRequirementTaskList"?(u(),B(K,{key:0,modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=t=>g.value=t),companies:$.value||[],class:"relative w-full md:w-40 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:h(()=>e[15]||(e[15]=[l("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):y("",!0),x(F).isAdminMood&&((r=(a=x(F))==null?void 0:a.user)==null?void 0:r.role)!=="employee"?(u(),c("div",Te,[l("div",Ce,[M(pe,{employees:V.value,modelValue:D.value,"onUpdate:modelValue":e[4]||(e[4]=t=>D.value=t),class:"border-2 border-gray-300 rounded h-[40px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),e[16]||(e[16]=l("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Employee ",-1))]),e[17]||(e[17]=l("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Employee ",-1))])):y("",!0)],64)),l("div",Me,[e[19]||(e[19]=l("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),A(l("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>L.value=t),class:"h-full text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},e[18]||(e[18]=[l("option",{value:""},"--ALL TASKS--",-1),l("option",{value:"not-completed"},"Not Completed",-1),l("option",{value:"only-completed"},"Completed",-1)]),512),[[ne,L.value]])]),l("div",he,[l("label",Ae,[A(l("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=t=>E.value=t)},null,512),[[z,E.value]]),e[20]||(e[20]=l("span",null,"Important",-1))]),l("label",Ue,[A(l("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=t=>S.value=t)},null,512),[[z,S.value]]),e[21]||(e[21]=l("span",null,"Urgent",-1))]),l("label",De,[A(l("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>N.value=t)},null,512),[[z,N.value]]),e[22]||(e[22]=l("span",null,"Is Target",-1))])]),l("div",_e,[e[23]||(e[23]=l("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),A(l("input",{id:"month-filter","onUpdate:modelValue":e[9]||(e[9]=t=>_.value=t),type:"month",class:"h-10 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[ue,_.value]])])]),w.isMyTask?(u(),B(J,{key:0,modelValue:j.value,"onUpdate:modelValue":e[10]||(e[10]=t=>j.value=t),class:"w-full md:w-64 lg:w-64 md:ml-auto"},null,8,["modelValue"])):y("",!0)])]),l("div",Le,[w.isMyTask?y("",!0):(u(),B(J,{key:0,modelValue:j.value,"onUpdate:modelValue":e[11]||(e[11]=t=>j.value=t),class:"w-full md:w-64 md:ml-auto"},null,8,["modelValue"])),l("div",Ee,[(u(!0),c(W,null,re(ee.value,t=>(u(),c("div",{key:t.label||t.value,class:"flex-shrink-0 text-xs bg-gray-50 border border-gray-300 rounded-md px-2 flex gap-1"},[l("div",null,[t.label?(u(),c("span",Se,I(t.label)+": ",1)):y("",!0),R(I(t.value),1)]),l("button",{type:"button",class:"text-gray-400 hover:text-red-400",onClick:de(t.onCancel,["prevent"])},e[24]||(e[24]=[l("i",{class:"fas fa-times-circle"},null,-1)]),8,Ne)]))),128))]),w.isMyTask?y("",!0):(u(),c("div",je,[M(i,{class:G(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((o=x(f).query)==null?void 0:o.view)==="userwise"?"bg-blue-500 text-white":""]),to:{query:{...x(f).query,view:"userwise"}}},{default:h(()=>e[25]||(e[25]=[R(" User Wise List ")])),_:1,__:[25]},8,["class","to"]),M(i,{class:G(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((v=x(f).query)==null?void 0:v.view)!=="userwise"?"bg-blue-500 text-white":""]),to:{query:{...Object.keys(((q=x(f))==null?void 0:q.query)||{}).filter(t=>{var C;return((C=x(f))==null?void 0:C.query[t])!=="userwise"}).reduce((t,C)=>({...t,[C]:x(f).query[C]}),{})}}},{default:h(()=>e[26]||(e[26]=[R(" Department Wise List ")])),_:1,__:[26]},8,["class","to"])]))])])}}};export{Pe as _};
