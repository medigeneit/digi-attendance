import{u as B,f as j,D as M,r as m,h as N,q as w,x as T,p as V,c as y,o as a,a as t,d as v,k,v as F,H as E,m as b,j as A,F as H,e as P,t as n,i as $,l as L}from"./index-I6EODA-h.js";import{_ as W}from"./EmployeeFilter-BV3Khxu-.js";import{L as z}from"./LoaderView-BAOlXwI8.js";import{u as G}from"./leave-application-DptDTiIe.js";import{u as I}from"./user-Dk6sqI0O.js";import"./company-SvxLzhXO.js";import"./department-DwHH1zRc.js";import"./EmployeeDropdownInput-Bw9b7UoW.js";import"./SelectDropdown-CgtTL0JS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-Dl28cZuL.js";const J={class:"space-y-2 px-4"},K={class:"flex flex-wrap gap-2"},O={key:0,class:"text-center py-4"},Q={key:1,class:"space-y-4"},X={class:"overflow-x-auto"},Y={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Z={class:"border border-gray-300 px-2"},ee={class:"border border-gray-300 px-2"},te={class:"border border-gray-300 px-2"},se={class:"border border-gray-300 px-2"},re={class:"border border-gray-300 px-2"},de={class:"border border-gray-300 px-2"},oe=["innerHTML"],le={class:"border border-gray-300 px-2"},ae={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},ue={class:"flex justify-center gap-2"},ye=["onClick"],ie={key:0},Le={__name:"LeaveApplicationList",setup(me){const _=B(),d=j(),o=G(),f=I(),{leaveApplications:q,loading:c}=M(o),S=m(null),i=m(d.query.date||o.selectedMonth),U=m(d.query.search||""),r=m({company_id:d.query.company_id||"",department_id:d.query.department_id||"all",line_type:d.query.line_type||"all",employee_id:d.query.employee_id||"",category:""}),u=async()=>{const l={company_id:r.value.company_id,department_id:r.value.department_id,line_type:r.value.line_type,selectedDate:i.value,selectedStatus:o.selectedStatus,query:U.value};r.value.employee_id&&(l.user_id=r.value.employee_id),c.value=!0,await o.fetchLeaveApplications(l),c.value=!1};N(async()=>{r.value.employee_id&&(await f.fetchUser(r.value.employee_id),S.value=f.user||null),await u()}),w(()=>[r.value.company_id,r.value.department_id,r.value.line_type,r.value.employee_id,i.value],async()=>{await u()}),w(()=>i.value,l=>{_.replace({query:{...d.query,date:l}}),u()});const p=T(()=>q.value||[]),C=async l=>{confirm("Are you sure to delete this application?")&&(await o.deleteLeaveApplication(l),await u())},R=()=>_.go(-1),D=()=>{_.replace({query:{...d.query,company_id:r.value.company_id,department_id:r.value.department_id,line_type:r.value.line_type,employee_id:r.value.employee_id}})};return(l,s)=>{const g=V("RouterLink");return a(),y("div",J,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:R},s[6]||(s[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),s[7]||(s[7]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Leave Applications",-1)),s[8]||(s[8]=t("div",null,null,-1))]),t("div",K,[v(W,{company_id:r.value.company_id,"onUpdate:company_id":s[0]||(s[0]=e=>r.value.company_id=e),department_id:r.value.department_id,"onUpdate:department_id":s[1]||(s[1]=e=>r.value.department_id=e),employee_id:r.value.employee_id,"onUpdate:employee_id":s[2]||(s[2]=e=>r.value.employee_id=e),line_type:r.value.line_type,"onUpdate:line_type":s[3]||(s[3]=e=>r.value.line_type=e),"with-type":!0,"initial-value":l.$route.query,onFilterChange:D},null,8,["company_id","department_id","employee_id","line_type","initial-value"]),t("div",null,[k(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[4]||(s[4]=e=>i.value=e),onChange:u,class:"input-1"},null,544),[[F,i.value]])]),t("div",null,[k(t("select",{"onUpdate:modelValue":s[5]||(s[5]=e=>b(o).selectedStatus=e),onChange:u,class:"input-1"},s[9]||(s[9]=[t("option",{value:"",selected:""},"All",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Rejected"},"Rejected",-1)]),544),[[E,b(o).selectedStatus]])])]),b(o).loading?(a(),y("div",O,[v(z)])):(a(),y("div",Q,[t("div",X,[t("table",Y,[s[14]||(s[14]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border border-gray-300 px-2 text-left"},"#"),t("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),t("th",{class:"border border-gray-300 px-2 text-left"},"Last Working Day"),t("th",{class:"border border-gray-300 px-2 text-left"},"Resumption Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Leave Period"),t("th",{class:"border border-gray-300 px-2 text-left"},"Total Days"),t("th",{class:"border border-gray-300 px-2 text-left"},"Type"),t("th",{class:"border border-gray-300 px-2 text-left"},"Status"),t("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),t("tbody",null,[(a(!0),y(H,null,P(p.value,(e,x)=>{var h;return a(),y("tr",{key:x,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",Z,n(x+1),1),t("td",ee,n(((h=e==null?void 0:e.user)==null?void 0:h.name)||"Unknown"),1),t("td",te,n(e==null?void 0:e.last_working_date),1),t("td",se,n(e==null?void 0:e.resumption_date),1),t("td",re,n(e==null?void 0:e.leave_period),1),t("td",de,[t("div",{innerHTML:e.duration||(e==null?void 0:e.total_leave_days)},null,8,oe)]),t("td",le,n(e==null?void 0:e.application_types),1),t("td",ae,n((e==null?void 0:e.status)||"N/A"),1),t("td",ne,[t("div",ue,[v(g,{to:{name:"LeaveApplicationShow",params:{id:e==null?void 0:e.id}},class:"btn-icon"},{default:L(()=>s[10]||(s[10]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[10]},1032,["to"]),(e==null?void 0:e.status)!=="Rejected"?(a(),$(g,{key:0,to:{name:"LeaveApplicationEdit",params:{id:e==null?void 0:e.id}},class:"btn-icon"},{default:L(()=>s[11]||(s[11]=[t("i",{class:"far fa-edit text-orange-600"},null,-1)])),_:2,__:[11]},1032,["to"])):A("",!0),t("button",{onClick:_e=>C(e==null?void 0:e.id),class:"btn-icon text-red-500"},s[12]||(s[12]=[t("i",{class:"far fa-trash"},null,-1)]),8,ye)])])])}),128)),p.value.length?A("",!0):(a(),y("tr",ie,s[13]||(s[13]=[t("td",{colspan:"7",class:"p-1 text-center text-red-500"},"No application found",-1)])))])])])]))])}}};export{Le as default};
