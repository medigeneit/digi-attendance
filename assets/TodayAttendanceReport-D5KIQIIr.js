import{u as N,f as j,D as z,r as p,x as v,h as O,q as L,p as W,c as r,o,a as e,i as x,t as n,d as Q,k as E,H as G,F as k,e as w,v as J,m as K,s as m,b as X,j as $,l as q}from"./index-xRQ_62kI.js";import{L as Y}from"./LoaderView-DVXcBrti.js";import{_ as Z}from"./EmployeeFilter-ACNS-V4k.js";import{u as ee}from"./attendance-DEjhy4WO.js";import{u as te}from"./company-D_lBB9wo.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./department-CIrVQAcB.js";import"./EmployeeDropdownInput-DEDKFf0c.js";import"./SelectDropdown-DXsJjjD4.js";import"./UserChip-s8R6EcAb.js";const ae={class:"px-4 space-y-6"},le={class:"report-hero glass-panel"},ne={class:"report-hero__left"},oe={class:"title-md md:title-lg"},ie={class:"glass-panel space-y-3 compact-panel relative z-50"},de={class:"filter-grid"},re={class:"flex justify-end gap-4 w-full"},ce={class:"filter-inline"},ue=["value"],pe={class:"filter-inline"},_e={key:1},ye={key:0,class:"empty-state glass-panel"},ve={key:1,class:"empty-state glass-panel"},me={key:2,class:"space-y-3"},fe={class:"compact-stats"},he={class:"table-shell"},be={class:"table-scroll"},xe={class:"min-w-full table-auto border-collapse"},ke={class:"text-[11px] text-center"},we={class:"td"},De={class:"td text-left"},Se={class:"font-semibold text-slate-800"},Ae={class:"text-[11px] text-slate-400"},Ce={class:"td text-left"},Le={class:"td"},Ee={class:"td"},$e=["title"],qe=["title"],Te=["title"],Pe={class:"td"},Re={class:"td"},Be={class:"td"},Fe={class:"td"},He={__name:"TodayAttendanceReport",setup(Ue){const D=N(),c=j(),T=te(),_=ee(),{dailyLogs:S}=z(_),P=p(c.query.company_id||""),R=p(c.query.department_id||""),f=p(c.query.employee_id||""),u=p(c.query.date||_.selectedDate||""),i=p(c.query.status||"all"),B=p(c.query.line_type||"all"),F=[{label:"All Status",value:"all"},{label:"Present",value:"Present"},{label:"Absent",value:"Absent"},{label:"Weekend",value:"Weekend"},{label:"Holiday",value:"Holiday"},{label:"Leave",value:"Leave"}],l=p({company_id:P.value,department_id:R.value,line_type:B.value,employee_id:f.value}),h=v(()=>Array.isArray(S.value)?S.value:[]),H=v(()=>`Today ${i.value&&i.value!=="all"?i.value:"Attendance"} Report`),U=v(()=>{const a=h.value,s=a.length,d=t=>a.filter(y=>y.status===t).length;return[{label:"Records",value:s,tone:"neutral"},{label:"Present",value:d("Present"),tone:"success"},{label:"Leave/Holiday",value:d("Leave")+d("Holiday"),tone:"info"},{label:"Absent",value:d("Absent"),tone:"danger"}]}),V=v(()=>!!l.value.company_id),A=async()=>{const{company_id:a,department_id:s,employee_id:d,line_type:t}=l.value;(a||i.value&&i.value!=="all")&&await _.getTodayAttendanceReport({companyId:l.value.company_id,departmentId:s,employee_id:d,line_type:t,month:u.value,status:i.value})},b=()=>{const a={company_id:l.value.company_id,department_id:l.value.department_id,line_type:l.value.line_type,employee_id:l.value.employee_id,date:u.value,status:i.value};Object.entries(a).some(([d,t])=>c.query[d]!==String(t))&&D.replace({query:a})},g=()=>{var a;return _.attendanceDownloadExcel(l.value.company_id,(a=f.value)==null?void 0:a.id,l.value.line_type,u.value,i.value)},I=()=>{var a;return _.attendanceDownloadPdf(l.value.company_id,(a=f.value)==null?void 0:a.id,l.value.line_type,u.value,i.value)},C=a=>{if(a.absent_reason)return a.absent_reason.includes("Approved")?{text:a.absent_reason,tone:"success"}:a.absent_reason.includes("Pending")?{text:a.absent_reason,tone:"warning"}:{text:a.absent_reason,tone:"neutral"};const s={Present:"success",Holiday:"info",Leave:"neutral",Weekend:"neutral",Absent:"danger"};return{text:a.status,tone:s[a.status]||"neutral"}},M=()=>D.go(-1);return O(async()=>{await T.fetchCompanies(),await A()}),L(u,a=>{b()}),L(i,()=>{b()}),(a,s)=>{const d=W("router-link");return o(),r("div",ae,[e("div",le,[e("div",ne,[e("button",{class:"btn-3 !h-10 !w-10 rounded-full shadow-sm",onClick:M},s[6]||(s[6]=[e("i",{class:"far fa-arrow-left"},null,-1)])),e("div",null,[s[7]||(s[7]=e("p",{class:"hero-eyebrow"},"Today overview",-1)),e("h1",oe,n(H.value),1)])]),e("div",{class:"report-hero__actions"},[e("button",{type:"button",class:"btn-1 hero-action",onClick:g},s[8]||(s[8]=[e("i",{class:"far fa-file-excel text-green-500"},null,-1),e("span",null,"Excel",-1)])),e("button",{type:"button",class:"btn-1 hero-action",onClick:I},s[9]||(s[9]=[e("i",{class:"fal fa-file-pdf text-red-500"},null,-1),e("span",null,"PDF",-1)]))])]),e("div",ie,[e("div",de,[Q(Z,{company_id:l.value.company_id,"onUpdate:company_id":s[0]||(s[0]=t=>l.value.company_id=t),department_id:l.value.department_id,"onUpdate:department_id":s[1]||(s[1]=t=>l.value.department_id=t),employee_id:l.value.employee_id,"onUpdate:employee_id":s[2]||(s[2]=t=>l.value.employee_id=t),line_type:l.value.line_type,"onUpdate:line_type":s[3]||(s[3]=t=>l.value.line_type=t),"with-type":!0,"initial-value":a.$route.query,onFilterChange:b,class:"w-full"},null,8,["company_id","department_id","employee_id","line_type","initial-value"]),e("div",re,[e("div",ce,[E(e("select",{id:"userSelect","onUpdate:modelValue":s[4]||(s[4]=t=>i.value=t),class:"input-1 py-1 min-w-40"},[(o(),r(k,null,w(F,t=>e("option",{key:t.value,value:t.value},n(t.label),9,ue)),64))],512),[[G,i.value]])]),e("div",pe,[E(e("input",{type:"date","onUpdate:modelValue":s[5]||(s[5]=t=>u.value=t),class:"input-1 py-1 min-w-40"},null,512),[[J,u.value]])]),e("div",{class:"filter-inline self-end"},[e("button",{type:"button",onClick:A,class:"btn-1 px-6"},"Search")])])])]),K(_).isLoading?(o(),x(Y,{key:0})):(o(),r("div",_e,[V.value?h.value.length===0?(o(),r("div",ve,s[11]||(s[11]=[e("p",{class:"text-base font-semibold text-slate-700"},"No records found",-1),e("p",{class:"text-sm text-gray-500"},"Adjust filters or pick a different date/status.",-1)]))):(o(),r("div",me,[e("div",fe,[(o(!0),r(k,null,w(U.value,t=>(o(),r("div",{key:t.label,class:m(["compact-stats__chip",`compact-stats__chip--${t.tone}`])},[e("span",null,n(t.label),1),e("strong",null,n(t.value),1)],2))),128))]),e("div",he,[e("div",be,[e("table",xe,[s[14]||(s[14]=e("thead",{class:"sticky top-0 z-10 bg-slate-50"},[e("tr",{class:"text-[11px] text-slate-600"},[e("th",{class:"th"},"#"),e("th",{class:"th text-left"},"Employee"),e("th",{class:"th text-left"},"Department"),e("th",{class:"th"},"Date"),e("th",{class:"th"},"Day"),e("th",{class:"th"},"Shift"),e("th",{class:"th"},"Entry"),e("th",{class:"th"},"Exit"),e("th",{class:"th"},"Hours"),e("th",{class:"th"},"Late"),e("th",{class:"th"},"Early"),e("th",{class:"th"},"Status")])],-1)),e("tbody",ke,[(o(!0),r(k,null,w(h.value,(t,y)=>(o(),r("tr",{key:`${t==null?void 0:t.date}-${y}`,class:"table-row"},[e("td",we,n(y+1),1),e("td",De,[e("p",Se,n(t.user_name),1),e("p",Ae,"ID: "+n(t.user_id||"-"),1)]),e("td",Ce,n(t.department),1),e("td",Le,n(t.date),1),e("td",Ee,n(t.weekday),1),e("td",{class:"td",title:`${t.shift_start_time} to ${t.shift_end_time}`},n(t.shift_name),9,$e),e("td",{class:m(["td td--alert",{"td--danger":t.late_duration}]),title:`Device: ${t.entry_device}`},n(t.entry_time),11,qe),e("td",{class:m(["td td--alert",{"td--danger":t.early_leave_duration}]),title:`Device: ${t.exit_device}`},n(t.exit_time),11,Te),e("td",Pe,n(t.working_hours),1),e("td",Re,n(t.late_duration||"-"),1),e("td",Be,n(t.early_leave_duration||"-"),1),e("td",Fe,[e("div",{class:m(["status-chip",`status-chip--${C(t).tone}`])},[X(n(C(t).text)+" ",1),t.application_id?(o(),x(d,{key:0,to:{name:"LeaveApplicationShow",params:{id:t.application_id}},class:"status-link"},{default:q(()=>s[12]||(s[12]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[12]},1032,["to"])):$("",!0),t.exchange_application_id?(o(),x(d,{key:1,to:{name:"ExchangeOffdayShow",params:{id:t.exchange_application_id}},class:"status-link"},{default:q(()=>s[13]||(s[13]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[13]},1032,["to"])):$("",!0)],2)])]))),128))])])])])])):(o(),r("div",ye,s[10]||(s[10]=[e("p",{class:"text-base font-semibold text-rose-500"},"Select a company to see today's logs.",-1),e("p",{class:"text-sm text-gray-500"},"Use the filter set above to load records.",-1)])))]))])}}},Ge=se(He,[["__scopeId","data-v-2e2084c2"]]);export{Ge as default};
