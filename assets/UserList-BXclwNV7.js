import{S as ye,r as h,q as O,h as $t,x as w,y as _e,j as Ne,o as d,d as U,m as B,c as r,k as S,a as t,T as me,t as a,F as Z,e as X,b as q,l as vt,H as De,v as At,Z as je,A as zt,_ as Ie,u as Le,f as Ve,g as Me,D as it,G as fe,p as Pe,n as T,w as at,s as x,C as We}from"./index-rh_aQaub.js";import{_ as Te}from"./EmployeeFilter-BFbPuiGG.js";import{L as Oe}from"./LoaderView-Dmom3oqu.js";import{d as ue}from"./dayjs.min-DZAbuHJp.js";import{u as xe}from"./shift-DVM794Oq.js";import{_ as Re}from"./WeekendAssignModal-CwCg0g9n.js";import{C as Ke}from"./CriteriaAssignModal-D81w7C3g.js";import{_ as Be}from"./FlexibleDatePicker-EeWUUjZz.js";import{u as Fe}from"./company-C47YjgfS.js";import{u as He}from"./department-SjrTQ2u6.js";import{u as Ye}from"./user-L-BuYhcK.js";import{u as Qe}from"./userClearance-CijkuabX.js";import"./EmployeeDropdownInput-DRF3Xqdg.js";import"./SelectDropdown-BesA1ylz.js";import"./UserChip-CaKbs_MR.js";import"./monthly-kpi-assignments-DeHuoKcB.js";const Ge={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Je={class:"relative w-full max-w-xl rounded-2xl bg-white shadow-xl ring-1 ring-black/5 p-5"},Ze={class:"flex items-start justify-between mb-4"},Xe={class:"flex items-center gap-3"},ts={class:"h-10 w-10 rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center font-semibold"},es={class:"text-base font-semibold text-gray-900"},ss={class:"text-xs text-gray-500"},ns={class:"flex flex-col gap-2"},is={class:"md:col-span-5"},as={class:"rounded-lg border bg-white p-2"},os={class:"flex items-center justify-between mb-2"},ls={class:"text-xs text-gray-500"},ds={key:0,class:"text-sm text-gray-500"},rs={key:1},cs=["checked"],ps={class:"flex-1"},ms={class:"flex items-center gap-2"},fs={class:"text-sm text-gray-900"},us={key:0,class:"inline-flex items-center text-xs font-medium rounded-full bg-green-100 text-green-700 px-2 py-0.5"},ys={key:1,class:"inline-flex items-center text-xs font-medium rounded-full bg-gray-100 text-gray-700 px-2 py-0.5"},_s={class:"mt-0.5 text-xs text-gray-600"},xs={key:0,class:"ml-2 text-gray-400"},gs={class:"rounded-lg border bg-white p-4"},bs={class:"grid gap-4 md:grid-cols-12"},vs={class:"md:col-span-12"},hs=["disabled"],ws=["value"],ks={key:0,class:"mt-1 text-xs text-gray-500"},Ss={class:"md:col-span-6"},Cs={class:"mt-4 flex justify-end gap-2"},$s=["disabled"],As=["disabled"],zs={key:0},Es={key:1},qs={__name:"ShiftAssignmentModal",props:{modelValue:{type:Boolean,default:!1},isOpen:{type:Boolean,default:!1},employee:{type:Object,default:()=>({id:0,name:""})},shifts:{type:[Array,Object],default:()=>[]},hasShift:{type:Object,default:null},current_shift:{type:Object,default:null},shift_history:{type:[Object,Array,null],default:null}},emits:["update:modelValue","saved","close"],setup(ot,{emit:lt}){var y;const p=ot,F=lt,tt=ye(),dt=xe(),v=h(!1);O(()=>p.modelValue,i=>{i!==v.value&&(v.value=i)}),O(()=>p.isOpen,i=>{i!==v.value&&(v.value=i)}),$t(()=>{v.value=!!(p.modelValue||p.isOpen)});function j(){v.value&&(v.value=!1,F("update:modelValue",!1),F("close",!1))}const g=h({shift_id:"",employee_id:((y=p.employee)==null?void 0:y.id)||0,start_date:"",end_date:""});O(()=>p.employee,i=>{g.value.employee_id=(i==null?void 0:i.id)||0},{immediate:!0,deep:!0});const N=w(()=>{var C,f,L,I;const i=((C=p.employee)==null?void 0:C.name)||String(((f=p.employee)==null?void 0:f.id)||""),l=i.trim().split(/\s+/);return((((L=l[0])==null?void 0:L[0])||"")+(((I=l[1])==null?void 0:I[0])||"")||i[0]||"#").toUpperCase().slice(0,2)});function H(i){return i?typeof i=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(i)?i:ue(i).isValid()?ue(i).format("YYYY-MM-DD"):"":""}const rt=w(()=>{const i=p.shifts;return Array.isArray(i)?i:i&&typeof i=="object"?Object.values(i).flat().filter(Boolean):[]}),ht=w(()=>{const i=p.shift_history;return i&&typeof i=="object"&&Array.isArray(i.history)?i.history:Array.isArray(i)?i:i?[i]:[]}),V=w(()=>ht.value.map(i=>{var l,_;return{id:i.id??null,name:((l=i==null?void 0:i.shift)==null?void 0:l.name)||(i==null?void 0:i.name)||`#${(i==null?void 0:i.shift_id)||(i==null?void 0:i.id)||"—"}`,shift_id:((_=i==null?void 0:i.shift)==null?void 0:_.id)??(i==null?void 0:i.shift_id)??null,start_date:H(i.start_date),end_date:H(i.end_date),status:i.status||(i.end_date?"ended":"active"),days:i.days??null,active:!i.end_date||i.status==="active",created_at:i.created_at?new Date(i.created_at).getTime():0}}).sort((i,l)=>i.active!==l.active?i.active?-1:1:(l.start_date||"").localeCompare(i.start_date||""))),wt=w(()=>{const i=p.shift_history;return i&&typeof i=="object"&&typeof i.count=="number"?i.count:V.value.length}),R=w(()=>{var _,C;const i=V.value.find(f=>f.active);if(i)return i;const l=p.current_shift||p.hasShift;return l?{id:l.id??null,name:((_=l==null?void 0:l.shift)==null?void 0:_.name)||(l==null?void 0:l.name)||`#${(l==null?void 0:l.shift_id)||(l==null?void 0:l.id)||"—"}`,shift_id:((C=l==null?void 0:l.shift)==null?void 0:C.id)??(l==null?void 0:l.shift_id)??null,start_date:H(l.start_date),end_date:H(l.end_date),active:!l.end_date}:null});async function ct(){const i=R.value;i?(g.value.shift_id=String(i.shift_id||""),g.value.start_date=H(i.start_date)||"",g.value.end_date=H(i.end_date)||""):(g.value.shift_id="",g.value.start_date="",g.value.end_date="")}O(v,(i,l)=>{i&&!l&&zt(ct)}),O([R,()=>p.shift_history],()=>{v.value&&zt(ct)});const K=h(!1),D=w(()=>!!g.value.employee_id&&!!g.value.shift_id&&!!g.value.start_date&&!K.value);async function pt(){var i,l;try{if(!D.value){tt.error("All required fields must be filled");return}K.value=!0;const _={employee_id:Number(g.value.employee_id),shift_id:Number(g.value.shift_id),start_date:g.value.start_date,end_date:g.value.end_date||null},C=await dt.shiftAssign(_);tt.success(R.value?"Shift updated":"Shift assigned"),F("saved",C),j()}catch(_){const C=((l=(i=_==null?void 0:_.response)==null?void 0:i.data)==null?void 0:l.message)||"Failed to assign shift";tt.error(C)}finally{K.value=!1}}function Y(i){v.value&&(i.key==="Escape"&&j(),(i.ctrlKey||i.metaKey)&&i.key.toLowerCase()==="enter"&&D.value&&pt())}return $t(()=>window.addEventListener("keydown",Y)),_e(()=>window.removeEventListener("keydown",Y)),(i,l)=>(d(),Ne(je,{to:"body"},[U(me,{name:"fade"},{default:B(()=>[v.value?(d(),r("div",Ge,[t("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:j}),U(me,{name:"pop"},{default:B(()=>{var _,C;return[t("div",Je,[t("div",Ze,[t("div",Xe,[t("div",ts,a(N.value),1),t("div",null,[t("h3",es,a(R.value?"Update Shift":"Assign Shift"),1),t("p",ss,a(((_=ot.employee)==null?void 0:_.name)||"#"+(((C=ot.employee)==null?void 0:C.id)||"")),1)])]),t("button",{class:"btn-icon",onClick:j,"aria-label":"Close"},"✕")]),t("div",ns,[t("div",is,[t("div",as,[t("div",os,[l[2]||(l[2]=t("h4",{class:"text-sm font-semibold text-gray-800"},"Shift history",-1)),t("span",ls,a(wt.value)+" item(s)",1)]),V.value.length?(d(),r("ul",rs,[(d(!0),r(Z,null,X(V.value,(f,L)=>(d(),r("li",{key:f.id??L,class:"flex items-start gap-3"},[t("input",{type:"checkbox",class:"mt-1 rounded border-gray-300",checked:f.active,disabled:""},null,8,cs),t("div",ps,[t("div",ms,[t("span",fs,a(f.name),1),f.active?(d(),r("span",us,"Active")):(d(),r("span",ys,"Closed"))]),t("div",_s,[q(" Period: "+a(f.start_date||"—")+" → "+a(f.end_date||"present")+" ",1),f.days?(d(),r("span",xs,"("+a(f.days)+" days)",1)):S("",!0)])])]))),128))])):(d(),r("div",ds," No history found "))])]),t("div",gs,[t("div",bs,[t("div",vs,[l[4]||(l[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select Shift",-1)),vt(t("select",{"onUpdate:modelValue":l[0]||(l[0]=f=>g.value.shift_id=f),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200",disabled:!rt.value.length},[l[3]||(l[3]=t("option",{value:""},"Choose a shift…",-1)),(d(!0),r(Z,null,X(rt.value,f=>(d(),r("option",{key:f==null?void 0:f.id,value:f==null?void 0:f.id},a(f==null?void 0:f.name),9,ws))),128))],8,hs),[[De,g.value.shift_id]]),rt.value.length?S("",!0):(d(),r("p",ks,"No shifts found"))]),t("div",Ss,[l[5]||(l[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),vt(t("input",{"onUpdate:modelValue":l[1]||(l[1]=f=>g.value.start_date=f),type:"date",class:"mt-1 w-full rounded-md border px-3 py-2"},null,512),[[At,g.value.start_date]])])]),t("div",Cs,[t("button",{class:"btn-3",onClick:j,disabled:K.value},"Cancel",8,$s),t("button",{class:"btn-2",onClick:pt,disabled:!D.value},[K.value?(d(),r("span",Es,"Processing…")):(d(),r("span",zs,a(R.value?"Update":"Assign"),1))],8,As)])])])])]}),_:1})])):S("",!0)]),_:1})]))}},Us={class:"space-y-3 p-5"},Ns={class:"flex items-center justify-between gap-2"},Ds={class:"flex gap-3"},js={key:0,class:"rounded-md border border-indigo-200 bg-indigo-50 p-3 text-sm text-indigo-800"},Is={class:"sticky top-14 z-40 -mx-5 px-5 py-3 bg-white/90 supports-[backdrop-filter]:bg-white/70 backdrop-blur border-b border-zinc-200"},Ls={class:"flex flex-col md:flex-row md:items-end gap-2"},Vs={class:"flex items-center gap-1"},Ms={class:"flex items-center gap-2 w-full md:w-auto"},Ps={class:"mt-2 flex flex-wrap gap-2 text-[12px]"},Ws={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Ts={class:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700"},Os={class:"px-2 py-1 rounded-full bg-rose-100 text-rose-700"},Rs={class:"px-2 py-1 rounded-full bg-amber-100 text-amber-800"},Ks={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Bs={class:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-800"},Fs={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Hs={key:1,class:"text-center py-6"},Ys={key:2,class:"space-y-4"},Qs={key:0,class:"text-center py-6 text-lg italic text-gray-500"},Gs={class:"grid grid-cols-1 gap-2 md:hidden"},Js={class:"flex items-start gap-3"},Zs={class:"h-10 w-10 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},Xs={class:"min-w-0"},tn={class:"font-medium leading-5 truncate"},en={class:"text-[12px] text-zinc-500"},sn={class:"mt-1 text-[12px] text-zinc-600"},nn={class:"text-[12px] text-zinc-600"},an={class:"mt-1"},on={class:"mt-1 text-[12px]"},ln=["href"],dn=["href"],rn={class:"mt-2 flex flex-wrap gap-1"},cn=["disabled","onClick"],pn=["disabled","onClick"],mn=["disabled","onClick"],fn=["onClick","title"],un={class:"hidden lg:inline"},yn={class:"hidden md:block"},_n={class:"group-scroll relative overflow-auto max-h-[70vh] rounded-md border border-zinc-200 bg-white shadow-sm"},xn={class:"group-sticky sticky top-0 z-40 flex items-center justify-between h-11 px-3 bg-white/95 backdrop-blur border-b border-zinc-200"},gn={class:"title-md"},bn={class:"min-w-full table-auto"},vn={class:"border border-gray-100 px-2 py-2"},hn={class:"border border-gray-100 px-3 py-2"},wn={class:"flex items-start gap-2"},kn={key:0,class:"h-8 w-8 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold overflow-hidden"},Sn=["src","alt"],Cn={key:1,class:"h-8 w-8 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},$n={class:"min-w-0"},An={class:"font-medium truncate max-w-[220px]"},zn={class:"text-[11px] text-zinc-500"},En={class:"text-[11px] text-zinc-500"},qn={class:"text-[11px] text-zinc-500"},Un={class:"border border-gray-100 px-2 py-2"},Nn={class:"flex items-center gap-2"},Dn=["href"],jn={class:"flex items-center gap-2"},In=["href"],Ln={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},Vn={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},Mn={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},Pn={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Wn=["onClick","title","disabled"],Tn={class:"ml-1 hidden lg:inline"},On={class:"mt-1 text-[11px] text-gray-500"},Rn={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Kn=["onClick","title","disabled"],Bn={class:"ml-1 hidden lg:inline"},Fn={class:"mt-1 text-[11px] text-gray-500"},Hn={class:"border border-gray-100 px-2 py-2"},Yn={key:0,class:"mt-1 text-[11px] text-rose-600"},Qn={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Gn=["onClick","title","disabled"],Jn={class:"ml-1 hidden lg:inline"},Zn={class:"border border-gray-100 px-2 py-2"},Xn={class:"flex gap-2"},ti=["onClick","title"],ei={class:"hidden lg:inline"},si={key:3,class:"fixed inset-0 z-[9999] flex items-center justify-center"},ni={class:"relative w-full max-w-lg rounded-lg bg-white shadow-xl"},ii={class:"space-y-4 p-4"},ai={class:"text-sm text-gray-600"},oi={class:"font-semibold text-gray-900"},li={class:"space-y-1"},di={class:"space-y-1"},ri={key:0,class:"rounded-md border border-red-200 bg-red-50 p-2 text-sm text-red-700"},ci={key:1,class:"rounded-md border border-amber-200 bg-amber-50 p-2 text-sm text-amber-800"},pi={class:"flex items-center justify-end gap-2 border-t bg-gray-50 px-4 py-3"},mi=["disabled"],fi={key:0},ui={key:1},yi=["disabled"],_i={key:0},xi={key:1},gi={key:4,class:"fixed inset-0 z-[9998] flex items-center justify-center"},bi={class:"relative w-full max-w-2xl rounded-lg bg-white shadow-xl"},vi={class:"space-y-4 p-4"},hi={class:"space-y-1 text-sm text-gray-600"},wi={class:"font-semibold text-gray-900"},ki={class:"font-medium"},Si={class:"font-medium"},Ci={class:"font-medium"},$i={key:0,class:"rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700"},Ai={id:"print-area",class:"print-area"},zi={class:"text-center"},Ei={class:"text-xl font-bold tracking-wide"},qi={class:"mt-4 grid grid-cols-2 gap-3 text-sm"},Ui={class:"font-medium"},Ni={class:"font-medium"},Di={class:"font-medium"},ji={class:"font-medium"},Ii={class:"mt-4 rounded-md border border-gray-200 p-3 text-sm"},Li={class:"font-medium"},Vi={class:"mt-1"},Mi={class:"font-medium"},Pi={class:"mt-4"},Wi={key:0,class:"text-sm text-gray-600"},Ti={key:1,class:"text-sm text-rose-600"},Oi={key:2,class:"w-full border border-gray-300 text-sm",style:{"border-collapse":"collapse"}},Ri={class:"border border-gray-300 px-2 py-1"},Ki={class:"border border-gray-300 px-2 py-1"},Bi={class:"border border-gray-300 px-2 py-1"},Fi={key:0},Hi={class:"mt-6 text-xs text-gray-500"},Yi={__name:"UserList",setup(ot){const lt=Le(),p=Ve(),F=ye(),tt=Me(),dt=Fe(),v=He(),j=Ye(),g=xe(),N=Qe(),{companies:H}=it(dt),{departments:rt}=it(v),{shifts:ht}=it(g),{users:V,isLoading:wt}=it(j),{items:R,loading:ct,error:K}=it(N),D=n=>{if(!n)return"";if(typeof n=="string")return n.slice(0,10);const e=new Date(n);return Number.isNaN(e.getTime())?"":e.toISOString().slice(0,10)},pt=()=>{const n=new Date;return new Date(n.getTime()-n.getTimezoneOffset()*6e4).toISOString().slice(0,10)},Y=n=>{const e=D(n==null?void 0:n.last_working_date);return!!e&&e<=pt()},y=n=>n!=null&&n.is_inactive||Y(n)?!0:Number((n==null?void 0:n.is_active)??0)===0,i=n=>{var e,c;return!!((c=(e=n==null?void 0:n.current_shift)==null?void 0:e.shift)!=null&&c.name)},l=n=>{var e,c;return((c=(e=n==null?void 0:n.current_shift)==null?void 0:e.shift)==null?void 0:c.name)||"Not Assigned"},_=n=>{var e;return Array.isArray((e=n==null?void 0:n.assign_weekend)==null?void 0:e.weekends)&&n.assign_weekend.weekends.length>0},C=n=>_(n)?n.assign_weekend.weekends.join(", "):"Not Assigned",f=(n,e)=>{var u,z,b;if(!e)return!0;const c=e.toLowerCase();return[n==null?void 0:n.name,n==null?void 0:n.phone,n==null?void 0:n.employee_id,(u=n==null?void 0:n.company)==null?void 0:u.name,(z=n==null?void 0:n.department)==null?void 0:z.name,(b=n==null?void 0:n.designation)==null?void 0:b.title].some($=>String($||"").toLowerCase().includes(c))},L=n=>!!D(n==null?void 0:n.last_working_date),I=n=>{const e=L(n),c=Y(n),u="inline-flex items-center gap-1.5 rounded-md border px-2.5 py-1.5 text-[12px] font-semibold transition focus:outline-none focus:ring-2 focus:ring-offset-1 active:scale-[.99]";return e?c?{label:"Edit Exit",icon:"far fa-circle-xmark",cls:`${u} border-rose-200 bg-rose-50 text-rose-700 hover:bg-rose-100 focus:ring-rose-300`,badgeCls:"bg-white/70 text-rose-800"}:{label:"Edit Exit",icon:"far fa-pen-to-square",cls:`${u} border-amber-200 bg-amber-50 text-amber-800 hover:bg-amber-100 focus:ring-amber-300`,badgeCls:"bg-white/70 text-amber-800"}:{label:"Set Exit",icon:"far fa-door-open",cls:`${u} border-zinc-300 bg-white text-zinc-700 hover:bg-zinc-50 focus:ring-zinc-300`,badgeCls:"bg-zinc-100 text-zinc-700"}},ge=w(()=>p.query.action==="clearance"),Et=w(()=>{var e;const n=String(((e=tt.user)==null?void 0:e.role)||"").toLowerCase();return["admin","super_admin","developer"].includes(n)}),o=fe({company:String(p.query.company??"all"),department:String(p.query.department??"all"),line_type:String(p.query.line_type??"all"),status:String(p.query.status??"active"),employee_id:String(p.query.employee_id??""),q:String(p.query.q??"")});let qt=null;const be=w(()=>{const n={};return o.company&&o.company!=="all"&&(n.company=o.company),o.department&&o.department!=="all"&&(n.department=o.department),o.line_type&&o.line_type!=="all"&&(n.line_type=o.line_type),o.status&&o.status!=="all"&&(n.status=o.status),o.employee_id&&(n.employee_id=o.employee_id),o.q&&(n.q=o.q),p.query.action&&(n.action=p.query.action),n});function ve(){clearTimeout(qt),qt=setTimeout(()=>{lt.replace({query:{...be.value}})},250)}O(o,ve,{deep:!0}),$t(async()=>{await dt.fetchCompanies(),o.company&&o.company!=="all"&&await v.fetchDepartments(o.company),Ut()}),O(()=>p.query,()=>Ut(),{deep:!0});async function Ut(){await j.fetchUsers({company_id:p.query.company,department_id:p.query.department,line_type:p.query.line_type,status:p.query.status,user_id:p.query.employee_id,q:p.query.q})}O(()=>o.company,async(n,e)=>{var c;n!==e&&(n&&n!=="all"?await v.fetchDepartments(n):(c=v.$reset)==null||c.call(v))});const he=()=>lt.go(-1),we=n=>{if(o.status==="all")return!0;const e=y(n);return o.status==="active"?!e:e},Nt=w(()=>(Array.isArray(V.value)?V.value:[]).filter(e=>{var c;return!(o.company!=="all"&&String((c=e==null?void 0:e.company)==null?void 0:c.id)!==String(o.company)||o.line_type!=="all"&&String(e==null?void 0:e.type)!==String(o.line_type)||o.employee_id&&String(e==null?void 0:e.id)!==String(o.employee_id)||!we(e)||!f(e,o.q))})),Q=w(()=>{const n=Nt.value,e=n.length,c=n.filter(b=>Number((b==null?void 0:b.is_active)??0)===1).length,u=n.filter(b=>i(b)).length,z=n.filter(b=>_(b)).length;return{total:e,active:c,inactive:e-c,withShift:u,withoutShift:e-u,withWeekend:z,withoutWeekend:e-z}}),Dt=w(()=>{var e;const n={};for(const c of Nt.value){const u=((e=c==null?void 0:c.company)==null?void 0:e.name)||"Unknown Company";(n[u]??(n[u]=[])).push(c)}return n});h(null);const E=h(null),et=h(null),jt=h(null),mt=h(!1),st=h(!1),ft=h(!1),nt=h(!1),k=h(null),A=fe({last_working_date:"",exit_reason:""}),It=w({get(){if(!A.last_working_date)return{year:null,month:null,day:null};const[n,e,c]=A.last_working_date.split("-");return{year:Number(n)||null,month:Number(e)||null,day:Number(c)||1}},set(n){if(!n){A.last_working_date="";return}const e=Number(n.year)||null,c=Number(n.month)||null,u=Number(n.day)||1;if(!e||!c){A.last_working_date="";return}const z=String(c).padStart(2,"0"),b=String(Math.min(u,31)).padStart(2,"0");A.last_working_date=`${e}-${z}-${b}`}}),ut=h(!1),M=h(""),yt=h(!1),P=h(""),G=w(()=>k.value),ke=w(()=>{var n,e;return((e=(n=G.value)==null?void 0:n.company)==null?void 0:e.name)||"Digi Attendance"}),Lt=w(()=>(Array.isArray(R.value)?R.value:[]).map(e=>{const c=e.latest||{};return{label:e.label||e.template_item_name||e.item_key||`#${e.template_item_id??e.id??""}`,status:c.status||e.status||(e.is_cleared?"COMPLETED":"PENDING"),remarks:c.remarks||e.remarks||""}}));async function Vt(n){if(E.value=n,n!=null&&n.company_id){const e=await j.fetchUserShifts(n.id);jt.value=e,await g.fetchShifts(n.company_id)}mt.value=!0}async function Mt(n){E.value=n,st.value=!0;try{const e=await j.fetchUserWeekends(n.id);et.value=e}catch{et.value={history:[],current:null}}}function Se(){st.value=!1,et.value=null}function Ce(n){st.value=!1;const e=n==null?void 0:n.current;e&&E.value&&(E.value.assign_weekend={weekends:e.weekends||[],start_month:e.start_month,end_month:e.end_month}),et.value=null}function Pt(n){E.value=n,ft.value=!0}function Wt(n){n!=null&&n.id&&(k.value=n,A.last_working_date=D(n==null?void 0:n.last_working_date),A.exit_reason=(n==null?void 0:n.exit_reason)||"",M.value="",P.value="",nt.value=!0)}function _t(){nt.value=!1,M.value="",P.value=""}function kt(n){n.key==="Escape"&&_t()}const xt=h(!1);async function $e(){var n,e,c,u,z,b,$;if(!(!((n=k.value)!=null&&n.id)||!((e=k.value)!=null&&e.last_working_date))){yt.value=!0,P.value="";try{(c=N.resetFilters)==null||c.call(N),(u=N.setUser)==null||u.call(N,k.value.id),await((z=N.fetch)==null?void 0:z.call(N)),xt.value=!0}catch(W){P.value=(($=(b=W==null?void 0:W.response)==null?void 0:b.data)==null?void 0:$.message)||"Failed to load clearance for print.",F.error(P.value)}finally{yt.value=!1}}}async function Ae(){document.body.classList.add("printing-exit");try{await zt(),window.print()}finally{xt.value=!1,setTimeout(()=>document.body.classList.remove("printing-exit"),0)}}function St(){xt.value=!1}async function ze(){var n,e,c;if(!((n=k.value)!=null&&n.id)){M.value="Select a user first.";return}if(!A.last_working_date){M.value="Last working date is required.";return}ut.value=!0,M.value="";try{await We.put(`/users/${k.value.id}/exit`,{last_working_date:A.last_working_date,exit_reason:A.exit_reason||null});const u=$=>{$&&($.last_working_date=A.last_working_date,$.exit_reason=A.exit_reason||"",$.is_inactive=Y($))};u(k.value);const b=(Array.isArray(V.value)?V.value:[]).find($=>{var W;return $.id===((W=k.value)==null?void 0:W.id)});u(b),nt.value=!1,F.success("Exit information updated.")}catch(u){M.value=((c=(e=u==null?void 0:u.response)==null?void 0:e.data)==null?void 0:c.message)||"Failed to update exit info.",F.error(M.value)}finally{ut.value=!1}}async function Ee(){await j.fetchUsersExcelExport({data:{company_id:o.company!=="all"?o.company:void 0,department_id:o.department!=="all"?o.department:void 0,line_type:o.line_type!=="all"?o.line_type:void 0,status:o.status!=="all"?o.status:void 0,employee_id:o.employee_id||void 0,q:o.q||void 0}})}function qe(){ft.value=!1}function Ue(){o.company="all",o.department="all",o.line_type="all",o.status="active",o.employee_id="",o.q=""}return O(nt,n=>{n?window.addEventListener("keydown",kt):(window.removeEventListener("keydown",kt),k.value=null)}),_e(()=>{window.removeEventListener("keydown",kt)}),(n,e)=>{var u,z,b,$,W,Tt,Ot,Rt,Kt,Bt,Ft,Ht,Yt,Qt,Gt,Jt,Zt,Xt,te,ee,se,ne,ie;const c=Pe("RouterLink");return d(),r("div",Us,[t("div",Ns,[t("button",{class:"btn-3",onClick:he},e[16]||(e[16]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[19]||(e[19]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Employee List",-1)),t("div",Ds,[U(c,{to:{name:"UserAdd",query:{company:T(p).query.company}},class:"btn-2"},{default:B(()=>e[17]||(e[17]=[t("span",{class:"hidden md:flex"},"Add New",-1),t("i",{class:"far fa-plus"},null,-1)])),_:1,__:[17]},8,["to"]),t("button",{type:"button",onClick:Ee,class:"btn-3"},e[18]||(e[18]=[t("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1),q("Excel ")]))])]),ge.value?(d(),r("div",js," Select a user to view clearance & print. ")):S("",!0),t("div",Is,[t("div",Ls,[U(Te,{company_id:o.company,"onUpdate:company_id":e[3]||(e[3]=m=>o.company=m),department_id:o.department,"onUpdate:department_id":e[4]||(e[4]=m=>o.department=m),employee_id:o.employee_id,"onUpdate:employee_id":e[5]||(e[5]=m=>o.employee_id=m),line_type:o.line_type,"onUpdate:line_type":e[6]||(e[6]=m=>o.line_type=m),"with-type":!0,"initial-value":n.$route.query,class:"w-full"},{default:B(()=>[t("div",Vs,[t("button",{class:x(["h-8 px-3 text-xs rounded-l-md border transition",o.status==="all"?"bg-zinc-800 text-white border-zinc-800":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:e[0]||(e[0]=at(m=>o.status="all",["prevent"]))},"All",2),t("button",{class:x(["h-8 px-3 text-xs border-y transition",o.status==="active"?"bg-emerald-600 text-white border-emerald-600":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:e[1]||(e[1]=at(m=>o.status="active",["prevent"]))},"Active",2),t("button",{class:x(["h-8 px-3 text-xs rounded-r-md border transition",o.status==="in_active"?"bg-rose-600 text-white border-rose-600":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:e[2]||(e[2]=at(m=>o.status="in_active",["prevent"]))},"Inactive",2)])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"]),t("div",Ms,[vt(t("input",{"onUpdate:modelValue":e[7]||(e[7]=m=>o.q=m),type:"text",placeholder:"Search name / phone / ID",class:"input-1 h-8 text-sm w-full md:w-64"},null,512),[[At,o.q,void 0,{trim:!0}]]),t("button",{type:"button",onClick:Ue,class:"inline-flex h-8 items-center rounded-md border border-zinc-300 bg-zinc-50 px-3 text-[12px] font-medium text-zinc-700 hover:bg-white active:scale-[.99]",title:"Reset filters"},e[20]||(e[20]=[t("i",{class:"far fa-undo mr-1"},null,-1),q(" Reset ")]))])]),t("div",Ps,[t("span",Ws,"Total: "+a(Q.value.total),1),t("span",Ts,"Active: "+a(Q.value.active),1),t("span",Os,"Inactive: "+a(Q.value.inactive),1),t("span",Rs,"With Shift: "+a(Q.value.withShift),1),t("span",Ks,"No Shift: "+a(Q.value.withoutShift),1),t("span",Bs,"With Weekend: "+a(Q.value.withWeekend),1),t("span",Fs,"No Weekend: "+a(Q.value.withoutWeekend),1)])]),T(wt)?(d(),r("div",Hs,[U(Oe)])):(d(),r("div",Ys,[Object.keys(Dt.value).length===0?(d(),r("div",Qs," No users found ")):S("",!0),(d(!0),r(Z,null,X(Dt.value,(m,gt)=>(d(),r("div",{key:gt,class:"space-y-2"},[t("div",Gs,[(d(!0),r(Z,null,X(m,s=>{var bt;return d(),r("div",{key:s.id,class:"rounded-lg border border-zinc-200 bg-white p-3 shadow-sm"},[t("div",Js,[t("div",Zs,a(((s==null?void 0:s.name)||"?").charAt(0).toUpperCase()),1),t("div",Xs,[t("div",tn,a(s==null?void 0:s.name),1),t("div",en,"ID: "+a(s==null?void 0:s.employee_id)+" • "+a(((bt=s==null?void 0:s.designation)==null?void 0:bt.title)||"—"),1),t("div",sn,"Shift: "+a(l(s)),1),t("div",nn,"Weekend: "+a(C(s)),1),t("div",an,[t("span",{class:x(["inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium",y(s)?"bg-rose-50 text-rose-700":"bg-emerald-50 text-emerald-700"])},a(y(s)?"Inactive":"Active"),3)]),t("div",on,[t("a",{class:"underline",href:"tel:"+(s==null?void 0:s.phone),onClick:e[8]||(e[8]=at(()=>{},["stop"]))},a((s==null?void 0:s.phone)||"—"),9,ln),e[21]||(e[21]=t("span",{class:"mx-1"},"•",-1)),t("a",{class:"underline",href:"mailto:"+((s==null?void 0:s.email)||""),onClick:e[9]||(e[9]=at(()=>{},["stop"]))},a((s==null?void 0:s.email)||"নেই"),9,dn)]),t("div",rn,[t("button",{class:x(["btn-3 !px-2 !py-1",y(s)?"opacity-50 cursor-not-allowed pointer-events-none":""]),disabled:y(s),onClick:J=>Vt(s)},"Shift",10,cn),t("button",{class:x(["btn-3 !px-2 !py-1",y(s)?"opacity-50 cursor-not-allowed pointer-events-none":""]),disabled:y(s),onClick:J=>Mt(s)},"Weekend",10,pn),t("button",{class:x(["btn-3 !px-2 !py-1",y(s)?"opacity-50 cursor-not-allowed pointer-events-none":""]),disabled:y(s),onClick:J=>Pt(s)},"KPI",10,mn),Et.value?(d(),r("button",{key:0,type:"button",class:x(I(s).cls),onClick:J=>Wt(s),title:L(s)?"Update exit info":"Set exit info"},[t("i",{class:x(I(s).icon)},null,2),t("span",un,a(I(s).label),1),e[22]||(e[22]=t("span",{class:"lg:hidden"},"Exit",-1)),L(s)?(d(),r("span",{key:0,class:x(["ml-1 rounded px-1.5 py-0.5 text-[10px] font-bold tabular-nums",I(s).badgeCls])},a(D(s==null?void 0:s.last_working_date)),3)):S("",!0)],10,fn)):S("",!0),U(c,{to:{name:"UserShow",params:{id:s.id},query:{company:T(p).query.company}},class:"btn-3 !px-2 !py-1"},{default:B(()=>e[23]||(e[23]=[q("View")])),_:2,__:[23]},1032,["to"])])])])])}),128))]),t("div",yn,[t("div",_n,[t("div",xn,[t("h2",gn,a(gt)+" ("+a(m.length)+")",1)]),t("table",bn,[e[28]||(e[28]=t("thead",{class:"user-group-table-head"},[t("tr",null,[t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"#"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Name"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Phone & Email"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Finger ID"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Joining"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Role"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Shift"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Weekend"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Status"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"KPI Criteria"),t("th",{class:"px-3 py-2 text-xs font-semibold uppercase tracking-wide text-zinc-500"},"Action")])],-1)),t("tbody",null,[(d(!0),r(Z,null,X(m,(s,bt)=>{var J,ae,oe,le,de,re,ce,pe;return d(),r("tr",{key:s.id,class:x(["border-b text-sm border-gray-100 hover:bg-indigo-50/50",y(s)?"opacity-70":""])},[t("td",vn,a(bt+1),1),t("td",hn,[t("div",wn,[s.photo?(d(),r("div",kn,[t("img",{src:s.photo,alt:s==null?void 0:s.name,class:"h-8 w-8 rounded-full object-cover"},null,8,Sn)])):(d(),r("div",Cn,a(((s==null?void 0:s.name)||"?").charAt(0).toUpperCase()),1)),t("div",$n,[t("div",An,a(s==null?void 0:s.name),1),t("div",zn,a(s==null?void 0:s.bn_name),1),t("div",En,a(((J=s==null?void 0:s.designation)==null?void 0:J.title)||"—"),1),t("div",qn,"ID: "+a(s==null?void 0:s.employee_id),1)])])]),t("td",Un,[t("div",Nn,[t("a",{class:"underline",href:"tel:"+(s==null?void 0:s.phone)},a((s==null?void 0:s.phone)||"—"),9,Dn)]),t("div",jn,[t("a",{class:"underline",href:"mailto:"+((s==null?void 0:s.email)||"")},a((s==null?void 0:s.email)||"নেই"),9,In)])]),t("td",Ln,a(s==null?void 0:s.device_user_id),1),t("td",Vn,a(s==null?void 0:s.joining_date),1),t("td",Mn,a(s==null?void 0:s.role),1),t("td",Pn,[t("button",{onClick:Ct=>Vt(s),title:i(s)?"Manage Shift":"Assign Shift",class:x(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",y(s)?"opacity-50 cursor-not-allowed pointer-events-none":"",i(s)?"border-amber-200 bg-amber-50 text-amber-700 hover:bg-amber-100 focus:ring-amber-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"]),disabled:y(s)},[t("span",Tn,a(i(s)?"Manage":"Assign"),1),t("span",{class:x(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",i(s)?"bg-amber-600 text-white":"bg-slate-200 text-slate-700"])},a((s==null?void 0:s.shifts_count)||(i(s)?1:0)),3)],10,Wn),t("div",On,a(l(s)),1)]),t("td",Rn,[t("button",{onClick:Ct=>Mt(s),title:_(s)?"Manage Weekend":"Assign Weekend",class:x(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",y(s)?"opacity-50 cursor-not-allowed pointer-events-none":"",_(s)?"border-emerald-200 bg-emerald-50 text-emerald-700 hover:bg-emerald-100 focus:ring-emerald-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"]),disabled:y(s)},[t("span",Bn,a(_(s)?"Manage":"Assign"),1),t("span",{class:x(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",_(s)?"bg-emerald-600 text-white":"bg-slate-200 text-slate-700"])},a((s==null?void 0:s.assign_weekends_count)||_(s)&&((oe=(ae=s==null?void 0:s.assign_weekend)==null?void 0:ae.weekends)==null?void 0:oe.length)||0),3)],10,Kn),t("div",Fn,a(C(s)),1)]),t("td",Hn,[t("span",{class:x(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium",y(s)?"bg-rose-50 text-rose-700":"bg-emerald-50 text-emerald-700"])},a(y(s)?"Inactive":"Active"),3),Y(s)?(d(),r("div",Yn," Exit: "+a(D(s==null?void 0:s.last_working_date)),1)):S("",!0)]),t("td",Qn,[t("button",{onClick:Ct=>Pt(s),title:(((le=s==null?void 0:s.criteria_assignments)==null?void 0:le.length)||0)>0?"Manage KPI criteria":"Assign KPI criteria",class:x(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",y(s)?"opacity-50 cursor-not-allowed pointer-events-none":"",(((de=s==null?void 0:s.criteria_assignments)==null?void 0:de.length)||0)>0?"border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 focus:ring-indigo-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"]),disabled:y(s)},[t("span",Jn,a((((re=s==null?void 0:s.criteria_assignments)==null?void 0:re.length)||0)>0?"Manage":"Assign"),1),t("span",{class:x(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",(((ce=s==null?void 0:s.criteria_assignments)==null?void 0:ce.length)||0)>0?"bg-indigo-600 text-white":"bg-slate-200 text-slate-700"])},a(((pe=s==null?void 0:s.criteria_assignments)==null?void 0:pe.length)||0),3)],10,Gn)]),t("td",Zn,[t("div",Xn,[U(c,{to:{name:"UserShow",params:{id:s.id},query:{company:T(p).query.company}},class:"btn-icon",title:"View"},{default:B(()=>e[24]||(e[24]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[24]},1032,["to"]),U(c,{to:{name:"UserEdit",params:{id:s.id},query:{company:T(p).query.company}},class:x(["btn-icon",y(s)?"pointer-events-none opacity-50":""]),tabindex:y(s)?-1:0,title:"Edit"},{default:B(()=>e[25]||(e[25]=[t("i",{class:"far fa-edit"},null,-1)])),_:2,__:[25]},1032,["to","class","tabindex"]),U(c,{to:{name:"KpiReview",params:{employeeId:s.id}},class:x(["btn-icon",y(s)?"pointer-events-none opacity-50":""]),tabindex:y(s)?-1:0,title:"KPI"},{default:B(()=>e[26]||(e[26]=[q(" KPI ")])),_:2,__:[26]},1032,["to","class","tabindex"]),Et.value?(d(),r("button",{key:0,type:"button",class:x(I(s).cls),onClick:Ct=>Wt(s),title:L(s)?"Update exit info":"Set exit info"},[t("i",{class:x(I(s).icon)},null,2),t("span",ei,a(I(s).label),1),e[27]||(e[27]=t("span",{class:"lg:hidden"},"Exit",-1)),L(s)?(d(),r("span",{key:0,class:x(["ml-1 rounded px-1.5 py-0.5 text-[10px] font-bold tabular-nums",I(s).badgeCls])},a(D(s==null?void 0:s.last_working_date)),3)):S("",!0)],10,ti)):S("",!0)])])],2)}),128))])])])])]))),128))])),nt.value?(d(),r("div",si,[t("div",{class:"absolute inset-0 bg-black/40",onClick:_t}),t("div",ni,[t("div",{class:"flex items-center justify-between border-b px-4 py-3"},[e[30]||(e[30]=t("h3",{class:"text-lg font-semibold text-gray-900"},"User Exit Information",-1)),t("button",{type:"button",class:"text-gray-500 hover:text-gray-700","aria-label":"Close",onClick:_t},e[29]||(e[29]=[t("i",{class:"far fa-times"},null,-1)]))]),t("div",ii,[t("div",ai,[e[31]||(e[31]=q(" User: ")),t("span",oi,a(((u=k.value)==null?void 0:u.name)||"N/A"),1)]),t("div",li,[e[32]||(e[32]=t("label",{class:"text-sm font-medium text-gray-700"},[q(" Last Working Date "),t("span",{class:"text-red-500"},"*")],-1)),U(Be,{modelValue:It.value,"onUpdate:modelValue":e[10]||(e[10]=m=>It.value=m),"show-year":!1,"show-month":!1,"show-date":!0,label:"Date",class:"w-full",required:""},null,8,["modelValue"])]),t("div",di,[e[33]||(e[33]=t("label",{class:"text-sm font-medium text-gray-700"},"Exit Reason",-1)),vt(t("textarea",{"onUpdate:modelValue":e[11]||(e[11]=m=>A.exit_reason=m),class:"input-1 w-full min-h-[90px]",placeholder:"Optional"},null,512),[[At,A.exit_reason,void 0,{trim:!0}]])]),M.value?(d(),r("div",ri,a(M.value),1)):S("",!0),P.value?(d(),r("div",ci,a(P.value),1)):S("",!0)]),t("div",pi,[t("button",{type:"button",class:"btn-3",onClick:_t},"Cancel"),t("button",{type:"button",class:"btn-2",disabled:yt.value||!((z=k.value)!=null&&z.last_working_date),onClick:$e,title:"Print Exit + Clearance"},[yt.value?(d(),r("span",fi,"Preparing...")):(d(),r("span",ui,"Print Exit Sheet"))],8,mi),t("button",{type:"button",class:"btn-1",disabled:ut.value,onClick:ze},[ut.value?(d(),r("span",_i,"Saving...")):(d(),r("span",xi,"Save Exit Info"))],8,yi)])])])):S("",!0),xt.value?(d(),r("div",gi,[t("div",{class:"absolute inset-0 bg-black/40",onClick:St}),t("div",bi,[t("div",{class:"flex items-center justify-between border-b px-4 py-3"},[e[35]||(e[35]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Exit & Clearance Preview",-1)),t("button",{type:"button",class:"text-gray-500 hover:text-gray-700","aria-label":"Close",onClick:St},e[34]||(e[34]=[t("i",{class:"far fa-times"},null,-1)]))]),t("div",vi,[t("div",hi,[t("div",null,[e[36]||(e[36]=t("span",{class:"text-gray-500"},"User:",-1)),t("span",wi,a(((b=k.value)==null?void 0:b.name)||"N/A"),1)]),t("div",null,[e[37]||(e[37]=t("span",{class:"text-gray-500"},"Employee ID:",-1)),t("span",ki,a((($=k.value)==null?void 0:$.employee_id)||"N/A"),1)]),t("div",null,[e[38]||(e[38]=t("span",{class:"text-gray-500"},"Department:",-1)),t("span",Si,a(((Tt=(W=k.value)==null?void 0:W.department)==null?void 0:Tt.name)||"N/A"),1)]),t("div",null,[e[39]||(e[39]=t("span",{class:"text-gray-500"},"Last Working Date:",-1)),t("span",Ci,a(D((Ot=k.value)==null?void 0:Ot.last_working_date)||"N/A"),1)])]),e[40]||(e[40]=t("div",null,[t("p",{class:"text-sm text-gray-600"},"The clearance summary will be printed based on the latest data below.")],-1)),P.value?(d(),r("div",$i,a(P.value),1)):S("",!0)]),t("div",{class:"flex items-center justify-end gap-2 border-t px-4 py-3 bg-gray-50"},[t("button",{type:"button",class:"btn-3",onClick:St},"Close"),t("button",{type:"button",class:"btn-1",onClick:Ae}," Print Exit Sheet ")])])])):S("",!0),t("div",Ai,[t("div",zi,[t("h1",Ei,a(ke.value),1),e[41]||(e[41]=t("p",{class:"text-xs text-gray-500"},"User Exit & Clearance Summary",-1))]),t("div",qi,[t("div",null,[e[42]||(e[42]=t("span",{class:"text-gray-500"},"Name:",-1)),e[43]||(e[43]=q()),t("span",Ui,a(((Rt=G.value)==null?void 0:Rt.name)||"N/A"),1)]),t("div",null,[e[44]||(e[44]=t("span",{class:"text-gray-500"},"Employee ID:",-1)),e[45]||(e[45]=q()),t("span",Ni,a(((Kt=G.value)==null?void 0:Kt.employee_id)||"N/A"),1)]),t("div",null,[e[46]||(e[46]=t("span",{class:"text-gray-500"},"Department:",-1)),e[47]||(e[47]=q()),t("span",Di,a(((Ft=(Bt=G.value)==null?void 0:Bt.department)==null?void 0:Ft.name)||"N/A"),1)]),t("div",null,[e[48]||(e[48]=t("span",{class:"text-gray-500"},"Designation:",-1)),e[49]||(e[49]=q()),t("span",ji,a(((Yt=(Ht=G.value)==null?void 0:Ht.designation)==null?void 0:Yt.title)||"N/A"),1)])]),t("div",Ii,[t("div",null,[e[50]||(e[50]=t("span",{class:"text-gray-500"},"Last Working Date:",-1)),e[51]||(e[51]=q()),t("span",Li,a(D((Qt=G.value)==null?void 0:Qt.last_working_date)||"N/A"),1)]),t("div",Vi,[e[52]||(e[52]=t("span",{class:"text-gray-500"},"Exit Reason:",-1)),e[53]||(e[53]=q()),t("span",Mi,a(((Gt=G.value)==null?void 0:Gt.exit_reason)||"N/A"),1)])]),t("div",Pi,[e[56]||(e[56]=t("div",{class:"mb-2 text-sm font-semibold text-gray-700"},"Clearance Items Summary",-1)),T(ct)?(d(),r("div",Wi,"Loading clearance...")):T(K)?(d(),r("div",Ti,a(T(K)),1)):(d(),r("table",Oi,[e[55]||(e[55]=t("thead",null,[t("tr",{class:"bg-gray-100 text-gray-700"},[t("th",{class:"border border-gray-300 px-2 py-1 text-left"},"Item"),t("th",{class:"border border-gray-300 px-2 py-1 text-left w-[120px]"},"Status"),t("th",{class:"border border-gray-300 px-2 py-1 text-left"},"Remarks")])],-1)),t("tbody",null,[(d(!0),r(Z,null,X(Lt.value,(m,gt)=>(d(),r("tr",{key:gt},[t("td",Ri,a(m.label||"N/A"),1),t("td",Ki,a(m.status||"N/A"),1),t("td",Bi,a(m.remarks||"—"),1)]))),128)),Lt.value.length?S("",!0):(d(),r("tr",Fi,e[54]||(e[54]=[t("td",{colspan:"3",class:"border border-gray-300 px-2 py-4 text-center text-gray-500"}," No clearance items found. ",-1)])))])]))]),t("div",Hi,"Printed: "+a(new Date().toLocaleString()),1)]),U(Ke,{modelValue:ft.value,"onUpdate:modelValue":e[12]||(e[12]=m=>ft.value=m),"user-id":(Jt=E.value)==null?void 0:Jt.id,"user-label":(Zt=E.value)==null?void 0:Zt.name,criteria_assignments:(Xt=E.value)==null?void 0:Xt.criteria_assignments,onAssigned:qe},null,8,["modelValue","user-id","user-label","criteria_assignments"]),U(Re,{modelValue:st.value,"onUpdate:modelValue":e[13]||(e[13]=m=>st.value=m),"user-id":(te=E.value)==null?void 0:te.id,"user-label":(ee=E.value)==null?void 0:ee.name,assign_weekends:et.value,onSaved:Ce,onClose:Se},null,8,["modelValue","user-id","user-label","assign_weekends"]),U(qs,{modelValue:mt.value,"onUpdate:modelValue":e[14]||(e[14]=m=>mt.value=m),shifts:T(ht),employee:{id:(se=E.value)==null?void 0:se.id,name:(ne=E.value)==null?void 0:ne.name},"has-shift":(ie=E.value)==null?void 0:ie.current_shift,shift_history:jt.value,onClose:e[15]||(e[15]=m=>mt.value=!1)},null,8,["modelValue","shifts","employee","has-shift","shift_history"])])}}},pa=Ie(Yi,[["__scopeId","data-v-369fcc43"]]);export{pa as default};
