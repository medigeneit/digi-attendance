import{_ as y}from"./MultiselectDropdown-DepS3hLD.js";import{u as B}from"./company-CZNW1yiz.js";import{u as U}from"./department-B4DNpegw.js";import{s as k,r,e as C,A as _,c as F,o as w,l as h,m as I,f as j,h as g}from"./index-DNQb_tB1.js";const N={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},q={__name:"EmployeeFilter",props:{modelValue:Object,withType:{type:Boolean,default:!0},initialValue:{type:Object,default:()=>({})}},emits:["update:modelValue","filter-change"],setup(S,{emit:A}){const t=S,D=A,n=B(),f=U(),{companies:E,employees:O}=k(n),{departments:v}=k(f),m=r(null),o=r({id:"all",name:"All Departments"}),d=r({id:"all",name:"All Types"}),s=r(null),u=r([]),x=e=>({executive:"Executive",support_staff:"Support Staff",doctor:"Doctor",academy_body:"Academy Body"})[e]||e;C(async()=>{var e,l,a,i;if(await n.fetchCompanies(),(e=t.initialValue)!=null&&e.company_id){const c=E.value.find(p=>p.id==t.initialValue.company_id);if(c){if(m.value=c,await f.fetchDepartments(c.id),await n.fetchEmployee(c.id),u.value=[...n.employees],(l=t.initialValue)!=null&&l.department_id&&t.initialValue.department_id!=="all"){const p=v.value.find(b=>b.id==t.initialValue.department_id);p&&(o.value=p)}if((a=t.initialValue)!=null&&a.type&&t.initialValue.type!=="all"&&(d.value={id:t.initialValue.type,name:x(t.initialValue.type)}),T(),(i=t.initialValue)!=null&&i.employee_id){const p=u.value.find(b=>b.id==t.initialValue.employee_id);p&&(s.value=p)}}}}),_(m,async e=>{e?(await f.fetchDepartments(e.id),await n.fetchEmployee(e.id),u.value=[...n.employees]):(u.value=[],v.value=[]),V()}),_([o,d],()=>{T()}),_(s,()=>{V()});const T=()=>{var l,a;let e=[...n.employees];(l=o.value)!=null&&l.id&&o.value.id!=="all"&&(e=e.filter(i=>i.department_id==o.value.id)),t.withType&&((a=d.value)!=null&&a.id)&&d.value.id!=="all"&&(e=e.filter(i=>i.type==d.value.id)),u.value=e,s.value=null,V()},V=()=>{var e,l,a,i;D("update:modelValue",{company_id:((e=m.value)==null?void 0:e.id)||"",department_id:((l=o.value)==null?void 0:l.id)||"all",type:t.withType?((a=d.value)==null?void 0:a.id)||"all":null,employee_id:((i=s.value)==null?void 0:i.id)||""}),D("filter-change")};return(e,l)=>(w(),F("div",N,[h(y,{modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=a=>m.value=a),options:g(E),label:"name","track-by":"id",placeholder:"Select Company"},null,8,["modelValue","options"]),h(y,{modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=a=>o.value=a),options:[{id:"all",name:"All Departments"},...g(v)],label:"name","track-by":"id",placeholder:"Select Department",disabled:!m.value},null,8,["modelValue","options","disabled"]),S.withType?(w(),I(y,{key:0,modelValue:d.value,"onUpdate:modelValue":l[2]||(l[2]=a=>d.value=a),options:[{id:"all",name:"All Types"},{id:"executive",name:"Executive"},{id:"support_staff",name:"Support Staff"},{id:"doctor",name:"Doctor"},{id:"academy_body",name:"Academy Body"}],label:"name","track-by":"id",placeholder:"Select Type"},null,8,["modelValue"])):j("",!0),h(y,{modelValue:s.value,"onUpdate:modelValue":l[3]||(l[3]=a=>s.value=a),options:u.value,label:"name","track-by":"id",placeholder:"Select Employee",disabled:u.value.length===0},null,8,["modelValue","options","disabled"])]))}};export{q as _};
