import{u as We,r as _,p as Te,b as He,c as r,a as t,k as n,j as Le,t as l,h as b,e as u,y as Pe,l as ze,d as Ie,v as Ue,F as Ge,f as Je,o,g as Ke}from"./index-BKwJRMPl.js";import{u as Oe}from"./exchange-B7puhgoS.js";import{L as Qe}from"./LoaderView-husGst7k.js";import{_ as Xe}from"./ShareComponent-DXk06kbZ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ye={class:"my-container max-w-3xl space-y-6"},Ze={class:"flex items-center justify-between gap-2 print:hidden"},et={key:1,class:"card-bg p-4 md:p-8"},tt={class:"grid md:grid-cols-2"},st={class:"grid md:grid-cols-2 gap-4 pt-10"},lt={class:"font-medium"},nt={class:"text-sm"},at={key:0,class:"print:hidden"},ot={class:"text-xs"},rt={class:"flex gap-2"},ut={class:"font-bold"},dt={key:0,class:"text-green-600 print:text-black"},it={key:1,class:"pl-2 text-yellow-700"},pt={class:"title-md"},vt={key:0},ct={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},mt={class:"pt-10"},gt={key:0,class:"print:hidden"},bt={class:""},xt={class:"text-xs text-blue-600"},_t={class:"flex gap-4"},ft={class:"font-bold"},yt={key:0,class:"text-green-600"},ht={class:"pt-10"},kt={key:0,class:"print:hidden"},wt={class:""},jt={class:"text-xs text-blue-600"},At={class:"flex gap-4"},Ct={class:"font-bold"},Rt={key:0,class:"text-green-600"},Et={class:"flex flex-col pt-10"},Nt={key:0,class:"print:hidden"},Bt={class:""},$t={class:"text-xs text-blue-600"},Ft={class:"flex gap-4"},St={class:"font-bold"},Dt={key:0,class:"text-green-600"},Vt={key:0,class:"modal-bg"},qt={class:"modal-card"},Mt={class:"flex justify-end gap-2 mt-4"},It={__name:"ExchangeShow",setup(Wt){const Ve=Ke(),p=Je(),d=Oe(),v=We(),f=_(!0),c=_(!1),m=_(""),s=Te(()=>d.exchange);He(async()=>{const{id:a}=p.params;try{await d.fetchExchange(a)}catch(e){console.error("Failed to fetch exchange details:",e)}finally{f.value=!1}});const qe=async()=>{try{await d.rejectExchange(p.params.id,m.value),c.value=!1,m.value="",await d.fetchExchange(p.params.id)}catch(a){console.error("Failed to reject exchange request:",a),alert("Failed to reject exchange request.")}},x=()=>{c.value=!0},g=async a=>{try{const{id:e}=p.params;a==="handover"&&await d.handoverAccept(e),a==="inCharge"&&await d.inChargeAccept(e),a==="recommend"&&await d.recommendByAccept(e),a==="approve"&&await d.approvedByAccept(e),alert(`${a} accepted successfully!`),await d.fetchExchange(e)}catch(e){console.error(`Failed to accept ${a}:`,e),alert(`Failed to accept ${a}.`)}},Me=()=>Ve.go(-1);return(a,e)=>{var y,h,k,w,j,A,C,R,E,N,B,$,F,S,D,V,q,M,W,T,H,L,P,z,I,U,G,J,K,O,Q,X,Y,Z,ee,te,se,le,ne,ae,oe,re,ue,de,ie,pe,ve,ce,me,ge,be,xe,_e,fe,ye,he,ke,we,je,Ae,Ce,Re,Ee,Ne,Be,$e,Fe,Se,De;return o(),r(Ge,null,[t("div",Ye,[t("div",Ze,[t("button",{class:"btn-3",onClick:Me},e[7]||(e[7]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[9]||(e[9]=t("h1",{class:"title-lg text-center"},"Exchange Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:e[0]||(e[0]=(...i)=>a.print&&a.print(...i))},e[8]||(e[8]=[t("i",{class:"far fa-print"},null,-1),n(" Print ")]))])]),f.value?(o(),Le(Qe,{key:0})):(o(),r("div",et,[e[38]||(e[38]=t("h2",{class:"title-md"},"Exchange Request",-1)),t("div",tt,[t("div",null,[e[10]||(e[10]=t("b",null,"Type:",-1)),n(" "+l((y=s.value)==null?void 0:y.exchange_type),1)]),t("div",null,[e[11]||(e[11]=t("b",null,"Current Date:",-1)),n(" "+l((h=s.value)==null?void 0:h.current_date),1)]),t("div",null,[e[12]||(e[12]=t("b",null,"Exchange Date:",-1)),n(" "+l((k=s.value)==null?void 0:k.exchange_date),1)]),t("div",null,[e[13]||(e[13]=t("b",null,"Status:",-1)),n(" "+l(((w=s.value)==null?void 0:w.status)||"N/A"),1)]),t("div",null,[e[14]||(e[14]=t("b",null,"Works in Hand:",-1)),n(" "+l(((j=s.value)==null?void 0:j.works_in_hand)||"N/A"),1)])]),t("div",st,[t("div",null,[e[15]||(e[15]=t("hr",{class:"w-44 border-black"},null,-1)),e[16]||(e[16]=t("div",null,[t("b",null,"Applicant")],-1)),t("p",lt,l((C=(A=s.value)==null?void 0:A.user)==null?void 0:C.name),1),t("div",nt,[t("p",null,l((N=(E=(R=s.value)==null?void 0:R.user)==null?void 0:E.department)==null?void 0:N.name),1),t("p",null,l((F=($=(B=s.value)==null?void 0:B.user)==null?void 0:$.designation)==null?void 0:F.title),1)])]),t("div",null,[t("p",null,l(((D=(S=s.value)==null?void 0:S.handover_user)==null?void 0:D.name)||"Not assigned"),1),!((V=s.value)!=null&&V.status)&&s.value.handover_user_id===b(v).user.id?(o(),r("div",at,[t("p",ot,[n(l((M=(q=s.value)==null?void 0:q.user)==null?void 0:M.name)+" has assigned you for his handover.",1),e[17]||(e[17]=t("br",null,null,-1)),e[18]||(e[18]=n(" Do you agree? "))]),t("div",rt,[t("button",{class:"font-bold text-lg text-green-600 px-2",onClick:e[1]||(e[1]=i=>g("handover"))}," ✔ "),e[19]||(e[19]=t("button",{class:"px-2"},"❌",-1))])])):u("",!0),e[22]||(e[22]=t("hr",{class:"w-44 border-black"},null,-1)),t("h4",ut,[e[21]||(e[21]=n(" Handover ")),(W=s.value)!=null&&W.handover_user_id&&((T=s.value)!=null&&T.status)?(o(),r("span",dt," (✔) ")):u("",!0),(H=s.value)!=null&&H.handover_user_id&&!((L=s.value)!=null&&L.status)?(o(),r("span",it,e[20]||(e[20]=[t("i",{class:"fad fa-spinner"},null,-1)]))):u("",!0)])])]),e[39]||(e[39]=t("hr",null,null,-1)),t("div",null,[t("h3",pt,[e[23]||(e[23]=n(" Approvals ")),t("span",{class:Pe({"text-yellow-500":((P=s.value)==null?void 0:P.status)==="Pending","text-green-500":((z=s.value)==null?void 0:z.status)==="Approved","text-red-500":((I=s.value)==null?void 0:I.status)==="Rejected"})}," ("+l(((U=s.value)==null?void 0:U.status)||"N/A")+") ",3)]),((G=s.value)==null?void 0:G.status)==="Rejected"?(o(),r("div",vt,[t("div",null,[e[24]||(e[24]=t("b",null,"Rejected By:",-1)),n(" "+l(((K=(J=s.value)==null?void 0:J.rejected_by_user)==null?void 0:K.name)||"N/A"),1)]),t("div",null,[e[25]||(e[25]=t("b",null,"Rejection Reason:",-1)),n(" "+l(((O=s.value)==null?void 0:O.rejection_reason)||"N/A"),1)])])):u("",!0)]),t("div",ct,[t("div",mt,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Q=s.value)!=null&&Q.in_charge_user_id)&&((Z=(Y=(X=s.value)==null?void 0:X.user)==null?void 0:Y.other_approval)==null?void 0:Z.in_charge_user_id)===b(v).user.id?(o(),r("div",gt,[t("p",bt,l(((le=(se=(te=(ee=s.value)==null?void 0:ee.user)==null?void 0:te.other_approval)==null?void 0:se.in_charge_user)==null?void 0:le.name)||"N/A"),1),t("p",xt,[n(l((ae=(ne=s.value)==null?void 0:ne.user)==null?void 0:ae.name)+" has submitted an application. ",1),e[26]||(e[26]=t("br",null,null,-1)),e[27]||(e[27]=n(" Will you forward it? "))]),t("div",_t,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=i=>g("inCharge"))}," ✔ "),t("button",{class:"",onClick:x},"❌")])])):u("",!0),t("p",null,l(((re=(oe=s.value)==null?void 0:oe.in_charge_user)==null?void 0:re.name)||""),1),e[29]||(e[29]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",ft,[e[28]||(e[28]=n(" In-Charge ")),(ue=s.value)!=null&&ue.in_charge_user_id?(o(),r("span",yt,"(✔)")):u("",!0)])]),t("div",ht,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((de=s.value)!=null&&de.recommend_by_user_id)&&((ve=(pe=(ie=s.value)==null?void 0:ie.user)==null?void 0:pe.other_approval)==null?void 0:ve.recommend_by_user_id)===b(v).user.id?(o(),r("div",kt,[t("p",wt,l(((be=(ge=(me=(ce=s.value)==null?void 0:ce.user)==null?void 0:me.other_approval)==null?void 0:ge.recommend_by_user)==null?void 0:be.name)||"N/A"),1),t("p",jt,[n(l((_e=(xe=s.value)==null?void 0:xe.user)==null?void 0:_e.name)+" has submitted an application.",1),e[30]||(e[30]=t("br",null,null,-1)),e[31]||(e[31]=n(" Will you recommend it? "))]),t("div",At,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[3]||(e[3]=i=>g("recommend"))}," ✔ "),t("button",{class:"",onClick:x},"❌")])])):u("",!0),t("p",null,l(((ye=(fe=s.value)==null?void 0:fe.recommend_by_user)==null?void 0:ye.name)||""),1),e[33]||(e[33]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Ct,[e[32]||(e[32]=n(" Recommend By ")),(he=s.value)!=null&&he.recommend_by_user_id?(o(),r("span",Rt,"(✔)")):u("",!0)])])]),t("div",Et,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ke=s.value)!=null&&ke.approved_by_user_id)&&((Ae=(je=(we=s.value)==null?void 0:we.user)==null?void 0:je.other_approval)==null?void 0:Ae.approved_by_user_id)===b(v).user.id?(o(),r("div",Nt,[t("p",Bt,l(((Ne=(Ee=(Re=(Ce=s.value)==null?void 0:Ce.user)==null?void 0:Re.other_approval)==null?void 0:Ee.approved_by_user)==null?void 0:Ne.name)||"N/A"),1),t("p",$t,[n(l(($e=(Be=s.value)==null?void 0:Be.user)==null?void 0:$e.name)+" has submitted an application.",1),e[34]||(e[34]=t("br",null,null,-1)),e[35]||(e[35]=n(" Will you accept it? "))]),t("div",Ft,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[4]||(e[4]=i=>g("approve"))}," ✔ "),t("button",{class:"",onClick:x},"❌")])])):u("",!0),t("p",null,l(((Se=(Fe=s.value)==null?void 0:Fe.approved_by_user)==null?void 0:Se.name)||""),1),e[37]||(e[37]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",St,[e[36]||(e[36]=n(" Approved By ")),(De=s.value)!=null&&De.approved_by_user_id?(o(),r("span",Dt,"(✔)")):u("",!0)])])])),ze(Xe)]),c.value?(o(),r("div",Vt,[t("div",qt,[e[40]||(e[40]=t("h3",{class:"title-lg"},"Reject Exchange Request",-1)),Ie(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=i=>m.value=i),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[Ue,m.value]]),t("div",Mt,[t("button",{class:"btn-3",onClick:e[6]||(e[6]=i=>c.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:qe},"Confirm")])])])):u("",!0)],64)}}};export{It as default};
