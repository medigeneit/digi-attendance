import{O as U}from"./OverlyModal-cgf15HCw.js";import{m as P,c as i,o,g as D,F as T,n as L,f as S,p as C,q as _,i as h,a as e,t as r,k as f,R as V,w,s as F,r as N,d as O,e as j,x as q,h as E,v as W,y as B,u as Y,z as H,j as x}from"./index-DPIp4nXa.js";import{L as I}from"./LoaderView-BBVnRieA.js";import{o as M,g as R,a as G}from"./datetime-DLUp6MRA.js";import{m as J}from"./task-tree-Da8PYs5l.js";import{u as K}from"./useTaskStore-Co6VBnju.js";import{_ as Q}from"./TaskTreeViewWithSubTable-CVNPMTo2.js";import{u as X}from"./user-CipzU-rG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TaskSupervisorAndEmployee-B5nujLVr.js";import"./UserChip-qEgGZyiq.js";import"./url-CePbr-gY.js";const Z=(v,y,l,d)=>{const p=new Date(d,l-1,y);return v.filter(a=>{const c=a.deadline?new Date(a.deadline):null,u=M(new Date);if(a.assigned_at||a.created_at){let b=a.assigned_at?M(new Date(a.assigned_at)):null;!b&&a.created_at&&(b=M(new Date(a.created_at)));let m=null;return!(p<b||(a.completed_at&&(m=M(new Date(a.completed_at))),m&&m<p)||c&&c<p&&p>u)}return!1}).map(a=>{let c=!1;return a.deadline&&(c=new Date(a.deadline)<p),{...a,deadline_crossed:c}})},ee={key:0},te={key:0,class:"fad fa-folder text-xs mr-2"},se={key:1,class:"fad fa-file-alt text-xs mr-2"},ae={key:2,class:"text-center w-full mt-4 text-xs text-gray-600"},oe={__name:"TaskListOnDay",props:{isCurrentMonth:{type:Boolean,default:!1},tasks:{type:Array,default:()=>[]},limit:{type:Number,default:null},tree:{type:Boolean,default:!1}},emits:["clickOnMore"],setup(v,{emit:y}){const l=v,d=y,p=P(()=>{var a;return l.limit?((a=l==null?void 0:l.tasks)==null?void 0:a.slice(0,l.limit))||[]:[...l.tasks]});return(a,c)=>(o(),i("div",null,[v.tree?(o(),i("div",ee,[(o(!0),i(T,null,L(p.value,u=>(o(),S(Q,{"hide-buttons":"","hide-assigned-users":"",task:u,key:u.id,class:"mb-6 shadow hover:shadow-md"},null,8,["task"]))),128))])):(o(),i("ul",{key:1,class:C({"text-gray-500 group-hover:text-gray-900":!v.isCurrentMonth})},[(o(!0),i(T,null,L(p.value,u=>(o(),i("li",{class:"mb-2",key:u.id},[_(f(V),{to:`/tasks/${u.id}`,target:"_blank",class:"flex items-center hover:underline hover:text-blue-600"},{default:h(()=>[u.children_task_count>0?(o(),i("i",te)):D("",!0),u.children_task_count==0?(o(),i("i",se)):D("",!0),e("span",{class:C(["line-clamp-1",{"text-red-800":u.deadline_crossed}])},r(u.title),3)]),_:2},1032,["to"])]))),128))],2)),v.tasks.length-p.value.length>0?(o(),i("div",ae,[e("button",{onClick:c[0]||(c[0]=w(u=>d("clickOnMore",u),["prevent"])),class:"text-blue-600 hover:underline"}," +"+r(v.tasks.length-p.value.length)+" More Tasks ",1)])):D("",!0)]))}},ne={class:"border"},le={class:"px-4 py-2 flex items-center bg-gray-50 group"},ie={class:"mx-4"},re=["disabled"],de={class:"ml-4 md:ml-auto flex items-center gap-2"},ue={class:"bg-gray-300 bg-opacity-90 relative"},ce={class:"bg-gray-50 border-y rounded-md z-20"},me={__name:"DailyTask",setup(v){const y=F({day:null,month:null,year:null}),l=N(),d=N("loading"),p=K(),a=O();j(()=>{l.value=R(new Date)}),q(l,t=>{const[n,k,$]=t.split("-").map(Number);y.day=$,y.month=k,y.year=n}),q(()=>y.month,async()=>{d.value="loading",await c(),d.value=""});async function c(){await p.fetchMyTasks({status:"not-completed"})}function u(){const t=new Date;l.value=R(t)}function b(){const t=new Date(l.value);t.setDate(t.getDate()+1),l.value=R(t)}function m(){const t=new Date(l.value);t.setDate(t.getDate()-1),l.value=R(t)}const A=async()=>{d.value="loading",await c(),d.value=""},g=P(()=>{var n;const t=J(p.tasks,{"user-ids":(n=a==null?void 0:a.user)==null?void 0:n.id});return Z(t,y.day,y.month,y.year)});return(t,n)=>(o(),i("div",ne,[e("div",le,[n[2]||(n[2]=e("h2",{class:"leading-none font-semibold text-lg"},"Daily Task",-1)),e("div",ie,r(f(G)(l.value)),1),e("button",{class:"btn-3 mx-4 h-7",onClick:w(u,["prevent"])},"Today"),e("button",{class:C(["btn-3 px-2 py-2 mx-4 size-7 disabled:text-gray-300 disabled:border-gray-300",{"animate-spin text-gray-300 border-gray-300 !bg-opacity-0":d.value=="loading"}]),onClick:w(A,["prevent"]),disabled:d.value=="loading"},n[1]||(n[1]=[e("i",{class:"fas fa-redo-alt"},null,-1)]),10,re),e("div",de,[e("button",{class:"btn-2 h-7",onClick:w(m,["prevent"])},"Previous Day"),e("button",{class:"btn-2 h-7",onClick:w(b,["prevent"])},"Next Day"),E(e("input",{type:"date","onUpdate:modelValue":n[0]||(n[0]=k=>l.value=k),class:"border px-2 rounded"},null,512),[[W,l.value]])])]),e("div",ue,[e("div",ce,[n[3]||(n[3]=e("div",{class:"text-md font-semibold sticky top-0 border-b px-4 z-30 py-3 bg-white flex items-center shadow"}," Tasks ",-1)),_(oe,{class:"p-4 min-h-[40vh] max-h-[60vh] overflow-y-auto","is-current-month":t.isCurrentMonth,tasks:g.value,tree:!0},null,8,["is-current-month","tasks"])]),d.value==="loading"?(o(),S(I,{key:0,class:"absolute inset-0 flex items-center justify-center z-20 bg-opacity-70"})):D("",!0)])]))}},ye={class:"container px-6 mx-auto"},pe={key:0,class:"grid gap-4 md:grid-cols-3 mt-4"},fe={class:"text-3xl"},xe={class:"text-3xl"},ge={class:"text-3xl"},he={class:"text-3xl"},_e={class:"text-3xl"},ve={class:"text-3xl"},be={key:1,class:"w-full mt-4"},ke={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},we={class:"bg-white shadow-md rounded-lg p-4"},De={class:"space-y-2"},Te={class:"flex justify-between items-center px-4 py-2 rounded hover:bg-gray-50 transition-colors"},Le={class:"font-semibold text-gray-800"},Ce={key:0},$e={key:1},Me={key:2},Re={class:"space-y-3"},Se={class:"flex items-center space-x-4"},Ae={key:0,class:"h-3 w-3 bg-red-600 rounded-full inline-block"},Ne={key:1,class:"inline-block"},Pe={class:"absolute top-10 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition pointer-events-none z-10 whitespace-nowrap"},qe={class:"text-sm font-medium text-gray-900"},Be={class:"text-xs text-gray-500 mt-0.5"},Oe={class:"text-xl font-bold text-gray-800 flex items-center gap-2 p-4"},je={class:"space-y-5 px-4 md:px-6 py-4"},ze={class:"text-sm text-gray-500 flex items-center gap-2"},Ue={class:"flex justify-end gap-3 mt-6"},Ve={class:"bg-white shadow-md rounded-lg"},Fe={class:"overflow-x-auto shadow-md sm:rounded-lg min-h-max"},Ee={class:"min-w-full text-sm text-left text-gray-500"},We={class:"px-6 py-4 font-medium text-gray-900"},Ye={class:"px-6 py-4"},He={class:"px-6 py-4"},Ie={class:"px-6 py-4"},Ge={class:"card-bg mt-4 gap-0 shadow-md border border-gray-300"},it={__name:"DashBoard",setup(v){const y=O(),l=X(),{dashboardInfo:d,selectedDate:p,userDashboard:a}=B(l),{user:c}=B(y),u=Y(),b=P(()=>{var g;return["admin","super_admin","developer"].includes((g=c==null?void 0:c.value)==null?void 0:g.role)}),m=N(null);j(async()=>{var t,n;c.value||await y.fetchUser(),await l.fetchUserDashboardData(),b.value&&await l.fetchAdminDashboardData();const g=(n=(t=a.value)==null?void 0:t.notices)==null?void 0:n.find(k=>!k.user_feedback);g&&(m.value=g)});const A=()=>{if(!m.value)return;const g=m.value.type===1?`/notice-details/${m.value.id}`:`/policy-details/${m.value.id}`;u.push(g)};return(g,t)=>{var k,$;const n=H("RouterLink");return o(),i("div",ye,[b.value&&f(y).isAdminMood?(o(),i("div",pe,[_(n,{to:{name:"TodayAttendanceReport",query:{search:"all"}},class:"main-button"},{default:h(()=>{var s;return[e("span",fe,r((s=f(d))==null?void 0:s.totalUsers),1),t[2]||(t[2]=x(" Total Employees "))]}),_:1,__:[2]}),_(n,{to:{name:"TodayAttendanceReport",query:{search:"Present"}},class:"main-button"},{default:h(()=>{var s;return[e("span",xe,r((s=f(d))==null?void 0:s.todayPresents),1),t[3]||(t[3]=x(" Today Present "))]}),_:1,__:[3]}),_(n,{to:{name:"TodayAttendanceReport",query:{search:"Absent"}},class:"main-button"},{default:h(()=>{var s;return[e("span",ge,r((s=f(d))==null?void 0:s.todayAbsents),1),t[4]||(t[4]=x(" Today Absent "))]}),_:1,__:[4]}),_(n,{to:{name:"LeaveApplicationList",query:{search:"today"}},class:"main-button"},{default:h(()=>{var s;return[e("span",he,r((s=f(d))==null?void 0:s.todayLeaves),1),t[5]||(t[5]=x(" Today Leave "))]}),_:1,__:[5]}),_(n,{to:{name:"LeaveApplicationList",query:{search:"tomorrow"}},class:"main-button"},{default:h(()=>{var s;return[e("span",_e,r((s=f(d))==null?void 0:s.tomorrowLeaves),1),t[6]||(t[6]=x(" Tomorrow Leave "))]}),_:1,__:[6]}),_(n,{to:{name:"ShortLeaveList",query:{search:f(p)}},class:"main-button"},{default:h(()=>{var s;return[e("span",ve,r((s=f(d))==null?void 0:s.todayShortLeaves),1),t[7]||(t[7]=x(" Today Short Leaves "))]}),_:1,__:[7]},8,["to"])])):(o(),i("div",be,[e("div",ke,[e("div",we,[e("div",De,[t[11]||(t[11]=e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Applications")],-1)),(o(!0),i(T,null,L((k=f(a))==null?void 0:k.current_month_leave,s=>(o(),S(n,{to:{name:"MyLeaveApplicationShow",params:{id:s.id}},key:s.id},{default:h(()=>[e("div",Te,[e("h3",Le," Leave Application #"+r(s.id),1),e("p",{class:C(["text-sm font-medium flex items-center space-x-2",{"bg-gray-500 py-1.5 rounded-full px-4 text-white":s.status===null,"bg-yellow-500 py-1.5 rounded-full px-4 text-white":s.status==="Pending","bg-green-500 py-1.5 rounded-full px-4 text-white":s.status==="approved"}])},[s.status===null?(o(),i("span",Ce,t[8]||(t[8]=[e("i",{class:"fas fa-clock mr-2"},null,-1),x(" Wait for Hanover ")]))):s.status==="Pending"?(o(),i("span",$e,t[9]||(t[9]=[e("i",{class:"fas fa-hourglass-half mr-2"},null,-1),x(" Pending ")]))):(o(),i("span",Me,t[10]||(t[10]=[e("i",{class:"fas fa-check-circle mr-2"},null,-1),x(" Approved ")])))],2)])]),_:2},1032,["to"]))),128))]),t[17]||(t[17]=e("div",{class:"flex justify-between items-start mb-4"},[e("div",{class:"flex items-center"},[e("i",{class:"fas fa-file mr-2 h-5 w-5"}),e("h2",{class:"text-xl font-semibold"},"Notices")])],-1)),e("div",Re,[(o(!0),i(T,null,L(f(a).notices,(s,z)=>(o(),i("div",{key:z,class:"flex items-center justify-between p-4 border rounded-lg shadow-sm hover:shadow transition-all bg-white"},[e("div",Se,[e("div",{class:C([["rounded-full",s.user_feedback?"bg-green-100":"bg-red-100"],"h-8 w-8 flex items-center justify-center rounded-full"])},[s.user_feedback?(o(),i("span",Ne,t[12]||(t[12]=[e("i",{class:"far fa-check text-green-600"},null,-1)]))):(o(),i("span",Ae)),e("div",Pe,r(s.user_feedback?"Feedback Submitted":"Feedback Pending"),1)],2),e("div",null,[e("p",qe,r(s.title),1),e("p",Be,r(s.published_at),1)])]),_(n,{to:s.type===1?`/notice-details/${s.id}`:`/policy-details/${s.id}`,class:"text-blue-600 hover:text-blue-800 font-semibold text-sm"},{default:h(()=>t[13]||(t[13]=[x(" View ")])),_:2,__:[13]},1032,["to"])]))),128)),m.value?(o(),S(U,{key:0,show:!0,onClose:t[1]||(t[1]=s=>m.value=null)},{default:h(()=>[e("div",Oe,[t[14]||(t[14]=e("i",{class:"fas fa-bell text-blue-500"},null,-1)),x(" "+r(m.value.title),1)]),e("div",je,[e("p",ze,[t[15]||(t[15]=e("i",{class:"fas fa-calendar-alt text-gray-400"},null,-1)),x(" Published: "+r(m.value.published_at),1)]),t[16]||(t[16]=e("p",{class:"text-base text-gray-700 leading-relaxed"}," You must read this notice before proceeding. ",-1)),e("div",Ue,[e("button",{onClick:t[0]||(t[0]=s=>m.value=null),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-5 py-2 rounded-lg transition"}," Cancel "),e("button",{onClick:A,class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2.5 rounded-lg shadow transition"}," Read Details ")])])]),_:1})):D("",!0)])]),e("div",Ve,[t[19]||(t[19]=e("h2",{class:"text-xl font-semibold py-3 px-4"},"Leave Balance",-1)),e("div",Fe,[e("table",Ee,[t[18]||(t[18]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"Type"),e("th",{scope:"col",class:"px-6 py-3"},"Total Days"),e("th",{scope:"col",class:"px-6 py-3"},"Used Days"),e("th",{scope:"col",class:"px-6 py-3"},"Remaining Days")])],-1)),e("tbody",null,[(o(!0),i(T,null,L(($=f(a))==null?void 0:$.leave_balance,s=>(o(),i("tr",{key:s.id,class:"border-b hover:bg-gray-100"},[e("td",We,r(s.leave_type),1),e("td",Ye,r(s.annual_quota),1),e("td",He,r(s.used_days),1),e("td",Ie,r(s.remaining_days),1)]))),128))])])])])]),e("div",Ge,[_(me)])]))])}}};export{it as default};
