import{C as F,r as f,D as g,K as V,x as E,z as U,b as S,o as b,c as w,a as e,t as h,w as q,d as x,v as $,B as A,l as H,e as B,i as I,h as D,F as N,q as L}from"./index-CycAv-Ih.js";import{_ as j}from"./MultiselectDropdown-DrCEXPXC.js";import{u as T}from"./company-C5VMElF7.js";import{_ as z,a as O}from"./HeaderWithButtons-CRQLfIEF.js";import{L as Y}from"./LoaderView-BPPjVwlW.js";import"./vue-multiselect.esm-Es6MOdD1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G=F("holiday",()=>{const p=f([]),c=f(null),o=f(!1),d=f(null);async function y(i={}){var r,n;o.value=!0,d.value=null;try{const a=await g.get("/holidays",{params:i});p.value=a.data}catch(a){d.value=((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.message)||"Failed to fetch holidays"}finally{o.value=!1}}async function u(i){var r,n;o.value=!0,d.value=null;try{const a=await g.get(`/holidays/${i}`);c.value=a.data}catch(a){d.value=((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.message)||`Failed to fetch holiday with ID ${i}`}finally{o.value=!1}}async function s(i){var r,n;o.value=!0,d.value=null;try{const a=await g.post("/holidays",i);p.value.push(a.data.data)}catch(a){d.value=((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.message)||"Failed to create holiday"}finally{o.value=!1}}async function _(i,r){var n,a;o.value=!0,d.value=null;try{const t=await g.put(`/holidays/${i}`,r),l=p.value.findIndex(k=>k.id===i);l!==-1&&(p.value[l]=t.data.data)}catch(t){d.value=((a=(n=t.response)==null?void 0:n.data)==null?void 0:a.message)||`Failed to update holiday with ID ${i}`}finally{o.value=!1}}async function v(i){var r,n;o.value=!0,d.value=null;try{await g.delete(`/holidays/${i}`),p.value=p.value.filter(a=>a.id!==i)}catch(a){d.value=((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.message)||`Failed to delete holiday with ID ${i}`}finally{o.value=!1}}return{holidays:p,holiday:c,loading:o,error:d,fetchHolidays:y,fetchHolidayById:u,createHoliday:s,updateHoliday:_,deleteHoliday:v}}),K={key:0,class:"modal-bg"},J={class:"modal-card"},P={class:"text-lg font-semibold"},Q={class:""},R={class:""},W={class:""},X={class:""},Z={class:""},ee={class:""},te={class:"flex justify-end"},ae={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},se={__name:"HolidayModal",props:{show:{type:Boolean,required:!0},holiday:{type:Object,default:null}},emits:["close","save"],setup(p,{emit:c}){const o=p,d=c,y=f([]),u=f(!1),s=V({id:null,year:new Date().getFullYear(),name:"",start_date:"",end_date:"",type:"government",description:"",company_id:null,company_ids:[]});s.company_ids=E(()=>y.value.filter(a=>a==null?void 0:a.id).map(a=>a.id));const _=T(),v=f([]),i=()=>{u.value=!1,s.id=null,s.year=new Date().getFullYear(),s.name="",s.start_date="",s.end_date="",s.type="government",s.description="",s.company_id=null};U(()=>o.holiday,a=>{a?(u.value=!0,Object.assign(s,a),y.value=v.value.find(t=>t.id==a.company_id)):i()},{immediate:!0,deep:!0});const r=()=>{d("save",{...s}),n()},n=()=>{d("close")};return S(async()=>{await _.fetchCompanies(),v.value=[{id:null,name:"All"},..._.companies]}),(a,t)=>p.show?(b(),w("div",K,[e("div",J,[e("h2",P,h(u.value?"Edit Holiday":"Add Holiday"),1),e("form",{onSubmit:q(r,["prevent"]),class:"space-y-2"},[e("div",Q,[t[7]||(t[7]=e("label",{for:"year",class:"block text-sm font-medium"},"Year",-1)),x(e("input",{id:"year","onUpdate:modelValue":t[0]||(t[0]=l=>s.year=l),type:"number",class:"w-full border rounded px-3 py-2",placeholder:"Enter year",required:""},null,512),[[$,s.year]])]),e("div",R,[t[8]||(t[8]=e("label",{for:"name",class:"block text-sm font-medium"},"Name",-1)),x(e("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=l=>s.name=l),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter holiday name",required:""},null,512),[[$,s.name]])]),e("div",W,[t[9]||(t[9]=e("label",{for:"start_date",class:"block text-sm font-medium"},"Start Date",-1)),x(e("input",{id:"start_date","onUpdate:modelValue":t[2]||(t[2]=l=>s.start_date=l),type:"date",class:"w-full border rounded px-3 py-2",required:""},null,512),[[$,s.start_date]])]),e("div",X,[t[10]||(t[10]=e("label",{for:"end_date",class:"block text-sm font-medium"},"End Date",-1)),x(e("input",{id:"end_date","onUpdate:modelValue":t[3]||(t[3]=l=>s.end_date=l),type:"date",class:"w-full border rounded px-3 py-2",required:""},null,512),[[$,s.end_date]])]),e("div",Z,[t[12]||(t[12]=e("label",{for:"type",class:"block text-sm font-medium"},"Type",-1)),x(e("select",{id:"type","onUpdate:modelValue":t[4]||(t[4]=l=>s.type=l),class:"w-full border rounded px-3 py-2",required:""},t[11]||(t[11]=[e("option",{value:"government"},"Government",-1),e("option",{value:"special"},"Special",-1),e("option",{value:"organizational"},"Organizational",-1)]),512),[[A,s.type]])]),e("div",null,[t[13]||(t[13]=e("label",{for:"company_id",class:"block text-sm font-medium"},"Company",-1)),H(j,{modelValue:y.value,"onUpdate:modelValue":t[5]||(t[5]=l=>y.value=l),options:v.value,multiple:!u.value,searchable:!0,placeholder:"Select companies","track-by":"id",label:"name"},null,8,["modelValue","options","multiple"])]),e("div",ee,[t[14]||(t[14]=e("label",{for:"description",class:"block text-sm font-medium"},"Description",-1)),x(e("textarea",{id:"description","onUpdate:modelValue":t[6]||(t[6]=l=>s.description=l),class:"w-full border rounded px-3 py-2",placeholder:"Enter holiday description (optional)"},null,512),[[$,s.description]])]),e("div",te,[e("button",{type:"button",onClick:n,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2"}," Cancel "),e("button",ae,h(u.value?"Update":"Create"),1)])],32)])])):B("",!0)}},le={class:"my-container space-y-2"},oe={class:"overflow-x-auto"},ne={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},de={class:"text-gray-600 text-sm"},ie={key:0},re={colspan:"5"},ue={class:"py-3 px-2 text-left"},ce={class:"font-medium"},pe={class:"py-3 px-2 text-left"},ye={class:"font-medium"},me={class:"py-3 px-2 text-center"},fe={class:"font-medium"},ve={class:"py-3 px-2 text-center"},he={class:"font-medium"},_e={class:"py-3 px-2 text-center"},xe={class:"font-medium"},be={class:"py-3 px-2 text-center"},we={class:"flex item-center justify-center gap-4"},ge=["onClick"],$e=["onClick"],He={key:2},Ee={__name:"HoliDayList",setup(p){const c=G(),o=I(),d=f(!1),y=f(!1),u=f(null),s=()=>{u.value=null,d.value=!0},_=t=>{u.value=t,d.value=!0},v=()=>{d.value=!1},i=async t=>{try{t.id?(await c.updateHoliday(t.id,t),o.success("Holiday updated successfully!")):(await c.createHoliday(t),o.success("Holiday added successfully!")),await c.fetchHolidays()}catch(l){o.error("Failed to save holiday!"),console.error("Error handling save:",l)}},r=t=>{u.value=t,y.value=!0},n=()=>{y.value=!1},a=async()=>{if(!u.value||!u.value.id){o.error("Invalid holiday selected for deletion!");return}try{await c.deleteHoliday(u.value.id),o.warning("Holiday deleted successfully!"),await c.fetchHolidays()}catch(t){o.error("Failed to delete holiday!"),console.error("Error deleting holiday:",t)}finally{n()}};return S(async()=>{await c.fetchHolidays()}),(t,l)=>{var k;return b(),w("div",le,[H(O,{title:"Holiday List",onAdd:s}),e("div",oe,[e("table",ne,[l[3]||(l[3]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"Name"),e("th",{class:"py-3 px-2 text-left"},"Company"),e("th",{class:"py-3 px-2 text-center"},"Start Date"),e("th",{class:"py-3 px-2 text-center"},"End Date"),e("th",{class:"py-3 px-2 text-center"},"Type"),e("th",{class:"py-3 px-2 text-center"},"Action")])],-1)),e("tbody",de,[D(c).loading?(b(),w("tr",ie,[e("td",re,[H(Y)])])):D(c).holidays&&D(c).holidays.length?(b(!0),w(N,{key:1},L(D(c).holidays,m=>{var C;return b(),w("tr",{key:m.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",ue,[e("p",ce,h(m.name),1)]),e("td",pe,[e("p",ye,h(((C=m==null?void 0:m.company)==null?void 0:C.name)||"All"),1)]),e("td",me,[e("p",fe,h(m.start_date),1)]),e("td",ve,[e("p",he,h(m.end_date),1)]),e("td",_e,[e("p",xe,h(m.type),1)]),e("td",be,[e("div",we,[e("button",{onClick:M=>_(m),class:"text-blue-600 hover:text-blue-800"},l[0]||(l[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ge),e("button",{onClick:M=>r(m),class:"text-red-600 hover:text-red-800"},l[1]||(l[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,$e)])])])}),128)):(b(),w("tr",He,l[2]||(l[2]=[e("td",{colspan:"5",class:"text-center text-red-500 py-4"},"No holidays found",-1)])))])])]),H(se,{show:d.value,holiday:u.value,onClose:v,onSave:i},null,8,["show","holiday"]),H(z,{show:y.value,title:"Delete Holiday",message:`Are you sure you want to delete ${(k=u.value)==null?void 0:k.name}?`,onClose:n,onConfirm:a},null,8,["show","message"])])}}};export{Ee as default};
