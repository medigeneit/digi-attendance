import{c as o,o as a,a as s,k as w,b as F,d as L,t as C,s as S,w as c,r as T,x as b,h as M,A as V,y as E,j as $,P as O,l as P,v as U,F as H,e as Q,a5 as D}from"./index-B51W9D4O.js";import{u as R}from"./useTaskStore-QJBAZmUL.js";import{_ as q}from"./TaskTitle-D26f2XGb.js";const G=["title"],J={class:S(["line-clamp-1 mr-4 "])},K={key:0,class:"border btn-2 ml-auto"},W={__name:"TodoInputTaskItem",props:{task:Object,level:Number,selected:{type:[Number,String],default:null}},emits:["select"],setup(l,{emit:h}){const i=h;return(x,r)=>(a(),o("div",{class:S(["px-2 border-b py-1 h-12 over text-sm relative group/main cursor-pointer flex items-center",[l.task.id==l.selected?"text-red-50 bg-sky-500 px-2":"hover:bg-blue-50 hover:text-blue-500"]]),onClick:r[0]||(r[0]=c(()=>i("select",l.task),["prevent"])),title:l.task.title},[s("div",J,[F(C(l.task.id)+" - ",1),L(q,{title:l.task.title},null,8,["title"])]),l.task.id!=l.selected?(a(),o("button",K,"Select")):w("",!0)],10,G))}},X={key:0,class:"line-clamp-1"},Y={key:1,class:"text-gray-500"},Z={class:"ml-auto flex items-center justify-center h-full gap-2"},_={class:"flex items-center mb-2"},ee={class:"relative"},te={class:"border flex rounded-t-md sticky top-0 bg-white"},se={class:"max-h-[200px] min-h-[60px] overflow-y-auto"},le={key:0,class:"border"},ae={key:1,class:"border h-[150px] flex flex-col items-center justify-center italic text-gray-500 text-sm"},re={__name:"TaskSelectionInput",props:{todoType:{type:String,default:"task"},taskId:{type:[String,Number],default:null},show:{type:Boolean,default:!0},readonly:{type:Boolean,default:!1},taskQueryParams:{type:Object,default:()=>{}},isOnlyMyTask:{type:Boolean,default:!0},showAddBtnIfNotFound:{type:Boolean,default:!1},filterTasks:{type:Function,default:null}},emits:["update:todoType","update:taskId","update:show","addNewTaskClick"],setup(l,{emit:h}){const i=l,x=h,r=T(""),f=b({get:()=>i.taskId,set:t=>x("update:taskId",t)}),m=b({get:()=>i.show,set:t=>x("update:show",t)}),k=T(null),B=T({});function p(){if(!(k!=null&&k.value))return;const t=k.value.getBoundingClientRect(),e=window.innerHeight,n=300,d=e-t.bottom<n;B.value={position:"fixed",top:d?t.top-n+"px":t.bottom+"px",left:t.left+"px",width:t.width+"px",zIndex:5e3}}M(async()=>{N(),await V(),window.addEventListener("resize",p),document.addEventListener("scroll",p)});async function N(){i.isOnlyMyTask?await v.fetchAllMyTasks(i.taskQueryParams):await v.fetchAllTasks(i.taskQueryParams)}const v=R();E(()=>{window.removeEventListener("resize",p),document.removeEventListener("scroll",p)});function j(t){f.value=t.id,m.value=!1}function A(){f.value="",m.value=!1}const g=b(()=>[...v.tasks||[]].find(t=>t.id==f.value)),I=b(()=>{const t=typeof i.filterTasks=="function"?[...v.tasks||[]].filter(n=>i.filterTasks(n)):v.tasks||[],e=r.value.trim().toUpperCase();return e.length?t.filter(n=>{const y=String(n.title||"").toUpperCase(),d=String(n.id??"").toUpperCase();return y.includes(e)||d.includes(e)}):t});return(t,e)=>{var n,y,d,z;return a(),o("div",{class:"relative border rounded-md shadow-sm flex items-center",ref_key:"anchor",ref:k},[s("div",{class:"w-full px-4 py-2 focus:ring-2 focus:ring-blue-500 cursor-pointer flex items-center",onClick:e[1]||(e[1]=c(()=>{l.readonly||(m.value=!0,p())},["stop"]))},[(n=g.value)!=null&&n.title?(a(),o("div",X,C((y=g.value)==null?void 0:y.id)+" - "+C((d=g.value)==null?void 0:d.title),1)):(a(),o("div",Y,"Click to select todo")),s("div",Z,[f.value&&!l.readonly?(a(),o("button",{key:0,class:"btn-icon fas fa-times !size-8 text-sm",onClick:e[0]||(e[0]=c(()=>A(),["prevent","stop"]))})):w("",!0),s("span",{class:S([[l.readonly?"text-gray-300":""],"fas fa-caret-down"])},null,2)])]),(a(),$(D,{to:"body"},[m.value?(a(),o("div",{key:0,style:O(B.value),class:"fixed bg-white rounded-b-md shadow-lg border z-[5000] p-4"},[s("div",_,[e[7]||(e[7]=s("h2",{class:"text-sky-800 text-sm uppercase"},"Task List",-1)),s("button",{class:"fas fa-redo text-gray-500 text-sm ml-4",onClick:e[2]||(e[2]=c(u=>N(),["prevent"]))}),s("button",{onClick:e[3]||(e[3]=c(()=>m.value=!1,["prevent"])),class:"ml-auto"},e[6]||(e[6]=[s("i",{class:"fas fa-times-circle text-red-700 text-xl hover:text-red-500"},null,-1)]))]),s("div",ee,[s("div",te,[P(s("input",{type:"text",placeholder:"Search task",class:"w-full py-2 px-4 rounded-t-md outline-sky-200","onUpdate:modelValue":e[4]||(e[4]=u=>r.value=u)},null,512),[[U,r.value]]),e[8]||(e[8]=s("label",{class:"ml-auto flex w-8 items-center justify-center absolute right-0 top-0 bottom-0"},[s("i",{class:"fas fa-search"})],-1))])]),s("div",se,[((z=I.value)==null?void 0:z.length)>0?(a(),o("div",le,[(a(!0),o(H,null,Q(I.value,u=>(a(),$(W,{key:u.id,task:u,onSelect:j,selected:f.value},null,8,["task","selected"]))),128))])):(a(),o("div",ae,[e[9]||(e[9]=s("div",null,"No Tasks Found",-1)),l.showAddBtnIfNotFound?(a(),o("button",{key:0,onClick:e[5]||(e[5]=c(u=>x("addNewTaskClick"),["prevent"])),class:"btn-3"}," Add New Task ")):w("",!0)]))])],4)):w("",!0)]))],512)}}};export{re as _};
