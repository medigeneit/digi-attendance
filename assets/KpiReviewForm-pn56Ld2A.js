import{f as Qe,g as Je,r as h,x as p,h as Xe,c as a,o,a as e,j as b,t as n,m as U,b as R,F as w,e as k,k as K,v as D,O as ve,n as Ze}from"./index-7XHHBKNu.js";import{u as et}from"./kpi-BgH5Hljr.js";const tt={class:"max-w-7xl mx-auto px-4 py-6 space-y-6"},st={class:"border rounded-2xl bg-white/80 backdrop-blur px-4 py-3 shadow-sm"},lt={class:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between"},nt={class:"space-y-1"},at={class:"inline-flex items-center gap-2 rounded-full bg-indigo-50 px-3 py-1"},ot={class:"text-xs text-indigo-900"},rt={class:"text-sm text-slate-600"},it={class:"font-medium text-slate-800"},dt={class:"flex flex-wrap gap-2 text-xs mt-0.5"},ut={key:0,class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},ct={class:"ml-1 font-medium text-slate-800"},xt={key:1,class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},pt={class:"ml-1 font-medium text-slate-800"},mt={class:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-slate-600"},vt={key:0,class:"ml-1 inline-flex items-center gap-1"},_t={key:1,class:"ml-1 font-semibold text-slate-800"},bt={class:"flex items-end gap-4"},ft={class:"text-right"},ht={class:"text-lg font-bold text-slate-900"},yt={class:"text-slate-400"},gt={class:"text-xs text-slate-500"},wt={key:0,class:"border rounded-2xl bg-white shadow-sm overflow-hidden"},kt={class:"overflow-auto"},Nt={class:"min-w-[980px] w-full text-sm"},Ct={class:"bg-slate-50 sticky top-0 z-10"},jt={class:"text-slate-700"},Ft={class:"font-medium"},St={class:"text-[11px] text-slate-500 flex flex-col items-center"},At={key:0,class:"mt-0.5 inline-flex items-center rounded-full bg-blue-50 px-2 py-0.5 text-[10px] font-medium text-blue-700 border border-blue-200"},Lt={class:"bg-slate-100/80 border-t"},Rt=["colspan"],Ht={class:"px-3 py-2 text-center text-slate-500"},Mt={class:"px-3 py-2 align-top"},$t={class:"font-medium text-slate-800"},Et={class:"mt-1 flex gap-1 text-[11px] text-slate-500"},Gt=["disabled","onClick"],Pt=["disabled","onClick"],Tt=["disabled","onClick"],Vt={class:"px-3 py-2 text-center text-slate-700"},Ut={key:0,class:"flex items-center justify-center"},Kt=["max","onUpdate:modelValue","onChange"],Dt={key:1,class:"text-slate-700 text-sm"},zt={key:2,class:"text-slate-300 text-sm"},Bt={class:"bg-slate-50 border-t"},Ot={class:"px-3 py-2 text-center font-semibold text-slate-800"},It=["colspan"],Yt={class:"font-semibold text-slate-900"},qt={class:"text-slate-500"},Wt={key:1,class:"mt-2"},Qt={class:"grid gap-4 lg:grid-cols-5"},Jt={class:"space-y-4 lg:col-span-3"},Xt={class:"flex items-center justify-between border-b bg-slate-50 px-4 py-2.5"},Zt={class:"text-sm font-semibold text-slate-800"},es={class:"flex items-center gap-2 text-[11px] text-slate-500"},ts=["onClick","disabled"],ss=["onClick","disabled"],ls=["onClick","disabled"],ns={class:"overflow-auto"},as={class:"w-full text-sm"},os={class:"px-3 py-2 text-center text-slate-500"},rs={class:"px-3 py-2"},is={class:"font-medium text-slate-800"},ds={class:"px-3 py-2 text-center text-slate-700"},us={class:"px-3 py-2 text-center"},cs=["max","onUpdate:modelValue","onChange"],xs={key:1,class:"text-slate-700"},ps={class:"bg-slate-50 border-t"},ms={class:"px-3 py-2 text-center font-semibold text-slate-800"},vs={class:"px-3 py-2 text-center text-sm"},_s={class:"lg:col-span-2 space-y-4"},bs={key:0,class:"border rounded-2xl bg-white shadow-sm"},fs={class:"flex items-center justify-between border-b px-4 py-3 text-sm font-semibold text-slate-800"},hs={class:"flex items-center gap-1 text-[11px] text-slate-500"},ys={key:0,class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},gs={class:"rounded-full border bg-slate-50 px-2 py-0.5 text-slate-700"},ws={class:"p-4 space-y-3"},ks={class:"grid grid-cols-1 gap-3 sm:grid-cols-2"},Ns={class:"rounded-xl border bg-slate-50 p-3"},Cs={class:"flex items-center justify-between"},js={class:"text-[11px] px-1.5 py-0.5 rounded bg-blue-50 text-blue-700 border border-blue-200"},Fs={class:"mt-1 text-sm font-semibold text-slate-900"},Ss={class:"text-xs text-slate-500"},As={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},Ls={class:"rounded-xl border bg-slate-50 p-3"},Rs={class:"flex items-center justify-between"},Hs={class:"text-[11px] px-1.5 py-0.5 rounded bg-violet-50 text-violet-700 border border-violet-200"},Ms={class:"mt-1 text-sm font-semibold text-slate-900"},$s={class:"text-xs text-slate-500"},Es={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},Gs={class:"rounded-xl border bg-slate-50 p-3 sm:col-span-2"},Ps={class:"flex items-center justify-between"},Ts={class:"text-[11px] px-1.5 py-0.5 rounded bg-emerald-50 text-emerald-700 border border-emerald-200"},Vs={class:"mt-1 text-sm font-semibold text-slate-900"},Us={class:"text-xs text-slate-500"},Ks={class:"mt-2 h-2 rounded bg-slate-100 overflow-hidden"},Ds={class:"border-t pt-2 text-xs"},zs={key:0,class:"mt-3 rounded-xl border bg-slate-50 p-3 text-xs space-y-1"},Bs={class:"flex justify-between"},Os={class:"font-medium"},Is={class:"flex justify-between"},Ys={class:"font-medium"},qs={class:"flex justify-between"},Ws={class:"font-medium"},Qs={class:"flex justify-between"},Js={class:"font-medium"},Xs={class:"flex justify-between"},Zs={class:"font-medium"},el={class:"flex justify-between"},tl={class:"font-medium"},sl={class:"flex justify-between"},ll={class:"font-medium"},nl={class:"flex justify-between"},al={class:"font-medium"},ol={key:1,class:"border rounded-2xl bg-white shadow-sm"},rl={class:"flex items-center justify-between border-b px-4 py-3 text-sm font-semibold text-slate-800"},il={class:"text-[11px] text-slate-500"},dl={class:"p-4 space-y-3"},ul={class:"max-h-96 overflow-auto border rounded-xl"},cl={class:"min-w-full text-xs text-left"},xl={class:"px-2 py-2"},pl={class:"font-semibold text-slate-700"},ml={key:0,class:"mt-0.5 text-[11px] text-slate-400"},vl={class:"px-2 py-2"},_l={key:0,class:"flex flex-wrap gap-1"},bl={key:1,class:"text-slate-400"},fl={class:"px-2 py-2"},hl={key:0,class:"flex flex-wrap gap-1"},yl={key:1,class:"text-slate-400"},gl={class:"px-2 py-2"},wl={key:0,class:"flex flex-wrap gap-1"},kl={key:1,class:"text-slate-400"},Nl={key:2,class:"rounded-2xl bg-white border shadow-sm px-4 py-4 space-y-4"},Cl={class:"grid gap-4 md:grid-cols-3"},jl={class:"space-y-3"},Fl={class:"flex items-center justify-between text-xs font-semibold text-slate-600"},Sl={key:0,class:"text-[11px] text-emerald-600"},Al={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 max-h-32 overflow-y-auto"},Ll={class:"flex flex-wrap gap-1.5"},Rl=["onClick","disabled"],Hl={key:1,class:"text-[11px] text-slate-400"},Ml={class:"space-y-1"},$l={class:"space-y-3"},El={class:"flex items-center justify-between text-xs font-semibold text-slate-600"},Gl={key:0,class:"text-[11px] text-amber-600"},Pl={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 max-h-32 overflow-y-auto"},Tl={class:"flex flex-wrap gap-1.5"},Vl=["onClick","disabled"],Ul={key:1,class:"text-[11px] text-slate-400"},Kl={class:"space-y-1"},Dl={class:"space-y-3"},zl={class:"flex items-center justify-between text-xs font-semibold text-slate-600"},Bl={key:0,class:"text-[11px] text-sky-600"},Ol={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50/70 p-3 max-h-32 overflow-y-auto"},Il={class:"flex flex-wrap gap-1.5"},Yl=["onClick","disabled"],ql={class:"space-y-1"},Wl={class:"mt-2 flex flex-col gap-3 border-t pt-3 md:flex-row md:items-center md:justify-between"},Ql={class:"text-sm text-slate-600"},Jl={class:"text-slate-900"},Xl={class:"text-slate-400"},Zl=["disabled"],ln={__name:"KpiReviewForm",setup(en){const z=Qe(),y=et(),le=Je(),_=h({}),H=h({}),B=h(""),O=h(""),I=h(""),M=h(null),Y=h(!1),_e=h([]),q=h({}),j=h(null),ne=h(!1),ae=p(()=>{var s;return((s=y.cycle)==null?void 0:s.groups_json)||[]}),be=s=>(s==null?void 0:s.id)==="personal"||/personal/i.test((s==null?void 0:s.label)||""),S=p(()=>ae.value.find(be)||null),oe=p(()=>ae.value.filter(s=>!be(s))),Ve=(s,t)=>(s==null?void 0:s.label)||`Group ${t+1}`,Ue=s=>/^hr\d*$/i.test(s)||s==="hr",fe=s=>Ue((s==null?void 0:s.key)||"")||(s==null?void 0:s.is_hr_lane)===!0,he=p(()=>[..._e.value||[]].sort((s,t)=>(s.rank??999)-(t.rank??999))),re=p(()=>he.value.filter(fe)),A=p(()=>he.value.filter(s=>!fe(s))),Ke=p(()=>A.value.find(s=>s.key===j.value)||null),De=p(()=>{var s;return((s=Ke.value)==null?void 0:s.rank)??null}),ze=p(()=>{var s;return Number(((s=le==null?void 0:le.user)==null?void 0:s.id)||0)}),ie=p(()=>{const s=ze.value;if(!s)return null;const t=re.value.find(r=>Number(r.assigned_user_id)===s);return t||re.value.find(r=>r.can_current_user_review)||null}),F=p(()=>{var s;return((s=ie.value)==null?void 0:s.key)||null}),Be=p(()=>!!(ie.value&&ie.value.can_current_user_review)),N=p(()=>!!(ne.value||Be.value)),L=p(()=>!!j.value&&A.value.some(s=>s.key===j.value&&s.can_current_user_review)),W=p(()=>N.value&&F.value?F.value:j.value),ye=p(()=>!!(W.value&&F.value&&W.value===F.value));function de(s){var r;return(((r=q.value)==null?void 0:r[s])||[])[0]||null}function ge(s,t){var i;const r=de(s);return((i=r==null?void 0:r.marks)==null?void 0:i[t])??""}function we(s){var r,i,x,d;if(F.value){const f=de(F.value),C=(r=f==null?void 0:f.marks)==null?void 0:r[s];if(C!=null)return C}let t=null;for(const f of re.value){const v=(((i=q.value)==null?void 0:i[f.key])||[])[0];if(!(!v||((x=v==null?void 0:v.marks)==null?void 0:x[s])==null)){if(!t){t=v;continue}v.submitted_at&&t.submitted_at&&v.submitted_at>t.submitted_at&&(t=v)}}return((d=t==null?void 0:t.marks)==null?void 0:d[s])??""}function ue(s,t){const r=Number(_.value[s]??0);r<0&&(_.value[s]=0),r>Number(t)&&(_.value[s]=Number(t))}function Q(s,t,r){r==="zero"?_.value[s]=0:r==="half"?_.value[s]=Number(t)/2:r==="full"&&(_.value[s]=Number(t)),ue(s,t)}function ce(s,t){s.items.forEach(r=>Q(r.id,r.max,t))}const G=p(()=>{let s=0,t=0;const r=S.value;r&&r.items.forEach(x=>{s+=Number(x.max||0);const d=Number(_.value[x.id]||0);t+=Math.min(Math.max(d,0),Number(x.max||0))});const i=s>0?t/s*100:0;return{max:Number(s.toFixed(2)),got:Number(t.toFixed(2)),percent:Number(i.toFixed(2))}}),Oe=p(()=>!!M.value&&typeof M.value=="object"),m=p(()=>{var s;return((s=M.value)==null?void 0:s.avg)||{max:0,incharge:0,coordinator:0,final:0,percent_simple:0,percent_weighted:0}}),xe=p(()=>{var s;return((s=M.value)==null?void 0:s.year)??null}),ke=p(()=>{var s;return((s=M.value)==null?void 0:s.months_total_form)??0}),J=p(()=>{const s=q.value||{},t=A.value||[],r=[],i=ye.value||N.value?1/0:De.value??null,x=d=>d?Array.isArray(d)?d.filter(Boolean):typeof d=="string"&&d.trim()!==""?[d.trim()]:[]:[];return t.forEach(d=>{const f=d.key;if(!f||i!=null&&(d.rank??999)>i)return;const C=s[f]||[];if(!Array.isArray(C)||!C.length)return;const v=C[0],P=x(v.strengths),T=x(v.gaps),V=x(v.suggestions);!P.length&&!T.length&&!V.length||r.push({key:f,lane:f,label:d.label||(v==null?void 0:v.lane_label)||f,reviewer_id:v.reviewer_id,reviewer_name:v.reviewer_name,strengths:P,gaps:T,suggestions:V,submitted_at:v.submitted_at??null})}),r}),Ie=s=>{const t=new Set;return J.value.forEach(r=>{(Array.isArray(r[s])?r[s]:[]).forEach(x=>{const d=typeof x=="string"?x.trim():"";d&&t.add(d)})}),Array.from(t)},Ne=s=>{if(!Array.isArray(s))return[];const t=new Set;return s.forEach(r=>{const i=typeof r=="string"?r.trim():"";i&&t.add(i)}),Array.from(t)},X=p(()=>Ne(y.strengths)),Z=p(()=>Ne(y.gaps)),ee=p(()=>Ie("suggestions"));h([]),h([]),h([]);const Ce={strengths:B,gaps:O,suggestions:I};function Ye(s,t){const r=(t||"").trim();return r?s!=null&&s.trim()?`${s.trim()}
${r}`:r:s}const qe=p(()=>{const s={};let t=1;const r=S.value;return r&&r.items.forEach(i=>{s[i.id]=t++}),s});Xe(async()=>{var t,r;y.cycle||await y.fetchActiveCycle(Number(z.params.employeeId));const s=await y.fetchLanes(y.cycle.id,Number(z.params.employeeId));if(H.value=s.employee,M.value=(s==null?void 0:s.annual_target_avg_marks)||null,_e.value=s.lanes||[],q.value=s.reviews_by_lane||{},ne.value=!!(((t=s==null?void 0:s.meta)==null?void 0:t.is_hr)??(s==null?void 0:s.hr)??!1),j.value=((r=A.value.find(i=>i.can_current_user_review))==null?void 0:r.key)||null,ae.value.forEach(i=>i.items.forEach(x=>{_.value[x.id]==null&&(_.value[x.id]=0)})),j.value){const i=de(j.value);i!=null&&i.marks&&Object.assign(_.value,i.marks)}N.value&&oe.value.forEach(i=>{i.items.forEach(x=>{let d=F.value?ge(F.value,x.id):"";(d===""||d==null)&&(d=we(x.id)),d!==""&&d!=null&&(_.value[x.id]=Number(d))})})});async function We(){const s=W.value;if(!s){alert("Unable to determine reviewer lane.");return}F.value,await y.submitReview({cycle_id:y.cycle.id,employee_id:Number(z.params.employeeId),reviewer_lane:s,marks:_.value,strengths:B.value,gaps:O.value,suggestions:I.value}),alert("Submitted")}function g(s){const t=Number(s??0);return isNaN(t)?"0.00":t.toFixed(2)}function $(s,t){const r=Number(s??0),i=Number(t??0);return i>0?Math.round(r/i*100):0}function te(s,t){const r=Ce[s];if(!r)return!1;const i=(r.value||"").split(`
`).map(d=>d.trim()).filter(Boolean),x=(t||"").trim();return x?i.includes(x):!1}function pe(s,t){const r=Ce[s];if(!r)return;const i=typeof t=="string"?t.trim():"";i&&(te(s,i)||(r.value=Ye(r.value,i)))}return(s,t)=>{var r,i,x,d,f,C,v,P,T,V,me,je,Fe,Se,Ae,Le,Re,He,Me,$e,Ee,Ge,Pe,Te;return o(),a("div",tt,[e("header",st,[e("div",lt,[e("div",nt,[e("div",at,[t[5]||(t[5]=e("span",{class:"text-xs font-semibold text-indigo-700"},"KPI Cycle",-1)),e("span",ot,n((r=U(y).cycle)==null?void 0:r.title),1)]),e("div",rt,[e("div",it,n(((i=H.value)==null?void 0:i.name)||"Employee"),1),e("div",dt,[(d=(x=H.value)==null?void 0:x.designation)!=null&&d.title?(o(),a("span",ut,[t[6]||(t[6]=R(" Designation: ")),e("span",ct,n(H.value.designation.title),1)])):b("",!0),(C=(f=H.value)==null?void 0:f.department)!=null&&C.name?(o(),a("span",xt,[t[7]||(t[7]=R(" Department: ")),e("span",pt,n(H.value.department.name),1)])):b("",!0),e("span",mt,[t[9]||(t[9]=R(" Reviewing as: ")),ye.value?(o(),a("span",vt,t[8]||(t[8]=[e("span",{class:"font-semibold text-emerald-700"},"HR",-1),e("span",{class:"text-[10px] rounded bg-emerald-50 border border-emerald-200 px-1.5 py-0.5 text-emerald-700"}," HR mode ",-1)]))):(o(),a("span",_t,n(W.value||"No lane"),1))])])])]),e("div",bt,[e("div",ft,[t[10]||(t[10]=e("div",{class:"text-[11px] uppercase tracking-wide text-slate-500"}," Personal group total ",-1)),e("div",ht,[R(n(G.value.got.toFixed(2))+" ",1),e("span",yt,"/ "+n(G.value.max.toFixed(2)),1)]),e("div",gt,n(G.value.percent.toFixed(2))+"% achieved ",1)]),ne.value?(o(),a("button",{key:0,onClick:t[0]||(t[0]=l=>U(y).submitFinalResult(U(y).cycle.id,U(z).params.employeeId)),class:"inline-flex items-center gap-2 rounded-xl bg-indigo-600 px-4 py-2.5 text-sm font-medium text-white shadow hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-300 focus:outline-none"},t[11]||(t[11]=[e("span",null,"Finalize & Lock",-1)]))):b("",!0)])])]),U(y).cycle&&S.value?(o(),a("section",wt,[t[17]||(t[17]=e("div",{class:"flex items-center justify-between border-b bg-slate-50 px-4 py-2"},[e("div",{class:"text-sm font-semibold text-slate-800"}," Personal Evaluation "),e("div",{class:"text-xs text-slate-500"}," Fill only your lane; others appear as read-only. ")],-1)),e("div",kt,[e("table",Nt,[e("thead",Ct,[e("tr",jt,[t[12]||(t[12]=e("th",{class:"px-3 py-2 w-[40px] text-center font-medium"},"#",-1)),t[13]||(t[13]=e("th",{class:"text-left px-3 py-2 w-[20%] font-medium"},"মূল্যায়নের বিষয় (Personal)",-1)),t[14]||(t[14]=e("th",{class:"px-3 py-2 text-center font-medium"},"Max",-1)),(o(!0),a(w,null,k(A.value,l=>(o(),a("th",{key:l.key,class:"px-3 py-2 text-center font-medium"},[e("div",Ft,n(l.label||l.key),1),e("div",St,[e("span",null,n(l.assigned_user_name||"-"),1),l.key===j.value&&l.can_current_user_review?(o(),a("span",At," You can edit ")):b("",!0)])]))),128))])]),e("tbody",null,[e("tr",Lt,[e("td",{colspan:3+A.value.length,class:"px-3 py-2 font-medium text-slate-800"},n(S.value.label||"Personal"),9,Rt)]),(o(!0),a(w,null,k(S.value.items,l=>(o(),a("tr",{key:l.id,class:"border-t hover:bg-slate-50/60"},[e("td",Ht,n(qe.value[l.id]),1),e("td",Mt,[e("div",$t,n(l.label),1),e("div",Et,[e("button",{class:"border rounded px-1.5 py-0.5 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!L.value,onClick:u=>L.value&&Q(l.id,l.max,"zero")}," 0 ",8,Gt),e("button",{class:"border rounded px-1.5 py-0.5 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!L.value,onClick:u=>L.value&&Q(l.id,l.max,"half")}," ½ ",8,Pt),e("button",{class:"border rounded px-1.5 py-0.5 disabled:opacity-40 disabled:cursor-not-allowed",disabled:!L.value,onClick:u=>L.value&&Q(l.id,l.max,"full")}," Full ",8,Tt)])]),e("td",Vt,n(l.max),1),(o(!0),a(w,null,k(A.value,u=>(o(),a("td",{key:u.key,class:"px-3 py-2 text-center"},[u.key===j.value&&u.can_current_user_review?(o(),a("div",Ut,[K(e("input",{type:"number",step:"0.1",min:"0",max:l.max,"onUpdate:modelValue":c=>_.value[l.id]=c,onChange:c=>ue(l.id,l.max),inputmode:"decimal",class:"w-24 text-right rounded-lg border px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"},null,40,Kt),[[D,_.value[l.id],void 0,{number:!0}]])])):u.can_view_marks?(o(),a("div",Dt,n(ge(u.key,l.id)),1)):(o(),a("div",zt," — "))]))),128))]))),128)),e("tr",Bt,[t[15]||(t[15]=e("td",null,null,-1)),t[16]||(t[16]=e("td",{class:"px-3 py-2 text-right font-medium text-slate-700"}," Group Total ",-1)),e("td",Ot,n(S.value.items.reduce((l,u)=>l+Number(u.max||0),0).toFixed(2)),1),e("td",{colspan:A.value.length,class:"px-3 py-2 text-center text-sm"},[e("span",Yt,n(S.value.items.reduce((l,u)=>{const c=Number(_.value[u.id]||0);return l+Math.min(Math.max(c,0),Number(u.max||0))},0).toFixed(2)),1),e("span",qt," / "+n(S.value.items.reduce((l,u)=>l+Number(u.max||0),0).toFixed(2)),1)],8,It)])])])])])):b("",!0),oe.value.length?(o(),a("section",Wt,[e("div",Qt,[e("div",Jt,[(o(!0),a(w,null,k(oe.value,(l,u)=>(o(),a("div",{key:u,class:"overflow-hidden border rounded-2xl bg-white shadow-sm"},[e("div",Xt,[e("div",Zt," Group "+n(u+1)+" — "+n(Ve(l,u)),1),e("div",es,[t[18]||(t[18]=e("span",null,"Quick fill:",-1)),e("button",{class:"rounded border px-1.5 py-0.5 hover:bg-slate-100 disabled:opacity-40",onClick:c=>ce(l,"zero"),disabled:!N.value}," All 0 ",8,ts),e("button",{class:"rounded border px-1.5 py-0.5 hover:bg-slate-100 disabled:opacity-40",onClick:c=>ce(l,"half"),disabled:!N.value}," All ½ ",8,ss),e("button",{class:"rounded border px-1.5 py-0.5 hover:bg-slate-100 disabled:opacity-40",onClick:c=>ce(l,"full"),disabled:!N.value}," All Full ",8,ls)])]),e("div",ns,[e("table",as,[t[21]||(t[21]=e("thead",{class:"sticky top-0 bg-white z-10"},[e("tr",{class:"bg-slate-100 text-slate-700"},[e("th",{class:"px-3 py-2 w-[40px] text-center font-medium"},"#"),e("th",{class:"text-left px-3 py-2 w-[30%] font-medium"},"Item"),e("th",{class:"px-3 py-2 text-center w-[40px] font-medium"},"Max"),e("th",{class:"px-3 py-2 text-center w-[80px] font-medium"}," HR Score ")])],-1)),e("tbody",null,[(o(!0),a(w,null,k(l.items,(c,E)=>(o(),a("tr",{key:c.id,class:"border-t hover:bg-slate-50/60"},[e("td",os,n(E+1),1),e("td",rs,[e("div",is,n(c.label),1)]),e("td",ds,n(c.max),1),e("td",us,[N.value?K((o(),a("input",{key:0,type:"number",step:"0.1",min:"0",max:c.max,"onUpdate:modelValue":se=>_.value[c.id]=se,onChange:se=>ue(c.id,c.max),inputmode:"decimal",class:"w-24 text-right rounded-lg border px-2 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-200"},null,40,cs)),[[D,_.value[c.id],void 0,{number:!0}]]):(o(),a("span",xs,n(we(c.id)),1))])]))),128)),e("tr",ps,[t[19]||(t[19]=e("td",null,null,-1)),t[20]||(t[20]=e("td",{class:"px-3 py-2 text-right font-medium text-slate-700"}," Group Total ",-1)),e("td",ms,n(l.items.reduce((c,E)=>c+Number(E.max||0),0).toFixed(2)),1),e("td",vs,n(l.items.reduce((c,E)=>{const se=Number(_.value[E.id]||0);return c+Math.min(Math.max(se,0),Number(E.max||0))},0).toFixed(2)),1)])])])])]))),128))]),e("aside",_s,[Oe.value&&N.value?(o(),a("section",bs,[e("header",fs,[t[22]||(t[22]=e("span",null,"Annual Target",-1)),e("div",hs,[xe.value?(o(),a("span",ys," Year "+n(xe.value),1)):b("",!0),e("span",gs,n(ke.value)+" month(s) ",1)])]),e("div",ws,[e("div",ks,[e("div",Ns,[e("div",Cs,[t[23]||(t[23]=e("span",{class:"text-xs font-medium text-slate-600"},"Incharge",-1)),e("span",js,n($((v=m.value.per_scored_month)==null?void 0:v.incharge,m.value.per_scored_month.max))+"% ",1)]),e("div",Fs,[R(n(g((P=m.value.per_scored_month)==null?void 0:P.incharge))+" ",1),e("span",Ss,"/ "+n(g(m.value.per_scored_month.max)),1)]),e("div",As,[e("div",{class:"h-2 bg-blue-500",style:ve({width:$((T=m.value.per_scored_month)==null?void 0:T.incharge,(V=m.value.per_scored_month)==null?void 0:V.max)+"%"})},null,4)])]),e("div",Ls,[e("div",Rs,[t[24]||(t[24]=e("span",{class:"text-xs font-medium text-slate-600"},"Coordinator",-1)),e("span",Hs,n($(m.value.per_scored_month.coordinator,m.value.per_scored_month.max))+"% ",1)]),e("div",Ms,[R(n(g((me=m.value.per_scored_month)==null?void 0:me.coordinator))+" ",1),e("span",$s,"/ "+n(g((je=m.value.per_scored_month)==null?void 0:je.max)),1)]),e("div",Es,[e("div",{class:"h-2 bg-violet-500",style:ve({width:$((Fe=m.value.per_scored_month)==null?void 0:Fe.coordinator,(Se=m.value.per_scored_month)==null?void 0:Se.max)+"%"})},null,4)])]),e("div",Gs,[e("div",Ps,[t[25]||(t[25]=e("span",{class:"text-xs font-medium text-slate-600"},"Final",-1)),e("span",Ts,n($((Ae=m.value.per_form_yearly)==null?void 0:Ae.final,(Le=m.value.per_scored_month)==null?void 0:Le.max))+"% ",1)]),e("div",Vs,[R(n(g((Re=m.value.per_form_yearly)==null?void 0:Re.final))+" ",1),e("span",Us,"/ "+n(g((He=m.value.per_scored_month)==null?void 0:He.max)),1)]),e("div",Ks,[e("div",{class:"h-2 bg-emerald-500",style:ve({width:$((Me=m.value.per_form_yearly)==null?void 0:Me.final,($e=m.value.per_scored_month)==null?void 0:$e.max)+"%"})},null,4)])])]),e("div",Ds,[e("button",{class:"text-xs px-3 py-1.5 rounded-md border hover:bg-slate-50",onClick:t[1]||(t[1]=l=>Y.value=!Y.value)},n(Y.value?"Hide details":"Show details"),1),Y.value?(o(),a("div",zs,[e("div",Bs,[t[26]||(t[26]=e("span",{class:"text-slate-500"},"Year",-1)),e("span",Os,n(xe.value||"-"),1)]),e("div",Is,[t[27]||(t[27]=e("span",{class:"text-slate-500"},"Months counted",-1)),e("span",Ys,n(ke.value),1)]),e("div",qs,[t[28]||(t[28]=e("span",{class:"text-slate-500"},"Max (denominator)",-1)),e("span",Ws,n(g((Ee=m.value.per_scored_month)==null?void 0:Ee.max)),1)]),e("div",Qs,[t[29]||(t[29]=e("span",{class:"text-slate-500"},"Incharge avg",-1)),e("span",Js,n(g((Ge=m.value.per_form_yearly)==null?void 0:Ge.incharge)),1)]),e("div",Xs,[t[30]||(t[30]=e("span",{class:"text-slate-500"},"Coordinator avg",-1)),e("span",Zs,n(g((Pe=m.value.per_form_yearly)==null?void 0:Pe.coordinator)),1)]),e("div",el,[t[31]||(t[31]=e("span",{class:"text-slate-500"},"Final avg",-1)),e("span",tl,n(g((Te=m.value.per_form_yearly)==null?void 0:Te.final)),1)]),e("div",sl,[t[32]||(t[32]=e("span",{class:"text-slate-500"},"Percent (simple)",-1)),e("span",ll,n(g(m.value.percent_simple))+"%",1)]),e("div",nl,[t[33]||(t[33]=e("span",{class:"text-slate-500"},"Percent (weighted)",-1)),e("span",al,n(g(m.value.percent_weighted))+"%",1)])])):b("",!0)])])])):b("",!0),J.value.length?(o(),a("section",ol,[e("header",rl,[t[34]||(t[34]=e("span",null,"Review Comments",-1)),e("span",il,n(J.value.length)+" lane(s) ",1)]),e("div",dl,[e("div",ul,[e("table",cl,[t[35]||(t[35]=e("thead",{class:"text-[11px] text-slate-600 uppercase tracking-wide bg-slate-50"},[e("tr",null,[e("th",{class:"px-2 py-2 w-[90px]"},"Lane"),e("th",{class:"px-2 py-2"},"Strengths"),e("th",{class:"px-2 py-2"},"Gaps"),e("th",{class:"px-2 py-2"},"Suggestions")])],-1)),e("tbody",null,[(o(!0),a(w,null,k(J.value,l=>(o(),a("tr",{key:l.key,class:"border-t hover:bg-slate-50/60 align-top"},[e("td",xl,[e("div",pl,n(l.label),1),l.submitted_at?(o(),a("div",ml,n(new Date(l.submitted_at).toLocaleDateString()),1)):b("",!0)]),e("td",vl,[l.strengths&&l.strengths.length?(o(),a("div",_l,[(o(!0),a(w,null,k(l.strengths,(u,c)=>(o(),a("span",{key:"s-"+c,class:"inline-flex items-center rounded-full bg-emerald-50 border border-emerald-100 px-2 py-0.5 text-[11px] text-emerald-700"},n(u),1))),128))])):(o(),a("span",bl,"—"))]),e("td",fl,[l.gaps&&l.gaps.length?(o(),a("div",hl,[(o(!0),a(w,null,k(l.gaps,(u,c)=>(o(),a("span",{key:"g-"+c,class:"inline-flex items-center rounded-full bg-amber-50 border border-amber-100 px-2 py-0.5 text-[11px] text-amber-800"},n(u),1))),128))])):(o(),a("span",yl,"—"))]),e("td",gl,[l.suggestions&&l.suggestions.length?(o(),a("div",wl,[(o(!0),a(w,null,k(l.suggestions,(u,c)=>(o(),a("span",{key:"su-"+c,class:"inline-flex items-center rounded-full bg-sky-50 border border-sky-100 px-2 py-0.5 text-[11px] text-sky-800"},n(u),1))),128))])):(o(),a("span",kl,"—"))])]))),128))])])])])])):b("",!0)])])])):b("",!0),L.value||N.value?(o(),a("section",Nl,[t[42]||(t[42]=Ze('<header class="flex items-center justify-between mb-1"><div><h2 class="text-sm font-semibold text-slate-800"> Overall Review Notes </h2><p class="text-[11px] text-slate-500"> Use saved hints or write your own detailed comments. </p></div><div class="hidden md:flex items-center gap-2 text-[11px] text-slate-500"><span class="inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-0.5 border border-emerald-100"><span class="text-xs">●</span> Strengths </span><span class="inline-flex items-center gap-1 rounded-full bg-amber-50 px-2 py-0.5 border border-amber-100"><span class="text-xs">●</span> Gaps </span><span class="inline-flex items-center gap-1 rounded-full bg-sky-50 px-2 py-0.5 border border-sky-100"><span class="text-xs">●</span> Suggestions </span></div></header>',1)),e("div",Cl,[e("div",jl,[e("header",Fl,[t[36]||(t[36]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-emerald-500 text-base leading-none"},"★"),e("span",null,"Strengths")],-1)),X.value.length?(o(),a("span",Sl,n(X.value.length)+" saved hint(s) ",1)):b("",!0)]),X.value.length?(o(),a("div",Al,[e("div",Ll,[(o(!0),a(w,null,k(X.value,l=>(o(),a("button",{key:l,type:"button",onClick:u=>pe("strengths",l),disabled:te("strengths",l),class:"rounded-full border px-2.5 py-1 text-[11px] font-medium transition border-slate-200 bg-white text-slate-700 hover:border-emerald-300 hover:bg-emerald-50 hover:text-emerald-800 disabled:opacity-40 disabled:cursor-not-allowed"},n(l),9,Rl))),128))])])):(o(),a("p",Hl," No historical strengths yet. Write your own notes below. ")),e("div",Ml,[t[37]||(t[37]=e("label",{class:"text-[11px] font-medium text-slate-500"}," Key Strength(s) ",-1)),K(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=l=>B.value=l),placeholder:"e.g. Strong ownership, proactive problem solving…",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-emerald-200"},null,512),[[D,B.value]])])]),e("div",$l,[e("header",El,[t[38]||(t[38]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-amber-500 text-base leading-none"},"!"),e("span",null,"Gaps")],-1)),Z.value.length?(o(),a("span",Gl,n(Z.value.length)+" saved hint(s) ",1)):b("",!0)]),Z.value.length?(o(),a("div",Pl,[e("div",Tl,[(o(!0),a(w,null,k(Z.value,l=>(o(),a("button",{key:l,type:"button",onClick:u=>pe("gaps",l),disabled:te("gaps",l),class:"rounded-full border px-2.5 py-1 text-[11px] font-medium transition border-slate-200 bg-white text-slate-700 hover:border-amber-300 hover:bg-amber-50 hover:text-amber-800 disabled:opacity-40 disabled:cursor-not-allowed"},n(l),9,Vl))),128))])])):(o(),a("p",Ul," No historical gaps yet. ")),e("div",Kl,[t[39]||(t[39]=e("label",{class:"text-[11px] font-medium text-slate-500"},"GAP(s)",-1)),K(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=l=>O.value=l),placeholder:"e.g. Needs improvement in documentation, communication…",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-amber-200"},null,512),[[D,O.value]])])]),e("div",Dl,[e("header",zl,[t[40]||(t[40]=e("div",{class:"flex items-center gap-1"},[e("span",{class:"text-sky-500 text-base leading-none"},"✱"),e("span",null,"Suggestions / Training")],-1)),ee.value.length?(o(),a("span",Bl,n(ee.value.length)+" common suggestion(s) ",1)):b("",!0)]),ee.value.length?(o(),a("div",Ol,[e("div",Il,[(o(!0),a(w,null,k(ee.value,l=>(o(),a("button",{key:l,type:"button",onClick:u=>pe("suggestions",l),disabled:te("suggestions",l),class:"rounded-full border px-2.5 py-1 text-[11px] font-medium transition border-slate-200 bg-white text-slate-700 hover:border-sky-300 hover:bg-sky-50 hover:text-sky-800 disabled:opacity-40 disabled:cursor-not-allowed"},n(l),9,Yl))),128))])])):b("",!0),e("div",ql,[t[41]||(t[41]=e("label",{class:"text-[11px] font-medium text-slate-500"}," Suggestions / Development plan ",-1)),K(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=l=>I.value=l),placeholder:"Specific actions, training plans, timeline and expectations…",class:"w-full rounded-xl border px-3 py-2 text-sm min-h-28 focus:outline-none focus:ring-2 focus:ring-sky-200"},null,512),[[D,I.value]])])])])])):b("",!0),e("div",Wl,[e("div",Ql,[t[43]||(t[43]=R(" My (Personal) Total: ")),e("b",Jl,n(G.value.got.toFixed(2)),1),e("span",Xl,"/ "+n(G.value.max.toFixed(2)),1)]),e("button",{onClick:We,disabled:!(N.value||L.value),class:"inline-flex items-center justify-center rounded-xl bg-emerald-600 px-5 py-2.5 text-sm font-medium text-white shadow hover:bg-emerald-700 disabled:opacity-40 focus:outline-none focus:ring-2 focus:ring-emerald-300"}," Submit ",8,Zl)])])}}};export{ln as default};
