import{u as le,b as se,r as g,e as oe,x as U,m as ae,c as d,o as i,a as t,q as G,k as u,h as v,v as f,g as w,j as y,t as p,p as I,F as re,n as ne,K as J,w as _,C as de}from"./index-D9IEX7DE.js";import{_ as ie}from"./EmployeeFilter-Ca3ZoABE.js";import{L as ue}from"./LoaderView-BmbnyFUa.js";import{u as pe}from"./manual-attendance-DQc6tVzx.js";import{u as ce}from"./user-C1oOsaUK.js";import"./MultiselectDropdown-C1SgkTOl.js";import"./company-CqJ1XfCM.js";import"./department-27-mR-EF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ye={class:"space-y-2 px-4"},me={class:"flex items-center justify-between gap-2"},ve={class:"flex flex-wrap gap-2"},be={key:0,class:"text-center py-4"},ge={key:1,class:"space-y-4"},_e={key:0,class:"bg-sky-100/30 p-4 rounded-lg shadow mb-6 space-y-4"},ke={class:"grid gap-6"},xe={class:"bg-white border rounded-lg p-4 shadow"},he={class:"grid grid-cols-2 sm:grid-cols-4 gap-y-1 text-sm text-gray-600"},fe={class:"overflow-x-auto"},we={key:0,class:"text-red-500 text-sm text-left"},Ce={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Ve={class:"bg-gray-200"},Ae={class:"border border-gray-300 px-2 text-left py-2"},Ue={class:"flex items-center justify-center gap-2"},Me=["onClick"],Se={class:"border border-gray-300 px-2 cursor-pointer text-center"},qe=["onUpdate:modelValue"],Be={class:"border border-gray-300 px-2"},Fe=["onUpdate:modelValue"],De={class:"border border-gray-300 px-2"},Pe=["onUpdate:modelValue"],je={class:"border border-gray-300 px-2"},Ne=["onUpdate:modelValue"],$e={class:"border border-gray-300 px-2"},Ee=["onUpdate:modelValue"],Re={class:"border border-gray-300 px-2"},Te=["onUpdate:modelValue","disabled"],Le={key:0},Oe={key:1},He={class:"space-y-6"},Ke={key:0,class:"text-red-500 text-sm text-left"},We={class:"flex items-center justify-center gap-2 cursor-pointer"},ze={class:"flex justify-center"},Ge=["disabled"],Ie={key:0},Je={key:1},rt={__name:"AdminManualAttendanceApplication",setup(Qe){const Q=le(),b=se(),o=pe(),M=ce(),X=g(null),h=g(b.query.date||o.selectedMonth),k=g([]),m=g(!1),c=g(null),A=g(!0),r=g({company_id:b.query.company_id||"",department_id:b.query.department_id||"all",type:b.query.type||"all",employee_id:b.query.employee_id||"",category:""}),C=async()=>{const s={company_id:r.value.company_id,department_id:r.value.department_id,selectedMonth:h.value,selectedStatus:o.selectedStatus};r.value.employee_id?(s.user_id=r.value.employee_id,m.value=!0,await o.fetchAdminManualAttendances(s),m.value=!1):o.manualAttendances.value=[]};oe(async()=>{await M.fetchUsers(),X.value=M.users.find(s=>s.id==r.value.employee_id)||null,await C()}),U(()=>[r.value.company_id,r.value.department_id,r.value.employee_id,h.value],async()=>{await C()}),U(h,s=>{Q.replace({query:{...b.query,date:s}})});const Y=ae(()=>o.attendances||[]);U(()=>o.attendances,s=>{k.value=[],s==null||s.forEach(e=>{k.value.push({date:e==null?void 0:e.date,type:"Forget Punch",check_in:e==null?void 0:e.entry_time,check_out:e==null?void 0:e.exit_time,description:"",is_check:!1})})},{immediate:!0,deep:!0});const Z=()=>{const s=k.value.every(e=>e.is_check);k.value.forEach(e=>{e.is_check=!s})},ee=async()=>{var s;if(m.value=!0,c.value=null,!r.value.employee_id){c.value="Please select an employee.",m.value=!1;return}try{const e=k.value.filter(a=>a.is_check&&(a.check_in||a.check_out));if(e.length===0){c.value="Please select at least one row.",m.value=!1;return}const V=e.map(a=>({user_id:r.value.employee_id,type:a.type,check_in:a.check_in?`${a.date} ${a.check_in}:00`:null,check_out:a.check_out?`${a.date} ${a.check_out}:00`:null,description:a.description||""})),x=await o.createBulkManualAttendance({records:V,direct_approve:A.value});(s=x==null?void 0:x.data)!=null&&s.length&&await C()}catch(e){c.value=e.message||"Failed to submit manual attendance requests."}finally{m.value=!1}};return(s,e)=>{var V,x,a,S,q,B,F,D,P,j,N,$,E,R,T,L,O,H,K,W,z;return i(),d("div",ye,[t("div",me,[t("button",{class:"btn-3",onClick:e[0]||(e[0]=(...l)=>s.goBack&&s.goBack(...l))},e[11]||(e[11]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[12]||(e[12]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Admin Bulk Manual Attendance Applications",-1)),e[13]||(e[13]=t("div",null,null,-1))]),t("div",ve,[G(ie,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=l=>r.value=l),"initial-value":u(b).query,onFilterChange:s.handleFilterChange},null,8,["modelValue","initial-value","onFilterChange"]),t("div",null,[v(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":e[2]||(e[2]=l=>h.value=l),onChange:C,class:"input-1"},null,544),[[f,h.value]])])]),u(o).loading?(i(),d("div",be,[G(ue)])):(i(),d("div",ge,[(V=r.value)!=null&&V.employee_id?(i(),d("div",_e,[t("div",ke,[t("div",xe,[t("div",he,[t("p",null,[e[14]||(e[14]=t("strong",null,"Name:",-1)),y(" "+p((a=(x=u(o))==null?void 0:x.user)==null?void 0:a.name),1)]),t("p",null,[e[15]||(e[15]=t("strong",null,"Data:",-1)),y(" "+p((B=(q=(S=u(o))==null?void 0:S.user)==null?void 0:q.designation)==null?void 0:B.title),1)]),t("p",null,[e[16]||(e[16]=t("strong",null,"Department:",-1)),y(" "+p((P=(D=(F=u(o))==null?void 0:F.user)==null?void 0:D.department)==null?void 0:P.name),1)]),t("p",null,[e[17]||(e[17]=t("strong",null,"Company:",-1)),y(" "+p(($=(N=(j=u(o))==null?void 0:j.user)==null?void 0:N.company)==null?void 0:$.name),1)]),t("p",null,[e[18]||(e[18]=t("strong",null,"Phone:",-1)),y(" "+p((R=(E=u(o))==null?void 0:E.user)==null?void 0:R.phone),1)]),t("p",null,[e[19]||(e[19]=t("strong",null,"Email:",-1)),y(" "+p((L=(T=u(o))==null?void 0:T.user)==null?void 0:L.email),1)]),t("p",null,[e[20]||(e[20]=t("strong",null,"Joining Date:",-1)),y(" "+p((H=(O=u(o))==null?void 0:O.user)==null?void 0:H.joining_date),1)]),t("p",null,[e[21]||(e[21]=t("strong",null,"Blood Group:",-1)),y(" "+p(((W=(K=u(o))==null?void 0:K.user)==null?void 0:W.blood)||"N/A"),1)])])])])])):w("",!0),t("div",fe,[t("div",{class:I(c.value?"py-2":"")},[c.value?(i(),d("div",we,p(c.value),1)):w("",!0)],2),t("table",Ce,[t("thead",null,[t("tr",Ve,[t("th",Ae,[t("div",Ue,[t("input",{id:"allCheck",type:"checkbox",onChange:Z,class:"h-5 w-5 accent-blue-600 cursor-pointer"},null,32),e[22]||(e[22]=t("label",{for:"allCheck",class:"text-sm cursor-pointer"},"All Check",-1))])]),e[23]||(e[23]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Date",-1)),e[24]||(e[24]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Type",-1)),e[25]||(e[25]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Check-In",-1)),e[26]||(e[26]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Check-Out",-1)),e[27]||(e[27]=t("th",{class:"border border-gray-300 px-2 text-left py-2"},"Description",-1))])]),t("tbody",null,[(i(!0),d(re,null,ne(k.value,(l,te)=>(i(),d("tr",{key:te,class:I(["border-b border-gray-200 hover:bg-blue-200 cursor-pointer",l.is_check?"bg-yellow-100":""]),onClick:n=>l.is_check=!l.is_check},[t("td",Se,[v(t("input",{type:"checkbox","onUpdate:modelValue":n=>l.is_check=n,class:"h-5 w-5",onClick:e[3]||(e[3]=_(()=>{},["stop"]))},null,8,qe),[[J,l.is_check]])]),t("td",Be,[v(t("input",{type:"date","onUpdate:modelValue":n=>l.date=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[4]||(e[4]=_(()=>{},["stop"])),disabled:""},null,8,Fe),[[f,l.date]])]),t("td",De,[v(t("select",{"onUpdate:modelValue":n=>l.type=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[5]||(e[5]=_(()=>{},["stop"]))},e[28]||(e[28]=[t("option",{value:""},"Select Type",-1),t("option",{value:"Home Office"},"Home Office",-1),t("option",{value:"Remote Work"},"Remote Work",-1),t("option",{value:"Forget Punch"},"Forget Punch",-1)]),8,Pe),[[de,l.type]])]),t("td",je,[v(t("input",{type:"time","onUpdate:modelValue":n=>l.check_in=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[6]||(e[6]=_(()=>{},["stop"]))},null,8,Ne),[[f,l.check_in]])]),t("td",$e,[v(t("input",{type:"time","onUpdate:modelValue":n=>l.check_out=n,class:"w-full border border-gray-600 py-1 px-2 rounded-sm",onClick:e[7]||(e[7]=_(()=>{},["stop"]))},null,8,Ee),[[f,l.check_out]])]),t("td",Re,[v(t("textarea",{"onUpdate:modelValue":n=>l.description=n,onKeyup:e[8]||(e[8]=_(()=>{},["stop"])),onClick:e[9]||(e[9]=_(()=>{},["stop"])),disabled:!l.check_in&&!l.check_out,class:"w-full border border-gray-600 py-1 px-2 rounded-sm disabled:bg-gray-300 disabled:cursor-not-allowed",cols:"1"},null,40,Te),[[f,l.description]])])],10,Me))),128)),Y.value.length===0?(i(),d("tr",Le,e[29]||(e[29]=[t("td",{colspan:"6",class:"p-2 text-center text-red-500"},"Please select any employee",-1)]))):w("",!0)])])]),(z=r.value)!=null&&z.employee_id?(i(),d("div",Oe,[t("div",He,[c.value?(i(),d("div",Ke,p(c.value),1)):w("",!0),t("div",We,[v(t("input",{id:"directApprove",type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=l=>A.value=l),class:"accent-blue-600 h-6 w-6 cursor-pointer"},null,512),[[J,A.value]]),e[30]||(e[30]=t("label",{for:"directApprove",class:"text-lg cursor-pointer"},"Direct Approve",-1))]),t("div",ze,[t("button",{type:"button",class:"btn-2",disabled:m.value,onClick:ee},[m.value?(i(),d("span",Ie,e[31]||(e[31]=[t("i",{class:"fas fa-spinner fa-spin mr-2"},null,-1),y("Submitting... ")]))):(i(),d("span",Je,"Submit All"))],8,Ge)])])])):w("",!0)]))])}}};export{rt as default};
