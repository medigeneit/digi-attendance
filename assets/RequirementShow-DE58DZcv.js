import{r as h,e as W,c as d,o as l,a as e,f as q,g as x,w,F as R,h as V,j as T,y as C,v as N,i as S,A as le,t as f,C as oe,n as ie,x as L,q as be,k as ne,b as ce,u as ve,z}from"./index-CVR3qdRf.js";import{L as G}from"./LoaderView-DIRbex2j.js";import{O as P}from"./OverlyModal-DKMcCwjt.js";import{R as ae}from"./RequiredIcon-Bb_yrCTi.js";import{f as H}from"./requirement-BIbx4uDJ.js";import{a as fe,f as de,d as xe,u as ye,_ as ge}from"./TaskAddForm-DMKIsU9x.js";import{u as ue}from"./department-D9ObpVuy.js";import{S as me}from"./SelectDropdown-DkWqFXQg.js";import{_ as B}from"./UserChip-QT_czVo6.js";import{u as pe}from"./user-BkG8Ec9V.js";import{_ as ke}from"./TaskUserChip-DlfsgSYe.js";import{u as we}from"./useTaskStore-BVf5F1pb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./company-CNyiFjEo.js";import"./url-CePbr-gY.js";import"./CompanyDepartmentSelectInput-CfWmNK55.js";import"./SectionLoading-DRHH68s9.js";import"./TextWithHr-CDY7ERGS.js";import"./TaskUrgencyInput-BtHIGIUe.js";const _e={class:"sticky top-0 pt-4 bg-white z-10"},he={class:"mb-4"},$e={class:"block text-gray-600 text-sm mb-1 font-medium"},qe={class:"mb-4"},Ce={class:"mb-4"},De={class:"mb-4"},Ie={class:"mb-4"},Se={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},Re={key:0,class:"mb-4 text-red-500 font-medium"},Te={key:1,class:"mb-4"},Ve={class:"flex items-center justify-between gap-4"},Ee=["disabled"],Ue={__name:"RequirementDetailAddForm",props:{requirementId:{type:[Number,String],required:!0}},emits:["create","closeClick","error"],setup(y,{emit:D}){const g=y,v=D,u=ue(),_=h(),r=h(""),o=h(),i=h({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),k=h([]);async function p(){var t,c;r.value="submitting";const b={...i.value};console.log({payload:b});try{const m=await fe(g.requirementId,b);v("create",m),r.value="create"}catch(m){r.value="error",o.value=((c=(t=m.response)==null?void 0:t.data)==null?void 0:c.message)||"Failed to create requirement detail",v("error",o.value)}}return W(async()=>{var t;const b=((t=(await H(g.requirementId)).data)==null?void 0:t.requirement)||{};k.value=await u.fetchDepartmentEmployee([b.from_department_id])}),(b,t)=>(l(),d("div",{class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative",ref_key:"formContainerRef",ref:_},[e("div",_e,[t[7]||(t[7]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add Requirement",-1)),t[8]||(t[8]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:t[0]||(t[0]=w(c=>v("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:w(p,["prevent"]),class:"z-0"},[r.value!=="loading"?(l(),d(R,{key:0},[e("div",he,[e("label",$e,[t[9]||(t[9]=T("Title ")),C(ae)]),V(e("input",{"onUpdate:modelValue":t[1]||(t[1]=c=>i.value.title=c),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[N,i.value.title]])]),e("div",qe,[t[10]||(t[10]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Details",-1)),V(e("textarea",{rows:"10","onUpdate:modelValue":t[2]||(t[2]=c=>i.value.description=c),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[N,i.value.description]])]),e("div",Ce,[t[12]||(t[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),C(me,{modelValue:i.value.supervisor_id,"onUpdate:modelValue":t[3]||(t[3]=c=>i.value.supervisor_id=c),options:k.value,placeholder:"--NO SUPERVISOR--",containment:_.value,clearable:"",class:"h-10"},{"list-header":S(()=>t[11]||(t[11]=[e("div",{class:"px-3 pt-2 pb-1 shadow-md text-xs uppercase bg-gray-50 text-gray-500"}," Employees ",-1)])),option:S(({option:c})=>[C(B,{user:c||{},class:"pr-5 -mx-1"},null,8,["user"])]),"selected-option":S(({option:c})=>[c?(l(),q(B,{key:0,user:c||{},class:"pr-4"},null,8,["user"])):x("",!0)]),_:1},8,["modelValue","options","containment"])]),e("div",De,[t[14]||(t[14]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),V(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[4]||(t[4]=c=>i.value.priority=c)},t[13]||(t[13]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[le,i.value.priority]])]),e("div",Ie,[t[15]||(t[15]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),V(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=c=>i.value.better_to_complete_on=c),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[N,i.value.better_to_complete_on]])])],64)):x("",!0),e("div",Se,[o.value?(l(),d("div",Re,f(o.value),1)):x("",!0),o.value?(l(),d("hr",Te)):x("",!0),e("div",Ve,[e("button",{type:"button",onClick:t[6]||(t[6]=w(c=>v("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:r.value=="loading"||r.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},f(r.value=="submitting"?"Saving...":"Add Requirement"),9,Ee)])])],32),r.value==="loading"||r.value==="submitting"?(l(),q(G,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):x("",!0)],512))}},Fe={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},Ne={class:"mb-4"},Le={class:"font-semibold"},Ae={class:"mb-4"},Me={class:"line-clamp-2"},je={key:1,class:"min-h-40"},Oe={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},ze={key:0,class:"mb-4 text-red-500 font-medium"},Pe={key:1,class:"mb-4"},Be={class:"flex items-center justify-between gap-4"},We=["disabled"],Ge={__name:"RequirementDetailDeleteForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["delete","closeClick","error"],setup(y,{emit:D}){const g=y,v=D,u=pe(),_=h(null),r=h(""),o=h(),i=h([]);async function k(){var p,b;r.value="submitting";try{const t=await xe(g.requirementId,g.detailId);v("delete",t),r.value="create"}catch(t){r.value="error",o.value=((b=(p=t.response)==null?void 0:p.data)==null?void 0:b.message)||"Failed to update requirement detail: "+t,v("error",o.value)}}return W(async()=>{var p,b,t;r.value="loading";try{i.value=await u.fetchDepartmentWiseEmployees(),_.value=(p=(await de(g.requirementId,g.detailId)).data)==null?void 0:p.detail}catch(c){o.value=((t=(b=c.response)==null?void 0:b.data)==null?void 0:t.message)||"Failed to fetch requirement detail"}finally{r.value=""}}),(p,b)=>{var t,c;return l(),d("div",Fe,[b[4]||(b[4]=e("div",{class:"sticky top-0 -mx-6 px-6 z-10 bg-gray-50"},[e("h2",{class:"text-xl font-semibold text-gray-800 py-2"},"Delete Requirement Details"),e("hr",{class:"mb-4 -mx-6"})],-1)),e("form",{onSubmit:w(k,["prevent"]),class:"z-0"},[r.value!=="loading"?(l(),d(R,{key:0},[e("div",Ne,[b[1]||(b[1]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Title",-1)),e("div",Le,f((t=_.value)==null?void 0:t.title),1)]),e("div",Ae,[b[2]||(b[2]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),e("div",Me,f((c=_.value)==null?void 0:c.description),1)]),b[3]||(b[3]=e("div",{class:"my-8 text-center text-xl text-red-600"},"Are you sure want to delete?",-1))],64)):(l(),d("div",je)),e("div",Oe,[o.value?(l(),d("div",ze,f(o.value),1)):x("",!0),o.value?(l(),d("hr",Pe)):x("",!0),e("div",Be,[e("button",{type:"button",onClick:b[0]||(b[0]=w(m=>v("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:r.value=="loading"||r.value=="submitting",type:"submit",class:"bg-red-700 hover:bg-red-500 text-white font-semibold px-5 py-2 rounded transition"},f(r.value=="submitting"?"Deleting...":"Delete"),9,We)])])],32),r.value==="loading"||r.value==="submitting"?(l(),q(G,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):x("",!0)])}}},He={class:"sticky top-0 pt-4 bg-white z-10"},Je={class:"mb-4"},Ke={class:"block text-gray-600 text-sm mb-1 font-medium"},Qe={class:"mb-4"},Xe={class:"mb-4"},Ye={key:0,class:"relative w-full"},Ze={key:0,class:"absolute right-1 text-xl top-0 bottom-0 flex items-center"},et={class:"mb-4"},tt={class:"mb-4"},st={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},rt={key:0,class:"mb-4 text-red-500 font-medium"},lt={key:1,class:"mb-4"},ot={class:"flex items-center justify-between gap-4"},it=["disabled"],nt={__name:"RequirementDetailEditForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(y,{emit:D}){const g=y,v=D,u=h(),_=pe(),r=ue(),o=h(null),i=h(""),k=h(),p=h({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),b=h([]),t=h([]);async function c(){var n,I;i.value="submitting";const m={...p.value};try{const a=await ye(g.requirementId,g.detailId,m);v("update",a),i.value="create"}catch(a){i.value="error",k.value=((I=(n=a.response)==null?void 0:n.data)==null?void 0:I.message)||"Failed to update requirement detail",v("error",k.value)}}return W(async()=>{var m,n,I,a,s,E,A,M;i.value="loading";try{b.value=await _.fetchDepartmentWiseEmployees();const U=((m=(await H(g.requirementId)).data)==null?void 0:m.requirement)||{};t.value=await r.fetchDepartmentEmployee([U.from_department_id]),o.value=(n=(await de(g.requirementId,g.detailId)).data)==null?void 0:n.detail,p.value={title:(I=o.value)==null?void 0:I.title,description:(a=o.value)==null?void 0:a.description,priority:(s=o.value)==null?void 0:s.priority,supervisor_id:(E=o.value)==null?void 0:E.supervisor_id};const j=new Date(o.value.better_to_complete_on);p.value.better_to_complete_on=j.toISOString().split("T")[0]}catch(U){k.value=((M=(A=U.response)==null?void 0:A.data)==null?void 0:M.message)||"Failed to fetch requirement detail"}finally{i.value=""}}),(m,n)=>{var I;return l(),d("div",{ref_key:"formContainerRef",ref:u,class:"max-h-[90vh] w-full mx-auto overflow-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},[e("div",He,[n[8]||(n[8]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Edit Requirement",-1)),n[9]||(n[9]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:n[0]||(n[0]=w(a=>v("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:w(c,["prevent"]),class:"z-0"},[i.value!=="loading"?(l(),d(R,{key:0},[e("div",Je,[e("label",Ke,[n[10]||(n[10]=T("Title ")),C(ae)]),V(e("input",{"onUpdate:modelValue":n[1]||(n[1]=a=>p.value.title=a),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[N,p.value.title]])]),e("div",Qe,[n[11]||(n[11]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),V(e("textarea",{rows:"10","onUpdate:modelValue":n[2]||(n[2]=a=>p.value.description=a),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[N,p.value.description]])]),e("div",Xe,[n[12]||(n[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),C(me,{modelValue:p.value.supervisor_id,"onUpdate:modelValue":n[4]||(n[4]=a=>p.value.supervisor_id=a),options:[...t.value,...t.value.find(a=>{var s,E;return a.id==((E=(s=o.value)==null?void 0:s.supervisor)==null?void 0:E.id)})?[]:[(I=o.value)==null?void 0:I.supervisor]],containment:u.value,placeholder:"--NO SUPERVISOR--",class:"h-10"},{option:S(({option:a})=>[C(B,{user:a||{}},null,8,["user"])]),"selected-option":S(({option:a})=>[a?(l(),d("div",Ye,[C(B,{user:a||{}},null,8,["user"]),p.value.supervisor_id?(l(),d("div",Ze,[e("button",{onClick:n[3]||(n[3]=w(s=>p.value.supervisor_id=null,["prevent"])),class:"text-gray-6 font-semibold 00 hover:text-red-700"}," × ")])):x("",!0)])):x("",!0)]),_:1},8,["modelValue","options","containment"])]),e("div",et,[n[14]||(n[14]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),V(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":n[5]||(n[5]=a=>p.value.priority=a)},n[13]||(n[13]=[e("option",{value:null},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[le,p.value.priority]])]),e("div",tt,[n[15]||(n[15]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),V(e("input",{type:"date","onUpdate:modelValue":n[6]||(n[6]=a=>p.value.better_to_complete_on=a),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[N,p.value.better_to_complete_on]])])],64)):x("",!0),e("div",st,[k.value?(l(),d("div",rt,f(k.value),1)):x("",!0),k.value?(l(),d("hr",lt)):x("",!0),e("div",ot,[e("button",{type:"button",onClick:n[7]||(n[7]=w(a=>v("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:i.value=="loading"||i.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},f(i.value=="submitting"?"Saving...":"Edit Detail"),9,it)])])],32),i.value==="loading"||i.value==="submitting"?(l(),q(G,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):x("",!0)],512)}}},at={class:"group/item border text-gray-800 py-4 shadow-sm mb-4 px-4 rounded-md hover:bg-blue-50"},dt={class:"border-2 border-gray-700 p-3 align-top"},ut={class:"text-2xl font-medium"},mt={class:"border-2 border-gray-700 p-3"},pt={class:"text-lg font-semibold mb-2"},bt={class:"mb-5"},ct={class:"text-justify"},vt=["innerHTML"],ft={class:"flex items-end"},xt={class:"flex items-center gap-1 mb-3"},yt={class:"text-blue-400 font-semibold"},gt={class:"ml-auto flex gap-6 items-center"},kt={class:"border-2 border-gray-700 p-3 whitespace-nowrap print:whitespace-break-spaces print:px-0 text-center"},wt={class:"border-2 border-gray-700 p-3 text-center"},_t={class:"border-2 border-gray-700 p-3"},ht={key:0},$t={key:1,class:"text-gray-500"},qt={key:1,colspan:"2",class:"border-2 border-gray-700 p-3 text-center"},Ct={__name:"RequirementDetailTableRow",props:{detail:{type:Object},serial:{type:Number}},emits:["editClick","deleteClick","taskCreateClick"],setup(y,{emit:D}){const g=D,v=h("line-clamp-2");function u(){v.value=v.value?"":"line-clamp-2"}return(_,r)=>{var i,k,p,b;const o=oe("RouterLink");return l(),d("tr",at,[e("td",dt,[e("span",ut,f(y.serial),1)]),e("td",mt,[e("div",null,[e("div",pt,[e("span",null,f(y.detail.title),1)]),r[4]||(r[4]=e("hr",{class:"mb-4 -mx-4"},null,-1)),e("div",bt,[r[3]||(r[3]=e("div",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Description",-1)),e("div",ct,[e("p",{class:ie(["print:line-clamp-none",v.value]),innerHTML:y.detail.description},null,10,vt),e("button",{class:"text-blue-500 group-hover/item:underline hover:text-sky-400 ml-auto text-sm print:hidden",onClick:w(u,["prevent"])},f(v.value?"Show More":"Show Less"),1)])])]),e("div",ft,[e("div",null,[e("div",xt,[r[5]||(r[5]=e("span",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Supervisor:",-1)),y.detail.supervisor?(l(),q(ke,{key:0,user:y.detail.supervisor},null,8,["user"])):x("",!0)]),e("div",null,[r[6]||(r[6]=e("span",{class:"text-gray-500 mr-2 text-xs uppercase font-semibold"},"Priority:",-1)),e("span",yt,f(y.detail.priority),1)])]),e("div",gt,[e("button",{class:"btn-2",onClick:r[0]||(r[0]=w(t=>g("editClick",y.detail),["prevent"]))},r[7]||(r[7]=[e("i",{class:"fas fa-edit"},null,-1),T("Edit ")])),e("button",{class:"btn-2-red",onClick:r[1]||(r[1]=w(t=>g("deleteClick",y.detail),["prevent"]))},r[8]||(r[8]=[e("i",{class:"fas fa-trash-alt"},null,-1),T("Delete ")]))])])]),e("td",kt,[e("div",null,f(new Date(y.detail.better_to_complete_on).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",weekday:"short"})),1)]),((k=(i=y.detail)==null?void 0:i.tasks)==null?void 0:k.length)>0?(l(),d(R,{key:0},[e("td",wt,[(l(!0),d(R,null,L(((p=y.detail)==null?void 0:p.tasks)||[],t=>(l(),q(o,{key:t.id,to:{name:"TaskShow",params:{id:t.id}},class:"hover:underline text-gray-900 hover:text-blue-600 whitespace-nowrap block",target:"_blank"},{default:S(()=>[T(f(t.id),1)]),_:2},1032,["to"]))),128))]),e("td",_t,[(l(!0),d(R,null,L(((b=y.detail)==null?void 0:b.tasks)||[],t=>(l(),d("div",{key:t.id,class:"whitespace-nowrap text-center print:whitespace-break-spaces"},[t.deadline?(l(),d("div",ht,f(new Date(t.deadline).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",weekday:"short"})),1)):(l(),d("div",$t,"-"))]))),128))])],64)):(l(),d("td",qt,[e("button",{onClick:r[2]||(r[2]=w(t=>g("taskCreateClick",y.detail),["prevent"])),class:"print:hidden hover:border-2 group-hover/item:bg-blue-200 hover:border-blue-700 text-blue-500 hover:text-white hover:!bg-blue-500 rounded-md px-4 py-1"}," Create Task ")]))])}}},Dt={class:"text-left p-4"},It={class:"flex items-center gap-6 justify-center my-10"},St={key:0,class:"border rounded-md"},Rt={class:"flex flex-col justify-center items-start rounded-md h-[70vh] overflow-y-scroll"},Tt=["onClick"],Vt={class:"mt-[1px]"},Et=["onClick"],Ut={__name:"TaskParentIdSelector",props:{fromDepartmentId:{type:Number}},emits:["parentIdSelect"],setup(y,{emit:D}){const g=y,v=D,u=we(),_=h(!1);return be(()=>_.value,r=>{r&&u.fetchTasks({"to-department-id":g.fromDepartmentId})},{immediate:!0}),(r,o)=>(l(),d("div",Dt,[e("div",It,[e("button",{onClick:o[0]||(o[0]=w(i=>v("parentIdSelect",0),["prevent"])),class:"btn-3"},"Add as Main Task"),o[2]||(o[2]=e("span",null,"or",-1)),e("button",{class:ie({"btn-3":!_.value,"btn-2":_.value}),onClick:o[1]||(o[1]=w(i=>_.value=!0,["prevent"]))}," Add as Sub Task ",2)]),_.value?(l(),d("div",St,[o[4]||(o[4]=e("div",{class:"py-2 px-4 font-bold text-center border-b shadow"}," Click to select task or sub task ",-1)),e("div",Rt,[(l(!0),d(R,null,L(ne(u).tasks,i=>(l(),d("div",{key:i.id,class:"w-full mb-2"},[e("button",{type:"button",class:"text-left text-base w-full bg-blue-50 px-2 hover:bg-blue-500 hover:text-white py-4 text-blue-500 font-semibold",onClick:w(k=>v("parentIdSelect",i.id),["prevent"])},f(i.title),9,Tt),e("div",Vt,[(l(!0),d(R,null,L(i.children_tasks||[],k=>(l(),d("div",{key:k.id,class:"border-b"},[e("button",{type:"button",class:"text-left text-sm w-full hover:bg-blue-500 hover:text-white py-2",onClick:w(p=>v("parentIdSelect",k.id),["prevent"])},[o[3]||(o[3]=e("span",{class:"text-gray-400"},"—",-1)),T(f(k.title),1)],8,Et)]))),128))])]))),128))])])):x("",!0)]))}},Ft={class:"container mx-auto p-6 print:p-0 w-full print:max-w-full"},Nt={class:"bg-white rounded shadow print:shadow-none p-4 print:p-0 relative"},Lt={class:"flex items-start"},At={class:"mb-4 text-lg print:black print:font-bold"},Mt={class:"ml-auto print:hidden flex gap-2 items-center"},jt={class:"mb-4 flex items-center gap-1 print:mb-1"},Ot={class:"font-bold print:text-gray-900"},zt={class:"mb-4 print:flex print:items-center print:gap-3 print:mb-1"},Pt={class:"print:text-gray-900"},Bt={class:"mb-4 print:flex print:items-center print:gap-3 print:mb-1"},Wt={class:"flex items-center gap-2 print:text-gray-900 flex-wrap"},Gt={class:"mb-4 print:flex print:items-center print:gap-3 print:mb-1"},Ht={class:"print:text-gray-900"},Jt={key:0,class:"overflow-x-auto print:overflow-visible"},Kt={class:"w-full table-auto print:table-fixed"},Qt={colspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap px-3 py-1 print:whitespace-normal w-[25%]"},Xt={class:"whitespace-nowrap print:whitespace-break-spaces print:px-0 p-3 text-center border-2 border-gray-800"},Yt={class:"text-gray-900 text-base"},Zt={class:"mt-8 border rounded-md p-8 flex items-center justify-center bg-gray-50"},gs={__name:"RequirementShow",setup(y){const D=ce(),g=ve(),v=h(""),u=h(null),_=z({open:!1}),r=z({detail:null,open:!1}),o=z({detail:null,open:!1});W(async()=>{await i()});async function i(){var a;v.value="loading",u.value=(a=(await H(D.params.id)).data)==null?void 0:a.requirement,v.value=""}function k(a){console.log({detail:a}),m.modalShown=!0,m.from_department_id=u.value.from_department_id,m.to_department_id=u.value.to_department_id,m.taskDefaultValues={title:a.title,description:a.description,from_department_id:u.value.from_department_id,to_department_id:u.value.to_department_id},m.requirementDetail=a}function p(){_.open=!0}function b(a){r.open=!0,r.detail=a}function t(a){o.open=!0,o.detail=a}function c(){window.print()}const m=z({parentId:null,modalShown:!1,requirementId:0,taskDefaultValues:{},requirementDetail:null});async function n(){m.parentId=0,m.parentId=null,m.modalShown=!1,m.requirementDetail=null,v.value="loading",await i()}async function I(){m.parentId=null,m.modalShown=!1,m.requirementDetail=null}return(a,s)=>{var A,M,U,j,J,K,Q,X,Y,Z,ee,te,se;const E=oe("RouterLink");return l(),d("div",Ft,[_.open?(l(),q(P,{key:0,class:"*:max-w-4xl"},{default:S(()=>[C(Ue,{requirementId:u.value.id,onCloseClick:s[0]||(s[0]=$=>_.open=!1),onCreate:s[1]||(s[1]=async()=>{_.open=!1,await i()})},null,8,["requirementId"])]),_:1})):x("",!0),r.open?(l(),q(P,{key:1},{default:S(()=>{var $;return[C(nt,{requirementId:u.value.id,detailId:($=r.detail)==null?void 0:$.id,onCloseClick:s[2]||(s[2]=F=>r.open=!1),onUpdate:s[3]||(s[3]=async()=>{r.open=!1,await i()})},null,8,["requirementId","detailId"])]}),_:1})):x("",!0),o.open?(l(),q(P,{key:2},{default:S(()=>{var $;return[C(Ge,{requirementId:u.value.id,detailId:($=o.detail)==null?void 0:$.id,onCloseClick:s[4]||(s[4]=F=>o.open=!1),onDelete:s[5]||(s[5]=async()=>{o.open=!1,await i()})},null,8,["requirementId","detailId"])]}),_:1})):x("",!0),m.modalShown?(l(),q(P,{key:3,class:"*:relative"},{default:S(()=>{var $,F;return[e("button",{onClick:w(I,["prevent"]),class:"absolute right-3 top-2 text-xl text-red-500 hover:text-red-400"},s[8]||(s[8]=[e("i",{class:"fas fa-times-circle"},null,-1)])),m.parentId===null?(l(),q(Ut,{key:0,"from-department-id":($=u.value)==null?void 0:$.from_department_id,onParentIdSelect:s[6]||(s[6]=O=>m.parentId=O)},null,8,["from-department-id"])):(l(),q(ge,{key:1,parentTaskId:m.parentId,requirementDetailId:(F=m==null?void 0:m.requirementDetail)==null?void 0:F.id,requirementId:u.value.id,onClose:I,onTaskCreated:n,defaultValues:m.taskDefaultValues,readonlyFields:{from_department_id:!0,to_department_id:!0}},null,8,["parentTaskId","requirementDetailId","requirementId","defaultValues"]))]}),_:1})):x("",!0),e("div",Nt,[e("div",Lt,[e("div",At,[s[9]||(s[9]=e("div",{class:"text-gray-800 leading-none"},"To",-1)),e("div",null,f((M=(A=u.value)==null?void 0:A.to_department)==null?void 0:M.name),1)]),e("div",Mt,[(((U=u.value)==null?void 0:U.details)||[]).length>0?(l(),d("button",{key:0,class:"btn-3 font-semibold !pl-2 !pr-4",onClick:w(c,["prevent"])},s[10]||(s[10]=[e("i",{class:"fad fa-print text-xl"},null,-1),T("Print ")]))):x("",!0),e("button",{class:"btn-3",onClick:s[7]||(s[7]=w(()=>ne(g).back(),["prevent"]))},"Back"),C(E,{class:"btn-2",to:`/requirements/edit/${(j=u.value)==null?void 0:j.id}`},{default:S(()=>s[11]||(s[11]=[T("Edit")])),_:1,__:[11]},8,["to"])])]),s[24]||(s[24]=e("div",{class:"text-center text-xl font-bold mb-2 underline"},"Requirement Form",-1)),e("div",jt,[s[12]||(s[12]=e("div",{class:"text-gray-800 text-sm"},"Requirement ID:",-1)),e("div",Ot,f((J=u.value)==null?void 0:J.id),1)]),e("div",zt,[s[13]||(s[13]=e("div",{class:"text-gray-800 text-sm"},"From",-1)),e("div",Pt,f((Q=(K=u.value)==null?void 0:K.from_department)==null?void 0:Q.name),1)]),e("div",Bt,[s[14]||(s[14]=e("div",{class:"text-gray-500 text-sm"},"Website",-1)),e("div",Wt,[(l(!0),d(R,null,L(((X=u.value)==null?void 0:X.website_tags)||[],$=>(l(),d("div",{key:$.id,class:"border px-2 rounded-md bg-gray-50 shadow-sm whitespace-nowrap"},f($.name),1))),128))])]),e("div",Gt,[s[15]||(s[15]=e("div",{class:"text-gray-500 text-sm"},"Submission Date",-1)),e("div",Ht,f(new Date((Y=u.value)==null?void 0:Y.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),1)]),s[25]||(s[25]=e("hr",{class:"mb-4"},null,-1)),e("div",null,[s[23]||(s[23]=e("div",{class:"flex items-end mb-3"},[e("h2",{class:"text-xl font-semibold"},"Requirements"),e("div",{class:"ml-auto print:hidden flex gap-2 text-sm"})],-1)),(((Z=u.value)==null?void 0:Z.details)||[]).length>0?(l(),d("div",Jt,[e("table",Kt,[e("thead",null,[e("tr",null,[s[16]||(s[16]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-left px-4 text-gray-800 print:text-black text-xl font-semibold whitespace-nowrap w-[15%]"}," SL ",-1)),s[17]||(s[17]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap w-[65%]"}," Requirement Details ",-1)),s[18]||(s[18]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base px-3 font-semibold whitespace-nowrap print:whitespace-normal print:p-0 w-[15%]"}," Better To Complete ",-1)),e("th",Qt," For '"+f(((ee=u.value.to_department)==null?void 0:ee.short_name)||((te=u.value.to_department)==null?void 0:te.name))+"' Use ",1)]),s[19]||(s[19]=e("tr",null,[e("td",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-sm font-semibold whitespace-nowrap p-3 print:whitespace-normal"}," Issue No "),e("td",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-sm font-semibold whitespace-nowrap p-3 print:whitespace-normal print:p-0"}," Expected Date ")],-1))]),e("tbody",null,[(l(!0),d(R,null,L(((se=u.value)==null?void 0:se.details)||[],($,F)=>{var O,re;return l(),d(R,{key:$.id},[C(Ct,{detail:$,serial:F+1,onEditClick:b,onDeleteClick:t,onTaskCreateClick:k},null,8,["detail","serial"]),e("tr",null,[e("td",Xt,[e("div",Yt," For '"+f(((O=u.value.to_department)==null?void 0:O.short_name)||((re=u.value.to_department)==null?void 0:re.name))+"' Use ",1),s[20]||(s[20]=e("div",{class:"text-gray-800 text-xs"},"(Feedback)",-1))]),s[21]||(s[21]=e("td",{class:"whitespace-nowrap p-3 text-center border-2 border-gray-800",colspan:"4"},null,-1))])],64)}),128))])])])):x("",!0),e("div",Zt,[e("button",{class:"btn-2 pl-2 text-base",onClick:w(p,["prevent"])},s[22]||(s[22]=[e("i",{class:"fad fa-plus-circle text-2xl mr-2"},null,-1),T("Add Requirement ")]))])]),v.value==="loading"?(l(),q(G,{key:0,class:"absolute inset-0 bg-opacity-90"})):x("",!0)])])}}};export{gs as default};
