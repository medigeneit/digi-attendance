import{u as R,b as B,s as M,r as g,y as S,e as N,A as _,k as T,c as a,o as d,a as e,l as h,h as y,g as p,v as j,C as E,f as q,F,x as H,t as c,m as P,p as C}from"./index-B5miUE8g.js";import{L as $}from"./LoaderView-D_3-BmOM.js";import{_ as I}from"./MultiselectDropdown-BETLsm8L.js";import{u as W}from"./leave-application-D3h9rT36.js";import{u as z}from"./user-BtgV1TWh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue-multiselect.esm-0wAWB18E.js";const G={class:"space-y-2 px-4"},J={class:"flex gap-2"},K={style:{width:"300px"}},O={key:0,class:"text-center py-4"},Q={key:1,class:"space-y-4"},X={class:"overflow-x-auto"},Y={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Z={class:"border border-gray-300 px-2"},ee={class:"border border-gray-300 px-2"},te={class:"border border-gray-300 px-2"},se={class:"border border-gray-300 px-2"},re={class:"border border-gray-300 px-2"},oe=["innerHTML"],le={class:"border border-gray-300 px-2"},de={class:"border border-gray-300 px-2"},ae={class:"flex justify-center gap-2"},ne=["onClick"],ue={key:0},he={__name:"LeaveApplicationList",setup(ce){var k;const f=R(),o=B(),l=W(),m=z(),{leaveApplications:ve,loading:U}=M(l),v=g(""),i=S(()=>{var r;return(r=v.value)==null?void 0:r.id}),n=g(((k=o==null?void 0:o.query)==null?void 0:k.date)||l.selectedMonth),x=g("");N(async()=>{var r;U.value=!0,await m.fetchUsers(),v.value=m.users.find(s=>{var u;return s.id==((u=o==null?void 0:o.query)==null?void 0:u.user_id)}),x.value=((r=o==null?void 0:o.query)==null?void 0:r.search)||"",await b()});const V=()=>{f.go(-1)},b=async()=>{i.value?await l.fetchLeaveApplications({user_id:i.value,selectedDate:n.value,selectedStatus:l.selectedStatus,query:x.value}):await l.fetchLeaveApplications({selectedStatus:l.selectedStatus,selectedDate:n.value,query:x.value})},A=S(()=>l.leaveApplications);_([i],b),_(i,r=>{f.replace({query:{...o.query,user_id:r}})}),_(n,r=>{f.replace({query:{...o.query,date:r}})});const D=async r=>{confirm("Are you sure to delete this application?")&&l.deleteLeaveApplication(r)};return(r,s)=>{const u=T("RouterLink");return d(),a("div",G,[e("div",{class:"flex items-center justify-between gap-2"},[e("button",{class:"btn-3",onClick:V},s[3]||(s[3]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),s[4]||(s[4]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Leave Applications",-1)),s[5]||(s[5]=e("div",null,null,-1))]),e("div",J,[e("div",K,[h(I,{modelValue:v.value,"onUpdate:modelValue":s[0]||(s[0]=t=>v.value=t),options:y(m).users,multiple:!1,label:"label",placeholder:"Select user"},null,8,["modelValue","options"])]),e("div",null,[p(e("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[1]||(s[1]=t=>n.value=t),onChange:b,class:"input-1"},null,544),[[j,n.value]])]),e("div",null,[p(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>y(l).selectedStatus=t),onChange:b,class:"input-1"},s[6]||(s[6]=[e("option",{value:"",selected:""},"All",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Approved"},"Approved",-1),e("option",{value:"Rejected"},"Rejected",-1)]),544),[[E,y(l).selectedStatus]])])]),y(l).loading?(d(),a("div",O,[h($)])):(d(),a("div",Q,[e("div",X,[e("table",Y,[s[11]||(s[11]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-300 px-2 text-left"},"#"),e("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),e("th",{class:"border border-gray-300 px-2 text-left"},"Last Working Day"),e("th",{class:"border border-gray-300 px-2 text-left"},"Resumption Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Total Days"),e("th",{class:"border border-gray-300 px-2 text-left"},"Status"),e("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),e("tbody",null,[(d(!0),a(F,null,H(A.value,(t,w)=>{var L;return d(),a("tr",{key:w,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",Z,c(w+1),1),e("td",ee,c(((L=t==null?void 0:t.user)==null?void 0:L.name)||"Unknown"),1),e("td",te,c(t==null?void 0:t.last_working_date),1),e("td",se,c(t==null?void 0:t.resumption_date),1),e("td",re,[e("div",{innerHTML:t.duration||(t==null?void 0:t.total_leave_days)},null,8,oe)]),e("td",le,c((t==null?void 0:t.status)||"N/A"),1),e("td",de,[e("div",ae,[h(u,{to:{name:"LeaveApplicationShow",params:{id:t==null?void 0:t.id}},class:"btn-icon"},{default:C(()=>s[7]||(s[7]=[e("i",{class:"far fa-eye"},null,-1)])),_:2},1032,["to"]),(t==null?void 0:t.status)!=="Approved"?(d(),P(u,{key:0,to:{name:"LeaveApplicationEdit",params:{id:t==null?void 0:t.id}},class:"btn-icon"},{default:C(()=>s[8]||(s[8]=[e("i",{class:"far fa-edit text-orange-600"},null,-1)])),_:2},1032,["to"])):q("",!0),e("button",{onClick:ie=>D(t==null?void 0:t.id),class:"btn-icon text-red-500"},s[9]||(s[9]=[e("i",{class:"far fa-trash"},null,-1)]),8,ne)])])])}),128)),A.value.length===0?(d(),a("tr",ue,s[10]||(s[10]=[e("td",{colspan:"7",class:"p-1 text-center text-red-500"},"No application found",-1)]))):q("",!0)])])])]))])}}};export{he as default};
