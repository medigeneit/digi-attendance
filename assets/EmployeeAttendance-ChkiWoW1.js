import{m as Y,c as l,o as n,a as t,j as r,x as b,t as a,u as Z,b as ee,r as S,e as te,z as K,n as se,f as x,p as w,k as p,h as ae,v as re,i as y,F as ne,q as le,g as c}from"./index-Bocfmwle.js";import{_ as ie}from"./EmployeeFilter-CKs9sdeI.js";import{L as oe}from"./LoaderView-DVDvxUcP.js";import{u as de}from"./attendance-Casxkew8.js";import{u as ue}from"./user-d3qAp21U.js";import"./MultiselectDropdown-CMEdQAos.js";import"./company-CDBcFmmH.js";import"./department-BZ2h6lKo.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const pe={class:"flex items-center gap-2"},ce="flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium border transition-all",_e={__name:"StatusBadge",props:{status:{type:String,required:!0},isApproved:{type:Boolean,default:!1}},setup(A){var h;const v=A,d=((h=v.status)==null?void 0:h.toLowerCase())??"",i=Y(()=>{switch(d){case"present":return{iconClass:"fas fa-check-circle",label:"Present",classes:"bg-emerald-50 text-emerald-700 border-emerald-200"};case"absent":return{iconClass:"fas fa-times-circle",label:"Absent",classes:"bg-red-50 text-red-700 border-red-200"};case"weekend":return{iconClass:"fas fa-calendar-alt",label:"Weekend",classes:"bg-purple-50 text-purple-700 border-purple-200"};case"eid":return{iconClass:"fas fa-coffee",label:"EID",classes:"bg-amber-50 text-amber-700 border-amber-200"};case"sl":return{iconClass:"fas fa-exclamation-circle",label:"Special Leave",classes:"bg-blue-50 text-blue-700 border-blue-200"};case"cl":return{iconClass:"fas fa-plane-departure",label:"Casual Leave",classes:"bg-cyan-50 text-cyan-700 border-cyan-200"};case"ml":return{iconClass:"fas fa-baby",label:"Medical Leave",classes:"bg-pink-50 text-pink-700 border-pink-200"};case"wpl":return{iconClass:"fas fa-user-slash",label:"Without Pay Leave",classes:"bg-yellow-50 text-yellow-700 border-yellow-200"};default:return d.startsWith("holiday")?{iconClass:"fas fa-umbrella-beach",label:v.status,classes:"bg-lime-50 text-lime-700 border-lime-200"}:{iconClass:"fas fa-question-circle",label:v.status,classes:"bg-gray-50 text-gray-700 border-gray-200"}}});return(o,f)=>(n(),l("div",pe,[t("div",{class:b([ce,i.value.classes])},[t("i",{class:b([i.value.iconClass,"h-3 w-3"])},null,2),r(" "+a(A.status),1)],2)]))}},me={class:"px-4 space-y-4"},ye={class:"w-full flex flex-wrap gap-4 items-center md:w-auto"},be={key:0,class:"grid md:grid-cols-2 gap-4 text-sm"},ve={class:"card-bg p-4 gap-1"},xe={class:"grid md:grid-cols-2"},fe={class:"card-bg p-4 gap-1"},he={class:"flex justify-between items-center"},we={class:"grid md:grid-cols-2"},ke={key:1},Ae={key:3,class:"space-y-4"},Se={class:"overflow-x-auto card-bg"},ge={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},Ce={class:"text-center text-xs"},Le={class:"border px-1 py-0.5"},De={class:"border px-1 py-0.5"},qe=["title"],Me={class:"flex flex-col gap-1"},Ee={class:"font-semibold text-gray-800"},Ne={key:0,class:"text-xs"},je=["title"],Pe={key:0,class:"font-semibold"},Be=["title"],Te={class:"border px-1 py-0.5"},Re={class:"border px-1 py-0.5"},Ve={key:2,class:"bg-red-100 text-red-700 px-2 py-1 rounded text-xs font-semibold"},We={key:3},$e={class:"border px-1 py-0.5"},He={class:"border px-1 py-0.5"},Ue={key:0},Oe={class:"border px-1 py-0.5"},Fe={key:0},Ie={class:"border py-0.5"},ze={class:"flex justify-center items-center gap-1"},Je={key:0,class:"flex items-center gap-2"},at={__name:"EmployeeAttendance",setup(A){const v=Z(),d=ee(),i=de(),h=ue(),o=S(null),f=S(d.query.date||i.selectedMonth),u=S({company_id:d.query.company_id||"",department_id:d.query.department_id||"all",type:d.query.type||"all",employee_id:d.query.employee_id||"",category:""}),g=async _=>{_?(await h.fetchUser(_),o.value=h.user):o.value=null},k=async()=>{u.value.employee_id&&f.value&&await i.getMonthlyAttendanceByShift(u.value.employee_id,f.value)};te(async()=>{u.value.employee_id&&(await g(u.value.employee_id),await k())}),K(f,_=>{v.replace({query:{...d.query,date:_}}),k()}),K(()=>u.value.employee_id,async(_,s)=>{_&&_!==s&&(await g(_),await k())});const Q=()=>v.go(-1),X=()=>{v.replace({query:{...d.query,company_id:u.value.company_id,department_id:u.value.department_id,type:u.value.type,employee_id:u.value.employee_id}})};return(_,s)=>{var C,L,D,q,M,E,N,j,P,B,T,R,V,W,$,H;const m=se("router-link");return n(),l("div",me,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:Q},s[2]||(s[2]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),s[3]||(s[3]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Attendance",-1)),s[4]||(s[4]=t("div",null,null,-1))]),t("div",ye,[w(ie,{modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),"initial-value":p(d).query,onFilterChange:X},null,8,["modelValue","initial-value"]),t("div",null,[ae(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[1]||(s[1]=e=>f.value=e),onChange:k,class:"input-1"},null,544),[[re,f.value]])])]),o.value?(n(),l("div",be,[t("div",ve,[s[14]||(s[14]=t("h2",{class:"title-md"},"Selected Employee Info",-1)),s[15]||(s[15]=t("hr",null,null,-1)),t("div",xe,[t("p",null,[s[5]||(s[5]=t("strong",null,"Name:",-1)),r(" "+a(o.value.name),1)]),t("p",null,[s[6]||(s[6]=t("strong",null,"Designation:",-1)),r(" "+a(((C=o.value.designation)==null?void 0:C.title)||"N/A"),1)]),t("p",null,[s[7]||(s[7]=t("strong",null,"Department:",-1)),r(" "+a(((L=o.value.department)==null?void 0:L.name)||"N/A"),1)]),t("p",null,[s[8]||(s[8]=t("strong",null,"Company:",-1)),r(" "+a(((D=o.value.company)==null?void 0:D.name)||"N/A"),1)]),t("p",null,[s[9]||(s[9]=t("strong",null,"Phone:",-1)),r(" "+a(o.value.phone),1)]),t("p",null,[s[10]||(s[10]=t("strong",null,"Email:",-1)),r(" "+a(o.value.email||"N/A"),1)]),t("p",null,[s[11]||(s[11]=t("strong",null,"Employee ID :",-1)),r(" "+a(o.value.employee_id||"N/A"),1)]),t("p",null,[s[12]||(s[12]=t("strong",null,"Joining Date :",-1)),r(" "+a(o.value.joining_date||"N/A"),1)]),t("p",null,[s[13]||(s[13]=t("strong",null,"Employee ID :",-1)),r(" "+a(o.value.blood||"N/A"),1)])])]),t("div",fe,[t("div",he,[s[17]||(s[17]=t("h2",{class:"title-md"},"Attendance Summary",-1)),w(m,{to:{name:"MonthWiseApplicationLog",query:{...p(d).query}},class:"btn-2",target:"_blank",rel:"noopener noreferrer"},{default:y(()=>s[16]||(s[16]=[r(" Application History ")])),_:1,__:[16]},8,["to"])]),s[24]||(s[24]=t("hr",null,null,-1)),t("div",we,[t("p",null,[s[18]||(s[18]=t("strong",null,"Total Working Days:",-1)),r(" "+a((M=(q=p(i))==null?void 0:q.summary)==null?void 0:M.total_working_days),1)]),t("p",null,[s[19]||(s[19]=t("strong",null,"Present Days:",-1)),r(" "+a((N=(E=p(i))==null?void 0:E.summary)==null?void 0:N.total_present_days),1)]),t("p",null,[s[20]||(s[20]=t("strong",null,"Absent Days:",-1)),r(" "+a((P=(j=p(i))==null?void 0:j.summary)==null?void 0:P.total_absent_days),1)]),t("p",null,[s[21]||(s[21]=t("strong",null,"Late Days:",-1)),r(" "+a((T=(B=p(i))==null?void 0:B.summary)==null?void 0:T.total_late_days),1)]),t("p",null,[s[22]||(s[22]=t("strong",null,"Total Working Hours:",-1)),r(" "+a((V=(R=p(i))==null?void 0:R.summary)==null?void 0:V.total_working_hours),1)]),t("p",null,[s[23]||(s[23]=t("strong",null,"Total Overtime Hours:",-1)),r(" "+a(($=(W=p(i))==null?void 0:W.summary)==null?void 0:$.total_overtime_hours),1)])])])])):(n(),l("div",ke,s[25]||(s[25]=[t("p",{class:"text-gray-400 text-center text-2xl italic"},"Select an employee, please.",-1)]))),p(i).isLoading?(n(),x(oe,{key:2})):(n(),l("div",Ae,[t("div",Se,[t("table",ge,[s[29]||(s[29]=t("thead",null,[t("tr",{class:"bg-gray-200 text-xs"},[t("th",{class:"border p-1"},"Date"),t("th",{class:"border p-1"},"Day"),t("th",{class:"border p-1"},"Shift"),t("th",{class:"border p-1"},"Entry Time"),t("th",{class:"border p-1"},"Exit Time"),t("th",{class:"border p-1"},"Working Hours"),t("th",{class:"border p-1"},"Over Time"),t("th",{class:"border p-1"},"Approved OT"),t("th",{class:"border p-1"},"Late Entry"),t("th",{class:"border p-1"},"Early Leave"),t("th",{class:"border p-1"},"Status")])],-1)),t("tbody",Ce,[(n(!0),l(ne,null,le((H=p(i))==null?void 0:H.monthlyLogs,e=>{var U,O,F,I,z,J,G;return n(),l("tr",{key:e==null?void 0:e.date,class:"hover:border-b-2 hover:border-gray-200 hover:bg-blue-200"},[t("td",Le,a(e.date),1),t("td",De,a(e.weekday),1),t("td",{class:"border px-2 py-1 text-sm whitespace-nowrap",title:`${e.shift_start_time} to ${e.shift_end_time}`},[t("div",Me,[t("div",Ee,a(e.shift_name),1),e.shift_exchange_application_status?(n(),l("div",Ne,[w(m,{to:{name:"ExchangeShiftShow",params:{id:e.shift_exchange_application_id}},class:b(["inline-flex items-center gap-1 px-2 py-0.5 rounded-full font-medium transition hover:opacity-90",{"bg-yellow-100 text-yellow-800":e.shift_exchange_application_status==="Pending","bg-green-100 text-green-800":e.shift_exchange_application_status==="Approved","bg-red-100 text-red-800":e.shift_exchange_application_status==="Rejected"}])},{default:y(()=>[s[26]||(s[26]=t("i",{class:"far fa-eye"},null,-1)),r(" "+a(e.shift_exchange_application_status),1)]),_:2,__:[26]},1032,["to","class"])])):c("",!0)])],8,qe),t("td",{class:b(["border px-2 py-1 text-sm whitespace-nowrap",{"bg-red-100 text-red-800":e.late_duration,"bg-blue-100 text-blue-800":((U=e==null?void 0:e.manual_attendance)==null?void 0:U.check_in)&&e.entry_time,"bg-gray-50":!e.entry_time}])},[t("div",{class:"flex items-center gap-1",title:`Device: ${e.entry_device}`},[(O=e==null?void 0:e.manual_attendance)!=null&&O.check_in&&e.entry_time?(n(),l("span",Pe,"M:")):c("",!0),t("span",null,a(e.entry_time||"--"),1),(F=e==null?void 0:e.manual_attendance)!=null&&F.id&&((I=e==null?void 0:e.manual_attendance)!=null&&I.check_in)?(n(),x(m,{key:1,to:{name:"ManualAttendanceShow",params:{id:e.manual_attendance.id}},class:"text-blue-600 hover:text-blue-800"},{default:y(()=>s[27]||(s[27]=[t("i",{class:"far fa-eye ml-1"},null,-1)])),_:2,__:[27]},1032,["to"])):c("",!0)],8,je)],2),t("td",{class:b(["border px-2 py-1 text-sm whitespace-nowrap",{"bg-red-100 text-red-800":e.early_leave_duration,"bg-blue-100 text-blue-800":((z=e==null?void 0:e.manual_attendance)==null?void 0:z.check_out)&&e.exit_time,"bg-gray-50":!e.exit_time}])},[t("div",{class:"flex items-center gap-1",title:`Device: ${e.exit_device}`},[t("span",null,a(e.exit_time||"--"),1),(J=e==null?void 0:e.manual_attendance)!=null&&J.id&&((G=e==null?void 0:e.manual_attendance)!=null&&G.check_out)?(n(),x(m,{key:0,to:{name:"ManualAttendanceShow",params:{id:e.manual_attendance.id}},class:"text-blue-600 hover:text-blue-800"},{default:y(()=>s[28]||(s[28]=[t("i",{class:"far fa-eye ml-1"},null,-1)])),_:2,__:[28]},1032,["to"])):c("",!0)],8,Be)],2),t("td",Te,a(e.working_hours),1),t("td",Re,[e.over_time_status==="Approved"?(n(),x(m,{key:0,to:{name:"MyOvertimeShow",params:{id:e.over_time_application_id}},class:"bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-semibold"},{default:y(()=>[r(a(e.overtime_hours)+" | Approved ",1)]),_:2},1032,["to"])):e.over_time_status==="Pending"?(n(),x(m,{key:1,to:{name:"MyOvertimeShow",params:{id:e.over_time_application_id}},class:"bg-yellow-100 text-yellow-700 px-2 py-1 rounded text-xs font-semibold animate-pulse"},{default:y(()=>[r(a(e.overtime_hours??"--")+" | Pending ",1)]),_:2},1032,["to"])):e.over_time_status==="Rejected"?(n(),l("span",Ve," Rejected ")):e.over_time_status&&e.overtime_hours?(n(),l("span",We,a(e.overtime_hours),1)):c("",!0)]),t("td",$e,a(e!=null&&e.approved_over_times?(e==null?void 0:e.approved_over_times)+" H":""),1),t("td",He,[e.late_duration?(n(),l("div",Ue,[r(a(e.late_duration)+" ",1),e.first_short_leave?(n(),x(m,{key:0,to:{name:"ShortLeaveShow",params:{id:e.first_short_leave_id}},class:b({"text-green-500":e.first_short_leave==="Approved","text-yellow-500":e.first_short_leave==="Pending","text-red-500":e.first_short_leave==="Rejected"})},{default:y(()=>[r(" ("+a(e.first_short_leave)+") ",1)]),_:2},1032,["to","class"])):c("",!0)])):c("",!0)]),t("td",Oe,[e.early_leave_duration?(n(),l("div",Fe,[r(a(e.early_leave_duration)+" ",1),e.last_short_leave?(n(),x(m,{key:0,to:{name:"ShortLeaveShow",params:{id:e.last_short_leave_id}},class:b(["px-1",{"text-green-500":e.last_short_leave==="Approved","text-yellow-500":e.last_short_leave==="Pending","text-red-500":e.last_short_leave==="Rejected"}])},{default:y(()=>[r(" ("+a(e.last_short_leave)+") ",1)]),_:2},1032,["to","class"])):c("",!0)])):c("",!0)]),t("td",Ie,[t("div",ze,[w(_e,{status:e.status},null,8,["status"]),e.leave_application_id?(n(),l("div",Je,[w(m,{to:{name:"LeaveApplicationShow",params:{id:e.leave_application_id}},class:"text-blue-600 text-xs inline-flex items-center gap-1 hover:underline hover:text-blue-800 transition",title:"View Leave Application"},{default:y(()=>[t("span",{class:b(["text-xs font-medium px-2 py-0.5 rounded-full border transition",{"bg-green-50 text-green-700 border-green-200":e.application_status==="Approved","bg-yellow-50 text-yellow-700 border-yellow-200":e.application_status==="Pending","bg-red-50 text-red-700 border-red-200":e.application_status==="Rejected","bg-gray-50 text-gray-600 border-gray-200":!e.application_status}])},a(e.application_status||"Waiting Handover"),3)]),_:2},1032,["to"])])):c("",!0)])])])}),128))])])])]))])}}};export{at as default};
