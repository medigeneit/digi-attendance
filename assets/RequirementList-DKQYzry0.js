import{L as F}from"./LoaderView-BaICqCEq.js";import{d as P,b as B,p as v,r as I,e as j,q as S,c as l,o,a as t,y as h,f as A,g as $,i as w,t as m,k as u,h as O,v as H,u as G,C as Y,j as N,F as J,x as K}from"./index-dBcMmu7q.js";import{g as Q}from"./task-Bj3Lm1o4.js";import{u as W}from"./company-PJnaK622.js";import{_ as z}from"./CompanyDepartmentSelectInput-xwj3h_Mj.js";import{_ as X}from"./EmployeeDropdownInput-a11Nbz8y.js";import{S as Z}from"./SelectDropdown-jQcUPhGP.js";import{_ as M}from"./UserChip-Dh7-0lTA.js";import{u as q}from"./useRequirementStore-C9vgqXVr.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./url-CePbr-gY.js";import"./requirement-oLM8cJKI.js";const ee={class:"mb-3 task-header"},te={class:"flex flex-wrap items-center justify-center gap-2 mt-3"},se={class:"flex flex-wrap gap-x-4 gap-y-3 justify-between"},oe={class:"relative"},ae=["title"],le={key:0},ne={key:1,class:"text-gray-500 whitespace-nowrap"},ie={key:1,class:"relative w-full md:w-56 lg:flex-grow"},de={class:"text-gray-600 w-full md:w-32 relative"},re={__name:"RequirementHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(E,{emit:r}){const f=E,D=P(),k=B(),b=v(c("company-id")),p=v(c("from-department-id")),s=v(c("to-department-id")),g=v(c("created-by")),T=v(c("month")),e=r,i=W(),C=I([]);function c(d){return{get:()=>f.modelValue[d]||"",set:a=>{e("update:modelValue",{...f.modelValue,[d]:a||void 0})}}}async function V(){var d,a,x;if(!f.isMyTask){const y=(d=f.modelValue)==null?void 0:d["company-id"],_=s.value,n={...y?{company_id:y}:{},..._?{department_ids:[_]}:{}};C.value=((x=(a=await Q({params:n}))==null?void 0:a.data)==null?void 0:x.employees)||[]}}j(async()=>{await i.fetchCompanies({with:"departments",ignore_permission:!0}),await i.fetchMyCompanies({with:"departments"}),await V()}),S(()=>s.value,V),S(()=>b.value,()=>{p.value="",s.value="",g.value="",V()});const L=v(()=>b.value?i==null?void 0:i.companies.filter(d=>d.id==b.value):i==null?void 0:i.companies);return(d,a)=>{var x,y,_;return o(),l("div",null,[t("div",ee,[t("div",te,[t("div",se,[t("div",oe,[h(Z,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=n=>b.value=n),options:((x=u(i))==null?void 0:x.companies)||[],label:"name",id:"id",class:"border-2 border-gray-300 rounded h-[40px] w-full md:w-48 bg-white text-sm",clearable:""},{"selected-option":w(({option:n})=>[t("div",{class:"line-clamp-1 text-sm text-gray-900",title:n==null?void 0:n.name},[n!=null&&n.name?(o(),l("span",le,m(n==null?void 0:n.name),1)):(o(),l("span",ne,"--ALL COMPANY--"))],8,ae)]),_:1},8,["modelValue","options"]),a[5]||(a[5]=t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Company ",-1))]),h(z,{modelValue:p.value,"onUpdate:modelValue":a[1]||(a[1]=n=>p.value=n),companies:L.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:w(()=>a[6]||(a[6]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),u(k).name!=="MyTaskList"?(o(),A(z,{key:0,modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=n=>s.value=n),companies:L.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:w(()=>a[7]||(a[7]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):$("",!0),u(D).isAdminMood&&((_=(y=u(D))==null?void 0:y.user)==null?void 0:_.role)!=="employee"?(o(),l("div",ie,[h(X,{employees:C.value,modelValue:g.value,"onUpdate:modelValue":a[3]||(a[3]=n=>g.value=n),class:"border-2 border-gray-300 rounded h-[40px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),a[8]||(a[8]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Created By ",-1))])):$("",!0),t("div",de,[a[9]||(a[9]=t("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),O(t("input",{id:"month-filter","onUpdate:modelValue":a[4]||(a[4]=n=>T.value=n),type:"month",class:"h-10 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[H,T.value]])])])])])])}}},me={class:"container mx-auto p-6"},ue={class:"bg-white shadow-md rounded-lg p-6"},pe={key:1,class:"text-center py-4 text-red-500"},ce={key:2,class:"overflow-x-auto border-x xl:border-x-0"},xe={class:"min-w-full bg-white border overflow-hidden table table-fixed"},ye={key:0},_e={class:"px-4 py-4 font-semibold text-xl text-gray-700 border border-gray-200 text-center"},fe={class:"px-4 py-4 min-w-[300px] md:min-w-[400px] border border-gray-200"},be={class:"flex flex-col lg:flex-row items-start lg:items-center lg:flex-wrap gap-2 text-sm mb-3"},ge=["title"],ve=["title"],he={class:"space-y-4"},we={key:0,class:"text-blue-800"},ke=["title"],Ve={key:1,class:"text-gray-400 text-sm italic"},Re={key:0},Ae={key:1,class:""},Te={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},Ce={class:"flex items-center gap-2"},Le={class:"flex items-center gap-2 mt-2"},De={key:1},Me={key:0},Ne={key:1,class:"italic text-xs text-gray-400"},Se={class:"flex items-center gap-2 mt-2"},$e={key:1},Ee={key:0},Ue={key:1,class:"italic text-xs text-gray-400"},ze={class:"flex items-center gap-2 mt-2"},Be={key:1},je={key:0},Fe={key:1,class:"italic text-xs text-gray-400"},Pe={class:"px-4 py-4 text-center whitespace-nowrap border border-gray-200"},Ie={key:0,class:"text-gray-600"},Oe={key:1},He={class:"px-4 py-4 text-center border border-gray-200"},Ge={class:"flex gap-4 items-center justify-center"},at={__name:"RequirementList",setup(E){const r=q(),f=G(),D=B(),k=v({get(){return{...D.query}},set(p){f.push({query:{...p}})}});j(()=>{console.log("Requirement List Mounted"),r.fetchRequirements(k.value)}),S(()=>({...k.value}),async function(p){r.fetchRequirements(p)});const b=()=>{f.push({name:"RequirementAdd"})};return(p,s)=>{var T;const g=Y("RouterLink");return o(),l("div",me,[t("div",ue,[t("div",{class:"flex justify-between items-center mb-6"},[s[3]||(s[3]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Requirements",-1)),t("button",{onClick:b,class:"btn-1"},"Add Requirement")]),h(re,{modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=e=>k.value=e)},null,8,["modelValue"]),u(r).loading?(o(),A(F,{key:0,class:"min-h-64 shadow-none"},{default:w(()=>s[4]||(s[4]=[N("Loading requirements...")])),_:1,__:[4]})):u(r).error?(o(),l("div",pe,m(u(r).error),1)):(o(),l("div",ce,[t("table",xe,[s[14]||(s[14]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-2 text-center whitespace-nowrap border w-[4%]"},"#"),t("th",{class:"px-4 py-2 text-left whitespace-nowrap border w-[60%]"},"Requirement"),t("th",{class:"px-4 py-2 text-center whitespace-nowrap w-[12%] border"},"User"),t("th",{class:"px-4 py-2 text-center whitespace-nowrap w-[12%] border"},"Submitted At"),t("th",{class:"px-4 py-2 text-center whitespace-nowrap w-[12%] border"},"Actions")])],-1)),t("tbody",null,[((T=u(r).requirements)==null?void 0:T.length)===0?(o(),l("tr",ye,s[5]||(s[5]=[t("td",{colspan:"10",class:"p-4"},[t("div",{class:"text-gray-500 italic w-full h-64 flex items-center justify-center"}," No Requirement Found ")],-1)]))):(o(!0),l(J,{key:1},K(u(r).requirements,(e,i)=>{var C,c,V,L,d,a,x,y,_,n;return o(),l("tr",{key:e.id,class:"border-t hover:bg-blue-50 odd:bg-gray-50 group/item"},[t("td",_e,m(i+1),1),t("td",fe,[t("div",be,[s[6]||(s[6]=t("span",{class:"text-gray-400"},"From ",-1)),t("span",{title:(C=e==null?void 0:e.from_department)==null?void 0:C.name,class:"text-blue-500/60 group-hover/item:text-blue-500 font-semibold flex-shrink-0 border bg-blue-50 rounded-full px-2 text-xs"},m(((c=e==null?void 0:e.from_department)==null?void 0:c.short_name)||((V=e==null?void 0:e.from_department)==null?void 0:V.name)),9,ge),s[7]||(s[7]=t("span",{class:"text-gray-400"},"To ",-1)),t("span",{title:(L=e==null?void 0:e.to_department)==null?void 0:L.name,class:"text-sky-500/60 group-hover/item:text-sky-500 font-semibold flex-shrink-0 border bg-blue-50 rounded-full px-2 text-xs"},m(((d=e==null?void 0:e.to_department)==null?void 0:d.short_name)||((a=e==null?void 0:e.to_department)==null?void 0:a.name)),9,ve)]),t("div",he,[((x=e==null?void 0:e.details)==null?void 0:x.length)>0&&Array.isArray(e==null?void 0:e.details)?(o(),l("div",we,[t("div",{class:"line-clamp-1 font-semibold",title:e==null?void 0:e.details[0].title},m(e==null?void 0:e.details[0].title),9,ke)])):(o(),l("div",Ve,"No Requirement added")),h(g,{to:{name:"RequirementShow",params:{id:e==null?void 0:e.id}},class:"text-blue-600 text-sm hover:underline hover:text-blue-800"},{default:w(()=>{var R,U;return[((R=e==null?void 0:e.details)==null?void 0:R.length)-1>0?(o(),l("span",Re,m(((U=e==null?void 0:e.details)==null?void 0:U.length)-1)+" More Requirement ",1)):(o(),l("span",Ae,"Show Form"))]}),_:2},1032,["to"])])]),t("td",Te,[t("div",Ce,[s[8]||(s[8]=t("span",{class:"text-xs text-gray-500"},"Created:",-1)),e.created_by?(o(),A(M,{key:0,user:e.created_by,"avatar-size":"xsmall"},null,8,["user"])):$("",!0)]),t("div",Le,[s[9]||(s[9]=t("div",{class:"text-xs text-gray-500"},"From Coordinator:",-1)),e.from_coordinator?(o(),A(M,{key:0,user:e.from_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",De,[(y=e==null?void 0:e.from_department)!=null&&y.coordinator_id?(o(),l("span",Me,"-")):(o(),l("span",Ne,"N/A"))]))]),t("div",Se,[s[10]||(s[10]=t("div",{class:"text-xs text-gray-500"},"To Coordinator:",-1)),e.to_coordinator?(o(),A(M,{key:0,user:e.to_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",$e,[(_=e==null?void 0:e.to_department)!=null&&_.coordinator_id?(o(),l("span",Ee,"-")):(o(),l("span",Ue,"N/A"))]))]),t("div",ze,[s[11]||(s[11]=t("div",{class:"text-xs text-gray-500"},"To In Charge:",-1)),e.to_incharge?(o(),A(M,{key:0,user:e.to_incharge,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",Be,[(n=e==null?void 0:e.to_department)!=null&&n.incharge_id?(o(),l("span",je,"-")):(o(),l("span",Fe,"N/A"))]))])]),t("td",Pe,[e.submission_date?(o(),l("div",Ie,[t("div",null,m(new Date(e.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),1),t("div",null,m(new Date(e.submission_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})),1)])):(o(),l("div",Oe,"-"))]),t("td",He,[t("div",Ge,[h(g,{to:{name:"RequirementShow",params:{id:e==null?void 0:e.id}},class:"btn-2",onClick:s[1]||(s[1]=R=>R.stopPropagation())},{default:w(()=>s[12]||(s[12]=[t("i",{class:"fad fa-eye"},null,-1),N(" Show ")])),_:2,__:[12]},1032,["to"]),h(g,{to:{name:"RequirementEdit",params:{id:e==null?void 0:e.id}},class:"btn-4 border border-blue-500 hover:bg-blue-500 hover:text-white",onClick:s[2]||(s[2]=R=>R.stopPropagation())},{default:w(()=>s[13]||(s[13]=[t("i",{class:"fad fa-edit"},null,-1),N(" Edit ")])),_:2,__:[13]},1032,["to"])])])])}),128))])])]))])])}}};export{at as default};
