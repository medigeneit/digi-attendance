import{u as F,f as T,D as E,r as m,x as q,h as H,q as D,p as P,c as i,o as n,a as t,d as _,l as c,k as G,m as p,H as I,j as U,F as O,e as W,t as a,i as Y}from"./index-DwjCuk-z.js";import{_ as z}from"./EmployeeFilter-BG8MCAWp.js";import{L as J}from"./LoaderView-BjZy94g6.js";import{_ as K}from"./FlexibleDatePicker-D9zpJgC9.js";import{u as Q}from"./leave-application-B95nfv_9.js";import{u as X}from"./user-Bful660Z.js";import"./company-DAUSD8Gu.js";import"./department-BbGy8YnP.js";import"./EmployeeDropdownInput-ynUHTXW0.js";import"./SelectDropdown-DtstiP7a.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-Egj6aAaz.js";const Z={class:"space-y-2 px-4"},ee={class:"flex flex-wrap gap-2 p-3 rounded-2xl border border-white/20 bg-white/60 backdrop-blur-md shadow-sm supports-[backdrop-filter]:bg-white/50 sticky top-14"},te={class:"flex gap-4 items-center flex-wrap"},re={class:"relative"},se={key:0,class:"text-center py-4"},oe={key:1,class:"space-y-4"},de={class:""},le={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},ae={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},ue={class:"border border-gray-300 px-2"},ie={class:"border border-gray-300 px-2"},ye={class:"border border-gray-300 px-2"},me={class:"border border-gray-300 px-2"},_e={class:"border border-gray-300 px-2"},ve=["innerHTML"],be={class:"border border-gray-300 px-2"},fe={class:"border border-gray-300 px-2"},ce={class:"border border-gray-300 px-2"},pe={class:"flex justify-center gap-2"},ge=["onClick"],xe={key:0},Ve={__name:"LeaveApplicationList",setup(he){const v=F(),d=T(),l=Q(),g=X(),{leaveApplications:C,loading:x}=E(l),M=m(null),b=d.query.date||l.selectedMonth||new Date().toISOString().slice(0,7),h=m(b),w=new Date,R=o=>o.toString().padStart(2,"0"),u=m({year:Number(b.split("-")[0]||w.getFullYear()),month:Number(b.split("-")[1]||w.getMonth()+1),day:1}),B=q(()=>{var o,r;return!((o=u.value)!=null&&o.year)||!((r=u.value)!=null&&r.month)?"":`${u.value.year}-${R(u.value.month)}`}),N=m(d.query.search||""),s=m({company_id:d.query.company_id||"",department_id:d.query.department_id||"all",line_type:d.query.line_type||"all",employee_id:d.query.employee_id||"",category:""}),y=async()=>{const o={company_id:s.value.company_id,department_id:s.value.department_id,line_type:s.value.line_type,selectedDate:h.value,selectedStatus:l.selectedStatus,query:N.value};s.value.employee_id&&(o.user_id=s.value.employee_id),x.value=!0,await l.fetchLeaveApplications(o),x.value=!1};H(async()=>{s.value.employee_id&&(await g.fetchUser(s.value.employee_id),M.value=g.user||null),await y()}),D(()=>[s.value.company_id,s.value.department_id,s.value.line_type,s.value.employee_id],async()=>{await y()}),D(B,o=>{o&&(h.value=o,v.replace({query:{...d.query,date:o}}),y())});const k=q(()=>C.value||[]),V=async o=>{confirm("Are you sure to delete this application?")&&(await l.deleteLeaveApplication(o),await y())},j=()=>v.go(-1),$=()=>{v.replace({query:{...d.query,company_id:s.value.company_id,department_id:s.value.department_id,line_type:s.value.line_type,employee_id:s.value.employee_id}})},f=o=>o?new Date(o).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"";return(o,r)=>{const L=P("RouterLink");return n(),i("div",Z,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:j},r[6]||(r[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),r[7]||(r[7]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Leave Applications",-1)),r[8]||(r[8]=t("div",null,null,-1))]),t("div",ee,[_(z,{company_id:s.value.company_id,"onUpdate:company_id":r[2]||(r[2]=e=>s.value.company_id=e),department_id:s.value.department_id,"onUpdate:department_id":r[3]||(r[3]=e=>s.value.department_id=e),employee_id:s.value.employee_id,"onUpdate:employee_id":r[4]||(r[4]=e=>s.value.employee_id=e),line_type:s.value.line_type,"onUpdate:line_type":r[5]||(r[5]=e=>s.value.line_type=e),"with-type":!0,"initial-value":o.$route.query,onFilterChange:$},{default:c(()=>[t("div",te,[t("div",null,[r[10]||(r[10]=t("label",{for:"",class:"top-label -top-1"},"Status ",-1)),G(t("select",{"onUpdate:modelValue":r[0]||(r[0]=e=>p(l).selectedStatus=e),onChange:y,class:"input-1 py-0.5"},r[9]||(r[9]=[t("option",{value:"",selected:""},"All",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Rejected"},"Rejected",-1)]),544),[[I,p(l).selectedStatus]])]),t("div",re,[r[11]||(r[11]=t("label",{class:"top-label -top-1"},"Month ",-1)),_(K,{modelValue:u.value,"onUpdate:modelValue":r[1]||(r[1]=e=>u.value=e),"show-year":!1,"show-month":!0,"show-date":!1},null,8,["modelValue"])])])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"])]),p(l).loading?(n(),i("div",se,[_(J)])):(n(),i("div",oe,[t("div",de,[t("table",le,[r[16]||(r[16]=t("thead",null,[t("tr",{class:"bg-gray-200 sticky top-28 p-2"},[t("th",{class:"border border-gray-300 px-2 text-left"},"#"),t("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),t("th",{class:"border border-gray-300 px-2 text-left"},"Created Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Last Working Day"),t("th",{class:"border border-gray-300 px-2 text-left"},"Resumption Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Leave Period"),t("th",{class:"border border-gray-300 px-2 text-left"},"Total Days"),t("th",{class:"border border-gray-300 px-2 text-left"},"Type"),t("th",{class:"border border-gray-300 px-2 text-left"},"Status"),t("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),t("tbody",null,[(n(!0),i(O,null,W(k.value,(e,A)=>{var S;return n(),i("tr",{key:A,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",ae,a(A+1),1),t("td",ne,a(((S=e==null?void 0:e.user)==null?void 0:S.name)||"Unknown"),1),t("td",ue,a(f(e==null?void 0:e.created_at)),1),t("td",ie,a(f(e==null?void 0:e.last_working_date)),1),t("td",ye,a(f(e==null?void 0:e.resumption_date)),1),t("td",me,a(e==null?void 0:e.leave_period),1),t("td",_e,[t("div",{innerHTML:e.duration||(e==null?void 0:e.total_leave_days)},null,8,ve)]),t("td",be,a(e==null?void 0:e.application_types),1),t("td",fe,a((e==null?void 0:e.status)||"N/A"),1),t("td",ce,[t("div",pe,[_(L,{to:{name:"LeaveApplicationShow",params:{id:e==null?void 0:e.id}},class:"btn-icon"},{default:c(()=>r[12]||(r[12]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[12]},1032,["to"]),(e==null?void 0:e.status)!=="Rejected"?(n(),Y(L,{key:0,to:{name:"LeaveApplicationEdit",params:{id:e==null?void 0:e.id}},class:"btn-icon"},{default:c(()=>r[13]||(r[13]=[t("i",{class:"far fa-edit text-orange-600"},null,-1)])),_:2,__:[13]},1032,["to"])):U("",!0),t("button",{onClick:we=>V(e==null?void 0:e.id),class:"btn-icon text-red-500"},r[14]||(r[14]=[t("i",{class:"far fa-trash"},null,-1)]),8,ge)])])])}),128)),k.value.length?U("",!0):(n(),i("tr",xe,r[15]||(r[15]=[t("td",{colspan:"7",class:"p-1 text-center text-red-500"},"No application found",-1)])))])])])]))])}}};export{Ve as default};
