import{P as _,r as u,x as d,Q as v,a9 as M}from"./index-CvmXPPpp.js";const P=_("shortLeave",()=>{const f=u(null),n=u([]),h=u(null),o=u(!1),s=u(null),p=u(new Date().toISOString().substring(0,7)),g=u(new Date().toISOString().substring(0,10)),w=u(""),y=async(a={})=>{var r,t;o.value=!0,s.value=null;try{const e=await v.get("/short-leaves",{params:a});n.value=e==null?void 0:e.data}catch(e){s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to fetch short leaves",console.error("Error fetching short leaves:",e)}finally{o.value=!1}},m=async(a={})=>{var r,t;o.value=!0,s.value=null;try{const e=await v.get("/date-wise-short-leaves",{params:a});n.value=e==null?void 0:e.data}catch(e){s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to fetch short leaves",console.error("Error fetching short leaves:",e)}finally{o.value=!1}},$=async(a={})=>{var r,t;o.value=!0,s.value=null;try{console.log({filters:a});const e=await v.get("/my-short-leaves",{params:a});n.value=e.data.data}catch(e){s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to fetch short leaves",console.error("Error fetching short leaves:",e)}finally{o.value=!1}},E=async(a={})=>{var r,t;o.value=!0,s.value=null;try{return(await v.get("/short-leaves/create",{params:a})).data}catch(e){s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to fetch short leaves",console.error("Error fetching short leaves:",e)}finally{o.value=!1}},S=async a=>{var r,t;o.value=!0,s.value=null;try{const e=await v.get(`/short-leaves/${a}`);h.value=e.data,await M().fetchApprovalPermissions("short_leave_applications",h.value.id)}catch(e){s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||`Failed to fetch short leave (ID: ${a})`,console.error(`Error fetching short leave with id ${a}:`,e)}finally{o.value=!1}},I=async a=>{var r,t;o.value=!0,s.value=null;try{const e=await v.post("/short-leaves/store",a);return n.value.push(e.data.data),e.data.data}catch(e){throw s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to create short leave",console.error("Error creating short leave:",e),new Error(s.value)}finally{o.value=!1}},L=async(a,r)=>{var t,e;o.value=!0,s.value=null;try{const l=await v.put(`/short-leaves/${a}`,r),c=n.value.findIndex(i=>i.id===a);return c!==-1&&(n.value[c]=l.data.data),l.data.data}catch(l){throw s.value=((e=(t=l.response)==null?void 0:t.data)==null?void 0:e.message)||`Failed to update short leave (ID: ${a})`,console.error(`Error updating short leave with id ${a}:`,l),new Error(s.value)}finally{o.value=!1}},x=async(a,r)=>{var t,e;o.value=!0,s.value=null;try{const l=await v.put(`/attachment/short-leaves/${a}`,r),c=n.value.findIndex(i=>i.id===a);return c!==-1&&(n.value[c]=l.data.data),l.data.data}catch(l){throw s.value=((e=(t=l.response)==null?void 0:t.data)==null?void 0:e.message)||`Failed to update short leave (ID: ${a})`,console.error(`Error updating short leave with id ${a}:`,l),new Error(s.value)}finally{o.value=!1}},D=async a=>{var r,t;o.value=!0,s.value=null;try{await v.delete(`/short-leaves/${a}`),n.value=n.value.filter(e=>e.id!==a)}catch(e){throw s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||`Failed to delete short leave (ID: ${a})`,console.error(`Error deleting short leave with id ${a}:`,e),new Error(s.value)}finally{o.value=!1}},F=async a=>{var r,t;o.value=!0,s.value=null;try{const e=await v.post(`/short-leaves/${a.id}/handover-accept`,a),l=n.value.findIndex(c=>c.id===id);return l!==-1&&(n.value[l]=e.data.data),e.data.data}catch(e){throw s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||`Failed to accept handover for short leave (ID: ${id})`,console.error(`Error accepting handover for short leave with id ${id}:`,e),new Error(s.value)}finally{o.value=!1}},C=async a=>{var r,t;o.value=!0,s.value=null;try{const e=await v.post(`/short-leaves/${a.id}/in-charge-accept`,a),l=n.value.findIndex(c=>c.id===a.id);return l!==-1&&(n.value[l]=e.data.data),e.data.data}catch(e){throw s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||`Failed to accept In-Charge for short leave (ID: ${a.id})`,console.error(`Error accepting In-Charge for short leave with id ${id}:`,e),new Error(s.value)}finally{o.value=!1}},b=async a=>{var r,t;o.value=!0,s.value=null;try{const e=await v.post(`/short-leaves/${a.id}/recommend-by-accept`,a),l=n.value.findIndex(c=>c.id===a.id);return l!==-1&&(n.value[l]=e.data.data),e.data.data}catch(e){throw s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||`Failed to accept recommend by for short leave (ID: ${a.id})`,console.error(`Error accepting recommend by for short leave with id ${id}:`,e),new Error(s.value)}finally{o.value=!1}},A=async a=>{var r,t;o.value=!0,s.value=null,console.log({payload:a});try{const e=await v.post(`/short-leaves/${a==null?void 0:a.id}/approved-by-accept`,a),l=n.value.findIndex(c=>c.id===a.id);return l!==-1&&(n.value[l]=e.data.data),e.data.data}catch(e){throw s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||`Failed to accept approval for short leave (ID: ${a.id})`,console.error(`Error accepting approval for short leave with id ${id}:`,e),new Error(s.value)}finally{o.value=!1}},j=async(a,r)=>{var t,e;o.value=!0,s.value=null;try{const l=await v.post(`/short-leaves/${a}/reject`,{rejection_reason:r}),c=n.value.findIndex(i=>i.id===a);return c!==-1&&(n.value[c]=l.data.data),l.data.data}catch(l){throw s.value=((e=(t=l.response)==null?void 0:t.data)==null?void 0:e.message)||`Failed to reject short leave (ID: ${a})`,console.error(`Error rejecting short leave with id ${a}:`,l),new Error(s.value)}finally{o.value=!1}},B=async a=>{var r,t;try{return o.value=!0,(await v.post("attachment-upload",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(e){s.value=((t=(r=e.response)==null?void 0:r.data)==null?void 0:t.message)||"Something went wrong"}finally{o.value=!1}};return{shortLeaves:d(()=>n.value),shortLeave:d(()=>h.value),loading:d(()=>o.value),error:d(()=>s.value),shortLeaveCreateDate:f,selectedMonth:p,selectedDate:g,selectedStatus:w,fetchShortLeaves:y,fetchShortLeaveById:S,createShortLeave:I,updateShortLeave:L,deleteShortLeave:D,handoverAccept:F,inChargeAccept:C,recommendByAccept:b,approvedByAccept:A,rejectShortLeave:j,fetchCreateShortLeaveData:E,uploadShortLeaveAttachment:x,fetchFileUpload:B,fetchMyShortLeaves:$,fetchDateWiseShortLeaves:m}});export{P as u};
