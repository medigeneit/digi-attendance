import{g as te,f as le,x as n,r as se,h as ae,q as W,p as oe,c as x,o as m,a as t,k as y,b as A,t as z,j as _,d as j,m as B,F as G,n as f,l as k,H as ne,Q as R,s as F,v as ue,e as re,w as de}from"./index-3jdekiaM.js";import{g as ie}from"./task-tIJpH8eQ.js";import{u as me}from"./company-UII91d5g.js";import{_ as K}from"./CompanyDepartmentSelectInput-kYD7gjZ5.js";import{_ as pe}from"./EmployeeDropdownInput-B-UBj69D.js";import{_ as Q}from"./SearchInput-C5zI9o__.js";const ve={class:"mb-3 task-header"},fe={class:"flex justify-between items-start"},xe={class:"text-2xl font-bold text-gray-800 leading-none h-7"},ye={key:0,class:"ml-auto flex gap-6 items-center"},ce={class:"flex flex-wrap items-center justify-stretch gap-2 mt-3"},be={class:"flex flex-wrap gap-x-4 gap-y-5 justify-between w-full"},ge={key:1,class:"relative w-full md:w-56 lg:flex-grow"},ke={class:"relative"},we={class:"w-32 relative h-7"},Ve={class:"flex gap-4 items-center flex-shrink-0"},Ce={class:"flex gap-2"},Te={class:"flex gap-2"},Me={class:"flex gap-2"},Ae={class:"text-gray-600 w-full md:w-32 relative xl:ml-auto"},Ue={class:"flex flex-col lg:flex-row mb-2 items-end mt-6 gap-6 sticky top-[4.1rem] z-40 bg-white/80"},he={class:"flex items-center gap-3 flex-grow flex-wrap justify-center"},De={key:0,class:"text-[9px] text-green-800"},Le=["onClick"],Ee={key:1,class:"flex justify-end gap-5"},Re={__name:"TaskHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(g,{emit:J}){const U=g,O=te(),c=le(),w=n(r("company-id")),V=n(r("from-department-id")),b=n(r("to-department-id")),h=n(r("user-ids")),D=n(r("month")),L=n(r("status")),E=n(r("is-important")),q=n(r("is-urgent")),N=n(r("is-target")),I=n(r("is-closed")),S=n(r("search")),P=J,p=me(),C=se([]);function r(a){return{get:()=>U.modelValue[a]||"",set:e=>{P("update:modelValue",{...U.modelValue,[a]:e||void 0})}}}const X=n(()=>Y(h.value));async function $(){var a,e,d;if(!U.isMyTask){const i=(a=U.modelValue)==null?void 0:a["company-id"],s=b.value,u={...i?{company_id:i}:{},...s?{department_ids:[s]}:{}};C.value=((d=(e=await ie({params:u}))==null?void 0:e.data)==null?void 0:d.employees)||[]}}ae(async()=>{await p.fetchCompanies({with:"departments",ignore_permission:!0}),await p.fetchMyCompanies({with:"departments"}),await $()});function Y(a){return Array.isArray(C.value)&&C.value.find(e=>e.id==a)||null}function Z(){h.value=""}W(()=>b.value,$),W(()=>w.value,()=>{V.value="",b.value=""});function T(a,e,{value:d,id:i,label:s,onCancel:u}={}){if(!a)return[];const o=Array.isArray(e)?e.find(v=>(v==null?void 0:v[i])==a):null;return o?[{label:s,value:typeof d=="function"?d(o):o==null?void 0:o[d],id:o==null?void 0:o[i],onCancel:u}]:[]}const ee=n(()=>{var i;const a=p.companies.reduce((s,u)=>[...s,...u.departments],[]),e=(s,{label:u,value:o,id:v,onCancel:l})=>s?[{label:u,value:o,id:v,onCancel:l}]:[],d=(s,{label:u,onCancel:o})=>{if(!s)return[];const v=new Date(s);return[{label:u,value:v.toLocaleDateString("en-US",{month:"long",year:"numeric"}),id:s,onCancel:o}]};return[...T(w.value,p.companies,{label:"Company",value:"short_name",id:"id",onCancel:()=>{w.value=""}}),...T(V.value,a,{id:"id",label:"From",value:s=>s.short_name||s.name,onCancel:()=>{V.value=""}}),...T(b.value,a,{id:"id",label:"To",value:s=>s.short_name||s.name,onCancel:()=>{b.value=""}}),...T((i=X.value)==null?void 0:i.id,C.value,{label:"Employee",value:"name",id:"id",onCancel:Z}),...T(L.value,[{id:"only-completed",name:"Completed Only"},{id:"not-completed",name:"Not Completed"}],{label:"",value:"name",id:"id",onCancel:()=>{L.value=""}}),...e(E.value,{label:"",value:"Important ",id:!0,onCancel:()=>{E.value=""}}),...e(q.value,{label:"",value:"Urgent ",id:!0,onCancel:()=>{q.value=""}}),...e(N.value,{label:"",value:"Targeted Task",id:!0,onCancel:()=>{N.value=""}}),...d(D.value,{label:"",onCancel:()=>{D.value=""}})]}),H=n(()=>w.value?p==null?void 0:p.companies.filter(a=>a.id==w.value):p==null?void 0:p.companies);return(a,e)=>{var i,s,u,o,v;const d=oe("RouterLink");return m(),x("div",null,[t("div",ve,[t("div",fe,[t("h2",xe,[e[12]||(e[12]=t("i",{class:"fad fa-tasks"},null,-1)),A(z(I.value?"Closed":"")+" Task List ",1)]),g.isMyTask?y("",!0):(m(),x("div",ye,[t("button",{onClick:e[0]||(e[0]=l=>P("clickAddTask")),class:"btn-1"},e[13]||(e[13]=[t("i",{class:"fad fa-plus-circle"},null,-1),A("Add Task ")]))]))]),t("div",ce,[t("div",be,[j(K,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=l=>V.value=l),companies:H.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-7 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:B(()=>e[14]||(e[14]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),g.isMyTask?y("",!0):(m(),x(G,{key:0},[f(c).name!=="MyRequirementTaskList"?(m(),_(K,{key:0,modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l),companies:H.value||[],class:"relative w-full md:w-40 flex-grow",className:{select:"h-7 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:B(()=>e[15]||(e[15]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):y("",!0),f(O).isAdminMood&&((s=(i=f(O))==null?void 0:i.user)==null?void 0:s.role)!=="employee"?(m(),x("div",ge,[t("div",ke,[j(pe,{employees:C.value,modelValue:h.value,"onUpdate:modelValue":e[3]||(e[3]=l=>h.value=l),class:"border-2 border-gray-300 rounded h-[28px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),e[16]||(e[16]=t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Employee ",-1))]),e[17]||(e[17]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Employee ",-1))])):y("",!0)],64)),t("div",we,[e[19]||(e[19]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),k(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>L.value=l),class:"h-full text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},e[18]||(e[18]=[t("option",{value:""},"--ALL TASKS--",-1),t("option",{value:"not-completed"},"Not Completed",-1),t("option",{value:"only-completed"},"Completed",-1)]),512),[[ne,L.value]])]),t("div",Ve,[t("label",Ce,[k(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=l=>E.value=l)},null,512),[[R,E.value]]),e[20]||(e[20]=t("span",null,"Important",-1))]),t("label",Te,[k(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=l=>q.value=l)},null,512),[[R,q.value]]),e[21]||(e[21]=t("span",null,"Urgent",-1))]),t("label",Me,[k(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=l=>N.value=l)},null,512),[[R,N.value]]),e[22]||(e[22]=t("span",null,"Is Target",-1))]),t("label",{class:F(["flex gap-2 border px-2 rounded",[I.value?"bg-sky-800 text-white border-sky-500":"text-sky-800 border-sky-500"]])},[k(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=l=>I.value=l)},null,512),[[R,I.value]]),e[23]||(e[23]=t("span",null,"Closed",-1))],2)]),t("div",Ae,[e[24]||(e[24]=t("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),k(t("input",{id:"month-filter","onUpdate:modelValue":e[9]||(e[9]=l=>D.value=l),type:"month",class:"h-7 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[ue,D.value]])])]),g.isMyTask?(m(),_(Q,{key:0,modelValue:S.value,"onUpdate:modelValue":e[10]||(e[10]=l=>S.value=l),class:"w-full md:w-64 lg:w-64 md:ml-auto h-7"},null,8,["modelValue"])):y("",!0)])]),t("div",Ue,[g.isMyTask?y("",!0):(m(),_(Q,{key:0,modelValue:S.value,"onUpdate:modelValue":e[11]||(e[11]=l=>S.value=l),class:"w-full md:w-64 md:ml-auto"},null,8,["modelValue"])),t("div",he,[(m(!0),x(G,null,re(ee.value,l=>(m(),x("div",{key:l.label||l.value,class:"flex-shrink-0 text-xs bg-gray-50 border border-gray-300 rounded-md px-2 flex gap-1"},[t("div",null,[l.label?(m(),x("span",De,z(l.label)+": ",1)):y("",!0),A(z(l.value),1)]),t("button",{type:"button",class:"text-gray-400 hover:text-red-400",onClick:de(l.onCancel,["prevent"])},e[25]||(e[25]=[t("i",{class:"fas fa-times-circle"},null,-1)]),8,Le)]))),128))]),g.isMyTask?y("",!0):(m(),x("div",Ee,[j(d,{class:F(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((u=f(c).query)==null?void 0:u.view)==="userwise"?"bg-blue-500 text-white":""]),to:{query:{...f(c).query,view:"userwise"}}},{default:B(()=>e[26]||(e[26]=[A(" User Wise List ")])),_:1,__:[26]},8,["class","to"]),j(d,{class:F(["text-xs sm:text-sm btn-3 py-0.5 flex-shrink-0",((o=f(c).query)==null?void 0:o.view)!=="userwise"?"bg-blue-500 text-white":""]),to:{query:{...Object.keys(((v=f(c))==null?void 0:v.query)||{}).filter(l=>{var M;return((M=f(c))==null?void 0:M.query[l])!=="userwise"}).reduce((l,M)=>({...l,[M]:f(c).query[M]}),{})}}},{default:B(()=>e[27]||(e[27]=[A(" Department Wise List ")])),_:1,__:[27]},8,["class","to"])]))])])}}};export{Re as _};
