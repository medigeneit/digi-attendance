import{L as E,r as u,x as v,M as l}from"./index-BPxZlJG7.js";const q=E("user",()=>{const c=u([]),p=u([]),h=u([]),y=u([]),i=u({}),f=u({}),m=u({}),r=u(null),n=u(!1),w=u(new Date().toISOString().substring(0,10)),U=v(()=>c.value),b=v(()=>i.value),S=v(()=>r.value),g=async(s={})=>{var e,t;try{n.value=!0;const a=await l.get("/users",{params:s});c.value=a.data,r.value=null}catch(a){r.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong"}finally{n.value=!1}};return{users:c,handoverUsers:y,user:i,error:r,isLoading:n,allUsers:U,userLeaveTypes:h,userLeaveBalance:p,singleUser:b,errorMessage:S,dashboardInfo:m,userDashboard:f,selectedDate:w,fetchUsers:g,fetchUser:async s=>{var e,t;try{n.value=!0;const o=(await l.get(`/users/${s}`)).data;return o&&(i.value=o),r.value=null,o}catch(a){r.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong"}finally{n.value=!1}},createUser:async s=>{var e,t;try{n.value=!0;const a=await l.post("/users",s);c.value.push(a.data.user),r.value=null}catch(a){r.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong"}finally{n.value=!1}},updateUser:async(s,e)=>{var t,a;try{n.value=!0;const o=await l.put(`/users/${s}`,e),d=c.value.findIndex(D=>D.id===s);return d!==-1&&(c.value[d]=o.data.user),r.value=null,o.data.user}catch(o){r.value=((a=(t=o.response)==null?void 0:t.data)==null?void 0:a.message)||"Something went wrong"}finally{n.value=!1}},deleteUser:async s=>{var e,t;try{n.value=!0,await l.delete(`/users/${s}`),c.value=c.value.filter(a=>a.id!==s),r.value=null}catch(a){r.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong"}finally{n.value=!1}},fetchUserDashboardData:async()=>{var s,e;try{n.value=!0;const a=(await l.get("/dashboard")).data;return a&&(f.value=a),r.value=null,a}catch(t){r.value=((e=(s=t.response)==null?void 0:s.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchAdminDashboardData:async()=>{var s,e;try{n.value=!0;const a=(await l.get("/admin-dashboard")).data;return a&&(m.value=a),r.value=null,a}catch(t){r.value=((e=(s=t.response)==null?void 0:s.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchTypeWiseEmployees:async(s={})=>{var e,t;try{n.value=!0;const a=await l.get("/type-wise-employees",{params:s});c.value=a.data,r.value=null}catch(a){r.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong"}finally{n.value=!1}},fetchDepartmentWiseEmployees:async()=>{var s,e;try{n.value=!0;const t=await l.get("/department-wise-employees");return c.value=t.data,r.value=null,c.value}catch(t){r.value=((e=(s=t.response)==null?void 0:s.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchHandoverDepartmentWiseEmployees:async()=>{var s,e;try{n.value=!0;const t=await l.get("/department-handover-wise-employees");y.value=t.data,r.value=null}catch(t){r.value=((e=(s=t.response)==null?void 0:s.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchUsersExcelExport:async s=>{var e,t;try{n.value=!0;const a=await l.get("/users",{params:{flag:"excel",company_id:s.data.company_id,department_id:s.data.department_id,line_type:s.data.line_type,status:s.data.status},responseType:"blob"}),o=window.URL.createObjectURL(new Blob([a.data])),d=document.createElement("a");d.href=o,d.setAttribute("download","users.xlsx"),document.body.appendChild(d),d.click(),d.remove(),r.value=null}catch(a){r.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong"}finally{n.value=!1}},saveLeaveBalances:async(s,e)=>{try{return n.value=!0,(await l.post(`/leave-balances/${s}`,{balances:e})).data}catch(t){throw console.error("Failed to save leave balances:",t),t}finally{n.value=!1}},fetchUserLeaveBalances:async s=>{try{const e=await l.get(`/user-leave-balance/${s}`);return p.value=e.data,e.data}catch(e){console.error("Failed to fetch balances",e)}},fetchUserLeaveTypes:async s=>{try{const e=await l.get(`/leave-balances/${s}`);return h.value=e.data,e.data}catch(e){console.error("Failed to fetch balances",e)}},updateOrCreateWeekend:async(s,e)=>{var t,a;try{const o=await l.post(`/employee/weekend/update-or-create/${s}`,{selected_weekend:e});return g(),o.data.message}catch(o){throw new Error(((a=(t=o.response)==null?void 0:t.data)==null?void 0:a.message)||o.message)}},fetchUserWeekends:async s=>{var e,t;try{const a=await l.get(`/employee/weekends/${s}`);return(a==null?void 0:a.data)??a}catch(a){r.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong"}},fetchUserShifts:async s=>{var e,t;try{const a=await l.get(`/employee/${s}/shift-history`);return(a==null?void 0:a.data)??a}catch(a){r.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||"Something went wrong"}}}});export{q as u};
