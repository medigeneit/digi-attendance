import{d as _t,b as W,m as U,r as B,c as l,o,a as s,g as y,L as K,F as L,k as a,w as F,t as v,p as g,i as C,z,f as $,h as bt,B as vt,q as ht,y as V,j as A,u as wt,e as Tt,A as mt,n as kt,x as H,I as Ct}from"./index-C1bkql9t.js";import{L as ct}from"./LoaderView-Zi2oAX2g.js";import{O as E}from"./OverlyModal-CN1BNUNZ.js";import{_ as $t}from"./DescriptionView-DmwlcxKP.js";import{m as St}from"./task-tree-wODDhwOu.js";import{_ as It}from"./SearchInput-D9o4WMz1.js";import{_ as At}from"./TaskAddForm-OtWXzWiW.js";import{_ as Lt}from"./TaskEditForm-CuRlKWMR.js";import{_ as Pt}from"./TaskTreeView-CBHo0gGk.js";import{_ as Ut}from"./DraggableList.vue_vue_type_script_setup_true_lang-DnvRRnLp.js";import{u as Mt}from"./task-priority-Dted0F2j.js";import{_ as Dt}from"./TaskUserAssignForm-DxUpsK69.js";import{b as Bt,T as Et,a as Nt}from"./TaskUrgentBadge-hKfxDHgP.js";import{_ as qt,a as jt,b as Ot}from"./TaskStatusManager-vVQ7zVJO.js";import{b as ft,d as Rt}from"./datetime-Efw590t9.js";import{_ as yt}from"./UserChip-CSeAmB_a.js";import{a as Vt}from"./TaskAssignedUsers-BVYAw-A3.js";import{_ as Ft}from"./TaskSupervisorAndEmployee-DJtj1WFj.js";import{s as gt}from"./dom-BKn8Ftnz.js";import{u as Ht}from"./useTaskStore-CWLIiIwg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./RequiredIcon-BDA5Sbl1.js";import"./company-BdLT_OVZ.js";import"./url-CePbr-gY.js";import"./CompanyDepartmentSelectInput-BTVezkTl.js";import"./SelectDropdown-DHwlNTVv.js";import"./SectionLoading-2j8Gclhf.js";import"./TextWithHr-cERRTcj_.js";import"./TaskUrgencyInput-BlKnEFNE.js";import"./tags-BrINPR_b.js";import"./MultiselectDropdown-aOvTGvyn.js";import"./MultiselectDropdown.vue_vue_type_style_index_0_lang-C49UNmET.js";import"./user-idbIKP8h.js";import"./TaskUserChip-ZxUqMbEP.js";import"./TaskTitle-BLz8WkeH.js";import"./task-DwjhQQ-w.js";import"./requirement-D_7sZsna.js";const zt={class:"mb-3"},Kt={key:0,class:"flex gap-2 items-center mx-auto justify-center mb-2"},Wt={key:1,class:"text-center py-4 text-gray-500"},Gt={key:2,class:"text-center py-4 text-red-500"},Jt={key:3,class:"space-y-4"},Qt={__name:"TaskList",props:{tasks:{default:null,type:Array},loading:{default:!1,type:Boolean},error:{default:"",type:String},parentId:{type:Number,default:0},treeLevel:{type:Number,required:!0}},emits:["commentButtonClick","editClick","addClick","updatePriority"],setup(m,{emit:t}){const n=m,f=_t(),x=W(),k=U(()=>{var M;return!!(((M=f==null?void 0:f.user)==null?void 0:M.role)!=="employee"&&(f!=null&&f.isAdminMood))}),b=t,p=B(null),{handleItemsPriorityUpdate:r,saveTaskPriority:c,listHasRearranged:_}=Mt(()=>n.tasks,n.parentId),S=async()=>{await c(),b("updatePriority")};return(M,h)=>(o(),l("div",null,[s("div",zt,[K(M.$slots,"task:header")]),k.value?(o(),l(L,{key:0},[a(_)?(o(),l("div",Kt,[h[4]||(h[4]=s("span",{class:"text-red-500"},"Priority Changed",-1)),s("button",{class:"btn-3",onClick:F(S,["prevent"])},"Save"),s("button",{class:"btn-3",onClick:h[0]||(h[0]=F((...D)=>p.value.resetItems&&p.value.resetItems(...D),["prevent"]))},"Discard")])):y("",!0)],64)):y("",!0),m.loading?(o(),l("div",Wt,"Loading tasks...")):m.error?(o(),l("div",Gt,v(m.error),1)):(o(),l("div",Jt,[g(Ut,{items:m.tasks,handle:"handle",onItemsUpdate:a(r),class:"rounded-lg bg-white overflow-hidden space-y-3",ref_key:"draggableTaskList",ref:p},{item:C(({item:D,index:N})=>[g(Pt,{isMyTask:a(x).name=="MyTaskShow",index:N,task:D,showDraggableHandle:k.value,"tree-level":m.treeLevel,class:"!border-0",onCommentButtonClick:w=>b("commentButtonClick",D.id),onEditClick:h[1]||(h[1]=w=>b("editClick",w)),onAddClick:h[2]||(h[2]=w=>b("addClick",w)),onEmployeeAssignClick:h[3]||(h[3]=w=>b("employeeAssignClick",w))},null,8,["isMyTask","index","task","showDraggableHandle","tree-level","onCommentButtonClick"])]),_:1},8,["items","onItemsUpdate"])]))]))}},Xt={class:"flex justify-between mt-5"},Yt={class:"flex justify-between items-center gap-4"},Zt={class:"w-32 relative h-8 mx-4"},te={key:0,class:"flex flex-wrap items-center gap-2 mt-3"},ee={key:3,class:"border p-4 rounded text-center text-gray-500 italic"},se={__name:"SubTaskList",props:{subTasks:Array,parentId:{type:Number,required:!0},treeLevel:{type:Number,required:!0},subTaskIsCreatable:{type:Boolean,default:!0}},emits:["created","error","updatePriority","assignUser"],setup(m,{emit:t}){const n=m,f=W(),x=_t(),k=B(""),b=B(""),p=z({taskId:0,isOpen:!1}),r=t,c=B(),_=z({show:!1,parentId:n.parentId,requirementId:null}),S=I=>{_.show=!0,_.parentId=I};function M(){_.show=!1,_.parentId=n.parentId,r("created")}function h(){r("assignUser")}function D(){c.value=!1,r("updated")}function N(){_.show=!1,_.parentId=n.parentId}const w=U(()=>{var I;return Array.isArray(n.subTasks)?St(n.subTasks,{status:b.value,...f.name=="MyTaskShow"?{"user-ids":(I=x==null?void 0:x.user)==null?void 0:I.id}:{}}).filter(d=>{var u,e,T;return k.value?(T=(u=d==null?void 0:d.title)==null?void 0:u.toUpperCase())==null?void 0:T.includes((e=k.value)==null?void 0:e.toUpperCase()):!0}):[]});return(I,d)=>{var u;return o(),l("div",null,[c.value?(o(),$(E,{key:0},{default:C(()=>[g(Lt,{taskId:c.value,onClose:d[0]||(d[0]=e=>c.value=null),onUpdated:D},null,8,["taskId"])]),_:1})):y("",!0),_.show?(o(),$(E,{key:1},{default:C(()=>[g(At,{parentTaskId:_.parentId,requirementId:_.requirementId,onTaskCreated:M,onError:I.handleTaskError,onClose:N},null,8,["parentTaskId","requirementId","onError"])]),_:1})):y("",!0),p.isOpen?(o(),$(E,{key:2},{default:C(()=>[g(Dt,{taskId:p.taskId,onCancelClick:d[1]||(d[1]=()=>{p.isOpen=!1,p.taskId=0}),onSuccess:d[2]||(d[2]=()=>{p.isOpen=!1,p.taskId=0,h()})},null,8,["taskId"])]),_:1})):y("",!0),g(Qt,{tasks:w.value,parentId:m.parentId,treeLevel:m.treeLevel,onAddClick:d[6]||(d[6]=e=>S(e)),onEditClick:d[7]||(d[7]=e=>c.value=e),onUpdatePriority:d[8]||(d[8]=e=>r("updatePriority")),onEmployeeAssignClick:d[9]||(d[9]=e=>{p.taskId=e,p.isOpen=!0})},{"task:header":C(()=>{var e;return[s("div",Xt,[s("div",Yt,[d[12]||(d[12]=s("h2",{class:"text-xl font-semibold text-gray-800"},"Sub Tasks",-1)),((e=n==null?void 0:n.subTasks)==null?void 0:e.length)>0?(o(),l(L,{key:0},[g(It,{modelValue:k.value,"onUpdate:modelValue":d[3]||(d[3]=T=>k.value=T),class:"w-full md:w-48 md:ml-auto h-8","debounce-time":0},null,8,["modelValue"]),s("div",Zt,[d[11]||(d[11]=s("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),bt(s("select",{"onUpdate:modelValue":d[4]||(d[4]=T=>b.value=T),class:"h-8 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},d[10]||(d[10]=[s("option",{value:""},"--ALL TASKS--",-1),s("option",{value:"not-completed"},"Not Completed",-1),s("option",{value:"only-completed"},"Completed",-1)]),512),[[vt,b.value]])])],64)):y("",!0)]),m.subTaskIsCreatable?(o(),l("div",te,[s("button",{class:"btn-1 ml-auto",onClick:d[5]||(d[5]=F(()=>S(m.parentId),["prevent"]))}," Add Sub Task ")])):y("",!0)])]}),_:1},8,["tasks","parentId","treeLevel"]),((u=w.value)==null?void 0:u.length)===0&&m.treeLevel<=2?(o(),l("div",ee," No Sub Tasks ")):y("",!0)])}}},ae=m=>m==null?void 0:m.reduce((t,n)=>t+n.task_weight,0),xt=(m,t)=>{const n=ae(m);return m.map(f=>{const x=t.filter(k=>k.user_id===f.id).reduce((k,b)=>k+b.progress,0);return{...f,task_progress:Math.floor(x*(f.task_weight/n)),user_progress:x}})},oe=(m,t)=>{let n=0;const f=[],x=p=>p.status==="COMPLETED",k=p=>p.users.some(r=>r.id===t),b=(p,r)=>{p.forEach(c=>{const _=k(c);f[r]=f[r]||{user_id:t,total_assigned:0,total_assigned_on_leaf_task:0,completed_count:0};const S=_&&c.children_tasks.length===0;f[r].total_assigned+=_?1:0,f[r].total_assigned_on_leaf_task+=S?1:0,n+=S?1:0,_&&x(c)&&(f[r].completed_count++,c.children_tasks.length),c.children_tasks.length>0&&b(c.children_tasks,r+1)})};return b(m,0),{sub_task_infos:f,assigned_on_any_leaf_task:n>0}},ne=(m,t)=>m.map(n=>({...n,...oe(t,n.id)})),re={key:0,class:"min-w-full bg-white rounded overflow-hidden"},le={class:"py-0.5 text-bg font-semibold"},ie={class:"bg-gray-50"},de={class:"px-2 py-1 border-y"},ue={class:"px-2 py-1 border-y"},pe={key:0,class:"text-sm text-gray-400"},me={key:1},ke={key:1,class:"min-w-full bg-white rounded overflow-hidden"},ce={class:"py-0.5 text-bg font-semibold"},fe={class:"px-2 py-1 border-y text-center"},ye={class:"px-2 py-1 border-y border-r"},ge={class:"px-2 py-1 border-y text-center"},_e={class:"px-2 py-1 border-y text-center"},xe=ht({__name:"TaskProgressTable",props:{task:{},subTasks:{}},setup(m){const t=m,n=U(()=>xt(t.task.users,t.task.task_reports||[])),f=U(()=>ne(t.task.users,t.subTasks));return(x,k)=>{var b,p;return t.task.children_task_count>0?(o(),l("table",re,[s("caption",le,[K(x.$slots,"caption",{},()=>[k[0]||(k[0]=A("Progress"))])]),s("thead",ie,[s("tr",null,[k[1]||(k[1]=s("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-left"},"#",-1)),k[2]||(k[2]=s("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-left lg:w-[200px]"}," User ",-1)),(o(!0),l(L,null,V(((p=(b=f.value[0]||{})==null?void 0:b.sub_task_infos)==null?void 0:p.length)||1,r=>(o(),l("th",{key:r,class:"px-2 py-1 border-y font-semibold text-xs uppercase text-center"},v(r===1?"Completed Sub Task":"")+" "+v(r===2?"Completed Sub Sub Task":"")+" "+v(r===3?"Completed Sub Sub Sub Task":""),1))),128))])]),s("tbody",null,[(o(!0),l(L,null,V(f.value,(r,c)=>(o(),l("tr",{key:r.id,class:"border-t hover:bg-gray-50 cursor-pointer"},[s("td",de,v(c+1),1),s("td",ue,[g(yt,{user:r},null,8,["user"])]),(o(!0),l(L,null,V(r.sub_task_infos,(_,S)=>(o(),l("td",{class:"px-2 py-1 border-y text-center",key:S},[_.total_assigned===0||!r.assigned_on_any_leaf_task?(o(),l("div",pe," Not Assigned To Any Task ")):(o(),l("div",me,v(_.completed_count)+" / "+v(_.total_assigned),1))]))),128))]))),128))])])):(o(),l("table",ke,[s("caption",ce,[K(x.$slots,"caption",{},()=>[k[3]||(k[3]=A("Progress"))])]),k[4]||(k[4]=s("thead",{class:"bg-gray-50"},[s("tr",null,[s("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase w-[50px] text-center"},"#"),s("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-left sm:w-[250px] mx:w-[300px] border-r"}," User "),s("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-center"},"Started"),s("th",{class:"px-2 py-1 border-y font-semibold text-xs uppercase text-center"},"Finished")])],-1)),s("tbody",null,[(o(!0),l(L,null,V(n.value,(r,c)=>(o(),l("tr",{key:r.id,class:"border-t hover:bg-gray-50 cursor-pointer"},[s("td",fe,v(c+1),1),s("td",ye,[g(yt,{user:r},null,8,["user"])]),s("td",ge,v(a(ft)(r.task_started_at)),1),s("td",_e,v(a(ft)(r.task_finished_at)),1)]))),128))])]))}}}),be={class:"container mx-auto p-6"},ve={key:3,class:"max-w-8xl min-h-64 mx-auto bg-white shadow-lg rounded-lg p-6 relative"},he={key:0,class:"text-sm mb-2 border-b","aria-label":"Breadcrumb"},we={class:"flex items-center gap-2"},Te={key:0,"aria-hidden":"true",class:"text-gray-400 text-base"},Ce=["title"],$e={key:1,class:"text-gray-900 font-medium line-clamp-1","aria-current":"page"},Se={class:"grid grid-cols-4"},Ie={class:"mb-4 flex col-span-full"},Ae={class:"font-medium text-xl"},Le={class:"flex items-center gap-3 text-xs text-gray-500 mt-2 opacity-80 text-left"},Pe={key:0,class:"text-white bg-green-700 text-[12px] uppercase px-2 py-[2px] rounded-full border border-green-200 opacity-80"},Ue={class:"font-semibold"},Me={class:"mt-2 col-span-full flex items-center"},De={class:"text-gray-400 text-xs"},Be={class:"flex items-center gap-0.5"},Ee={class:"text-sky-400 text-sm font-semibold"},Ne={class:"text-right col-span-full md:col-span-1 ml-auto flex items-start justify-center gap-4 !text-lg"},qe={class:"col-span-full mb-4"},je=["innerHTML"],Oe={key:0,class:"mt-4 col-span-full mb-6"},Re={class:"mt-2 py-2 flex flex-col lg:flex-row gap-y-4 justify-center items-center gap-2 col-span-full"},Ve={class:"flex items-center gap-4 flex-wrap justify-center"},Fe=["disabled"],He={class:"lg:ml-auto flex gap-4 items-center"},ze={key:1},Ke={key:3},We={key:1,class:"text-center py-4 text-red-500"},Ps={__name:"TaskShow",setup(m){const t=Ht(),n=W(),f=wt(),x=B(""),k=U(()=>t.tasks),b=B({}),p=z({open:!1,task:null});Tt(async()=>{x.value="loading",await c(n.params.id),x.value="",n.hash=="#sub-tasks"&&setTimeout(()=>gt(n.hash,66),0)});const r=z({user:null,type:""});async function c(u){await t.fetchTask(u)}const _=U(()=>xt(t.task.users,t.task.task_reports||[]));async function S(){await c(n.params.id),r.user=null,r.type=""}const M=u=>{f.push({name:"TaskEdit",params:{id:u}})},h=U(()=>{var u,e;return t.task?((u=t.task)==null?void 0:u.parent_id)==0?{name:w.value?"MyTaskList":"TaskList"}:{params:{id:(e=t.task)==null?void 0:e.parent_id},query:{"is-my-task":w.value}}:null});function D(){p.open=!0,p.task=t.task}function N(){p.open=!1,console.log({STATE:"Deleted",backLink:h.value}),f.push(h.value)}const w=U(()=>n.name=="MyTaskShow"||!!n.query["is-my-task"]),I=(u,e=!1)=>({id:u==null?void 0:u.id,title:u==null?void 0:u.title,status:u==null?void 0:u.status,is_current_page:e}),d=U(()=>{var e,T,q,j,O,R;const u=[];return(e=t==null?void 0:t.task)!=null&&e.parent&&(u.push(I((T=t.task)==null?void 0:T.parent)),(j=(q=t==null?void 0:t.task)==null?void 0:q.parent)!=null&&j.parent&&u.push(I((R=(O=t.task)==null?void 0:O.parent)==null?void 0:R.parent))),[...u.reverse(),I(t.task,!0)]});return mt(()=>n.params.id,async u=>{x.value="changing",await c(u),x.value=""}),mt(()=>n.hash,async function(){setTimeout(()=>gt(n.hash,66),0)}),(u,e)=>{var j,O,R,G,J,Q,X,Y,Z,tt,et,st,at,ot,nt,rt,lt,it,dt,ut,pt;const T=kt("RouterLink"),q=kt("router-view");return o(),l("div",be,[r.user?(o(),$(E,{key:0},{default:C(()=>[g(qt,{task:a(t).task,user:r.user,type:r.type,onCloseClick:e[0]||(e[0]=i=>r.user=null),onUpdateDate:S},null,8,["task","user","type"])]),_:1})):y("",!0),p.open?(o(),$(E,{key:1},{default:C(()=>[g(jt,{onCloseClick:e[1]||(e[1]=i=>p.open=!1),task:p.task,onDelete:N},null,8,["task"])]),_:1})):y("",!0),x.value==="loading"?(o(),$(ct,{key:2})):(o(),l("div",ve,[a(t).task?(o(),l(L,{key:0},[d.value.length>1?(o(),l("nav",he,[s("ol",we,[(o(!0),l(L,null,V(d.value,(i,P)=>(o(),l(L,{key:i.id},[P>0?(o(),l("li",Te,"/")):y("",!0),s("li",{title:i==null?void 0:i.title,class:"text-gray-600 line-clamp-1"},[i.is_current_page?(o(),l("span",$e,v(i==null?void 0:i.title),1)):(o(),$(T,{key:0,to:`${w.value?"/my-tasks":"/tasks"}/${i.id}`,class:H(["hover:text-gray-900 hover:underline transition",{"line-clamp-1 text-justify":P>0,"whitespace-nowrap":P===0}])},{default:C(()=>[A(v(i==null?void 0:i.title),1)]),_:2},1032,["to","class"]))],8,Ce)],64))),128))])])):y("",!0),s("section",Se,[s("div",Ie,[s("div",null,[s("h2",Ae,v(a(t).task.title),1),s("div",Le,[a(t).task.parent_id==0?(o(),l("div",Pe," MAIN TASK ")):y("",!0),s("div",Ue,"#"+v((j=a(t).task)==null?void 0:j.serial),1),(O=a(t).task)!=null&&O.is_important?(o(),$(Et,{key:1})):y("",!0),(R=a(t).task)!=null&&R.is_urgent?(o(),$(Nt,{key:2})):y("",!0)]),s("div",Me,[s("div",De,[e[13]||(e[13]=s("i",{class:"fas fa-clock"},null,-1)),A(" "+v(a(Rt)(a(t).task.created_at)),1)]),(G=a(t).task)!=null&&G.created_by_user?(o(),l(L,{key:0},[e[14]||(e[14]=s("span",{class:"text-sm text-gray-600 ml-4"},"By",-1)),s("div",Be,[g(Ct,{user:(J=a(t).task)==null?void 0:J.created_by_user,class:"ml-1",size:"xsmall"},null,8,["user"]),s("div",Ee,v((X=(Q=a(t).task)==null?void 0:Q.created_by_user)==null?void 0:X.label),1)])],64)):y("",!0)])]),s("div",Ne,[g(Vt,{status:(Y=a(t).task)==null?void 0:Y.status,progressPercent:(Z=a(t).task)==null?void 0:Z.progress_percent,class:"h-6 !text-lg"},null,8,["status","progressPercent"]),a(t).task?(o(),$(Bt,{key:0,task:a(t).task,ref_key:"progress",ref:b,class:"!text-lg"},null,8,["task"])):y("",!0)])]),s("div",qe,[g($t,null,{default:C(()=>{var i;return[s("p",{innerHTML:(i=a(t).task)==null?void 0:i.description,class:"text-justify"},null,8,je)]}),_:1})]),g(Ft,{task:(tt=a(t))==null?void 0:tt.task,"tree-level":(st=(et=a(t))==null?void 0:et.task)==null?void 0:st.level,class:"justify-center border col-span-full border-dashed rounded-lg"},null,8,["task","tree-level"]),a(t).task.children_task_count>0?(o(),l("section",Oe,[g(xe,{"task-users":((at=a(t).task)==null?void 0:at.users)||[],task:a(t).task,"sub-tasks":a(t).tasks,"progress-users":_.value},{caption:C(()=>e[15]||(e[15]=[s("div",{class:"text-sm py-1 text-left uppercase font-semibold text-gray-600"}," Assigned Users ",-1)])),_:1},8,["task-users","task","sub-tasks","progress-users"])])):y("",!0),(ot=a(t))!=null&&ot.task?(o(),$(Ot,{key:1,task:((nt=a(t))==null?void 0:nt.task)||{},class:"col-span-full mt-4",onUpdateStatus:e[2]||(e[2]=()=>{var i,P;return c((P=(i=a(t))==null?void 0:i.task)==null?void 0:P.id)})},null,8,["task"])):y("",!0),s("div",Re,[s("div",Ve,[s("button",{onClick:e[3]||(e[3]=F(i=>{var P;return M((P=a(t).task)==null?void 0:P.id)},["stop"])),class:"btn-2 py-0.5 disabled:opacity-30 disabled:pointer-events-none",disabled:!!a(t).task.closed_at},e[16]||(e[16]=[s("i",{class:"fas fa-edit"},null,-1),A(" Edit ")]),8,Fe),g(T,{to:{name:"TaskUserAssign",params:{id:(rt=a(t).task)==null?void 0:rt.id}},class:H(["bg-indigo-500 hover:bg-indigo-600 text-white font-semibold px-3 py-0.5 rounded-full transition whitespace-nowrap",a(t).task.closed_at?"opacity-30 pointer-events-none":""]),onClick:e[4]||(e[4]=i=>i.stopPropagation())},{default:C(()=>e[17]||(e[17]=[s("i",{class:"fas fa-users-cog"},null,-1),A(" Assign Users ")])),_:1,__:[17]},8,["to","class"]),s("button",{class:"border-2 border-indigo-500 hover:bg-indigo-500 hover:text-white text-indigo-500 font-semibold px-3 py-0.5 rounded-full transition disabled:opacity-30 disabled:pointer-events-none whitespace-nowrap",onClick:e[5]||(e[5]=i=>a(f).back())},e[18]||(e[18]=[s("i",{class:"fas fa-arrow-left"},null,-1),A(" Back ")])),g(T,{to:h.value,class:"border-2 border-indigo-500 hover:bg-indigo-500 hover:text-white ml-2 text-indigo-500 font-semibold px-3 py-0.5 rounded-full transition disabled:opacity-30 disabled:pointer-events-none whitespace-nowrap",onClick:e[6]||(e[6]=i=>i.stopPropagation())},{default:C(()=>e[19]||(e[19]=[s("i",{class:"fas fa-arrow-left"},null,-1),A(" Parent Task ")])),_:1,__:[19]},8,["to"])]),s("div",He,[((lt=a(t).task)==null?void 0:lt.children_task_count)===0&&((it=a(t).task)==null?void 0:it.status)==="PENDING"?(o(),l("button",{key:0,class:"btn-2-red h-8",onClick:F(D,["prevent"])}," Delete ")):y("",!0),k.value.length>0?(o(),$(T,{key:1,to:{name:w.value||a(n).query["is-my-task"]?"MyTaskShow":"TaskShow",params:{id:(dt=a(t).task)==null?void 0:dt.id},hash:"#sub-tasks"},onClick:e[7]||(e[7]=i=>i.stopPropagation()),class:H(["py-0.5 btn-3 ml-auto text-sm h-8 whitespace-nowrap",{"bg-blue-500 text-white":a(n).name=="TaskShow"||a(n).name==="MyTaskShow"}])},{default:C(()=>e[20]||(e[20]=[s("i",{class:"fal fa-list-ul"},null,-1),A(" Sub Tasks ")])),_:1,__:[20]},8,["to","class"])):y("",!0),g(T,{to:{name:"TaskReports",params:{id:(ut=a(t).task)==null?void 0:ut.id},query:{"is-my-task":w.value},hash:"#task-reports"},onClick:e[8]||(e[8]=i=>i.stopPropagation()),class:H(["py-0.5 btn-3 text-sm h-8",{"bg-blue-500 text-white":a(n).name=="TaskReports"}])},{default:C(()=>e[21]||(e[21]=[s("i",{class:"fal fa-file-alt"},null,-1),A(" Reports ")])),_:1,__:[21]},8,["to","class"])])])]),e[22]||(e[22]=s("div",{id:"sub-tasks"},null,-1)),(a(n).name=="TaskShow"||a(n).name==="MyTaskShow")&&((pt=a(t).task)==null?void 0:pt.level)<=2?(o(),l("section",ze,[g(se,{subTasks:k.value,"parent-id":a(n).params.id,"sub-task-is-creatable":!a(t).task.closed_at,"tree-level":a(t).task.level+1,onCreated:e[9]||(e[9]=i=>c(a(n).params.id)),onUpdated:e[10]||(e[10]=i=>c(a(n).params.id)),onUpdatePriority:e[11]||(e[11]=i=>c(a(n).params.id)),onAssignUser:e[12]||(e[12]=i=>c(a(n).params.id))},null,8,["subTasks","parent-id","sub-task-is-creatable","tree-level"])])):y("",!0),a(n).name==="TaskReportAdd"?(o(),$(E,{key:2,class:"*:bg-transparent"},{default:C(()=>[g(q)]),_:1})):(o(),l("section",Ke,[g(q)]))],64)):(o(),l("div",We,v(a(t).error),1)),x.value==="changing"?(o(),$(ct,{key:2,class:"absolute bg-opacity-80 inset-0 z-20"})):y("",!0)]))])}}};export{Ps as default};
