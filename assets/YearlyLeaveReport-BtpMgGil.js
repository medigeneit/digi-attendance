import{_ as it,u as dt,f as rt,D as ut,r as M,x as j,q as te,y as pt,c as d,o as r,a as s,k as N,t as i,d as me,m as ct,s as se,l as Ne,b as ye,P as mt,G as yt,n as p,O as Re,F as _,e as P}from"./index-9P-p50Eq.js";import{_ as xt}from"./EmployeeFilter-CApyhe4B.js";import{_ as vt}from"./FlexibleDatePicker-CNL3OPO6.js";import{L as bt}from"./LoaderView-CMP8l6LO.js";import{u as _t,E as xe,a as ve}from"./jspdf.plugin.autotable-B0il281i.js";import{S as ft}from"./sweetalert2.esm.all-5zhdP7Ax.js";import"./company-DmOZ7OWz.js";import"./department-yeNxoq9p.js";import"./EmployeeDropdownInput-CUlH_F7G.js";import"./SelectDropdown-9SVXVpNT.js";import"./UserChip-CAud_YYc.js";import"./user-C34LOgby.js";const gt={class:"w-full min-w-0 space-y-3 px-3 md:px-4"},ht={class:"flex flex-wrap items-center justify-between gap-2"},kt={class:"min-w-0 flex-1 text-center"},Lt={class:"text-[11px] text-slate-500 truncate"},Ct={class:"flex items-center gap-2"},Pt=["disabled"],St=["disabled"],$t={class:"rounded-2xl bg-white shadow-sm"},Dt={class:"p-3"},Et={class:"flex flex-wrap gap-2 border-t border-gray-200 px-3 py-2"},Ut={class:"inline-flex items-center gap-2 rounded-xl border bg-slate-50 px-3 py-2 text-[11px] font-semibold text-slate-700"},Yt={class:"flex items-center gap-2"},Tt={key:0,class:"rounded-2xl border bg-white shadow-sm p-6 text-center"},Mt={key:1,class:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-rose-700"},Nt={key:2,class:"space-y-3"},Rt={key:0,class:"rounded-2xl border bg-white shadow-sm overflow-hidden"},Bt={class:"flex flex-wrap items-center justify-between gap-2 border-b border-slate-300 bg-slate-50 px-4 py-3"},Vt={class:"flex flex-wrap items-center gap-2"},Ft={key:0,class:"text-[11px] font-semibold rounded-full bg-indigo-100 text-indigo-700 px-3 py-1 border border-ink"},qt={key:1,class:"text-[11px] rounded-full bg-amber-100 text-amber-700 px-3 py-1 border border-ink"},At={class:"text-[11px] text-slate-500"},Wt={class:"overflow-x-auto max-w-[calc(100vw-18rem)]"},jt={class:"text-[10px] uppercase tracking-wide text-slate-500"},zt={class:"bg-slate-100"},Ot=["colspan"],It={class:"bg-slate-100"},Qt=["title"],Gt={class:"divide-y divide-ink-soft"},Ht=["onClick"],Jt={class:"sticky-col sticky-col--sl px-3 py-2 font-bold"},Kt={class:"sticky-col sticky-col--emp px-3 py-2"},Xt={class:"font-semibold text-slate-800 leading-5 truncate max-w-[260px]"},Zt={class:"text-[10px] text-slate-500 leading-4 line-clamp-2 max-w-[260px]"},wt={key:0},es=["colspan"],ts={key:0,class:"flex items-center justify-between gap-2 border-t border-ink px-4 py-3"},ss={class:"text-[11px] text-slate-500"},as={class:"flex items-center gap-2"},ls=["disabled"],ns=["disabled"],os={key:1,class:"rounded-2xl border border-ink-strong bg-white shadow-sm overflow-hidden"},is={class:"flex flex-wrap items-center justify-between gap-2 border-b border-ink bg-slate-50 px-4 py-3"},ds={class:"text-[11px] text-slate-500"},rs={class:"table-scroll"},us={class:"text-[10px] uppercase tracking-wide text-slate-500"},ps={class:"bg-slate-100"},cs=["colspan"],ms={class:"bg-slate-100"},ys=["title"],xs={class:"divide-y divide-ink-soft"},vs={class:"sticky-col sticky-col--sl px-3 py-2 font-bold"},bs={class:"sticky-col sticky-col--emp px-3 py-2"},_s={class:"font-semibold text-slate-800 leading-5 truncate max-w-[260px]"},fs={class:"text-[10px] text-slate-500 leading-4 line-clamp-2 max-w-[260px]"},gs={key:0},hs=["colspan"],ks={key:0,class:"flex items-center justify-between gap-2 border-t border-ink px-4 py-3"},Ls={class:"text-[11px] text-slate-500"},Cs={class:"flex items-center gap-2"},Ps=["disabled"],Ss=["disabled"],$s={key:3,class:"fixed inset-0 z-[60]"},Ds={class:"absolute left-1/2 top-1/2 w-[95vw] max-w-2xl -translate-x-1/2 -translate-y-1/2 rounded-2xl bg-white shadow-xl overflow-hidden border border-ink-strong"},Es={class:"flex items-start justify-between gap-3 border-b border-ink bg-slate-50 px-4 py-3"},Us={class:"min-w-0"},Ys={class:"text-sm font-semibold text-slate-800 truncate"},Ts={class:"text-xs text-slate-500 truncate"},Ms={class:"p-4 space-y-4"},Ns={class:"rounded-2xl border border-ink-strong bg-white p-4"},Rs={class:"flex items-start justify-between gap-3"},Bs={class:"text-right"},Vs={class:"text-base font-bold text-indigo-700 tabular-nums"},Fs={class:"text-[11px] text-slate-500 tabular-nums"},qs={class:"mt-3 grid grid-cols-3 gap-2"},As={class:"rounded-xl bg-slate-50 px-3 py-2"},Ws={class:"text-lg font-bold text-slate-800 tabular-nums"},js={class:"rounded-xl bg-slate-50 px-3 py-2"},zs={class:"text-lg font-bold text-emerald-700 tabular-nums"},Os={class:"rounded-xl bg-slate-50 px-3 py-2"},Is={class:"text-lg font-bold text-slate-800 tabular-nums"},Qs={class:"rounded-2xl border border-ink-strong overflow-hidden"},Gs={class:"table-scroll"},Hs={class:"min-w-full text-sm"},Js={class:"divide-y divide-ink-soft"},Ks={class:"px-4 py-2 font-semibold text-slate-800"},Xs={class:"px-4 py-2 text-right tabular-nums"},Zs={class:"px-4 py-2 text-right tabular-nums"},ws={class:"px-4 py-2 text-right font-semibold tabular-nums"},ea={class:"bg-slate-50 border-t border-ink-soft"},ta={class:"px-4 py-2 text-right font-bold tabular-nums"},sa={class:"px-4 py-2 text-right font-bold tabular-nums text-emerald-700"},aa={class:"px-4 py-2 text-right font-bold tabular-nums"},la={key:0},Be=56,Ve=280,na={__name:"YearlyLeaveReport",setup(oa){const be=dt(),$=rt(),_e=_t(),{isLoading:Fe,error:fe,selectedYear:ge,pagination:x,companyReports:D,filters:qe}=ut(_e),ae=new Date().getFullYear(),c=(e,t="—")=>e==null||e===""?t:e,U=e=>{const t=Number(e);return Number.isFinite(t)?t:0},he=e=>{const t=Number(e);return!t||t<2e3||t>2100?String(ae):String(t)},b=M(he($.query.year||ge.value)),le=M({year:Number(b.value)}),u=M({company_id:$.query.company_id||"",department_id:$.query.department_id||"all",line_type:$.query.line_type||"all",employee_id:$.query.employee_id||""}),z=M($.query.include_pending?$.query.include_pending==="1":!0),O=M(Number($.query.per_page||25)),L=M(Number($.query.page||1)),ne=j(()=>!!u.value.company_id&&!!b.value),Y=M($.query.part==="part2"?"part2":"part1"),oe=()=>{ft.fire({icon:"warning",title:"Missing Selection!",text:"Please select Company and Year first!",confirmButtonText:"OK"})},G=()=>{be.replace({query:{...$.query,company_id:u.value.company_id||"",department_id:u.value.department_id||"all",line_type:u.value.line_type||"all",employee_id:u.value.employee_id||"",year:b.value,include_pending:z.value?"1":"0",per_page:String(O.value),page:String(L.value),part:Y.value}})},Ae=()=>{const e={company_id:u.value.company_id,department_id:u.value.department_id,line_type:u.value.line_type,year:Number(b.value),include_pending:z.value?1:0,per_page:O.value,page:L.value};return u.value.employee_id&&(e.user_id=u.value.employee_id),e},ie=async()=>{ne.value&&await _e.fetchYearlyLeaveReport(Ae())},We=async()=>{L.value=1,G(),await ie()};te(le,e=>{if(!(e!=null&&e.year))return;const t=he(e.year);b.value!==t&&(b.value=t)},{deep:!0}),te(b,async e=>{ge.value=e,L.value=1,G(),await ie()},{immediate:!0}),te(()=>[z.value,O.value,L.value],async()=>{G(),await ie()}),te(Y,()=>{G()});const R=j(()=>{const e=Number(b.value||ae);return Array.from({length:12},(t,o)=>`${e}-${String(o+1).padStart(2,"0")}`)}),de=e=>{const[,t]=e.split("-");return["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][Number(t)-1]},B=[{key:"CL",label:"CL"},{key:"ML",label:"ML"},{key:"SPECIAL LEAVE",label:"SL"},{key:"WITHOUT PAY LEAVE(WPL)",label:"WPL"}],H=(e,t,o)=>{var n;const l=(n=e==null?void 0:e.months)==null?void 0:n[t];return l?U((l==null?void 0:l[o])??0):0},je=e=>Number(e)===0?"text-slate-300":"text-slate-700 font-semibold",A=e=>{var t,o,l,n,m;return{name:c((t=e==null?void 0:e.user)==null?void 0:t.name,"Unknown"),meta:`${c((o=e==null?void 0:e.user)==null?void 0:o.department,"")}${(l=e==null?void 0:e.user)!=null&&l.department&&((n=e==null?void 0:e.user)!=null&&n.designation)?" • ":""}${c((m=e==null?void 0:e.user)==null?void 0:m.designation,"")}`}},v={CL:"CL",ML:"ML",SL:"SPECIAL LEAVE",WPL:"WITHOUT PAY LEAVE(WPL)",DPC:"DAY PAY CUT"},re=e=>e===v.SL?"SL":e===v.WPL?"WPL":e===v.DPC?"DPC":e,ze=(e,t)=>{var o,l;return U((l=(o=e==null?void 0:e.balances)==null?void 0:o[t])==null?void 0:l.effective_annual_quota)},Oe=(e,t)=>{var o,l;return U((l=(o=e==null?void 0:e.balances)==null?void 0:o[t])==null?void 0:l.used_approved_leave_days)},Ie=(e,t)=>{var o,l;return U((l=(o=e==null?void 0:e.balances)==null?void 0:o[t])==null?void 0:l.remaining)},ke=e=>U(e==null?void 0:e.day_pay_cut_days),Le=e=>U((e==null?void 0:e.dpc_quota)??(e==null?void 0:e.day_pay_cut_total)??0),Qe=e=>U(Le(e)-ke(e)),Ge=(e,t)=>t===v.DPC?Le(e):ze(e,t),He=(e,t)=>t===v.DPC?ke(e):Oe(e,t),Je=(e,t)=>t===v.DPC?Qe(e):Ie(e,t),V=j(()=>[{title:"Total",mode:"total",cols:[v.WPL,v.SL,v.DPC]},{title:"Used",mode:"used",cols:[v.CL,v.ML,v.SL,v.WPL,v.DPC]},{title:"Balance",mode:"balance",cols:[v.CL,v.ML,v.SL,v.WPL,v.DPC]}]),J=(e,t,o)=>t==="total"?Ge(e,o):t==="used"?He(e,o):Je(e,o),Ke=e=>Number(e)===0?"text-slate-300":"text-slate-700 font-semibold",K=M(!1),C=M(null),X=[{key:"CL",label:"CL"},{key:"ML",label:"ML"},{key:"SPECIAL LEAVE",label:"SL"},{key:"WITHOUT PAY LEAVE(WPL)",label:"WPL"}],T=(e,t,o)=>{var n;const l=(n=e==null?void 0:e.balances)==null?void 0:n[t];return l?o==="quota"?U(l.effective_annual_quota??0):o==="used"?U(l.used_approved_leave_days??0):o==="remaining"?U(l.remaining??0):0:0},Xe=e=>{C.value=e,K.value=!0,document.documentElement.classList.add("overflow-hidden")},ue=()=>{K.value=!1,C.value=null,document.documentElement.classList.remove("overflow-hidden")},Ce=e=>{e.key==="Escape"&&K.value&&ue()};window.addEventListener("keydown",Ce),pt(()=>window.removeEventListener("keydown",Ce));const Z=j(()=>ne.value&&(D.value||[]).length>0),w=j(()=>{const e=b.value||String(ae);return`yearly_leave_report_${c(u.value.company_id,"company")}_${e}_${Y.value}`}),W=e=>`"${String(e??"").replace(/"/g,'""')}"`,pe=(e,t)=>{const o=URL.createObjectURL(e),l=document.createElement("a");l.href=o,l.download=t,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(o)},Ze=()=>Z.value?Y.value==="part2"?st():et():oe(),we=()=>Z.value?Y.value==="part2"?at():tt():oe(),et=()=>{const e=["SL","Employee Name","Department","Designation",...R.value.flatMap(l=>B.map(n=>`${de(l)}_${n.label}`)),"Year"],t=(D.value||[]).map(l=>{var y,g,f;const n=[(l==null?void 0:l.sl)??"",c((y=l==null?void 0:l.user)==null?void 0:y.name,"Unknown"),c((g=l==null?void 0:l.user)==null?void 0:g.department,""),c((f=l==null?void 0:l.user)==null?void 0:f.designation,"")],m=R.value.flatMap(k=>B.map(S=>H(l,k,S.key)));return[...n,...m,b.value].map(W)}),o=[e.map(W).join(","),...t.map(l=>l.join(","))].join(`
`);pe(new Blob([o],{type:"text/csv;charset=utf-8;"}),`${w.value}.csv`)},tt=()=>{const e=new xe({unit:"pt",format:"a4",orientation:"landscape"}),t=e.internal.pageSize.getWidth();e.setFontSize(14),e.text("Yearly Leave Matrix (Part-1)",40,40),e.setFontSize(10),e.text(`Year: ${b.value}`,40,60),e.text(`Company ID: ${c(u.value.company_id,"")}`,40,76),e.text(`Department: ${c(u.value.department_id,"all")} • Line Type: ${c(u.value.line_type,"all")}`,40,92),u.value.employee_id&&e.text(`User filter: ${c(u.value.employee_id,"")}`,t-40,76,{align:"right"});const o=[["SL","Employee",...R.value.flatMap(n=>B.map(m=>`${de(n)} ${m.label}`))]],l=(D.value||[]).map(n=>{const m=A(n),y=[(n==null?void 0:n.sl)??"",`${m.name}
${m.meta}`],g=R.value.flatMap(f=>B.map(k=>H(n,f,k.key)));return[...y,...g]});ve(e,{startY:110,head:o,body:l,styles:{fontSize:7,cellPadding:3,valign:"middle"},headStyles:{fillColor:[241,245,249]},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:30,right:30}}),e.save(`${w.value}.pdf`)},st=()=>{const t=["SL","Employee Name","Department","Designation",...V.value.flatMap(n=>n.cols.map(m=>`${n.title}_${re(m)}`)),"Year"],o=(D.value||[]).map(n=>{var g,f,k;const m=[(n==null?void 0:n.sl)??"",c((g=n==null?void 0:n.user)==null?void 0:g.name,"Unknown"),c((f=n==null?void 0:n.user)==null?void 0:f.department,""),c((k=n==null?void 0:n.user)==null?void 0:k.designation,"")],y=V.value.flatMap(S=>S.cols.map(ee=>J(n,S.mode,ee)));return[...m,...y,b.value].map(W)}),l=[t.map(W).join(","),...o.map(n=>n.join(","))].join(`
`);pe(new Blob([l],{type:"text/csv;charset=utf-8;"}),`${w.value}.csv`)},at=()=>{const e=new xe({unit:"pt",format:"a4",orientation:"landscape"}),t=e.internal.pageSize.getWidth();e.setFontSize(14),e.text("Yearly Leave Report (Part-2: Total / Used / Balance)",40,40),e.setFontSize(10),e.text(`Year: ${b.value}`,40,60),e.text(`Company ID: ${c(u.value.company_id,"")}`,40,76),e.text(`Department: ${c(u.value.department_id,"all")} • Line Type: ${c(u.value.line_type,"all")}`,40,92),u.value.employee_id&&e.text(`User filter: ${c(u.value.employee_id,"")}`,t-40,76,{align:"right"});const o=[["SL","Employee",...V.value.flatMap(n=>n.cols.map(m=>`${n.title} ${re(m)}`))]],l=(D.value||[]).map(n=>{const m=A(n),y=[(n==null?void 0:n.sl)??"",`${m.name}
${m.meta}`],g=V.value.flatMap(f=>f.cols.map(k=>J(n,f.mode,k)));return[...y,...g]});ve(e,{startY:110,head:o,body:l,styles:{fontSize:8,cellPadding:4,valign:"middle"},headStyles:{fillColor:[241,245,249]},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:30,right:30}}),e.save(`${w.value}.pdf`)},lt=()=>{var m;const e=C.value;if(!e)return;const t=["Leave Type","Quota","Used","Remaining"],o=X.map(y=>[y.label,T(e,y.key,"quota"),T(e,y.key,"used"),T(e,y.key,"remaining")]);o.push(["DPC (Year)",(e==null?void 0:e.day_pay_cut_days)??0,"",""]);const l=[t.map(W).join(","),...o.map(y=>y.map(W).join(","))].join(`
`),n=c((m=e==null?void 0:e.user)==null?void 0:m.name,"employee").replace(/\s+/g,"_");pe(new Blob([l],{type:"text/csv;charset=utf-8;"}),`summary_${n}_${b.value}.csv`)},nt=()=>{var m,y,g,f,k;const e=C.value;if(!e)return;const t=new xe({unit:"pt",format:"a4"});t.setFontSize(14),t.text("Balance Summary",40,45),t.setFontSize(10),t.text(`Year: ${b.value}`,40,65),t.text(`Name: ${c((m=e==null?void 0:e.user)==null?void 0:m.name,"Unknown")}`,40,82),t.text(`${c((y=e==null?void 0:e.user)==null?void 0:y.department,"")} • ${c((g=e==null?void 0:e.user)==null?void 0:g.designation,"")}`,40,98);const o=X.map(S=>[S.label,T(e,S.key,"quota"),T(e,S.key,"used"),T(e,S.key,"remaining")]);ve(t,{startY:120,head:[["Type","Quota","Used","Remaining"]],body:o,styles:{fontSize:10,cellPadding:6},headStyles:{fillColor:[241,245,249]},alternateRowStyles:{fillColor:[250,250,250]},margin:{left:40,right:40}});const l=(((f=t.lastAutoTable)==null?void 0:f.finalY)||120)+18;t.setFontSize(11),t.text(`DPC (Year): ${(e==null?void 0:e.day_pay_cut_days)??0}`,40,l);const n=c((k=e==null?void 0:e.user)==null?void 0:k.name,"employee").replace(/\s+/g,"_");t.save(`summary_${n}_${b.value}.pdf`)},ot=()=>be.go(-1),ce=(e,t)=>e?X.reduce((o,l)=>o+Number(T(e,l.key,t)||0),0):0,F=j(()=>{const e=C.value;return{quota:ce(e,"quota"),used:ce(e,"used"),remaining:ce(e,"remaining"),dpc_days:Number((e==null?void 0:e.day_pay_cut_days)??0),dpc_hours:Number((e==null?void 0:e.hour_pay_cut)??0)}});return(e,t)=>{var o,l,n,m,y,g,f,k,S,ee,Pe,Se,$e,De,Ee,Ue,Ye,Te,Me;return r(),d("div",gt,[s("div",ht,[s("button",{class:"btn-3",onClick:ot},t[13]||(t[13]=[s("i",{class:"far fa-arrow-left"},null,-1),s("span",{class:"hidden sm:inline ml-2"},"Back",-1)])),s("div",kt,[t[14]||(t[14]=s("h1",{class:"text-base md:text-lg font-bold text-slate-800 leading-6 truncate"},"Yearly Leave Report",-1)),s("p",Lt," Company: "+i(c(u.value.company_id,"—"))+" • Year: "+i(b.value),1)]),s("div",Ct,[s("button",{type:"button",class:"btn-3",disabled:!Z.value,title:"Export CSV",onClick:Ze},t[15]||(t[15]=[s("i",{class:"far fa-file-csv"},null,-1),s("span",{class:"hidden md:inline ml-2"},"CSV",-1)]),8,Pt),s("button",{type:"button",class:"btn-3",disabled:!Z.value,title:"Download PDF",onClick:we},t[16]||(t[16]=[s("i",{class:"far fa-file-pdf"},null,-1),s("span",{class:"hidden md:inline ml-2"},"PDF",-1)]),8,St),ne.value?N("",!0):(r(),d("button",{key:0,type:"button",class:"btn-3",title:"Missing Selection",onClick:oe},t[17]||(t[17]=[s("i",{class:"far fa-circle-exclamation"},null,-1)])))])]),s("div",$t,[s("div",Dt,[me(xt,{company_id:u.value.company_id,"onUpdate:company_id":t[1]||(t[1]=a=>u.value.company_id=a),department_id:u.value.department_id,"onUpdate:department_id":t[2]||(t[2]=a=>u.value.department_id=a),employee_id:u.value.employee_id,"onUpdate:employee_id":t[3]||(t[3]=a=>u.value.employee_id=a),line_type:u.value.line_type,"onUpdate:line_type":t[4]||(t[4]=a=>u.value.line_type=a),"with-type":!0,"initial-value":e.$route.query,onFilterChange:We},{default:ct(()=>[me(vt,{modelValue:le.value,"onUpdate:modelValue":t[0]||(t[0]=a=>le.value=a),"show-year":!0,"show-month":!1,"show-date":!1,label:"Year"},null,8,["modelValue"])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"])]),s("div",Et,[s("button",{class:se(["tab-pill",Y.value==="part1"?"tab-pill--active":""]),onClick:t[5]||(t[5]=a=>Y.value="part1")}," Part 1 (Monthly) ",2),s("button",{class:se(["tab-pill",Y.value==="part2"?"tab-pill--active":""]),onClick:t[6]||(t[6]=a=>Y.value="part2")}," Part 2 (Total / Used / Balance) ",2),s("label",Ut,[Ne(s("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=a=>z.value=a),class:"accent-slate-700"},null,512),[[mt,z.value]]),t[18]||(t[18]=ye(" Include Pending "))]),s("div",Yt,[t[20]||(t[20]=s("span",{class:"text-[11px] font-semibold text-slate-600"},"Per Page",-1)),Ne(s("select",{"onUpdate:modelValue":t[8]||(t[8]=a=>O.value=a),class:"rounded-xl border bg-white px-3 py-2 text-[11px]"},t[19]||(t[19]=[s("option",{value:10},"10",-1),s("option",{value:25},"25",-1),s("option",{value:50},"50",-1),s("option",{value:100},"100",-1)]),512),[[yt,O.value]])])])]),p(Fe)?(r(),d("div",Tt,[me(bt)])):p(fe)?(r(),d("div",Mt,i(p(fe)),1)):(r(),d("div",Nt,[Y.value==="part1"?(r(),d("div",Rt,[s("div",Bt,[s("div",Vt,[t[21]||(t[21]=s("span",{class:"text-sm font-semibold text-slate-800"},"Yearly Leave Matrix (Part-1)",-1)),u.value.employee_id?(r(),d("span",Ft," User: "+i(u.value.employee_id),1)):N("",!0),(o=p(qe))!=null&&o.fallback_company_only?(r(),d("span",qt," Fallback: Company users ")):N("",!0)]),s("span",At," Page "+i(((l=p(x))==null?void 0:l.current_page)??1)+" / "+i(((n=p(x))==null?void 0:n.last_page)??1)+" • Total "+i(((m=p(x))==null?void 0:m.total)??(((y=p(D))==null?void 0:y.length)||0)),1)]),s("div",Wt,[s("table",{class:"min-w-max w-full text-[11px] text-slate-700",style:Re({"--slw":Be+"px","--empw":Ve+"px"})},[s("thead",jt,[s("tr",zt,[t[22]||(t[22]=s("th",{class:"sticky-col sticky-col--sl bg-slate-100 px-3 py-2 text-left",rowspan:"2"},"SL",-1)),t[23]||(t[23]=s("th",{class:"sticky-col sticky-col--emp bg-slate-100 px-3 py-2 text-left",rowspan:"2"}," Employee ",-1)),(r(!0),d(_,null,P(R.value,a=>(r(),d("th",{key:a,class:"px-2 py-2 text-center border-l border-ink",colspan:B.length},i(de(a)),9,Ot))),128))]),s("tr",It,[(r(!0),d(_,null,P(R.value,a=>(r(),d(_,{key:a+"_sub"},[(r(),d(_,null,P(B,h=>s("th",{key:a+"_"+h.key,class:"px-2 py-2 text-center border-l border-b border-t border-ink",title:h.key},i(h.label),9,Qt)),64))],64))),128))])]),s("tbody",Gt,[(r(!0),d(_,null,P(p(D),a=>{var h;return r(),d("tr",{key:(h=a==null?void 0:a.user)==null?void 0:h.id,class:"hover:bg-sky-100 cursor-pointer",onClick:E=>Xe(a)},[s("td",Jt,i((a==null?void 0:a.sl)??""),1),s("td",Kt,[s("div",Xt,i(A(a).name),1),s("div",Zt,i(A(a).meta),1)]),(r(!0),d(_,null,P(R.value,E=>{var I;return r(),d(_,{key:((I=a==null?void 0:a.user)==null?void 0:I.id)+"_"+E},[(r(),d(_,null,P(B,q=>{var Q;return s("td",{key:((Q=a==null?void 0:a.user)==null?void 0:Q.id)+"_"+E+"_"+q.key,class:se(["px-2 py-2 text-center border-l border-ink-soft tabular-nums",je(H(a,E,q.key))])},i(H(a,E,q.key)),3)}),64))],64)}),128))],8,Ht)}),128)),(g=p(D))!=null&&g.length?N("",!0):(r(),d("tr",wt,[s("td",{colspan:2+R.value.length*B.length+1,class:"px-4 py-10 text-center text-slate-500"}," No data found for selected filters. ",8,es)]))])],4)]),p(x)?(r(),d("div",ts,[s("p",ss," Page "+i(p(x).current_page)+" of "+i(p(x).last_page)+" • Total "+i(p(x).total),1),s("div",as,[s("button",{class:"btn-3",disabled:p(x).current_page<=1,onClick:t[9]||(t[9]=a=>L.value=Math.max(1,L.value-1))},t[24]||(t[24]=[s("i",{class:"far fa-chevron-left"},null,-1),s("span",{class:"hidden sm:inline ml-2"},"Prev",-1)]),8,ls),s("button",{class:"btn-3",disabled:p(x).current_page>=p(x).last_page,onClick:t[10]||(t[10]=a=>L.value=L.value+1)},t[25]||(t[25]=[s("span",{class:"hidden sm:inline mr-2"},"Next",-1),s("i",{class:"far fa-chevron-right"},null,-1)]),8,ns)])])):N("",!0)])):(r(),d("div",os,[s("div",is,[t[26]||(t[26]=s("div",{class:"flex flex-wrap items-center gap-2"},[s("span",{class:"text-sm font-semibold text-slate-800"},"Yearly Leave Report (Part-2)"),s("span",{class:"text-[11px] font-medium text-slate-500"},"Total / Used / Balance")],-1)),s("span",ds," Page "+i(((f=p(x))==null?void 0:f.current_page)??1)+" / "+i(((k=p(x))==null?void 0:k.last_page)??1)+" • Total "+i(((S=p(x))==null?void 0:S.total)??(((ee=p(D))==null?void 0:ee.length)||0)),1)]),s("div",rs,[s("table",{class:"min-w-max w-full text-[11px] text-slate-700",style:Re({"--slw":Be+"px","--empw":Ve+"px"})},[s("thead",us,[s("tr",ps,[t[27]||(t[27]=s("th",{class:"sticky-col sticky-col--sl bg-slate-100 px-3 py-2 text-left",rowspan:"2"},"SL",-1)),t[28]||(t[28]=s("th",{class:"sticky-col sticky-col--emp bg-slate-100 px-3 py-2 text-left",rowspan:"2"},"Employee",-1)),(r(!0),d(_,null,P(V.value,a=>(r(),d("th",{key:a.title,class:"px-2 py-2 text-center border-l border-ink",colspan:a.cols.length},i(a.title),9,cs))),128))]),s("tr",ms,[(r(!0),d(_,null,P(V.value,a=>(r(),d(_,{key:a.title+"_sub"},[(r(!0),d(_,null,P(a.cols,h=>(r(),d("th",{key:a.title+"_"+h,class:"px-2 py-2 text-center border-l border-ink",title:h},i(re(h)),9,ys))),128))],64))),128))])]),s("tbody",xs,[(r(!0),d(_,null,P(p(D),a=>{var h;return r(),d("tr",{key:(h=a==null?void 0:a.user)==null?void 0:h.id,class:"hover:bg-sky-100"},[s("td",vs,i((a==null?void 0:a.sl)??""),1),s("td",bs,[s("div",_s,i(A(a).name),1),s("div",fs,i(A(a).meta),1)]),(r(!0),d(_,null,P(V.value,E=>{var I;return r(),d(_,{key:((I=a==null?void 0:a.user)==null?void 0:I.id)+"_"+E.title},[(r(!0),d(_,null,P(E.cols,q=>{var Q;return r(),d("td",{key:((Q=a==null?void 0:a.user)==null?void 0:Q.id)+"_"+E.title+"_"+q,class:se(["px-2 py-2 text-center border-l border-ink-soft tabular-nums",Ke(J(a,E.mode,q))])},i(J(a,E.mode,q)),3)}),128))],64)}),128))])}),128)),(Pe=p(D))!=null&&Pe.length?N("",!0):(r(),d("tr",gs,[s("td",{colspan:2+V.value.reduce((a,h)=>a+h.cols.length,0),class:"px-4 py-10 text-center text-slate-500"}," No data found for selected filters. ",8,hs)]))])],4)]),p(x)?(r(),d("div",ks,[s("p",Ls," Page "+i(p(x).current_page)+" of "+i(p(x).last_page)+" • Total "+i(p(x).total),1),s("div",Cs,[s("button",{class:"btn-3",disabled:p(x).current_page<=1,onClick:t[11]||(t[11]=a=>L.value=Math.max(1,L.value-1))},t[29]||(t[29]=[s("i",{class:"far fa-chevron-left"},null,-1),s("span",{class:"hidden sm:inline ml-2"},"Prev",-1)]),8,Ps),s("button",{class:"btn-3",disabled:p(x).current_page>=p(x).last_page,onClick:t[12]||(t[12]=a=>L.value=L.value+1)},t[30]||(t[30]=[s("span",{class:"hidden sm:inline mr-2"},"Next",-1),s("i",{class:"far fa-chevron-right"},null,-1)]),8,Ss)])])):N("",!0)]))])),K.value?(r(),d("div",$s,[s("div",{class:"absolute inset-0 bg-black/40",onClick:ue}),s("div",Ds,[s("div",Es,[s("div",Us,[s("p",Ys,i(c(($e=(Se=C.value)==null?void 0:Se.user)==null?void 0:$e.name,"Employee")),1),s("p",Ts,i(c((Ee=(De=C.value)==null?void 0:De.user)==null?void 0:Ee.department,""))+" • "+i(c((Ye=(Ue=C.value)==null?void 0:Ue.user)==null?void 0:Ye.designation,""))+" • Year: "+i(b.value),1)]),s("div",{class:"flex items-center gap-2"},[s("button",{class:"btn-3",title:"Export Summary CSV",onClick:lt},t[31]||(t[31]=[s("i",{class:"far fa-file-csv"},null,-1),s("span",{class:"hidden md:inline ml-2"},"CSV",-1)])),s("button",{class:"btn-3",title:"Download Summary PDF",onClick:nt},t[32]||(t[32]=[s("i",{class:"far fa-file-pdf"},null,-1),s("span",{class:"hidden md:inline ml-2"},"PDF",-1)])),s("button",{class:"btn-3",title:"Close",onClick:ue},t[33]||(t[33]=[s("i",{class:"far fa-times"},null,-1)]))])]),s("div",Ms,[s("div",Ns,[s("div",Rs,[t[37]||(t[37]=s("div",null,[s("p",{class:"text-xs font-semibold text-slate-700"},"Total Summary"),s("p",{class:"text-[11px] text-slate-500"},"Sum of all leave types (CL + ML + SL + WPL)")],-1)),s("div",Bs,[t[36]||(t[36]=s("p",{class:"text-[11px] text-slate-500"},"DPC (Year)",-1)),s("p",Vs,[ye(i(F.value.dpc_days)+" ",1),t[34]||(t[34]=s("span",{class:"text-xs font-semibold text-slate-500"},"days",-1))]),s("p",Fs,[ye(i(F.value.dpc_hours)+" ",1),t[35]||(t[35]=s("span",{class:"text-[10px]"},"hours",-1))])])]),s("div",qs,[s("div",As,[t[38]||(t[38]=s("p",{class:"text-[10px] uppercase tracking-wide text-slate-500"},"Quota",-1)),s("p",Ws,i(F.value.quota),1)]),s("div",js,[t[39]||(t[39]=s("p",{class:"text-[10px] uppercase tracking-wide text-slate-500"},"Used",-1)),s("p",zs,i(F.value.used),1)]),s("div",Os,[t[40]||(t[40]=s("p",{class:"text-[10px] uppercase tracking-wide text-slate-500"},"Remaining",-1)),s("p",Is,i(F.value.remaining),1)])])]),s("div",Qs,[t[44]||(t[44]=s("div",{class:"px-4 py-2 bg-slate-50 border-b border-ink text-xs font-semibold text-slate-700"}," Balance Summary (By Type) ",-1)),s("div",Gs,[s("table",Hs,[t[43]||(t[43]=s("thead",{class:"text-[11px] uppercase tracking-wide text-slate-500 bg-slate-100"},[s("tr",null,[s("th",{class:"px-4 py-2 text-left"},"Type"),s("th",{class:"px-4 py-2 text-right"},"Quota"),s("th",{class:"px-4 py-2 text-right"},"Used"),s("th",{class:"px-4 py-2 text-right"},"Remaining")])],-1)),s("tbody",Js,[(r(),d(_,null,P(X,a=>s("tr",{key:a.key},[s("td",Ks,i(a.label),1),s("td",Xs,i(T(C.value,a.key,"quota")),1),s("td",Zs,i(T(C.value,a.key,"used")),1),s("td",ws,i(T(C.value,a.key,"remaining")),1)])),64)),s("tr",ea,[t[41]||(t[41]=s("td",{class:"px-4 py-2 font-bold text-slate-800"},"Total",-1)),s("td",ta,i(F.value.quota),1),s("td",sa,i(F.value.used),1),s("td",aa,i(F.value.remaining),1)]),!((Te=C.value)!=null&&Te.balances)||Object.keys(((Me=C.value)==null?void 0:Me.balances)||{}).length===0?(r(),d("tr",la,t[42]||(t[42]=[s("td",{colspan:"4",class:"px-4 py-6 text-center text-slate-500"},"No balance data",-1)]))):N("",!0)])])])])])])])):N("",!0)])}}},fa=it(na,[["__scopeId","data-v-bbab45e7"]]);export{fa as default};
