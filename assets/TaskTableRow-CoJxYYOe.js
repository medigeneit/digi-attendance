import{r as N,h as O,q as P,c as l,o as a,a as e,k as d,n as u,b as q,F as j,w as m,e as E,z as F,f as L,t as f,d as $,j as w,s as M}from"./index-T6D7L5ZT.js";import{b as A,c as S}from"./datetime-y2WWmmYq.js";import{_ as z,T as R,a as V,b as K}from"./TaskUrgentBadge-DtPYGhCO.js";import{_ as U,a as W}from"./TaskStatus-CXKla3P5.js";import{T as G}from"./TaskIsClosedBadge-CRro5mGT.js";function B(t){if(!t)return!1;const k=I(t);return["jpg","jpeg","png","gif","webp","bmp","svg","jfif"].includes(k)}function D(t){return I(t)==="pdf"}function I(t){return typeof t=="string"?t.split(".").pop().toLowerCase():""}function x(t){return typeof t!="string"?"":t.startsWith("http")?t:`https://hrm-api.medi.academy/storage/${t}`}const H={class:"border-b flex items-center px-2 py-1"},J=["href"],Q={class:"ml-auto flex items-center gap-2"},X={key:0,class:"p-2 min-h-[50vh] max-h-[70vh] overflow-y-auto"},Y=["src"],Z=["src"],tt={key:1},et={key:0,class:"grid grid-cols-4 p-4 gap-8 min-h-[50vh] max-h-[70vh] overflow-y-auto"},st=["onClick","onKeydown"],at=["src"],nt=["href"],lt={key:2,class:"text-xs text-gray-500 text-center"},Ot={__name:"RequirementAttachmentShow",props:{attachments:{type:Array,default:()=>[]},selected:{type:String,default:""}},emits:["change","clickClose"],setup(t,{emit:k}){const c=t,n=N(""),h=k;function o(r){n.value=r,h("change",r)}function y(){var s,i;const r=(c.attachments||[]).indexOf(n.value);console.log({currentIndex:r,attachments:c.attachments}),(s=c.attachments)!=null&&s[r-1]&&(n.value=(i=c.attachments)==null?void 0:i[r-1],h("change",n.value))}function v(){var s,i;const r=(c.attachments||[]).indexOf(n.value);(s=c.attachments)!=null&&s[r+1]&&(n.value=(i=c.attachments)==null?void 0:i[r+1],h("change",n.value))}return O(()=>{var r;n.value=((r=c.attachments)==null?void 0:r.length)==1?c.attachments[0]:n.value}),P(()=>c.selected,r=>n.value=r,{immediate:!0}),(r,s)=>(a(),l("div",null,[e("div",H,[s[6]||(s[6]=e("h2",{class:"text-xl font-semibold"},"Attachments",-1)),n.value?(a(),l("a",{key:0,href:u(x)(n.value),target:"_blank",class:"text-sky-600 hover:text-sky-400 hover:underline ml-2"},s[2]||(s[2]=[e("i",{class:"fas fa-external-link"},null,-1),q(),e("span",{class:"hidden md:inline"},"Open In New tab",-1)]),8,J)):d("",!0),e("div",Q,[n.value&&t.attachments.length>1?(a(),l(j,{key:0},[e("button",{onClick:s[0]||(s[0]=m(i=>o(""),["prevent"])),class:"btn-icon"},s[3]||(s[3]=[e("i",{class:"fas fa-list"},null,-1)])),e("button",{onClick:m(y,["prevent"]),class:"btn-icon"},s[4]||(s[4]=[e("i",{class:"fas fa-angle-left"},null,-1)])),e("button",{onClick:m(v,["prevent"]),class:"btn-icon"},s[5]||(s[5]=[e("i",{class:"fas fa-angle-right"},null,-1)]))],64)):d("",!0),e("button",{onClick:s[1]||(s[1]=m(i=>h("clickClose"),["prevent"])),class:"btn-icon ml-6"},"Ã—")])]),e("div",null,[n.value?(a(),l("div",X,[u(B)(n.value)?(a(),l("img",{key:0,src:u(x)(n.value),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,Y)):u(D)(n.value)?(a(),l("iframe",{key:1,src:u(x)(n.value),class:"w-full h-[60vh] border rounded-md"},null,8,Z)):d("",!0)])):(a(),l("div",tt,[t.attachments&&t.attachments.length?(a(),l("div",et,[(a(!0),l(j,null,E(t.attachments,(i,b)=>(a(),l("div",{key:b,class:"border p-1 rounded aspect-square flex items-center justify-center bg-gray-50 relative cursor-pointer hover:bg-gray-100 hover:shadow-md hover:border-gray-300 hover:scale-[1.02] transition-transform",tabindex:"0",onClick:m(p=>o(i),["prevent"]),onKeydown:F(m(p=>o(i),["prevent"]),["enter"])},[u(B)(i)?(a(),l("img",{key:0,src:u(x)(i),alt:"attachment",class:"object-cover w-full h-full rounded"},null,8,at)):u(D)(i)?(a(),l("a",{key:1,href:u(x)(i),target:"_blank",class:"text-xs text-blue-600 text-center break-words hover:underline"},s[7]||(s[7]=[e("i",{class:"fas fa-file-pdf fa-2x mb-1 text-amber-700"},null,-1),e("div",{class:"whitespace-nowrap text-xs mt-1"},"Open PDF",-1)]),8,nt)):(a(),l("span",lt,"Unknown"))],40,st))),128))])):d("",!0)]))])]))}},ot={class:"border text-center py-2 px-1 border-gray-200"},rt={class:"font-semibold text-purple-400 text-sm"},it={class:"border px-3 py-1 border-gray-200 relative"},ct={class:"flex items-center justify-between gap-2"},dt={class:"flex items-center gap-3 mb-0.5"},ut={class:"flex items-center flex-none lg:w-full order-0 lg:order-1"},mt={class:"text-pink-600 text-xs mr-2 whitespace-nowrap font-bold"},ft={class:"text-gray-400 text-xs mr-4 whitespace-nowrap"},kt={class:"ml-1"},ht={class:"flex items-center gap-2 text-xs text-gray-500 opacity-80 text-left"},gt={key:0,class:"text-xs flex items-center gap-1 text-sky-400 ml-4"},xt=["href"],yt={class:"border px-3 py-1 border-gray-200"},vt={class:"flex gap-2 justify-between items-center relative w-full"},bt={key:0,class:"shrink-0"},pt=["href"],wt={class:"border px-3 py-1 border-gray-200 text-center"},$t={key:0,class:"ml-4 text-gray-500 text-sm"},Ct={class:"text-blue-500 font-semibold whitespace-nowrap"},Tt={class:"border px-3 border-gray-200 sticky right-0 border-l bg-gray-50"},_t={class:"flex justify-end flex-wrap gap-2 py-2"},Pt={__name:"TaskTableRow",props:{task:{type:Object},indexing:{type:[Number,String]},hideButtons:{type:Boolean,default:!1},taskLinkTo:{type:Function,default:null}},emits:["editClick","employeeAssignClick"],setup(t,{emit:k}){const c=k,n=L();return(h,o)=>{var y,v,r,s,i,b,p,C,T,_;return a(),l("tr",{class:M(["group/sub-task-row h-20",[t.task.closed_at?"bg-orange-50 opacity-60 hover:opacity-90":{" bg-green-400/20":t.task.status=="COMPLETED"," bg-white hover:bg-slate-50":t.task.status!=="COMPLETED"}]])},[e("td",ot,[e("div",rt,f(t.indexing),1)]),e("td",it,[e("div",ct,[e("div",null,[e("div",dt,[$(z,{titleClass:"text-sm text-blue-400 font-semibold",task:t.task,"sub-tasks-open":!1,isMyTask:u(n).name=="RequirementList",to:g=>`/requirement-tasks/${g.id}`},null,8,["task","isMyTask","to"])]),e("div",ut,[e("div",mt,"#"+f(t.task.id),1),e("div",ft,[o[2]||(o[2]=e("i",{class:"fas fa-clock"},null,-1)),e("span",kt,f(u(A)(t.task.created_at)),1)]),e("div",ht,[(y=t.task)!=null&&y.is_important?(a(),w(R,{key:0})):d("",!0),(v=t.task)!=null&&v.is_urgent?(a(),w(V,{key:1})):d("",!0),t.task.closed_at?(a(),w(G,{key:2})):d("",!0)]),((r=t.task)==null?void 0:r.todo_dates_count)===null?(a(),l("div",gt,[o[3]||(o[3]=e("i",{class:"fas fa-tasks"},null,-1)),e("span",null,f((s=t.task)==null?void 0:s.completed_todo_dates_count),1),o[4]||(o[4]=e("span",null,"/",-1)),e("span",null,f((i=t.task)==null?void 0:i.todo_dates_count),1)])):d("",!0)])]),!t.task.closed_at&&!t.hideButtons?(a(),l("a",{key:0,href:`/tasks/edit/${t.task.id}`,onClick:o[0]||(o[0]=m(g=>c("editClick",t.task.id),["stop","prevent"])),class:"btn-3 py-1.5 px-1.5 !border-0 size-7 text-sm opacity-40 group-hover/sub-task-row:opacity-100 duration-100"},o[5]||(o[5]=[e("i",{class:"fas fa-edit"},null,-1)]),8,xt)):d("",!0)])]),e("td",yt,[e("div",vt,[$(U,{class:"flex items-center justify-center gap-x-3 gap-y-2",users:((b=t.task)==null?void 0:b.users)||[],isTargetTask:t.task.is_target,maxItem:1,"route-to":g=>`/requirement-tasks?status=not-completed&view=userwise&user-ids=${g.id}`},null,8,["users","isTargetTask","route-to"]),t.task.closed_at?d("",!0):(a(),l("div",bt,[t.hideButtons?d("",!0):(a(),l("a",{key:0,href:`/tasks/${t.task.id}/assign-users`,onClick:o[1]||(o[1]=m(g=>c("employeeAssignClick",t.task.id),["stop","prevent"])),class:"btn-3 py-1.5 px-1.5 !border-0 size-7 text-sm opacity-40 group-hover/sub-task-row:opacity-100 duration-100 flex-shrink-0"},o[6]||(o[6]=[e("i",{class:"fas fa-users-cog"},null,-1)]),8,pt))]))])]),e("td",wt,[t.task.deadline?(a(),l("span",$t,[e("span",Ct,f(u(S)(t.task.deadline)),1)])):d("",!0)]),e("td",Tt,[e("div",_t,[$(W,{status:(p=t.task)==null?void 0:p.status,progressPercent:((C=t.task)==null?void 0:C.progress_percent)||0,class:"w-full"},null,8,["status","progressPercent"]),((_=(T=t.task)==null?void 0:T.children_tasks)==null?void 0:_.length)>0?(a(),w(K,{key:0,ref:"progress",task:t.task,class:"text-sm w-full"},null,8,["task"])):d("",!0)])])],2)}}};export{Ot as _,D as a,Pt as b,x as f,B as i};
