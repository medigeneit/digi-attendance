import{q as p,s as N,A as R,e as z,c as r,o as d,a as t,f as U,w as A,g as b,C as B,F as C,x as E,t as H,h,l as w,p as L,E as S,v as j,y as F}from"./index-6S7cHxvf.js";import{_ as G}from"./MultiselectDropdown-_eC-0OrJ.js";import{u as q}from"./company-_CiXOzHo.js";import{_ as D}from"./UserChip-CHtI344L.js";import{_ as O}from"./TaskTreeView-C7LQ_2gh.js";const W={class:"mb-3 task-header"},J={class:"flex justify-between items-center"},K={class:"ml-auto flex gap-6 items-center"},Q={key:0,class:"flex gap-2 items-center"},X={class:"flex flex-wrap items-center gap-2 mt-3"},Y={class:"flex flex-wrap gap-4 w-full"},Z={class:"text-gray-600 w-full md:w-64 relative"},ee=["value"],te={class:"relative w-full md:w-72"},le={key:0,class:"absolute right-8 text-xl top-0 bottom-0 flex items-center"},se={class:"text-gray-600 w-40 relative"},oe={class:"flex gap-4 items-center flex-shrink-0"},ae={class:"flex gap-2"},ne={class:"flex gap-2"},ie={class:"flex gap-2"},re={class:"text-gray-600 w-full md:w-40 md:ml-auto relative"},be={__name:"TaskHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(y,{emit:V}){const m=y,c=p(f("company-id")),x=p(f("user-ids")),k=p(f("month")),g=p(f("status")),o=p(f("is-important")),a=p(f("is-urgent")),n=p(f("is-target")),i=V,u=q(),{companies:v,employees:T}=N(u);function f(s){return{get:()=>m.modelValue[s]||"",set:e=>{console.log("---SETTING modelValue: ",{key:s,value:e}),i("update:modelValue",{...m.modelValue,[s]:e||void 0})}}}const _=p(()=>P(x.value));async function $(s){s&&await u.fetchEmployee(s)}R(()=>c.value,$),z(async()=>{var s,e;await u.fetchCompanies(),(s=m.modelValue)!=null&&s["company-id"]&&await $((e=m.modelValue)==null?void 0:e["company-id"])});function P(s){return Array.isArray(T.value)&&T.value.find(e=>e.id==s)||null}function I(s){x.value=(s==null?void 0:s.id)||""}function M(){x.value=""}return(s,e)=>(d(),r("div",W,[t("div",J,[e[10]||(e[10]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Task List",-1)),t("div",K,[y.listHasRearranged?(d(),r("div",Q,[e[9]||(e[9]=t("span",{class:"text-red-500"},"Priority Changed",-1)),t("button",{class:"btn-3",onClick:e[0]||(e[0]=A(l=>i("clickPrioritySave"),["prevent"]))},"Save"),t("button",{class:"btn-3",onClick:e[1]||(e[1]=A(l=>i("clickPriorityDiscard"),["prevent"]))},"Discard")])):U("",!0),t("button",{onClick:e[2]||(e[2]=l=>i("clickAddTask")),class:"btn-1"},"Add Task")])]),t("div",X,[t("div",Y,[t("div",Z,[e[12]||(e[12]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"},"Company",-1)),b(t("select",{id:"company-filter","onUpdate:modelValue":e[3]||(e[3]=l=>c.value=l),class:"input-1"},[e[11]||(e[11]=t("option",{value:""},"All Company",-1)),(d(!0),r(C,null,E(h(v),l=>(d(),r("option",{key:l.id,value:l.id},H(l.name),9,ee))),128))],512),[[B,c.value]])]),t("div",te,[w(G,{modelValue:_.value,onSelect:I,onRemove:M,options:h(T),multiple:!1,label:"name","label-prefix":"id",placeholder:"All Employees",class:"text-gray-600 w-full"},{option:L(({option:l})=>[w(D,{user:l,class:"w-full line-clamp-1"},null,8,["user"])]),_:1},8,["modelValue","options"]),_.value?(d(),r("div",le,[t("button",{onClick:A(M,["prevent"]),class:"mt-0.5 text-gray-500 hover:text-red-700"}," Ã— ")])):U("",!0),e[13]||(e[13]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"},"Employee",-1))]),t("div",se,[e[15]||(e[15]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),b(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>g.value=l),class:"input-1"},e[14]||(e[14]=[t("option",{value:""},"All Tasks",-1),t("option",{value:"not-completed"},"Not Completed",-1),t("option",{value:"only-completed"},"Completed",-1)]),512),[[B,g.value]])]),t("div",oe,[t("label",ae,[b(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=l=>o.value=l)},null,512),[[S,o.value]]),e[16]||(e[16]=t("span",null,"Important",-1))]),t("label",ne,[b(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=l=>a.value=l)},null,512),[[S,a.value]]),e[17]||(e[17]=t("span",null,"Urgent",-1))]),t("label",ie,[b(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=l=>n.value=l)},null,512),[[S,n.value]]),e[18]||(e[18]=t("span",null,"Is Target",-1))])]),t("div",re,[e[19]||(e[19]=t("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),b(t("input",{id:"month-filter","onUpdate:modelValue":e[8]||(e[8]=l=>k.value=l),type:"month",class:"input-1",placeholder:"All month"},null,512),[[j,k.value]])])])])]))}},de={class:"w-full bg-white rounded"},ue=["rowspan"],xe={__name:"UserWiseList",props:{tasks:Array,selectedUserId:{type:String,default:null}},emits:["commentButtonClick","editClick","addClick","updatePriority"],setup(y,{emit:V}){const m=y,c=V,x=p(()=>m.tasks.reduce((o,a)=>(o.push(...a.users.filter(n=>!o.find(i=>i.id==n.id&&n.id))),o),[]).filter(o=>m.selectedUserId?o.id==m.selectedUserId:!0)),k=o=>m.tasks.filter(i=>i.users.some(u=>u.id===o)),g=p(()=>x.value.map(o=>{const a=k(o.id);return{...o,tasks:a}}));return(o,a)=>(d(),r("div",null,[t("table",de,[t("tbody",null,[(d(!0),r(C,null,E(g.value,n=>(d(),r(C,{key:n.id},[(d(!0),r(C,null,E(n.tasks,(i,u)=>(d(),r("tr",{key:i.id},[u==0?(d(),r("td",{key:0,class:"border p-4 align-top border-green-300 bg-blue-50",rowspan:Math.max(n.tasks.length,1)},[w(D,{user:n,class:"sticky top-[80px]"},null,8,["user"])],8,ue)):U("",!0),t("td",{class:F(["py-4 px-4 border-x border-green-300 bg-blue-50",{"border-t":u==0,"border-b":n.tasks.length-1===u}])},[w(O,{task:i,class:"!border-0 my-0",index:u,onCommentButtonClick:a[0]||(a[0]=v=>c("commentButtonClick",o.item.id)),onEditClick:a[1]||(a[1]=v=>c("editClick",v)),onAddClick:a[2]||(a[2]=v=>c("addClick",v))},null,8,["task","index"])],2)]))),128))],64))),128))])])]))}};export{be as _,xe as a};
