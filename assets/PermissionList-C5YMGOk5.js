import{_ as P}from"./UserChip-Bd2YN5FE.js";import{u as v}from"./userPermissionStore-CoJSpnv_.js";import{u as C,z as B,e as A,m as L,a0 as N,A as R,c as n,o as r,a as s,x as f,i as j,j as U,F as c,q as b,g as V,t as u,U as S}from"./index-Va8zAUrJ.js";const $={class:"space-y-2 px-4"},D={class:"flex items-center justify-between gap-2"},E={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},F={class:"p-3 border whitespace-nowrap"},T=["rowspan"],q={class:"p-3 border"},z={class:"p-3 border"},M={key:0},G={key:1},H={class:"p-3 border flex justify-center md:gap-4"},I=["onClick"],J=["onClick"],X={__name:"PermissionList",setup(K){const d=v(),_=C(),{userPermissions:g}=B(d),h=t=>{_.push({name:"PermissionEdit",params:{id:t}})},k=t=>{d.deletePermission(t)};A(()=>{d.fetchUserPermissions()});const x=L(()=>g.value.reduce((t,e)=>{const i=t.find(o=>o.id===e.user.id);return i?(i.permissions=[...i.permissions,e],t):[...t,{...e.user,permissions:[e]}]},[]));let l=0;return N(()=>{l=0}),(t,e)=>{const i=R("RouterLink");return r(),n("div",$,[s("div",D,[s("button",{class:"btn-3",onClick:e[0]||(e[0]=(...o)=>t.goBack&&t.goBack(...o))},e[1]||(e[1]=[s("i",{class:"far fa-arrow-left"},null,-1),s("span",{class:"hidden md:flex"},"Back",-1)])),e[3]||(e[3]=s("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Permissions List",-1)),f(i,{to:{name:"PermissionsAdd"},class:"btn-2"},{default:j(()=>e[2]||(e[2]=[U(" + Add New ")])),_:1,__:[2]})]),s("table",E,[e[6]||(e[6]=s("thead",{class:"bg-gray-100"},[s("tr",{class:"bg-gray-200"},[s("th",{class:"text-left p-3 border"},"#"),s("th",{class:"text-left p-3 border"},"User"),s("th",{class:"text-left p-3 border"},"Company"),s("th",{class:"text-left p-3 border"},"Departments"),s("th",{class:"text-left p-3 border"},"Actions")])],-1)),s("tbody",null,[(r(!0),n(c,null,b(x.value,o=>(r(),n(c,{key:o.id},[(r(!0),n(c,null,b(o.permissions||[],(a,y)=>{var m,p;return r(),n("tr",{key:a.id,class:"hover:bg-gray-50"},[s("td",F,u(S(l)?++l.value:++l),1),y===0?(r(),n("td",{key:0,class:"p-3 border align-top",rowspan:((m=o.permissions)==null?void 0:m.length)||1},[f(P,{user:o},null,8,["user"])],8,T)):V("",!0),s("td",q,u((p=a.company)==null?void 0:p.name),1),s("td",z,[a.department_ids.includes("*")?(r(),n("span",M,"All")):(r(),n("span",G,u(a.departments.join(", ")),1))]),s("td",H,[s("button",{onClick:w=>h(a.id),class:"btn-1"},e[4]||(e[4]=[s("i",{class:"fas fa-edit"},null,-1)]),8,I),s("button",{onClick:w=>k(a.id),class:"btn-1 text-red-600"},e[5]||(e[5]=[s("i",{class:"fas fa-trash"},null,-1)]),8,J)])])}),128))],64))),128))])])])}}};export{X as default};
