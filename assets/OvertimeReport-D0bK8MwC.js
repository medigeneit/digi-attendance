import{u as N,b as O,s as A,r as h,e as E,x as L,m as T,c as p,o as u,a as e,n as f,h as $,v as B,k as c,F,A as U,t as a,i as V}from"./index-CabKQ0b-.js";import{_ as H}from"./EmployeeFilter-CPisNvuD.js";import{L as P}from"./LoaderView-BitsNuiu.js";import{u as S}from"./overtime-B0smoURf.js";import"./company-08roQS6w.js";import"./department-BdMEuIwP.js";import"./EmployeeDropdownInput-DDCuQa04.js";import"./SelectDropdown-Buo2n_3h.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-9Fgm47W6.js";const j={class:"space-y-2 px-4"},z={class:"flex flex-wrap items-center gap-2"},G={key:0,class:"text-center py-4"},I={key:1,class:"space-y-4"},J={key:0,class:"overflow-x-auto"},K={class:"table-auto w-full border text-sm bg-white"},Q={class:"border p-2"},W={class:"border p-2"},X={class:"border p-2"},Y={class:"border p-2"},Z={class:"border p-2 text-center"},ee={class:"border p-2 text-center"},te={class:"border p-2 text-center"},oe={class:"border p-2 text-center print:hidden"},se={class:"flex justify-center items-center gap-4"},le={class:"bg-gray-50 font-semibold"},re={class:"border p-2 text-center"},ne={class:"border p-2 text-center"},ae={class:"border p-2 text-center"},ie={key:1,class:"text-center text-red-500 text-xl italic mt-10"},he={__name:"OvertimeReport",setup(de){const _=N(),i=O(),d=S(),{reports:v,loading:g,selectedMonth:q}=A(d),r=h(i.query.date||q.value),s=h({company_id:i.query.company_id||"",department_id:i.query.department_id||"all",line_type:i.query.line_type||"all",employee_id:i.query.employee_id||""}),C=async()=>{var n,t,l,o;_.replace({query:{...i.query,company_id:(n=s.value)==null?void 0:n.company_id,department_id:(t=s.value)==null?void 0:t.department_id,line_type:(l=s.value)==null?void 0:l.line_type,employee_id:(o=s.value)==null?void 0:o.employee_id}}),s.value.company_id&&r.value&&d.getCompanyDepartmentOvertimeReport(r.value,s.value)},k=()=>{_.replace({query:{...i.query,date:r.value}}),s.value.company_id&&r.value&&d.getCompanyDepartmentOvertimeReport(r.value,s.value)},M=()=>_.go(-1),w=()=>{r.value&&d.exportCompanyDepartmentOvertimeExcel(r.value,s.value)},R=()=>{r.value&&d.exportCompanyDepartmentOvertimePdf(r.value,s.value)};E(()=>{s.value.company_id&&r.value&&d.getCompanyDepartmentOvertimeReport(r.value,s.value)});const x=n=>{if(n==null||n==="")return 0;if(typeof n=="number")return Math.round(n*60);if(typeof n=="string"){const t=n.trim();if(/^\d+:\d{1,2}$/.test(t)){const[o,m]=t.split(":").map(D=>Number(D)||0);return o*60+m}const l=Number(t);if(!Number.isNaN(l))return Math.round(l*60)}return 0},b=n=>{const t=Math.floor(n/60),l=n%60;return`${t}h ${l}m`},y=L(()=>(v.value||[]).reduce((t,l)=>(t.entries+=Number(l==null?void 0:l.total_overtime_entries)||0,t.requestedMin+=x(l==null?void 0:l.total_request_overtime_hours),t.approvedMin+=x(l==null?void 0:l.total_approval_overtime_hours),t),{entries:0,requestedMin:0,approvedMin:0}));return(n,t)=>{const l=T("RouterLink");return u(),p("div",j,[e("div",{class:"flex items-center justify-between gap-2"},[e("button",{class:"btn-3",onClick:M},t[6]||(t[6]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[9]||(t[9]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Overtime Report",-1)),e("div",{class:"flex gap-2"},[e("button",{onClick:w,class:"btn-3",title:"Download Excel"},t[7]||(t[7]=[e("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)])),e("button",{onClick:R,class:"btn-3",title:"Download PDF"},t[8]||(t[8]=[e("i",{class:"far fa-file-pdf text-2xl text-red-500"},null,-1)]))])]),e("div",z,[f(H,{company_id:s.value.company_id,"onUpdate:company_id":t[0]||(t[0]=o=>s.value.company_id=o),department_id:s.value.department_id,"onUpdate:department_id":t[1]||(t[1]=o=>s.value.department_id=o),employee_id:s.value.employee_id,"onUpdate:employee_id":t[2]||(t[2]=o=>s.value.employee_id=o),line_type:s.value.line_type,"onUpdate:line_type":t[3]||(t[3]=o=>s.value.line_type=o),"with-type":!0,"initial-value":n.$route.query,onFilterChange:C},null,8,["company_id","department_id","employee_id","line_type","initial-value"]),e("div",null,[$(e("input",{id:"user-filter","onUpdate:modelValue":t[4]||(t[4]=o=>r.value=o),onChange:k,type:"month",class:"input-1"},null,544),[[B,r.value]])]),e("div",null,[e("button",{onClick:t[5]||(t[5]=o=>c(d).getCompanyDepartmentOvertimeReport(r.value,s.value)),class:"btn-3"},t[10]||(t[10]=[e("i",{class:"far fa-sync"},null,-1),e("span",null,"Refresh",-1)]))])]),c(g)?(u(),p("div",G,[f(P)])):(u(),p("div",I,[c(v).length?(u(),p("div",J,[e("table",K,[t[14]||(t[14]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"border p-2 text-left"},"#"),e("th",{class:"border p-2 text-left"},"Employee"),e("th",{class:"border p-2 text-left"},"Company"),e("th",{class:"border p-2 text-left"},"Department"),e("th",{class:"border p-2 text-center"},"Overtime Entries"),e("th",{class:"border p-2 text-center"},"Total Request Hours"),e("th",{class:"border p-2 text-center"},"Total Approval Hours"),e("th",{class:"border p-2 text-center print:hidden"},"Action")])],-1)),e("tbody",null,[(u(!0),p(F,null,U(c(v),(o,m)=>(u(),p("tr",{key:m,class:"hover:bg-blue-50"},[e("td",Q,a(m+1),1),e("td",W,a(o.user_name||"N/A"),1),e("td",X,a(o.company_name||"N/A"),1),e("td",Y,a(o.department_name||"N/A"),1),e("td",Z,a(o.total_overtime_entries),1),e("td",ee,a(o.total_request_overtime_hours),1),e("td",te,a(o.total_approval_overtime_hours),1),e("td",oe,[e("div",se,[f(l,{to:{name:"OvertimeList",query:{...s.value,employee_id:o.user_id,date:r.value}},class:"text-blue-800"},{default:V(()=>t[11]||(t[11]=[e("i",{class:"far fa-eye text-lg"},null,-1)])),_:2,__:[11]},1032,["to"])])])]))),128))]),e("tfoot",null,[e("tr",le,[t[12]||(t[12]=e("td",{class:"border p-2 text-left",colspan:"4"},"Totals",-1)),e("td",re,a(y.value.entries),1),e("td",ne,a(b(y.value.requestedMin)),1),e("td",ae,a(b(y.value.approvedMin)),1),t[13]||(t[13]=e("td",{class:"border p-2 print:hidden"},null,-1))])])])])):(u(),p("div",ie," No data available for this month. "))]))])}}};export{he as default};
