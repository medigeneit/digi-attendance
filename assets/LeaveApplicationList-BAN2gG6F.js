import{u as p,b as B,s as M,r as _,q as S,e as N,A as g,k as T,c as a,o as l,a as e,l as h,h as f,g as q,v as j,C as E,f as C,F as P,x as F,t as n,m as H,p as U}from"./index-l4XLehSa.js";import{L as $}from"./LoaderView-DUd6okPN.js";import{_ as I}from"./MultiselectDropdown-D4e9i3Ts.js";import{u as W}from"./leave-application-BPZb7a4N.js";import{u as z}from"./user-Cg1dUemw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue-multiselect.esm-BoJvfMpc.js";const G={class:"space-y-2 px-4"},J={class:"flex gap-2"},K={style:{width:"300px"}},O={key:0,class:"text-center py-4"},Q={key:1,class:"space-y-4"},X={class:"overflow-x-auto"},Y={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Z={class:"border border-gray-300 px-2"},ee={class:"border border-gray-300 px-2"},se={class:"border border-gray-300 px-2"},te={class:"border border-gray-300 px-2"},re={class:"border border-gray-300 px-2"},oe={class:"border border-gray-300 px-2"},de=["innerHTML"],le={class:"border border-gray-300 px-2"},ae={class:"border border-gray-300 px-2"},ne={class:"flex justify-center gap-2"},ue=["onClick"],ce={key:0},Ae={__name:"LeaveApplicationList",setup(ve){var k;const i=p(),o=B(),d=W(),m=z(),{leaveApplications:be,loading:V}=M(d),v=_(""),b=S(()=>{var r;return(r=v.value)==null?void 0:r.id}),u=_(((k=o==null?void 0:o.query)==null?void 0:k.date)||d.selectedMonth),x=_("");N(async()=>{var r;V.value=!0,await m.fetchUsers(),v.value=m.users.find(t=>{var c;return t.id==((c=o==null?void 0:o.query)==null?void 0:c.user_id)}),x.value=((r=o==null?void 0:o.query)==null?void 0:r.search)||"",await y()});const D=()=>{i.go(-1)},y=async()=>{b.value?await d.fetchLeaveApplications({user_id:b.value,selectedDate:u.value,selectedStatus:d.selectedStatus,query:x.value}):await d.fetchLeaveApplications({selectedStatus:d.selectedStatus,selectedDate:u.value,query:x.value})},A=S(()=>d.leaveApplications);g([b],y),g(b,r=>{i.replace({query:{...o.query,user_id:r}})}),g(u,r=>{i.replace({query:{...o.query,date:r}})});const R=async r=>{confirm("Are you sure to delete this application?")&&d.deleteLeaveApplication(r)};return(r,t)=>{const c=T("RouterLink");return l(),a("div",G,[e("div",{class:"flex items-center justify-between gap-2"},[e("button",{class:"btn-3",onClick:D},t[3]||(t[3]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[4]||(t[4]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Leave Applications",-1)),t[5]||(t[5]=e("div",null,null,-1))]),e("div",J,[e("div",K,[h(I,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=s=>v.value=s),options:f(m).users,multiple:!1,label:"label",placeholder:"Select user"},null,8,["modelValue","options"])]),e("div",null,[q(e("input",{id:"monthSelect",type:"month","onUpdate:modelValue":t[1]||(t[1]=s=>u.value=s),onChange:y,class:"input-1"},null,544),[[j,u.value]])]),e("div",null,[q(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>f(d).selectedStatus=s),onChange:y,class:"input-1"},t[6]||(t[6]=[e("option",{value:"",selected:""},"All",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Approved"},"Approved",-1),e("option",{value:"Rejected"},"Rejected",-1)]),544),[[E,f(d).selectedStatus]])])]),f(d).loading?(l(),a("div",O,[h($)])):(l(),a("div",Q,[e("div",X,[e("table",Y,[t[11]||(t[11]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-300 px-2 text-left"},"#"),e("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),e("th",{class:"border border-gray-300 px-2 text-left"},"Last Working Day"),e("th",{class:"border border-gray-300 px-2 text-left"},"Resumption Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Leave Period"),e("th",{class:"border border-gray-300 px-2 text-left"},"Total Days"),e("th",{class:"border border-gray-300 px-2 text-left"},"Status"),e("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),e("tbody",null,[(l(!0),a(P,null,F(A.value,(s,L)=>{var w;return l(),a("tr",{key:L,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",Z,n(L+1),1),e("td",ee,n(((w=s==null?void 0:s.user)==null?void 0:w.name)||"Unknown"),1),e("td",se,n(s==null?void 0:s.last_working_date),1),e("td",te,n(s==null?void 0:s.resumption_date),1),e("td",re,n(s==null?void 0:s.leave_period),1),e("td",oe,[e("div",{innerHTML:s.duration||(s==null?void 0:s.total_leave_days)},null,8,de)]),e("td",le,n((s==null?void 0:s.status)||"N/A"),1),e("td",ae,[e("div",ne,[h(c,{to:{name:"LeaveApplicationShow",params:{id:s==null?void 0:s.id}},class:"btn-icon"},{default:U(()=>t[7]||(t[7]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[7]},1032,["to"]),(s==null?void 0:s.status)!=="Approved"?(l(),H(c,{key:0,to:{name:"LeaveApplicationEdit",params:{id:s==null?void 0:s.id}},class:"btn-icon"},{default:U(()=>t[8]||(t[8]=[e("i",{class:"far fa-edit text-orange-600"},null,-1)])),_:2,__:[8]},1032,["to"])):C("",!0),e("button",{onClick:ye=>R(s==null?void 0:s.id),class:"btn-icon text-red-500"},t[9]||(t[9]=[e("i",{class:"far fa-trash"},null,-1)]),8,ue)])])])}),128)),A.value.length===0?(l(),a("tr",ce,t[10]||(t[10]=[e("td",{colspan:"7",class:"p-1 text-center text-red-500"},"No application found",-1)]))):C("",!0)])])])]))])}}};export{Ae as default};
