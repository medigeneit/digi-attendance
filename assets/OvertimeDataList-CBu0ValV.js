import{r as k,e as K,$ as W,c as i,o as a,a as e,g as y,t as n,y as f,F as A,M as J,b as Y,u as Z,d as ee,a3 as te,p as G,C as se,x as re,n as oe,k as _,f as ne,i as ae}from"./index-R7vZ2RpN.js";import{u as B}from"./overtime-GIxFp7ll.js";import{_ as le}from"./AcceptAndRejectHandler-jOsy7yWZ.js";import{_ as w}from"./DisplayFormattedWorkingHours-VZebGqYs.js";import{_ as ie}from"./TimePickerAsFloatHour-D2JOxD-X.js";const de={key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50"},ce={class:"modal-card max-w-sm p-4"},ue={class:"grid grid-cols-3 gap-2 border p-3"},pe={class:"border-x"},me={class:"col-span-full text-xs md:text-sm border-t pt-3"},ye={class:"flex justify-between gap-2 mt-2"},fe={__name:"DeleteOvertime",props:{overtime:Object,onSuccess:{type:Function,default:null}},setup(r){const u=r,b=B(),p=k(null),g=k(null),c=k(!1),x=async()=>{await b.deleteOvertime(u.overtime.id),u.onSuccess&&await u.onSuccess(),v()},S=()=>{c.value=!0,t()},v=()=>{c.value=!1};function t(){J(()=>{var m;(m=p.value)==null||m.focus()})}function d(m){var l,o;c.value&&(m.key==="ArrowLeft"?(l=g.value)==null||l.focus():m.key==="ArrowRight"&&((o=p.value)==null||o.focus()))}return K(()=>{window.addEventListener("keydown",d)}),W(()=>{window.removeEventListener("keydown",d)}),(m,l)=>(a(),i(A,null,[e("i",{onClick:S,class:"fa fa-trash cursor-pointer text-red-600"}),c.value?(a(),i("div",de,[e("div",ce,[l[0]||(l[0]=e("h3",{class:"title-lg"},"Delete Overtime",-1)),e("div",ue,[e("div",null,[e("b",null,n(new Date(r.overtime.date).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})),1)]),e("div",pe,[e("b",null,n(r.overtime.duty_type),1)]),e("div",null,[e("b",null,[f(w,{workingHours:r.overtime.request_overtime_hours},null,8,["workingHours"])])]),e("div",me,n(r.overtime.work_details),1)]),e("div",ye,[e("button",{type:"button",ref_key:"cancelBtnRef",ref:g,class:"btn-3 focus:ring-2 ring-offset-2",onClick:v}," Cancel ",512),e("button",{type:"button",ref_key:"confirmBtnRef",ref:p,class:"btn-2-red focus:ring-2 ring-offset-2",onClick:x}," Delete ",512)])])])):y("",!0)],64))}},be={key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50"},ge={class:"modal-card max-w-sm"},xe={class:"flex justify-between gap-2 mt-4"},_e={__name:"UpdateApprovalTime",props:{overtime:Object,onSuccess:{type:Function,default:null}},setup(r){const u=r,b=B(),p=k(null),g=k(null),c=k(!1),x=k(u.overtime.approval_overtime_hours||u.overtime.request_overtime_hours||""),S=async()=>{if(!x.value)return alert("Please set approval time!");await b.updateApprovalTime(u.overtime.id,x.value),u.onSuccess&&await u.onSuccess(),t()},v=()=>{c.value=!0,d()},t=()=>{c.value=!1};function d(){J(()=>{var l;(l=p.value)==null||l.focus()})}function m(l){var o,h;c.value&&(l.key==="ArrowLeft"?(o=g.value)==null||o.focus():l.key==="ArrowRight"&&((h=p.value)==null||h.focus()))}return K(()=>{window.addEventListener("keydown",m)}),W(()=>{window.removeEventListener("keydown",m)}),(l,o)=>(a(),i(A,null,[e("i",{onClick:v,class:"fa fa-edit cursor-pointer text-sky-600"}),c.value?(a(),i("div",be,[e("div",ge,[o[1]||(o[1]=e("h3",{class:"title-lg"},"Update Approval Time",-1)),o[2]||(o[2]=e("hr",{class:"my-2"},null,-1)),f(ie,{modelValue:x.value,"onUpdate:modelValue":o[0]||(o[0]=h=>x.value=h),"minute-interval":5,required:!0,"hour-min":1,"hour-max":16},null,8,["modelValue"]),o[3]||(o[3]=e("hr",{class:"my-2"},null,-1)),e("div",xe,[e("button",{type:"button",ref_key:"cancelBtnRef",ref:g,class:"btn-3 focus:ring-2 ring-offset-2",onClick:t}," Cancel ",512),e("button",{type:"button",ref_key:"confirmBtnRef",ref:p,class:"btn-2-green focus:ring-2 ring-offset-2",onClick:S}," Update Time ",512)])])])):y("",!0)],64))}},ve={class:"space-y-4"},he={class:"card-bg p-4 gap-1"},ke={class:"flex flex-wrap gap-x-8 gap-y-2"},we={key:0,class:"text-gray-700"},Se={class:"ml-1"},Ae={key:1,class:"text-gray-700"},Be={class:"ml-1"},De={key:2,class:"text-gray-700"},Ce={class:"ml-1"},Re={key:3,class:"text-gray-700"},$e={class:"ml-1"},Oe={key:4,class:"text-gray-700"},He={class:"ml-1"},Le={class:"overflow-x-auto"},Ne={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},Me={class:"border border-gray-300 px-2 text-center"},je={class:"border border-gray-300 px-2 text-center"},Te={class:"border border-gray-300 px-2 text-center"},Ue={class:"border border-gray-300 px-2 text-center"},qe={class:"border border-gray-300 px-2 text-center"},Ee={class:"border border-gray-300 px-2 text-center"},Pe={class:"border border-gray-300 px-2 text-center"},Ve={class:"border border-gray-300 px-2 text-center"},Fe={class:"flex items-center justify-center gap-4"},Ie={class:"border border-gray-300 px-2 text-center"},ze={class:"border border-gray-300 px-2 text-center"},Ge={class:"border border-gray-300 px-2 text-center !py-0.5"},Ke={class:"flex items-center justify-center gap-x-4"},We={key:0,class:"border border-dashed px-4 rounded-xl"},Je={key:0},Qe={key:0,class:"bg-gray-50"},Xe={class:"*:py-2 font-semibold"},Ye={class:"border border-gray-300 px-2 text-center"},Ze={class:"border border-gray-300 px-2 text-center"},nt={__name:"OvertimeDataList",props:{user:Object,onUpdate:{type:Function,default:null}},setup(r){Y(),Z();const u=ee(),b=B(),p=te(),g=r,c=async()=>{g.onUpdate?await g.onUpdate():await p.fetchCountNotifications()},x=G(()=>(b.overtimes||[]).reduce((t,d)=>t+(Number(d==null?void 0:d.request_overtime_hours)||0),0)),S=G(()=>(b.overtimes||[]).reduce((t,d)=>t+(Number(d==null?void 0:d.approval_overtime_hours)||0),0));return(v,t)=>{var m,l,o,h,D,C,R,$,O,H,L,N,M,j,T,U;const d=se("RouterLink");return a(),i("div",ve,[e("div",he,[e("div",ke,[(m=r.user)!=null&&m.employee_id?(a(),i("p",we,[t[0]||(t[0]=e("span",{class:"text-gray-400"},"Employee ID:",-1)),e("strong",Se,n(((l=r.user)==null?void 0:l.employee_id)||"N/A"),1)])):y("",!0),(o=r.user)!=null&&o.name?(a(),i("p",Ae,[t[1]||(t[1]=e("span",{class:"text-gray-400"},"Name:",-1)),e("strong",Be,n((h=r.user)==null?void 0:h.name),1)])):y("",!0),(C=(D=r.user)==null?void 0:D.designation)!=null&&C.title?(a(),i("p",De,[t[2]||(t[2]=e("span",{class:"text-gray-400"},"Designation:",-1)),e("strong",Ce,n((($=(R=r.user)==null?void 0:R.designation)==null?void 0:$.title)||"N/A"),1)])):y("",!0),(H=(O=r.user)==null?void 0:O.department)!=null&&H.name?(a(),i("p",Re,[t[3]||(t[3]=e("span",{class:"text-gray-400"},"Department:",-1)),e("strong",$e,n(((N=(L=r.user)==null?void 0:L.department)==null?void 0:N.name)||"N/A"),1)])):y("",!0),(M=r.user)!=null&&M.phone?(a(),i("p",Oe,[t[4]||(t[4]=e("span",{class:"text-gray-400"},"Phone:",-1)),e("strong",He,n((j=r.user)==null?void 0:j.phone),1)])):y("",!0)])]),e("div",Le,[e("table",Ne,[t[11]||(t[11]=e("thead",null,[e("tr",{class:"bg-gray-200 *:py-1"},[e("th",{class:"border border-gray-300 px-2 text-center"},"#"),e("th",{class:"border border-gray-300 px-2 text-center"},"Date"),e("th",{class:"border border-gray-300 px-2 text-center"},"Type"),e("th",{class:"border border-gray-300 px-2 text-center"},"Shift"),e("th",{class:"border border-gray-300 px-2 text-center"},"Check-In"),e("th",{class:"border border-gray-300 px-2 text-center"},"Check-Out"),e("th",{class:"border border-gray-300 px-2 text-center"},"Working (hour)"),e("th",{class:"border border-gray-300 px-2 text-center"},"Request (hour)"),e("th",{class:"border border-gray-300 px-2 text-center"},"Approved (hour)"),e("th",{class:"border border-gray-300 px-2 text-center"},"Details"),e("th",{class:"border border-gray-300 px-2 text-center"},"Status"),e("th",{class:"border border-gray-300 px-2 text-center"},"Action")])],-1)),e("tbody",null,[(a(!0),i(A,null,re(_(b).overtimes,(s,Q)=>{var q,E,P,V,F,I,z;return a(),i("tr",{key:s==null?void 0:s.id,class:"border-b border-gray-200 hover:bg-blue-200 *:py-2"},[e("td",Me,n(Q+1),1),e("td",je,n(new Date(s.date).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})),1),e("td",Te,n(s.duty_type),1),e("td",Ue,n(s.shift),1),e("td",qe,n(s.check_in||"- : -"),1),e("td",Ee,n(s.check_out||"- : -"),1),e("td",Pe,[f(w,{workingHours:s.working_hours},null,8,["workingHours"])]),e("td",Ve,[f(w,{workingHours:s.request_overtime_hours},null,8,["workingHours"])]),e("td",{class:oe(["border border-gray-300 px-2 text-center",{"bg-red-500/50":!s.approval_overtime_hours&&(s.recommend_by_user_id===((q=_(u).user)==null?void 0:q.id)||((P=(E=_(p).applicationApprovalPermissions)==null?void 0:E[s.id])==null?void 0:P.allow_recommend_by))}])},[e("div",Fe,[f(w,{workingHours:s.approval_overtime_hours},null,8,["workingHours"]),s.recommend_by_user_id===((V=_(u).user)==null?void 0:V.id)||(I=(F=_(p).applicationApprovalPermissions)==null?void 0:F[s.id])!=null&&I.allow_recommend_by?(a(),ne(_e,{key:0,overtime:s,onSuccess:c},null,8,["overtime"])):y("",!0)])],2),e("td",Ie,n(s.work_details||""),1),e("td",ze,n(s.status||"Pending"),1),e("td",Ge,[e("div",Ke,[s.approval_overtime_hours&&Object.values(((z=_(p).applicationApprovalPermissions)==null?void 0:z[s.id])||{}).some(X=>X)?(a(),i("div",We,[f(le,{class:"ml-auto",notificationType:"overtime_applications",applicationId:s.id,onSuccess:c,variant:1},null,8,["applicationId"])])):y("",!0),f(d,{to:{name:"MyOvertimeShow",params:{id:s.id}},class:"text-blue-800"},{default:ae(()=>t[5]||(t[5]=[e("i",{class:"far fa-eye text-lg"},null,-1)])),_:2,__:[5]},1032,["to"]),f(fe,{overtime:s,onSuccess:c},null,8,["overtime"])])])])}),128)),((T=_(b).overtimes)==null?void 0:T.length)===0?(a(),i("tr",Je,t[6]||(t[6]=[e("td",{colspan:"100",class:"p-2 text-center text-red-500"},"No overtimes found",-1)]))):y("",!0)]),(U=_(b).overtimes)!=null&&U.length?(a(),i("tfoot",Qe,[e("tr",Xe,[t[7]||(t[7]=e("td",{class:"border border-gray-300 px-2 text-right",colspan:"7"},"Totals",-1)),e("td",Ye,[f(w,{workingHours:x.value},null,8,["workingHours"])]),e("td",Ze,[f(w,{workingHours:S.value},null,8,["workingHours"])]),t[8]||(t[8]=e("td",{class:"border border-gray-300 px-2 text-center"},"—",-1)),t[9]||(t[9]=e("td",{class:"border border-gray-300 px-2 text-center"},"—",-1)),t[10]||(t[10]=e("td",{class:"border border-gray-300 px-2 text-center"},"—",-1))])])):y("",!0)])])])}}};export{nt as _};
