import{Q as R,u as B,D as k,r as V,G as F,h as G,q as O,x as W,p as Y,c as s,o as d,a as l,w as $,k as n,v as i,j as f,H as a,F as u,e as y,t as v,m as w,n as T,d as L,b as D,aa as z,s as H,l as J}from"./index-BXiBRMZd.js";import{S as Q}from"./WeekendAssignModal--5OFW5Qz.js";import{u as K}from"./company-Cc8aY4qC.js";import{u as X}from"./department-BTANqMsz.js";import{u as Z}from"./designation-DctwnCXL.js";import{u as h}from"./leave-approval-BrZW0Skq.js";import{u as c}from"./user-CR5CRYNW.js";import{d as ee}from"./dayjs.min-Bqu5AcVt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"my-container space-y-2"},oe={class:"card-bg md:p-8 p-4 mx-4"},te={class:"grid gap-4"},ne={class:"border p-4 rounded-md bg-gray-100"},se={class:"grid md:grid-cols-2 gap-4"},de={class:"border p-4 rounded-md bg-gray-100"},re={class:"grid md:grid-cols-2 gap-4"},ie=["value"],ae=["value"],ue=["value"],pe={class:""},ve={key:0,class:"flex gap-2 md:gap-4 bg-white p-2 border rounded mt-1"},me=["value"],ye=["value"],be={class:"border p-4 rounded-md bg-gray-100"},fe={class:"grid md:grid-cols-4 gap-4"},we={class:"relative"},ge=["type"],Se={class:"flex justify-center gap-4"},Le={__name:"UserAdd",setup(xe){const g=R(),M=B(),S=c(),x=K(),P=X(),A=Z(),U=h(),{designations:j}=k(A),{companies:E}=k(x),{error:C}=k(S),b=V(!1),_=V(!1),t=F({name:"",phone:"",email:"",password:"",role:"employee",type:"",address:"",device_user_id:null,is_active:!0,company_id:"",department_id:"",designation_id:"",shift_id:"",nid:"",date_of_birth:"",joining_date:"",employment_type:"Probationary",provisional_month:0,extended_provisional_month:0,employee_id:"",weekends:[],leave_approval_id:"",other_approval_id:""}),m=V({weekends:[],start_month:ee(new Date).format("YYYY-MM")||"",end_month:""});G(async()=>{await x.fetchCompanies(),await U.fetchLeaveApprovals()}),O(()=>t.company_id,async r=>{r&&(await P.fetchDepartments(r),await A.fetchDesignations(r),t.department_id="",t.designation_id="",t.shift_id="")});const q=r=>{m.value=r},I=async()=>{var r,e;try{const p={name:t.name,phone:t.phone,email:t.email,password:t.password,role:t.role,type:t.type,address:t.address,device_user_id:t.device_user_id,is_active:t.is_active,company_id:t.company_id,department_id:t.department_id,designation_id:t.designation_id,nid:t.nid,date_of_birth:t.date_of_birth,joining_date:t.joining_date,employee_id:t.employee_id,employment_type:t.employment_type,provisional_month:t.provisional_month,extended_provisional_month:t.extended_provisional_month,weekends:t.weekends,selected_weekend:m.value,leave_approval_id:t.leave_approval_id,other_approval_id:t.other_approval_id};await S.createUser(p),C.value?g.error(C.value):(g.success("User created successfully"),await S.fetchUsers(),M.replace("/settings/user-list"))}catch(p){const o=((e=(r=p.response)==null?void 0:r.data)==null?void 0:e.message)||"Failed to save user";g.error(o),console.error(o)}},N=W(()=>{var e;const r=(e=x.companies.find(p=>p.id===t.company_id))==null?void 0:e.name;return r?j.value[r]||[]:[]});return(r,e)=>{const p=Y("RouterLink");return d(),s("div",le,[l("div",oe,[e[64]||(e[64]=l("h2",{class:"title-lg text-center"},"Add Employee",-1)),l("form",{onSubmit:$(I,["prevent"]),class:"space-y-4"},[l("div",te,[l("div",ne,[e[30]||(e[30]=l("p",{class:"title-md"},"Personal Info",-1)),e[31]||(e[31]=l("hr",{class:"my-2"},null,-1)),l("div",se,[l("div",null,[e[24]||(e[24]=l("label",null,"Name",-1)),n(l("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.name=o),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[i,t.name]])]),l("div",null,[e[25]||(e[25]=l("label",null,"Phone",-1)),n(l("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.phone=o),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[i,t.phone]])]),l("div",null,[e[26]||(e[26]=l("label",null,"Email",-1)),n(l("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.email=o),type:"email",class:"w-full p-2 border rounded"},null,512),[[i,t.email]])]),l("div",null,[e[27]||(e[27]=l("label",null,"Address",-1)),n(l("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>t.address=o),type:"text",class:"w-full p-2 border rounded"},null,512),[[i,t.address]])]),l("div",null,[e[28]||(e[28]=l("label",null,"NID",-1)),n(l("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>t.nid=o),type:"text",class:"w-full p-2 border rounded"},null,512),[[i,t.nid]])]),l("div",null,[e[29]||(e[29]=l("label",null,"Date of Birth",-1)),n(l("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>t.date_of_birth=o),type:"date",class:"w-full p-2 border rounded"},null,512),[[i,t.date_of_birth]])])])]),l("div",de,[e[53]||(e[53]=l("p",{class:"title-md"},"Professional Info",-1)),e[54]||(e[54]=l("hr",{class:"my-2"},null,-1)),l("div",re,[l("div",null,[e[33]||(e[33]=l("label",null,"Company",-1)),n(l("select",{id:"company_id","onUpdate:modelValue":e[6]||(e[6]=o=>t.company_id=o),class:"w-full border rounded px-3 py-2",required:""},[e[32]||(e[32]=l("option",{value:"",disabled:""},"Select a company",-1)),(d(!0),s(u,null,y(w(E),o=>(d(),s("option",{key:o==null?void 0:o.id,value:o==null?void 0:o.id},v(o==null?void 0:o.name),9,ie))),128))],512),[[a,t.company_id]])]),l("div",null,[e[35]||(e[35]=l("label",null,"Department",-1)),n(l("select",{"onUpdate:modelValue":e[7]||(e[7]=o=>t.department_id=o),class:"w-full p-2 border rounded"},[e[34]||(e[34]=l("option",{value:"",disabled:""},"Select a department",-1)),(d(!0),s(u,null,y(w(P).departments,o=>(d(),s("option",{key:o==null?void 0:o.id,value:o==null?void 0:o.id},v(o==null?void 0:o.name),9,ae))),128))],512),[[a,t.department_id]])]),l("div",null,[e[37]||(e[37]=l("label",null,"Designation",-1)),n(l("select",{"onUpdate:modelValue":e[8]||(e[8]=o=>t.designation_id=o),class:"w-full p-2 border rounded"},[e[36]||(e[36]=l("option",{value:"",disabled:""},"Select a designation",-1)),(d(!0),s(u,null,y(N.value,o=>(d(),s("option",{key:o==null?void 0:o.id,value:o==null?void 0:o.id},v(o==null?void 0:o.title),9,ue))),128))],512),[[a,t.designation_id]])]),l("div",null,[e[39]||(e[39]=l("label",null,"Employment Type",-1)),n(l("select",{"onUpdate:modelValue":e[9]||(e[9]=o=>t.employment_type=o),class:"w-full p-2 border rounded"},e[38]||(e[38]=[T('<option value="Probationary">Probationary</option><option value="Permanent">Permanent</option><option value="Part_Time">Part Time</option><option value="Remote">Remote</option><option value="Contract">Contract</option><option value="Freelance">Freelance</option><option value="Intern">Intern</option>',7)]),512),[[a,t.employment_type]])]),t.employment_type==="Probationary"?(d(),s(u,{key:0},[l("div",null,[e[40]||(e[40]=l("label",null,"Probationary (month)",-1)),n(l("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>t.provisional_month=o),type:"number",class:"w-full p-2 border rounded"},null,512),[[i,t.provisional_month]])]),l("div",null,[e[41]||(e[41]=l("label",null,"Extended Probationary (month)",-1)),n(l("input",{"onUpdate:modelValue":e[11]||(e[11]=o=>t.extended_provisional_month=o),type:"number",class:"w-full p-2 border rounded"},null,512),[[i,t.extended_provisional_month]])])],64)):f("",!0),l("div",null,[e[43]||(e[43]=l("label",null,"Line Type",-1)),n(l("select",{"onUpdate:modelValue":e[12]||(e[12]=o=>t.type=o),class:"w-full p-2 border rounded",required:""},e[42]||(e[42]=[T('<option value="">Select Line Type</option><option value="executive">Executive</option><option value="support_staff">Support Staff</option><option value="doctor">Doctor</option><option value="academy_body">Academy Body</option>',5)]),512),[[a,t.type]])]),l("div",null,[e[44]||(e[44]=l("label",null,"Joining Date",-1)),n(l("input",{"onUpdate:modelValue":e[13]||(e[13]=o=>t.joining_date=o),type:"date",class:"w-full p-2 border rounded"},null,512),[[i,t.joining_date]])]),l("div",pe,[l("button",{type:"button",class:"btn-2",onClick:e[14]||(e[14]=o=>_.value=!0)}," Select Weekends "),m.value?(d(),s("div",ve,[l("p",null,[e[45]||(e[45]=l("strong",null,"Weekends:",-1)),D(" "+v(m.value.weekends.join(", ")),1)]),l("p",null,[e[46]||(e[46]=l("strong",null,"Start Date:",-1)),D(" "+v(m.value.start_month),1)])])):f("",!0),L(Q,{isOpen:_.value,hasShift:m.value,onClose:e[15]||(e[15]=o=>_.value=!1),onUpdate:q},null,8,["isOpen","hasShift"])]),l("div",null,[e[48]||(e[48]=l("label",null,"Leave Approval Group",-1)),n(l("select",{"onUpdate:modelValue":e[16]||(e[16]=o=>t.leave_approval_id=o),class:"w-full p-2 border rounded"},[e[47]||(e[47]=l("option",{value:"",disabled:""},"Select Leave Approval Group",-1)),(d(!0),s(u,null,y(w(U).leaveApprovals,o=>(d(),s(u,{key:o.id},[o.type==="leave"?(d(),s("option",{key:0,value:o.id},v(o.name),9,me)):f("",!0)],64))),128))],512),[[a,t.leave_approval_id]])]),l("div",null,[e[50]||(e[50]=l("label",null,"Other Approval Group",-1)),n(l("select",{"onUpdate:modelValue":e[17]||(e[17]=o=>t.other_approval_id=o),class:"w-full p-2 border rounded"},[e[49]||(e[49]=l("option",{value:"",disabled:""},"Select Other Approval Group",-1)),(d(!0),s(u,null,y(w(U).leaveApprovals,o=>(d(),s(u,{key:o.id},[o.type==="other"?(d(),s("option",{key:0,value:o.id},v(o.name),9,ye)):f("",!0)],64))),128))],512),[[a,t.other_approval_id]])]),l("div",null,[e[52]||(e[52]=l("label",null,"Active Status",-1)),n(l("select",{"onUpdate:modelValue":e[18]||(e[18]=o=>t.is_active=o),class:"w-full p-2 border rounded"},e[51]||(e[51]=[l("option",{value:!0},"Active",-1),l("option",{value:!1},"Inactive",-1)]),512),[[a,t.is_active]])])])]),l("div",be,[e[60]||(e[60]=l("p",{class:"title-md"},"Technical Info",-1)),e[61]||(e[61]=l("hr",{class:"my-2"},null,-1)),l("div",fe,[l("div",null,[e[56]||(e[56]=l("label",null,"Role",-1)),n(l("select",{"onUpdate:modelValue":e[19]||(e[19]=o=>t.role=o),class:"w-full p-2 border rounded",required:""},e[55]||(e[55]=[l("option",{value:"employee"},"Employee",-1),l("option",{value:"admin"},"Admin",-1),l("option",{value:"super_admin"},"Super Admin",-1),l("option",{value:"developer"},"Developer",-1)]),512),[[a,t.role]])]),l("div",null,[e[57]||(e[57]=l("label",null,"Device User ID",-1)),n(l("input",{"onUpdate:modelValue":e[20]||(e[20]=o=>t.device_user_id=o),type:"number",placeholder:"1353",class:"w-full p-2 border rounded"},null,512),[[i,t.device_user_id]])]),l("div",null,[e[58]||(e[58]=l("label",null,"Employee ID",-1)),n(l("input",{"onUpdate:modelValue":e[21]||(e[21]=o=>t.employee_id=o),type:"text",class:"w-full p-2 border rounded",placeholder:"Employee ID : M123567",required:""},null,512),[[i,t.employee_id]])]),l("div",null,[e[59]||(e[59]=l("label",null,"Password",-1)),l("div",we,[n(l("input",{"onUpdate:modelValue":e[22]||(e[22]=o=>t.password=o),type:b.value?"text":"password",class:"w-full p-2 border rounded",required:""},null,8,ge),[[z,t.password]]),l("span",{class:"absolute inset-y-0 right-3 flex items-center cursor-pointer",onClick:e[23]||(e[23]=o=>b.value=!b.value)},[l("i",{class:H(b.value?"fas fa-eye-slash":"fas fa-eye")},null,2)])])])])])]),l("div",Se,[L(p,{to:{name:"UserList"},type:"button",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:J(()=>e[62]||(e[62]=[D(" Cancel ")])),_:1,__:[62]}),e[63]||(e[63]=l("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"}," Save ",-1))])],32)])])}}};export{Le as default};
