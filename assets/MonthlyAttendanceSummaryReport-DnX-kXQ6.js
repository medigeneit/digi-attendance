import{p as C,c as y,o as c,t as a,u as M,b as P,d as E,r as f,A as F,y as T,e as R,B as $,a as t,f as w,s as b,h as B,v as U,k as u,F as V,q as W,g as N,i as I,j}from"./index-CYLY5e6P.js";import{_ as O}from"./EmployeeFilter-Cd4tH1_N.js";import{L as Q}from"./LoaderView-Dvm0hjDp.js";import{u as z}from"./attendance-D7YWap4I.js";import{_ as G}from"./UpdateOrCreate-DA3xQtuS.js";import"./company-SkayvuxI.js";import"./department-BQpRDXqQ.js";import"./SelectDropdown-BMHsG4jH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-wHaeHovk.js";import"./TimePickerAsFloatHour-DIi8B-rC.js";const J={__name:"DisplayFormattedWorkingHours",props:["workingHours"],setup(h){const i=h,d=C(()=>{if(!i.workingHours)return"-";const _=Math.floor(i.workingHours),p=Math.round((i.workingHours-_)*60);return p?`${_}h ${p}m`:`${_}h`});return(_,p)=>(c(),y("span",null,a(d.value),1))}},K={class:"px-4 space-y-4"},X={class:"flex flex-wrap gap-4"},Y={class:"flex gap-4"},Z={key:1,class:"space-y-4"},g={key:0,class:"overflow-x-auto card-bg"},ee={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},te={class:"text-center text-sm"},se={class:"border px-2 py-0.5"},ae={class:"border px-2 py-0.5"},re={class:"border px-2 py-0.5"},ne={class:"border px-2 py-0.5"},de={class:"border px-2 py-0.5"},pe={class:"border px-2 py-0.5"},oe={class:"border px-2 py-0.5"},ce={class:"border px-2 py-0.5"},ie={class:"border px-2 py-0.5"},ye={class:"border px-2 py-0.5"},_e={class:"border px-2 py-0.5"},le={class:"border px-2 py-0.5"},ue={class:"border px-2 py-0.5"},me={class:"border px-2 py-0.5"},be={class:"border px-2 py-0.5"},he={class:"border px-2 py-0.5"},xe={class:"border py-0.5"},ve={class:"border-b border-black font-semibold text-green-600"},fe={class:"text-gray-600"},we={class:"border px-2 py-0.5"},ke={class:"border px-2 py-0.5"},He={class:"border px-2 py-0.5"},De={class:"border px-2 py-0.5"},Le={class:"border px-2 py-0.5"},qe={class:"border px-2 py-0.5"},Ae={class:"border px-2 py-0.5"},Se={class:"border px-2 py-0.5"},Ce={class:"border px-2 py-0.5"},Me={class:"border px-2 py-0.5"},Pe={class:"flex gap-2 items-center"},Ee={class:"border px-2 py-0.5"},Fe={class:"border px-4 py-0.5"},Te={key:1,class:"text-center text-red-500 text-xl italic mt-10"},ze={__name:"MonthlyAttendanceSummaryReport",setup(h){const i=M(),d=P(),_=E(),p=z(),o=f(d.query.date||p.selectedMonth),{monthly_company_summary:k}=F(p),r=f({company_id:d.query.company_id||"",department_id:d.query.department_id||"all",line_type:d.query.line_type||"all",employee_id:d.query.employee_id||""}),m=async()=>{const n=r.value.company_id,s=r.value.employee_id||"",l=r.value.line_type!=="all"?r.value.line_type:"";if(!n){alert("⚠️ Please select a company first.");return}try{await p.getMonthlyAttendanceSummaryReport(n,l,s,o.value)}catch(e){console.error("❌ Failed to load attendance:",e),alert("❌ Failed to load attendance data.")}},H=()=>{const n=d.query,s={...n,company_id:r.value.company_id,department_id:r.value.department_id,line_type:r.value.line_type,employee_id:r.value.employee_id,date:o.value};Object.keys(s).some(e=>n[e]!==String(s[e]))&&i.replace({query:s})};T(o,n=>{d.query.date!==n&&i.replace({query:{...d.query,date:n}})}),R(()=>{r.value.company_id&&m()});const D=async()=>{if(r.value.company_id){const n=r.value.line_type!=="all"?r.value.line_type:"";await p.downloadExcel(r.value.company_id,n,o.value)}},L=async()=>{if(r.value.company_id){const n=r.value.line_type!=="all"?r.value.line_type:"";await p.downloadPDF(r.value.company_id,n,o.value)}},q=()=>i.go(-1),A=async()=>{await m()};return(n,s)=>{const l=$("router-link");return c(),y("div",K,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:q},s[6]||(s[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),s[9]||(s[9]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Attendance Summary Report",-1)),t("div",{class:"flex gap-4"},[t("button",{type:"button",onClick:D,class:"btn-1"},s[7]||(s[7]=[t("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)])),t("button",{type:"button",onClick:L,class:"btn-1"},s[8]||(s[8]=[t("i",{class:"fal fa-file-pdf text-2xl text-red-500"},null,-1)]))])]),t("div",X,[b(O,{company_id:r.value.company_id,"onUpdate:company_id":s[0]||(s[0]=e=>r.value.company_id=e),department_id:r.value.department_id,"onUpdate:department_id":s[1]||(s[1]=e=>r.value.department_id=e),employee_id:r.value.employee_id,"onUpdate:employee_id":s[2]||(s[2]=e=>r.value.employee_id=e),line_type:r.value.line_type,"onUpdate:line_type":s[3]||(s[3]=e=>r.value.line_type=e),"with-type":!0,"initial-value":n.$route.query,onFilterChange:H},null,8,["company_id","department_id","employee_id","line_type","initial-value"]),t("div",Y,[B(t("input",{type:"month","onUpdate:modelValue":s[4]||(s[4]=e=>o.value=e),class:"input-1"},null,512),[[U,o.value]]),t("button",{type:"button",onClick:s[5]||(s[5]=e=>m()),class:"btn-2"},"Search")])]),u(p).isLoading?(c(),w(Q,{key:0})):(c(),y("div",Z,[r.value.company_id?(c(),y("div",g,[t("table",ee,[s[11]||(s[11]=t("thead",{class:"sticky top-0 z-10 bg-white shadow-sm"},[t("tr",{class:"bg-gray-100 text-sm"},[t("th",{rowspan:"2",class:"border px-1 py-0.5"},"#"),t("th",{rowspan:"2",class:"border px-1 py-0.5"},"Employee Name"),t("th",{rowspan:"2",class:"border px-1 py-0.5"},"Designation"),t("th",{colspan:"5",class:"border px-1 py-0.5"},"Attendance Summary"),t("th",{colspan:"2",class:"border px-1 py-0.5"},"Actual Late"),t("th",{colspan:"2",class:"border px-1 py-0.5"},"Remaining Late"),t("th",{colspan:"2",class:"border px-1 py-0.5"},"Actual Early"),t("th",{colspan:"2",class:"border px-1 py-0.5"},"Remaining Early"),t("th",{rowspan:"2",class:"border px-1 py-0.5"},"Working Hour"),t("th",{colspan:"4",class:"border px-1 py-0.5"},"Leave Day"),t("th",{colspan:"2",class:"border px-1 py-0.5"},"Short Leave"),t("th",{rowspan:"2",class:"border px-1 py-0.5"},"OT Hour"),t("th",{colspan:"4",class:"border px-1 py-0.5"},"Deduction"),t("th",{rowspan:"2",class:"border px-8 py-0.5"},"Action")]),t("tr",{class:"bg-gray-100 text-xs"},[t("th",{class:"border px-2 py-0.5"},"TD"),t("th",{class:"border px-2 py-0.5"},"TP"),t("th",{class:"border px-2 py-0.5"},"TW"),t("th",{class:"border px-2 py-0.5"},"TL"),t("th",{class:"border px-2 py-0.5"},"TA"),t("th",{class:"border px-1 py-0.5"},"Day"),t("th",{class:"border px-2 py-0.5"},"Hour"),t("th",{class:"border px-1 py-0.5"},"Day"),t("th",{class:"border px-2 py-0.5"},"Hour"),t("th",{class:"border px-1 py-0.5"},"Day"),t("th",{class:"border px-2 py-0.5"},"Hour"),t("th",{class:"border px-1 py-0.5"},"Day"),t("th",{class:"border px-2 py-0.5"},"Hour"),t("th",{class:"border px-2 py-0.5"},"CL"),t("th",{class:"border px-2 py-0.5"},"ML"),t("th",{class:"border px-2 py-0.5"},"SL"),t("th",{class:"border px-2 py-0.5"},"WPL"),t("th",{class:"border px-2 py-0.5"},"Delay"),t("th",{class:"border px-2 py-0.5"},"Early"),t("th",{class:"border px-2 py-0.5"},"Absent Hour"),t("th",{class:"border px-2 py-0.5"},"WPL(Hour)"),t("th",{class:"border px-2 py-0.5"},"Pay Cut"),t("th",{class:"border px-2 py-0.5"},"Payable Hour")])],-1)),t("tbody",te,[(c(!0),y(V,null,W(u(k),(e,S)=>{var x,v;return c(),y("tr",{key:e==null?void 0:e.date,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",se,a(S+1),1),t("td",ae,a(e==null?void 0:e.user),1),t("td",re,a(e==null?void 0:e.designation),1),t("td",ne,a(e==null?void 0:e.total_monthly_days),1),t("td",de,a(e==null?void 0:e.total_present),1),t("td",pe,a(e==null?void 0:e.total_weekend),1),t("td",oe,a(e==null?void 0:e.total_leave),1),t("td",ce,a(e==null?void 0:e.total_absent),1),t("td",ie,a(e==null?void 0:e.actual_late_day),1),t("td",ye,a(e==null?void 0:e.actual_late_hour),1),t("td",_e,a(e==null?void 0:e.total_remain_late_day),1),t("td",le,a(e==null?void 0:e.total_remain_late_hour),1),t("td",ue,a(e==null?void 0:e.actual_early_day),1),t("td",me,a(e==null?void 0:e.actual_early_hour),1),t("td",be,a(e==null?void 0:e.total_remain_early_day),1),t("td",he,a(e==null?void 0:e.total_remain_early_hour),1),t("td",xe,[t("div",ve,a((e==null?void 0:e.total_working_hours)||0),1),t("div",fe,a((e==null?void 0:e.total_shift_hour)||0),1)]),t("td",we,a(e==null?void 0:e.total_cl_leave),1),t("td",ke,a(e==null?void 0:e.total_ml_leave),1),t("td",He,a(e==null?void 0:e.total_sl_leave),1),t("td",De,a(e==null?void 0:e.total_wpl_leave),1),t("td",Le,a(e==null?void 0:e.total_first_short_leave),1),t("td",qe,a(e==null?void 0:e.total_last_short_leave),1),t("td",Ae,a(e!=null&&e.total_overtime_hours?(e==null?void 0:e.total_overtime_hours)+" H":""),1),t("td",Se,a((e==null?void 0:e.remain_total_absent)*9)+"H",1),t("td",Ce,a(e==null?void 0:e.total_wpl_hour)+"H",1),t("td",Me,[t("div",Pe,[b(J,{workingHours:(x=e==null?void 0:e.paycut)==null?void 0:x.paycut_hours},null,8,["workingHours"]),((v=u(_).user)==null?void 0:v.id)===8?(c(),w(G,{key:0,class:"mr-2",userId:e==null?void 0:e.user_id,month:o.value,onUpdated:A},null,8,["userId","month"])):N("",!0)])]),t("td",Ee,a(e==null?void 0:e.payable_hour)+"H",1),t("td",Fe,[b(l,{to:{name:"EmployeeAttendance",query:{...u(d).query,employee_id:e==null?void 0:e.user_id,date:o.value}},target:"_blank",class:"text-blue-500 hover:underline inline-flex items-center gap-1"},{default:I(()=>s[10]||(s[10]=[t("i",{class:"fas fa-calendar-check"},null,-1),j(" Go to ")])),_:2,__:[10]},1032,["to"])])])}),128))])])])):(c(),y("div",Te,"Please select company"))]))])}}};export{ze as default};
