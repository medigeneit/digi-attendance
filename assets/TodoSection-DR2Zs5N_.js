import{L as X}from"./LoaderView-JIMyBoEP.js";import{r as j,x as U,e as z,A as Y,c as v,o as l,J as N,a as t,F as W,y as G,t as $,g,w as D,q,n as L,f as P,G as le,i as E,d as oe,k as w,H as ie,j as F,h as J,v as Q,m as me,T as K,U as H}from"./index-uOuxETrS.js";import{f as ye,b as Z,g as de}from"./datetime-l2Vm98rT.js";import{u as V}from"./useTodoStore-7aE56jAO.js";import{_ as ve}from"./DraggableList.vue_vue_type_script_setup_true_lang-CgQwyNrz.js";import{_ as fe}from"./UserChip-CMXpw_pi.js";import{O as te}from"./OverlyModal-Dx8IUZxk.js";const pe={class:"grid grid-cols-7 *:text-center *:p-2 *:border-r *:border-b *:text-blue-800 *:text-sm"},ge={class:"flex flex-col"},be={key:0,class:"p-2 border-r border-t"},ke={__name:"CalenderView",props:{month:{type:String,required:!0,validator:o=>/^\d{4}-(0[1-9]|1[0-2])$/.test(o)}},emits:["change"],setup(o,{emit:C}){const a=o,s=C,y=j(),e=j(),c=j(),m=j(),d=["Saturday","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday"];function r(h,i,k,x){const b=[];for(let I=k-1;I>=0;I--){const p=x-I,M=new Date(h,i-1,p);b.push({date:M,day:M.getDate(),month:M.getMonth()+1,year:M.getFullYear(),isCurrentMonth:!1})}return b}function f(h,i,k){const x=[];for(let b=1;b<=k;b++){const p={date:new Date(h,i,b),day:b,month:i+1,year:h,isCurrentMonth:!0};x.push(p)}return x}function u(h,i,k){const x=[...h],b=Math.ceil(x.length/7)*7,I=1;for(let p=0;x.length<b;p++){const M=new Date(i,k+1,I+p);x.push({date:M,day:M.getDate(),month:M.getMonth()+1,year:M.getFullYear(),isCurrentMonth:!1})}return x}function n(h,i){const k=new Date(h,i,1),b=new Date(h,i+1,0).getDate(),p=(k.getDay()+1)%7,R=new Date(h,i,0).getDate();let O=[];O=[...r(h,i,p,R)];const A=f(h,i,b);return c.value=A[0],m.value=A[A.length-1],O=[...O,...A],O=[...u(O,h,i)],y.value=O[0],e.value=O[O.length-1],O}const S=U(()=>{const[h,i]=a.month.split("-"),k=parseInt(h),x=parseInt(i)-1;return console.log({yearStr:h,monthStr:i}),n(k,x)}),T=U(()=>{const h=S.value,i=[];for(let k=0;k<h.length;k+=7)i.push(h.slice(k,k+7));return i});function _(){s("change",{gridStartDate:y.value,gridEndDate:e.value,startOfMonth:c.value,endOfMonth:m.value})}return z(()=>_()),Y(()=>a.month,_),(h,i)=>(l(),v("div",null,[N(h.$slots,"calender-top"),t("div",pe,[(l(),v(W,null,G(d,k=>t("div",{key:k},$(k),1)),64))]),t("div",ge,[(l(!0),v(W,null,G(T.value,(k,x)=>(l(),v("div",{class:"week grid grid-cols-7 min-h-28 items-stretch",key:x},[(l(!0),v(W,null,G(k,(b,I)=>N(h.$slots,"date",{key:I,day:b.day,month:b.month,year:b.year,weekday:(b.date.getDay()+1)%7,isCurrentMonth:b.isCurrentMonth,yearMonthDate:`${b.year}-${String(b.month).padStart(2,"0")}-${String(b.day).padStart(2,"0")}`},()=>{var p;return[b!=null&&b.date?(l(),v("div",be,$((p=b==null?void 0:b.date)==null?void 0:p.getDate()),1)):g("",!0)]})),128))]))),128))]),N(h.$slots,"calender-bottom")]))}},he={class:"px-4 py-2 flex items-center bg-gray-50 group gap-2"},xe=["value"],Ce=["value"],we=["value"],De=["value"],$e=["disabled"],Te={key:4,class:"ml-4 md:ml-auto flex items-center gap-2"},Se={key:5,class:"ml-4 md:ml-auto flex items-center gap-2"},Me={__name:"TodoHeading",props:{selected:{type:Object,default:()=>({type:"month-view",month:"",day:"",year:"",week:""})},loading:{type:Boolean,default:!1}},emits:["reloadClick",,"change"],setup(o,{emit:C}){const a=o,s=[{value:"month-view",label:"Monthly"},{value:"day-view",label:"Daily"}],y=C,e=j();function c(i){e.value=i,y("change",{...a.selected,type:i})}Y(()=>{var i;return(i=a.selected)==null?void 0:i.type},i=>c(i),{immediate:!0});const m=U(()=>e.value=="month-view"&&a.selected.year&&a.selected.month?[a.selected.year,a.selected.month-1,1]:e.value=="day-view"&&a.selected.year&&a.selected.month&&a.selected.day?[a.selected.year,a.selected.month-1,a.selected.day]:[new Date().getFullYear(),new Date().getMonth(),new Date().getDate()]);function d(){e.value=="month-view"&&T(new Date)}function r(){if(e.value=="month-view"){const i=new Date(...m.value);i.setMonth(i.getMonth()+1),T(i)}}function f(){if(e.value=="month-view"){const i=new Date(...m.value);i.setMonth(i.getMonth()-1),T(i)}}function u(){e.value=="day-view"&&T(new Date)}function n(){if(e.value=="day-view"){const i=new Date(...m.value);i.setDate(i.getDate()+1),T(i)}}function S(){if(e.value=="day-view"){const i=new Date(...m.value);i.setDate(i.getDate()-1),T(i)}}function T(i){y("change",{type:e.value,month:i.getMonth()+1,day:i.getDate(),year:i.getFullYear(),week:i.getDay()})}const _=U(()=>e.value=="month-view"?`${a.selected.year}-${a.selected.month.toString().padStart(2,"0")}`:e.value=="day-view"?`${a.selected.year}-${a.selected.month.toString().padStart(2,"0")}-${a.selected.day.toString().padStart(2,"0")}`:a.selected),h=i=>{var k,x;if(e.value=="month-view"){const[b,I]=(k=i.target.value)==null?void 0:k.split("-").map(Number),p=new Date(b,I-1,1);T(p)}if(e.value=="day-view"){const b=new Date((x=i.target)==null?void 0:x.value);T(b)}};return(i,k)=>(l(),v("div",null,[t("div",he,[N(i.$slots,"before",{selected:o.selected}),N(i.$slots,"typeSelection",{selected:o.selected,types:s,changeType:c},()=>[t("select",{class:"px-2 h-7 border rounded",value:e.value,onChange:k[0]||(k[0]=x=>c(x.target.value))},[(l(),v(W,null,G(s,x=>t("option",{value:x.value,key:x.id},$(x.label),9,Ce)),64))],40,xe)]),e.value=="month-view"?(l(),v("input",{key:0,type:"month",value:_.value,onInput:h,class:"border px-2 rounded"},null,40,we)):g("",!0),e.value=="day-view"?(l(),v("input",{key:1,type:"date",value:_.value,onInput:h,class:"border px-2 rounded"},null,40,De)):g("",!0),e.value=="month-view"?(l(),v("button",{key:2,class:"btn-3 mx-4 h-7",onClick:D(d,["prevent"])}," Current Month ")):g("",!0),e.value=="day-view"?(l(),v("button",{key:3,class:"btn-3 mx-4 h-7",onClick:D(u,["prevent"])}," Today ")):g("",!0),t("button",{class:q(["btn-3 px-2 py-2 mx-4 size-7 disabled:text-gray-300 disabled:border-gray-300",{"animate-spin text-gray-300 border-gray-300 !bg-opacity-0":o.loading}]),onClick:k[1]||(k[1]=D(x=>y("reloadClick"),["prevent"])),disabled:o.loading},k[2]||(k[2]=[t("i",{class:"fas fa-redo-alt"},null,-1)]),10,$e),e.value=="month-view"?(l(),v("div",Te,[t("button",{class:"btn-3 h-7",onClick:D(f,["prevent"])}," Previous Month "),t("button",{class:"btn-3 h-7",onClick:D(r,["prevent"])},"Next Month")])):g("",!0),e.value=="day-view"?(l(),v("div",Se,[t("button",{class:"btn-3 h-7",onClick:D(S,["prevent"])},"Previous Day"),t("button",{class:"btn-3 h-7",onClick:D(n,["prevent"])},"Next Day")])):g("",!0),N(i.$slots,"after",{selected:o.selected})]),N(i.$slots,"bottom",{selected:o.selected})]))}},Ee={key:0,class:"fa fa-exclamation-square",title:"Pending"},Ie={key:1,class:"fa fa-pause",title:"Working"},Oe={key:2,class:"fa fa-check-square",title:"Completed"},ne={__name:"TodoStatusIcon",props:{todo:{type:Object,required:!0}},setup(o){const C=o,a=U(()=>{switch(C.todo.status){case"PENDING":return"text-red-400";case"WORKING":return"text-yellow-600";case"COMPLETED":return"text-green-400"}return""});return(s,y)=>(l(),v("span",{class:q(a.value)},[o.todo.status=="PENDING"?(l(),v("i",Ee)):g("",!0),o.todo.status=="WORKING"?(l(),v("i",Ie)):g("",!0),o.todo.status=="COMPLETED"?(l(),v("i",Oe)):g("",!0)],2))}},Re=["title","onClick"],Ne={class:"line-clamp-1"},Pe={key:0,class:"text-purple-600 text-center"},re={__name:"TodosInDate",props:{date:{type:String,required:!0},maxItems:{type:[Number,String],default:3}},emits:["clickTodo"],setup(o,{emit:C}){const a=o,s=C,{getTodosByDate:y}=V(),e=U(()=>{let c=[],m=!1,d=[];if(typeof y=="function"){const r=y(a.date);if(d=Array.isArray(r)?r:[],a.maxItems==="all")return{all:d,items:d,moreItemsCount:0};c=d.slice(0,a.maxItems),m=d.length-c.length}return{all:d,items:c,moreItemsCount:m}});return(c,m)=>(l(),v("div",null,[e.value.items.length===0?N(c.$slots,"noTodos",{key:0},()=>[m[0]||(m[0]=t("div",{class:"text-gray-400 text-center"},"No todos",-1))]):(l(),v(W,{key:1},[N(c.$slots,"todoItems",{todos:e.value.items,allTodos:e.value.items,moreItemsCount:e.value.moreItemsCount},()=>[(l(!0),v(W,null,G(e.value.items,d=>N(c.$slots,"todoItem",{key:d.id,todo:d,moreItemsCount:e.value.moreItemsCount},()=>{var r,f,u,n;return[t("div",{title:`${d==null?void 0:d.title} ${d!=null&&d.user?`
by:`:""} ${(r=d==null?void 0:d.user)==null?void 0:r.name} ${(f=d==null?void 0:d.user)!=null&&f.department?`
DEPT:`:""} ${(n=(u=d.user)==null?void 0:u.department)==null?void 0:n.name}`,class:q(["px-1 mb-2 text-sm rounded cursor-pointer flex items-center gap-2",{"bg-sky-50 text-sky-900 hover:bg-sky-700 hover:text-white border border-sky-300":d.status!=="COMPLETED","bg-green-500 text-white":d.status==="COMPLETED"}]),onClick:D(S=>s("clickTodo",d),["prevent","stop"])},[L(ne,{todo:d,class:q(["text-sm",[d.status=="COMPLETED"?"!text-white":""]])},null,8,["todo","class"]),t("div",Ne,$(d.title),1),d.user?(l(),P(le,{key:0,user:d.user,size:"xsmall",class:"ml-auto"},null,8,["user"])):g("",!0)],10,Re)]})),128))]),e.value.moreItemsCount>0?(l(),v("div",Pe," + "+$(e.value.moreItemsCount)+" more todo"+$(e.value.moreItemsCount>1?"s":""),1)):g("",!0)],64))]))}},Le={class:"relative"},je=["onClick","onKeypress"],_e={class:"flex items-center justify-center"},Ue=["onClick"],Ae={__name:"TodosInCalenderView",props:{month:{type:String,required:!0,validator:o=>/^\d{4}-(0[1-9]|1[0-2])$/.test(o)}},emits:["dateClick","clickTodo","clickDateCell"],setup(o,{emit:C}){const a=C;function s(e,c){e.isTrusted&&e.ctrlKey&&e.which==10&&a("dateClick",c)}function y(e){const[c,m,d]=String(e).split("-").map(Number),r=new Date(c,m-1,d);return ye(r)}return(e,c)=>(l(),v("div",Le,[o.month?(l(),P(ke,{key:0,month:o.month,class:"border-t border-blue-200/50 relative"},{date:E(({day:m,yearMonthDate:d,isCurrentMonth:r})=>[t("div",{tabindex:"0",class:q(["border p-4 cursor-pointer group/date relative focus:outline-slate-400",{"bg-sky-50   border-sky-300 focus:bg-sky-50 focus:outline-sky-400":y(d),"hover:bg-slate-50  hover:border-slate-300 focus:bg-slate-50 ":!y(d)}]),onClick:D(f=>a("dateClick",d),["prevent","stop"]),onKeypress:D(f=>s(f,d),["prevent"])},[t("button",{tabindex:"1",class:q([{"text-gray-300":!r,"text-sky-400":r},"text-center mb-2 font-semibold hover:bg-sky-200 w-full rounded"])},$(m),3),t("div",null,[L(re,{date:d,onClickTodo:c[0]||(c[0]=f=>a("clickTodo",f))},{noTodos:E(()=>c[1]||(c[1]=[t("span",null,null,-1)])),_:2},1032,["date"])]),t("div",_e,[t("button",{onClick:D(f=>a("clickDateCell",d),["prevent","stop"]),class:"btn-3 !py-1 invisible group-hover/date:visible text-sm text-red-800/40"},c[2]||(c[2]=[t("i",{class:"fas fa-plus"},null,-1),t("span",{class:"hidden lg:inline whitespace-nowrap"}," Add todo ",-1)]),8,Ue)])],42,je)]),_:1},8,["month"])):g("",!0)]))}},Fe={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},ue={__name:"DepartmentChip",props:{department:Object},setup(o){return(C,a)=>{var s;return l(),v("div",Fe,$((s=o.department)==null?void 0:s.name),1)}}},We={class:"ml-4"},qe={key:0,class:"mt-1 flex items-center gap-2"},Ve={key:0,class:"line-clamp-2 ml-4 text-gray-500"},Be={class:"ml-auto flex items-center gap-2"},Ge={key:0,class:"flex items-center gap-1 text-red-600"},ze={__name:"TodoItemCard",props:{todo:{type:Object,required:!0},hideDepartment:{type:Boolean,default:!1},hideUser:{type:Boolean,default:!1}},emits:["clickTodo","clickEdit","clickDelete","clickChangeStatus","clickDelete"],setup(o,{emit:C}){const a=oe(),s=C;return(y,e)=>{var c,m,d;return l(),v("div",{class:q(["px-4 py-2 cursor-pointer flex items-center",{"bg-green-100":o.todo.status=="COMPLETED","hover:bg-gray-50":o.todo.status!="COMPLETED"}]),onClick:e[4]||(e[4]=D(r=>s("clickTodo",o.todo),["prevent"]))},[L(ne,{todo:o.todo},null,8,["todo"]),t("div",We,[t("div",{class:q(["line-clamp-1",{"text-green-800":o.todo.status=="COMPLETED","text-blue-800":o.todo.status!="COMPLETED"}])},$(o.todo.id)+" - "+$(o.todo.title),3),o.todo.user?(l(),v("div",qe,[o.hideUser?g("",!0):(l(),P(fe,{key:0,user:o.todo.user,"avatar-size":"xsmall"},null,8,["user"])),o.hideDepartment?g("",!0):(l(),P(ue,{key:1,department:(m=(c=o.todo)==null?void 0:c.user)==null?void 0:m.department},null,8,["department"]))])):g("",!0)]),o.todo.todo_type&&o.todo.todo_type_id?(l(),v("div",Ve,$(o.todo.todo_type)+" id: "+$(o.todo.todo_type_id),1)):g("",!0),t("div",Be,[o.todo.status=="WORKING"?(l(),v("div",Ge,e[5]||(e[5]=[t("span",{class:"fas fa-circle animate-pulse text-xs"},null,-1),t("span",{class:"text-xs"},"Working",-1)]))):g("",!0),o.todo.user_id===((d=w(a).user)==null?void 0:d.id)?(l(),v(W,{key:1},[o.todo.status==="WORKING"?(l(),v("button",{key:0,title:"Mark as Completed",class:"btn-icon bg-transparent text-green-400 border-green-400 border hover:bg-green-400 hover:text-white",onClick:e[0]||(e[0]=D(()=>s("clickChangeStatus",o.todo,"COMPLETED"),["prevent","stop"]))},e[6]||(e[6]=[t("i",{class:"fas fa-check"},null,-1)]))):g("",!0),o.todo.status==="PENDING"?(l(),v("button",{key:1,title:"Start Working",class:"btn-icon bg-transparent text-red-400 border-red-400 border hover:bg-red-400 hover:text-white",onClick:e[1]||(e[1]=D(()=>s("clickChangeStatus",o.todo,"WORKING"),["prevent","stop"]))},e[7]||(e[7]=[t("i",{class:"fas fa-play ml-[4px]"},null,-1)]))):g("",!0),t("button",{class:"btn-icon bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:e[2]||(e[2]=D(r=>s("clickEdit",o.todo),["prevent","stop"]))},e[8]||(e[8]=[t("i",{class:"fas fa-pen"},null,-1)])),t("button",{class:"btn-icon bg-red-400 text-white hover:bg-red-600 hover:text-white",onClick:e[3]||(e[3]=D(()=>s("clickDelete",o.todo),["prevent","stop"]))},e[9]||(e[9]=[t("i",{class:"fas fa-trash-alt"},null,-1)]))],64)):g("",!0),t("button",{onClick:D(()=>null,["stop","prevent"]),class:"btn-icon bg-gray-400 text-white hover:bg-gray-600 hover:text-white handle"},e[10]||(e[10]=[t("i",{class:"fas fa-arrows-alt-v"},null,-1)]))])],2)}}},Ke={class:"border rounded-md"},He={class:"text-gray-700 bg-gradient-to-tl from-sky-400/60 to-sky-400 border-b py-2 px-4 flex items-center"},Ye={class:"font-semibold flex items-center gap-2"},Je={class:"text-white text-base"},Qe={class:"ml-auto flex items-center gap-2"},Xe={key:0,class:"flex items-center gap-3 mr-6"},Ze=["disabled"],et=["disabled"],tt=["date"],ot={key:1,class:"flex min-h-[38vh] items-center justify-center text-gray-400 text-center rounded-md"},nt={__name:"UserTodos",props:{todos:{type:Array,required:!0},user:{type:Object,required:!0},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickEdit","update"],setup(o,{emit:C}){const a=o,s=j(null),y=C,e=V();async function c(r){confirm(`Are your sure want to delete todo
'${r==null?void 0:r.title}'`)&&(await e.deleteTodo(r.id),y("update"))}async function m(r,f){confirm(`Are your sure?
want to change status to ${f} 
todo: '${r==null?void 0:r.title}'`)&&(await e.updateTodoStatus(r.id,f),y("update"))}async function d(){var f;const r=(f=s==null?void 0:s.value.items)==null?void 0:f.map(u=>u.id);await e.rearrangeMyTodos(r,{date:a.date}),y("update")}return(r,f)=>{var u,n;return l(),v("div",Ke,[t("div",He,[t("div",Ye,[L(le,{user:o.user},null,8,["user"]),t("div",Je,$(o.user.label),1)]),t("div",Qe,[(u=s.value)!=null&&u.isItemsChanged?(l(),v("div",Xe,[t("button",{onClick:f[0]||(f[0]=D(()=>d(),["prevent"])),class:"btn-2 disabled:opacity-40 disabled:pointer-events-none",disabled:w(e).updatingPriority}," Save Rearranged ",8,Ze),t("button",{onClick:f[1]||(f[1]=D(()=>s.value.resetItems(),["prevent"])),class:"btn-3 disabled:opacity-40 disabled:pointer-events-none",disabled:w(e).updatingPriority}," Discard ",8,et)])):g("",!0),L(ue,{department:(n=o.user)==null?void 0:n.department,class:"px-2"},null,8,["department"])])]),t("div",{date:r.date,"max-items":"all",class:"w-full"},[o.todos.length>0?(l(),P(ve,{key:0,items:o.todos,ref_key:"draggableTodos",ref:s,handle:"handle"},{item:E(({item:S})=>[L(ze,{todo:S,onClickTodo:T=>y("clickTodo",T),onClickEdit:T=>y("clickEdit",T),onClickDelete:T=>c(T),onClickChangeStatus:(T,_)=>m(T,_),"hide-department":"","hide-user":"",class:"border-b border-sky-200"},null,8,["todo","onClickTodo","onClickEdit","onClickDelete","onClickChangeStatus"])]),_:1},8,["items"])):g("",!0),o.todos.length===0?(l(),v("div",ot," No Todos ")):g("",!0)],8,tt)])}}},st={class:"relative bg-white p-4"},at={key:0,class:"text-red-500 text-sm border border-red-300 max-w-6xl mx-auto py-2 gap-2 shadow-sm rounded flex items-center px-3"},lt={class:"max-w-6xl mx-auto border rounded my-5"},it={class:"text-gray-700 border-b py-2 px-4 flex items-center"},dt={class:"text-lg font-semibold"},rt={class:"ml-auto flex items-center gap-2"},ut={__name:"TodosInDailyView",props:{date:{type:String,required:!0},userRole:{type:String,default:"employee"}},emits:["clickTodo","clickAdd","clickEdit","clickDelete","clickChangeStatus","backClick","update"],setup(o,{emit:C}){const a=o,s=C,y=oe(),e=V(),c=U(()=>new Date(a.date)),m=d=>{if(a.userRole=="employee")return[{...y.user,todos:d}];const r={};return d.forEach(f=>{const u=f.user.id;r[u]||(r[u]={...f.user,todos:[]}),r[u].todos.push(f)}),Object.values(r)};return(d,r)=>(l(),v("div",st,[w(e).error?(l(),v("div",at,[r[5]||(r[5]=t("i",{class:"fad fa-exclamation-circle"},null,-1)),t("div",null,$(w(e).error),1)])):g("",!0),t("div",lt,[t("div",it,[t("button",{class:"fa fa-arrow-left btn-icon mr-2",onClick:r[0]||(r[0]=D(f=>s("backClick"),["prevent"]))}),t("div",dt,$(w(Z)(c.value,{weekDay:"long"}))+" "+$(d.type),1),t("div",rt,[t("button",{class:"btn btn-icon",onClick:r[1]||(r[1]=D(f=>s("clickAdd",a.date),["prevent"]))},r[6]||(r[6]=[t("i",{class:"fas fa-plus"},null,-1)]))])]),L(re,{date:o.date,"max-items":"all",class:"w-full space-y-4 p-2"},{todoItems:E(({allTodos:f})=>[(l(!0),v(W,null,G(m(f),u=>(l(),P(nt,{key:u.id,todos:(u==null?void 0:u.todos)||[],user:u,onClickTodo:r[2]||(r[2]=n=>s("clickTodo",n)),onClickEdit:r[3]||(r[3]=n=>s("clickEdit",n)),onUpdate:r[4]||(r[4]=n=>s("update"))},null,8,["todos","user"]))),128))]),noTodos:E(()=>r[7]||(r[7]=[t("div",{class:"flex min-h-[38vh] items-center justify-center text-gray-400 text-center rounded-md"}," No Todos ",-1)])),_:1},8,["date"])])]))}},ct={class:"bg-white border-t px-4 py-4 sticky bottom-0 rounded-b-md"},mt={key:0,class:"mb-4 text-red-500 font-medium"},yt={key:1,class:"mb-4 text-blue-500 font-medium"},vt={class:"flex justify-between items-center gap-4"},ft=["disabled"],ce={__name:"FormHandler",props:{isSubmitting:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},error:{type:String,default:""}},emits:["submit","clickCancel"],setup(o,{emit:C}){const a=C;return(s,y)=>(l(),v("form",{onSubmit:y[1]||(y[1]=D(e=>a("submit"),["prevent"]))},[N(s.$slots,"default"),t("div",ct,[o.error?(l(),v("div",mt,$(o.error),1)):g("",!0),o.isSubmitting?(l(),v("div",yt,"Saving changes...")):g("",!0),N(s.$slots,"footer",{},()=>[t("div",vt,[t("button",{type:"button",onClick:y[0]||(y[0]=e=>a("clickCancel")),class:"btn-3"},"Cancel"),t("button",{disabled:o.isSubmitting||o.isLoading,type:"submit",class:"btn-2"},$(o.isSubmitting?"Saving...":"Save"),9,ft)])])])],32))}},pt={class:""},gt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},bt={class:"mb-2"},kt={class:"mb-4"},ht={class:"mb-4"},xt={__name:"TodoAddForm",props:{date:{type:String,default:de(new Date)},userRole:{type:String,default:"employee"}},emits:["update","cancelClick"],setup(o,{emit:C}){const a=o,s=j(),y=j(),e=V(),c=C,m=j({title:"",date:a.date||"",task_id:""});async function d(){try{s.value="submitting",await e.createTodo(m.value,{returnWith:a.userRole!=="employee"?"user,department,company":""}),c("update")}finally{s.value=""}}const r=U(()=>new Date(a.date));return z(async()=>{var f;await ie(),(f=y.value)==null||f.focus()}),(f,u)=>(l(),v("div",pt,[w(e).loading?(l(),P(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:E(()=>u[3]||(u[3]=[F(" Loading... ")])),_:1,__:[3]})):g("",!0),L(ce,{onSubmit:d,onClickCancel:u[2]||(u[2]=n=>c("cancelClick")),isSubmitting:s.value=="submitting",error:w(e).error,class:"rounded-md relative"},{default:E(()=>[u[7]||(u[7]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Add Todo")],-1)),t("div",gt,[t("div",bt,[u[4]||(u[4]=t("span",{class:"font-semibold"}," Date ",-1)),t("span",null,$(w(Z)(r.value,{weekDay:"long"})),1)]),t("div",kt,[u[5]||(u[5]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),J(t("input",{ref_key:"titleRef",ref:y,"onUpdate:modelValue":u[0]||(u[0]=n=>m.value.title=n),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.title]])]),t("div",ht,[u[6]||(u[6]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),J(t("input",{"onUpdate:modelValue":u[1]||(u[1]=n=>m.value.task_id=n),placeholder:"Enter a task id",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.task_id]])])])]),_:1,__:[7]},8,["isSubmitting","error"])]))}},Ct={class:"relative"},wt={class:"p-4 min-h-[10vh] max-h-[50vh] overflow-y-auto"},Dt={class:"mb-2"},$t={class:"mb-4"},Tt={class:"mb-4"},St={__name:"TodoEditForm",props:{date:{type:String,default:de(new Date)},todo:{type:Object,default:()=>{}}},emits:["update","cancelClick"],setup(o,{emit:C}){const a=o,s=j(),y=j(),e=V(),c=C,m=j({title:"",todo_type:"task",todo_type_id:""});async function d(){var u,n,S;await e.fetchTodo((u=a.todo)==null?void 0:u.id),m.value.title=(n=e.todo)==null?void 0:n.title,m.value.todo_type_id=(S=e.todo)==null?void 0:S.todoable_id}async function r(){s.value="submitting";try{await e.updateTodo(a.todo.id,m.value),c("update")}finally{s.value=""}}const f=U(()=>new Date(a.todo.date));return z(async()=>{var u;await d(),await ie(),(u=y.value)==null||u.focus()}),(u,n)=>(l(),v("div",Ct,[w(e).loading?(l(),P(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:E(()=>n[3]||(n[3]=[F(" Loading... ")])),_:1,__:[3]})):g("",!0),L(ce,{onSubmit:r,onClickCancel:n[2]||(n[2]=S=>c("cancelClick")),isSubmitting:s.value=="submitting",isLoading:w(e).loading,error:w(e).error},{default:E(()=>[n[7]||(n[7]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Edit Todo")],-1)),t("div",wt,[t("div",Dt,[n[4]||(n[4]=t("span",{class:"font-semibold"}," Date ",-1)),t("span",null,$(w(Z)(f.value,{weekDay:"long"})),1)]),t("div",$t,[n[5]||(n[5]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Title",-1)),J(t("input",{ref_key:"titleRef",ref:y,"onUpdate:modelValue":n[0]||(n[0]=S=>m.value.title=S),required:"",placeholder:"Enter todo title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.title]])]),t("div",Tt,[n[6]||(n[6]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Task ID (optional)",-1)),J(t("input",{"onUpdate:modelValue":n[1]||(n[1]=S=>m.value.todo_type_id=S),placeholder:"Enter a task id",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[Q,m.value.todo_type_id]])])])]),_:1,__:[7]},8,["isSubmitting","isLoading","error"])]))}},Mt={class:"relative"},Et={class:"min-h-[10vh] max-h-[50vh] overflow-y-auto p-4"},It={class:"mb-4"},Ot={class:"mb-4"},Rt={key:0,class:"mt-1 flex items-center gap-2"},Nt={class:"border border-sky-400 rounded-full text-sky-500 font-semibold bg-sky-50 px-1 py-0.5 text-xs inline-block"},Pt={class:"flex items-center gap-4"},Lt={key:0,class:"flex items-center gap-2"},jt={class:"flex justify-between items-center gap-4 py-4 px-4 border-t"},_t={key:0,class:"ml-auto flex items-center gap-2"},Ut={__name:"TodoShow",props:{todo:{type:Object,default:()=>{}}},emits:["cancelClick","clickEdit","update"],setup(o,{emit:C}){const a=o,s=V(),y=oe(),e=C;async function c(){var u;await s.fetchTodo((u=a.todo)==null?void 0:u.id)}const m=U(()=>{var u,n;return(u=s.todo)!=null&&u.date?new Date((n=s.todo)==null?void 0:n.date):null}),d=U(()=>{var u;return a.todo.user_id===((u=y.user)==null?void 0:u.id)});async function r(u){var n;confirm(`Are your sure want to delete todo
'${(n=s.todo)==null?void 0:n.title}'`)&&(await s.deleteTodo(u.id),e("update"))}async function f(u,n){var S;confirm(`Are your sure want to compete todo
'${(S=s.todo)==null?void 0:S.title}'`)&&(await s.updateTodoStatus(u.id,n),e("update"))}return z(async()=>{await c()}),(u,n)=>{var T,_,h,i,k,x,b,I;const S=me("UserChip");return l(),v("div",Mt,[w(s).loading?(l(),P(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:E(()=>n[5]||(n[5]=[F(" Loading... ")])),_:1,__:[5]})):g("",!0),t("div",null,[n[11]||(n[11]=t("div",{class:"border-b py-2 px-4"},[t("h2",{class:"text-xl font-semibold"},"Show Todo")],-1)),t("div",Et,[t("div",It,[n[6]||(n[6]=t("div",{class:"font-semibold text-xs text-gray-500"},"Date",-1)),t("span",null,$(w(Z)(m.value,{weekDay:"long"})),1)]),t("div",Ot,[n[7]||(n[7]=t("div",{class:"text-xs text-gray-500"},"Todo",-1)),F(" "+$((T=w(s).todo)==null?void 0:T.title),1)]),o.todo.user?(l(),v("div",Rt,[L(S,{user:o.todo.user,"avatar-size":"xsmall"},null,8,["user"]),t("div",Nt,$((h=(_=o.todo.user)==null?void 0:_.department)==null?void 0:h.name),1)])):g("",!0),t("div",null,[n[10]||(n[10]=t("div",{class:"text-xs text-gray-500"},"Status",-1)),t("div",Pt,[t("div",null,[(i=w(s))!=null&&i.todo?(l(),P(ne,{key:0,todo:(k=w(s))==null?void 0:k.todo},null,8,["todo"])):g("",!0),F(" "+$((x=w(s).todo)==null?void 0:x.status),1)]),d.value&&!w(s).loading?(l(),v("div",Lt,[((b=w(s).todo)==null?void 0:b.status)==="PENDING"?(l(),v("button",{key:0,class:"btn-2 from-yellow-700 to-yellow-500 text-white hover:bg-green-600 hover:text-white",onClick:n[0]||(n[0]=D(()=>f(w(s).todo,"WORKING"),["prevent","stop"]))},n[8]||(n[8]=[t("i",{class:"fas fa-exclamation-circle"},null,-1),F(" Change to Working ")]))):g("",!0),((I=w(s).todo)==null?void 0:I.status)==="WORKING"?(l(),v("button",{key:1,class:"btn-2 from-green-700 to-green-300 text-white hover:bg-green-600 hover:text-white",onClick:n[1]||(n[1]=D(()=>f(w(s).todo,"COMPLETED"),["prevent","stop"]))},n[9]||(n[9]=[t("i",{class:"fas fa-check"},null,-1),F(" Make Complete ")]))):g("",!0)])):g("",!0)])])])]),t("div",jt,[t("button",{type:"button",onClick:n[2]||(n[2]=p=>e("cancelClick")),class:"btn-3"},"Cancel"),d.value&&!w(s).loading?(l(),v("div",_t,[t("button",{class:"btn-2 bg-sky-400 text-white hover:bg-sky-600 hover:text-white",onClick:n[3]||(n[3]=D(p=>e("clickEdit",w(s).todo),["prevent","stop"]))},n[12]||(n[12]=[t("i",{class:"fas fa-pen"},null,-1),F(" Edit ")])),t("button",{class:"btn-2-red",onClick:n[4]||(n[4]=D(()=>r(w(s).todo),["prevent","stop"]))},n[13]||(n[13]=[t("i",{class:"fas fa-trash-alt"},null,-1),F(" Delete ")]))])):g("",!0)])])}}},At={__name:"TodoCreateEditShow",props:{todoModal:{type:Object,required:!0},userRole:{type:String,required:"employee"}},emits:["cancelClick","update","clickEdit","clickDelete","clickChangeStatus"],setup(o,{emit:C}){const a=C;function s(){a("update")}return(y,e)=>(l(),v(W,null,[o.todoModal.action=="add"?(l(),P(te,{key:0},{default:E(()=>{var c;return[L(xt,{onCancelClick:e[0]||(e[0]=m=>a("cancelClick")),onUpdate:s,date:(c=o.todoModal)==null?void 0:c.date,userRole:o.userRole},null,8,["date","userRole"])]}),_:1})):g("",!0),o.todoModal.action=="edit"?(l(),P(te,{key:1},{default:E(()=>{var c;return[L(St,{onCancelClick:e[1]||(e[1]=m=>a("cancelClick")),onUpdate:s,todo:(c=o.todoModal)==null?void 0:c.todo,userRole:o.userRole},null,8,["todo","userRole"])]}),_:1})):g("",!0),o.todoModal.action=="show"?(l(),P(te,{key:2},{default:E(()=>{var c;return[L(Ut,{onCancelClick:e[2]||(e[2]=m=>a("cancelClick")),onUpdate:s,onClickEdit:e[3]||(e[3]=m=>a("clickEdit",m)),onClickDelete:e[4]||(e[4]=m=>a("clickDelete",m)),onClickChangeStatus:e[5]||(e[5]=(m,d)=>a("clickChangeStatus",m,d)),todo:(c=o.todoModal)==null?void 0:c.todo,userRole:o.userRole},null,8,["todo","userRole"])]}),_:1})):g("",!0)],64))}},Ft={class:"border bg-white relative"},Ht={__name:"TodoSection",props:{year:{type:Number,default:()=>new Date().getFullYear()},month:{type:Number,default:()=>new Date().getMonth()+1},day:{type:Number,default:()=>new Date().getDate()},week:{type:Number,default:()=>new Date().getDay()},type:{type:String,default:"month-view"},userRole:{type:String,default:"employee"}},emits:["changeInput"],setup(o,{emit:C}){const a=new Date,s=o,y=j({type:"month-view",month:a.getMonth()+1,day:a.getDate(),year:a.getFullYear(),week:a.getDay()}),e=C;Y(()=>({...y.value}),p=>{e("changeInput",p)}),Y(()=>({year:s.year,month:s.month,day:s.day,week:s.week,type:s.type}),p=>{y.value={...p}},{immediate:!0});const c=j({action:null}),m=V();async function d(){await I()}function r(){c.value={...c.value,action:""}}async function f(p,M){await m.updateTodoStatus(p,M)}async function u(p){await m.deleteTodo(p)}function n(){y.value={...y.value,type:"month-view"}}function S(p){y.value={...y.value,...p}}function T(p){const[M,R,O]=p.split("-").map(Number);y.value={...y.value,type:"day-view",year:M,month:R,day:O}}function _(p){c.value={...c.value,action:"show",todo:p}}function h(p){c.value={...c.value,action:"edit",todo:p}}function i(p){c.value={...c.value,action:"add",date:p}}function k(){c.value={action:null,todo:null}}const x=U(()=>{var O,B,A,ee,se,ae;const p=(B=(O=y.value)==null?void 0:O.year)==null?void 0:B.toString(),M=(ee=(A=y.value)==null?void 0:A.month)==null?void 0:ee.toString().padStart(2,"0"),R=(ae=(se=y.value)==null?void 0:se.day)==null?void 0:ae.toString().padStart(2,"0");return`${p}-${M}-${R}`}),b=U(()=>{var R,O,B,A;const p=(O=(R=y.value)==null?void 0:R.year)==null?void 0:O.toString(),M=(A=(B=y.value)==null?void 0:B.month)==null?void 0:A.toString().padStart(2,"0");return`${p}-${M}`});async function I(){s.userRole=="employee"?await m.fetchMyTodos():await m.fetchTodos()}return z(async()=>{await I()}),(p,M)=>(l(),v("div",null,[t("div",Ft,[w(m).loading?(l(),P(X,{key:0,class:"absolute inset-0 bg-opacity-80 text-center py-4 text-gray-500 z-10 flex items-center justify-center"},{default:E(()=>M[0]||(M[0]=[F(" Loading... ")])),_:1,__:[0]})):g("",!0),L(Me,{selected:y.value,class:"border-b shadow z-20",onChange:S,onReloadClick:d},{before:E(R=>[N(p.$slots,"beforeHeader",K(H(R)))]),after:E(R=>[N(p.$slots,"afterHeader",K(H(R)))]),bottom:E(R=>[N(p.$slots,"bottomHeader",K(H(R)))]),typeSelection:E(R=>[N(p.$slots,"typeSelection",K(H(R)))]),_:3},8,["selected"]),y.value.type=="month-view"?(l(),P(Ae,{key:1,month:b.value,class:"bg-white",onDateClick:T,onClickTodo:_,onClickDateCell:i},null,8,["month"])):g("",!0),y.value.type=="day-view"?(l(),P(ut,{key:2,date:x.value,userRole:o.userRole,onClickTodo:_,onClickEdit:h,onClickAdd:i,onClickDelete:u,onClickChangeStatus:f,onBackClick:n,onUpdate:r},null,8,["date","userRole"])):g("",!0)]),L(At,{todoModal:c.value,userRole:o.userRole,onCancelClick:k,onUpdate:r,onClickEdit:h},null,8,["todoModal","userRole"])]))}};export{ke as _,Ht as a};
