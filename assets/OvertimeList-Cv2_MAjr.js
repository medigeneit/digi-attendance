import{u as S,b as h,a3 as B,r as d,e as C,m as O,x as w,c,o as p,a as o,f as x,g as v,q as b,h as L,v as M,p as N,k as D}from"./index-DFN3F9TA.js";import{_ as V}from"./EmployeeFilter-Df8Ce9K3.js";import{L as $}from"./LoaderView-Bm25Ml6I.js";import{_ as A}from"./OvertimeDataList-Dhcixvhf.js";import{u as F}from"./overtime-CmT3B051.js";import{u as I}from"./user-VKkcCi_H.js";import"./company-WMxMoEGB.js";import"./department-DkAnO1Db.js";import"./SelectDropdown-ZBR42h8e.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-C5cdFgMr.js";import"./AcceptAndRejectHandler-bWjTC9J0.js";import"./DisplayFormattedWorkingHours-DRWVaacd.js";import"./TimePickerAsFloatHour-Da89Wied.js";const R={class:"px-4 space-y-4"},j={key:0,class:"absolute inset-0 w-full h-full"},z={key:2},oe={__name:"OvertimeList",setup(E){const m=S(),i=h(),q=B(),y=F(),f=I(),r=d(!1),s=d(null),n=d(i.query.date||new Date().toISOString().slice(0,7)),a=d({company_id:i.query.company_id||"",department_id:i.query.department_id||"all",type:i.query.type||"all",employee_id:i.query.employee_id||"",category:""});C(async()=>{if(a.value.employee_id){r.value=!0;try{await _(a.value.employee_id),await u()}catch(t){console.log(t)}r.value=!1}});const _=async t=>{t?(await f.fetchUser(t),s.value=f.user):s.value=null},g=O(()=>{var t;return((t=y.overtimes)==null?void 0:t.map(e=>e.id))||[]}),u=async()=>{var t;a.value.employee_id&&n.value&&(await y.fetchUserMonthlyOvertimes(a.value.employee_id,n.value),(t=g.value)!=null&&t.length&&await q.fetchApprovalPermissionsByUserApplicationIds("overtime_applications",g.value))};w(n,t=>{m.replace({query:{...i.query,date:t}}),u()}),w(()=>a.value.employee_id,async(t,e)=>{t&&t!==e&&(await _(t),await u())});const U=()=>m.go(-1),k=()=>{m.replace({query:{...i.query,company_id:a.value.company_id,department_id:a.value.department_id,type:a.value.type,employee_id:a.value.employee_id||i.query.employee_id}})};return(t,e)=>(p(),c("div",R,[o("div",{class:"flex items-center justify-between gap-2"},[o("button",{class:"btn-3",onClick:U},e[5]||(e[5]=[o("i",{class:"far fa-arrow-left"},null,-1),o("span",{class:"hidden md:flex"},"Back",-1)])),e[6]||(e[6]=o("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Overtime",-1)),e[7]||(e[7]=o("div",null,null,-1))]),o("div",{class:N(["w-full flex flex-wrap gap-4 items-center md:w-auto relative",{"opacity-50":r.value}])},[b(V,{company_id:a.value.company_id,"onUpdate:company_id":e[0]||(e[0]=l=>a.value.company_id=l),department_id:a.value.department_id,"onUpdate:department_id":e[1]||(e[1]=l=>a.value.department_id=l),employee_id:a.value.employee_id,"onUpdate:employee_id":e[2]||(e[2]=l=>a.value.employee_id=l),category:a.value.category,"onUpdate:category":e[3]||(e[3]=l=>a.value.category=l),"with-type":!0,"initial-value":t.$route.query,onFilterChange:k},null,8,["company_id","department_id","employee_id","category","initial-value"]),o("div",null,[L(o("input",{id:"monthSelect",type:"month","onUpdate:modelValue":e[4]||(e[4]=l=>n.value=l),onChange:u,class:"input-1"},null,544),[[M,n.value]])]),r.value?(p(),c("div",j)):v("",!0)],2),D(y).isLoading||r.value?(p(),x($,{key:0})):s.value?(p(),x(A,{key:1,user:s.value,onUpdate:u},null,8,["user"])):v("",!0),s.value?v("",!0):(p(),c("div",z,e[8]||(e[8]=[o("p",{class:"text-gray-400 text-center text-2xl italic"},"Select an employee, please.",-1)])))]))}};export{oe as default};
