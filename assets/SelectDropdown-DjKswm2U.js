import{r as m,e as Y,I as Z,p as b,M as _,y as ee,c as r,o as u,a as f,h as A,g as $,F as U,q,H as v,t as g,w as y,v as z,V as h,j as I,n as K,W as te}from"./index-ZQhFJS6z.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ne={class:"w-full h-full"},oe={key:0,class:"flex flex-wrap items-center gap-2 w-full h-full justify-items-stretch"},ae={class:"bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm"},se=["onClick"],re={key:1,class:"text-gray-400"},ue=["placeholder","onKeydown"],ie={key:1,class:"flex items-center h-full"},de=["title"],ce={key:1,class:"text-gray-500"},fe={class:"flex items-center gap-0.5"},pe={key:0,class:"px-2 pt-2"},ve={class:"max-h-60 overflow-y-auto py-2"},me=["onClick","onKeydown"],ge={key:1,class:"px-3 py-2 text-gray-500 min-h-24 flex justify-center items-center -mt-2"},ye={__name:"SelectDropdown",props:{options:{type:Array,required:!0},modelValue:{type:[Object,Array,String,Number,null],default:null},placeholder:{type:String,default:null},multiple:{type:Boolean,default:!1},label:{type:String,default:"label"},value:{type:String,default:"id"},clearable:{type:Boolean,default:!1},searchable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},filterBy:{type:Function,default:null},position:{type:String,default:"auto",validator:a=>["top","left","right","bottom","auto"].includes(a)},containment:{type:Object,default:()=>window},taggable:{type:Boolean,default:!1},createOption:Function},emits:["update:modelValue","input","open","close","search","search:focus","search:blur","option:selecting","option:selected","option:deselecting","option:deselected"],setup(a,{emit:P}){const l=a,o=P,i=m(!1),s=m(""),M=m(null),T=m(null),w=m(),D=m(),k=m(l.position);function E(e){w.value&&!w.value.contains(e.target)&&i.value&&(i.value=!1,o("close"))}function F(e){return l.options.find(t=>(t==null?void 0:t[l.value])==e)}Y(()=>{var e;document.addEventListener("click",E),(e=l.containment)==null||e.addEventListener("scroll",()=>L(i.value)),setTimeout(()=>{var t;(t=T.value)==null||t.focus()})}),Z(()=>{var e;document.removeEventListener("click",E),(e=l.containment)==null||e.removeEventListener("scroll",()=>L(i.value))});const W=b(()=>l.multiple||l.taggable),G=b(()=>{const e={top:"bottom-[100%] mb-0.5",left:"right-[100%] mr-0.5",right:"left-[100%] ml-0.5",bottom:"top-[100%] mt-0.5"};return e[k.value]||e.bottom}),d=b(()=>l.multiple||l.taggable?Array.isArray(l.modelValue)?l.modelValue:[]:l.modelValue),B=e=>(e==null?void 0:e[l.label])??(e==null?void 0:e.label)??e,x=e=>{const t=l.options.find(n=>typeof n=="string"||typeof n=="number"?String(n)===String(e):(n==null?void 0:n[l.value])==e);return t?(t==null?void 0:t[l.label])??(t==null?void 0:t.label)??t:l.taggable?e:null},c=e=>typeof e=="object"?(e==null?void 0:e[l.value])??(e==null?void 0:e.value)??e:typeof e=="string"||typeof e=="number"?e:"",J=()=>{l.disabled||(i.value=!i.value,o(i.value?"open":"close"),i.value&&setTimeout(()=>{var e;(e=M.value)==null||e.focus()},0))},C=e=>{const t=c(e);return l.multiple||l.taggable?d.value.some(n=>c(n)===t):c(d.value)===t},V=e=>{if(l.multiple||l.taggable)if(C(e)){o("option:deselecting",e);const t=d.value.filter(n=>c(n)!==c(e));o("update:modelValue",t),o("option:deselected",e)}else{o("option:selecting",e);const t=[...d.value,c(e)];o("update:modelValue",t),o("option:selected",e)}else o("option:selected",e),typeof l.modelValue=="object"&&l.modelValue?o("update:modelValue",e):o("update:modelValue",c(e));i.value=!1,o("close"),o("input",e),s.value=""},N=e=>{const t=d.value.filter(n=>c(n)!==c(e));o("update:modelValue",t),o("option:deselected",e)},O=b(()=>{const e=s.value.toLowerCase();return!l.searchable||!e?l.options:typeof l.filterBy=="function"?l.filterBy(l.options,e):l.options.filter(t=>B(t).toLowerCase().includes(e))});async function L(e){if(!l.containment)return null;if(e&&l.position==="auto"){await _();const t=w.value,n=D.value;if(t&&n){console.log({cm:l.containment});const p=t.getBoundingClientRect(),S=n.offsetHeight,H=(l.containment.innerHeight||l.containment.clientHeight)-p.bottom,j=p.top;console.log({triggerRect:p,dropdownHeight:S,spaceBelow:H,spaceAbove:j}),j<S?k.value="bottom":k.value=H<S&&j>S?"top":"bottom"}}else k.value=l.position}const R=b(()=>O.value.find(e=>B(e).toLowerCase()===s.value.toLowerCase()));function Q(e){if(s.value.length===0&&l.taggable&&Array.isArray(l.modelValue)){const t=[...l.modelValue];t.pop(),o("update:modelValue",t)}}function X(e){if(e.preventDefault(),!(!l.taggable||!s.value.trim())){if(R.value)V(R.value);else{const t=l.createOption?l.createOption(s.value):s.value.trim();o("option:created",t),o("option:selected",t),o("input",t),o("update:modelValue",[...l.modelValue,t])}s.value="",e.target.focus()}}return ee(i,L),(e,t)=>(u(),r("div",{class:"border rounded cursor-pointer bg-white relative",ref_key:"dropdownRef",ref:w},[f("div",{class:K(["flex items-center justify-between px-2 h-full",{"bg-gray-100":a.disabled}]),onClick:J,tabindex:"0"},[f("div",ne,[W.value?(u(),r("div",oe,[Array.isArray(d.value)&&d.value.length>0?(u(!0),r(U,{key:0},q(d.value,n=>v(e.$slots,"selected-option",{key:c(n),option:F(n),removeItem:p=>N(p)},()=>[f("span",ae,[f("span",null,g(x(n)),1),f("button",{onClick:y(p=>N(n),["prevent","stop"]),type:"button",class:"ml-1 text-xs"}," × ",8,se)])],!0)),128)):a.taggable?$("",!0):(u(),r("span",re,g(a.placeholder||"Select.."),1)),a.taggable?A((u(),r("input",{key:2,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value=n),ref_key:"tagSearchInput",ref:T,type:"text",class:"flex-grow px-2 py-1 rounded outline-none",placeholder:a.placeholder||"Type and enter to add",onKeydown:[h(y(X,["prevent","stop"]),["enter"]),h(Q,["backspace"])],onKeyup:t[1]||(t[1]=()=>i.value=!!s.value),onFocus:t[2]||(t[2]=n=>e.$emit("search:focus")),onBlur:t[3]||(t[3]=n=>e.$emit("search:blur"))},null,40,ue)),[[z,s.value]]):$("",!0)])):(u(),r("div",ie,[v(e.$slots,"selected-option",{option:F(a.modelValue),isSelected:C},()=>[x(d.value)?(u(),r("span",{key:0,class:"line-clamp-1",title:x(d.value)},g(x(d.value)),9,de)):(u(),r("span",ce,g(a.placeholder||"Select..."),1))],!0)]))]),f("div",fe,[l.modelValue&&a.clearable?(u(),r("button",{key:0,onClick:t[4]||(t[4]=y(()=>o("update:modelValue",""),["prevent"])),class:"text-gray-600 font-semibold hover:text-red-700 text-xl",title:"Clear selection"},[v(e.$slots,"clear-icon",{},()=>[t[9]||(t[9]=I(" × "))],!0)])):$("",!0),v(e.$slots,"open-indicator",{},()=>[t[10]||(t[10]=f("svg",{class:"w-4 h-4 ml-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[f("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M19 9l-7 7-7-7"})],-1))],!0)])],2),A(f("div",{class:K(["absolute w-full border rounded shadow-[0px_0px_10px_0px_rgba(0,0,0,0.25)] z-50 border-teal-500 bg-white",G.value]),ref_key:"dropdownMenuRef",ref:D},[a.searchable&&!a.taggable?(u(),r("div",pe,[v(e.$slots,"search",{},()=>[A(f("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=n=>s.value=n),ref_key:"searchInput",ref:M,class:"w-full px-2 py-1 border rounded outline-blue-400 focus:outline-1",placeholder:"Search...",onFocus:t[6]||(t[6]=n=>e.$emit("search:focus")),onBlur:t[7]||(t[7]=n=>e.$emit("search:blur")),onKeydown:t[8]||(t[8]=h(y(n=>n.preventDefault(),["stop"]),["enter"]))},null,544),[[z,s.value]])],!0)])):$("",!0),v(e.$slots,"list-header",{},void 0,!0),f("ul",ve,[O.value.length?(u(!0),r(U,{key:0},q(O.value,n=>(u(),r("li",{tabindex:"0",key:c(n),class:K([{"bg-blue-50":C(n)},"px-3 py-1 my-0.5 hover:bg-blue-100 focus:bg-blue-100 focus:outline-blue-500 cursor-pointer"]),onClick:p=>V(n),onKeydown:[h(y(p=>V(n),["prevent"]),["space"]),h(y(p=>V(n),["prevent"]),["enter"])]},[v(e.$slots,"option",{option:n},()=>[I(g(B(n)),1)],!0)],42,me))),128)):(u(),r("li",ge,[v(e.$slots,"no-options",{},()=>[I(g(a.taggable?"No option found, Enter to add":"No options found"),1)],!0)]))]),v(e.$slots,"list-footer",{},void 0,!0)],2),[[te,i.value]])],512))}},we=le(ye,[["__scopeId","data-v-5e071a3c"]]);export{we as S};
