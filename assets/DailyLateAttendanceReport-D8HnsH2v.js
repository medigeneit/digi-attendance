import{u as E,b as F,r as b,s as S,e as z,z as p,c as o,o as n,a as t,h as k,B as w,F as D,q as C,t as i,k as g,l as W,p as U,v as j,U as I,x as K}from"./index-W_PqaTeh.js";import{L as O}from"./LoaderView-P05kDm88.js";import{_ as $}from"./MultiselectDropdown-C1hM4XQv.js";import{u as G}from"./attendance-JzbGRpon.js";import{u as H}from"./company-DcDQxJ-7.js";import{u as J}from"./department-Ca8ax3mn.js";import{S as Q}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"space-y-2 px-4"},Y={class:"flex flex-wrap items-center gap-2"},Z=["value"],ee=["value"],te={key:0,class:"text-center py-4"},ae={key:1,class:"space-y-4"},le={key:0,class:"overflow-x-auto"},se={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},oe={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},de={class:"border border-gray-300 px-2"},ie={class:"border border-gray-300 px-2"},re={class:"border border-gray-300 px-2"},ue={class:"border border-gray-300 px-2"},ce={class:"border border-gray-300 px-2"},ve={class:"border border-gray-300 px-2"},ye={class:"border border-gray-300 px-2"},pe={key:0},me={key:1,class:"text-gray-500 italic text-xs"},fe={class:"border border-gray-300 px-2"},xe={key:1,class:"text-center text-red-500 text-xl italic mt-10"},qe={__name:"DailyLateAttendanceReport",setup(be){const f=E(),m=F(),v=b("all"),_=G(),c=H(),q=J(),{dailyLateLogs:B,isLoading:R,selectedDate:d}=S(_),{companies:V}=S(c),s=b(m.query.company_id||""),r=b(m.query.department_id||""),u=b(""),{departments:N}=S(q),y=b([]);m.query.date&&(d.value=m.query.date),z(async()=>{if(await c.fetchCompanies(),s.value){const a=await c.fetchEmployee(s.value);y.value=a,A(s.value),await h()}}),p(s,async a=>{a?(await c.fetchEmployee(a),y.value=c.employees,u.value="",r.value="",A(a)):(y.value=[],u.value="",r.value=""),x()}),p(r,a=>{a?y.value=c.employees.filter(l=>l.department_id==a):y.value=c.employees,x()}),p(v,a=>{a!=="all"?y.value=c.employees.filter(l=>l.type==a):y.value=c.employees,x()}),p(u,()=>{x()}),p(d,()=>{x()}),p(u,async a=>{a!=null&&a.id&&await h(),f.replace({query:{...m.query,employee_id:(a==null?void 0:a.id)||""}})}),p(d,a=>{f.replace({query:{...m.query,date:a}})}),p(s,a=>{f.replace({query:{...m.query,date:a}})});const h=async()=>{!s.value||!d.value||s.value&&await _.getAttendanceLateReport(s.value,r.value,v.value,u.value.id,d.value,"daily")},A=async a=>{await q.fetchDepartments(a)},M=async()=>{s.value?await _.lateReportDownloadExcel(s.value,r.value,v==null?void 0:v.value,u.value.id,d.value,"daily"):Q.fire({icon:"warning",title:"Missing Selection!",text:"Please select Company and Employee first!",confirmButtonText:"OK"})},P=()=>{f.go(-1)},T=a=>a==="Pending"?"text-yellow-700":a==="Approved"?"text-green-700":"text-red-500",x=async()=>{var a,l;!s.value||!d.value||(await _.getAttendanceLateReport(s.value,r.value,v.value,((a=u.value)==null?void 0:a.id)||"",d.value,"daily",r.value||""),f.replace({query:{company_id:s.value||"",department_id:r.value||"",employee_id:((l=u.value)==null?void 0:l.id)||"",date:d.value||""}}))};return(a,l)=>(n(),o("div",X,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:P},l[5]||(l[5]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),l[7]||(l[7]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Daily Late Reports",-1)),t("div",{class:"flex gap-4"},[t("button",{type:"button",onClick:M,class:"btn-3"},l[6]||(l[6]=[t("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1)]))])]),t("div",Y,[t("div",null,[k(t("select",{id:"user-filter","onUpdate:modelValue":l[0]||(l[0]=e=>s.value=e),class:"input-1"},[l[8]||(l[8]=t("option",{value:""},"Select Company",-1)),(n(!0),o(D,null,C(g(V),e=>(n(),o("option",{key:e.id,value:e.id},i(e.name),9,Z))),128))],512),[[w,s.value]])]),t("div",null,[k(t("select",{id:"user-filter","onUpdate:modelValue":l[1]||(l[1]=e=>r.value=e),class:"input-1"},[l[9]||(l[9]=t("option",{value:""},"Select Department",-1)),(n(!0),o(D,null,C(g(N),e=>(n(),o("option",{key:e.id,value:e.id},i(e.name),9,ee))),128))],512),[[w,r.value]])]),t("div",null,[k(t("select",{id:"userSelect","onUpdate:modelValue":l[2]||(l[2]=e=>v.value=e),onChange:h,class:"input-1"},l[10]||(l[10]=[W('<option value="all">All Category</option><option value="executive">Executive</option><option value="support_staff">Support Staff</option><option value="doctor">Doctor</option><option value="academy_body">Academy Body</option>',5)]),544),[[w,v.value]])]),t("div",null,[U($,{modelValue:u.value,"onUpdate:modelValue":l[3]||(l[3]=e=>u.value=e),options:y.value,multiple:!1,label:"label",placeholder:"Please select employee..."},null,8,["modelValue","options"])]),t("div",null,[k(t("input",{id:"user-filter","onUpdate:modelValue":l[4]||(l[4]=e=>I(d)?d.value=e:null),onChange:h,type:"date",class:"input-1"},null,544),[[j,g(d)]])])]),g(R)?(n(),o("div",te,[U(O)])):(n(),o("div",ae,[s.value?(n(),o("div",le,[t("table",se,[l[11]||(l[11]=t("thead",null,[t("tr",{class:"bg-gray-200"},[t("th",{class:"border border-gray-300 px-2 text-left"},"#"),t("th",{class:"border border-gray-300 px-2 text-left"},"Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Weekday"),t("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),t("th",{class:"border border-gray-300 px-2 text-left"},"Company"),t("th",{class:"border border-gray-300 px-2 text-left"},"Department"),t("th",{class:"border border-gray-300 px-2 text-left"},"Entry Time"),t("th",{class:"border border-gray-300 px-2 text-left"},"Late Duration"),t("th",{class:"border border-gray-300 px-2 text-left"},"Action"),t("th",{class:"border border-gray-300 px-2 text-left"},"Shift")])],-1)),t("tbody",null,[(n(!0),o(D,null,C(g(B),(e,L)=>(n(),o("tr",{key:e.id||L,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",oe,i(L+1),1),t("td",ne,i(e==null?void 0:e.date),1),t("td",de,i(e==null?void 0:e.weekday),1),t("td",ie,i((e==null?void 0:e.user_name)||"Unknown"),1),t("td",re,i((e==null?void 0:e.company_name)||"Unknown"),1),t("td",ue,i((e==null?void 0:e.department_name)||"Unknown"),1),t("td",ce,i(e==null?void 0:e.entry_time),1),t("td",ve,i(e==null?void 0:e.late_duration),1),t("td",ye,[e!=null&&e.short_leave?(n(),o("div",pe,[t("span",{class:K(T(e.short_leave.status))},i(e.short_leave.status||"Waiting"),3)])):(n(),o("div",me,"No Application"))]),t("td",fe,i(e==null?void 0:e.shift_name),1)]))),128))])])])):(n(),o("div",xe,"Please select company"))]))]))}};export{qe as default};
