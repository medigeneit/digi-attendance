import{_ as O}from"./EmployeeFilter-DObv74j3.js";import{_ as $}from"./FlexibleDatePicker-BOQ-fgzp.js";import{L as C}from"./LoaderView-D_-WElnV.js";import{_ as L}from"./OvertimeDataList-Cm21aY3p.js";import{u as V,f as D,ab as F,r as u,x,h as j,q,c as v,o as p,a as o,i as U,j as _,d as S,s as A,m as I}from"./index-4cVhF2CH.js";import{u as R}from"./overtime-l8pTdy8y.js";import{u as z}from"./user-DejXXCx-.js";import"./company-De50kkBt.js";import"./department-DYjgWrB_.js";import"./EmployeeDropdownInput-BAmZixbQ.js";import"./SelectDropdown-wWdYH0ad.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-BoWo7TBw.js";import"./AcceptAndRejectHandler-BSyv1Kx6.js";import"./DisplayFormattedWorkingHours-CwvSXZXP.js";import"./TimePickerAsFloatHour-BvN3KGKT.js";const E={class:"px-4 space-y-4"},P={key:0,class:"absolute inset-0 w-full h-full"},Y={key:2},se={__name:"OvertimeList",setup(G){const d=V(),i=D(),k=F(),y=R(),f=z(),n=u(!1),s=u(null),c=i.query.date||new Date().toISOString().slice(0,7),b=t=>t.toString().padStart(2,"0"),r=u({year:Number(c.split("-")[0]||new Date().getFullYear()),month:Number(c.split("-")[1]||new Date().getMonth()+1),day:1}),w=x(()=>{var t,e;return!((t=r.value)!=null&&t.year)||!((e=r.value)!=null&&e.month)?"":`${r.value.year}-${b(r.value.month)}`}),B=u(c),a=u({company_id:i.query.company_id||"",department_id:i.query.department_id||"all",line_type:i.query.line_type||"all",employee_id:i.query.employee_id||"",category:""});j(async()=>{if(a.value.employee_id){n.value=!0;try{await g(a.value.employee_id),await m()}catch(t){console.log(t)}n.value=!1}});const g=async t=>{t?(await f.fetchUser(t),s.value=f.user):s.value=null},h=x(()=>{var t;return((t=y.overtimes)==null?void 0:t.map(e=>e.id))||[]}),m=async()=>{var e;const t=w.value;a.value.employee_id&&t&&(await y.fetchUserMonthlyOvertimes(a.value.employee_id,t),(e=h.value)!=null&&e.length&&await k.fetchApprovalPermissionsByUserApplicationIds("overtime_applications",h.value))};q(w,t=>{t&&(B.value=t,d.replace({query:{...i.query,date:t}}),m())}),q(()=>a.value.employee_id,async(t,e)=>{t&&t!==e&&(await g(t),await m())});const M=()=>d.go(-1),N=()=>{d.replace({query:{...i.query,company_id:a.value.company_id,department_id:a.value.department_id,line_type:a.value.line_type,employee_id:a.value.employee_id||i.query.employee_id}})};return(t,e)=>(p(),v("div",E,[o("div",{class:"flex items-center justify-between gap-2"},[o("button",{class:"btn-3",onClick:M},e[5]||(e[5]=[o("i",{class:"far fa-arrow-left"},null,-1),o("span",{class:"hidden md:flex"},"Back",-1)])),e[6]||(e[6]=o("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Overtime",-1)),e[7]||(e[7]=o("div",null,null,-1))]),o("div",{class:A(["w-full flex flex-wrap gap-4 items-center md:w-auto relative",{"opacity-50":n.value}])},[S(O,{company_id:a.value.company_id,"onUpdate:company_id":e[0]||(e[0]=l=>a.value.company_id=l),department_id:a.value.department_id,"onUpdate:department_id":e[1]||(e[1]=l=>a.value.department_id=l),employee_id:a.value.employee_id,"onUpdate:employee_id":e[2]||(e[2]=l=>a.value.employee_id=l),line_type:a.value.line_type,"onUpdate:line_type":e[3]||(e[3]=l=>a.value.line_type=l),"with-type":!0,"initial-value":t.$route.query,onFilterChange:N},null,8,["company_id","department_id","employee_id","line_type","initial-value"]),o("div",null,[S($,{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value=l),"show-year":!1,"show-month":!0,"show-date":!1},null,8,["modelValue"])]),n.value?(p(),v("div",P)):_("",!0)],2),I(y).isLoading||n.value?(p(),U(C,{key:0})):s.value?(p(),U(L,{key:1,user:s.value,onUpdate:m},null,8,["user"])):_("",!0),s.value?_("",!0):(p(),v("div",Y,e[8]||(e[8]=[o("p",{class:"text-gray-400 text-center text-2xl italic"},"Select an employee, please.",-1)])))]))}};export{se as default};
