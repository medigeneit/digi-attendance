import{r as p,u as C,B,e as D,C as R,c as n,o as a,a as e,y as k,i as P,j as x,w as T,g as y,k as j,F as q,x as E,t as g,h as u,v,A as w}from"./index-Dtet4G9t.js";import{L}from"./LoaderView-CniLPauM.js";import{_ as $}from"./MultiselectDropdown-Dvuf6OjY.js";import{u as O}from"./manual-attendance-CNRWvOmH.js";import{u as N}from"./user-fmGqzGKg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./MultiselectDropdown.vue_vue_type_style_index_0_lang-B2f3_n4c.js";const H={class:"max-w-4xl mx-auto p-4 space-y-4"},I={class:"flex items-center justify-between gap-2"},W={key:0,class:"text-center"},z={class:"flex justify-between items-center"},G={class:"text-lg font-semibold"},J=["onClick"],K={class:"flex justify-between flex-wrap gap-4"},Q={class:"flex-1"},X=["onUpdate:modelValue"],Y={class:"flex-1"},Z=["onUpdate:modelValue"],ee={key:0,class:"flex-1"},te=["onUpdate:modelValue"],le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se={key:0},oe=["onUpdate:modelValue"],ne={key:1},ae=["onUpdate:modelValue"],ue=["onUpdate:modelValue"],ie={key:0,class:"text-red-500 text-sm text-center"},ke={__name:"ManualAttendanceAdd",setup(de){const r=p(null),b=C(),V=O(),h=N(),f=new Date().toISOString().split("T")[0];p(null);const{users:U}=B(h),i=p([{date:f,type:"",check_in:"",check_out:"",description:"",punch_type:""}]);D(async()=>{await h.fetchUsers()});const S=()=>{i.value.push({date:f,type:"",check_in:"",check_out:"",description:"",punch_type:""})},A=c=>{i.value.length>1&&i.value.splice(c,1)},m=p(!1),d=p(null),F=async()=>{var c;if(m.value=!0,d.value=null,!((c=r.value)!=null&&c.id)){d.value="Please select an employee.",m.value=!1;return}try{const t=i.value.map(o=>{var l;return{user_id:(l=r.value)==null?void 0:l.id,...o,check_in:o.check_in?`${o.date} ${o.check_in}:00`:null,check_out:o.check_out?`${o.date} ${o.check_out}:00`:null}});await V.createBulkManualAttendance(t),b.push({name:"ManualAttendanceList"})}catch(t){d.value=t.message||"Failed to submit manual attendance requests."}finally{m.value=!1}},M=()=>{b.go(-1)};return(c,t)=>{const o=R("RouterLink");return a(),n("div",H,[e("div",I,[e("button",{class:"btn-3",onClick:M},t[1]||(t[1]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[3]||(t[3]=e("h1",{class:"title-md md:title-lg text-center"},"Manual Attendance Request (Multiple Dates)",-1)),k(o,{to:"/",class:"btn-2"},{default:P(()=>t[2]||(t[2]=[x("Home")])),_:1,__:[2]})]),m.value?(a(),n("div",W,[k(L)])):(a(),n("form",{key:1,onSubmit:T(F,["prevent"]),class:"space-y-6"},[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium mb-1"},"Select Employee",-1)),k($,{modelValue:r.value,"onUpdate:modelValue":t[0]||(t[0]=l=>r.value=l),options:j(U),multiple:!1,label:"label",placeholder:"Select employee"},null,8,["modelValue","options"])]),(a(!0),n(q,null,E(i.value,(l,_)=>(a(),n("div",{key:_,class:"card-bg p-4 md:p-6 rounded border border-gray-300 space-y-4"},[e("div",z,[e("h2",G,"Entry "+g(_+1),1),e("button",{type:"button",class:"text-red-600 text-sm",onClick:s=>A(_)},t[5]||(t[5]=[e("i",{class:"far fa-trash-alt"},null,-1),x(" Remove ")]),8,J)]),e("div",K,[e("div",Q,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium"},"Date",-1)),u(e("input",{type:"date","onUpdate:modelValue":s=>l.date=s,class:"input-1 w-full",required:""},null,8,X),[[v,l.date]])]),e("div",Y,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium"},"Type",-1)),u(e("select",{"onUpdate:modelValue":s=>l.type=s,class:"input-1 w-full",required:""},t[7]||(t[7]=[e("option",{value:""},"Select Type",-1),e("option",{value:"Home Office"},"Home Office",-1),e("option",{value:"Remote Work"},"Remote Work",-1),e("option",{value:"Forget Punch"},"Forget Punch",-1)]),8,Z),[[w,l.type]])]),l.type==="Forget Punch"?(a(),n("div",ee,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium"},"Forget Punch Type",-1)),u(e("select",{"onUpdate:modelValue":s=>l.punch_type=s,class:"input-1 w-full",required:""},t[9]||(t[9]=[e("option",{value:""},"Select One",-1),e("option",{value:"entry"},"Entry",-1),e("option",{value:"exit"},"Exit",-1),e("option",{value:"both"},"Both",-1)]),8,te),[[w,l.punch_type]])])):y("",!0)]),e("div",le,[l.type!=="Forget Punch"||l.punch_type==="both"||l.punch_type==="entry"?(a(),n("div",se,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium"},"Check-In",-1)),u(e("input",{type:"time","onUpdate:modelValue":s=>l.check_in=s,class:"input-1 w-full"},null,8,oe),[[v,l.check_in]])])):y("",!0),l.type!=="Forget Punch"||l.punch_type==="both"||l.punch_type==="exit"?(a(),n("div",ne,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium"},"Check-Out",-1)),u(e("input",{type:"time","onUpdate:modelValue":s=>l.check_out=s,class:"input-1 w-full"},null,8,ae),[[v,l.check_out]])])):y("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium"},"Description",-1)),u(e("textarea",{"onUpdate:modelValue":s=>l.description=s,class:"input-1 w-full",required:""},null,8,ue),[[v,l.description]])])]))),128)),e("div",{class:"flex justify-end"},[e("button",{type:"button",class:"btn-1",onClick:S},"+ Add Another Day")]),d.value?(a(),n("div",ie,g(d.value),1)):y("",!0),t[14]||(t[14]=e("div",{class:"flex justify-center"},[e("button",{type:"submit",class:"btn-2"},"Submit All")],-1))],32))])}}};export{ke as default};
