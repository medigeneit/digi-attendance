import{N as kt,u as wt,i as At,r as f,x as jt,b as Ct,c as o,a as t,k as a,j as Nt,t as l,h as b,e as i,p as Dt,l as ct,m as Rt,d as Et,v as Ft,F as St,f as Bt,o as n,g as $t}from"./index-D74-o6rI.js";import{L as Vt}from"./LoaderView-BYkW3_94.js";import{_ as qt}from"./ScreenshotCapture-CHLPlphs.js";import{_ as It}from"./ShareComponent-CzOBg44Z.js";import{u as Lt}from"./exchange-ClDqbqVc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Mt={class:"my-container max-w-3xl space-y-6"},Ut={key:1,class:"card-bg p-4 md:p-8"},Wt={class:"flex justify-end"},Ht={class:"font-medium"},Ot={class:"gap-y-1"},Tt={class:"gap-y-1"},Pt={class:"grid md:grid-cols-2 pt-3"},zt={class:"col-span-2 pt-2"},Gt={class:"grid print:grid-cols-2 md:grid-cols-2 gap-4 pt-10"},Jt={key:0,class:"print:hidden"},Kt={class:"text-xs"},Qt={class:"flex gap-2"},Xt={class:"font-bold"},Yt={key:0,class:"text-green-600 print:text-black"},Zt={key:1,class:"pl-2 text-yellow-700"},es={class:"title-md"},ts={key:0},ss={class:"grid grid-cols-2 print:grid-cols-3 md:grid-cols-3 gap-4"},ls={class:"pt-10"},as={key:0},ns={key:1},os={key:2,class:"print:hidden"},rs={class:""},is={class:"text-xs text-blue-600"},us={class:"flex gap-4"},ds={class:"font-bold"},ps={key:0,class:"text-green-600"},vs={key:1,class:"pl-2 text-yellow-700"},cs={class:"pt-10"},_s={key:0},ms={key:1},gs={key:2,class:"print:hidden"},ys={class:""},fs={class:"text-xs text-blue-600"},bs={class:"flex gap-4"},xs={class:"font-bold"},hs={key:0,class:"text-green-600"},ks={key:1,class:"pl-2 text-yellow-700"},ws={class:"pt-10"},As={key:0},js={key:1},Cs={key:2,class:"print:hidden"},Ns={class:"text-xs text-blue-600"},Ds={class:"flex gap-4"},Rs={class:"font-bold"},Es={key:0,class:"text-green-600"},Fs={key:1,class:"pl-2 text-yellow-700"},Ss={class:"print:hidden"},Bs={key:0,class:"mb-2"},$s=["href"],Vs={key:0,class:"modal-bg"},qs={class:"modal-card"},Is={class:"flex justify-end gap-2 mt-4"},Ps={__name:"ExchangeOffdayShow",setup(Ls){const _t=kt(),mt=$t(),p=Bt(),u=Lt(),_=wt(),h=At(),k=f(!0),m=f(!1),g=f(""),w=f(null),s=jt(()=>u.exchange);Ct(async()=>{const{id:r}=p.params;try{await u.fetchExchange(r)}catch(e){console.error("Failed to fetch exchange details:",e)}finally{k.value=!1}});const gt=async()=>{try{await u.rejectExchange(p.params.id,g.value),m.value=!1,g.value="",await u.fetchExchange(p.params.id),j()}catch(r){console.error("Failed to reject exchange request:",r),alert("Failed to reject exchange request.")}},x=()=>{m.value=!0},y=async r=>{try{const{id:e}=p.params;r==="handover"&&await u.handoverAccept(e),r==="inCharge"&&await u.inChargeAccept(e),r==="recommend"&&await u.recommendByAccept(e),r==="approve"&&await u.approvedByAccept(e),alert(`${r} accepted successfully!`),await u.fetchExchange(e),j()}catch(e){console.error(`Failed to accept ${r}:`,e),alert(`Failed to accept ${r}.`)}},yt=async r=>{const e=r.target.files[0];if(e){const c=new FormData;c.append("file",e);const d=await u.fetchFileUpload(c);w.value=d==null?void 0:d.url,d!=null&&d.url?(ft(),h.success("File uploaded successfully")):h.error("Failed to upload file")}},ft=async()=>{try{const r={attachment:w.value};await u.uploadAttachmentExchange(p.params.id,r)}catch(r){console.error("Failed to reject short leave:",r),alert("Failed to reject short leave.")}};function bt(){window.print()}const xt=()=>mt.go(-1),ht=r=>new Date(r).toISOString().slice(0,10),A=r=>new Date(r).toLocaleDateString("en-US",{weekday:"long"});async function j(){await _t.markAsRead(p.query.notifyId)}return(r,e)=>{var c,d,C,N,D,R,E,F,S,B,$,V,q,I,L,M,U,W,H,O,T,P,z,G,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ie,ue,de,pe,ve,ce,_e,me,ge,ye,fe,be,xe,he,ke,we,Ae,je,Ce,Ne,De,Re,Ee,Fe,Se,Be,$e,Ve,qe,Ie,Le,Me,Ue,We,He,Oe,Te,Pe,ze,Ge,Je,Ke,Qe,Xe,Ye,Ze,et,tt,st,lt,at,nt,ot,rt,it,ut,dt,pt,vt;return n(),o(St,null,[t("div",Mt,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:xt},e[6]||(e[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[8]||(e[8]=t("h1",{class:"title-lg text-center"},"Exchange Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:bt},e[7]||(e[7]=[t("i",{class:"far fa-print"},null,-1),a(" Print ")]))])]),k.value?(n(),Nt(Vt,{key:0})):(n(),o("div",Ut,[e[42]||(e[42]=t("div",null,[t("h1",{class:"title-lg text-center"},"Offday Exchange Application")],-1)),t("div",Wt,[t("div",null,"Date: "+l(ht((c=s.value)==null?void 0:c.created_at)),1)]),t("div",null,[t("p",Ht,[e[9]||(e[9]=a(" Name: ")),t("b",null,l((C=(d=s.value)==null?void 0:d.user)==null?void 0:C.name),1)]),t("div",Ot,[t("p",null,[e[10]||(e[10]=a(" Designation: ")),t("b",null,l((R=(D=(N=s.value)==null?void 0:N.user)==null?void 0:D.designation)==null?void 0:R.title),1)])]),t("div",Tt,[t("p",null,[e[11]||(e[11]=a(" Department: ")),t("b",null,l((S=(F=(E=s.value)==null?void 0:E.user)==null?void 0:F.company)==null?void 0:S.name),1)])])]),t("div",Pt,[t("div",null,[e[12]||(e[12]=t("b",null,"Holiday Day:",-1)),a(" "+l(A((B=s.value)==null?void 0:B.current_date)),1)]),t("div",null,[e[13]||(e[13]=t("b",null,"Date:",-1)),a(" "+l(($=s.value)==null?void 0:$.current_date),1)]),t("div",null,[e[14]||(e[14]=t("b",null,"Exchange Day:",-1)),a(" "+l(A((V=s.value)==null?void 0:V.exchange_date)),1)]),t("div",null,[e[15]||(e[15]=t("b",null,"Date:",-1)),a(" "+l((q=s.value)==null?void 0:q.exchange_date),1)]),t("div",zt,[e[16]||(e[16]=t("b",null,"Reason:",-1)),a(" "+l(((I=s.value)==null?void 0:I.reason)||"N/A"),1)])]),t("div",Gt,[t("div",null,[t("div",null,[e[17]||(e[17]=t("b",null,"Works in Hand:",-1)),a(" "+l(((L=s.value)==null?void 0:L.works_in_hand)||"N/A"),1)])]),t("div",null,[t("p",null,l(((U=(M=s.value)==null?void 0:M.handover_user)==null?void 0:U.name)||"Not assigned"),1),!((W=s.value)!=null&&W.status)&&s.value.handover_user_id===b(_).user.id?(n(),o("div",Jt,[t("p",Kt,[a(l((O=(H=s.value)==null?void 0:H.user)==null?void 0:O.name)+" has assigned you for his handover.",1),e[18]||(e[18]=t("br",null,null,-1)),e[19]||(e[19]=a(" Do you agree? "))]),t("div",Qt,[t("button",{class:"font-bold text-lg text-green-600 px-2",onClick:e[0]||(e[0]=v=>y("handover"))}," ✔ "),e[20]||(e[20]=t("button",{class:"px-2"},"❌",-1))])])):i("",!0),e[23]||(e[23]=t("hr",{class:"w-44 border-black"},null,-1)),t("h4",Xt,[e[22]||(e[22]=a(" Handover ")),(T=s.value)!=null&&T.handover_user_id&&((P=s.value)!=null&&P.status)?(n(),o("span",Yt," (✔) ")):i("",!0),(z=s.value)!=null&&z.handover_user_id&&!((G=s.value)!=null&&G.status)?(n(),o("span",Zt,e[21]||(e[21]=[t("i",{class:"fad fa-spinner"},null,-1)]))):i("",!0)])])]),e[43]||(e[43]=t("hr",null,null,-1)),t("div",null,[t("h3",es,[e[24]||(e[24]=a(" Approvals ")),t("span",{class:Dt({"text-yellow-500":((J=s.value)==null?void 0:J.status)==="Pending","text-green-500":((K=s.value)==null?void 0:K.status)==="Approved","text-red-500":((Q=s.value)==null?void 0:Q.status)==="Rejected"})}," ("+l(((X=s.value)==null?void 0:X.status)||"N/A")+") ",3)]),((Y=s.value)==null?void 0:Y.status)==="Rejected"?(n(),o("div",ts,[t("div",null,[e[25]||(e[25]=t("b",null,"Rejected By:",-1)),a(" "+l(((ee=(Z=s.value)==null?void 0:Z.rejected_by_user)==null?void 0:ee.name)||"N/A"),1)]),t("div",null,[e[26]||(e[26]=t("b",null,"Rejection Reason:",-1)),a(" "+l(((te=s.value)==null?void 0:te.rejection_reason)||"N/A"),1)])])):i("",!0)]),t("div",ss,[t("div",ls,[(se=s.value)!=null&&se.in_charge_user?(n(),o("p",as,l(((ae=(le=s.value)==null?void 0:le.in_charge_user)==null?void 0:ae.name)||""),1)):(n(),o("p",ns,l(((ie=(re=(oe=(ne=s.value)==null?void 0:ne.user)==null?void 0:oe.other_approval)==null?void 0:re.in_charge_user)==null?void 0:ie.name)||"N/A"),1)),s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ue=s.value)!=null&&ue.in_charge_user_id)&&((ve=(pe=(de=s.value)==null?void 0:de.user)==null?void 0:pe.other_approval)==null?void 0:ve.in_charge_user_id)===b(_).user.id?(n(),o("div",os,[t("p",rs,l(((ge=(me=(_e=(ce=s.value)==null?void 0:ce.user)==null?void 0:_e.other_approval)==null?void 0:me.in_charge_user)==null?void 0:ge.name)||"N/A"),1),t("p",is,[a(l((fe=(ye=s.value)==null?void 0:ye.user)==null?void 0:fe.name)+" has submitted an application. ",1),e[27]||(e[27]=t("br",null,null,-1)),e[28]||(e[28]=a(" Will you forward it? "))]),t("div",us,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=v=>y("inCharge"))}," ✔ "),t("button",{class:"",onClick:x},"❌")])])):i("",!0),e[31]||(e[31]=t("hr",{class:"w-28 md:w-44 border-black mt-2"},null,-1)),t("p",ds,[e[30]||(e[30]=a(" In-Charge ")),(be=s.value)!=null&&be.in_charge_user_id?(n(),o("span",ps,"(✔)")):i("",!0),!((xe=s.value)!=null&&xe.in_charge_user_id)&&((we=(ke=(he=s.value)==null?void 0:he.user)==null?void 0:ke.other_approval)!=null&&we.in_charge_user)?(n(),o("span",vs,e[29]||(e[29]=[t("i",{class:"fad fa-spinner"},null,-1)]))):i("",!0)])]),t("div",cs,[(Ae=s.value)!=null&&Ae.recommend_by_user?(n(),o("p",_s,l(((Ce=(je=s.value)==null?void 0:je.recommend_by_user)==null?void 0:Ce.name)||""),1)):(n(),o("p",ms,l(((Ee=(Re=(De=(Ne=s.value)==null?void 0:Ne.user)==null?void 0:De.other_approval)==null?void 0:Re.recommend_by_user)==null?void 0:Ee.name)||"N/A"),1)),s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Fe=s.value)!=null&&Fe.recommend_by_user_id)&&(($e=(Be=(Se=s.value)==null?void 0:Se.user)==null?void 0:Be.other_approval)==null?void 0:$e.recommend_by_user_id)===b(_).user.id?(n(),o("div",gs,[t("p",ys,l(((Le=(Ie=(qe=(Ve=s.value)==null?void 0:Ve.user)==null?void 0:qe.other_approval)==null?void 0:Ie.recommend_by_user)==null?void 0:Le.name)||"N/A"),1),t("p",fs,[a(l((Ue=(Me=s.value)==null?void 0:Me.user)==null?void 0:Ue.name)+" has submitted an application.",1),e[32]||(e[32]=t("br",null,null,-1)),e[33]||(e[33]=a(" Will you recommend it? "))]),t("div",bs,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=v=>y("recommend"))}," ✔ "),t("button",{class:"",onClick:x},"❌")])])):i("",!0),e[36]||(e[36]=t("hr",{class:"w-28 md:w-44 border-black mt-2"},null,-1)),t("p",xs,[e[35]||(e[35]=a(" Recommend By ")),(We=s.value)!=null&&We.recommend_by_user_id?(n(),o("span",hs,"(✔)")):i("",!0),!((He=s.value)!=null&&He.recommend_by_user_id)&&((Pe=(Te=(Oe=s.value)==null?void 0:Oe.user)==null?void 0:Te.other_approval)!=null&&Pe.recommend_by_user)?(n(),o("span",ks,e[34]||(e[34]=[t("i",{class:"fad fa-spinner"},null,-1)]))):i("",!0)])]),t("div",ws,[(ze=s.value)!=null&&ze.approved_by_user?(n(),o("p",As,l(((Je=(Ge=s.value)==null?void 0:Ge.approved_by_user)==null?void 0:Je.name)||""),1)):(n(),o("p",js,l(((Ye=(Xe=(Qe=(Ke=s.value)==null?void 0:Ke.user)==null?void 0:Qe.other_approval)==null?void 0:Xe.approved_by_user)==null?void 0:Ye.name)||"N/A"),1)),s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Ze=s.value)!=null&&Ze.approved_by_user_id)&&((st=(tt=(et=s.value)==null?void 0:et.user)==null?void 0:tt.other_approval)==null?void 0:st.approved_by_user_id)===b(_).user.id?(n(),o("div",Cs,[t("p",Ns,[a(l((at=(lt=s.value)==null?void 0:lt.user)==null?void 0:at.name)+" has submitted an application.",1),e[37]||(e[37]=t("br",null,null,-1)),e[38]||(e[38]=a(" Will you accept it? "))]),t("div",Ds,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[3]||(e[3]=v=>y("approve"))}," ✔ "),t("button",{class:"",onClick:x},"❌")])])):i("",!0),e[41]||(e[41]=t("hr",{class:"w-44 border-black mt-2"},null,-1)),t("p",Rs,[e[40]||(e[40]=a(" Approved By ")),(nt=s.value)!=null&&nt.approved_by_user_id?(n(),o("span",Es,"(✔)")):i("",!0),!((ot=s.value)!=null&&ot.approved_by_user_id)&&((ut=(it=(rt=s.value)==null?void 0:rt.user)==null?void 0:it.other_approval)!=null&&ut.approved_by_user)?(n(),o("span",Fs,e[39]||(e[39]=[t("i",{class:"fad fa-spinner"},null,-1)]))):i("",!0)])])])])),t("div",Ss,[t("div",null,[e[44]||(e[44]=t("label",null,"Attachment",-1)),(dt=s.value)!=null&&dt.attachment&&typeof((pt=s.value)==null?void 0:pt.attachment)=="string"?(n(),o("div",Bs,[t("a",{href:(vt=s.value)==null?void 0:vt.attachment,target:"_blank",class:"text-blue-500 underline"}," View Current File ",8,$s)])):i("",!0),t("input",{type:"file",onChange:yt,class:"w-full p-2 border rounded"},null,32),e[45]||(e[45]=t("p",{class:"text-sm text-gray-600 mt-1"},"Selected File",-1))])]),ct(It,null,{default:Rt(()=>[ct(qt,{targetId:"leave-application",platform:"whatsapp"})]),_:1})]),m.value?(n(),o("div",Vs,[t("div",qs,[e[46]||(e[46]=t("h3",{class:"title-lg"},"Reject Exchange Request",-1)),Et(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=v=>g.value=v),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[Ft,g.value]]),t("div",Is,[t("button",{class:"btn-3",onClick:e[5]||(e[5]=v=>m.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:gt},"Confirm")])])])):i("",!0)],64)}}};export{Ps as default};
