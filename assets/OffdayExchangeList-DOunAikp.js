import{u as $,f as F,r as y,x as O,D as j,h as P,q as D,p as G,c as i,o as n,a as e,d as c,l as C,k as H,m as u,H as I,j as T,F as Y,e as z,t as p}from"./index-CLmgMs23.js";import{_ as J}from"./EmployeeFilter-DCNVwisw.js";import{_ as K}from"./FlexibleDatePicker-Bj9QYcDp.js";import{L as Q}from"./LoaderView-DeSV26WB.js";import{u as W}from"./exchange-CtbSm_iy.js";import{u as X}from"./user-FgST85lw.js";import"./company-BCXbDAZx.js";import"./department-CGzCQhC6.js";import"./EmployeeDropdownInput-5gLvi8vD.js";import"./SelectDropdown-p4nQPDr1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-C-Utqq0-.js";const Z={class:"space-y-2 px-4"},ee={class:"grid md:flex gap-4 p-2"},te={key:0,class:"text-center py-4"},oe={key:1,class:"space-y-4"},re={class:"overflow-x-auto"},se={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},ae={class:"border border-gray-300 px-2"},le={class:"border border-gray-300 px-2"},de={class:"border border-gray-300 px-2"},ie={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},pe={class:"border border-gray-300 px-2"},ue={class:"border border-gray-300 px-2"},me={class:"flex gap-2"},ye=["onClick"],ce={key:0},E="offday",he={__name:"OffdayExchangeList",setup(_e){const _=$(),l=F(),a=W(),w=X(),U=y(null),f=l.query.date||a.selectedMonth||new Date().toISOString().slice(0,7),v=y(f),g=new Date,h=s=>s.toString().padStart(2,"0"),d=y({year:Number(f.split("-")[0]||g.getFullYear()),month:Number(f.split("-")[1]||g.getMonth()+1),day:1}),A=O(()=>{var s,o;return!((s=d.value)!=null&&s.year)||!((o=d.value)!=null&&o.month)?"":`${d.value.year}-${h(d.value.month)}`}),{loading:M}=j(a),r=y({company_id:l.query.company_id||"",department_id:l.query.department_id||"all",type:l.query.type||"all",employee_id:l.query.employee_id||"",category:""});P(async()=>{M.value=!0,await w.fetchUsers(),U.value=w.users.find(s=>{var o;return s.id==((o=l==null?void 0:l.query)==null?void 0:o.company_id)}),await m()});const m=async()=>{r.value.employee_id?await a.fetchAllExchanges({company_id:r.value.company_id,department_id:r.value.department_id,user_id:r.value.employee_id,type:E,selectedMonth:v.value,selectedStatus:a.selectedStatus}):await a.fetchAllExchanges({company_id:r.value.company_id,department_id:r.value.department_id,type:E,selectedMonth:v.value,selectedStatus:a.selectedStatus})};D(()=>[r.value.company_id,r.value.department_id,r.value.employee_id],async()=>{await m()}),D(A,s=>{s&&(v.value=s,_.replace({query:{...l.query,date:s}}),m())},{immediate:!0});const N=()=>{_.go(-1)},V=async s=>{confirm("Are you sure to delete this application?")&&a.deleteExchange(s)},B=()=>{_.replace({query:{...l.query,company_id:r.value.company_id,department_id:r.value.department_id,type:r.value.type,employee_id:r.value.employee_id}})},b=s=>s?new Date(s).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"";return(s,o)=>{var S,k,q;const L=G("RouterLink");return n(),i("div",Z,[e("div",{class:"flex items-center justify-between gap-2"},[e("button",{class:"btn-3",onClick:N},o[6]||(o[6]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),o[7]||(o[7]=e("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Offday Exchanges",-1)),o[8]||(o[8]=e("div",null,null,-1))]),e("div",ee,[c(J,{company_id:r.value.company_id,"onUpdate:company_id":o[1]||(o[1]=t=>r.value.company_id=t),department_id:r.value.department_id,"onUpdate:department_id":o[2]||(o[2]=t=>r.value.department_id=t),employee_id:r.value.employee_id,"onUpdate:employee_id":o[3]||(o[3]=t=>r.value.employee_id=t),category:r.value.category,"onUpdate:category":o[4]||(o[4]=t=>r.value.category=t),"with-type":!0,"initial-value":s.$route.query,onFilterChange:B},{default:C(()=>[e("div",null,[H(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>u(a).selectedStatus=t),onChange:m,class:"input-1 py-0.5"},o[9]||(o[9]=[e("option",{value:"",selected:""},"All",-1),e("option",{value:"Pending"},"Pending",-1),e("option",{value:"Approved"},"Approved",-1),e("option",{value:"Rejected"},"Rejected",-1)]),544),[[I,u(a).selectedStatus]])])]),_:1},8,["company_id","department_id","employee_id","category","initial-value"]),e("div",null,[c(K,{modelValue:d.value,"onUpdate:modelValue":o[5]||(o[5]=t=>d.value=t),"show-year":!1,"show-month":!0,"show-date":!1},null,8,["modelValue"])])]),u(a).loading?(n(),i("div",te,[c(Q)])):(n(),i("div",oe,[e("div",re,[e("table",se,[o[13]||(o[13]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-300 px-2 text-left"},"#"),e("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),e("th",{class:"border border-gray-300 px-2 text-left"},"Created Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Current Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Exchange Date"),e("th",{class:"border border-gray-300 px-2 text-left"},"Status"),e("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),e("tbody",null,[(n(!0),i(Y,null,z((S=u(a))==null?void 0:S.all_exchanges,(t,R)=>{var x;return n(),i("tr",{key:t==null?void 0:t.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",ae,p(R+1),1),e("td",le,p(((x=t==null?void 0:t.user)==null?void 0:x.name)||"Unknown"),1),e("td",de,p(b(t==null?void 0:t.created_at)),1),e("td",ie,p(b(t==null?void 0:t.current_date)),1),e("td",ne,p(b(t==null?void 0:t.exchange_date)),1),e("td",pe,p((t==null?void 0:t.status)||"N/A"),1),e("td",ue,[e("div",me,[c(L,{to:{name:"ExchangeOffdayShow",params:{id:t==null?void 0:t.id}},class:"btn-icon"},{default:C(()=>o[10]||(o[10]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[10]},1032,["to"]),e("button",{onClick:fe=>V(t==null?void 0:t.id),class:"btn-icon text-red-500"},o[11]||(o[11]=[e("i",{class:"far fa-trash"},null,-1)]),8,ye)])])])}),128)),((q=(k=u(a))==null?void 0:k.all_exchanges)==null?void 0:q.length)===0?(n(),i("tr",ce,o[12]||(o[12]=[e("td",{colspan:"6",class:"p-2 text-center text-red-500"},"No exchanges found",-1)]))):T("",!0)])])])]))])}}};export{he as default};
