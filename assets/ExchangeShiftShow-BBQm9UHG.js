import{u as et,i as tt,r as b,p as st,b as lt,c as r,a as t,k as l,j as at,t as a,h as x,e as i,y as nt,l as ze,m as ot,d as rt,v as it,F as dt,f as ut,o,g as pt}from"./index-CsmDG6Aa.js";import{L as vt}from"./LoaderView-Bai0Uw93.js";import{_ as ct}from"./ScreenshotCapture-my2KoEb2.js";import{_ as mt}from"./ShareComponent-CDjoegy_.js";import{u as gt}from"./exchange-CFq67yQN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ft={class:"my-container max-w-3xl space-y-6"},_t={key:1,class:"bg-white rounded p-4 md:p-8",id:"leave-application"},bt={class:"flex justify-end"},xt={class:"font-medium"},yt={class:"gap-y-1"},ht={class:"gap-y-1"},kt={class:"grid md:grid-cols-2 pt-3"},wt={class:"col-span-2 pt-2"},jt={class:"grid print:grid-cols-2 md:grid-cols-2 gap-4 pt-10"},At={key:0,class:"print:hidden"},Ct={class:"text-xs"},Dt={class:"flex gap-2"},Ft={class:"font-bold"},Rt={key:0,class:"text-green-600 print:text-black"},Et={key:1,class:"pl-2 text-yellow-700"},Nt={class:"title-md"},St={key:0},Bt={class:"grid print:grid-cols-3 md:grid-cols-3 justify-center items-center gap-4"},$t={class:"pt-10"},Vt={key:0,class:"print:hidden"},Lt={class:""},Mt={class:"text-xs text-blue-600"},Tt={class:"flex gap-4"},Ut={class:"font-bold"},Wt={key:0,class:"text-green-600"},qt={class:"pt-10"},It={key:0,class:"print:hidden"},Ht={class:""},Pt={class:"text-xs text-blue-600"},zt={class:"flex gap-4"},Ot={class:"font-bold"},Gt={key:0,class:"text-green-600"},Jt={class:"pt-10"},Kt={key:0,class:"print:hidden"},Qt={class:""},Xt={class:"text-xs text-blue-600"},Yt={class:"flex gap-4"},Zt={class:"font-bold"},es={key:0,class:"text-green-600"},ts={class:"print:hidden"},ss={key:0,class:"mb-2"},ls=["href"],as={key:0,class:"modal-bg"},ns={class:"modal-card"},os={class:"flex justify-end gap-2 mt-4"},ms={__name:"ExchangeShiftShow",setup(rs){const Oe=pt(),v=ut(),d=gt(),m=et(),h=tt(),k=b(!0),g=b(!1),f=b(""),w=b(null),s=st(()=>d.exchange);lt(async()=>{const{id:n}=v.params;try{await d.fetchExchange(n),console.log()}catch(e){console.error("Failed to fetch exchange details:",e)}finally{k.value=!1}});const Ge=async()=>{try{await d.rejectExchange(v.params.id,f.value),g.value=!1,f.value="",await d.fetchExchange(v.params.id)}catch(n){console.error("Failed to reject exchange request:",n),alert("Failed to reject exchange request.")}},y=()=>{g.value=!0},_=async n=>{try{const{id:e}=v.params;n==="handover"&&await d.handoverAccept(e),n==="inCharge"&&await d.inChargeAccept(e),n==="recommend"&&await d.recommendByAccept(e),n==="approve"&&await d.approvedByAccept(e),alert(`${n} accepted successfully!`),await d.fetchExchange(e)}catch(e){console.error(`Failed to accept ${n}:`,e),alert(`Failed to accept ${n}.`)}},Je=async n=>{const e=n.target.files[0];if(e){const c=new FormData;c.append("file",e);const u=await d.fetchFileUpload(c);w.value=u==null?void 0:u.url,u!=null&&u.url?(Ke(),h.success("File uploaded successfully")):h.error("Failed to upload file")}},Ke=async()=>{try{const n={attachment:w.value};await d.uploadAttachmentExchange(v.params.id,n)}catch(n){console.error("Failed to reject short leave:",n),alert("Failed to reject short leave.")}};function Qe(){window.print()}const Xe=()=>Oe.go(-1),Ye=n=>new Date(n).toISOString().slice(0,10),Ze=n=>new Date(n).toLocaleDateString("en-US",{weekday:"long"});return(n,e)=>{var c,u,j,A,C,D,F,R,E,N,S,B,$,V,L,M,T,U,W,q,I,H,P,z,O,G,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ie,de,ue,pe,ve,ce,me,ge,fe,_e,be,xe,ye,he,ke,we,je,Ae,Ce,De,Fe,Re,Ee,Ne,Se,Be,$e,Ve,Le,Me,Te,Ue,We,qe,Ie,He,Pe;return o(),r(dt,null,[t("div",ft,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:Xe},e[6]||(e[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[8]||(e[8]=t("h1",{class:"title-lg text-center"},"Exchange Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:Qe},e[7]||(e[7]=[t("i",{class:"far fa-print"},null,-1),l(" Print ")]))])]),k.value?(o(),at(vt,{key:0})):(o(),r("div",_t,[e[39]||(e[39]=t("div",null,[t("h1",{class:"title-lg text-center"},"Shift Exchange Application")],-1)),t("div",bt,[t("div",null,"Date: "+a(Ye((c=s.value)==null?void 0:c.created_at)),1)]),t("div",null,[t("p",xt,[e[9]||(e[9]=l(" Name: ")),t("b",null,a((j=(u=s.value)==null?void 0:u.user)==null?void 0:j.name),1)]),t("div",yt,[t("p",null,[e[10]||(e[10]=l(" Designation: ")),t("b",null,a((D=(C=(A=s.value)==null?void 0:A.user)==null?void 0:C.designation)==null?void 0:D.title),1)])]),t("div",ht,[t("p",null,[e[11]||(e[11]=l(" Department: ")),t("b",null,a((E=(R=(F=s.value)==null?void 0:F.user)==null?void 0:R.company)==null?void 0:E.name),1)])])]),t("div",kt,[t("div",null,[e[12]||(e[12]=t("b",null,"Exchange Day:",-1)),l(" "+a(Ze((N=s.value)==null?void 0:N.exchange_date)),1)]),t("div",null,[e[13]||(e[13]=t("b",null,"Date:",-1)),l(" "+a((S=s.value)==null?void 0:S.exchange_date),1)]),t("div",null,[e[14]||(e[14]=t("b",null,"From:",-1)),l(" "+a((V=($=(B=s.value)==null?void 0:B.user)==null?void 0:$.shift)==null?void 0:V.name),1)]),t("div",null,[e[15]||(e[15]=t("b",null,"To:",-1)),l(" "+a((M=(L=s.value)==null?void 0:L.shift)==null?void 0:M.name),1)]),t("div",wt,[e[16]||(e[16]=t("b",null,"Reason:",-1)),l(" "+a(((T=s.value)==null?void 0:T.reason)||"N/A"),1)])]),t("div",jt,[t("div",null,[t("div",null,[e[17]||(e[17]=t("b",null,"Works in Hand:",-1)),l(" "+a(((U=s.value)==null?void 0:U.works_in_hand)||"N/A"),1)])]),t("div",null,[t("p",null,a(((q=(W=s.value)==null?void 0:W.handover_user)==null?void 0:q.name)||"Not assigned"),1),!((I=s.value)!=null&&I.status)&&s.value.handover_user_id===x(m).user.id?(o(),r("div",At,[t("p",Ct,[l(a((P=(H=s.value)==null?void 0:H.user)==null?void 0:P.name)+" has assigned you for his handover.",1),e[18]||(e[18]=t("br",null,null,-1)),e[19]||(e[19]=l(" Do you agree? "))]),t("div",Dt,[t("button",{class:"font-bold text-lg text-green-600 px-2",onClick:e[0]||(e[0]=p=>_("handover"))}," ✔ "),e[20]||(e[20]=t("button",{class:"px-2"},"❌",-1))])])):i("",!0),e[23]||(e[23]=t("hr",{class:"w-44 border-black mt-2"},null,-1)),t("h4",Ft,[e[22]||(e[22]=l(" Handover ")),(z=s.value)!=null&&z.handover_user_id&&((O=s.value)!=null&&O.status)?(o(),r("span",Rt," (✔) ")):i("",!0),(G=s.value)!=null&&G.handover_user_id&&!((J=s.value)!=null&&J.status)?(o(),r("span",Et,e[21]||(e[21]=[t("i",{class:"fad fa-spinner"},null,-1)]))):i("",!0)])])]),e[40]||(e[40]=t("hr",{class:"mt-2"},null,-1)),t("div",null,[t("h3",Nt,[e[24]||(e[24]=l(" Approvals ")),t("span",{class:nt({"text-yellow-500":((K=s.value)==null?void 0:K.status)==="Pending","text-green-500":((Q=s.value)==null?void 0:Q.status)==="Approved","text-red-500":((X=s.value)==null?void 0:X.status)==="Rejected"})}," ("+a(((Y=s.value)==null?void 0:Y.status)||"N/A")+") ",3)]),((Z=s.value)==null?void 0:Z.status)==="Rejected"?(o(),r("div",St,[t("div",null,[e[25]||(e[25]=t("b",null,"Rejected By:",-1)),l(" "+a(((te=(ee=s.value)==null?void 0:ee.rejected_by_user)==null?void 0:te.name)||"N/A"),1)]),t("div",null,[e[26]||(e[26]=t("b",null,"Rejection Reason:",-1)),l(" "+a(((se=s.value)==null?void 0:se.rejection_reason)||"N/A"),1)])])):i("",!0)]),t("div",Bt,[t("div",$t,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((le=s.value)!=null&&le.in_charge_user_id)&&((oe=(ne=(ae=s.value)==null?void 0:ae.user)==null?void 0:ne.other_approval)==null?void 0:oe.in_charge_user_id)===x(m).user.id?(o(),r("div",Vt,[t("p",Lt,a(((ue=(de=(ie=(re=s.value)==null?void 0:re.user)==null?void 0:ie.other_approval)==null?void 0:de.in_charge_user)==null?void 0:ue.name)||"N/A"),1),t("p",Mt,[l(a((ve=(pe=s.value)==null?void 0:pe.user)==null?void 0:ve.name)+" has submitted an application. ",1),e[27]||(e[27]=t("br",null,null,-1)),e[28]||(e[28]=l(" Will you forward it? "))]),t("div",Tt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=p=>_("inCharge"))}," ✔ "),t("button",{class:"",onClick:y},"❌")])])):i("",!0),t("p",null,a(((me=(ce=s.value)==null?void 0:ce.in_charge_user)==null?void 0:me.name)||""),1),e[30]||(e[30]=t("hr",{class:"w-44 border-black mt-2"},null,-1)),t("p",Ut,[e[29]||(e[29]=l(" In-Charge ")),(ge=s.value)!=null&&ge.in_charge_user_id?(o(),r("span",Wt,"(✔)")):i("",!0)])]),t("div",qt,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((fe=s.value)!=null&&fe.recommend_by_user_id)&&((xe=(be=(_e=s.value)==null?void 0:_e.user)==null?void 0:be.other_approval)==null?void 0:xe.recommend_by_user_id)===x(m).user.id?(o(),r("div",It,[t("p",Ht,a(((we=(ke=(he=(ye=s.value)==null?void 0:ye.user)==null?void 0:he.other_approval)==null?void 0:ke.recommend_by_user)==null?void 0:we.name)||"N/A"),1),t("p",Pt,[l(a((Ae=(je=s.value)==null?void 0:je.user)==null?void 0:Ae.name)+" has submitted an application.",1),e[31]||(e[31]=t("br",null,null,-1)),e[32]||(e[32]=l(" Will you recommend it? "))]),t("div",zt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=p=>_("recommend"))}," ✔ "),t("button",{class:"",onClick:y},"❌")])])):i("",!0),t("p",null,a(((De=(Ce=s.value)==null?void 0:Ce.recommend_by_user)==null?void 0:De.name)||""),1),e[34]||(e[34]=t("hr",{class:"w-44 border-black mt-2"},null,-1)),t("p",Ot,[e[33]||(e[33]=l(" Recommend By ")),(Fe=s.value)!=null&&Fe.recommend_by_user_id?(o(),r("span",Gt,"(✔)")):i("",!0)])]),t("div",Jt,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Re=s.value)!=null&&Re.approved_by_user_id)&&((Se=(Ne=(Ee=s.value)==null?void 0:Ee.user)==null?void 0:Ne.other_approval)==null?void 0:Se.approved_by_user_id)===x(m).user.id?(o(),r("div",Kt,[t("p",Qt,a(((Le=(Ve=($e=(Be=s.value)==null?void 0:Be.user)==null?void 0:$e.other_approval)==null?void 0:Ve.approved_by_user)==null?void 0:Le.name)||"N/A"),1),t("p",Xt,[l(a((Te=(Me=s.value)==null?void 0:Me.user)==null?void 0:Te.name)+" has submitted an application.",1),e[35]||(e[35]=t("br",null,null,-1)),e[36]||(e[36]=l(" Will you accept it? "))]),t("div",Yt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[3]||(e[3]=p=>_("approve"))}," ✔ "),t("button",{class:"",onClick:y},"❌")])])):i("",!0),t("p",null,a(((We=(Ue=s.value)==null?void 0:Ue.approved_by_user)==null?void 0:We.name)||""),1),e[38]||(e[38]=t("hr",{class:"w-44 border-black mt-2"},null,-1)),t("p",Zt,[e[37]||(e[37]=l(" Approved By ")),(qe=s.value)!=null&&qe.approved_by_user_id?(o(),r("span",es,"(✔)")):i("",!0)])])])])),t("div",ts,[t("div",null,[e[41]||(e[41]=t("label",null,"Attachment",-1)),(Ie=s.value)!=null&&Ie.attachment&&typeof((He=s.value)==null?void 0:He.attachment)=="string"?(o(),r("div",ss,[t("a",{href:(Pe=s.value)==null?void 0:Pe.attachment,target:"_blank",class:"text-blue-500 underline"}," View Current File ",8,ls)])):i("",!0),t("input",{type:"file",onChange:Je,class:"w-full p-2 border rounded"},null,32),e[42]||(e[42]=t("p",{class:"text-sm text-gray-600 mt-1"},"Selected File",-1))])]),ze(mt,null,{default:ot(()=>[ze(ct,{targetId:"leave-application",platform:"whatsapp"})]),_:1})]),g.value?(o(),r("div",as,[t("div",ns,[e[43]||(e[43]=t("h3",{class:"title-lg"},"Reject Exchange Request",-1)),rt(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=p=>f.value=p),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[it,f.value]]),t("div",os,[t("button",{class:"btn-3",onClick:e[5]||(e[5]=p=>g.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:Ge},"Confirm")])])])):i("",!0)],64)}}};export{ms as default};
