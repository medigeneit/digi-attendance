import{r as f,e as N,z as D,c as p,o as d,a as e,g as v,F as E,h as V,j as R,p as i,v as q,i as x,w,B as M,f as B,t as C,k as $,u as F}from"./index-DfseKDJj.js";import{_ as U}from"./CompanyDepartmentSelectInput-eagSCYy6.js";import{R as h}from"./RequiredIcon-CcDwljMb.js";import{a as z}from"./requirement-BWpIx0mj.js";import{u as A}from"./company-CUlmvYZZ.js";import{u as O}from"./tags-DlImAwJw.js";import{L as j}from"./LoaderView-CjrIvmzj.js";import{S as I}from"./SelectDropdown-C98DSrzS.js";import{T as L}from"./TextWithHr-DNzl1QX9.js";import{u as P}from"./department-CyvbDj7H.js";import{_ as T}from"./UserChip-D9kkJvtx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"mb-4"},G={class:"block text-gray-600 text-sm mb-1 font-medium"},H={class:"mb-4"},J={class:"mb-4"},K={key:0,class:"relative w-full"},Q={key:0,class:"absolute right-1 text-xl top-0 bottom-0 flex items-center"},X={class:"mb-4"},Y={class:"mb-4"},Z={__name:"RequirementFormDetailItem",props:{fromDepartmentId:{type:[Number,String],required:!0}},emits:["update","onRemoveClick"],setup(S,{emit:g}){const m=S,b=g,n=P(),r=f(""),l=f({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:"4"}),a=f([]);return N(async()=>{a.value=await n.fetchDepartmentEmployee([m.fromDepartmentId])}),D(()=>m.fromDepartmentId,async()=>{a.value=await n.fetchDepartmentEmployee([m.fromDepartmentId])}),D(()=>({...l.value}),c=>{b("update",c)}),(c,t)=>(d(),p("div",null,[e("form",{onSubmit:t[6]||(t[6]=w((...s)=>c.submit&&c.submit(...s),["prevent"])),class:"z-0"},[r.value!=="loading"?(d(),p(E,{key:0},[e("div",W,[e("label",G,[t[7]||(t[7]=R("Requirement Title ")),i(h)]),V(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.title=s),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[q,l.value.title]])]),e("div",H,[t[8]||(t[8]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Requirement Details",-1)),V(e("textarea",{rows:"10","onUpdate:modelValue":t[1]||(t[1]=s=>l.value.description=s),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[q,l.value.description]])]),e("div",J,[t[9]||(t[9]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor ",-1)),i(I,{modelValue:l.value.supervisor_id,"onUpdate:modelValue":t[3]||(t[3]=s=>l.value.supervisor_id=s),options:a.value,placeholder:"--NO SUPERVISOR--"},{option:x(({option:s})=>[i(T,{user:s||{}},null,8,["user"])]),"selected-option":x(({option:s})=>[s?(d(),p("div",K,[i(T,{user:s||{}},null,8,["user"]),l.value.supervisor_id?(d(),p("div",Q,[e("button",{onClick:t[2]||(t[2]=w(o=>l.value.supervisor_id=null,["prevent"])),class:"text-gray-6 font-semibold 00 hover:text-red-700"}," Ã— ")])):v("",!0)])):v("",!0)]),_:1},8,["modelValue","options"])]),e("div",X,[t[11]||(t[11]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),V(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[4]||(t[4]=s=>l.value.priority=s)},t[10]||(t[10]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[M,l.value.priority]])]),e("div",Y,[t[12]||(t[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),V(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=s=>l.value.better_to_complete_on=s),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[q,l.value.better_to_complete_on]])])],64)):v("",!0)],32)]))}},ee={class:"w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},te={class:"sticky top-0 pt-4 bg-white z-10"},oe={class:"block text-gray-600 text-sm mb1 font-medium"},se={class:"block text-gray-600 text-sm mb-1 font-medium"},le={class:"mb-4"},re={class:"mb-8 mt-10"},ae={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},ie={key:0,class:"mb-4 text-red-500 font-medium"},ne={key:1,class:"mb-4"},me={class:"flex items-center justify-between gap-4"},ue=["disabled"],de={__name:"RequirementAddForm",emits:["create","cancelClick","error"],setup(S,{emit:g}){const m=g,b=O(),n=A(),r=f(""),l=f(""),a=f({from_department_id:"",to_department_id:"",website_tags:[],details:[]});N(async()=>{r.value="loading",b.fetchTags("website"),await n.fetchCompanies({with:"departments",ignore_permission:!0}),await n.fetchMyCompanies({with:"departments"}),r.value=""});async function c(){var o,_,y,u;r.value="submitting";const s={...a.value};try{const k=await z(s);m("create",k),r.value="create"}catch(k){m("error",(_=(o=k.response)==null?void 0:o.data)==null?void 0:_.message),l.value=(u=(y=k.response)==null?void 0:y.data)==null?void 0:u.message,r.value="error"}}function t(s){console.log({detailData:s}),a.value.details=[s]}return(s,o)=>{var _,y;return d(),p("div",ee,[e("div",te,[o[5]||(o[5]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add New Requirement",-1)),o[6]||(o[6]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:o[0]||(o[0]=w(u=>m("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),R(" "+C(a.value)+" ",1),e("form",{onSubmit:w(c,["prevent"]),class:"z-0"},[r.value!=="loading"&&r.value!=="submitting"?(d(),p(E,{key:0},[i(U,{modelValue:a.value.from_department_id,"onUpdate:modelValue":o[1]||(o[1]=u=>a.value.from_department_id=u),companies:((_=$(n))==null?void 0:_.myCompanies)||[],class:"mb-4"},{label:x(()=>[e("label",oe,[o[7]||(o[7]=R(" From ")),i(h)])]),_:1},8,["modelValue","companies"]),i(U,{modelValue:a.value.to_department_id,"onUpdate:modelValue":o[2]||(o[2]=u=>a.value.to_department_id=u),companies:((y=$(n))==null?void 0:y.companies)||[],class:"mb-4"},{label:x(()=>[e("label",se,[o[8]||(o[8]=R(" To ")),i(h)])]),_:1},8,["modelValue","companies"]),e("div",le,[o[9]||(o[9]=e("label",{class:"text-gray-800"},"Websites",-1)),i(I,{options:$(b).tags,modelValue:a.value.website_tags,"onUpdate:modelValue":o[3]||(o[3]=u=>a.value.website_tags=u),taggable:"",label:"name",value:"name"},null,8,["options","modelValue"])])],64)):v("",!0),e("div",re,[i(L,{class:"mb-5"},{default:x(()=>o[10]||(o[10]=[e("h3",{class:"font-semibold text-xl text-gray-800 mx-2"},"Requirement details",-1)])),_:1,__:[10]}),i(Z,{"from-department-id":a.value.from_department_id,onUpdate:t},null,8,["from-department-id"])]),e("div",ae,[l.value?(d(),p("div",ie,C(l.value),1)):v("",!0),l.value?(d(),p("hr",ne)):v("",!0),e("div",me,[e("button",{type:"button",onClick:o[4]||(o[4]=w(u=>m("cancelClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:r.value=="loading"||r.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},C(r.value=="submitting"?"Saving...":"Save"),9,ue)])])],32),r.value==="loading"||r.value==="submitting"?(d(),B(j,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):v("",!0)])}}},pe={class:"container mx-auto p-6"},Se={__name:"RequirementAdd",setup(S){const g=F();function m(b){var r;const n=((r=b.data)==null?void 0:r.requirement)||null;n&&g.push({name:"RequirementShow",params:{id:n.id}})}return(b,n)=>(d(),p("div",pe,[i(de,{onCreate:m})]))}};export{Se as default};
