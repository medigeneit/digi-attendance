import{D as A,r as p,y as k,E as w,o as y,c as b,a as e,q as S,t as h,e as E,K as I,A as j,w as F,d as g,v as D,C as N,j as U,b as q,m as $,h as C,F as L,x as P}from"./index-CkmyQy8U.js";import{_ as B,a as O}from"./HeaderWithButtons-dFVAbVB0.js";import{L as T}from"./LoaderView-D0uvVIAB.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const V=A("device",()=>{const u=p([]),i=p(null),r=p(!1),n=p(null),c=async()=>{var t,a;r.value=!0,n.value=null;try{const l=await w.get("/devices");u.value=l.data}catch(l){n.value=((a=(t=l.response)==null?void 0:t.data)==null?void 0:a.message)||"ডিভাইস লোড করতে ব্যর্থ হয়েছে।",console.error("Error fetching devices:",l)}finally{r.value=!1}},s=async t=>{var a,l;r.value=!0,n.value=null;try{const o=await w.get(`/devices/${t}`);i.value=o.data}catch(o){n.value=((l=(a=o.response)==null?void 0:a.data)==null?void 0:l.message)||`ডিভাইস (ID: ${t}) লোড করতে ব্যর্থ হয়েছে।`,console.error(`Error fetching device with id ${t}:`,o)}finally{r.value=!1}},_=async t=>{var a,l;r.value=!0,n.value=null;try{const o=await w.post("/devices",t);return u.value.push(o.data),o.data}catch(o){n.value=((l=(a=o.response)==null?void 0:a.data)==null?void 0:l.message)||"ডিভাইস তৈরি করতে ব্যর্থ হয়েছে।",console.error("Error creating device:",o)}finally{r.value=!1}},m=async(t,a)=>{var l,o;r.value=!0,n.value=null;try{const f=await w.put(`/devices/${t}`,a),v=u.value.findIndex(M=>M.id===t);return v!==-1&&(u.value[v]=f.data),f.data}catch(f){n.value=((o=(l=f.response)==null?void 0:l.data)==null?void 0:o.message)||`ডিভাইস (ID: ${t}) আপডেট করতে ব্যর্থ হয়েছে।`,console.error(`Error updating device with id ${t}:`,f)}finally{r.value=!1}},x=async t=>{var a,l;r.value=!0,n.value=null;try{await w.delete(`/devices/${t}`),u.value=u.value.filter(o=>o.id!==t)}catch(o){n.value=((l=(a=o.response)==null?void 0:a.data)==null?void 0:l.message)||`ডিভাইস (ID: ${t}) মুছতে ব্যর্থ হয়েছে।`,console.error(`Error deleting device with id ${t}:`,o)}finally{r.value=!1}},d=async t=>{try{return await w.get(`/check-device-connection/${t}`),!0}catch(a){return console.error(a),!1}};return{devices:k(()=>u.value),device:k(()=>i.value),loading:k(()=>r.value),error:k(()=>n.value),fetchDevices:c,fetchDevice:s,createDevice:_,updateDevice:m,deleteDevice:x,checkDeviceConnection:d}}),z={class:"flex justify-center items-center gap-2"},K={__name:"CheckDeviceConnection",props:{device:Object},setup(u){const i=V(),r=u,n=p(!1),c=p(""),s=p(!1),_=async()=>{s.value=!0;const m=await i.checkDeviceConnection(r.device.id);n.value=m,c.value=m?"success":"Failed",s.value=!1,setTimeout(()=>{c.value=!1},1e3*60)};return(m,x)=>(y(),b("div",z,[e("button",{onClick:_,class:"text-blue-600 hover:text-blue-800"},[e("i",{class:S(["fas fa-sync-alt",{"animate-spin":s.value}])},null,2)]),c.value?(y(),b("span",{key:0,class:S(n.value?"text-green-600":"text-red-600")},h(c.value),3)):E("",!0)]))}},G={key:0,class:"modal-bg"},H={class:"modal-card"},J={class:"text-lg font-semibold mb-4"},Q={class:"mb-4"},R={class:"mb-4"},W={class:"mb-4"},X={class:"mb-4"},Y={class:"mb-4"},Z={class:"mb-4"},ee={class:"flex justify-end"},te={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},se={__name:"DeviceModal",props:{show:{type:Boolean,required:!0},device:{type:Object,default:null}},emits:["close","save"],setup(u,{emit:i}){const r=u,n=i,c=p(!1),s=I({id:null,name:"",ip_address:"",port:"",serial_number:"",firmware:"",status:"active"}),_=()=>{c.value=!1,s.id=null,s.name="",s.ip_address="",s.port="",s.serial_number="",s.firmware="",s.status="active"};j(()=>r.device,d=>{d&&typeof d=="object"&&Object.keys(d).length>0?(c.value=!0,s.id=d.id||null,s.name=d.name||"",s.ip_address=d.ip_address||"",s.port=d.port||"",s.serial_number=d.serial_number||"",s.firmware=d.firmware||"",s.status=d.status||"active"):_()},{immediate:!0,deep:!0});const m=()=>{n("save",{...s}),x()},x=()=>{n("close")};return(d,t)=>u.show?(y(),b("div",G,[e("div",H,[e("h2",J,h(c.value?"Edit Device":"Add Device"),1),e("form",{onSubmit:F(m,["prevent"])},[e("div",Q,[t[6]||(t[6]=e("label",{for:"name",class:"block text-sm font-medium mb-2"},"Name",-1)),g(e("input",{id:"name","onUpdate:modelValue":t[0]||(t[0]=a=>s.name=a),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter device name",required:""},null,512),[[D,s.name]])]),e("div",R,[t[7]||(t[7]=e("label",{for:"ip_address",class:"block text-sm font-medium mb-2"},"IP Address",-1)),g(e("input",{id:"ip_address","onUpdate:modelValue":t[1]||(t[1]=a=>s.ip_address=a),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter IP address",required:""},null,512),[[D,s.ip_address]])]),e("div",W,[t[8]||(t[8]=e("label",{for:"port",class:"block text-sm font-medium mb-2"},"Port",-1)),g(e("input",{id:"port","onUpdate:modelValue":t[2]||(t[2]=a=>s.port=a),type:"number",class:"w-full border rounded px-3 py-2",placeholder:"Enter port",required:""},null,512),[[D,s.port]])]),e("div",X,[t[9]||(t[9]=e("label",{for:"serial_number",class:"block text-sm font-medium mb-2"},"Serial Number",-1)),g(e("input",{id:"serial_number","onUpdate:modelValue":t[3]||(t[3]=a=>s.serial_number=a),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter serial number (optional)"},null,512),[[D,s.serial_number]])]),e("div",Y,[t[10]||(t[10]=e("label",{for:"firmware",class:"block text-sm font-medium mb-2"},"Firmware",-1)),g(e("input",{id:"firmware","onUpdate:modelValue":t[4]||(t[4]=a=>s.firmware=a),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter firmware version (optional)"},null,512),[[D,s.firmware]])]),e("div",Z,[t[12]||(t[12]=e("label",{for:"status",class:"block text-sm font-medium mb-2"},"Status",-1)),g(e("select",{id:"status","onUpdate:modelValue":t[5]||(t[5]=a=>s.status=a),class:"w-full border rounded px-3 py-2",required:""},t[11]||(t[11]=[e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1),e("option",{value:"error"},"Error",-1)]),512),[[N,s.status]])]),e("div",ee,[e("button",{type:"button",onClick:x,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2"}," Cancel "),e("button",te,h(c.value?"Update":"Create"),1)])],32)])])):E("",!0)}},ae={class:"my-container space-y-2"},oe={class:"overflow-x-auto"},le={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},re={class:"text-gray-600 text-sm"},ne={key:0},ie={colspan:"6"},de={class:"py-3 px-2 text-left"},ce={class:"font-medium"},ue={class:"py-3 px-2 text-left whitespace-nowrap"},pe={class:"font-medium"},ve={class:"py-3 px-2 text-center"},me={class:"font-medium"},fe={class:"py-3 px-2 text-center"},ye={class:"font-medium"},be={class:"py-3 px-2 text-center"},_e={class:"py-3 px-2 text-center"},xe={class:"flex item-center justify-center gap-4"},he=["onClick"],we={key:2},Ce={__name:"DeviceList",setup(u){const i=V(),r=U(),n=p(!1),c=p(!1),s=p(null),_=()=>{s.value=null,n.value=!0},m=l=>{s.value=l,n.value=!0},x=()=>{n.value=!1},d=async l=>{try{l.id?(await i.updateDevice(l.id,l),r.success("Device updated successfully!")):(await i.createDevice(l),r.success("Device added successfully!")),await i.fetchDevices()}catch(o){r.error("Failed to save device!"),console.error("Error handling save:",o)}},t=()=>{c.value=!1},a=async()=>{if(!s.value||!s.value.id){r.error("Invalid device selected for deletion!");return}try{await i.deleteDevice(s.value.id),r.warning("Device deleted successfully!"),await i.fetchDevices()}catch(l){r.error("Failed to delete device!"),console.error("Error deleting device:",l)}finally{t()}};return q(async()=>{await i.fetchDevices()}),(l,o)=>{var f;return y(),b("div",ae,[$(O,{title:"Device List",onAdd:_}),e("div",oe,[e("table",le,[o[3]||(o[3]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"Name"),e("th",{class:"py-3 px-2 text-left"},"IP Address"),e("th",{class:"py-3 px-2 text-center"},"Port"),e("th",{class:"py-3 px-2 text-center"},"Status"),e("th",{class:"py-3 px-2 text-center"},"Connection"),e("th",{class:"py-3 px-2 text-center"},"Action")])],-1)),e("tbody",re,[C(i).loading?(y(),b("tr",ne,[e("td",ie,[$(T)])])):C(i).devices&&C(i).devices.length?(y(!0),b(L,{key:1},P(C(i).devices,v=>(y(),b("tr",{key:v.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",de,[e("p",ce,h(v.name),1)]),e("td",ue,[e("p",pe,h(v.ip_address),1)]),e("td",ve,[e("p",me,h(v.port),1)]),e("td",fe,[e("p",ye,h(v.status),1)]),e("td",be,[$(K,{device:v},null,8,["device"])]),e("td",_e,[e("div",xe,[e("button",{onClick:M=>m(v),class:"text-blue-600 hover:text-blue-800"},o[0]||(o[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,he),E("",!0)])])]))),128)):(y(),b("tr",we,o[2]||(o[2]=[e("td",{colspan:"5",class:"text-center text-red-500 py-4"},"No devices found",-1)])))])])]),$(se,{show:n.value,device:s.value,onClose:x,onSave:d},null,8,["show","device"]),$(B,{show:c.value,title:"Delete Device",message:`Are you sure you want to delete ${(f=s.value)==null?void 0:f.name}?`,onClose:t,onConfirm:a},null,8,["show","message"])])}}};export{Ce as default};
