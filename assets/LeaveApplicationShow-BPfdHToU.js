import{u as St,r as b,p as Wt,b as Tt,c as i,a as e,k as a,j as Vt,t as l,h as p,e as u,F as kt,x as Ht,y as At,l as Mt,d as Ot,v as Et,f as Ft,o as r,g as Pt}from"./index-UFfEhbYM.js";import{u as Ut}from"./leave-application-CTqeUhV2.js";import{L as zt}from"./LoaderView-BOuvwNZF.js";import{_ as qt}from"./ShareComponent-TsO_y5aU.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Gt={class:"my-container max-w-3xl space-y-6"},Jt={key:1,class:"card-bg p-4 md:p-8"},Kt={class:"title-lg text-center"},Qt={class:"text-center text-sm"},Xt={class:"space-y-4"},Yt={class:"grid md:grid-cols-2 print:grid-cols-2 gap-8"},Zt={class:""},es={class:"text-sm"},ts={class:""},ss={class:"grid print:grid-cols-2 md:grid-cols-2 text-sm"},ls={class:"text-sm"},as={class:"pt-8 grid grid-cols-2"},ns={class:"text-sm"},os={class:"flex flex-col justify-center items-center text-sm"},rs={key:0,class:"print:hidden"},is={class:"text-xs text-center"},ds={class:"flex justify-center gap-2"},us={class:"font-bold"},ps={key:0,class:"text-green-600 print:text-black"},cs={key:1,class:"pl-2 text-yellow-700"},vs={class:"overflow-x-auto"},ys={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},ms={class:"border border-gray-500 px-4 py-0.5 text-left"},_s={class:"border border-gray-500 px-4 py-0.5 text-center"},xs={class:"border border-gray-500 px-4 py-0.5 text-center"},bs={class:"space-y-14"},fs={class:"font-bold text-center text-lg"},gs={key:0},ks={class:"grid md:grid-cols-3 print:grid-cols-3 gap-4 text-sm items-end"},As={class:"flex flex-col justify-center items-center"},ws={key:0,class:"print:hidden"},js={class:"text-center"},Cs={class:"text-xs text-center text-blue-600"},hs={class:"flex justify-center gap-4"},Bs={class:"font-bold"},Ls={key:0,class:"text-green-600"},Rs={class:"flex flex-col justify-center items-center"},Ds={key:0,class:"print:hidden"},Ns={class:"text-center"},Is={class:"text-xs text-center text-blue-600"},$s={class:"flex justify-center gap-4"},Ss={class:"font-bold"},Ws={key:0,class:"text-green-600"},Ts={class:"flex flex-col justify-center items-center"},Vs={key:0,class:"print:hidden"},Hs={class:"text-center"},Ms={class:"text-xs text-center text-blue-600"},Os={class:"flex justify-center gap-4"},Es={class:"font-bold"},Fs={key:0,class:"text-green-600"},Ps={class:"flex justify-evenly text-sm items-end"},Us={class:"flex flex-col justify-center items-center"},zs={key:0,class:"print:hidden"},qs={class:"text-center"},Gs={class:"text-xs text-center text-blue-600"},Js={class:"flex justify-center gap-4"},Ks={class:"font-bold"},Qs={key:0,class:"text-green-600"},Xs={class:"flex flex-col justify-center items-center"},Ys={key:0,class:"print:hidden"},Zs={class:"text-center"},el={class:"text-xs text-center text-blue-600"},tl={class:"flex justify-center gap-4"},sl={class:"font-bold"},ll={key:0,class:"text-green-600"},al={key:0,class:"modal-bg"},nl={class:"modal-card"},ol={class:"flex justify-end gap-2 mt-4"},vl={__name:"LeaveApplicationShow",setup(rl){const c=St(),o=Ut(),wt=Pt(),x=Ft(),f=b(!0),y=b(!1),m=b(""),s=Wt(()=>o.leaveApplication);Tt(async()=>{var t;const{id:n}=x.params;try{await o.fetchLeaveApplicationById(n),await o.fetchLeaveBalance((t=o==null?void 0:o.leaveApplication)==null?void 0:t.user_id)}catch(_){console.error("Failed to load leave application:",_)}finally{f.value=!1}});async function jt(){try{await o.rejectLeaveApplication(x.params.id,{rejection_reason:m.value}),alert("Leave application rejected successfully!"),y.value=!1,m.value="",await o.fetchLeaveApplicationById(x.params.id)}catch(n){alert(n.message)}}function v(){y.value=!0}async function Ct(n){try{await o.acceptHandover(n),alert("Handover accepted successfully!"),await o.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function ht(n){try{await o.acceptInCharge(n),alert("Leave Application Successfully Accepted!"),await o.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function Bt(n){try{await o.acceptCoordinator(n),alert("Coordinator accepted successfully!"),await o.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function Lt(n){try{await o.acceptOperationalAdmin(n),alert("Operational Admin accepted successfully!"),await o.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function Rt(n){try{await o.acceptRecommendBy(n),alert("Recommendation accepted successfully!"),await o.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}async function Dt(n){try{await o.acceptApprovedBy(n),alert("Leave Application approved successfully!"),await o.fetchLeaveApplicationById(n)}catch(t){alert(t.message)}}function Nt(){window.print()}const It=()=>wt.go(-1);return(n,t)=>{var _,g,k,A,w,j,C,h,B,L,R,D,N,I,$,S,W,T,V,H,M,O,E,F,P,U,z,q,G,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ie,de,ue,pe,ce,ve,ye,me,_e,xe,be,fe,ge,ke,Ae,we,je,Ce,he,Be,Le,Re,De,Ne,Ie,$e,Se,We,Te,Ve,He,Me,Oe,Ee,Fe,Pe,Ue,ze,qe,Ge,Je,Ke,Qe,Xe,Ye,Ze,et,tt,st,lt,at,nt,ot,rt,it,dt,ut,pt,ct,vt,yt,mt,_t,xt,bt,ft,gt;return r(),i(kt,null,[e("div",Gt,[e("div",{class:"flex items-center justify-between gap-2 print:hidden"},[e("button",{class:"btn-3",onClick:It},t[8]||(t[8]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:flex"},"Back",-1)])),t[10]||(t[10]=e("h1",{class:"title-md md:title-xl flex-wrap text-center"},"Leave Application",-1)),e("div",null,[e("button",{class:"btn-2",onClick:Nt},t[9]||(t[9]=[e("i",{class:"far fa-print"},null,-1),a(" Print ")]))])]),f.value?(r(),Vt(zt,{key:0})):(r(),i("div",Jt,[e("div",null,[e("h1",Kt,l((k=(g=(_=s.value)==null?void 0:_.user)==null?void 0:g.company)==null?void 0:k.name),1),e("p",Qt,l((w=(A=s.value)==null?void 0:A.user)==null?void 0:w.company.address),1)]),e("div",Xt,[e("div",Yt,[e("div",null,[t[11]||(t[11]=e("p",null,"To",-1)),t[12]||(t[12]=e("p",{class:"font-bold"},"Managing Director",-1)),e("p",Zt,l((h=(C=(j=s.value)==null?void 0:j.user)==null?void 0:C.company)==null?void 0:h.name),1),e("p",es,l((L=(B=s.value)==null?void 0:B.user)==null?void 0:L.company.address),1)])]),e("div",null,[e("p",ts,[t[13]||(t[13]=e("b",null,"Subject:",-1)),t[14]||(t[14]=a(" Application for ")),e("b",null,l((D=(R=s.value)==null?void 0:R.leave_type)==null?void 0:D.name),1)])]),e("div",null,[t[21]||(t[21]=e("h3",{class:"font-bold"},"Leave Details:",-1)),e("div",ss,[e("li",null,[t[15]||(t[15]=e("strong",null,"Start Date:",-1)),a(" "+l((N=s.value)==null?void 0:N.start_date),1)]),e("li",null,[t[16]||(t[16]=e("strong",null,"End Date:",-1)),a(" "+l((I=s.value)==null?void 0:I.end_date),1)]),e("li",null,[t[17]||(t[17]=e("strong",null,"Total Days:",-1)),a(" "+l(($=s.value)==null?void 0:$.total_days),1)]),e("li",null,[t[18]||(t[18]=e("strong",null,"Reason: ",-1)),a(l(((S=s.value)==null?void 0:S.reason)||"No reason provided"),1)]),e("li",null,[t[19]||(t[19]=e("strong",null,"Weekends:",-1)),a(" "+l((W=s.value)==null?void 0:W.user.weekends.join(", ")),1)]),e("li",null,[t[20]||(t[20]=e("strong",null,"Resumption Date:",-1)),a(" "+l((T=s.value)==null?void 0:T.resumption_date),1)])])]),e("div",ls,[e("p",null,[t[22]||(t[22]=e("strong",null,"Works in Hand: ",-1)),a(l(((V=s.value)==null?void 0:V.works_in_hand)||"No details provided"),1)])]),e("div",as,[e("div",null,[e("div",ns,[t[27]||(t[27]=e("hr",{class:"w-44 border-black hidden print:block"},null,-1)),e("p",null,[t[23]||(t[23]=e("strong",null,"Applicant:",-1)),a(" "+l((M=(H=s.value)==null?void 0:H.user)==null?void 0:M.name),1)]),e("p",null,[t[24]||(t[24]=e("strong",null,"Designation:",-1)),a(" "+l((F=(E=(O=s.value)==null?void 0:O.user)==null?void 0:E.designation)==null?void 0:F.title),1)]),e("p",null,[t[25]||(t[25]=e("strong",null,"Department:",-1)),a(" "+l((z=(U=(P=s.value)==null?void 0:P.user)==null?void 0:U.department)==null?void 0:z.name),1)]),e("p",null,[t[26]||(t[26]=e("strong",null,"Phone:",-1)),a(" "+l((G=(q=s.value)==null?void 0:q.user)==null?void 0:G.phone),1)])])]),e("div",os,[e("p",null,l(((K=(J=s.value)==null?void 0:J.handover_user)==null?void 0:K.name)||"Not assigned"),1),!((Q=s.value)!=null&&Q.status)&&s.value.handover_user_id===p(c).user.id?(r(),i("div",rs,[e("p",is,[a(l((Y=(X=s.value)==null?void 0:X.user)==null?void 0:Y.name)+" has assigned you for his handover. ",1),t[28]||(t[28]=e("br",null,null,-1)),t[29]||(t[29]=a(" Do you agree? "))]),e("div",ds,[e("button",{class:"font-bold text-lg text-green-600 px-2",onClick:t[0]||(t[0]=d=>Ct(s.value.id))}," ✔ "),t[30]||(t[30]=e("button",{class:"px-2"},"❌",-1))])])):u("",!0),t[33]||(t[33]=e("hr",{class:"w-44 border-black"},null,-1)),e("h4",us,[t[32]||(t[32]=a(" Handover ")),(Z=s.value)!=null&&Z.handover_user_id&&((ee=s.value)!=null&&ee.status)?(r(),i("span",ps," (✔) ")):u("",!0),(te=s.value)!=null&&te.handover_user_id&&!((se=s.value)!=null&&se.status)?(r(),i("span",cs,t[31]||(t[31]=[e("i",{class:"fad fa-spinner"},null,-1)]))):u("",!0)])])]),e("div",null,[t[35]||(t[35]=e("h1",{class:"font-bold"},"Leave Balance",-1)),e("div",vs,[e("table",ys,[t[34]||(t[34]=e("thead",null,[e("tr",{class:"bg-gray-200"},[e("th",{class:"border border-gray-500 px-4 py-0.5 text-left"},"Leave Type"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Total Days"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Used Days"),e("th",{class:"border border-gray-500 px-4 py-0.5 text-center"},"Remaining Days")])],-1)),e("tbody",null,[(r(!0),i(kt,null,Ht(p(o).leaveBalance,(d,$t)=>(r(),i("tr",{key:$t,class:"hover:bg-gray-100"},[e("td",ms,l(d.leave_type),1),e("td",_s,l(d.total_days),1),e("td",xs,l(d.used_days),1),e("td",{class:At(["border border-gray-500 px-4 py-0.5 text-center",{"text-green-600 font-bold":d.remaining_days>0,"text-red-600 font-bold":d.remaining_days===0}])},l(d.remaining_days),3)]))),128))])])])])]),e("div",bs,[e("p",fs,[t[36]||(t[36]=a(" Leave Approval: ")),e("b",{class:At({"text-yellow-600":((le=s.value)==null?void 0:le.status)==="Pending","text-green-600":((ae=s.value)==null?void 0:ae.status)==="Approved","text-red-600":((ne=s.value)==null?void 0:ne.status)==="Rejected"})},l(((oe=s.value)==null?void 0:oe.status)||"N/A"),3)]),((re=s.value)==null?void 0:re.status)==="Rejected"?(r(),i("div",gs,[e("p",null,[t[37]||(t[37]=e("b",null,"Rejected by: ",-1)),a(" "+l((de=(ie=s.value)==null?void 0:ie.rejected_by_user)==null?void 0:de.name),1)]),e("p",null,[t[38]||(t[38]=e("b",null,"rejection Reason: ",-1)),a(" "+l(s.value.rejection_reason),1)])])):u("",!0),e("div",ks,[e("div",As,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ue=s.value)!=null&&ue.in_charge_user_id)&&((ve=(ce=(pe=s.value)==null?void 0:pe.user)==null?void 0:ce.leave_approval)==null?void 0:ve.in_charge_user_id)===p(c).user.id?(r(),i("div",ws,[e("p",js,l(((xe=(_e=(me=(ye=s.value)==null?void 0:ye.user)==null?void 0:me.leave_approval)==null?void 0:_e.in_charge_user)==null?void 0:xe.name)||"N/A"),1),e("p",Cs,[a(l((fe=(be=s.value)==null?void 0:be.user)==null?void 0:fe.name)+" has submitted an application. ",1),t[39]||(t[39]=e("br",null,null,-1)),t[40]||(t[40]=a(" Will you forward it? "))]),e("div",hs,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[1]||(t[1]=d=>ht(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((ke=(ge=s.value)==null?void 0:ge.in_charge_user)==null?void 0:ke.name)||""),1),t[42]||(t[42]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Bs,[t[41]||(t[41]=a(" In-Charge ")),(Ae=s.value)!=null&&Ae.in_charge_user_id?(r(),i("span",Ls,"(✔)")):u("",!0)])]),e("div",Rs,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((we=s.value)!=null&&we.coordinator_user_id)&&((he=(Ce=(je=s.value)==null?void 0:je.user)==null?void 0:Ce.leave_approval)==null?void 0:he.coordinator_user_id)===p(c).user.id?(r(),i("div",Ds,[e("p",Ns,l(((De=(Re=(Le=(Be=s.value)==null?void 0:Be.user)==null?void 0:Le.leave_approval)==null?void 0:Re.coordinator_user)==null?void 0:De.name)||"N/A"),1),e("p",Is,[a(l((Ie=(Ne=s.value)==null?void 0:Ne.user)==null?void 0:Ie.name)+" has submitted an application. ",1),t[43]||(t[43]=e("br",null,null,-1)),t[44]||(t[44]=a(" Will you recommend it? "))]),e("div",$s,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[2]||(t[2]=d=>Bt(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((Se=($e=s.value)==null?void 0:$e.coordinator_user)==null?void 0:Se.name)||""),1),t[46]||(t[46]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Ss,[t[45]||(t[45]=a(" Coordinator ")),(We=s.value)!=null&&We.coordinator_user_id?(r(),i("span",Ws,"(✔)")):u("",!0)])]),e("div",Ts,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Te=s.value)!=null&&Te.operational_admin_user_id)&&((Me=(He=(Ve=s.value)==null?void 0:Ve.user)==null?void 0:He.leave_approval)==null?void 0:Me.operational_admin_user_id)===p(c).user.id?(r(),i("div",Vs,[e("p",Hs,l(((Pe=(Fe=(Ee=(Oe=s.value)==null?void 0:Oe.user)==null?void 0:Ee.leave_approval)==null?void 0:Fe.operational_admin_user)==null?void 0:Pe.name)||"N/A"),1),e("p",Ms,[a(l((ze=(Ue=s.value)==null?void 0:Ue.user)==null?void 0:ze.name)+" has submitted an application.",1),t[47]||(t[47]=e("br",null,null,-1)),t[48]||(t[48]=a(" Will you recommend it? "))]),e("div",Os,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[3]||(t[3]=d=>Lt(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((Ge=(qe=s.value)==null?void 0:qe.operational_admin_user)==null?void 0:Ge.name)||""),1),t[50]||(t[50]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Es,[t[49]||(t[49]=a(" Operational Admin ")),(Je=s.value)!=null&&Je.operational_admin_user_id?(r(),i("span",Fs,"(✔)")):u("",!0)])])]),e("div",Ps,[e("div",Us,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Ke=s.value)!=null&&Ke.recommend_by_user_id)&&((Ye=(Xe=(Qe=s.value)==null?void 0:Qe.user)==null?void 0:Xe.leave_approval)==null?void 0:Ye.recommend_by_user_id)===p(c).user.id?(r(),i("div",zs,[e("p",qs,l(((st=(tt=(et=(Ze=s.value)==null?void 0:Ze.user)==null?void 0:et.leave_approval)==null?void 0:tt.recommend_by_user)==null?void 0:st.name)||"N/A"),1),e("p",Gs,[a(l((at=(lt=s.value)==null?void 0:lt.user)==null?void 0:at.name)+" has submitted an application.",1),t[51]||(t[51]=e("br",null,null,-1)),t[52]||(t[52]=a(" Will you recommend it? "))]),e("div",Js,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[4]||(t[4]=d=>Rt(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((ot=(nt=s.value)==null?void 0:nt.recommend_by_user)==null?void 0:ot.name)||""),1),t[54]||(t[54]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",Ks,[t[53]||(t[53]=a(" Recommend By ")),(rt=s.value)!=null&&rt.recommend_by_user_id?(r(),i("span",Qs,"(✔)")):u("",!0)])]),e("div",Xs,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((it=s.value)!=null&&it.approved_by_user_id)&&((pt=(ut=(dt=s.value)==null?void 0:dt.user)==null?void 0:ut.leave_approval)==null?void 0:pt.approved_by_user_id)===p(c).user.id?(r(),i("div",Ys,[e("p",Zs,l(((mt=(yt=(vt=(ct=s.value)==null?void 0:ct.user)==null?void 0:vt.leave_approval)==null?void 0:yt.approved_by_user)==null?void 0:mt.name)||"N/A"),1),e("p",el,[a(l((xt=(_t=s.value)==null?void 0:_t.user)==null?void 0:xt.name)+" has submitted an application.",1),t[55]||(t[55]=e("br",null,null,-1)),t[56]||(t[56]=a(" Will you accept it? "))]),e("div",tl,[e("button",{class:"font-bold text-lg text-green-600",onClick:t[5]||(t[5]=d=>Dt(s.value.id))}," ✔ "),e("button",{class:"",onClick:v},"❌")])])):u("",!0),e("p",null,l(((ft=(bt=s.value)==null?void 0:bt.approved_by_user)==null?void 0:ft.name)||""),1),t[58]||(t[58]=e("hr",{class:"w-44 border-black"},null,-1)),e("p",sl,[t[57]||(t[57]=a(" Approved By ")),(gt=s.value)!=null&&gt.approved_by_user_id?(r(),i("span",ll,"(✔)")):u("",!0)])])])])])),Mt(qt)]),y.value?(r(),i("div",al,[e("div",nl,[t[59]||(t[59]=e("h3",{class:"title-lg"},"Reject Application",-1)),Ot(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=d=>m.value=d),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[Et,m.value]]),e("div",ol,[e("button",{class:"btn-3",onClick:t[7]||(t[7]=d=>y.value=!1)},"Cancel"),e("button",{class:"btn-2 bg-red-500 text-white",onClick:jt},"Confirm")])])])):u("",!0)],64)}}};export{vl as default};
