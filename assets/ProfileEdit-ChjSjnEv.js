import{E,d as O,s as T,j as G,u as R,r,e as I,A as $,k as q,c as g,o as f,a as l,m as U,f as z,l as V,w as H,h as M,g as n,v as d,C as J,F as S,x as K,t as Q,p as W,n as X}from"./index-Duuy0F5A.js";import{L as Y}from"./LoaderView-CROo3rHL.js";import{_ as Z}from"./PhotoModal-8od16ahg.js";import{_ as ee}from"./ChangePasswordModal-CNlapJ95.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"my-container space-y-2"},oe={class:"card-bg md:p-8 p-4 mx-4"},te={class:"grid gap-4"},se={class:"border p-4 rounded-md bg-gray-100"},ae={class:"flex justify-center w-full"},re=["src"],ne={class:"grid md:grid-cols-2 gap-4"},de={class:"space-y-2"},ue=["value"],ie={class:"flex justify-center gap-4"},ye={__name:"ProfileEdit",setup(pe){const o=E({name:"",phone:"",email:"",nid:"",date_of_birth:"",address:"",blood:""}),B=["A+","A-","B+","B-","AB+","AB-","O+","O-"],u=O(),{user:a}=T(u),m=G(),F=R(),A=r(!1),v=r(!1),c=r(!1),x=r(null),i=r(null),y=r(!1),w=r(!1);I(()=>{a.value&&h()}),$(a,s=>{s&&h()});const j=()=>{x.value=a.value.photo,c.value=!0},P=()=>{c.value=!1,i.value=null},D=()=>{v.value=!1},L=s=>{i.value=s},h=()=>{var s,e,b,p,t,k,C;o.name=((s=a.value)==null?void 0:s.name)||"",o.phone=((e=a.value)==null?void 0:e.phone)||"",o.email=((b=a.value)==null?void 0:b.email)||"",o.address=((p=a.value)==null?void 0:p.address)||"",o.nid=((t=a.value)==null?void 0:t.nid)||"",o.blood=((k=a.value)==null?void 0:k.blood)||"",o.date_of_birth=((C=a.value)==null?void 0:C.date_of_birth)||""},N=async()=>{try{await u.updateProfile(o),m.success("Profile updated successfully!"),F.push({name:"MyProfile"})}catch(s){console.error("Failed to update profile:",s),m.error(u.error||"Failed to save profile!");return}},_=async()=>{if(console.log(i.value),!i.value)return;const s=new FormData;s.append("photo",i.value),s.append("user_id",a.value.id),console.log({formData:s});try{y.value=!0,await u.uploadProfilePhoto(s),w.value=!0,setTimeout(()=>{P(),y.value=!1,w.value=!1},1500),m.success("Image updated successfully!")}catch(e){console.error("Failed to upload photo:",e),m.error(u.error||"Failed to save profile!")}finally{y.value=!1}};return(s,e)=>{var p;const b=q("RouterLink");return f(),g(S,null,[l("div",le,[l("div",oe,[e[21]||(e[21]=l("h2",{class:"title-lg text-center"},"Edit Profile",-1)),A.value?(f(),U(Y,{key:0,class:"bg-gray-100 border shadow-none"})):(f(),g("form",{key:1,onSubmit:H(N,["prevent"]),class:"space-y-4"},[l("div",te,[l("div",se,[l("div",ae,[l("div",{onClick:j,class:"relative bg-gray-200 w-40 h-40 rounded-full overflow-hidden mx-auto flex items-center justify-center"},[l("img",{class:"object-cover w-full h-full",src:((p=M(a))==null?void 0:p.photo)||"/default-avatar.png",alt:"Profile Photo"},null,8,re),e[8]||(e[8]=l("div",{class:"absolute inset-0 flex items-end justify-center bg-black/30 opacity-0 hover:opacity-100 transition-opacity"},[l("button",{type:"button",class:"btn-2 px-3 py-1 text-sm rounded-md mb-2"}," Change ")],-1))])]),e[17]||(e[17]=l("p",{class:"title-md"},"Personal Info",-1)),e[18]||(e[18]=l("hr",{class:"my-2"},null,-1)),l("div",ne,[l("div",null,[e[9]||(e[9]=l("label",null,"Name",-1)),n(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>o.name=t),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[d,o.name]])]),l("div",null,[e[10]||(e[10]=l("label",null,"Phone",-1)),n(l("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>o.phone=t),type:"text",class:"w-full p-2 border rounded",required:""},null,512),[[d,o.phone]])]),l("div",null,[e[11]||(e[11]=l("label",null,"Email",-1)),n(l("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>o.email=t),type:"email",class:"w-full p-2 border rounded"},null,512),[[d,o.email]])]),l("div",de,[e[13]||(e[13]=l("label",{for:"bloodGroup",class:"text-gray-700 flex items-center gap-2"}," Blood Group ",-1)),n(l("select",{id:"bloodGroup","onUpdate:modelValue":e[3]||(e[3]=t=>o.blood=t),class:"py-2 px-4 border rounded w-full"},[e[12]||(e[12]=l("option",{disabled:"",value:""},"Select blood group",-1)),(f(),g(S,null,K(B,t=>l("option",{key:t,value:t},Q(t),9,ue)),64))],512),[[J,o.blood]])]),l("div",null,[e[14]||(e[14]=l("label",null,"NID",-1)),n(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>o.nid=t),type:"text",class:"w-full p-2 border rounded"},null,512),[[d,o.nid]])]),l("div",null,[e[15]||(e[15]=l("label",null,"Date of Birth",-1)),n(l("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>o.date_of_birth=t),type:"date",class:"w-full p-2 border rounded"},null,512),[[d,o.date_of_birth]])]),l("div",null,[e[16]||(e[16]=l("label",null,"Address",-1)),n(l("textarea",{"onUpdate:modelValue":e[6]||(e[6]=t=>o.address=t),rows:"2",class:"w-full p-2 border rounded"},null,512),[[d,o.address]])])])])]),l("div",ie,[V(b,{to:{name:"MyProfile"},type:"button",class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},{default:W(()=>e[19]||(e[19]=[X(" Cancel ")])),_:1,__:[19]}),e[20]||(e[20]=l("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"}," Save ",-1)),l("button",{type:"button",onClick:e[7]||(e[7]=t=>v.value=!v.value),class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"}," Change Password ")])],32))])]),v.value?(f(),U(ee,{key:0,onClose:D,user:M(a)},null,8,["user"])):z("",!0),V(Z,{imageSrc:x.value,isOpen:c.value,onClose:P,onFileSelected:L,onUploadPhoto:_},null,8,["imageSrc","isOpen"])],64)}}};export{ye as default};
