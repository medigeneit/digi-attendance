import{L as B}from"./LoaderView-BXKCzav_.js";import{d as j,b as U,p as g,r as F,e as z,q as N,c as l,o,a as t,y as v,f as V,g as S,i as h,t as u,k as p,h as P,v as I,u as O,C as H,j as M,F as G,x as Y}from"./index-BbhQvqb4.js";import{g as J}from"./task-rZbAR42D.js";import{u as K}from"./company-BM1HidGp.js";import{_ as E}from"./CompanyDepartmentSelectInput-iVksjwQ0.js";import{_ as Q}from"./EmployeeDropdownInput-DbNy_Uyu.js";import{S as W}from"./SelectDropdown-OZFzqdoH.js";import{_ as D}from"./UserChip-YEbxia5G.js";import{u as X}from"./useRequirementStore-DToUPgYo.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./url-CePbr-gY.js";import"./requirement-B1fTINL6.js";const Z={class:"mb-3 task-header"},q={class:"flex flex-wrap items-center justify-center gap-2 mt-3"},ee={class:"flex flex-wrap gap-x-4 gap-y-3 justify-between"},te={class:"relative"},se=["title"],oe={key:0},ae={key:1,class:"text-gray-500 whitespace-nowrap"},le={key:1,class:"relative w-full md:w-56 lg:flex-grow"},ne={class:"text-gray-600 w-full md:w-32 relative"},ie={__name:"RequirementHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup($,{emit:m}){const f=$,L=j(),w=U(),_=g(x("company-id")),c=g(x("from-department-id")),s=g(x("to-department-id")),b=g(x("created-by")),R=g(x("month")),e=m,d=K(),A=F([]);function x(r){return{get:()=>f.modelValue[r]||"",set:a=>{e("update:modelValue",{...f.modelValue,[r]:a||void 0})}}}async function k(){var r,a,i;if(!f.isMyTask){const y=(r=f.modelValue)==null?void 0:r["company-id"],C=s.value,n={...y?{company_id:y}:{},...C?{department_ids:[C]}:{}};A.value=((i=(a=await J({params:n}))==null?void 0:a.data)==null?void 0:i.employees)||[]}}z(async()=>{await d.fetchCompanies({with:"departments",ignore_permission:!0}),await d.fetchMyCompanies({with:"departments"}),await k()}),N(()=>s.value,k),N(()=>_.value,()=>{c.value="",s.value="",b.value="",k()});const T=g(()=>_.value?d==null?void 0:d.companies.filter(r=>r.id==_.value):d==null?void 0:d.companies);return(r,a)=>{var i,y,C;return o(),l("div",null,[t("div",Z,[t("div",q,[t("div",ee,[t("div",te,[v(W,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=n=>_.value=n),options:((i=p(d))==null?void 0:i.companies)||[],label:"name",id:"id",class:"border-2 border-gray-300 rounded h-[40px] w-full md:w-48 bg-white text-sm",clearable:""},{"selected-option":h(({option:n})=>[t("div",{class:"line-clamp-1 text-sm text-gray-900",title:n==null?void 0:n.name},[n!=null&&n.name?(o(),l("span",oe,u(n==null?void 0:n.name),1)):(o(),l("span",ae,"--ALL COMPANY--"))],8,se)]),_:1},8,["modelValue","options"]),a[5]||(a[5]=t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Company ",-1))]),v(E,{modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=n=>c.value=n),companies:T.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300"},defaultOption:"--ALL DEPARTMENT--"},{label:h(()=>a[6]||(a[6]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),p(w).name!=="MyTaskList"?(o(),V(E,{key:0,modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=n=>s.value=n),companies:T.value||[],class:"relative w-full md:w-48 flex-grow",className:{select:"h-10 text-sm border-2 border-gray-300  "},defaultOption:"--ALL DEPARTMENT--"},{label:h(()=>a[7]||(a[7]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):S("",!0),p(L).isAdminMood&&((C=(y=p(L))==null?void 0:y.user)==null?void 0:C.role)!=="employee"?(o(),l("div",le,[v(Q,{employees:A.value,modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=n=>b.value=n),class:"border-2 border-gray-300 rounded h-[40px] w-full bg-white !text-sm"},null,8,["employees","modelValue"]),a[8]||(a[8]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Created By ",-1))])):S("",!0),t("div",ne,[a[9]||(a[9]=t("label",{class:"absolute text-xs left-2.5 -top-1.5 bg-slate-100 text-blue-500"},"Month",-1)),P(t("input",{id:"month-filter","onUpdate:modelValue":a[4]||(a[4]=n=>R.value=n),type:"month",class:"h-10 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full",placeholder:"All month"},null,512),[[I,R.value]])])])])])])}}},de={class:"container mx-auto p-6"},re={class:"bg-white shadow-md rounded-lg p-6"},me={key:1,class:"text-center py-4 text-red-500"},ue={key:2,class:"overflow-x-auto"},pe={class:"min-w-full bg-white border overflow-hidden table table-fixed"},ce={key:0},xe={class:"px-4 py-4 font-semibold text-xl text-gray-700 border border-gray-200 text-center"},ye={class:"px-4 py-4 max-w-[60px] md:max-w-[300px] border border-gray-200"},fe={class:"flex flex-col lg:flex-row items-start lg:items-center gap-2 text-sm mb-3"},_e={class:"text-blue-500/60 group-hover/item:text-blue-500 font-semibold flex-shrink-0 border bg-blue-50 rounded-full px-2 text-xs"},be={class:"text-sky-500/60 group-hover/item:text-sky-500 font-semibold flex-shrink-0 border bg-blue-50 rounded-full px-2 text-xs"},ge={class:"space-y-4"},ve={key:0,class:"text-blue-800"},he=["title"],we={key:1,class:"text-gray-400 text-sm italic"},ke={key:0},Ve={key:1,class:""},Re={class:"px-4 py-4 whitespace-nowrap border border-gray-200"},Ae={class:"flex items-center gap-2"},Te={class:"flex items-center gap-2 mt-2"},Ce={key:1},Le={key:0},De={key:1,class:"italic text-xs text-gray-400"},Me={class:"flex items-center gap-2 mt-2"},Ne={key:1},Se={key:0},$e={key:1,class:"italic text-xs text-gray-400"},Ee={class:"flex items-center gap-2 mt-2"},Ue={key:1},ze={key:0},Be={key:1,class:"italic text-xs text-gray-400"},je={class:"px-4 py-4 text-center whitespace-nowrap border border-gray-200"},Fe={key:0,class:"text-gray-600"},Pe={key:1},Ie={class:"px-4 py-4 text-center border border-gray-200"},Oe={class:"flex gap-4 items-center justify-center"},st={__name:"RequirementList",setup($){const m=X(),f=O(),L=U(),w=g({get(){return{...L.query}},set(c){f.push({query:{...c}})}});z(()=>{console.log("Requirement List Mounted"),m.fetchRequirements(w.value)}),N(()=>({...w.value}),async function(c){m.fetchRequirements(c)});const _=()=>{f.push({name:"RequirementAdd"})};return(c,s)=>{var R;const b=H("RouterLink");return o(),l("div",de,[t("div",re,[t("div",{class:"flex justify-between items-center mb-6"},[s[3]||(s[3]=t("h2",{class:"text-2xl font-bold text-gray-800"},"Requirements",-1)),t("button",{onClick:_,class:"btn-1"},"Add Requirement")]),v(ie,{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=e=>w.value=e)},null,8,["modelValue"]),p(m).loading?(o(),V(B,{key:0,class:"min-h-64 shadow-none"},{default:h(()=>s[4]||(s[4]=[M("Loading requirements...")])),_:1,__:[4]})):p(m).error?(o(),l("div",me,u(p(m).error),1)):(o(),l("div",ue,[t("table",pe,[s[14]||(s[14]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-2 text-center whitespace-nowrap w-2 border"},"#"),t("th",{class:"px-4 py-2 text-left whitespace-nowrap border"},"Requirement"),t("th",{class:"px-4 py-2 text-center whitespace-nowrap w-16 border"},"User"),t("th",{class:"px-4 py-2 text-center whitespace-nowrap w-16 border"},"Submitted At"),t("th",{class:"px-4 py-2 text-center whitespace-nowrap w-20 border"},"Actions")])],-1)),t("tbody",null,[((R=p(m).requirements)==null?void 0:R.length)===0?(o(),l("tr",ce,s[5]||(s[5]=[t("td",{colspan:"10",class:"p-4"},[t("div",{class:"text-gray-500 italic w-full h-64 flex items-center justify-center"}," No Requirement Found ")],-1)]))):(o(!0),l(G,{key:1},Y(p(m).requirements,(e,d)=>{var A,x,k,T,r,a;return o(),l("tr",{key:e.id,class:"border-t hover:bg-blue-50 odd:bg-gray-50 group/item"},[t("td",xe,u(d+1),1),t("td",ye,[t("div",fe,[s[6]||(s[6]=t("span",{class:"text-gray-400"},"From ",-1)),t("span",_e,u((A=e==null?void 0:e.from_department)==null?void 0:A.name),1),s[7]||(s[7]=t("span",{class:"text-gray-400"},"To ",-1)),t("span",be,u((x=e==null?void 0:e.to_department)==null?void 0:x.name),1)]),t("div",ge,[((k=e==null?void 0:e.details)==null?void 0:k.length)>0&&Array.isArray(e==null?void 0:e.details)?(o(),l("div",ve,[t("div",{class:"line-clamp-1 font-semibold",title:e==null?void 0:e.details[0].title},u(e==null?void 0:e.details[0].title),9,he)])):(o(),l("div",we,"No Requirement added")),v(b,{to:{name:"RequirementShow",params:{id:e==null?void 0:e.id}},class:"text-blue-600 text-sm hover:underline hover:text-blue-800"},{default:h(()=>{var i,y;return[((i=e==null?void 0:e.details)==null?void 0:i.length)-1>0?(o(),l("span",ke,u(((y=e==null?void 0:e.details)==null?void 0:y.length)-1)+" More Requirement ",1)):(o(),l("span",Ve,"Show Form"))]}),_:2},1032,["to"])])]),t("td",Re,[t("div",Ae,[s[8]||(s[8]=t("span",{class:"text-xs text-gray-500"},"Created:",-1)),e.created_by?(o(),V(D,{key:0,user:e.created_by,"avatar-size":"xsmall"},null,8,["user"])):S("",!0)]),t("div",Te,[s[9]||(s[9]=t("div",{class:"text-xs text-gray-500"},"From Coordinator:",-1)),e.from_coordinator?(o(),V(D,{key:0,user:e.from_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",Ce,[(T=e==null?void 0:e.from_department)!=null&&T.coordinator_id?(o(),l("span",Le,"-")):(o(),l("span",De,"N/A"))]))]),t("div",Me,[s[10]||(s[10]=t("div",{class:"text-xs text-gray-500"},"To Coordinator:",-1)),e.to_coordinator?(o(),V(D,{key:0,user:e.to_coordinator,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",Ne,[(r=e==null?void 0:e.to_department)!=null&&r.coordinator_id?(o(),l("span",Se,"-")):(o(),l("span",$e,"N/A"))]))]),t("div",Ee,[s[11]||(s[11]=t("div",{class:"text-xs text-gray-500"},"To In Charge:",-1)),e.to_incharge?(o(),V(D,{key:0,user:e.to_incharge,"avatar-size":"xsmall"},null,8,["user"])):(o(),l("div",Ue,[(a=e==null?void 0:e.to_department)!=null&&a.incharge_id?(o(),l("span",ze,"-")):(o(),l("span",Be,"N/A"))]))])]),t("td",je,[e.submission_date?(o(),l("div",Fe,[t("div",null,u(new Date(e.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),1),t("div",null,u(new Date(e.submission_date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})),1)])):(o(),l("div",Pe,"-"))]),t("td",Ie,[t("div",Oe,[v(b,{to:{name:"RequirementShow",params:{id:e==null?void 0:e.id}},class:"btn-2",onClick:s[1]||(s[1]=i=>i.stopPropagation())},{default:h(()=>s[12]||(s[12]=[t("i",{class:"fad fa-eye"},null,-1),M(" Show ")])),_:2,__:[12]},1032,["to"]),v(b,{to:{name:"RequirementEdit",params:{id:e==null?void 0:e.id}},class:"btn-4 border border-blue-500 hover:bg-blue-500 hover:text-white",onClick:s[2]||(s[2]=i=>i.stopPropagation())},{default:h(()=>s[13]||(s[13]=[t("i",{class:"fad fa-edit"},null,-1),M(" Edit ")])),_:2,__:[13]},1032,["to"])])])])}),128))])])]))])])}}};export{st as default};
