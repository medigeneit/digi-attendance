import{u as ft,i as xt,r as b,p as ht,b as kt,c as o,a as t,k as a,j as wt,t as l,h as f,e as u,y as At,l as jt,d as Ct,v as Dt,F as Nt,f as Rt,o as n,g as Et}from"./index-Bi70UsqH.js";import{L as Ft}from"./LoaderView-Bg1dVyCM.js";import{_ as Bt}from"./ShareComponent-CrR44Ig4.js";import{u as St}from"./exchange-CfIFS0xt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $t={class:"my-container max-w-3xl space-y-6"},Vt={key:1,class:"card-bg p-4 md:p-8"},Lt={class:"flex justify-end"},Mt={class:"font-medium"},Ut={class:"gap-y-1"},Wt={class:"gap-y-1"},qt={class:"grid md:grid-cols-2 pt-3"},Ht={class:"col-span-2 pt-2"},Ot={class:"grid print:grid-cols-2 md:grid-cols-2 gap-4 pt-10"},Tt={key:0,class:"print:hidden"},It={class:"text-xs"},Pt={class:"flex gap-2"},zt={class:"font-bold"},Gt={key:0,class:"text-green-600 print:text-black"},Jt={key:1,class:"pl-2 text-yellow-700"},Kt={class:"title-md"},Qt={key:0},Xt={class:"grid grid-cols-2 print:grid-cols-3 md:grid-cols-3 gap-4"},Yt={class:"pt-10"},Zt={key:0},es={key:1},ts={key:2,class:"print:hidden"},ss={class:""},ls={class:"text-xs text-blue-600"},as={class:"flex gap-4"},ns={class:"font-bold"},os={key:0,class:"text-green-600"},rs={key:1,class:"pl-2 text-yellow-700"},us={class:"pt-10"},is={key:0},ds={key:1},ps={key:2,class:"print:hidden"},vs={class:""},cs={class:"text-xs text-blue-600"},_s={class:"flex gap-4"},ms={class:"font-bold"},gs={key:0,class:"text-green-600"},ys={key:1,class:"pl-2 text-yellow-700"},bs={class:"pt-10"},fs={key:0},xs={key:1},hs={key:2,class:"print:hidden"},ks={class:"text-xs text-blue-600"},ws={class:"flex gap-4"},As={class:"font-bold"},js={key:0,class:"text-green-600"},Cs={key:1,class:"pl-2 text-yellow-700"},Ds={class:"print:hidden"},Ns={key:0,class:"mb-2"},Rs=["href"],Es={key:0,class:"modal-bg"},Fs={class:"modal-card"},Bs={class:"flex justify-end gap-2 mt-4"},Ws={__name:"ExchangeOffdayShow",setup(Ss){const vt=Et(),v=Rt(),i=St(),_=ft(),h=xt(),k=b(!0),m=b(!1),g=b(""),w=b(null),s=ht(()=>i.exchange);kt(async()=>{const{id:r}=v.params;try{await i.fetchExchange(r)}catch(e){console.error("Failed to fetch exchange details:",e)}finally{k.value=!1}});const ct=async()=>{try{await i.rejectExchange(v.params.id,g.value),m.value=!1,g.value="",await i.fetchExchange(v.params.id)}catch(r){console.error("Failed to reject exchange request:",r),alert("Failed to reject exchange request.")}},x=()=>{m.value=!0},y=async r=>{try{const{id:e}=v.params;r==="handover"&&await i.handoverAccept(e),r==="inCharge"&&await i.inChargeAccept(e),r==="recommend"&&await i.recommendByAccept(e),r==="approve"&&await i.approvedByAccept(e),alert(`${r} accepted successfully!`),await i.fetchExchange(e)}catch(e){console.error(`Failed to accept ${r}:`,e),alert(`Failed to accept ${r}.`)}},_t=async r=>{const e=r.target.files[0];if(e){const c=new FormData;c.append("file",e);const d=await i.fetchFileUpload(c);w.value=d==null?void 0:d.url,d!=null&&d.url?(mt(),h.success("File uploaded successfully")):h.error("Failed to upload file")}},mt=async()=>{try{const r={attachment:w.value};await i.uploadAttachmentExchange(v.params.id,r)}catch(r){console.error("Failed to reject short leave:",r),alert("Failed to reject short leave.")}};function gt(){window.print()}const yt=()=>vt.go(-1),bt=r=>new Date(r).toISOString().slice(0,10),A=r=>new Date(r).toLocaleDateString("en-US",{weekday:"long"});return(r,e)=>{var c,d,j,C,D,N,R,E,F,B,S,$,V,L,M,U,W,q,H,O,T,I,P,z,G,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ue,ie,de,pe,ve,ce,_e,me,ge,ye,be,fe,xe,he,ke,we,Ae,je,Ce,De,Ne,Re,Ee,Fe,Be,Se,$e,Ve,Le,Me,Ue,We,qe,He,Oe,Te,Ie,Pe,ze,Ge,Je,Ke,Qe,Xe,Ye,Ze,et,tt,st,lt,at,nt,ot,rt,ut,it,dt,pt;return n(),o(Nt,null,[t("div",$t,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:yt},e[6]||(e[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[8]||(e[8]=t("h1",{class:"title-lg text-center"},"Exchange Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:gt},e[7]||(e[7]=[t("i",{class:"far fa-print"},null,-1),a(" Print ")]))])]),k.value?(n(),wt(Ft,{key:0})):(n(),o("div",Vt,[e[42]||(e[42]=t("div",null,[t("h1",{class:"title-lg text-center"},"Offday Exchange Application")],-1)),t("div",Lt,[t("div",null,"Date: "+l(bt((c=s.value)==null?void 0:c.created_at)),1)]),t("div",null,[t("p",Mt,[e[9]||(e[9]=a(" Name: ")),t("b",null,l((j=(d=s.value)==null?void 0:d.user)==null?void 0:j.name),1)]),t("div",Ut,[t("p",null,[e[10]||(e[10]=a(" Designation: ")),t("b",null,l((N=(D=(C=s.value)==null?void 0:C.user)==null?void 0:D.designation)==null?void 0:N.title),1)])]),t("div",Wt,[t("p",null,[e[11]||(e[11]=a(" Department: ")),t("b",null,l((F=(E=(R=s.value)==null?void 0:R.user)==null?void 0:E.company)==null?void 0:F.name),1)])])]),t("div",qt,[t("div",null,[e[12]||(e[12]=t("b",null,"Holiday Day:",-1)),a(" "+l(A((B=s.value)==null?void 0:B.current_date)),1)]),t("div",null,[e[13]||(e[13]=t("b",null,"Date:",-1)),a(" "+l((S=s.value)==null?void 0:S.current_date),1)]),t("div",null,[e[14]||(e[14]=t("b",null,"Exchange Day:",-1)),a(" "+l(A(($=s.value)==null?void 0:$.exchange_date)),1)]),t("div",null,[e[15]||(e[15]=t("b",null,"Date:",-1)),a(" "+l((V=s.value)==null?void 0:V.exchange_date),1)]),t("div",Ht,[e[16]||(e[16]=t("b",null,"Reason:",-1)),a(" "+l(((L=s.value)==null?void 0:L.reason)||"N/A"),1)])]),t("div",Ot,[t("div",null,[t("div",null,[e[17]||(e[17]=t("b",null,"Works in Hand:",-1)),a(" "+l(((M=s.value)==null?void 0:M.works_in_hand)||"N/A"),1)])]),t("div",null,[t("p",null,l(((W=(U=s.value)==null?void 0:U.handover_user)==null?void 0:W.name)||"Not assigned"),1),!((q=s.value)!=null&&q.status)&&s.value.handover_user_id===f(_).user.id?(n(),o("div",Tt,[t("p",It,[a(l((O=(H=s.value)==null?void 0:H.user)==null?void 0:O.name)+" has assigned you for his handover.",1),e[18]||(e[18]=t("br",null,null,-1)),e[19]||(e[19]=a(" Do you agree? "))]),t("div",Pt,[t("button",{class:"font-bold text-lg text-green-600 px-2",onClick:e[0]||(e[0]=p=>y("handover"))}," ✔ "),e[20]||(e[20]=t("button",{class:"px-2"},"❌",-1))])])):u("",!0),e[23]||(e[23]=t("hr",{class:"w-44 border-black"},null,-1)),t("h4",zt,[e[22]||(e[22]=a(" Handover ")),(T=s.value)!=null&&T.handover_user_id&&((I=s.value)!=null&&I.status)?(n(),o("span",Gt," (✔) ")):u("",!0),(P=s.value)!=null&&P.handover_user_id&&!((z=s.value)!=null&&z.status)?(n(),o("span",Jt,e[21]||(e[21]=[t("i",{class:"fad fa-spinner"},null,-1)]))):u("",!0)])])]),e[43]||(e[43]=t("hr",null,null,-1)),t("div",null,[t("h3",Kt,[e[24]||(e[24]=a(" Approvals ")),t("span",{class:At({"text-yellow-500":((G=s.value)==null?void 0:G.status)==="Pending","text-green-500":((J=s.value)==null?void 0:J.status)==="Approved","text-red-500":((K=s.value)==null?void 0:K.status)==="Rejected"})}," ("+l(((Q=s.value)==null?void 0:Q.status)||"N/A")+") ",3)]),((X=s.value)==null?void 0:X.status)==="Rejected"?(n(),o("div",Qt,[t("div",null,[e[25]||(e[25]=t("b",null,"Rejected By:",-1)),a(" "+l(((Z=(Y=s.value)==null?void 0:Y.rejected_by_user)==null?void 0:Z.name)||"N/A"),1)]),t("div",null,[e[26]||(e[26]=t("b",null,"Rejection Reason:",-1)),a(" "+l(((ee=s.value)==null?void 0:ee.rejection_reason)||"N/A"),1)])])):u("",!0)]),t("div",Xt,[t("div",Yt,[(te=s.value)!=null&&te.in_charge_user?(n(),o("p",Zt,l(((le=(se=s.value)==null?void 0:se.in_charge_user)==null?void 0:le.name)||""),1)):(n(),o("p",es,l(((re=(oe=(ne=(ae=s.value)==null?void 0:ae.user)==null?void 0:ne.other_approval)==null?void 0:oe.in_charge_user)==null?void 0:re.name)||"N/A"),1)),s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ue=s.value)!=null&&ue.in_charge_user_id)&&((pe=(de=(ie=s.value)==null?void 0:ie.user)==null?void 0:de.other_approval)==null?void 0:pe.in_charge_user_id)===f(_).user.id?(n(),o("div",ts,[t("p",ss,l(((me=(_e=(ce=(ve=s.value)==null?void 0:ve.user)==null?void 0:ce.other_approval)==null?void 0:_e.in_charge_user)==null?void 0:me.name)||"N/A"),1),t("p",ls,[a(l((ye=(ge=s.value)==null?void 0:ge.user)==null?void 0:ye.name)+" has submitted an application. ",1),e[27]||(e[27]=t("br",null,null,-1)),e[28]||(e[28]=a(" Will you forward it? "))]),t("div",as,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=p=>y("inCharge"))}," ✔ "),t("button",{class:"",onClick:x},"❌")])])):u("",!0),e[31]||(e[31]=t("hr",{class:"w-28 md:w-44 border-black mt-2"},null,-1)),t("p",ns,[e[30]||(e[30]=a(" In-Charge ")),(be=s.value)!=null&&be.in_charge_user_id?(n(),o("span",os,"(✔)")):u("",!0),!((fe=s.value)!=null&&fe.in_charge_user_id)&&((ke=(he=(xe=s.value)==null?void 0:xe.user)==null?void 0:he.other_approval)!=null&&ke.in_charge_user)?(n(),o("span",rs,e[29]||(e[29]=[t("i",{class:"fad fa-spinner"},null,-1)]))):u("",!0)])]),t("div",us,[(we=s.value)!=null&&we.recommend_by_user?(n(),o("p",is,l(((je=(Ae=s.value)==null?void 0:Ae.recommend_by_user)==null?void 0:je.name)||""),1)):(n(),o("p",ds,l(((Re=(Ne=(De=(Ce=s.value)==null?void 0:Ce.user)==null?void 0:De.other_approval)==null?void 0:Ne.recommend_by_user)==null?void 0:Re.name)||"N/A"),1)),s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Ee=s.value)!=null&&Ee.recommend_by_user_id)&&((Se=(Be=(Fe=s.value)==null?void 0:Fe.user)==null?void 0:Be.other_approval)==null?void 0:Se.recommend_by_user_id)===f(_).user.id?(n(),o("div",ps,[t("p",vs,l(((Me=(Le=(Ve=($e=s.value)==null?void 0:$e.user)==null?void 0:Ve.other_approval)==null?void 0:Le.recommend_by_user)==null?void 0:Me.name)||"N/A"),1),t("p",cs,[a(l((We=(Ue=s.value)==null?void 0:Ue.user)==null?void 0:We.name)+" has submitted an application.",1),e[32]||(e[32]=t("br",null,null,-1)),e[33]||(e[33]=a(" Will you recommend it? "))]),t("div",_s,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=p=>y("recommend"))}," ✔ "),t("button",{class:"",onClick:x},"❌")])])):u("",!0),e[36]||(e[36]=t("hr",{class:"w-28 md:w-44 border-black mt-2"},null,-1)),t("p",ms,[e[35]||(e[35]=a(" Recommend By ")),(qe=s.value)!=null&&qe.recommend_by_user_id?(n(),o("span",gs,"(✔)")):u("",!0),!((He=s.value)!=null&&He.recommend_by_user_id)&&((Ie=(Te=(Oe=s.value)==null?void 0:Oe.user)==null?void 0:Te.other_approval)!=null&&Ie.recommend_by_user)?(n(),o("span",ys,e[34]||(e[34]=[t("i",{class:"fad fa-spinner"},null,-1)]))):u("",!0)])]),t("div",bs,[(Pe=s.value)!=null&&Pe.approved_by_user?(n(),o("p",fs,l(((Ge=(ze=s.value)==null?void 0:ze.approved_by_user)==null?void 0:Ge.name)||""),1)):(n(),o("p",xs,l(((Xe=(Qe=(Ke=(Je=s.value)==null?void 0:Je.user)==null?void 0:Ke.other_approval)==null?void 0:Qe.approved_by_user)==null?void 0:Xe.name)||"N/A"),1)),s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Ye=s.value)!=null&&Ye.approved_by_user_id)&&((tt=(et=(Ze=s.value)==null?void 0:Ze.user)==null?void 0:et.other_approval)==null?void 0:tt.approved_by_user_id)===f(_).user.id?(n(),o("div",hs,[t("p",ks,[a(l((lt=(st=s.value)==null?void 0:st.user)==null?void 0:lt.name)+" has submitted an application.",1),e[37]||(e[37]=t("br",null,null,-1)),e[38]||(e[38]=a(" Will you accept it? "))]),t("div",ws,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[3]||(e[3]=p=>y("approve"))}," ✔ "),t("button",{class:"",onClick:x},"❌")])])):u("",!0),e[41]||(e[41]=t("hr",{class:"w-44 border-black mt-2"},null,-1)),t("p",As,[e[40]||(e[40]=a(" Approved By ")),(at=s.value)!=null&&at.approved_by_user_id?(n(),o("span",js,"(✔)")):u("",!0),!((nt=s.value)!=null&&nt.approved_by_user_id)&&((ut=(rt=(ot=s.value)==null?void 0:ot.user)==null?void 0:rt.other_approval)!=null&&ut.approved_by_user)?(n(),o("span",Cs,e[39]||(e[39]=[t("i",{class:"fad fa-spinner"},null,-1)]))):u("",!0)])])])])),t("div",Ds,[t("div",null,[e[44]||(e[44]=t("label",null,"Attachment",-1)),(it=s.value)!=null&&it.attachment&&typeof((dt=s.value)==null?void 0:dt.attachment)=="string"?(n(),o("div",Ns,[t("a",{href:(pt=s.value)==null?void 0:pt.attachment,target:"_blank",class:"text-blue-500 underline"}," View Current File ",8,Rs)])):u("",!0),t("input",{type:"file",onChange:_t,class:"w-full p-2 border rounded"},null,32),e[45]||(e[45]=t("p",{class:"text-sm text-gray-600 mt-1"},"Selected File",-1))])]),jt(Bt)]),m.value?(n(),o("div",Es,[t("div",Fs,[e[46]||(e[46]=t("h3",{class:"title-lg"},"Reject Exchange Request",-1)),Ct(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=p=>g.value=p),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[Dt,g.value]]),t("div",Bs,[t("button",{class:"btn-3",onClick:e[5]||(e[5]=p=>m.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:ct},"Confirm")])])])):u("",!0)],64)}}};export{Ws as default};
