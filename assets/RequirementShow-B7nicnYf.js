import{r as _,e as P,c as a,o as r,a as e,f as j,g as v,w as R,F as E,h as U,j as N,p as I,v as L,i as T,B as he,t as w,k as B,d as $e,m as F,n as Ce,y as te,x as V,N as Re,K as le,J as Se,O as Ae,b as Ne,u as je,z as Z}from"./index-D_5uLc0m.js";import{L as ne}from"./LoaderView-Vwi1TR_Y.js";import{O as ee}from"./OverlyModal-BivJUPJf.js";import{_ as Ee}from"./ShareComponent-C9a7NTfu.js";import{_ as ie}from"./DescriptionView-Bj3-M-t0.js";import{R as Ie}from"./RequiredIcon-CnH5FTMr.js";import{f as ae,s as Ue}from"./requirement-CTOxWsnK.js";import{a as Le,f as oe,d as Ve,u as Fe,b as Oe,_ as Pe}from"./TaskAddForm-DtdIXKAp.js";import{u as Be}from"./department-DGJw0TnN.js";import{S as Te}from"./SelectDropdown-C_1hYAY2.js";import{_ as se}from"./UserChip-DhTjmJnp.js";import{u as De}from"./user-CCxpx14a.js";import{_ as Me}from"./TaskUserChip-Ce7vf9-U.js";import{u as ze}from"./useTaskStore-CZrHIqK1.js";import{_ as Ge}from"./TaskSelectionInput-BXKxd6Zt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./company-a54urnhi.js";import"./url-CePbr-gY.js";import"./CompanyDepartmentSelectInput-BS762kFO.js";import"./SectionLoading-D8UKrJK-.js";import"./TextWithHr-CbvW5L7E.js";import"./TaskUrgencyInput-CI_T0KZv.js";import"./TaskTitle-B2e5I6Pn.js";const He={class:"sticky top-0 pt-4 bg-white z-10"},We={class:"mb-4"},Ke={class:"block text-gray-600 text-sm mb-1 font-medium"},Qe={class:"mb-4"},Je={class:"mb-4"},Ye={class:"mb-4"},Xe={class:"mb-4"},Ze={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},et={key:0,class:"mb-4 text-red-500 font-medium"},tt={key:1,class:"mb-4"},st={class:"flex items-center justify-between gap-4"},nt=["disabled"],rt={__name:"RequirementDetailAddForm",props:{requirementId:{type:[Number,String],required:!0}},emits:["create","closeClick","error"],setup(f,{emit:D}){const o=f,y=D,u=Be(),g=_(),d=_(""),m=_(),p=_({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),c=_([]);async function i(){var t,n;d.value="submitting";const s={...p.value};console.log({payload:s});try{const q=await Le(o.requirementId,s);y("create",q),d.value="create"}catch(q){d.value="error",m.value=((n=(t=q.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to create requirement detail",y("error",m.value)}}return P(async()=>{var t;const s=((t=(await ae(o.requirementId)).data)==null?void 0:t.requirement)||{};c.value=await u.fetchDepartmentEmployee([s.from_department_id])}),(s,t)=>(r(),a("div",{class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative",ref_key:"formContainerRef",ref:g},[e("div",He,[t[7]||(t[7]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add Requirement",-1)),t[8]||(t[8]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:t[0]||(t[0]=R(n=>y("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:R(i,["prevent"]),class:"z-0"},[d.value!=="loading"?(r(),a(E,{key:0},[e("div",We,[e("label",Ke,[t[9]||(t[9]=N("Title ")),I(Ie)]),U(e("input",{"onUpdate:modelValue":t[1]||(t[1]=n=>p.value.title=n),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[L,p.value.title]])]),e("div",Qe,[t[10]||(t[10]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Details",-1)),U(e("textarea",{rows:"10","onUpdate:modelValue":t[2]||(t[2]=n=>p.value.description=n),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[L,p.value.description]])]),e("div",Je,[t[12]||(t[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),I(Te,{modelValue:p.value.supervisor_id,"onUpdate:modelValue":t[3]||(t[3]=n=>p.value.supervisor_id=n),options:c.value,placeholder:"--NO SUPERVISOR--",containment:g.value,clearable:"",class:"h-10"},{"list-header":T(()=>t[11]||(t[11]=[e("div",{class:"px-3 pt-2 pb-1 shadow-md text-xs uppercase bg-gray-50 text-gray-500"}," Employees ",-1)])),option:T(({option:n})=>[I(se,{user:n||{},class:"pr-5 -mx-1"},null,8,["user"])]),"selected-option":T(({option:n})=>[n?(r(),j(se,{key:0,user:n||{},class:"pr-4"},null,8,["user"])):v("",!0)]),_:1},8,["modelValue","options","containment"])]),e("div",Ye,[t[14]||(t[14]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),U(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[4]||(t[4]=n=>p.value.priority=n)},t[13]||(t[13]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[he,p.value.priority]])]),e("div",Xe,[t[15]||(t[15]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),U(e("input",{type:"date","onUpdate:modelValue":t[5]||(t[5]=n=>p.value.better_to_complete_on=n),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[L,p.value.better_to_complete_on]])])],64)):v("",!0),e("div",Ze,[m.value?(r(),a("div",et,w(m.value),1)):v("",!0),m.value?(r(),a("hr",tt)):v("",!0),e("div",st,[e("button",{type:"button",onClick:t[6]||(t[6]=R(n=>y("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:d.value=="loading"||d.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},w(d.value=="submitting"?"Saving...":"Add Requirement"),9,nt)])])],32),d.value==="loading"||d.value==="submitting"?(r(),j(ne,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):v("",!0)],512))}},it={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},lt={class:"mb-4"},at={class:"font-semibold"},ot={class:"mb-4"},ut={class:"line-clamp-2"},dt={key:1,class:"min-h-40"},mt={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},pt={key:0,class:"mb-4 text-red-500 font-medium"},ct={key:1,class:"mb-4"},vt={class:"flex items-center justify-between gap-4"},bt=["disabled"],ft={__name:"RequirementDetailDeleteForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["delete","closeClick","error"],setup(f,{emit:D}){const o=f,y=D,u=De(),g=_(null),d=_(""),m=_(),p=_([]);async function c(){var i,s;d.value="submitting";try{const t=await Ve(o.requirementId,o.detailId);y("delete",t),d.value="create"}catch(t){d.value="error",m.value=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to update requirement detail: "+t,y("error",m.value)}}return P(async()=>{var i,s,t;d.value="loading";try{p.value=await u.fetchDepartmentWiseEmployees(),g.value=(i=(await oe(o.requirementId,o.detailId)).data)==null?void 0:i.detail}catch(n){m.value=((t=(s=n.response)==null?void 0:s.data)==null?void 0:t.message)||"Failed to fetch requirement detail"}finally{d.value=""}}),(i,s)=>{var t,n;return r(),a("div",it,[s[4]||(s[4]=e("div",{class:"sticky top-0 -mx-6 px-6 z-10 bg-gray-50"},[e("h2",{class:"text-xl font-semibold text-gray-800 py-2"},"Delete Requirement Details"),e("hr",{class:"mb-4 -mx-6"})],-1)),e("form",{onSubmit:R(c,["prevent"]),class:"z-0"},[d.value!=="loading"?(r(),a(E,{key:0},[e("div",lt,[s[1]||(s[1]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Title",-1)),e("div",at,w((t=g.value)==null?void 0:t.title),1)]),e("div",ot,[s[2]||(s[2]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),e("div",ut,w((n=g.value)==null?void 0:n.description),1)]),s[3]||(s[3]=e("div",{class:"my-8 text-center text-xl text-red-600"},"Are you sure want to delete?",-1))],64)):(r(),a("div",dt)),e("div",mt,[m.value?(r(),a("div",pt,w(m.value),1)):v("",!0),m.value?(r(),a("hr",ct)):v("",!0),e("div",vt,[e("button",{type:"button",onClick:s[0]||(s[0]=R(q=>y("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:d.value=="loading"||d.value=="submitting",type:"submit",class:"bg-red-700 hover:bg-red-500 text-white font-semibold px-5 py-2 rounded transition"},w(d.value=="submitting"?"Deleting...":"Delete"),9,bt)])])],32),d.value==="loading"||d.value==="submitting"?(r(),j(ne,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):v("",!0)])}}},yt={class:"sticky top-0 pt-4 bg-white z-10"},gt={class:"mb-4"},xt={class:"block text-gray-600 text-sm mb-1 font-medium"},kt={class:"mb-4"},_t={class:"mb-4"},wt={key:0,class:"relative w-full"},qt={key:0,class:"absolute right-1 text-xl top-0 bottom-0 flex items-center"},ht={class:"mb-4"},$t={class:"mb-4"},Ct={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},Rt={key:0,class:"mb-4 text-red-500 font-medium"},St={key:1,class:"mb-4"},It={class:"flex items-center justify-between gap-4"},Tt=["disabled"],Dt={__name:"RequirementDetailEditForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(f,{emit:D}){const o=f,y=D,u=_(),g=De(),d=_(null),m=_(""),p=_(),c=_({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),i=_([]);async function s(){var n,q;m.value="submitting";const t={...c.value};try{const k=await Fe(o.requirementId,o.detailId,t);y("update",k),m.value="create"}catch(k){m.value="error",p.value=((q=(n=k.response)==null?void 0:n.data)==null?void 0:q.message)||"Failed to update requirement detail",y("error",p.value)}}return P(async()=>{var t,n,q,k,S,A,b;m.value="loading";try{i.value=await g.fetchDepartmentWiseEmployees(),await g.fetchTypeWiseEmployees({type:"academy_body,doctor,executive"}),d.value=(t=(await oe(o.requirementId,o.detailId)).data)==null?void 0:t.detail,c.value={title:(n=d.value)==null?void 0:n.title,description:(q=d.value)==null?void 0:q.description,priority:(k=d.value)==null?void 0:k.priority,supervisor_id:(S=d.value)==null?void 0:S.supervisor_id};const C=new Date(d.value.better_to_complete_on);c.value.better_to_complete_on=C.toISOString().split("T")[0]}catch(C){p.value=((b=(A=C.response)==null?void 0:A.data)==null?void 0:b.message)||"Failed to fetch requirement detail"}finally{m.value=""}}),(t,n)=>{var q;return r(),a("div",{ref_key:"formContainerRef",ref:u,class:"max-h-[90vh] w-full mx-auto overflow-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},[e("div",yt,[n[8]||(n[8]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Edit Requirement",-1)),n[9]||(n[9]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:n[0]||(n[0]=R(k=>y("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:R(s,["prevent"]),class:"z-0"},[m.value!=="loading"?(r(),a(E,{key:0},[e("div",gt,[e("label",xt,[n[10]||(n[10]=N("Title ")),I(Ie)]),U(e("input",{"onUpdate:modelValue":n[1]||(n[1]=k=>c.value.title=k),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[L,c.value.title]])]),e("div",kt,[n[11]||(n[11]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),U(e("textarea",{rows:"10","onUpdate:modelValue":n[2]||(n[2]=k=>c.value.description=k),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[L,c.value.description]])]),e("div",_t,[n[12]||(n[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),I(Te,{modelValue:c.value.supervisor_id,"onUpdate:modelValue":n[4]||(n[4]=k=>c.value.supervisor_id=k),options:[...B(g).users||[],...(B(g).users||[]).find(k=>{var S,A;return k.id==((A=(S=d.value)==null?void 0:S.supervisor)==null?void 0:A.id)})?[]:[(q=d.value)==null?void 0:q.supervisor]],containment:u.value,placeholder:"--NO SUPERVISOR--",class:"h-10"},{option:T(({option:k})=>[I(se,{user:k||{}},null,8,["user"])]),"selected-option":T(({option:k})=>[k?(r(),a("div",wt,[I(se,{user:k||{}},null,8,["user"]),c.value.supervisor_id?(r(),a("div",qt,[e("button",{onClick:n[3]||(n[3]=R(S=>c.value.supervisor_id=null,["prevent"])),class:"text-gray-6 font-semibold 00 hover:text-red-700"}," × ")])):v("",!0)])):v("",!0)]),_:1},8,["modelValue","options","containment"])]),e("div",ht,[n[14]||(n[14]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),U(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":n[5]||(n[5]=k=>c.value.priority=k)},n[13]||(n[13]=[e("option",{value:null},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[he,c.value.priority]])]),e("div",$t,[n[15]||(n[15]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),U(e("input",{type:"date","onUpdate:modelValue":n[6]||(n[6]=k=>c.value.better_to_complete_on=k),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[L,c.value.better_to_complete_on]])])],64)):v("",!0),e("div",Ct,[p.value?(r(),a("div",Rt,w(p.value),1)):v("",!0),p.value?(r(),a("hr",St)):v("",!0),e("div",It,[e("button",{type:"button",onClick:n[7]||(n[7]=R(k=>y("closeClick"),["prevent"])),class:"btn-3"},"Cancel"),e("button",{disabled:m.value=="loading"||m.value=="submitting",type:"submit",class:"btn-2"},w(m.value=="submitting"?"Saving...":"Edit"),9,Tt)])])],32),m.value==="loading"||m.value==="submitting"?(r(),j(ne,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):v("",!0)],512)}}},At=["rowspan"],Nt={class:"text-2xl font-medium"},jt=["rowspan"],Et={class:"text-lg font-semibold mb-2 flex items-start gap-3"},Ut={key:0},Lt={key:0,class:"mb-5"},Vt=["innerHTML"],Ft={class:"flex items-end"},Ot={key:0,class:"mt-4 flex justify-between items-end print:pb-0"},Pt={class:""},Bt={key:1,class:"ml-auto flex gap-6 items-center"},Mt=["rowspan"],zt={class:"text-center print:text-xs"},Gt={class:"border-2 border-gray-700 p-3 text-center"},Ht=["title"],Wt={class:"border-2 border-gray-700 p-3"},Kt={class:"whitespace-nowrap text-center print:whitespace-break-spaces"},Qt={key:0,class:"print:text-xs"},Jt={key:1,class:"text-gray-500"},Yt={key:0,colspan:"2",class:"border-2 border-gray-700 p-3 text-center"},Xt={key:1,class:"text-red-400"},Zt={key:2,class:"text-blue-400"},es={key:0},ts={colspan:"2",class:"border-2 border-gray-700 p-3 text-center"},ss={key:1,class:"text-red-400"},ns={key:2,class:"text-blue-400"},rs={__name:"RequirementDetailTableRow",props:{detail:{type:Object},requirement:{type:Object},serial:{type:Number},isPrinting:{type:Boolean}},emits:["editClick","deleteClick","taskCreateClick"],setup(f,{emit:D}){const o=f,y=D,u=$e(),g=_(""),d=F(()=>{var c,i,s;return((i=(c=o.detail)==null?void 0:c.tasks)==null?void 0:i.length)>0?(s=o.detail)==null?void 0:s.tasks:[{id:0}]});function m(){var c,i,s,t,n;if(u.user.role!=="super_admin"&&((c=u.user)==null?void 0:c.id)!==((s=(i=o.requirement)==null?void 0:i.to_department)==null?void 0:s.incharge_id))return alert(`You can't create or assign task for this requirement. 
Only ${(n=(t=o.requirement)==null?void 0:t.to_department)==null?void 0:n.name}'s In charge can create or assign.`);y("taskCreateClick",o.detail)}const p=F(()=>{var c,i;return(((i=(c=o.detail)==null?void 0:c.tasks)==null?void 0:i.length)||1)+(o.isPrinting?0:1)});return(c,i)=>{const s=Ce("RouterLink");return r(),a(E,null,[(r(!0),a(E,null,te(d.value,(t,n)=>{var q,k,S;return r(),a("tr",{key:t.id,class:"group/item border text-gray-800 py-4 shadow-sm mb-4 px-4 rounded-md hover:bg-blue-50"},[n===0?(r(),a(E,{key:0},[e("td",{class:"border-2 border-gray-700 p-3 align-baseline",rowspan:p.value},[e("span",Nt,w(f.serial),1)],8,At),e("td",{class:"border-2 border-gray-700 p-3 align-baseline",rowspan:p.value},[e("div",null,[e("div",Et,[I(ie,{"line-clamp":"3",class:"grow"},{default:T(()=>[N(w(f.detail.title),1)]),btnText:T(({lineClampClass:A})=>[N(w(A?"More":"Less"),1)]),_:1}),f.detail.priority?(r(),a("div",Ut,[e("span",{class:V(["font-semibold text-sm",{"text-yellow-600 ":f.detail.priority=="IMPORTANT","text-red-700 ":f.detail.priority=="URGENT"}])},w(f.detail.priority),3)])):v("",!0)]),i[3]||(i[3]=e("hr",{class:"mb-4 -mx-4"},null,-1)),f.detail.description?(r(),a("div",Lt,[i[2]||(i[2]=e("div",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Description",-1)),I(ie,{"line-clamp":4,"class-name":{button:"group-hover/item:underline"}},{default:T(()=>[e("p",{innerHTML:f.detail.description,class:"text-justify"},null,8,Vt)]),_:1})])):v("",!0)]),e("div",Ft,[f.detail.supervisor?(r(),a("div",Ot,[e("div",Pt,[i[4]||(i[4]=e("div",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Supervisor:",-1)),I(Me,{user:f.detail.supervisor},null,8,["user"])])])):v("",!0),g.value!="loading"&&!((q=f.requirement)!=null&&q.status)||((S=(k=B(u))==null?void 0:k.user)==null?void 0:S.role)=="super_admin"?(r(),a("div",Bt,[e("button",{class:"btn-2",onClick:i[0]||(i[0]=R(A=>y("editClick",f.detail),["prevent"]))},i[5]||(i[5]=[e("i",{class:"fas fa-edit"},null,-1),N("Edit ")])),e("button",{class:"btn-2-red",onClick:i[1]||(i[1]=R(A=>y("deleteClick",f.detail),["prevent"]))},i[6]||(i[6]=[e("i",{class:"fas fa-trash-alt"},null,-1),N("Delete ")]))])):v("",!0)])],8,jt),e("td",{class:"border-2 border-gray-700 p-3 whitespace-nowrap print:whitespace-break-spaces print:px-0",rowspan:p.value},[e("div",zt,w(f.detail.better_to_complete_on?new Date(f.detail.better_to_complete_on).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",weekday:"short"}):""),1)],8,Mt)],64)):v("",!0),t.id?(r(),a(E,{key:1},[e("td",Gt,[I(s,{title:t.title,to:{name:"RequirementTaskShow",params:{id:t.id}},class:"hover:underline text-gray-900 hover:text-blue-600 whitespace-nowrap block",target:"_blank"},{default:T(()=>[N(w(t.id)+" ",1),e("i",{title:t.status,class:V(["ml-1",{"fad fa-exclamation-circle text-red-600":t.status=="PENDING","fad fa-exclamation-square text-yellow-600":t.status=="IN_PROGRESS","fad fa-check-circle text-green-600":t.status=="COMPLETED"}])},null,10,Ht)]),_:2},1032,["title","to"])]),e("td",Wt,[e("div",Kt,[t.deadline?(r(),a("div",Qt,w(new Date(t.deadline).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",weekday:"short"})),1)):(r(),a("div",Jt,"-"))])])],64)):(r(),a(E,{key:2},[f.isPrinting?(r(),a("td",Yt,[f.requirement.status=="approved"?(r(),a("button",{key:0,onClick:R(m,["prevent"]),class:"print:hidden border-2 border-transparent group-hover/item:bg-blue-200 hover:border-blue-700 text-blue-500 hover:text-white hover:!bg-blue-500 rounded-md px-4 py-1 whitespace-nowrap"},i[7]||(i[7]=[e("i",{class:"fas fa-plus-circle"},null,-1),N(" Create / Assign Task ")]))):f.requirement.status=="rejected"?(r(),a("div",Xt,"Task Rejected")):(r(),a("div",Zt,"Approval Pending"))])):v("",!0)],64))])}),128)),f.isPrinting?v("",!0):(r(),a("tr",es,[e("td",ts,[f.requirement.status=="approved"?(r(),a("button",{key:0,onClick:R(m,["prevent"]),class:"print:hidden border-2 border-transparent group-hover/item:bg-blue-200 hover:border-blue-700 text-blue-500 hover:text-white hover:!bg-blue-500 rounded-md px-4 py-1 whitespace-nowrap"},i[8]||(i[8]=[e("i",{class:"fas fa-plus-circle"},null,-1),N(" Create / Assign Task ")]))):f.requirement.status=="rejected"?(r(),a("div",ss,"Task Rejected")):(r(),a("div",ns,"Approval Pending"))])]))],64)}}},is={class:"sticky top-0 pt-4 bg-white z-10"},ls={class:"mb-4"},as={class:"mb-4"},os={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},us={key:0,class:"mb-4 text-red-500 font-medium"},ds={key:1,class:"mb-4"},ms={class:"flex items-center justify-between gap-4"},ps=["disabled"],cs={__name:"RequirementFeedbackEditForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(f,{emit:D}){const o=f,y=D,u=_(),g=_(null),d=_(""),m=_(),p=_({feedback:""});async function c(){var i,s;d.value="submitting";try{const t=await Oe(o.requirementId,o.detailId,p.value.feedback);y("update",t),d.value="create"}catch(t){d.value="error",m.value=((s=(i=t.response)==null?void 0:i.data)==null?void 0:s.message)||"Failed to update requirement detail",y("error",m.value)}}return P(async()=>{var i,s,t,n;d.value="loading";try{await ae(o.requirementId),g.value=(i=(await oe(o.requirementId,o.detailId)).data)==null?void 0:i.detail,p.value={feedback:(s=g.value)==null?void 0:s.feedback}}catch(q){m.value=((n=(t=q.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to fetch requirement detail"}finally{d.value=""}}),(i,s)=>{var t;return r(),a("div",{ref_key:"formContainerRef",ref:u,class:"max-h-[90vh] w-full mx-auto overflow-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},[e("div",is,[s[3]||(s[3]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Requirement Feedback",-1)),s[4]||(s[4]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:s[0]||(s[0]=R(n=>y("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:R(c,["prevent"]),class:"z-0"},[d.value!=="loading"?(r(),a(E,{key:0},[e("div",ls,[s[5]||(s[5]=e("label",{class:"block text-gray-600 text-sm font-medium"},"Title ",-1)),I(ie,{"line-clamp":"1",className:{paragraph:"whitespace-pre-wrap text-justify ",button:"mt-0"}},{default:T(()=>{var n;return[N(w((n=g.value)==null?void 0:n.title),1)]}),_:1})]),e("div",as,[s[6]||(s[6]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Feedback",-1)),U(e("textarea",{rows:"5","onUpdate:modelValue":s[1]||(s[1]=n=>p.value.feedback=n),placeholder:"Enter requirement feedback",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[L,p.value.feedback]])])],64)):v("",!0),e("div",os,[m.value?(r(),a("div",us,w(m.value),1)):v("",!0),m.value?(r(),a("hr",ds)):v("",!0),e("div",ms,[e("button",{type:"button",onClick:s[2]||(s[2]=R(n=>y("closeClick"),["prevent"])),class:"btn-3"},"Cancel"),e("button",{disabled:d.value=="loading"||d.value=="submitting",type:"submit",class:"btn-2"},w(d.value=="submitting"?"Saving...":(t=g.value)!=null&&t.feedback?"Update Feedback":"Add Feedback"),9,ps)])])],32),d.value==="loading"||d.value==="submitting"?(r(),j(ne,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):v("",!0)],512)}}},vs={class:"flex justify-center items-center"},bs={class:"modal-card"},fs=["required"],ys={class:"flex"},gs={class:"flex justify-between gap-2 mt-4"},xs=["disabled"],ks=["disabled"],_s={__name:"RequirementSubmissionHandler",props:{requirementId:{type:[String,Number],required:!0}},emits:["loading","success","error"],setup(f,{emit:D}){const o=f,y=D,u=_(255),g=F(()=>u.value-i.value.length),d=Re(),m=_(null),p=_(null),c=_(null),i=_(""),s=_(!1),t=F(()=>c.value!==null);function n(b){c.value=b,i.value="",A()}function q(){c.value=null,i.value=""}async function k(){var b,C;if(c.value==="reject"&&!i.value)return d.error("Rejection Reason is required!");if(typeof o.onSubmit=="function")return o.onSubmit({note:i.value,action:c.value});y("loading",!0),s.value=!0;try{await Ue(o.requirementId,{note:i.value}),y("success"),q()}catch($){return y("error",$),d.error(((C=(b=$==null?void 0:$.response)==null?void 0:b.data)==null?void 0:C.message)||"Submission failed!")}finally{y("loading",!1),s.value=!1}}function S(b){var C,$;t.value&&(b.key==="ArrowLeft"?(C=p.value)==null||C.focus():b.key==="ArrowRight"&&(($=m.value)==null||$.focus()))}function A(){Se(()=>{var b;(b=m.value)==null||b.focus()})}return P(()=>{window.addEventListener("keydown",S)}),le(()=>{window.removeEventListener("keydown",S)}),(b,C)=>(r(),a("div",null,[e("div",vs,[e("button",{onClick:C[0]||(C[0]=$=>n("accept"))},C[3]||(C[3]=[e("span",{class:"btn-2"},[e("span",{class:"fas fa-paper-plane"}),e("span",{class:"hidden md:inline"},"Submit Requirement")],-1)]))]),t.value?(r(),a("div",{key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50",onClick:R(q,["self"])},[e("div",bs,[C[4]||(C[4]=e("h3",{class:"title-lg"},"Requirement Submission",-1)),e("div",null,[U(e("textarea",{"onUpdate:modelValue":C[1]||(C[1]=$=>i.value=$),rows:"4",placeholder:"Note...",class:"w-full border rounded-lg p-2 text-gray-700",required:c.value==="reject",onInput:C[2]||(C[2]=$=>i.value.length>u.value?i.value=i.value.slice(0,u.value):null)},null,40,fs),[[L,i.value]]),e("div",ys,[e("div",{class:V(["ml-auto inline-block text-sm text-gray-500",i.value.length>=u.value?"text-red-500":""])}," left "+w(g.value)+"/"+w(u.value)+" words ",3)])]),e("div",gs,[e("button",{ref_key:"cancelBtnRef",ref:p,class:"btn-3 focus:ring-2 ring-offset-2 disabled:opacity-30",onClick:q,disabled:s.value}," Cancel ",8,xs),e("button",{ref_key:"confirmBtnRef",ref:m,class:V(["focus:ring-2 ring-offset-2 disabled:opacity-30",c.value==="reject"?"btn-2-red":"btn-2-green"]),onClick:k,disabled:s.value}," Confirm Submission ",10,ks)])])])):v("",!0)]))}},ws={class:"flex items-center gap-6 justify-center my-16"},qs={key:0,class:"border rounded-md"},hs={__name:"RequirementTaskCreateOrAssign",props:{fromDepartmentId:{type:Number},requirementDetail:{type:Object}},emits:["addNewTaskClick","cancelClick","assignTask"],setup(f,{emit:D}){const o=f,y=D,u=ze(),g=_(""),d=_(null),m=_(""),p=_(!1);async function c(){await u.setTaskRequirement(m.value,o.requirementDetail.id),y("assignTask")}return(i,s)=>(r(),a("div",{class:V(["text-left p-4",[g.value&&!d.value?"min-h-[400px]":""]])},[e("div",ws,[e("button",{onClick:s[0]||(s[0]=R(t=>y("addNewTaskClick"),["prevent"])),class:"btn-3"},"Add New Task"),s[5]||(s[5]=e("span",null,"or",-1)),e("button",{class:V({"btn-3":g.value!=="direct-assign","btn-2":g.value=="direct-assign"}),onClick:s[1]||(s[1]=R(()=>g.value="direct-assign",["prevent"]))}," Assign Task ",2)]),g.value&&!d.value?(r(),a("div",qs,[e("form",{onSubmit:R(c,["prevent"]),class:"p-4 flex items-end"},[I(Ge,{class:"flex-grow mr-4 h-12",taskId:m.value,"onUpdate:taskId":s[2]||(s[2]=t=>m.value=t),show:p.value,"onUpdate:show":s[3]||(s[3]=t=>p.value=t),isOnlyMyTask:!1,taskQueryParams:{"from-department-id":f.fromDepartmentId},filterTasks:t=>!t.requirement_detail_id,onAddNewTaskClick:s[4]||(s[4]=t=>y("addNewTaskClick"))},null,8,["taskId","show","taskQueryParams","filterTasks"]),s[6]||(s[6]=e("div",{class:"flex justify-center"},[e("button",{class:"btn-2 h-12 rounded-md"},"Save")],-1))],32)])):v("",!0)],2))}},$s={key:0,class:"font-bold text-lg text-green-600",title:"Approve"},Cs={key:1,class:"btn-2"},Rs={key:0,class:"text-base",title:"Reject"},Ss={key:1,class:"btn-1"},Is={class:"modal-card"},Ts={class:"title-lg"},Ds=["placeholder","required"],As={class:"flex"},Ns={class:"text-red-500 text-center"},js={class:"flex justify-between gap-2 mt-4"},Es=["disabled"],Us=["disabled"],Ls={class:"capitalize hidden md:inline"},Vs={__name:"ApproveAndReject",props:{notificationType:{type:String,required:!0},applicationId:{type:[String,Number],required:!0},onSuccess:{type:Function,default:null},onSubmit:{type:Function,default:null},variant:{type:Number,default:1}},emits:["loading"],setup(f,{emit:D}){const o=f,y=D,u=_(255),g=F(()=>u.value-s.value.length),d=Re(),m=Ae(),p=_(null),c=_(null),i=_(null),s=_(""),t=_(!1),n=F(()=>i.value!==null),q=F(()=>i.value==="accept"?"Accept Application":"Reject Application");function k($){($==="accept"||$==="reject")&&(i.value=$,s.value="",C())}function S(){i.value=null,s.value=""}async function A(){if(!m.loading){if(i.value==="reject"&&!s.value)return d.error("Rejection Reason is required!");if(typeof o.onSubmit=="function")return o.onSubmit({note:s.value,action:i.value});y("loading",!0),t.value=!0;try{await m.updateNotification(o.notificationType,o.applicationId,i.value,s.value)}finally{y("loading",!1),t.value=!1}typeof o.onSuccess=="function"?o.onSuccess():m.fetchTaskNotification(),S()}}function b($){var x,l;n.value&&($.key==="ArrowLeft"?(x=c.value)==null||x.focus():$.key==="ArrowRight"&&((l=p.value)==null||l.focus()))}function C(){Se(()=>{var $;($=p.value)==null||$.focus()})}return P(()=>{window.addEventListener("keydown",b)}),le(()=>{window.removeEventListener("keydown",b)}),($,x)=>(r(),a("div",null,[e("div",{class:V(["flex justify-center items-center",f.variant===1?"gap-5":"gap-2"])},[e("button",{onClick:x[0]||(x[0]=l=>k("accept"))},[f.variant===1?(r(),a("span",$s,"✔")):v("",!0),f.variant===2?(r(),a("span",Cs,x[4]||(x[4]=[e("span",{class:"text-base scale-110"},"✔",-1),e("span",{class:"hidden md:inline"},"Approve",-1)]))):v("",!0)]),e("button",{onClick:x[1]||(x[1]=l=>k("reject"))},[f.variant===1?(r(),a("span",Rs,"❌")):v("",!0),f.variant===2?(r(),a("span",Ss,x[5]||(x[5]=[e("span",{class:"text-base"},"❌",-1),e("span",{class:"hidden md:inline"},"Reject",-1)]))):v("",!0)])],2),n.value?(r(),a("div",{key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50",onClick:R(S,["self"])},[e("div",Is,[e("h3",Ts,w(q.value),1),e("div",null,[U(e("textarea",{"onUpdate:modelValue":x[2]||(x[2]=l=>s.value=l),rows:"7",placeholder:i.value==="accept"?"Accept Note...":"Rejection Reason...",class:"w-full border rounded-lg p-2 text-gray-700",required:i.value==="reject",onInput:x[3]||(x[3]=l=>s.value.length>u.value?s.value=s.value.slice(0,u.value):null)},null,40,Ds),[[L,s.value]]),e("div",As,[e("div",{class:V(["ml-auto inline-block text-sm text-gray-500",s.value.length>=u.value?"text-red-500":""])}," left "+w(g.value)+"/"+w(u.value)+" words ",3)])]),e("div",Ns,w(B(m).error),1),e("div",js,[e("button",{ref_key:"cancelBtnRef",ref:c,class:"btn-3 focus:ring-2 ring-offset-2 disabled:opacity-30",onClick:S,disabled:t.value}," Cancel ",8,Es),e("button",{ref_key:"confirmBtnRef",ref:p,class:V(["focus:ring-2 ring-offset-2 disabled:opacity-30",i.value==="reject"?"btn-2-red":"btn-2-green"]),onClick:A,disabled:t.value},[x[6]||(x[6]=N(" Confirm ")),e("span",Ls,w(i.value),1)],10,Us)])])])):v("",!0)]))}},Fs={class:"flex flex-col items-center gax-x-1 justify-between pt-16"},Os={key:0},Ps={key:1},Bs={class:"text-base text-gray-900 font-semibold"},Ms={class:"ml-2"},zs={key:0,class:"text-green-600 ml-2"},Gs={key:1,class:"ml-2 text-yellow-700"},qe={__name:"RequirementApprovalItem",props:{requirement:{type:Object,required:!0},approvalType:{type:String,required:!0}},emits:["updateApproval"],setup(f,{emit:D}){const o=f,y=D,u=$e(),g=F(()=>{var t,n,q,k,S,A,b,C,$,x,l,re,M,z,G,H,W,K,Q,J,Y,X;let m=null,p=null,c=null,i="",s=!1;return o.approvalType==="from_in_charge"&&(m=(t=o.requirement)==null?void 0:t.from_department,p=(q=(n=o.requirement)==null?void 0:n.from_department)==null?void 0:q.in_charge,c=(S=(k=o.requirement)==null?void 0:k.from_department)==null?void 0:S.in_charge,i="In Charge",s=!!((A=o.requirement)!=null&&A.status&&((b=o.requirement)!=null&&b.submission_date))),o.approvalType==="from_coordinator"&&(m=(C=o.requirement)==null?void 0:C.from_department,p=(x=($=o.requirement)==null?void 0:$.from_department)==null?void 0:x.coordinator,c=(l=o.requirement)==null?void 0:l.from_coordinator,s=!!((re=o.requirement)!=null&&re.from_coordinator),i="Coordinator"),o.approvalType==="to_in_charge"&&(m=(M=o.requirement)==null?void 0:M.to_department,p=(G=(z=o.requirement)==null?void 0:z.to_department)==null?void 0:G.in_charge,c=(H=o.requirement)==null?void 0:H.to_in_charge,s=!!((W=o.requirement)!=null&&W.to_incharge),i="In Charge"),o.approvalType==="to_coordinator"&&(m=(K=o.requirement)==null?void 0:K.to_department,p=(J=(Q=o.requirement)==null?void 0:Q.to_department)==null?void 0:J.coordinator,c=(Y=o.requirement)==null?void 0:Y.to_coordinator,s=!!((X=o.requirement)!=null&&X.to_coordinator),i="Coordinator"),{department:m,department_user:p,approval_user:c,userType:i,approved:s}});function d(){y("updateApproval")}return(m,p)=>{var c,i,s,t,n,q,k,S;return r(),a("div",Fs,[g.value.department_user?(r(),a("div",Os,[I(se,{user:g.value.department_user,"avatar-size":"xsmall"},null,8,["user"])])):(r(),a("div",Ps,p[0]||(p[0]=[e("span",{class:"italic text-xs text-gray-400"},"N/A",-1)]))),p[2]||(p[2]=e("hr",{class:"my-2 border-gray-600 w-64"},null,-1)),e("div",Bs,[e("span",null,w(((c=g.value.department)==null?void 0:c.short_name)||((i=g.value.department)==null?void 0:i.name)),1),e("span",Ms,w(g.value.userType),1),g.value.department_user?(r(),a(E,{key:0},[g.value.approved||((s=o.requirement)==null?void 0:s.status)==="approved"?(r(),a("span",zs,"(✔)")):(r(),a("span",Gs,p[1]||(p[1]=[e("i",{class:"fad fa-spinner"},null,-1)])))],64)):v("",!0),((t=o.requirement)==null?void 0:t.status)!=="approved"&&g.value.department_user&&!g.value.approved&&((n=B(u).user)==null?void 0:n.id)==((k=(q=g.value)==null?void 0:q.department_user)==null?void 0:k.id)?(r(),j(Vs,{key:1,class:"ml-auto z-[5000000]",notificationType:"pending-requirements",applicationId:(S=o.requirement)==null?void 0:S.id,onSuccess:d,variant:1},null,8,["applicationId"])):v("",!0)])])}}},Hs={class:"container mx-auto p-6 print:p-0 w-full print:max-w-full"},Ws={class:"bg-white rounded shadow print:shadow-none p-4 print:p-0 relative mb-6 print:mb-0"},Ks={class:"flex items-start"},Qs={class:"mb-4 text-lg print:black print:font-bold"},Js={class:"ml-auto print:hidden flex gap-2 items-center"},Ys={class:"mb-4 flex items-center gap-1 print:mb-1"},Xs={class:"font-bold print:text-gray-900"},Zs={class:"mb-3 flex items-center gap-3 print:mb-1"},en={class:"print:text-gray-900"},tn={key:0,class:"mb-3 flex items-center gap-3 print:mb-1"},sn={class:"flex items-center gap-2 print:text-gray-900 flex-wrap"},nn={key:1,class:"mb-3 flex items-center gap-3 print:mb-1"},rn={class:"print:text-gray-900"},ln={key:0,class:"overflow-x-auto print:overflow-visible"},an={class:"w-full table-auto print:table-fixed"},on={colspan:"2",class:"w-[30%] border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap px-3 py-1 print:whitespace-normal"},un={class:""},dn={class:"p-3 border-2 border-gray-800",colspan:"5"},mn={class:"font-semibold text-gray-500 print:text-gray-800 text-sm mb-1"},pn={key:0},cn=["innerHTML"],vn=["onClick"],bn={key:1,class:"mt-8 border rounded-md p-8 flex items-start justify-between bg-gray-50 print:hidden"},fn={class:"flex flex-col items-end"},yn={key:2,class:"mt-2 text-right print:hidden"},gn={key:3,class:"mt-4 mb-8 break-before-avoid-page"},xn={class:"whitespace-nowrap border-gray-200 grid grid-cols-2 items-center"},kn={key:0,class:"whitespace-nowrap border-gray-200 grid grid-cols-2 gap-2 items-center"},zn={__name:"RequirementShow",setup(f){const D=Ne(),o=je(),y=_(""),u=_(null),g=Z({open:!1}),d=Z({detail:null,open:!1}),m=Z({detail:null,open:!1}),p=Z({detail:null,open:!1}),c=_(!1),i=()=>c.value=!0,s=()=>c.value=!1;P(async()=>{await t(),window.addEventListener("beforeprint",i),window.addEventListener("afterprint",s)}),le(()=>{window.removeEventListener("beforeprint",i),window.removeEventListener("afterprint",s)});async function t(){var x;y.value="loading",u.value=(x=(await ae(D.params.id)).data)==null?void 0:x.requirement,y.value=""}function n(x){console.log({detail:x}),b.modalShown=!0,b.from_department_id=u.value.from_department_id,b.to_department_id=u.value.to_department_id,b.taskDefaultValues={title:"",description:"",from_department_id:u.value.from_department_id,to_department_id:u.value.to_department_id,is_important:(x==null?void 0:x.priority)=="IMPORTANT",is_urgent:(x==null?void 0:x.priority)=="URGENT",supervisor_ids:x!=null&&x.supervisor_id?[x==null?void 0:x.supervisor_id]:[]},b.requirementDetail=x}function q(){g.open=!0}function k(x){d.open=!0,d.detail=x}function S(x){p.open=!0,p.detail=x}function A(){setTimeout(()=>window.print()),c.value=!0}const b=Z({parentId:null,modalShown:!1,requirementId:0,taskDefaultValues:{},requirementDetail:null,creating:!1});async function C(){b.parentId=0,b.parentId=null,b.modalShown=!1,b.requirementDetail=null,y.value="loading",await t()}async function $(){b.parentId=null,b.modalShown=!1,b.requirementDetail=null,b.creating=!1}return(x,l)=>{var M,z,G,H,W,K,Q,J,Y,X,ue,de,me,pe,ce,ve,be,fe,ye,ge,xe;const re=Ce("RouterLink");return r(),a("div",Hs,[g.open?(r(),j(ee,{key:0,class:"*:max-w-4xl"},{default:T(()=>[I(rt,{requirementId:u.value.id,onCloseClick:l[0]||(l[0]=h=>g.open=!1),onCreate:l[1]||(l[1]=async()=>{g.open=!1,await t()})},null,8,["requirementId"])]),_:1})):v("",!0),d.open?(r(),j(ee,{key:1},{default:T(()=>{var h;return[I(Dt,{requirementId:u.value.id,detailId:(h=d.detail)==null?void 0:h.id,onCloseClick:l[2]||(l[2]=O=>d.open=!1),onUpdate:l[3]||(l[3]=async()=>{d.open=!1,await t()})},null,8,["requirementId","detailId"])]}),_:1})):v("",!0),m.open?(r(),j(ee,{key:2},{default:T(()=>{var h;return[I(cs,{requirementId:u.value.id,detailId:(h=m.detail)==null?void 0:h.id,onCloseClick:l[4]||(l[4]=O=>m.open=!1),onUpdate:l[5]||(l[5]=async()=>{m.open=!1,await t()})},null,8,["requirementId","detailId"])]}),_:1})):v("",!0),p.open?(r(),j(ee,{key:3},{default:T(()=>{var h;return[I(ft,{requirementId:u.value.id,detailId:(h=p.detail)==null?void 0:h.id,onCloseClick:l[6]||(l[6]=O=>p.open=!1),onDelete:l[7]||(l[7]=async()=>{p.open=!1,await t()})},null,8,["requirementId","detailId"])]}),_:1})):v("",!0),b.modalShown?(r(),j(ee,{key:4,class:"*:relative"},{default:T(()=>{var h,O;return[e("button",{onClick:R($,["prevent"]),class:"absolute right-3 top-2 text-xl text-red-500 hover:text-red-400"},l[12]||(l[12]=[e("i",{class:"fas fa-times-circle"},null,-1)])),b!=null&&b.creating?v("",!0):(r(),j(hs,{key:0,"from-department-id":(h=u.value)==null?void 0:h.from_department_id,requirementDetail:b==null?void 0:b.requirementDetail,onCancelClick:$,onAddNewTaskClick:l[8]||(l[8]=()=>{b.modalShown=!0,b.creating=!0}),onAssignTask:C},null,8,["from-department-id","requirementDetail"])),b!=null&&b.creating?(r(),j(Pe,{key:1,requirementDetailId:(O=b==null?void 0:b.requirementDetail)==null?void 0:O.id,requirementId:u.value.id,onClose:$,onTaskCreated:C,defaultValues:b.taskDefaultValues,readonlyFields:{from_department_id:!0,to_department_id:!0}},null,8,["requirementDetailId","requirementId","defaultValues"])):v("",!0)]}),_:1})):v("",!0),e("div",Ws,[e("div",Ks,[e("div",Qs,[l[13]||(l[13]=e("div",{class:"text-gray-800 leading-none"},"To",-1)),e("div",null,w((z=(M=u.value)==null?void 0:M.to_department)==null?void 0:z.name),1)]),e("div",Js,[(((G=u.value)==null?void 0:G.details)||[]).length>0?(r(),a("button",{key:0,class:"btn-3 font-semibold !pl-2 !pr-4",onClick:R(A,["prevent"])},l[14]||(l[14]=[e("i",{class:"fad fa-print text-xl"},null,-1),N("Print ")]))):v("",!0),e("button",{class:"btn-3",onClick:l[9]||(l[9]=R(()=>B(o).back(),["prevent"]))},"Back"),I(re,{class:"btn-2",to:`/requirements/edit/${(H=u.value)==null?void 0:H.id}`},{default:T(()=>l[15]||(l[15]=[N("Edit")])),_:1,__:[15]},8,["to"])])]),l[30]||(l[30]=e("div",{class:"text-center text-xl font-bold mb-2 underline"},"Requirement Form",-1)),e("div",Ys,[l[16]||(l[16]=e("div",{class:"text-gray-500 text-sm"},"Requirement ID:",-1)),e("div",Xs,w((W=u.value)==null?void 0:W.id),1)]),e("div",Zs,[l[17]||(l[17]=e("div",{class:"text-gray-500 text-sm"},"From",-1)),e("div",en,w((Q=(K=u.value)==null?void 0:K.from_department)==null?void 0:Q.name),1)]),((Y=(J=u.value)==null?void 0:J.website_tags)==null?void 0:Y.length)>0?(r(),a("div",tn,[l[18]||(l[18]=e("div",{class:"text-gray-500 text-sm"},"Website",-1)),e("div",sn,[(r(!0),a(E,null,te(((X=u.value)==null?void 0:X.website_tags)||[],h=>(r(),a("div",{key:h.id,class:"border px-2 rounded-md bg-gray-50 shadow-sm whitespace-nowrap"},w(h.name),1))),128))])])):v("",!0),(ue=u.value)!=null&&ue.submission_date?(r(),a("div",nn,[l[19]||(l[19]=e("div",{class:"text-gray-500 text-sm"},"Submission Date",-1)),e("div",rn,w(new Date((de=u.value)==null?void 0:de.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),1)])):v("",!0),l[31]||(l[31]=e("hr",{class:"mb-4"},null,-1)),e("div",null,[l[29]||(l[29]=e("div",{class:"flex items-end mb-3"},[e("h2",{class:"text-xl font-semibold"},"Requirements"),e("div",{class:"ml-auto print:hidden flex gap-2 text-sm"})],-1)),(((me=u.value)==null?void 0:me.details)||[]).length>0?(r(),a("div",ln,[e("table",an,[e("thead",null,[e("tr",null,[l[20]||(l[20]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-left px-4 print:px-2 text-gray-800 print:text-black text-xl font-semibold whitespace-nowrap w-[8%]"}," SL ",-1)),l[21]||(l[21]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap print:whitespace-normal w-[65%]"}," Requirement Details ",-1)),l[22]||(l[22]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base px-3 font-semibold whitespace-nowrap print:whitespace-normal print:p-0 w-[15%]"}," Better To Complete ",-1)),e("th",on," For '"+w(((pe=u.value.to_department)==null?void 0:pe.short_name)||((ce=u.value.to_department)==null?void 0:ce.name))+"' Use ",1)]),l[23]||(l[23]=e("tr",null,[e("td",{class:"whitespace-nowrap border-2 border-gray-800 text-center text-gray-800 print:text-black text-sm font-semibold print:text-xs"}," Task No "),e("td",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-sm font-semibold whitespace-nowrap p-3 print:text-xs print:p-0"}," Expected Date ")],-1))]),e("tbody",null,[(r(!0),a(E,null,te(((ve=u.value)==null?void 0:ve.details)||[],(h,O)=>{var ke,_e,we;return r(),a(E,{key:h.id},[I(rs,{requirement:u.value,detail:h,serial:O+1,onEditClick:k,onDeleteClick:S,onTaskCreateClick:n,isPrinting:c.value},null,8,["requirement","detail","serial","isPrinting"]),e("tr",un,[e("td",dn,[e("div",mn," '"+w(((ke=u.value.to_department)==null?void 0:ke.short_name)||((_e=u.value.to_department)==null?void 0:_e.name))+"' Feedback ",1),y.value!="loading"&&((we=u.value)!=null&&we.status)?(r(),a("div",pn,[h!=null&&h.feedback?(r(),j(ie,{key:0,lineClamp:"2",className:{button:"  underline"},class:"mb-4 print:mb-0"},{default:T(()=>[e("p",{class:"text-sky-800 text-sm text-justify",innerHTML:h==null?void 0:h.feedback},null,8,cn)]),_:2},1024)):v("",!0),e("div",null,[e("button",{class:"btn-3 print:hidden",onClick:R(()=>{m.open=!0,m.detail=h},["prevent"])},w(h.feedback?"Update Feedback":"Add feedback"),9,vn)])])):v("",!0)])])],64)}),128))])])])):v("",!0),y.value!="loading"&&!((be=u.value)!=null&&be.status)?(r(),a("div",bn,[e("button",{class:"btn-2 pl-2 text-base",onClick:R(q,["prevent"])},l[24]||(l[24]=[e("i",{class:"fad fa-plus-circle text-2xl mr-2"},null,-1),N("Add Requirement ")])),e("div",fn,[I(_s,{"requirement-id":(fe=u.value)==null?void 0:fe.id,onSuccess:t},{heading:T(()=>l[25]||(l[25]=[N(" Requirement Submission ")])),acceptButtonLabel:T(()=>l[26]||(l[26]=[e("span",{class:"btn-2 pl-2 text-base"},[e("i",{class:"fad fa-paper-plane text-lg mr-2"}),N("Submit Requirement ")],-1)])),submitButtonLabel:T(()=>l[27]||(l[27]=[N(" Submit Requirement ")])),_:1},8,["requirement-id"])])])):v("",!0),y.value!="loading"&&!((ye=u.value)!=null&&ye.status)?(r(),a("div",yn,l[28]||(l[28]=[e("p",{class:"text-yellow-800 text-sm"},[e("span",{class:"fas fa-exclamation-circle"}),N(" After submitting you cannot add requirement no more ")],-1)]))):v("",!0),(ge=u.value)!=null&&ge.status?(r(),a("div",gn,[e("div",xn,[(r(),a(E,null,te(["from_in_charge","from_coordinator"],h=>I(qe,{key:h,requirement:u.value,"approval-type":h,onUpdateApproval:l[10]||(l[10]=()=>t())},null,8,["requirement","approval-type"])),64))]),u.value.from_department_id!==((xe=u.value)==null?void 0:xe.to_department_id)?(r(),a("div",kn,[(r(),a(E,null,te(["to_in_charge","to_coordinator"],h=>I(qe,{key:h,requirement:u.value,"approval-type":h,onUpdateApproval:l[11]||(l[11]=()=>t())},null,8,["requirement","approval-type"])),64))])):v("",!0)])):v("",!0)]),y.value==="loading"?(r(),j(ne,{key:2,class:"absolute inset-0 bg-opacity-90"})):v("",!0)]),I(Ee)])}}};export{zn as default};
