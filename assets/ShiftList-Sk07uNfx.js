import{_ as N}from"./DeleteModal-l6RrPQWO.js";import{_ as I}from"./HeaderWithButtons-BGJItJl3.js";import{L as G}from"./LoaderView-CiljVQ-Z.js";import{r as x,z as O,A as F,c as d,g as z,o as u,a as e,t as c,w as H,h as _,B as U,F as A,y as E,k as V,v as b,s as J,J as R,e as K,n as C}from"./index-C2mX-CvJ.js";import{u as P}from"./company-D_jtdhX1.js";import{u as Q}from"./shift-pYQnFzIR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W={key:0,class:"modal-bg"},X={class:"modal-card"},Y={class:"text-lg font-semibold mb-4"},Z={class:"mb-4"},ee=["value"],te={class:"mb-4"},se={class:"mb-4"},oe={class:"mb-4"},le={class:"mb-4"},ae={class:"mb-4"},ie={class:"mb-4"},ne={class:"flex justify-end"},re={type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},de={__name:"ShiftModal",props:{show:{type:Boolean,required:!0},shift:{type:Object,default:null}},emits:["close","save"],setup(M,{emit:p}){const h=M,g=p,v=P();v.companies;const f=x(!1),i=x(!1),t=O({id:null,company_id:"",name:"",start_time:"",end_time:"",grace_time:"",description:"",status:"Active"}),y=()=>{f.value=!1,t.id=null,t.company_id="",t.name="",t.start_time="",t.end_time="",t.grace_time="",t.description="",t.status="Active"};F(()=>h.shift,l=>{l&&typeof l=="object"&&Object.keys(l).length>0?(f.value=!0,t.id=l.id||null,t.company_id=l.company_id||"",t.name=l.name||"",t.start_time=l.start_time||"",t.end_time=l.end_time||"",t.grace_time=l.grace_time||"",t.description=l.description||"",t.status=l.status||"Active"):y()},{immediate:!0,deep:!0}),F(()=>h.show,async l=>{l&&!i.value&&await S()});const r=()=>{g("save",{...t}),y(),w()},w=()=>{y(),g("close")},S=async()=>{try{await v.fetchCompanies(),i.value=!0}catch(l){console.error("Failed to fetch companies:",l)}};return(l,s)=>M.show?(u(),d("div",W,[e("div",X,[e("h2",Y,c(f.value?"Edit Shift":"Add Shift"),1),e("form",{onSubmit:H(r,["prevent"])},[e("div",Z,[s[8]||(s[8]=e("label",{for:"company_id",class:"block text-sm font-medium mb-2"},"Company",-1)),_(e("select",{id:"company_id","onUpdate:modelValue":s[0]||(s[0]=o=>t.company_id=o),class:"w-full border rounded px-3 py-2",required:""},[s[7]||(s[7]=e("option",{value:"",disabled:""},"Select a company",-1)),(u(!0),d(A,null,E(V(v).companies,o=>(u(),d("option",{key:o.id,value:o.id},c(o.name),9,ee))),128))],512),[[U,t.company_id]])]),e("div",te,[s[9]||(s[9]=e("label",{for:"name",class:"block text-sm font-medium mb-2"},"Name",-1)),_(e("input",{id:"name","onUpdate:modelValue":s[1]||(s[1]=o=>t.name=o),type:"text",class:"w-full border rounded px-3 py-2",placeholder:"Enter shift name",required:""},null,512),[[b,t.name]])]),e("div",se,[s[10]||(s[10]=e("label",{for:"start_time",class:"block text-sm font-medium mb-2"},"Start Time",-1)),_(e("input",{id:"start_time","onUpdate:modelValue":s[2]||(s[2]=o=>t.start_time=o),type:"time",class:"w-full border rounded px-3 py-2",required:""},null,512),[[b,t.start_time]])]),e("div",oe,[s[11]||(s[11]=e("label",{for:"end_time",class:"block text-sm font-medium mb-2"},"End Time",-1)),_(e("input",{id:"end_time","onUpdate:modelValue":s[3]||(s[3]=o=>t.end_time=o),type:"time",class:"w-full border rounded px-3 py-2",required:""},null,512),[[b,t.end_time]])]),e("div",le,[s[12]||(s[12]=e("label",{for:"end_time",class:"block text-sm font-medium mb-2"},"Grace Time (Minute)",-1)),_(e("input",{id:"end_time","onUpdate:modelValue":s[4]||(s[4]=o=>t.grace_time=o),type:"number",class:"w-full border rounded px-3 py-2",required:""},null,512),[[b,t.grace_time]])]),e("div",ae,[s[13]||(s[13]=e("label",{for:"description",class:"block text-sm font-medium mb-2"},"Description",-1)),_(e("textarea",{id:"description","onUpdate:modelValue":s[5]||(s[5]=o=>t.description=o),class:"w-full border rounded px-3 py-2",placeholder:"Enter description (optional)"},null,512),[[b,t.description]])]),e("div",ie,[s[15]||(s[15]=e("label",{for:"status",class:"block text-sm font-medium mb-2"},"Status",-1)),_(e("select",{id:"status","onUpdate:modelValue":s[6]||(s[6]=o=>t.status=o),class:"w-full border rounded px-3 py-2",required:""},s[14]||(s[14]=[e("option",{value:"Active"},"Active",-1),e("option",{value:"Inactive"},"Inactive",-1)]),512),[[U,t.status]])]),e("div",ne,[e("button",{type:"button",onClick:w,class:"bg-gray-300 text-gray-700 px-4 py-2 rounded mr-2"}," Cancel "),e("button",re,c(f.value?"Update":"Create"),1)])],32)])])):z("",!0)}},ue={class:"my-container space-y-4"},ce={key:0,class:"text-center py-4"},me={key:1,class:"space-y-4"},pe={class:"title-md"},fe={class:"overflow-x-auto"},ye={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},_e={class:"text-gray-600 text-sm"},ve={class:"py-3 px-2 text-left"},be={class:"py-3 px-2 text-left"},xe={class:"py-3 px-2 text-left"},he={class:"py-3 px-2 text-left"},ge={class:"py-3 px-2 text-center"},we={class:"py-3 px-2 text-center"},Se={class:"py-3 px-2 text-center"},ke={class:"flex item-center justify-center gap-4"},$e=["onClick"],Ce=["onClick"],Ue={__name:"ShiftList",setup(M){const p=Q(),{shifts:h,loading:g,error:v,message:f}=J(p),i=R(),t=x(!1),y=x(!1),r=x(null),w=()=>{r.value=null,t.value=!0},S=()=>{t.value=!1},l=a=>{r.value=a,t.value=!0},s=a=>{r.value=a,y.value=!0},o=()=>{y.value=!1},q=async a=>{try{a.id?await p.updateShift(a.id,a)?i.success(f.value):i.error(v.value):await p.createShift(a)?i.success(f.value):i.error(v.value)}catch(n){i.error("Failed to save shift!"),console.error("Error handling save:",n)}finally{S()}},L=async()=>{if(!r.value||!r.value.id){i.error("Invalid shift selected for deletion!");return}try{await p.deleteShift(r.value.id),i.success("Shift deleted successfully!")}catch(a){i.error("Failed to delete shift!"),console.error("Error deleting shift:",a)}finally{o()}};K(async()=>{try{await p.fetchShifts()}catch(a){i.error("Failed to fetch shifts!"),console.error("Error fetching shifts:",a)}});const T=a=>{const[n,k]=a.split(":").map(Number),$=new Date;return $.setHours(n,k),$.toLocaleString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})};return(a,n)=>{var k;return u(),d("div",ue,[C(I,{title:"Shift List",onAdd:w}),V(g)?(u(),d("div",ce,[C(G)])):(u(),d("div",me,[(u(!0),d(A,null,E(V(h),($,D)=>(u(),d("div",{key:D},[e("h2",pe,c(D),1),e("div",fe,[e("table",ye,[n[2]||(n[2]=e("thead",null,[e("tr",{class:"bg-gray-200 text-gray-700 text-sm leading-normal"},[e("th",{class:"py-3 px-2 text-left"},"#"),e("th",{class:"py-3 px-2 text-left"},"Name"),e("th",{class:"py-3 px-2 text-left"},"Start Time"),e("th",{class:"py-3 px-2 text-left"},"End Time"),e("th",{class:"py-3 px-2 text-left"},"Grace Time"),e("th",{class:"py-3 px-2 text-center"},"Status"),e("th",{class:"py-3 px-2 text-center"},"Action")])],-1)),e("tbody",_e,[(u(!0),d(A,null,E($,(m,j)=>(u(),d("tr",{key:m.id,class:"border-b border-gray-200 hover:bg-blue-200"},[e("td",ve,c(j+=1),1),e("td",be,c(m.name),1),e("td",xe,c(T(m.start_time)),1),e("td",he,c(T(m.end_time)),1),e("td",ge,c(m.grace_time||0)+" Minutes",1),e("td",we,c(m.status),1),e("td",Se,[e("div",ke,[e("button",{onClick:B=>l(m),class:"text-blue-600 hover:text-blue-800"},n[0]||(n[0]=[e("i",{class:"fas fa-edit"},null,-1)]),8,$e),e("button",{onClick:B=>s(m),class:"text-red-600 hover:text-red-800"},n[1]||(n[1]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ce)])])]))),128))])])])]))),128))])),C(de,{show:t.value,shift:r.value,onClose:S,onSave:q},null,8,["show","shift"]),C(N,{show:y.value,title:"Delete Shift",message:`Are you sure you want to delete ${(k=r.value)==null?void 0:k.name}?`,onClose:o,onConfirm:L},null,8,["show","message"])])}}};export{Ue as default};
