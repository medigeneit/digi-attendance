import{u as Ee,r as y,p as We,b as Pe,c as n,a as t,k as o,j as ze,t as l,h as b,e as d,y as He,l as Ue,d as qe,v as Ge,F as Je,f as Ke,o as a,g as Oe}from"./index-B8yiLsc3.js";import{u as Qe}from"./short-leave-5-szNjmf.js";import{L as Xe}from"./LoaderView-DCHcCu6r.js";import{_ as Ye}from"./ShareComponent-B6F2qvAh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ze={class:"my-container max-w-3xl space-y-6"},et={key:1,class:"card-bg p-4 md:p-8"},tt={class:""},st={class:"grid md:grid-cols-2"},lt={class:"grid md:grid-cols-2 gap-4 pt-10"},ot={class:""},at={class:"font-medium"},nt={class:"text-sm"},rt={key:0,class:"print:hidden"},dt={class:"text-xs"},ut={class:"flex gap-2"},it={class:"font-bold"},vt={key:0,class:"text-green-600 print:text-black"},pt={key:1,class:"pl-2 text-yellow-700"},ct={class:"title-md"},mt={key:0},_t={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},bt={class:"pt-10"},ft={key:0,class:"print:hidden"},yt={class:""},gt={class:"text-xs text-blue-600"},xt={class:"flex gap-4"},ht={class:"font-bold"},kt={key:0,class:"text-green-600"},wt={class:"pt-10"},jt={key:0,class:"print:hidden"},At={class:""},Ct={class:"text-xs text-blue-600"},St={class:"flex gap-4"},Lt={class:"font-bold"},Rt={key:0,class:"text-green-600"},Bt={class:"flex flex-col pt-10"},Nt={key:0,class:"print:hidden"},$t={class:""},Ft={class:"text-xs text-blue-600"},Vt={class:"flex gap-4"},Dt={class:"font-bold"},Mt={key:0,class:"text-green-600"},Tt={key:0,class:"modal-bg"},It={class:"modal-card"},Et={class:"flex justify-end gap-2 mt-4"},Gt={__name:"ShortLeaveShow",setup(Wt){const De=Oe(),v=Ke(),u=Qe(),p=Ee(),g=y(!0),c=y(!1),m=y(""),s=We(()=>u.shortLeave);Pe(async()=>{const{id:r}=v.params;try{await u.fetchShortLeaveById(r)}catch(e){console.error("Failed to fetch short leave details:",e)}finally{g.value=!1}});const Me=async()=>{try{await u.rejectShortLeave(v.params.id,m.value),alert("Short leave rejected successfully!"),c.value=!1,m.value="",await u.fetchShortLeaveById(v.params.id)}catch(r){console.error("Failed to reject short leave:",r),alert("Failed to reject short leave.")}},f=()=>{c.value=!0},_=async r=>{try{const{id:e}=v.params;r==="handover"&&await u.handoverAccept(e),r==="inCharge"&&await u.inChargeAccept(e),r==="recommend"&&await u.recommendByAccept(e),r==="approve"&&await u.approvedByAccept(e),alert(`${r} accepted successfully!`),await u.fetchShortLeaveById(e)}catch(e){console.error(`Failed to accept ${r}:`,e),alert(`Failed to accept ${r}.`)}},Te=()=>De.go(-1);function Ie(){window.print()}return(r,e)=>{var x,h,k,w,j,A,C,S,L,R,B,N,$,F,V,D,M,T,I,E,W,P,z,H,U,q,G,J,K,O,Q,X,Y,Z,ee,te,se,le,oe,ae,ne,re,de,ue,ie,ve,pe,ce,me,_e,be,fe,ye,ge,xe,he,ke,we,je,Ae,Ce,Se,Le,Re,Be,Ne,$e,Fe,Ve;return a(),n(Je,null,[t("div",Ze,[t("div",{class:"flex items-center justify-between gap-2 print:hidden"},[t("button",{class:"btn-3",onClick:Te},e[6]||(e[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[8]||(e[8]=t("h1",{class:"title-lg flex-wrap text-center"},"Short Leave Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:Ie},e[7]||(e[7]=[t("i",{class:"far fa-print"},null,-1),o(" Print ")]))])]),g.value?(a(),ze(Xe,{key:0})):(a(),n("div",et,[t("div",null,l((x=s.value)==null?void 0:x.user.company.name),1),e[37]||(e[37]=t("h2",{class:"title-md"},"Short Leave Application",-1)),t("div",tt,[t("div",st,[t("div",null,[e[9]||(e[9]=t("b",null,"Date:",-1)),o(" "+l((h=s.value)==null?void 0:h.date),1)]),t("div",null,[e[10]||(e[10]=t("b",null,"Start Time:",-1)),o(" "+l((k=s.value)==null?void 0:k.start_time),1)]),t("div",null,[e[11]||(e[11]=t("b",null,"End Time:",-1)),o(" "+l((w=s.value)==null?void 0:w.end_time),1)]),t("div",null,[e[12]||(e[12]=t("b",null,"Total Minutes:",-1)),o(" "+l((j=s.value)==null?void 0:j.total_minutes),1)]),t("div",null,[e[13]||(e[13]=t("b",null,"Reason:",-1)),o(" "+l(((A=s.value)==null?void 0:A.reason)||"N/A"),1)])]),t("div",lt,[t("div",ot,[e[14]||(e[14]=t("hr",{class:"w-44 border-black"},null,-1)),e[15]||(e[15]=t("div",null,[t("b",null,"Applicant")],-1)),t("p",at,l((C=s.value)==null?void 0:C.user.name),1),t("div",nt,[t("p",null,l((R=(L=(S=s.value)==null?void 0:S.user)==null?void 0:L.department)==null?void 0:R.name),1),t("p",null,l(($=(N=(B=s.value)==null?void 0:B.user)==null?void 0:N.designation)==null?void 0:$.title),1)])]),t("div",null,[t("p",null,l(((V=(F=s.value)==null?void 0:F.handover_user)==null?void 0:V.name)||"Not assigned"),1),!((D=s.value)!=null&&D.status)&&s.value.handover_user_id===b(p).user.id?(a(),n("div",rt,[t("p",dt,[o(l((T=(M=s.value)==null?void 0:M.user)==null?void 0:T.name)+" has assigned you for his handover. ",1),e[16]||(e[16]=t("br",null,null,-1)),e[17]||(e[17]=o(" Do you agree? "))]),t("div",ut,[t("button",{class:"font-bold text-lg text-green-600 px-2",onClick:e[0]||(e[0]=i=>_("handover"))}," ✔ "),e[18]||(e[18]=t("button",{class:"px-2"},"❌",-1))])])):d("",!0),e[21]||(e[21]=t("hr",{class:"w-44 border-black"},null,-1)),t("h4",it,[e[20]||(e[20]=o(" Handover ")),(I=s.value)!=null&&I.handover_user_id&&((E=s.value)!=null&&E.status)?(a(),n("span",vt," (✔) ")):d("",!0),(W=s.value)!=null&&W.handover_user_id&&!((P=s.value)!=null&&P.status)?(a(),n("span",pt,e[19]||(e[19]=[t("i",{class:"fad fa-spinner"},null,-1)]))):d("",!0)])])])]),e[38]||(e[38]=t("hr",null,null,-1)),t("div",null,[t("h3",ct,[e[22]||(e[22]=o(" Approvals ")),t("span",{class:He({"text-yellow-500":((z=s.value)==null?void 0:z.status)==="Pending","text-green-500":((H=s.value)==null?void 0:H.status)==="Approved","text-red-500":((U=s.value)==null?void 0:U.status)==="Rejected"})}," ("+l(((q=s.value)==null?void 0:q.status)||"N/A")+") ",3)]),((G=s.value)==null?void 0:G.status)==="Rejected"?(a(),n("div",mt,[t("div",null,[e[23]||(e[23]=t("b",null,"Rejected By:",-1)),o(" "+l(((K=(J=s.value)==null?void 0:J.rejected_by_user)==null?void 0:K.name)||"N/A"),1)]),t("div",null,[e[24]||(e[24]=t("b",null,"Rejection Reason:",-1)),o(" "+l(((O=s.value)==null?void 0:O.rejection_reason)||"N/A"),1)])])):d("",!0)]),t("div",_t,[t("div",bt,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((Q=s.value)!=null&&Q.in_charge_user_id)&&((Z=(Y=(X=s.value)==null?void 0:X.user)==null?void 0:Y.other_approval)==null?void 0:Z.in_charge_user_id)===b(p).user.id?(a(),n("div",ft,[t("p",yt,l(((le=(se=(te=(ee=s.value)==null?void 0:ee.user)==null?void 0:te.other_approval)==null?void 0:se.in_charge_user)==null?void 0:le.name)||"N/A"),1),t("p",gt,[o(l((ae=(oe=s.value)==null?void 0:oe.user)==null?void 0:ae.name)+" has submitted an application. ",1),e[25]||(e[25]=t("br",null,null,-1)),e[26]||(e[26]=o(" Will you forward it? "))]),t("div",xt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=i=>_("inCharge"))}," ✔ "),t("button",{class:"",onClick:f},"❌")])])):d("",!0),t("p",null,l(((re=(ne=s.value)==null?void 0:ne.in_charge_user)==null?void 0:re.name)||""),1),e[28]||(e[28]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",ht,[e[27]||(e[27]=o(" In-Charge ")),(de=s.value)!=null&&de.in_charge_user_id?(a(),n("span",kt,"(✔)")):d("",!0)])]),t("div",wt,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ue=s.value)!=null&&ue.recommend_by_user_id)&&((pe=(ve=(ie=s.value)==null?void 0:ie.user)==null?void 0:ve.other_approval)==null?void 0:pe.recommend_by_user_id)===b(p).user.id?(a(),n("div",jt,[t("p",At,l(((be=(_e=(me=(ce=s.value)==null?void 0:ce.user)==null?void 0:me.other_approval)==null?void 0:_e.recommend_by_user)==null?void 0:be.name)||"N/A"),1),t("p",Ct,[o(l((ye=(fe=s.value)==null?void 0:fe.user)==null?void 0:ye.name)+" has submitted an application.",1),e[29]||(e[29]=t("br",null,null,-1)),e[30]||(e[30]=o(" Will you recommend it? "))]),t("div",St,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=i=>_("recommend"))}," ✔ "),t("button",{class:"",onClick:f},"❌")])])):d("",!0),t("p",null,l(((xe=(ge=s.value)==null?void 0:ge.recommend_by_user)==null?void 0:xe.name)||""),1),e[32]||(e[32]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Lt,[e[31]||(e[31]=o(" Recommend By ")),(he=s.value)!=null&&he.recommend_by_user_id?(a(),n("span",Rt,"(✔)")):d("",!0)])])]),t("div",Bt,[s.value.status!=="Rejected"&&s.value.status!=="Approved"&&!((ke=s.value)!=null&&ke.approved_by_user_id)&&((Ae=(je=(we=s.value)==null?void 0:we.user)==null?void 0:je.other_approval)==null?void 0:Ae.approved_by_user_id)===b(p).user.id?(a(),n("div",Nt,[t("p",$t,l(((Re=(Le=(Se=(Ce=s.value)==null?void 0:Ce.user)==null?void 0:Se.other_approval)==null?void 0:Le.approved_by_user)==null?void 0:Re.name)||"N/A"),1),t("p",Ft,[o(l((Ne=(Be=s.value)==null?void 0:Be.user)==null?void 0:Ne.name)+" has submitted an application.",1),e[33]||(e[33]=t("br",null,null,-1)),e[34]||(e[34]=o(" Will you accept it? "))]),t("div",Vt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[3]||(e[3]=i=>_("approve"))}," ✔ "),t("button",{class:"",onClick:f},"❌")])])):d("",!0),t("p",null,l(((Fe=($e=s.value)==null?void 0:$e.approved_by_user)==null?void 0:Fe.name)||""),1),e[36]||(e[36]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",Dt,[e[35]||(e[35]=o(" Approved By ")),(Ve=s.value)!=null&&Ve.approved_by_user_id?(a(),n("span",Mt,"(✔)")):d("",!0)])])])),Ue(Ye)]),c.value?(a(),n("div",Tt,[t("div",It,[e[39]||(e[39]=t("h3",{class:"title-lg"},"Reject Short Leave",-1)),qe(t("textarea",{"onUpdate:modelValue":e[4]||(e[4]=i=>m.value=i),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[Ge,m.value]]),t("div",Et,[t("button",{class:"btn-3",onClick:e[5]||(e[5]=i=>c.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:Me},"Confirm")])])])):d("",!0)],64)}}};export{Gt as default};
