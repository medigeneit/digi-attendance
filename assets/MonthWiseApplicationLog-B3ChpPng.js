import{u as P,b as W,r as O,m as E,A as R,e as z,n as J,c,o as i,a as e,g as K,f as Q,h as X,v as Y,p as f,F as g,y as v,x as t,t as o,i as L,j as C,k as A}from"./index-D6iC7rwH.js";import{_ as Z}from"./EmployeeFilter-CyGkUbG1.js";import{L as ee}from"./LoaderView-Bw0cq5KP.js";import{_ as B}from"./DisplayFormattedWorkingHours-DHVruhIP.js";import{S as te}from"./SelectedEmployeeCard-ByrkmMgp.js";import{u as se}from"./leave-application-zZ2AzoM9.js";import{u as ae}from"./user-BA9-UOg0.js";import"./company-CaNFWHcq.js";import"./department-DqwK8h_U.js";import"./EmployeeDropdownInput-hHdZv0_2.js";import"./SelectDropdown-CepdAiVY.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-CuDalE-S.js";const le={class:"px-4 space-y-4"},ne={class:"flex flex-wrap items-center justify-between gap-3"},oe={class:"flex items-center gap-2"},re={class:"rounded-xl border bg-white p-3 md:p-4"},ie={key:0,class:"flex"},ce={key:2,class:"rounded-xl border bg-white p-10 text-center"},de={key:3,class:"space-y-4"},ue={class:"flex flex-wrap items-center gap-2"},pe=["onClick"],he={class:"inline-flex h-5 min-w-5 items-center justify-center rounded-full bg-black/5 px-1 text-[12px] font-semibold"},fe={class:"rounded-xl border bg-white overflow-hidden"},ye={class:"border-b bg-slate-50 px-4 py-2.5 text-sm font-semibold text-slate-800"},_e={key:0,class:"overflow-x-auto"},xe={key:1,class:"overflow-x-auto"},me={key:2,class:"overflow-x-auto"},ge={class:"sticky top-0 bg-white/90 backdrop-blur border-b"},ve={class:"text-xs uppercase text-slate-600"},be=["href"],ke={key:1,class:"text-slate-400"},we={key:3,class:"overflow-x-auto"},Se={class:"sticky top-0 bg-white/90 backdrop-blur border-b"},Le={class:"text-xs uppercase text-slate-600"},Ce={key:4,class:"overflow-x-auto"},Ae={class:"sticky top-0 bg-white/90 backdrop-blur border-b"},De={class:"text-xs uppercase text-slate-600"},qe={key:5,class:"p-6 text-center text-slate-500"},D="min-w-full text-sm",l="px-3 py-2 text-left font-semibold text-slate-700 whitespace-nowrap",n="px-3 py-2 align-top text-slate-700",Ie={__name:"MonthWiseApplicationLog",setup(Oe){var $;const b=P(),h=W(),T=ae(),y=se(),k=O(null),_=O(h.query.date||y.selectedMonth||new Date().toISOString().slice(0,7)),d=O({company_id:h.query.company_id||"",department_id:h.query.department_id||"all",line_type:h.query.line_type||"all",employee_id:h.query.employee_id||"",category:""}),U={overtime:"Overtime",leave_application:"Leave Applications",short_leave:"Short Leave",exchange_offday:"Exchange Offday",exchange_shift:"Exchange Shift",manual_attendance:"Manual Attendance"},H=["overtime","leave_application","short_leave","exchange_offday","exchange_shift","manual_attendance"],q=E(()=>{const r=y.applicationLog||{};return H.filter(a=>Array.isArray(r[a])&&r[a].length).map(a=>({key:a,label:U[a]||a,count:r[a].length}))}),u=O(h.query.group||(($=q.value[0])==null?void 0:$.key)||null);R(q,r=>{if(!r.length){u.value=null;return}r.find(a=>a.key===u.value)||(u.value=r[0].key)}),R(u,r=>{b.replace({query:{...h.query,group:r||void 0}})});const j=E(()=>y.loading),V=async r=>{r?(await T.fetchUser(r),k.value=T.user):k.value=null},x=async()=>{d.value.employee_id&&_.value&&await y.getMonthlyApplicationLog(d.value.employee_id,_.value)};z(async()=>{d.value.employee_id&&await V(d.value.employee_id),d.value.employee_id&&_.value&&await x()}),R(()=>d.value.employee_id,async r=>{r?(await V(r),_.value&&await x(),b.replace({query:{...h.query,employee_id:r}})):k.value=null},{immediate:!0}),R(_,r=>{b.replace({query:{...h.query,date:r}}),d.value.employee_id&&r&&x()},{immediate:!0});const G=()=>b.go(-1),M=r=>r?new Date(r).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A",N=r=>r?new Date(`1970-01-01T${r}`).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A",m=r=>r?new Date(r).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"",F=()=>{b.replace({query:{...h.query,company_id:d.value.company_id,department_id:d.value.department_id,line_type:d.value.line_type,employee_id:d.value.employee_id}}),d.value.employee_id&&_.value&&x()},I={exchange_shift:"ExchangeShiftShow",exchange_offday:"ExchangeOffdayShow"},w=r=>{const a=(r||"").toLowerCase();return a==="approved"||a==="success"?"bg-emerald-50 text-emerald-700 ring-1 ring-emerald-200":a==="rejected"||a==="declined"?"bg-rose-50 text-rose-700 ring-1 ring-rose-200":a==="pending"?"bg-amber-50 text-amber-700 ring-1 ring-amber-200":a==="processing"||a==="reviewing"?"bg-blue-50 text-blue-700 ring-1 ring-blue-200":"bg-slate-100 text-slate-700 ring-1 ring-slate-200"};return(r,a)=>{const S=J("RouterLink");return i(),c("div",le,[e("div",ne,[e("button",{class:"inline-flex items-center gap-2 rounded-lg border px-3 py-1.5 hover:bg-slate-50",onClick:G},a[5]||(a[5]=[e("i",{class:"far fa-arrow-left"},null,-1),e("span",{class:"hidden md:inline"},"Back",-1)])),a[7]||(a[7]=e("h1",{class:"text-xl md:text-2xl font-semibold tracking-tight text-slate-800"}," Monthly Application Log ",-1)),e("div",oe,[X(e("input",{id:"monthSelect",type:"month","onUpdate:modelValue":a[0]||(a[0]=s=>_.value=s),onChange:x,class:"input-1 py-1 rounded-lg border-slate-300"},null,544),[[Y,_.value]]),e("button",{class:"btn-2",onClick:x},a[6]||(a[6]=[e("i",{class:"far fa-rotate-right"},null,-1),e("span",{class:"hidden md:inline"},"Refresh",-1)]))])]),e("div",re,[f(Z,{company_id:d.value.company_id,"onUpdate:company_id":a[1]||(a[1]=s=>d.value.company_id=s),department_id:d.value.department_id,"onUpdate:department_id":a[2]||(a[2]=s=>d.value.department_id=s),employee_id:d.value.employee_id,"onUpdate:employee_id":a[3]||(a[3]=s=>d.value.employee_id=s),line_type:d.value.line_type,"onUpdate:line_type":a[4]||(a[4]=s=>d.value.line_type=s),"with-type":!0,"initial-value":r.$route.query,onFilterChange:F},null,8,["company_id","department_id","employee_id","line_type","initial-value"])]),k.value?(i(),c("div",ie,[f(te,{user:k.value},null,8,["user"])])):K("",!0),j.value?(i(),Q(ee,{key:1})):q.value.length?(i(),c("div",de,[e("div",ue,[(i(!0),c(g,null,v(q.value,s=>(i(),c("button",{key:s.key,type:"button",onClick:p=>u.value=s.key,class:t(["inline-flex items-center gap-2 rounded-full border px-3 py-1.5 text-sm",u.value===s.key?"border-emerald-600 text-emerald-700 bg-emerald-50":"border-slate-200 text-slate-700 hover:bg-slate-50"])},[e("span",null,o(s.label),1),e("span",he,o(s.count),1)],10,pe))),128))]),e("div",fe,[e("div",ye,o(U[u.value]||u.value),1),u.value==="overtime"?(i(),c("div",_e,[e("table",{class:t(D)},[e("thead",{class:"sticky top-0 bg-white/90 backdrop-blur border-b"},[e("tr",{class:"text-xs uppercase text-slate-600"},[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Date"),e("th",{class:t(l)},"Type"),e("th",{class:t(l)},"Shift"),e("th",{class:t(l)},"Check-In"),e("th",{class:t(l)},"Check-Out"),e("th",{class:t(l)},"Working"),e("th",{class:t(l)},"Request"),e("th",{class:t(l)},"Approved"),e("th",{class:t(l)},"Details"),e("th",{class:t(l)},"Status"),e("th",{class:t(l)},"Action")])]),e("tbody",null,[(i(!0),c(g,null,v(A(y).applicationLog.overtime,(s,p)=>(i(),c("tr",{key:`ot-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},o(p+1),1),e("td",{class:t(n)},o(m(s.date)),1),e("td",{class:t(n)},o(s.duty_type),1),e("td",{class:t(n)},o(s.shift),1),e("td",{class:t(n)},o(s.check_in||"—"),1),e("td",{class:t(n)},o(s.check_out||"—"),1),e("td",{class:t(n)},[f(B,{workingHours:s.working_hours},null,8,["workingHours"])]),e("td",{class:t(n)},[f(B,{workingHours:s.request_overtime_hours},null,8,["workingHours"])]),e("td",{class:t(n)},[f(B,{workingHours:s.approval_overtime_hours},null,8,["workingHours"])]),e("td",{class:t(n)},o(s.work_details||""),1),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",w(s.status)])},o(s.status||"Pending"),3)]),e("td",{class:t(n+" text-right")},[f(S,{to:{name:"MyOvertimeShow",params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:L(()=>a[9]||(a[9]=[e("i",{class:"far fa-eye"},null,-1),C(" View ")])),_:2,__:[9]},1032,["to"])],2)]))),128))])])])):u.value==="leave_application"?(i(),c("div",xe,[e("table",{class:t(D)},[e("thead",{class:"sticky top-0 bg-white/90 backdrop-blur border-b"},[e("tr",{class:"text-xs uppercase text-slate-600"},[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Create Date"),e("th",{class:t(l)},"Last Working"),e("th",{class:t(l)},"Resumption"),e("th",{class:t(l)},"Type"),e("th",{class:t(l)},"Reason"),e("th",{class:t(l)},"Status"),e("th",{class:t(l)},"Action")])]),e("tbody",null,[(i(!0),c(g,null,v(A(y).applicationLog.leave_application,(s,p)=>(i(),c("tr",{key:`la-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},o(p+1),1),e("td",{class:t(n)},o(m(s.create_date)),1),e("td",{class:t(n)},o(s.from),1),e("td",{class:t(n)},o(s.to),1),e("td",{class:t([n,"whitespace-pre-line"])},o(s.application_types),1),e("td",{class:t([n,"whitespace-pre-line"])},o(s.reason),1),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",w(s.status)])},o(s.status),3)]),e("td",{class:t(n+" text-right")},[f(S,{to:{name:"LeaveApplicationShow",params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:L(()=>a[10]||(a[10]=[e("i",{class:"far fa-eye"},null,-1),C(" View ")])),_:2,__:[10]},1032,["to"])],2)]))),128))])])])):u.value==="short_leave"?(i(),c("div",me,[e("table",{class:t(D)},[e("thead",ge,[e("tr",ve,[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Create Date"),e("th",{class:t(l)},"Type"),e("th",{class:t(l)},"Date"),e("th",{class:t(l)},"Check-In"),e("th",{class:t(l)},"Check-Out"),e("th",{class:t(l)},"Duration"),e("th",{class:t(l)},"Attachment"),e("th",{class:t(l)},"Status"),e("th",{class:t([l,"text-right"])},"Action")])]),e("tbody",null,[(i(!0),c(g,null,v(A(y).applicationLog.short_leave,(s,p)=>(i(),c("tr",{key:`sl-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},o(p+1),1),e("td",{class:t(n)},o(m(s.create_date)),1),e("td",{class:t(n)},o(s.application_types),1),e("td",{class:t(n)},o(s.date),1),e("td",{class:t(n)},o(N(s.start_time)),1),e("td",{class:t(n)},o(N(s.end_time)),1),e("td",{class:t(n)},o(s.duration)+" m",1),e("td",{class:t(n+" text-center")},[s.attachment?(i(),c("a",{key:0,href:s.attachment,target:"_blank",rel:"noopener",class:"text-emerald-700 hover:underline"},a[11]||(a[11]=[e("i",{class:"far fa-eye"},null,-1)]),8,be)):(i(),c("span",ke,"No file"))],2),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",w(s.status)])},o(s.status),3)]),e("td",{class:t(n+" text-right")},[f(S,{to:{name:"ShortLeaveShow",params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:L(()=>a[12]||(a[12]=[e("i",{class:"far fa-eye"},null,-1),C(" View ")])),_:2,__:[12]},1032,["to"])],2)]))),128))])])])):u.value==="exchange_offday"||u.value==="exchange_shift"?(i(),c("div",we,[e("table",{class:t(D)},[e("thead",Se,[e("tr",Le,[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Create Date"),e("th",{class:t(l)},"Current Date"),e("th",{class:t(l)},"Exchange Date"),e("th",{class:t(l)},"Shift"),e("th",{class:t(l)},"Status"),e("th",{class:t([l,"text-right"])},"Action")])]),e("tbody",null,[(i(!0),c(g,null,v(A(y).applicationLog[u.value],(s,p)=>(i(),c("tr",{key:`ex-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},o(p+1),1),e("td",{class:t(n)},o(m(s.create_date)),1),e("td",{class:t(n)},o(s.current_date),1),e("td",{class:t(n)},o(s.exchange_date),1),e("td",{class:t(n)},o((s==null?void 0:s.shift)||"N/A"),1),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",w(s.status)])},o(s.status),3)]),e("td",{class:t(n+" text-right")},[f(S,{to:{name:I[s.type],params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:L(()=>a[13]||(a[13]=[e("i",{class:"far fa-eye"},null,-1),C(" View ")])),_:2,__:[13]},1032,["to"])],2)]))),128))])])])):u.value==="manual_attendance"?(i(),c("div",Ce,[e("table",{class:t(D)},[e("thead",Ae,[e("tr",De,[e("th",{class:t(l)},"#"),e("th",{class:t(l)},"Create Date"),e("th",{class:t(l)},"Date"),e("th",{class:t(l)},"Type"),e("th",{class:t(l)},"Check-In"),e("th",{class:t(l)},"Check-Out"),e("th",{class:t(l)},"Status"),e("th",{class:t([l,"text-right"])},"Action")])]),e("tbody",null,[(i(!0),c(g,null,v(A(y).applicationLog.manual_attendance,(s,p)=>(i(),c("tr",{key:`ma-${s.id||p}`,class:"border-b hover:bg-slate-50"},[e("td",{class:t(n)},o(p+1),1),e("td",{class:t(n)},o(m(s.create_date)),1),e("td",{class:t(n)},o(m(s.check_in||s.check_out)),1),e("td",{class:t(n)},o(s.application_types),1),e("td",{class:t(n)},o(M(s.check_in)),1),e("td",{class:t(n)},o(M(s.check_out)),1),e("td",{class:t(n)},[e("span",{class:t(["inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ring-1",w(s.status)])},o(s.status),3)]),e("td",{class:t(n+" text-right")},[f(S,{to:{name:"ManualAttendanceShow",params:{id:s.id}},class:"inline-flex items-center gap-1 text-emerald-700 hover:underline"},{default:L(()=>a[14]||(a[14]=[e("i",{class:"far fa-eye"},null,-1),C(" View ")])),_:2,__:[14]},1032,["to"])],2)]))),128))])])])):(i(),c("div",qe," No data for this group. "))])])):(i(),c("div",ce,a[8]||(a[8]=[e("div",{class:"mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-emerald-50"},[e("i",{class:"far fa-clipboard-list text-emerald-600 text-xl"})],-1),e("h3",{class:"text-lg font-semibold text-slate-800"},"No applications found",-1),e("p",{class:"mt-1 text-sm text-slate-500"},"Choose an employee and month to view logs.",-1)])))])}}};export{Ie as default};
