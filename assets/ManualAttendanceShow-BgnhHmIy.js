import{u as Pe,r as Ve,p as Ie,b as ze,c as o,a as t,k as a,j as Ge,t as l,e as u,y as Oe,h as g,l as Ue,d as He,v as Je,F as Ke,f as Qe,o as n,g as Xe}from"./index-uPZZieZ2.js";import{u as Ye}from"./manual-attendance-De9L1TUx.js";import{L as Ze}from"./LoaderView-Bg77KPBJ.js";import{_ as et}from"./ShareComponent-_YCUNww5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const tt={class:"my-container max-w-3xl space-y-6"},st={key:1,class:"card-bg p-4 md:p-8"},lt={class:"grid md:grid-cols-2"},at={key:0},nt={key:1},ot={class:"pt-10"},rt={class:"font-medium"},ut={class:"text-sm"},dt={class:"title-md"},it={key:0},ct={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pt={class:"pt-10"},vt={key:0,class:"print:hidden"},mt={class:""},_t={class:"text-xs text-blue-600"},bt={class:"flex gap-4"},gt={class:"font-bold"},yt={key:0,class:"text-green-600"},ft={class:"pt-10"},kt={key:0,class:"print:hidden"},xt={class:""},At={class:"text-xs text-blue-600"},wt={class:"flex gap-4"},ht={class:"font-bold"},jt={key:0,class:"text-green-600"},Ct={class:"flex flex-col pt-10"},Mt={key:0,class:"print:hidden"},Rt={class:""},Bt={class:"text-xs text-blue-600"},Nt={class:"flex gap-4"},St={class:"font-bold"},Dt={key:0,class:"text-green-600"},$t={key:0,class:"modal-bg"},Ft={class:"modal-card"},Vt={class:"flex justify-end gap-2 mt-4"},Pt={__name:"ManualAttendanceShow",setup(It){const Le=Xe(),c=Qe(),d=Ye(),m=Pe(),p=Ve(!1),v=Ve(""),Te=Ie(()=>d.loading),s=Ie(()=>d.manualAttendance);ze(async()=>{const{id:r}=c.params;try{await d.fetchManualAttendanceById(r)}catch(e){console.error("Failed to fetch manual attendance details:",e)}});const qe=async()=>{try{await d.rejectManualAttendance(c.params.id,v.value),alert("Manual attendance rejected successfully!"),p.value=!1,v.value="",await d.fetchManualAttendanceById(c.params.id)}catch(r){console.error("Failed to reject manual attendance:",r),alert("Failed to reject manual attendance.")}},_=()=>{p.value=!0},b=async r=>{try{const{id:e}=c.params;r==="inCharge"&&await d.inChargeAccept(e),r==="recommend"&&await d.recommendByAccept(e),r==="approve"&&await d.approvedByAccept(e),alert(`${r} accepted successfully!`),await d.fetchManualAttendanceById(e)}catch(e){console.error(`Failed to accept ${r}:`,e),alert(`Failed to accept ${r}.`)}},We=()=>Le.go(-1);function Ee(){window.print()}return(r,e)=>{var y,f,k,x,A,w,h,j,C,M,R,B,N,S,D,$,F,V,I,L,T,q,W,E,P,z,G,O,U,H,J,K,Q,X,Y,Z,ee,te,se,le,ae,ne,oe,re,ue,de,ie,ce,pe,ve,me,_e,be,ge,ye,fe,ke,xe,Ae,we,he,je,Ce,Me,Re,Be,Ne,Se,De,$e,Fe;return n(),o(Ke,null,[t("div",tt,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:We},e[5]||(e[5]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[7]||(e[7]=t("h1",{class:"title-lg text-center"},"Manual Attendance Details",-1)),t("div",null,[t("button",{class:"btn-2",onClick:Ee},e[6]||(e[6]=[t("i",{class:"far fa-print"},null,-1),a(" Print ")]))])]),Te.value?(n(),Ge(Ze,{key:0})):(n(),o("div",st,[e[30]||(e[30]=t("h2",{class:"title-md"},"Manual Attendance Request",-1)),t("div",null,[t("div",lt,[t("div",null,[e[8]||(e[8]=t("b",null,"Date:",-1)),a(" "+l(new Date((y=s.value)==null?void 0:y.created_at).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})),1)]),(f=s.value)!=null&&f.check_in?(n(),o("div",at,[e[9]||(e[9]=t("b",null,"Check-In:",-1)),a(" "+l((k=s.value)!=null&&k.check_in?new Date(s.value.check_in).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"),1)])):u("",!0),(x=s.value)!=null&&x.check_out?(n(),o("div",nt,[e[10]||(e[10]=t("b",null,"Check-Out:",-1)),a(" "+l((A=s.value)!=null&&A.check_out?new Date(s.value.check_out).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"),1)])):u("",!0),t("div",null,[e[11]||(e[11]=t("b",null,"Type:",-1)),a(" "+l((w=s.value)==null?void 0:w.type),1)]),t("div",null,[e[12]||(e[12]=t("b",null,"Reason:",-1)),a(" "+l(((h=s.value)==null?void 0:h.description)||"N/A"),1)])]),t("div",ot,[t("div",null,[e[13]||(e[13]=t("hr",{class:"w-44 border-black"},null,-1)),e[14]||(e[14]=t("div",null,[t("b",null,"Applicant")],-1)),t("p",rt,l((j=s.value)==null?void 0:j.user.name),1),t("div",ut,[t("p",null,l((R=(M=(C=s.value)==null?void 0:C.user)==null?void 0:M.department)==null?void 0:R.name),1),t("p",null,l((S=(N=(B=s.value)==null?void 0:B.user)==null?void 0:N.designation)==null?void 0:S.title),1)])])])]),e[31]||(e[31]=t("hr",null,null,-1)),t("div",null,[t("h3",dt,[e[15]||(e[15]=a(" Approvals ")),t("span",{class:Oe({"text-yellow-500":((D=s.value)==null?void 0:D.status)==="Pending","text-green-500":(($=s.value)==null?void 0:$.status)==="Approved","text-red-500":((F=s.value)==null?void 0:F.status)==="Rejected"})}," ("+l(((V=s.value)==null?void 0:V.status)||"N/A")+") ",3)]),((I=s.value)==null?void 0:I.status)==="Rejected"?(n(),o("div",it,[t("div",null,[e[16]||(e[16]=t("b",null,"Rejected By:",-1)),a(" "+l(((T=(L=s.value)==null?void 0:L.rejected_by_user)==null?void 0:T.name)||"N/A"),1)]),t("div",null,[e[17]||(e[17]=t("b",null,"Rejection Reason:",-1)),a(" "+l(((q=s.value)==null?void 0:q.rejection_reason)||"N/A"),1)])])):u("",!0)]),t("div",ct,[t("div",pt,[((W=s.value)==null?void 0:W.status)!=="Rejected"&&((E=s.value)==null?void 0:E.status)!=="Approved"&&!((P=s.value)!=null&&P.in_charge_user_id)&&((O=(G=(z=s.value)==null?void 0:z.user)==null?void 0:G.other_approval)==null?void 0:O.in_charge_user_id)===((H=(U=g(m))==null?void 0:U.user)==null?void 0:H.id)?(n(),o("div",vt,[t("p",mt,l(((X=(Q=(K=(J=s.value)==null?void 0:J.user)==null?void 0:K.other_approval)==null?void 0:Q.in_charge_user)==null?void 0:X.name)||"N/A"),1),t("p",_t,[a(l((Z=(Y=s.value)==null?void 0:Y.user)==null?void 0:Z.name)+' has submitted an "attendance request". ',1),e[18]||(e[18]=t("br",null,null,-1)),e[19]||(e[19]=a(" Will you forward it? "))]),t("div",bt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[0]||(e[0]=i=>b("inCharge"))}," ✔ "),t("button",{class:"",onClick:_},"❌")])])):u("",!0),t("p",null,l(((te=(ee=s.value)==null?void 0:ee.in_charge_user)==null?void 0:te.name)||""),1),e[21]||(e[21]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",gt,[e[20]||(e[20]=a(" In-Charge ")),(se=s.value)!=null&&se.in_charge_user_id?(n(),o("span",yt,"(✔)")):u("",!0)])]),t("div",ft,[((le=s.value)==null?void 0:le.status)!=="Rejected"&&((ae=s.value)==null?void 0:ae.status)!=="Approved"&&!((ne=s.value)!=null&&ne.recommend_by_user_id)&&((ue=(re=(oe=s.value)==null?void 0:oe.user)==null?void 0:re.other_approval)==null?void 0:ue.recommend_by_user_id)===((de=g(m).user)==null?void 0:de.id)?(n(),o("div",kt,[t("p",xt,l(((ve=(pe=(ce=(ie=s.value)==null?void 0:ie.user)==null?void 0:ce.other_approval)==null?void 0:pe.recommend_by_user)==null?void 0:ve.name)||"N/A"),1),t("p",At,[a(l((_e=(me=s.value)==null?void 0:me.user)==null?void 0:_e.name)+' has submitted an "attendance request".',1),e[22]||(e[22]=t("br",null,null,-1)),e[23]||(e[23]=a(" Will you recommend it? "))]),t("div",wt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[1]||(e[1]=i=>b("recommend"))}," ✔ "),t("button",{class:"",onClick:_},"❌")])])):u("",!0),t("p",null,l(((ge=(be=s.value)==null?void 0:be.recommend_by_user)==null?void 0:ge.name)||""),1),e[25]||(e[25]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",ht,[e[24]||(e[24]=a(" Recommend By ")),(ye=s.value)!=null&&ye.recommend_by_user_id?(n(),o("span",jt,"(✔)")):u("",!0)])])]),t("div",Ct,[((fe=s.value)==null?void 0:fe.status)!=="Rejected"&&((ke=s.value)==null?void 0:ke.status)!=="Approved"&&!((xe=s.value)!=null&&xe.approved_by_user_id)&&((he=(we=(Ae=s.value)==null?void 0:Ae.user)==null?void 0:we.other_approval)==null?void 0:he.approved_by_user_id)===((je=g(m).user)==null?void 0:je.id)?(n(),o("div",Mt,[t("p",Rt,l(((Be=(Re=(Me=(Ce=s.value)==null?void 0:Ce.user)==null?void 0:Me.other_approval)==null?void 0:Re.approved_by_user)==null?void 0:Be.name)||"N/A"),1),t("p",Bt,[a(l((Se=(Ne=s.value)==null?void 0:Ne.user)==null?void 0:Se.name)+' has submitted an "attendance request".',1),e[26]||(e[26]=t("br",null,null,-1)),e[27]||(e[27]=a(" Will you accept it? "))]),t("div",Nt,[t("button",{class:"font-bold text-lg text-green-600",onClick:e[2]||(e[2]=i=>b("approve"))}," ✔ "),t("button",{class:"",onClick:_},"❌")])])):u("",!0),t("p",null,l((($e=(De=s.value)==null?void 0:De.approved_by_user)==null?void 0:$e.name)||""),1),e[29]||(e[29]=t("hr",{class:"w-44 border-black"},null,-1)),t("p",St,[e[28]||(e[28]=a(" Approved By ")),(Fe=s.value)!=null&&Fe.approved_by_user_id?(n(),o("span",Dt,"(✔)")):u("",!0)])])])),Ue(et)]),p.value?(n(),o("div",$t,[t("div",Ft,[e[32]||(e[32]=t("h3",{class:"title-lg"},"Reject Manual Attendance",-1)),He(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=i=>v.value=i),rows:"4",placeholder:"Enter rejection reason...",class:"w-full border rounded-lg p-2 text-gray-700"},null,512),[[Je,v.value]]),t("div",Vt,[t("button",{class:"btn-3",onClick:e[4]||(e[4]=i=>p.value=!1)},"Cancel"),t("button",{class:"btn-2 bg-red-500 text-white",onClick:qe},"Confirm")])])])):u("",!0)],64)}}};export{Pt as default};
