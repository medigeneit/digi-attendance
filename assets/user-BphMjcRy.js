import{B as x,r as u,x as v,C as l}from"./index-BoadJ9GY.js";const q=x("user",()=>{const o=u([]),y=u([]),h=u([]),f=u([]),i=u({}),p=u({}),m=u({}),r=u(null),n=u(!1),w=u(new Date().toISOString().substring(0,10)),U=v(()=>o.value),b=v(()=>i.value),S=v(()=>r.value),g=async(s={})=>{var e,a;try{n.value=!0;const t=await l.get("/users",{params:s});o.value=t.data,r.value=null}catch(t){r.value=((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}finally{n.value=!1}};return{users:o,handoverUsers:f,user:i,error:r,isLoading:n,allUsers:U,userLeaveTypes:h,userLeaveBalance:y,singleUser:b,errorMessage:S,dashboardInfo:m,userDashboard:p,selectedDate:w,fetchUsers:g,fetchUser:async s=>{var e,a;try{n.value=!0;const c=(await l.get(`/users/${s}`)).data;return c&&(i.value=c),r.value=null,c}catch(t){r.value=((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}finally{n.value=!1}},createUser:async s=>{var e,a;try{n.value=!0;const t=await l.post("/users",s);o.value.push(t.data.user),r.value=null}catch(t){r.value=((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}finally{n.value=!1}},updateUser:async(s,e)=>{var a,t;try{n.value=!0;const c=await l.put(`/users/${s}`,e),d=o.value.findIndex(D=>D.id===s);return d!==-1&&(o.value[d]=c.data.user),r.value=null,c.data.user}catch(c){r.value=((t=(a=c.response)==null?void 0:a.data)==null?void 0:t.message)||"Something went wrong"}finally{n.value=!1}},deleteUser:async s=>{var e,a;try{n.value=!0,await l.delete(`/users/${s}`),o.value=o.value.filter(t=>t.id!==s),r.value=null}catch(t){r.value=((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}finally{n.value=!1}},fetchUserDashboardData:async()=>{var s,e;try{n.value=!0;const t=(await l.get("/dashboard")).data;return t&&(p.value=t),r.value=null,t}catch(a){r.value=((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchAdminDashboardData:async()=>{var s,e;try{n.value=!0;const t=(await l.get("/admin-dashboard")).data;return t&&(m.value=t),r.value=null,t}catch(a){r.value=((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchTypeWiseEmployees:async(s={})=>{var e,a;try{n.value=!0;const t=await l.get("/type-wise-employees",{params:s});o.value=t.data,r.value=null}catch(t){r.value=((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}finally{n.value=!1}},fetchDepartmentWiseEmployees:async()=>{var s,e;try{n.value=!0;const a=await l.get("/department-wise-employees");return o.value=a.data,r.value=null,o.value}catch(a){r.value=((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchHandoverDepartmentWiseEmployees:async()=>{var s,e;try{n.value=!0;const a=await l.get("/department-handover-wise-employees");f.value=a.data,r.value=null}catch(a){r.value=((e=(s=a.response)==null?void 0:s.data)==null?void 0:e.message)||"Something went wrong"}finally{n.value=!1}},fetchUsersExcelExport:async s=>{var e,a;try{n.value=!0;const t=await l.get("/users",{params:{flag:"excel",company_id:s.data.company_id,department_id:s.data.department_id,line_type:s.data.line_type,status:s.data.status},responseType:"blob"}),c=window.URL.createObjectURL(new Blob([t.data])),d=document.createElement("a");d.href=c,d.setAttribute("download","users.xlsx"),document.body.appendChild(d),d.click(),d.remove(),r.value=null}catch(t){r.value=((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}finally{n.value=!1}},saveLeaveBalances:async(s,e)=>{try{return n.value=!0,(await l.post(`/leave-balances/${s}`,{balances:e})).data}catch(a){throw console.error("Failed to save leave balances:",a),a}finally{n.value=!1}},fetchUserLeaveBalances:async(s,e=null)=>{try{const a={};typeof e=="number"||typeof e=="string"?a.year=e:(e!=null&&e.type&&(a.type=e.type),e!=null&&e.applicationId&&(a.context_application_id=e.applicationId),e!=null&&e.year&&(a.year=e.year));const t=await l.get(`/user-leave-balance/${s}`,{params:a});return y.value=t.data,t.data}catch(a){console.error("Failed to fetch balances",a)}},fetchUserLeaveTypes:async s=>{try{const e=await l.get(`/leave-balances/${s}`);return h.value=e.data,e.data}catch(e){console.error("Failed to fetch balances",e)}},updateOrCreateWeekend:async(s,e)=>{var a,t;try{const c=await l.post(`/employee/weekend/update-or-create/${s}`,{selected_weekend:e});return g(),c.data.message}catch(c){throw new Error(((t=(a=c.response)==null?void 0:a.data)==null?void 0:t.message)||c.message)}},fetchUserWeekends:async s=>{var e,a;try{const t=await l.get(`/employee/weekends/${s}`);return(t==null?void 0:t.data)??t}catch(t){r.value=((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}},fetchUserShifts:async s=>{var e,a;try{const t=await l.get(`/employee/${s}/shift-history`);return(t==null?void 0:t.data)??t}catch(t){r.value=((a=(e=t.response)==null?void 0:e.data)==null?void 0:a.message)||"Something went wrong"}}}});export{q as u};
