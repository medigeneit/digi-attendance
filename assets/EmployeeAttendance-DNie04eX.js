import{m as Z,c as l,o as n,a as t,t as a,x,u as ee,b as te,r as S,z as K,n as se,f as v,p as h,k as c,h as ae,v as re,j as r,i as _,F as g,q as ne,g as u}from"./index-B2fpbbf-.js";import{_ as le}from"./EmployeeFilter-DQN1to8_.js";import{L as ie}from"./LoaderView-BWHTz2yf.js";import{u as de}from"./attendance-ox_D5JEn.js";import{u as oe}from"./user-DtZ2p-Sf.js";import"./MultiselectDropdown-OYOnTbJP.js";import"./company-OOMZBDRm.js";import"./department-D8OlIQEc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"flex items-center gap-2"},pe="flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium border transition-all",ce={__name:"StatusBadge",props:{status:{type:String,required:!0},isApproved:{type:Boolean,default:!1}},setup(k){var w;const b=k,d=((w=b.status)==null?void 0:w.toLowerCase())??"",o=Z(()=>{switch(d){case"present":return{iconClass:"fas fa-check-circle",label:"Present",classes:"bg-emerald-50 text-emerald-700 border-emerald-200"};case"absent":return{iconClass:"fas fa-times-circle",label:"Absent",classes:"bg-red-50 text-red-700 border-red-200"};case"weekend":return{iconClass:"fas fa-calendar-alt",label:"Weekend",classes:"bg-purple-50 text-purple-700 border-purple-200"};case"eid":return{iconClass:"fas fa-coffee",label:"EID",classes:"bg-amber-50 text-amber-700 border-amber-200"};case"sl":return{iconClass:"fas fa-exclamation-circle",label:"Special Leave",classes:"bg-blue-50 text-blue-700 border-blue-200"};case"cl":return{iconClass:"fas fa-plane-departure",label:"Casual Leave",classes:"bg-cyan-50 text-cyan-700 border-cyan-200"};case"ml":return{iconClass:"fas fa-baby",label:"Medical Leave",classes:"bg-pink-50 text-pink-700 border-pink-200"};case"wpl":return{iconClass:"fas fa-user-slash",label:"Without Pay Leave",classes:"bg-yellow-50 text-yellow-700 border-yellow-200"};default:return d.startsWith("holiday")?{iconClass:"fas fa-umbrella-beach",label:b.status,classes:"bg-lime-50 text-lime-700 border-lime-200"}:{iconClass:"fas fa-question-circle",label:b.status,classes:"bg-gray-50 text-gray-700 border-gray-200"}}});return(i,f)=>(n(),l("div",ue,[t("div",{class:x([pe,o.value.classes])},a(k.status),3)]))}},_e={class:"px-4 space-y-4"},me={class:"w-full flex flex-wrap gap-4 items-center md:w-auto"},ye={key:0,class:"grid md:grid-cols-2 gap-4 text-sm"},xe={class:"card-bg p-4 gap-1"},be={class:"grid md:grid-cols-2"},ve={class:"card-bg p-4 gap-1"},fe={class:"flex justify-between items-center"},he={class:"grid md:grid-cols-2"},we={key:1},ke={key:3,class:"space-y-4"},Ae={class:"overflow-x-auto card-bg"},Se={class:"min-w-full table-auto border-collapse border border-gray-300 bg-white"},ge={class:"text-center text-xs"},Ce={class:"border px-1 py-0.5"},Le={class:"border px-1 py-0.5"},De=["title"],qe={class:"flex flex-col gap-1"},Ee={class:"font-semibold text-gray-800"},je={key:0,class:"text-xs"},Me=["title"],Ne={key:0,class:"font-semibold"},Pe=["title"],We={class:"border px-1 py-0.5"},Be={class:"border px-1 py-0.5"},Re={key:2,class:"bg-red-100 text-red-700 px-2 py-1 rounded text-xs font-semibold"},Te={key:3},Ve={class:"border px-1 py-0.5"},He={class:"border px-1 py-0.5"},Oe={key:0},$e={class:"border px-1 py-0.5"},Ue={key:0},Fe={class:"border py-0.5"},Ie={class:"flex justify-center items-center gap-1"},ze={key:0,class:"flex items-center gap-2"},Je={key:1,class:"flex items-center gap-2"},at={__name:"EmployeeAttendance",setup(k){const b=ee(),d=te(),o=de(),w=oe(),i=S(null),f=S(d.query.date||o.selectedMonth),m=S({company_id:d.query.company_id||"",department_id:d.query.department_id||"all",type:d.query.type||"all",employee_id:d.query.employee_id||"",category:""}),Q=async y=>{y?(await w.fetchUser(y),i.value=w.user):i.value=null},A=async()=>{m.value.employee_id&&f.value&&await o.getMonthlyAttendanceByShift(m.value.employee_id,f.value)};K(f,y=>{b.replace({query:{...d.query,date:y}}),A()}),K(()=>m.value.employee_id,async(y,s)=>{y&&y!==s&&(await Q(y),await A())});const X=()=>b.go(-1),Y=()=>{b.replace({query:{...d.query,company_id:m.value.company_id,department_id:m.value.department_id,type:m.value.type,employee_id:m.value.employee_id}})};return(y,s)=>{var C,L,D,q,E,j,M,N,P,W,B,R,T,V,H,O;const p=se("router-link");return n(),l("div",_e,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:X},s[2]||(s[2]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),s[3]||(s[3]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Monthly Attendance",-1)),s[4]||(s[4]=t("div",null,null,-1))]),t("div",me,[h(le,{modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=e=>m.value=e),"initial-value":c(d).query,onFilterChange:Y},null,8,["modelValue","initial-value"]),t("div",null,[ae(t("input",{id:"monthSelect",type:"month","onUpdate:modelValue":s[1]||(s[1]=e=>f.value=e),onChange:A,class:"input-1"},null,544),[[re,f.value]])])]),i.value?(n(),l("div",ye,[t("div",xe,[s[14]||(s[14]=t("h2",{class:"title-md"},"Selected Employee Info",-1)),s[15]||(s[15]=t("hr",null,null,-1)),t("div",be,[t("p",null,[s[5]||(s[5]=t("strong",null,"Name:",-1)),r(" "+a(i.value.name),1)]),t("p",null,[s[6]||(s[6]=t("strong",null,"Designation:",-1)),r(" "+a(((C=i.value.designation)==null?void 0:C.title)||"N/A"),1)]),t("p",null,[s[7]||(s[7]=t("strong",null,"Department:",-1)),r(" "+a(((L=i.value.department)==null?void 0:L.name)||"N/A"),1)]),t("p",null,[s[8]||(s[8]=t("strong",null,"Company:",-1)),r(" "+a(((D=i.value.company)==null?void 0:D.name)||"N/A"),1)]),t("p",null,[s[9]||(s[9]=t("strong",null,"Phone:",-1)),r(" "+a(i.value.phone),1)]),t("p",null,[s[10]||(s[10]=t("strong",null,"Email:",-1)),r(" "+a(i.value.email||"N/A"),1)]),t("p",null,[s[11]||(s[11]=t("strong",null,"Employee ID :",-1)),r(" "+a(i.value.employee_id||"N/A"),1)]),t("p",null,[s[12]||(s[12]=t("strong",null,"Joining Date :",-1)),r(" "+a(i.value.joining_date||"N/A"),1)]),t("p",null,[s[13]||(s[13]=t("strong",null,"Employee ID :",-1)),r(" "+a(i.value.blood||"N/A"),1)])])]),t("div",ve,[t("div",fe,[s[17]||(s[17]=t("h2",{class:"title-md"},"Attendance Summary",-1)),h(p,{to:{name:"MonthWiseApplicationLog",query:{...c(d).query}},class:"btn-2",target:"_blank",rel:"noopener noreferrer"},{default:_(()=>s[16]||(s[16]=[r(" Application History ")])),_:1,__:[16]},8,["to"])]),s[24]||(s[24]=t("hr",null,null,-1)),t("div",he,[t("p",null,[s[18]||(s[18]=t("strong",null,"Total Working Days:",-1)),r(" "+a((E=(q=c(o))==null?void 0:q.summary)==null?void 0:E.total_working_days),1)]),t("p",null,[s[19]||(s[19]=t("strong",null,"Present Days:",-1)),r(" "+a((M=(j=c(o))==null?void 0:j.summary)==null?void 0:M.total_present_days),1)]),t("p",null,[s[20]||(s[20]=t("strong",null,"Absent Days:",-1)),r(" "+a((P=(N=c(o))==null?void 0:N.summary)==null?void 0:P.total_absent_days),1)]),t("p",null,[s[21]||(s[21]=t("strong",null,"Late Days:",-1)),r(" "+a((B=(W=c(o))==null?void 0:W.summary)==null?void 0:B.total_late_days),1)]),t("p",null,[s[22]||(s[22]=t("strong",null,"Total Working Hours:",-1)),r(" "+a((T=(R=c(o))==null?void 0:R.summary)==null?void 0:T.total_working_hours),1)]),t("p",null,[s[23]||(s[23]=t("strong",null,"Total Overtime Hours:",-1)),r(" "+a((H=(V=c(o))==null?void 0:V.summary)==null?void 0:H.total_overtime_hours),1)])])])])):(n(),l("div",we,s[25]||(s[25]=[t("p",{class:"text-gray-400 text-center text-2xl italic"},"Select an employee, please.",-1)]))),c(o).isLoading?(n(),v(ie,{key:2})):(n(),l("div",ke,[t("div",Ae,[t("table",Se,[s[29]||(s[29]=t("thead",null,[t("tr",{class:"bg-gray-200 text-xs"},[t("th",{class:"border p-1"},"Date"),t("th",{class:"border p-1"},"Day"),t("th",{class:"border p-1"},"Shift"),t("th",{class:"border p-1"},"Entry Time"),t("th",{class:"border p-1"},"Exit Time"),t("th",{class:"border p-1"},"Working Hours"),t("th",{class:"border p-1"},"Over Time"),t("th",{class:"border p-1"},"Approved OT"),t("th",{class:"border p-1"},"Late Entry"),t("th",{class:"border p-1"},"Early Leave"),t("th",{class:"border p-1"},"Status")])],-1)),t("tbody",ge,[(n(!0),l(g,null,ne((O=c(o))==null?void 0:O.monthlyLogs,e=>{var $,U,F,I,z,J,G;return n(),l("tr",{key:e==null?void 0:e.date,class:"hover:border-b-2 hover:border-gray-200 hover:bg-blue-200"},[t("td",Ce,a(e.date),1),t("td",Le,a(e.weekday),1),t("td",{class:"border px-2 py-1 text-sm whitespace-nowrap",title:`${e.shift_start_time} to ${e.shift_end_time}`},[t("div",qe,[t("div",Ee,a(e.shift_name),1),e.shift_exchange_application_status?(n(),l("div",je,[h(p,{to:{name:"ExchangeShiftShow",params:{id:e.shift_exchange_application_id}},class:x(["inline-flex items-center gap-1 px-2 py-0.5 rounded-full font-medium transition hover:opacity-90",{"bg-yellow-100 text-yellow-800":e.shift_exchange_application_status==="Pending","bg-green-100 text-green-800":e.shift_exchange_application_status==="Approved","bg-red-100 text-red-800":e.shift_exchange_application_status==="Rejected"}])},{default:_(()=>[s[26]||(s[26]=t("i",{class:"far fa-eye"},null,-1)),r(" "+a(e.shift_exchange_application_status),1)]),_:2,__:[26]},1032,["to","class"])])):u("",!0)])],8,De),t("td",{class:x(["border px-2 py-1 text-sm whitespace-nowrap",{"bg-red-100 text-red-800":e.late_duration,"bg-blue-100 text-blue-800":(($=e==null?void 0:e.manual_attendance)==null?void 0:$.check_in)&&e.entry_time,"bg-gray-50":!e.entry_time}])},[t("div",{class:"flex items-center gap-1",title:`Device: ${e.entry_device}`},[(U=e==null?void 0:e.manual_attendance)!=null&&U.check_in&&e.entry_time?(n(),l("span",Ne,"M:")):u("",!0),t("span",null,a(e.entry_time||"--"),1),(F=e==null?void 0:e.manual_attendance)!=null&&F.id&&((I=e==null?void 0:e.manual_attendance)!=null&&I.check_in)?(n(),v(p,{key:1,to:{name:"ManualAttendanceShow",params:{id:e.manual_attendance.id}},class:"text-blue-600 hover:text-blue-800"},{default:_(()=>s[27]||(s[27]=[t("i",{class:"far fa-eye ml-1"},null,-1)])),_:2,__:[27]},1032,["to"])):u("",!0)],8,Me)],2),t("td",{class:x(["border px-2 py-1 text-sm whitespace-nowrap",{"bg-red-100 text-red-800":e.early_leave_duration,"bg-blue-100 text-blue-800":((z=e==null?void 0:e.manual_attendance)==null?void 0:z.check_out)&&e.exit_time,"bg-gray-50":!e.exit_time}])},[t("div",{class:"flex items-center gap-1",title:`Device: ${e.exit_device}`},[t("span",null,a(e.exit_time||"--"),1),(J=e==null?void 0:e.manual_attendance)!=null&&J.id&&((G=e==null?void 0:e.manual_attendance)!=null&&G.check_out)?(n(),v(p,{key:0,to:{name:"ManualAttendanceShow",params:{id:e.manual_attendance.id}},class:"text-blue-600 hover:text-blue-800"},{default:_(()=>s[28]||(s[28]=[t("i",{class:"far fa-eye ml-1"},null,-1)])),_:2,__:[28]},1032,["to"])):u("",!0)],8,Pe)],2),t("td",We,a(e.working_hours),1),t("td",Be,[e.over_time_status==="Approved"?(n(),v(p,{key:0,to:{name:"MyOvertimeShow",params:{id:e.over_time_application_id}},class:"bg-green-100 text-green-700 px-2 py-1 rounded text-xs font-semibold"},{default:_(()=>[r(a(e.overtime_hours)+" | Approved ",1)]),_:2},1032,["to"])):e.over_time_status==="Pending"?(n(),v(p,{key:1,to:{name:"MyOvertimeShow",params:{id:e.over_time_application_id}},class:"bg-yellow-100 text-yellow-700 px-2 py-1 rounded text-xs font-semibold animate-pulse"},{default:_(()=>[r(a(e.overtime_hours??"--")+" | Pending ",1)]),_:2},1032,["to"])):e.over_time_status==="Rejected"?(n(),l("span",Re," Rejected ")):e.over_time_status&&e.overtime_hours?(n(),l("span",Te,a(e.overtime_hours),1)):u("",!0)]),t("td",Ve,a(e!=null&&e.approved_over_times?(e==null?void 0:e.approved_over_times)+" H":""),1),t("td",He,[e.late_duration?(n(),l("div",Oe,[r(a(e.late_duration)+" ",1),e.first_short_leave?(n(),v(p,{key:0,to:{name:"ShortLeaveShow",params:{id:e.first_short_leave_id}},class:x({"text-green-500":e.first_short_leave==="Approved","text-yellow-500":e.first_short_leave==="Pending","text-red-500":e.first_short_leave==="Rejected"})},{default:_(()=>[r(" ("+a(e.first_short_leave)+") ",1)]),_:2},1032,["to","class"])):u("",!0)])):u("",!0)]),t("td",$e,[e.early_leave_duration?(n(),l("div",Ue,[r(a(e.early_leave_duration)+" ",1),e.last_short_leave?(n(),v(p,{key:0,to:{name:"ShortLeaveShow",params:{id:e.last_short_leave_id}},class:x(["px-1",{"text-green-500":e.last_short_leave==="Approved","text-yellow-500":e.last_short_leave==="Pending","text-red-500":e.last_short_leave==="Rejected"}])},{default:_(()=>[r(" ("+a(e.last_short_leave)+") ",1)]),_:2},1032,["to","class"])):u("",!0)])):u("",!0)]),t("td",Fe,[t("div",Ie,[h(ce,{status:e.status},null,8,["status"]),e.leave_application_id?(n(),l("div",ze,[h(p,{to:{name:"LeaveApplicationShow",params:{id:e.leave_application_id}},class:"text-blue-600 text-xs inline-flex items-center gap-1 hover:underline hover:text-blue-800 transition",title:"View Leave Application"},{default:_(()=>[t("span",{class:x(["text-xs font-medium py-0.5 transition",{" text-green-700 border-green-200":e.application_status==="Approved"," text-yellow-700 border-yellow-200":e.application_status==="Pending"," text-red-700 border-red-200":e.application_status==="Rejected"," text-gray-600 border-gray-200":!e.application_status}])},a(e.status=="Absent"?e.leave_application_type:"")+"( "+a(e.application_status||"Waiting Handover")+" ) ",3)]),_:2},1032,["to"])])):u("",!0),e.day_exchange_id?(n(),l("div",Je,[h(p,{to:{name:"ExchangeOffdayShow",params:{id:e.day_exchange_id}},class:"text-blue-600 text-xs inline-flex items-center gap-1 hover:underline hover:text-blue-800 transition",title:"View Exchange Offday Application"},{default:_(()=>[t("span",{class:x(["text-xs font-medium py-0.5 transition",{"text-green-700 border-green-200":e.day_exchange_status==="Approved","text-yellow-700 border-yellow-200":e.day_exchange_status==="Pending","text-red-700 border-red-200":e.day_exchange_status==="Rejected","text-gray-600 border-gray-200":!e.day_exchange_status}])},[e.status==="Absent"||e.status==="Present"?(n(),l(g,{key:0},[r(" Offday ("+a(e.day_exchange_status||"Waiting Handover")+") ",1)],64)):(n(),l(g,{key:1},[r(a(e.day_exchange_status||"Waiting Handover"),1)],64))],2)]),_:2},1032,["to"])])):u("",!0)])])])}),128))])])])]))])}}};export{at as default};
