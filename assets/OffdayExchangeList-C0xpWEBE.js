import{u as $,f as F,r as m,x as O,D as j,h as P,q as D,p as G,c as i,o as n,a as t,d as c,m as h,l as H,n as u,H as I,k as T,F as Y,e as z,t as p}from"./index-__drmr9Y.js";import{_ as J}from"./EmployeeFilter-CMW7MGaI.js";import{_ as K}from"./FlexibleDatePicker-BvMVI87f.js";import{L as Q}from"./LoaderView-ZRLoOt-V.js";import{u as W}from"./exchange-CWl18mfi.js";import{u as X}from"./user-BYdMJise.js";import"./company-CMbSCFJe.js";import"./department-Cefy_LVG.js";import"./EmployeeDropdownInput-sIBEzIPG.js";import"./SelectDropdown-D_1983tB.js";import"./UserChip-DMuY1LZw.js";const Z={class:"space-y-2 px-4"},ee={class:"flex flex-wrap gap-2 p-3 rounded-2xl border border-white/20 bg-white/60 backdrop-blur-md shadow-sm supports-[backdrop-filter]:bg-white/50 sticky top-14"},te={key:0,class:"text-center py-4"},oe={key:1,class:"space-y-4"},re={class:"min-w-full table-auto border-collapse border border-gray-200 bg-white rounded-md text-sm"},se={class:"border border-gray-300 px-2"},ae={class:"border border-gray-300 px-2"},le={class:"border border-gray-300 px-2"},de={class:"border border-gray-300 px-2"},ie={class:"border border-gray-300 px-2"},ne={class:"border border-gray-300 px-2"},pe={class:"border border-gray-300 px-2"},ue={class:"flex gap-2"},ye=["onClick"],me={key:0},C="offday",Ce={__name:"OffdayExchangeList",setup(ce){const f=$(),l=F(),a=W(),w=X(),E=m(null),_=l.query.date||a.selectedMonth||new Date().toISOString().slice(0,7),b=m(_),g=new Date,U=s=>s.toString().padStart(2,"0"),d=m({year:Number(_.split("-")[0]||g.getFullYear()),month:Number(_.split("-")[1]||g.getMonth()+1),day:1}),M=O(()=>{var s,e;return!((s=d.value)!=null&&s.year)||!((e=d.value)!=null&&e.month)?"":`${d.value.year}-${U(d.value.month)}`}),{loading:A}=j(a),r=m({company_id:l.query.company_id||"",department_id:l.query.department_id||"all",type:l.query.type||"all",employee_id:l.query.employee_id||"",category:""});P(async()=>{A.value=!0,await w.fetchUsers(),E.value=w.users.find(s=>{var e;return s.id==((e=l==null?void 0:l.query)==null?void 0:e.company_id)}),await y()});const y=async()=>{r.value.employee_id?await a.fetchAllExchanges({company_id:r.value.company_id,department_id:r.value.department_id,user_id:r.value.employee_id,type:C,selectedMonth:b.value,selectedStatus:a.selectedStatus}):await a.fetchAllExchanges({company_id:r.value.company_id,department_id:r.value.department_id,type:C,selectedMonth:b.value,selectedStatus:a.selectedStatus})};D(()=>[r.value.company_id,r.value.department_id,r.value.employee_id],async()=>{await y()}),D(M,s=>{s&&(b.value=s,f.replace({query:{...l.query,date:s}}),y())},{immediate:!0});const N=()=>{f.go(-1)},V=async s=>{confirm("Are you sure to delete this application?")&&a.deleteExchange(s)},B=()=>{f.replace({query:{...l.query,company_id:r.value.company_id,department_id:r.value.department_id,type:r.value.type,employee_id:r.value.employee_id}})},v=s=>s?new Date(s).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"";return(s,e)=>{var S,k,x;const L=G("RouterLink");return n(),i("div",Z,[t("div",{class:"flex items-center justify-between gap-2"},[t("button",{class:"btn-3",onClick:N},e[6]||(e[6]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),e[7]||(e[7]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Offday Exchanges",-1)),e[8]||(e[8]=t("div",null,null,-1))]),t("div",ee,[c(J,{company_id:r.value.company_id,"onUpdate:company_id":e[1]||(e[1]=o=>r.value.company_id=o),department_id:r.value.department_id,"onUpdate:department_id":e[2]||(e[2]=o=>r.value.department_id=o),employee_id:r.value.employee_id,"onUpdate:employee_id":e[3]||(e[3]=o=>r.value.employee_id=o),category:r.value.category,"onUpdate:category":e[4]||(e[4]=o=>r.value.category=o),"with-type":!0,"initial-value":s.$route.query,onFilterChange:B},{default:h(()=>[t("div",null,[e[10]||(e[10]=t("label",{for:"",class:"top-label -top-1"},"Status ",-1)),H(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>u(a).selectedStatus=o),onChange:y,class:"input-1 py-0.5"},e[9]||(e[9]=[t("option",{value:"",selected:""},"All",-1),t("option",{value:"Pending"},"Pending",-1),t("option",{value:"Approved"},"Approved",-1),t("option",{value:"Rejected"},"Rejected",-1)]),544),[[I,u(a).selectedStatus]])])]),_:1},8,["company_id","department_id","employee_id","category","initial-value"]),c(K,{modelValue:d.value,"onUpdate:modelValue":e[5]||(e[5]=o=>d.value=o),"show-year":!1,"show-month":!0,"show-date":!1,label:"Month"},null,8,["modelValue"])]),u(a).loading?(n(),i("div",te,[c(Q)])):(n(),i("div",oe,[t("table",re,[e[14]||(e[14]=t("thead",null,[t("tr",{class:"bg-gray-200 sticky top-28"},[t("th",{class:"border border-gray-300 px-2 text-left"},"#"),t("th",{class:"border border-gray-300 px-2 text-left"},"Employee Name"),t("th",{class:"border border-gray-300 px-2 text-left"},"Created Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Current Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Exchange Date"),t("th",{class:"border border-gray-300 px-2 text-left"},"Status"),t("th",{class:"border border-gray-300 px-2 text-left"},"Action")])],-1)),t("tbody",null,[(n(!0),i(Y,null,z((S=u(a))==null?void 0:S.all_exchanges,(o,R)=>{var q;return n(),i("tr",{key:o==null?void 0:o.id,class:"border-b border-gray-200 hover:bg-blue-200"},[t("td",se,p(R+1),1),t("td",ae,p(((q=o==null?void 0:o.user)==null?void 0:q.name)||"Unknown"),1),t("td",le,p(v(o==null?void 0:o.created_at)),1),t("td",de,p(v(o==null?void 0:o.current_date)),1),t("td",ie,p(v(o==null?void 0:o.exchange_date)),1),t("td",ne,p((o==null?void 0:o.status)||"N/A"),1),t("td",pe,[t("div",ue,[c(L,{to:{name:"ExchangeOffdayShow",params:{id:o==null?void 0:o.id}},class:"btn-icon"},{default:h(()=>e[11]||(e[11]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[11]},1032,["to"]),t("button",{onClick:fe=>V(o==null?void 0:o.id),class:"btn-icon text-red-500"},e[12]||(e[12]=[t("i",{class:"far fa-trash"},null,-1)]),8,ye)])])])}),128)),((x=(k=u(a))==null?void 0:k.all_exchanges)==null?void 0:x.length)===0?(n(),i("tr",me,e[13]||(e[13]=[t("td",{colspan:"6",class:"p-2 text-center text-red-500"},"No exchanges found",-1)]))):T("",!0)])])]))])}}};export{Ce as default};
