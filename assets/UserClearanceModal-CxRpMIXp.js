import{_ as F,x as g,c as i,o as l,a as e,t as d,i as K,b as T,k as v,F as A,e as z,s as D,D as Y,q as L,y as q,d as W,n as I,A as J}from"./index-D25JIjXx.js";import{u as Q}from"./userClearance-DSHazMZH.js";const X={class:"clearance-sheet mt-6 mb-10 w-[980px] max-w-[96vw] rounded-2xl bg-white shadow-2xl print:w-[186mm] print:max-w-[186mm] print:rounded-none print:shadow-none print:m-0 print:mt-0"},Z={class:"px-6 pt-6 pb-4 border-b print:px-[12mm] print:pt-[10mm] print:pb-[4mm]"},ee={class:"mt-4 grid grid-cols-1 sm:grid-cols-3 gap-3 text-sm print:text-[12px]"},te={class:"flex gap-2"},re={class:"font-medium"},se={class:"flex gap-2"},ae={class:"value"},ne={class:"value-text"},oe={class:"flex gap-2"},de={class:"value"},ie={class:"value-text"},le={class:"px-6 pb-6 print:px-[12mm] print:pb-[12mm] overflow-x-auto print:overflow-visible"},pe={class:"w-full border border-gray-800 text-[13px] print:text-[12px]",style:{"border-collapse":"collapse"}},ce={key:0},ue={key:1},me={colspan:"6",class:"border border-gray-800 text-center py-6 text-red-600"},be={key:2},ge={class:"border border-gray-800 px-2 py-1 align-top tabular-nums"},ye=["rowspan"],_e={class:"text-xs"},xe={class:"border border-gray-800 px-2 py-1"},ve={class:"font-medium"},he={class:"text-[11px] text-gray-700 mt-0.5"},fe={key:0,class:"text-gray-500 print:hidden"},ke={key:1,class:"ml-2 text-amber-700"},we={class:"border border-gray-800 px-2 py-1"},Ce={class:"inline-block min-w-[22mm] text-center font-semibold"},Se={class:"border border-gray-800 px-2 py-1"},Ne={class:"whitespace-pre-line"},Ee={class:"border border-gray-800 px-2 py-1"},Te={key:0,class:"text-[11px] text-gray-600 mt-0.5"},De={class:"border border-gray-800 px-2 py-1 print:hidden"},Re=["title","aria-label"],Pe={__name:"UserClearanceSheet",props:{titleUser:{type:String,default:""},employeeId:{type:String,default:""},userDept:{type:String,default:""},userPost:{type:String,default:""},printableRows:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},error:{type:String,default:""}},setup(c){const h=c,p=g(()=>h.error?typeof h.error=="string"?h.error:String(h.error):""),y={PENDING:{label:"Pending",pill:"bg-amber-50 text-amber-800 border-amber-200",dot:"bg-amber-500"},WORKING:{label:"Working",pill:"bg-sky-50 text-sky-800 border-sky-200",dot:"bg-sky-500"},COMPLETED:{label:"Completed",pill:"bg-emerald-50 text-emerald-800 border-emerald-200",dot:"bg-emerald-500"}};function _(n){const s=String(n??"").trim().toLowerCase();return["y","yes","true","1","done","cleared","complete","completed","yes.","yes,"].includes(s)?"Yes":["n","no","false","0","pending","not done","incomplete","no.","no,","rejected"].includes(s)?"No":["na","n/a"].includes(s)?"N/A":"-"}function u(n){var a;if(n!=null&&n.missing)return"Pending";const s=String((n==null?void 0:n.status)||"").toUpperCase();return((a=y[s])==null?void 0:a.label)||(n==null?void 0:n.status)||"-"}function f(n){var a;if(n!=null&&n.missing)return y.PENDING.pill;const s=String((n==null?void 0:n.status)||"").toUpperCase();return((a=y[s])==null?void 0:a.pill)||"bg-slate-50 text-slate-700 border-slate-200"}function S(n){var a;if(n!=null&&n.missing)return y.PENDING.dot;const s=String((n==null?void 0:n.status)||"").toUpperCase();return((a=y[s])==null?void 0:a.dot)||"bg-slate-400"}return(n,s)=>(l(),i("div",X,[e("div",Z,[s[3]||(s[3]=e("div",{class:"text-center"},[e("h1",{class:"text-2xl font-extrabold tracking-wide print:text-[20px]"},"GENESIS PG ORIENTATION CENTRE"),e("p",{class:"text-sm text-gray-600 print:text-[12px]"},"230, New Elephant Road, Katabon Mor, Dhaka-1205")],-1)),e("div",ee,[e("div",te,[s[0]||(s[0]=e("span",{class:"label"},"Name:",-1)),e("span",null,[e("span",re,d(c.titleUser||"-"),1)])]),e("div",se,[s[1]||(s[1]=e("span",{class:"label"},"Department:",-1)),e("span",ae,[e("span",ne,d(c.userDept||"-"),1)])]),e("div",oe,[s[2]||(s[2]=e("span",{class:"label"},"Post:",-1)),e("span",de,[e("span",ie,d(c.userPost||"-"),1)])])]),s[4]||(s[4]=e("div",{class:"mt-4 text-center"},[e("h2",{class:"inline-block text-base font-semibold px-4 py-1 border rounded print:text-[13px]"}," Employment Resignation Checklist ")],-1))]),e("div",le,[e("table",pe,[s[8]||(s[8]=e("thead",null,[e("tr",{class:"bg-gray-100"},[e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[14mm]"},"S. L."),e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[30mm]"},"Handover To"),e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[70mm]"},[T(" Particulars "),e("span",{class:"block text-[11px] text-gray-600"},"Cleared by")]),e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[30mm]"},"Handed over (Yes/No)"),e("th",{class:"border border-gray-800 text-left px-2 py-1"},"Present Conditions (note please)"),e("th",{class:"border border-gray-800 text-left px-2 py-1 w-[42mm]"},"Receiver Name"),e("th",{class:"border border-gray-800 text-left px-2 py-1 print:hidden"},"Status")])],-1)),e("tbody",null,[c.loading?(l(),i("tr",ce,s[5]||(s[5]=[e("td",{colspan:"6",class:"border border-gray-800 text-center py-6 text-gray-600"},"Loading...",-1)]))):p.value?(l(),i("tr",ue,[e("td",me,d(p.value),1)])):c.printableRows.length?v("",!0):(l(),i("tr",be,s[6]||(s[6]=[e("td",{colspan:"6",class:"border border-gray-800 text-center py-6 text-gray-600"},"No items found",-1)]))),(l(!0),i(A,null,z(c.printableRows,a=>{var w,C;return l(),i("tr",{key:a.row.template_item_id,class:"align-top"},[e("td",ge,d(a.sl)+".",1),a.isGroupFirst?(l(),i("td",{key:0,rowspan:a.groupSpan,class:"border border-gray-800 px-2 py-1 align-top font-medium"},[e("span",_e,d(a.group),1)],8,ye)):v("",!0),e("td",xe,[e("div",ve,d(a.row.label),1),e("div",he,[s[7]||(s[7]=T(" Cleared by: ")),e("strong",null,d(((w=a.row.cleared_by_user)==null?void 0:w.name)||((C=a.row.cleared_by_user)!=null&&C.id?"#"+a.row.cleared_by_user.id:"-")),1),a.row.cleared_at?(l(),i("span",fe," ("+d(new Date(a.row.cleared_at).toLocaleString())+") ",1)):v("",!0),a.row.missing?(l(),i("span",ke,"(pending)")):v("",!0)])]),e("td",we,[e("span",Ce,d(_(a.row.handover_status)),1)]),e("td",Se,[e("div",Ne,d(a.row.present_condition||"-"),1)]),e("td",Ee,[e("div",null,d(a.row.show_receiver&&a.row.receiver_name||"-"),1),a.row.remarks?(l(),i("div",Te,d(a.row.remarks),1)):v("",!0)]),e("td",De,[e("span",{class:D(["inline-flex items-center gap-1.5 rounded-full border px-2 py-0.5 text-xs font-medium print:bg-white print:text-black print:border-black",f(a.row)]),title:a.row.missing?"Not cleared yet":"Status: "+u(a.row),"aria-label":u(a.row)},[e("span",{class:D(["h-1.5 w-1.5 rounded-full",S(a.row)])},null,2),T(" "+d(u(a.row)),1)],10,Re)])])}),128))])]),s[9]||(s[9]=K('<div class="mt-8 grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm print:text-[12px]" data-v-9da5e85b><div class="border-gray-800 pt-6 text-center" data-v-9da5e85b><div class="font-medium" data-v-9da5e85b>User Signature</div></div><div class="border-gray-800 pt-6 text-center" data-v-9da5e85b><div class="font-medium" data-v-9da5e85b>Received by Head of HR</div></div><div class="border-gray-800 pt-6 text-center" data-v-9da5e85b><div class="font-medium" data-v-9da5e85b>Verified by ACC/CC</div></div></div>',1))])]))}},Le=F(Pe,[["__scopeId","data-v-9da5e85b"]]),Ie={key:1,class:"clearance-modal fixed inset-0 z-50 print:static print:z-auto"},Ae={class:"clearance-shell absolute inset-0 flex items-start justify-center overflow-y-auto print:static print:inset-auto print:block print:overflow-visible"},Be={class:"w-[980px] max-w-[96vw] bg-white rounded-md shadow-2xl print:w-[186mm] print:max-w-[186mm] print:rounded-none print:shadow-none print:m-0 print:mt-0"},Ve={__name:"UserClearanceModal",props:{user:{type:Object,required:!0},open:{type:Boolean,default:!1},buttonClass:{type:String,default:"px-3 py-1.5 rounded-md bg-indigo-600 text-white hover:bg-indigo-700"},hideTrigger:{type:Boolean,default:!1}},emits:["update:open"],setup(c,{emit:h}){const p=c,y=h,_=g({get:()=>p.open,set:t=>y("update:open",t)}),u=Q(),{items:f,loading:S,error:n,currentUserInfo:s}=Y(u),a=g(()=>{var t,r,o;return((t=s==null?void 0:s.value)==null?void 0:t.name)||((r=p.user)==null?void 0:r.name)||`#${(o=p.user)==null?void 0:o.id}`}),w=g(()=>{var t,r;return((t=s==null?void 0:s.value)==null?void 0:t.employee_id)||((r=p.user)==null?void 0:r.employee_id)||""}),C=g(()=>{var t,r,o,m;return((r=(t=s==null?void 0:s.value)==null?void 0:t.department)==null?void 0:r.name)||((m=(o=p.user)==null?void 0:o.department)==null?void 0:m.name)||""}),B=g(()=>{var t,r,o,m;return((r=(t=s==null?void 0:s.value)==null?void 0:t.designation)==null?void 0:r.title)||((m=(o=p.user)==null?void 0:o.designation)==null?void 0:m.title)||""});function G(){_.value=!0}function N(){_.value=!1}function E(t){t.key==="Escape"&&N()}const R=async()=>{var t,r,o;(t=p.user)!=null&&t.id&&((r=u.setUser)==null||r.call(u,p.user.id),await((o=u.fetch)==null?void 0:o.call(u)))};L(_,t=>{t?(R(),window.addEventListener("keydown",E)):window.removeEventListener("keydown",E)},{immediate:!0}),L(()=>{var t;return(t=p.user)==null?void 0:t.id},(t,r)=>{t&&t!==r&&_.value&&R()}),q(()=>window.removeEventListener("keydown",E));function M(t={}){const r=t.latest||null,o=(r==null?void 0:r.cleared_by)||null;return{id:t.template_item_id??t.id,template_item_id:t.template_item_id??t.id,label:t.label||t.template_item_name||t.item_key||`#${t.template_item_id??t.id}`,order_no:t.order_no??t.template_order_no??0,handover_to:t.handover_to||"departmental_incharge",handover_by:t.handover_user||"departmental_incharge",show_receiver:!!t.show_receiver,is_cleared:!!t.is_cleared,missing:!!t.missing,status:(r==null?void 0:r.status)??null,handover_status:(r==null?void 0:r.handover_status)??null,present_condition:(r==null?void 0:r.present_condition)??"",receiver_name:t.show_receiver?(r==null?void 0:r.receiver_name)??"":"",remarks:(r==null?void 0:r.remarks)??"",cleared_by_user:o?{id:o.id,name:o.name}:null,cleared_at:(r==null?void 0:r.cleared_at)||null}}const V={departmental_incharge:"Departmental In-charge",technical_support_team:"Technical Support Team",it_incharge:"IT In-charge",hr_department:"HR Department",inventory_incharge:"Inventory In-charge"},P=["Departmental In-charge","Technical Support Team","IT In-charge","HR Department","Inventory In-charge"];function O(t){const r=String((t==null?void 0:t.handover_to)||"").toLowerCase();return V[r]||"Departmental In-charge"}const U=g(()=>(Array.isArray(f==null?void 0:f.value)?f.value:[]).map(M)),H=g(()=>{var m;const t=new Map(P.map(b=>[b,[]]));for(const b of U.value)(m=t.get(O(b)))==null||m.push(b);for(const[,b]of t.entries())b.sort((x,k)=>(x.order_no??x.template_item_id??x.id??0)-(k.order_no??k.template_item_id??k.id??0));const r=[];let o=1;for(const b of P){const x=t.get(b)||[];x.length&&x.forEach((k,j)=>r.push({sl:o++,group:b,isGroupFirst:j===0,groupSpan:x.length,row:k}))}return r});async function $(){document.body.classList.add("print-modal"),await J(),window.print(),setTimeout(()=>document.body.classList.remove("print-modal"),0)}return(t,r)=>{var o,m;return l(),i(A,null,[c.hideTrigger?v("",!0):(l(),i("button",{key:0,class:D(c.buttonClass),onClick:G},"View Clearance",2)),_.value?(l(),i("div",Ie,[e("div",{class:"clearance-overlay absolute inset-0 bg-black/50 print:hidden",onClick:N}),e("div",Ae,[e("div",Be,[W(Le,{class:"clearance-print-root","title-user":a.value,"employee-id":w.value,"user-dept":C.value,"user-post":B.value,"printable-rows":H.value,loading:(o=I(S))==null?void 0:o.value,error:(m=I(n))==null?void 0:m.value},null,8,["title-user","employee-id","user-dept","user-post","printable-rows","loading","error"]),e("div",{class:"clearance-actions w-[980px] max-w-[96vw] px-2 py-2 flex justify-end gap-2 print:hidden"},[e("button",{class:"rounded border px-3 py-1.5 hover:bg-gray-50",onClick:$},"Print"),e("button",{class:"rounded bg-gray-900 px-3 py-1.5 text-white hover:bg-gray-800",onClick:N},"Close")])])])])):v("",!0)],64)}}};export{Ve as _};
