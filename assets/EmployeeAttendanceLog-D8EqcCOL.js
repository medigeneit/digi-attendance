import{_ as N}from"./EmployeeFilter-CSCrG6YK.js";import{_ as A}from"./FlexibleDatePicker-Bs4e7ZKx.js";import{L as V}from"./LoaderView-lMGIT-Ru.js";import{S as j}from"./SelectedEmployeeCard-Grrf1D1t.js";import{u as E}from"./attendance-CVhN-_9_.js";import{u as T}from"./user-_UxeZ3ol.js";import{u as R,f as Y,r as y,x as z,h as D,q as U,c as i,o as s,a as l,j as G,i as H,d as x,l as J,m as L,F as M,e as $,t as b,b as K}from"./index-Cv5O7YaQ.js";import"./company-DQgFipii.js";import"./department-B8YEEoBY.js";import"./EmployeeDropdownInput-m6X86KLR.js";import"./SelectDropdown-Byds4-qS.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-DYR2gCHq.js";const O={class:"px-4 space-y-4"},P={class:"flex flex-wrap gap-4 items-center bg-white p-4 rounded sticky top-14 z-40"},Q={key:0,class:"flex justify-between gap-4 text-sm"},W={key:2,class:"space-y-4"},X={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Z={class:"text-sm font-semibold text-blue-700 border-b pb-1 mb-2"},I={class:"flex items-center gap-1 text-gray-700"},ee={class:"text-right text-gray-500 bg-blue-100 px-2 py-0.5 rounded text-[10px]"},fe={__name:"EmployeeAttendanceLog",setup(te){const u=R(),n=Y(),h=T(),p=E(),m=y(null),c=new Date,w=t=>t.toString().padStart(2,"0"),_=n.query.date||p.selectedMonth||`${c.getFullYear()}-${w(c.getMonth()+1)}`,f=y(_),r=y({year:Number(_.split("-")[0]||c.getFullYear()),month:Number(_.split("-")[1]||c.getMonth()+1),day:1}),v=z(()=>{var t,e;return!((t=r.value)!=null&&t.year)||!((e=r.value)!=null&&e.month)?"":`${r.value.year}-${w(r.value.month)}`}),a=y({company_id:n.query.company_id||"",department_id:n.query.department_id||"all",line_type:n.query.line_type||"all",employee_id:n.query.employee_id||"",category:""}),k=async t=>{t?(await h.fetchUser(t),m.value=h.user):m.value=null},g=async()=>{a.value.employee_id&&f.value&&await p.getMonthlyAttendanceLog(a.value.employee_id,f.value)};D(async()=>{a.value.employee_id&&(await k(a.value.employee_id),await g())}),U(()=>a.value.employee_id,async(t,e)=>{t&&t!==e&&(await k(t),await g(),u.replace({query:{...n.query,employee_id:t,date:v.value||void 0}}))}),U(v,t=>{t&&(f.value=t,u.replace({query:{...n.query,date:t}}),g())},{immediate:!0});const B=()=>u.go(-1),C=t=>new Date(t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),F=()=>{u.replace({query:{...n.query,company_id:a.value.company_id,department_id:a.value.department_id,line_type:a.value.line_type,employee_id:a.value.employee_id,date:v.value||void 0}})};return(t,e)=>(s(),i("div",O,[l("div",{class:"flex items-center justify-between gap-2"},[l("button",{class:"btn-3",onClick:B},e[5]||(e[5]=[l("i",{class:"far fa-arrow-left"},null,-1),l("span",{class:"hidden md:flex"},"Back",-1)])),e[6]||(e[6]=l("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Attendance Log",-1)),e[7]||(e[7]=l("div",null,null,-1))]),l("div",P,[x(N,{company_id:a.value.company_id,"onUpdate:company_id":e[1]||(e[1]=o=>a.value.company_id=o),department_id:a.value.department_id,"onUpdate:department_id":e[2]||(e[2]=o=>a.value.department_id=o),employee_id:a.value.employee_id,"onUpdate:employee_id":e[3]||(e[3]=o=>a.value.employee_id=o),line_type:a.value.line_type,"onUpdate:line_type":e[4]||(e[4]=o=>a.value.line_type=o),"with-type":!0,"initial-value":t.$route.query,onFilterChange:F,class:"w-full"},{default:J(()=>[l("div",null,[e[8]||(e[8]=l("label",{class:"top-label -top-1"},"Select Month",-1)),x(A,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),"show-year":!1,"show-month":!0,"show-date":!1},null,8,["modelValue"])])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"])]),m.value?(s(),i("div",Q,[x(j,{user:m.value},null,8,["user"])])):G("",!0),L(p).isLoading?(s(),H(V,{key:1})):(s(),i("div",W,[l("div",X,[(s(!0),i(M,null,$(L(p).attendanceLogs,(o,q)=>(s(),i("div",{key:q,class:"bg-white shadow rounded-lg p-4"},[l("h3",Z,b(q),1),(s(!0),i(M,null,$(o,(d,ae)=>{var S;return s(),i("div",{key:d.id,class:"flex items-center justify-between text-xs mb-1"},[l("div",I,[e[9]||(e[9]=l("i",{class:"far fa-clock text-blue-500"},null,-1)),K(" "+b(C(d.timestamp)),1)]),l("div",ee,b(((S=d==null?void 0:d.device)==null?void 0:S.name)||"Unknown"),1)])}),128))]))),128))])]))]))}};export{fe as default};
