import{r as m,e as W,E as X,m as g,G as Y,z as Z,c as f,o as p,a as i,h as L,H as v,g as j,F as H,q as I,t as y,w as b,v as z,I as w,j as A,x as E,J as _}from"./index-Cpy-MwS1.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";const te={class:"w-full"},le={key:0,class:"flex flex-wrap items-center gap-1 w-full justify-items-stretch"},ne={class:"bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm"},oe=["onClick"],ae={key:1,class:"text-gray-400"},se=["placeholder","onKeydown"],re={key:0,class:"p-3"},ue={class:"max-h-60 overflow-auto"},ie=["onClick","onKeydown"],de={key:1,class:"px-3 py-2 text-gray-500 min-h-24 flex justify-center items-center"},ce={__name:"SelectDropdown",props:{options:{type:Array,required:!0},modelValue:{type:[Object,Array,String,Number,null],default:null},placeholder:{type:String,default:null},multiple:{type:Boolean,default:!1},label:{type:String,default:"label"},value:{type:String,default:"id"},clearable:{type:Boolean,default:!0},searchable:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},filterBy:{type:Function,default:null},reduce:{type:Function,default:null},position:{type:String,default:"auto",validator:a=>["top","left","right","bottom","auto"].includes(a)},containment:{type:Object,default:()=>window},taggable:{type:Boolean,default:!1},createOption:Function},emits:["update:modelValue","input","open","close","search","search:focus","search:blur","option:selecting","option:selected","option:deselecting","option:deselected"],setup(a,{emit:U}){const l=a,o=U,r=m(!1),s=m(""),h=m(),K=m(),k=m(l.position);function D(e){h.value&&!h.value.contains(e.target)&&r.value&&(r.value=!1,o("close"))}function F(e){return l.options.find(t=>(t==null?void 0:t[l.value])==e)}W(()=>{document.addEventListener("click",D),l.containment.addEventListener("scroll",()=>C(r.value))}),X(()=>{document.removeEventListener("click",D),l.containment.removeEventListener("scroll",()=>C(r.value))});const q=g(()=>l.multiple||l.taggable),P=g(()=>{const e={top:"bottom-[100%] mb-0.5",left:"right-[100%] mr-0.5",right:"left-[100%] ml-0.5",bottom:"top-[100%] mt-0.5"};return e[k.value]||e.bottom}),d=g(()=>l.multiple||l.taggable?Array.isArray(l.modelValue)?l.modelValue:[]:l.modelValue),x=e=>(e==null?void 0:e[l.label])??(e==null?void 0:e.label)??e,M=e=>{const t=l.options.find(n=>typeof n=="string"||typeof n=="number"?String(n)===String(e):(n==null?void 0:n[l.value])==e);return t?(t==null?void 0:t[l.label])??(t==null?void 0:t.label)??t:l.taggable?e:null},u=e=>typeof e=="object"?(e==null?void 0:e[l.value])??(e==null?void 0:e.value)??e:typeof e=="string"||typeof e=="number"?e:"",G=()=>{l.disabled||(r.value=!r.value,o(r.value?"open":"close"))},$=e=>{const t=u(e);return l.multiple||l.taggable?d.value.some(n=>u(n)===t):u(d.value)===t},S=e=>{if(l.multiple||l.taggable)if($(e)){o("option:deselecting",e);const t=d.value.filter(n=>u(n)!==u(e));o("update:modelValue",t),o("option:deselected",e)}else{o("option:selecting",e);const t=[...d.value,u(e)];o("update:modelValue",t),o("option:selected",e)}else o("option:selected",e),typeof l.modelValue=="object"&&l.modelValue?o("update:modelValue",e):o("update:modelValue",u(e));r.value=!1,o("close"),o("input",e),s.value=""},N=e=>{const t=d.value.filter(n=>u(n)!==u(e));o("update:modelValue",t),o("option:deselected",e)},B=g(()=>{const e=s.value.toLowerCase();return!l.searchable||!e?l.options:typeof l.filterBy=="function"?l.filterBy(l.options,e):l.options.filter(t=>x(t).toLowerCase().includes(e))});async function C(e){if(e&&l.position==="auto"){await Y();const t=h.value,n=K.value;if(t&&n){console.log({cm:l.containment});const c=t.getBoundingClientRect(),V=n.offsetHeight,T=(l.containment.innerHeight||l.containment.clientHeight)-c.bottom,O=c.top;console.log({triggerRect:c,dropdownHeight:V,spaceBelow:T,spaceAbove:O}),O<V?k.value="bottom":k.value=T<V&&O>V?"top":"bottom"}}else k.value=l.position}const R=g(()=>B.value.find(e=>x(e).toLowerCase()===s.value.toLowerCase()));function J(e){if(s.value.length===0&&l.taggable&&Array.isArray(l.modelValue)){const t=[...l.modelValue];t.pop(),o("update:modelValue",t)}}function Q(e){if(e.preventDefault(),!(!l.taggable||!s.value.trim())){if(R.value)S(R.value);else{const t=l.createOption?l.createOption(s.value):s.value.trim();o("option:created",t),o("option:selected",t),o("input",t),o("update:modelValue",[...l.modelValue,t])}s.value="",e.target.focus()}}return Z(r,C),(e,t)=>(p(),f("div",{class:"relative w-full",ref_key:"dropdownRef",ref:h},[i("div",{class:E(["border rounded-md px-2 py-1.5 cursor-pointer bg-white flex items-center justify-between",{"bg-gray-100":a.disabled}]),onClick:G,tabindex:"0"},[i("div",te,[q.value?(p(),f("div",le,[Array.isArray(d.value)&&d.value.length>0?(p(!0),f(H,{key:0},I(d.value,n=>v(e.$slots,"selected-option",{key:u(n),option:F(n),removeItem:c=>N(c)},()=>[i("span",ne,[i("span",null,y(M(n)),1),i("button",{onClick:b(c=>N(n),["prevent","stop"]),type:"button",class:"ml-1 text-xs"}," Ã— ",8,oe)])],!0)),128)):a.taggable?j("",!0):(p(),f("span",ae,y(a.placeholder||"Select.."),1)),a.taggable?L((p(),f("input",{key:2,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value=n),type:"text",class:"flex-grow px-2 py-1 rounded outline-none",placeholder:a.placeholder||"Type and enter to add",onKeydown:[w(b(Q,["prevent","stop"]),["enter"]),w(J,["backspace"])],onKeyup:t[1]||(t[1]=()=>r.value=!!s.value),onFocus:t[2]||(t[2]=n=>e.$emit("search:focus")),onBlur:t[3]||(t[3]=n=>e.$emit("search:blur"))},null,40,se)),[[z,s.value]]):j("",!0)])):v(e.$slots,"selected-option",{key:1,option:F(a.modelValue),isSelected:$},()=>[A(y(M(d.value)||a.placeholder||"Select..."),1)],!0)]),v(e.$slots,"open-indicator",{},()=>[t[8]||(t[8]=i("svg",{class:"w-4 h-4 ml-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))],!0)],2),L(i("div",{class:E(["absolute w-full border rounded shadow-[0px_0px_10px_0px_rgba(0,0,0,0.25)] z-50 border-teal-500 bg-white",P.value]),ref_key:"dropdownMenuRef",ref:K},[a.searchable&&!a.taggable?(p(),f("div",re,[v(e.$slots,"search",{},()=>[L(i("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=n=>s.value=n),class:"w-full px-2 py-1 border rounded",placeholder:"Search...",onFocus:t[5]||(t[5]=n=>e.$emit("search:focus")),onBlur:t[6]||(t[6]=n=>e.$emit("search:blur")),onKeydown:t[7]||(t[7]=w(b(n=>n.preventDefault(),["stop"]),["enter"]))},null,544),[[z,s.value]])],!0)])):j("",!0),v(e.$slots,"list-header",{},void 0,!0),i("ul",ue,[B.value.length?(p(!0),f(H,{key:0},I(B.value,n=>(p(),f("li",{tabindex:"0",key:u(n),class:E([{"bg-blue-50":$(n)},"px-3 py-2 hover:bg-blue-100 cursor-pointer"]),onClick:c=>S(n),onKeydown:[w(b(c=>S(n),["prevent"]),["space"]),w(b(c=>S(n),["prevent"]),["enter"])]},[v(e.$slots,"option",{option:n},()=>[A(y(x(n)),1)],!0)],42,ie))),128)):(p(),f("li",de,[v(e.$slots,"no-options",{},()=>[A(y(a.taggable?"No option found, Enter to add":"No options found"),1)],!0)]))]),v(e.$slots,"list-footer",{},void 0,!0)],2),[[_,r.value]])],512))}},ve=ee(ce,[["__scopeId","data-v-760b4029"]]);export{ve as S};
