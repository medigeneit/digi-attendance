import{L as I}from"./LoaderView-BUlRoAah.js";import{r as _,x as j,L as z,a9 as B,e as q,M as F,c as a,o as s,a as e,g as u,q as $,w as U,t as v,h as D,v as E,j as N,J,b as K,s as O,A as Z,m as G,f as P,k as m,F as C,y as M,n as A,i as Q}from"./index-B00qadZM.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const W={key:0,class:"font-bold text-lg text-green-600"},X={key:1,class:"btn-2"},Y={key:0,class:"text-base"},ee={key:1,class:"btn-1"},te={class:"modal-card"},se={class:"title-lg"},ae=["placeholder","required"],ne={class:"flex"},le={class:"flex justify-between gap-2 mt-4"},oe=["disabled"],ie=["disabled"],re={class:"capitalize hidden md:inline"},ce={__name:"ApproveAndReject",props:{notificationType:{type:String,required:!0},applicationId:{type:[String,Number],required:!0},onSuccess:{type:Function,default:null},onSubmit:{type:Function,default:null},variant:{type:Number,default:1}},emits:["loading"],setup(y,{emit:i}){const r=y,k=i,f=_(255),d=j(()=>f.value-o.value.length),L=z(),w=B(),T=_(null),c=_(null),t=_(null),o=_(""),x=_(!1),l=j(()=>t.value!==null),R=j(()=>t.value==="accept"?"Accept Application":"Reject Application");function h(p){(p==="accept"||p==="reject")&&(t.value=p,o.value="",V())}function b(){t.value=null,o.value=""}async function H(){if(!w.loading){if(t.value==="reject"&&!o.value)return L.error("Rejection Reason is required!");if(typeof r.onSubmit=="function")return r.onSubmit({note:o.value,action:t.value});k("loading",!0),x.value=!0;try{await w.updateNotification(r.notificationType,r.applicationId,t.value,o.value)}finally{k("loading",!1),x.value=!1}typeof r.onSuccess=="function"?r.onSuccess():w.fetchTaskNotification(),b()}}function S(p){var n,g;l.value&&(p.key==="ArrowLeft"?(n=c.value)==null||n.focus():p.key==="ArrowRight"&&((g=T.value)==null||g.focus()))}function V(){J(()=>{var p;(p=T.value)==null||p.focus()})}return q(()=>{window.addEventListener("keydown",S)}),F(()=>{window.removeEventListener("keydown",S)}),(p,n)=>(s(),a("div",null,[e("div",{class:$(["flex justify-center items-center",y.variant===1?"gap-5":"gap-2"])},[e("button",{onClick:n[0]||(n[0]=g=>h("accept"))},[y.variant===1?(s(),a("span",W,"✔")):u("",!0),y.variant===2?(s(),a("span",X,n[4]||(n[4]=[e("span",{class:"text-base scale-110"},"✔",-1),e("span",{class:"hidden md:inline"},"Approve",-1)]))):u("",!0)]),e("button",{onClick:n[1]||(n[1]=g=>h("reject"))},[y.variant===1?(s(),a("span",Y,"❌")):u("",!0),y.variant===2?(s(),a("span",ee,n[5]||(n[5]=[e("span",{class:"text-base"},"❌",-1),e("span",{class:"hidden md:inline"},"Reject",-1)]))):u("",!0)])],2),l.value?(s(),a("div",{key:0,class:"fixed inset-0 z-50 flex justify-center items-center bg-black/50",onClick:U(b,["self"])},[e("div",te,[e("h3",se,v(R.value),1),e("div",null,[D(e("textarea",{"onUpdate:modelValue":n[2]||(n[2]=g=>o.value=g),rows:"7",placeholder:t.value==="accept"?"Accept Note...":"Rejection Reason...",class:"w-full border rounded-lg p-2 text-gray-700",required:t.value==="reject",onInput:n[3]||(n[3]=g=>o.value.length>f.value?o.value=o.value.slice(0,f.value):null)},null,40,ae),[[E,o.value]]),e("div",ne,[e("div",{class:$(["ml-auto inline-block text-sm text-gray-500",o.value.length>=f.value?"text-red-500":""])}," left "+v(d.value)+"/"+v(f.value)+" words ",3)])]),e("div",le,[e("button",{ref_key:"cancelBtnRef",ref:c,class:"btn-3 focus:ring-2 ring-offset-2 disabled:opacity-30",onClick:b,disabled:x.value}," Cancel ",8,oe),e("button",{ref_key:"confirmBtnRef",ref:T,class:$(["focus:ring-2 ring-offset-2 disabled:opacity-30",t.value==="reject"?"btn-2-red":"btn-2-green"]),onClick:H,disabled:x.value},[n[6]||(n[6]=N(" Confirm ")),e("span",re,v(t.value),1)],10,ie)])])])):u("",!0)]))}},ue={class:"my-container space-y-4 px-4 py-4 relative"},de={class:"md:text-2xl font-semibold capitalize text-gray-700"},pe={key:0,class:"ml-auto text-xs bg-red-500 text-white rounded-full px-2 py-0.5 font-semibold"},fe={key:1,class:"space-y-4"},me={class:"flex gap-2 md:gap-3 items-center"},ve={class:"shrink grow font-semibold text-sm md:text-base"},ye=["innerHTML"],xe={class:"ml-auto shrink-0 grow-0 flex gap-2 md:gap-3 items-center"},ge=["innerHTML"],_e={key:0,class:"flex flex-wrap gap-y-1 gap-x-3 items-center text-xs md:text-sm lg:text-base"},he={key:0},be={class:"flex gap-3 items-center"},ke={class:"flex items-center gap-8"},we={key:0,class:"flex flex-wrap flex-col md:flex-row gap-x-1 text-xs md:text-sm text-left"},Te={key:0,class:"hidden md:inline font-bold"},Re=["innerHTML"],je={key:2,class:"h-[80vh] flex items-center justify-center border rounded-md bg-white/50 text-gray-400"},Ne={__name:"MyTaskNotificationList",setup(y){const i=K(),r=B(),{notifications:k,notification_count:f}=O(r),d=_(!1);q(async()=>{i.params.type&&(d.value=!0,await r.fetchTaskNotification(i.params.type),d.value=!1)});async function L(){d.value=!0,await r.fetchTaskNotification(i.params.type),d.value=!1}Z(()=>i.params.type,async(c,t)=>{c&&c!==t&&(d.value=!0,await r.fetchTaskNotification(c),d.value=!1)});const w=c=>{if(i.params.type=="pending-requirements")return{name:"RequirementShow",params:{id:c.application_id}}},T=j(()=>i.params.type?i.params.type.replace(/[_-]/g," ").replace(/([A-Z])/g," $1").replace(/\s+/g," ").trim().split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1)).join(" "):"");return(c,t)=>{var x;const o=G("RouterLink");return s(),a("div",ue,[e("h2",de,[N(v(T.value||"Notifications")+" ",1),m(f)[m(i).params.type]?(s(),a("span",pe,v(m(f)[m(i).params.type]),1)):u("",!0)]),d.value||m(r).loading?(s(),P(I,{key:0,class:"absolute inset-0 flex items-center justify-center bg-opacity-80 !shadow-none min-h-[80vh]"})):u("",!0),((x=m(k))==null?void 0:x.length)>0?(s(),a("div",fe,[(s(!0),a(C,null,M(m(k),l=>{var R;return s(),a("div",{key:l.application_id,class:"bg-white p-3 md:p-4 rounded-xl shadow border grid gap-2"},[e("div",me,[e("div",ve,[e("div",{class:"flex items-center text-green-600 text-xs md:text-sm lg:text-base",innerHTML:l.title},null,8,ye),e("div",null,v(l.user_name),1)]),e("div",xe,[A(o,{to:w(l),class:"btn-1 px-3"},{default:Q(()=>t[1]||(t[1]=[e("i",{class:"far fa-eye"},null,-1)])),_:2,__:[1]},1032,["to"])])]),e("div",{class:"text-red-600 text-xs md:text-sm lg:text-base line-clamp-1 pr-12",innerHTML:l.description},null,8,ge),l.type?(s(),a("div",_e,[l.type?(s(),a("div",he,[t[2]||(t[2]=e("span",{class:"text-gray-400"},"Type:",-1)),N(" "+v(l.type),1)])):u("",!0)])):u("",!0),e("div",be,[e("div",ke,[(R=l.messages)!=null&&R.length?(s(),a("p",we,[(s(!0),a(C,null,M(l.messages,(h,b)=>(s(),a(C,{key:b},[b?(s(),a("span",Te,"|")):u("",!0),e("span",{innerHTML:h,class:"text-black"},null,8,Re)],64))),128))])):u("",!0)]),A(ce,{class:"ml-auto",notificationType:m(i).params.type,applicationId:l==null?void 0:l.application_id,onSuccess:L,variant:2,onLoading:t[0]||(t[0]=h=>d.value=h)},null,8,["notificationType","applicationId"])])])}),128))])):d.value?u("",!0):(s(),a("div",je," No notifications found. "))])}}};export{Ne as default};
