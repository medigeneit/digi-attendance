import{g as te,f as le,x as n,r as se,h as ae,q as H,p as oe,c as y,o as m,a as t,k as f,t as _,j as R,d as I,m as S,F as W,n as v,l as M,G as ne,P as B,s as z,e as ue,b as j,w as re}from"./index-cDReJAxe.js";import{g as ie}from"./task-DW4hEa2K.js";import{u as de}from"./company-Cv20eCG5.js";import{_ as K}from"./CompanyDepartmentSelectInput-B-fhvA8l.js";import{_ as me}from"./EmployeeDropdownInput-DNnPS9nt.js";import{_ as J}from"./SearchInput-Y12deGhT.js";const pe={class:"mb-4"},ce={class:"flex items-start justify-between gap-4 border-b mb-6"},ve={class:"text-xl font-semibold text-slate-800 flex items-center gap-3 mb-2"},ye={key:0,class:"ml-auto"},fe={class:"flex flex-wrap items-center gap-3 mt-3"},xe={class:"flex flex-wrap flex-grow gap-4 items-center"},be={key:1,class:"relative w-full md:w-56 lg:flex-grow"},ge={class:"relative"},ke={class:"w-32 relative h-8"},we={class:"flex gap-4 items-center flex-shrink-0 text-sm"},Ve={class:"flex items-center gap-2"},Ce={class:"flex items-center gap-2"},Te={class:"flex items-center gap-2"},Me={class:"flex flex-col lg:flex-row mb-2 items-center gap-4 sticky top-[4.1rem] z-40 mt-6"},Ae={class:"flex items-center gap-3 flex-grow flex-wrap"},Ue={key:0,class:"text-[9px] text-green-800"},De=["onClick"],he={key:1,class:"flex justify-end gap-3"},Be={__name:"TaskHeader",props:{modelValue:{type:Object,default:()=>({})},listHasRearranged:{type:Boolean,default:!1},isMyTask:{type:Boolean,default:!1}},emits:["update:modelValue","clickPrioritySave","clickPriorityDiscard","clickAddTask"],setup(g,{emit:Q}){const A=g,F=te(),x=le(),k=n(r("company-id")),w=n(r("from-department-id")),b=n(r("to-department-id")),U=n(r("user-ids")),O=n(r("month")),D=n(r("status")),h=n(r("is-important")),L=n(r("is-urgent")),E=n(r("is-target")),q=n(r("is-closed")),N=n(r("search")),P=Q,p=de(),V=se([]);function r(a){return{get:()=>A.modelValue[a]||"",set:e=>{P("update:modelValue",{...A.modelValue,[a]:e||void 0})}}}const X=n(()=>Y(U.value));async function $(){var a,e,i;if(!A.isMyTask){const d=(a=A.modelValue)==null?void 0:a["company-id"],s=b.value,u={...d?{company_id:d}:{},...s?{department_ids:[s]}:{}};V.value=((i=(e=await ie({params:u}))==null?void 0:e.data)==null?void 0:i.employees)||[]}}ae(async()=>{await p.fetchCompanies({with:"departments",ignore_permission:!0}),await p.fetchMyCompanies({with:"departments"}),await $()});function Y(a){return Array.isArray(V.value)&&V.value.find(e=>e.id==a)||null}function Z(){U.value=""}H(()=>b.value,$),H(()=>k.value,()=>{w.value="",b.value=""});function C(a,e,{value:i,id:d,label:s,onCancel:u}={}){if(!a)return[];const o=Array.isArray(e)?e.find(c=>(c==null?void 0:c[d])==a):null;return o?[{label:s,value:typeof i=="function"?i(o):o==null?void 0:o[i],id:o==null?void 0:o[d],onCancel:u}]:[]}const ee=n(()=>{var d;const a=p.companies.reduce((s,u)=>[...s,...u.departments],[]),e=(s,{label:u,value:o,id:c,onCancel:l})=>s?[{label:u,value:o,id:c,onCancel:l}]:[],i=(s,{label:u,onCancel:o})=>{if(!s)return[];const c=new Date(s);return[{label:u,value:c.toLocaleDateString("en-US",{month:"long",year:"numeric"}),id:s,onCancel:o}]};return[...C(k.value,p.companies,{label:"Company",value:"short_name",id:"id",onCancel:()=>{k.value=""}}),...C(w.value,a,{id:"id",label:"From",value:s=>s.short_name||s.name,onCancel:()=>{w.value=""}}),...C(b.value,a,{id:"id",label:"To",value:s=>s.short_name||s.name,onCancel:()=>{b.value=""}}),...C((d=X.value)==null?void 0:d.id,V.value,{label:"Employee",value:"name",id:"id",onCancel:Z}),...C(D.value,[{id:"only-completed",name:"Completed Only"},{id:"not-completed",name:"Not Completed"}],{label:"",value:"name",id:"id",onCancel:()=>{D.value=""}}),...e(h.value,{label:"",value:"Important ",id:!0,onCancel:()=>{h.value=""}}),...e(L.value,{label:"",value:"Urgent ",id:!0,onCancel:()=>{L.value=""}}),...e(E.value,{label:"",value:"Targeted Task",id:!0,onCancel:()=>{E.value=""}}),...i(O.value,{label:"",onCancel:()=>{O.value=""}})]}),G=n(()=>k.value?p==null?void 0:p.companies.filter(a=>a.id==k.value):p==null?void 0:p.companies);return(a,e)=>{var d,s,u,o,c;const i=oe("RouterLink");return m(),y("div",null,[t("div",pe,[t("div",ce,[t("h2",ve,[e[11]||(e[11]=t("i",{class:"fad fa-tasks text-sky-600"},null,-1)),t("span",null,_(q.value?"Closed":"")+" Task List",1)]),g.isMyTask?f("",!0):(m(),y("div",ye,[t("button",{onClick:e[0]||(e[0]=l=>P("clickAddTask")),class:"inline-flex items-center gap-2 px-3 py-1 bg-sky-600 hover:bg-sky-700 text-white rounded-md shadow-sm text-sm"},e[12]||(e[12]=[t("i",{class:"fad fa-plus-circle"},null,-1),t("span",null,"Add Task",-1)]))]))]),t("div",fe,[t("div",xe,[I(K,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=l=>w.value=l),companies:G.value||[],class:"relative w-full md:w-48",className:{select:"h-8 text-sm border border-gray-200 bg-white"},defaultOption:"--ALL DEPARTMENT--"},{label:S(()=>e[13]||(e[13]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task From Department ",-1)])),_:1},8,["modelValue","companies"]),g.isMyTask?f("",!0):(m(),y(W,{key:0},[v(x).name!=="MyRequirementTaskList"?(m(),R(K,{key:0,modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l),companies:G.value||[],class:"relative w-full md:w-40 flex-grow",className:{select:"h-8 text-sm border border-gray-200 bg-white"},defaultOption:"--ALL DEPARTMENT--"},{label:S(()=>e[14]||(e[14]=[t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Task To Department ",-1)])),_:1},8,["modelValue","companies"])):f("",!0),v(F).isAdminMood&&((s=(d=v(F))==null?void 0:d.user)==null?void 0:s.role)!=="employee"?(m(),y("div",be,[t("div",ge,[I(me,{employees:V.value,modelValue:U.value,"onUpdate:modelValue":e[3]||(e[3]=l=>U.value=l),class:"border border-gray-200 rounded h-8 w-full bg-white text-sm"},null,8,["employees","modelValue"]),e[15]||(e[15]=t("div",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 leading-none z-30"}," Employee ",-1))]),e[16]||(e[16]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500 z-50"}," Employee ",-1))])):f("",!0)],64)),t("div",ke,[e[18]||(e[18]=t("label",{class:"absolute text-xs left-3 -top-1.5 bg-white text-sky-600"},"Status",-1)),M(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>D.value=l),class:"h-full text-sm px-2 text-gray-700 border border-gray-200 rounded-md w-full"},e[17]||(e[17]=[t("option",{value:""},"--ALL TASKS--",-1),t("option",{value:"not-completed"},"Not Completed",-1),t("option",{value:"only-completed"},"Completed",-1)]),512),[[ne,D.value]])]),t("div",we,[t("label",Ve,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=l=>h.value=l),class:"accent-sky-600"},null,512),[[B,h.value]]),e[19]||(e[19]=t("span",null,"Important",-1))]),t("label",Ce,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=l=>L.value=l),class:"accent-sky-600"},null,512),[[B,L.value]]),e[20]||(e[20]=t("span",null,"Urgent",-1))]),t("label",Te,[M(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=l=>E.value=l),class:"accent-sky-600"},null,512),[[B,E.value]]),e[21]||(e[21]=t("span",null,"Is Target",-1))]),t("label",{class:z(["flex items-center gap-2 px-2 rounded h-8",q.value?"bg-sky-800 text-white":"text-sky-800 border border-sky-200"])},[M(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=l=>q.value=l),class:"accent-sky-600"},null,512),[[B,q.value]]),e[22]||(e[22]=t("span",null,"Closed",-1))],2)])]),g.isMyTask?(m(),R(J,{key:0,modelValue:N.value,"onUpdate:modelValue":e[9]||(e[9]=l=>N.value=l),class:"w-full md:w-64 lg:w-64 md:ml-auto h-8"},null,8,["modelValue"])):f("",!0)])]),t("div",Me,[g.isMyTask?f("",!0):(m(),R(J,{key:0,modelValue:N.value,"onUpdate:modelValue":e[10]||(e[10]=l=>N.value=l),class:"w-full md:w-64 md:ml-auto"},null,8,["modelValue"])),t("div",Ae,[(m(!0),y(W,null,ue(ee.value,l=>(m(),y("div",{key:l.label||l.value,class:"inline-flex items-center gap-2 text-xs bg-gray-50 border border-gray-200 rounded-md px-2 py-1"},[t("div",null,[l.label?(m(),y("span",Ue,_(l.label)+": ",1)):f("",!0),j(_(l.value),1)]),t("button",{type:"button",class:"text-gray-400 hover:text-red-500",onClick:re(l.onCancel,["prevent"])},e[23]||(e[23]=[t("i",{class:"fas fa-times-circle"},null,-1)]),8,De)]))),128))]),g.isMyTask?f("",!0):(m(),y("div",he,[I(i,{class:z(["text-xs sm:text-sm px-3 py-1 rounded border",((u=v(x).query)==null?void 0:u.view)==="userwise"?"bg-sky-600 text-white border-sky-600":"bg-white text-slate-700"]),to:{query:{...v(x).query,view:"userwise"}}},{default:S(()=>e[24]||(e[24]=[j(" User Wise List ")])),_:1,__:[24]},8,["class","to"]),I(i,{class:z(["text-xs sm:text-sm px-3 py-1 rounded border",((o=v(x).query)==null?void 0:o.view)!=="userwise"?"bg-sky-600 text-white border-sky-600":"bg-white text-slate-700"]),to:{query:{...Object.keys(((c=v(x))==null?void 0:c.query)||{}).filter(l=>{var T;return((T=v(x))==null?void 0:T.query[l])!=="userwise"}).reduce((l,T)=>({...l,[T]:v(x).query[T]}),{})}}},{default:S(()=>e[25]||(e[25]=[j(" Department Wise List ")])),_:1,__:[25]},8,["class","to"])]))])])}}};export{Be as _};
