import{r as h,e as G,c as m,o as l,a as e,f as D,g as f,w as k,F as R,h as E,j as T,y as C,v as F,i as S,A as oe,t as x,p as be,C as ie,x as M,n as H,q as ce,k as ne,b as ve,u as fe,z as j}from"./index-CijbHKK9.js";import{L as W}from"./LoaderView-D_6hHg3u.js";import{O as z}from"./OverlyModal-CLIO6qo4.js";import{R as ae}from"./RequiredIcon-Cw78CLmk.js";import{f as J}from"./requirement-BFfA1_uh.js";import{a as xe,f as de,d as ye,u as ge,_ as we}from"./TaskAddForm-DrbK6tIQ.js";import{u as ue}from"./department-BGvwZoT-.js";import{S as me}from"./SelectDropdown-DUugRK1v.js";import{_ as B}from"./UserChip-D6MNjjpR.js";import{u as pe}from"./user-VvjOXRmx.js";import{_ as ke}from"./TaskUserChip-C0QmOAJt.js";import{u as _e}from"./useTaskStore-CEvczbMw.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./company-og68Gr4z.js";import"./url-CePbr-gY.js";import"./CompanyDepartmentSelectInput-CMQIQdGs.js";import"./SectionLoading-MyDb9Iz1.js";import"./TextWithHr-CFifGUzI.js";import"./TaskUrgencyInput-BKgQg0bJ.js";const he={class:"sticky top-0 pt-4 bg-white z-10"},$e={class:"mb-4"},qe={class:"block text-gray-600 text-sm mb-1 font-medium"},Ce={class:"mb-4"},De={class:"mb-4"},Ie={class:"mb-4"},Se={class:"mb-4"},Re={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},Te={key:0,class:"mb-4 text-red-500 font-medium"},Ee={key:1,class:"mb-4"},Ve={class:"flex items-center justify-between gap-4"},Ne=["disabled"],Ue={__name:"RequirementDetailAddForm",props:{requirementId:{type:[Number,String],required:!0}},emits:["create","closeClick","error"],setup(y,{emit:I}){const _=y,v=I,a=ue(),w=h(),u=h(""),o=h(),s=h({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),g=h([]);async function d(){var r,b;u.value="submitting";const c={...s.value};console.log({payload:c});try{const p=await xe(_.requirementId,c);v("create",p),u.value="create"}catch(p){u.value="error",o.value=((b=(r=p.response)==null?void 0:r.data)==null?void 0:b.message)||"Failed to create requirement detail",v("error",o.value)}}return G(async()=>{var r;const c=((r=(await J(_.requirementId)).data)==null?void 0:r.requirement)||{};g.value=await a.fetchDepartmentEmployee([c.from_department_id])}),(c,r)=>(l(),m("div",{class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative",ref_key:"formContainerRef",ref:w},[e("div",he,[r[7]||(r[7]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Add Requirement",-1)),r[8]||(r[8]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:r[0]||(r[0]=k(b=>v("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:k(d,["prevent"]),class:"z-0"},[u.value!=="loading"?(l(),m(R,{key:0},[e("div",$e,[e("label",qe,[r[9]||(r[9]=T("Title ")),C(ae)]),E(e("input",{"onUpdate:modelValue":r[1]||(r[1]=b=>s.value.title=b),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,s.value.title]])]),e("div",Ce,[r[10]||(r[10]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Details",-1)),E(e("textarea",{rows:"10","onUpdate:modelValue":r[2]||(r[2]=b=>s.value.description=b),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,s.value.description]])]),e("div",De,[r[12]||(r[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),C(me,{modelValue:s.value.supervisor_id,"onUpdate:modelValue":r[3]||(r[3]=b=>s.value.supervisor_id=b),options:g.value,placeholder:"--NO SUPERVISOR--",containment:w.value,clearable:"",class:"h-10"},{"list-header":S(()=>r[11]||(r[11]=[e("div",{class:"px-3 pt-2 pb-1 shadow-md text-xs uppercase bg-gray-50 text-gray-500"}," Employees ",-1)])),option:S(({option:b})=>[C(B,{user:b||{},class:"pr-5 -mx-1"},null,8,["user"])]),"selected-option":S(({option:b})=>[b?(l(),D(B,{key:0,user:b||{},class:"pr-4"},null,8,["user"])):f("",!0)]),_:1},8,["modelValue","options","containment"])]),e("div",Ie,[r[14]||(r[14]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),E(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":r[4]||(r[4]=b=>s.value.priority=b)},r[13]||(r[13]=[e("option",{value:""},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[oe,s.value.priority]])]),e("div",Se,[r[15]||(r[15]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),E(e("input",{type:"date","onUpdate:modelValue":r[5]||(r[5]=b=>s.value.better_to_complete_on=b),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,s.value.better_to_complete_on]])])],64)):f("",!0),e("div",Re,[o.value?(l(),m("div",Te,x(o.value),1)):f("",!0),o.value?(l(),m("hr",Ee)):f("",!0),e("div",Ve,[e("button",{type:"button",onClick:r[6]||(r[6]=k(b=>v("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:u.value=="loading"||u.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},x(u.value=="submitting"?"Saving...":"Add Requirement"),9,Ne)])])],32),u.value==="loading"||u.value==="submitting"?(l(),D(W,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)],512))}},Fe={class:"max-h-[90vh] overflow-auto w-full mx-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},Le={class:"mb-4"},Ae={class:"font-semibold"},Me={class:"mb-4"},Oe={class:"line-clamp-2"},Pe={key:1,class:"min-h-40"},je={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},ze={key:0,class:"mb-4 text-red-500 font-medium"},Be={key:1,class:"mb-4"},Ge={class:"flex items-center justify-between gap-4"},We=["disabled"],He={__name:"RequirementDetailDeleteForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["delete","closeClick","error"],setup(y,{emit:I}){const _=y,v=I,a=pe(),w=h(null),u=h(""),o=h(),s=h([]);async function g(){var d,c;u.value="submitting";try{const r=await ye(_.requirementId,_.detailId);v("delete",r),u.value="create"}catch(r){u.value="error",o.value=((c=(d=r.response)==null?void 0:d.data)==null?void 0:c.message)||"Failed to update requirement detail: "+r,v("error",o.value)}}return G(async()=>{var d,c,r;u.value="loading";try{s.value=await a.fetchDepartmentWiseEmployees(),w.value=(d=(await de(_.requirementId,_.detailId)).data)==null?void 0:d.detail}catch(b){o.value=((r=(c=b.response)==null?void 0:c.data)==null?void 0:r.message)||"Failed to fetch requirement detail"}finally{u.value=""}}),(d,c)=>{var r,b;return l(),m("div",Fe,[c[4]||(c[4]=e("div",{class:"sticky top-0 -mx-6 px-6 z-10 bg-gray-50"},[e("h2",{class:"text-xl font-semibold text-gray-800 py-2"},"Delete Requirement Details"),e("hr",{class:"mb-4 -mx-6"})],-1)),e("form",{onSubmit:k(g,["prevent"]),class:"z-0"},[u.value!=="loading"?(l(),m(R,{key:0},[e("div",Le,[c[1]||(c[1]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Title",-1)),e("div",Ae,x((r=w.value)==null?void 0:r.title),1)]),e("div",Me,[c[2]||(c[2]=e("div",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),e("div",Oe,x((b=w.value)==null?void 0:b.description),1)]),c[3]||(c[3]=e("div",{class:"my-8 text-center text-xl text-red-600"},"Are you sure want to delete?",-1))],64)):(l(),m("div",Pe)),e("div",je,[o.value?(l(),m("div",ze,x(o.value),1)):f("",!0),o.value?(l(),m("hr",Be)):f("",!0),e("div",Ge,[e("button",{type:"button",onClick:c[0]||(c[0]=k(p=>v("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:u.value=="loading"||u.value=="submitting",type:"submit",class:"bg-red-700 hover:bg-red-500 text-white font-semibold px-5 py-2 rounded transition"},x(u.value=="submitting"?"Deleting...":"Delete"),9,We)])])],32),u.value==="loading"||u.value==="submitting"?(l(),D(W,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)])}}},Je={class:"sticky top-0 pt-4 bg-white z-10"},Ke={class:"mb-4"},Qe={class:"block text-gray-600 text-sm mb-1 font-medium"},Xe={class:"mb-4"},Ye={class:"mb-4"},Ze={key:0,class:"relative w-full"},et={key:0,class:"absolute right-1 text-xl top-0 bottom-0 flex items-center"},tt={class:"mb-4"},st={class:"mb-4"},rt={class:"sticky bottom-0 bg-white py-4 border-t -mx-6 px-6"},lt={key:0,class:"mb-4 text-red-500 font-medium"},ot={key:1,class:"mb-4"},it={class:"flex items-center justify-between gap-4"},nt=["disabled"],at={__name:"RequirementDetailEditForm",props:{requirementId:{type:[Number,String],required:!0},detailId:{type:[Number,String],required:!0}},emits:["update","closeClick","error"],setup(y,{emit:I}){const _=y,v=I,a=h(),w=pe(),u=ue(),o=h(null),s=h(""),g=h(),d=h({title:"",description:"",priority:"",better_to_complete_on:"",supervisor_id:null}),c=h([]),r=h([]);async function b(){var i,q;s.value="submitting";const p={...d.value};try{const n=await ge(_.requirementId,_.detailId,p);v("update",n),s.value="create"}catch(n){s.value="error",g.value=((q=(i=n.response)==null?void 0:i.data)==null?void 0:q.message)||"Failed to update requirement detail",v("error",g.value)}}return G(async()=>{var p,i,q,n,t,V,L,A;s.value="loading";try{c.value=await w.fetchDepartmentWiseEmployees();const N=((p=(await J(_.requirementId)).data)==null?void 0:p.requirement)||{};r.value=await u.fetchDepartmentEmployee([N.from_department_id]),o.value=(i=(await de(_.requirementId,_.detailId)).data)==null?void 0:i.detail,d.value={title:(q=o.value)==null?void 0:q.title,description:(n=o.value)==null?void 0:n.description,priority:(t=o.value)==null?void 0:t.priority,supervisor_id:(V=o.value)==null?void 0:V.supervisor_id};const O=new Date(o.value.better_to_complete_on);d.value.better_to_complete_on=O.toISOString().split("T")[0]}catch(N){g.value=((A=(L=N.response)==null?void 0:L.data)==null?void 0:A.message)||"Failed to fetch requirement detail"}finally{s.value=""}}),(p,i)=>{var q;return l(),m("div",{ref_key:"formContainerRef",ref:a,class:"max-h-[90vh] w-full mx-auto overflow-auto bg-white shadow-lg rounded-lg p-6 pb-0 pt-0 relative"},[e("div",Je,[i[8]||(i[8]=e("h2",{class:"text-2xl font-semibold text-gray-800"},"Edit Requirement",-1)),i[9]||(i[9]=e("hr",{class:"mb-4"},null,-1)),e("div",{class:"text-purple-600/80 mb-4 text-xs border-b border-dashed",onClick:i[0]||(i[0]=k(n=>v("ok"),["prevent"]))}," Fields that must be filled in will be marked with an asterisk. ")]),e("form",{onSubmit:k(b,["prevent"]),class:"z-0"},[s.value!=="loading"?(l(),m(R,{key:0},[e("div",Ke,[e("label",Qe,[i[10]||(i[10]=T("Title ")),C(ae)]),E(e("input",{"onUpdate:modelValue":i[1]||(i[1]=n=>d.value.title=n),required:"",placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,d.value.title]])]),e("div",Xe,[i[11]||(i[11]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Description",-1)),E(e("textarea",{rows:"10","onUpdate:modelValue":i[2]||(i[2]=n=>d.value.description=n),placeholder:"Enter requirement description",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,d.value.description]])]),e("div",Ye,[i[12]||(i[12]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Supervisor",-1)),C(me,{modelValue:d.value.supervisor_id,"onUpdate:modelValue":i[4]||(i[4]=n=>d.value.supervisor_id=n),options:[...r.value,...r.value.find(n=>{var t,V;return n.id==((V=(t=o.value)==null?void 0:t.supervisor)==null?void 0:V.id)})?[]:[(q=o.value)==null?void 0:q.supervisor]],containment:a.value,placeholder:"--NO SUPERVISOR--",class:"h-10"},{option:S(({option:n})=>[C(B,{user:n||{}},null,8,["user"])]),"selected-option":S(({option:n})=>[n?(l(),m("div",Ze,[C(B,{user:n||{}},null,8,["user"]),d.value.supervisor_id?(l(),m("div",et,[e("button",{onClick:i[3]||(i[3]=k(t=>d.value.supervisor_id=null,["prevent"])),class:"text-gray-6 font-semibold 00 hover:text-red-700"}," × ")])):f("",!0)])):f("",!0)]),_:1},8,["modelValue","options","containment"])]),e("div",tt,[i[14]||(i[14]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Priority ",-1)),E(e("select",{class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":i[5]||(i[5]=n=>d.value.priority=n)},i[13]||(i[13]=[e("option",{value:null},"NORMAL",-1),e("option",null,"IMPORTANT",-1),e("option",null,"URGENT",-1)]),512),[[oe,d.value.priority]])]),e("div",st,[i[15]||(i[15]=e("label",{class:"block text-gray-600 text-sm mb-1 font-medium"},"Better to Complete ",-1)),E(e("input",{type:"date","onUpdate:modelValue":i[6]||(i[6]=n=>d.value.better_to_complete_on=n),placeholder:"EnderRequirement detail title",class:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500"},null,512),[[F,d.value.better_to_complete_on]])])],64)):f("",!0),e("div",rt,[g.value?(l(),m("div",lt,x(g.value),1)):f("",!0),g.value?(l(),m("hr",ot)):f("",!0),e("div",it,[e("button",{type:"button",onClick:i[7]||(i[7]=k(n=>v("closeClick"),["prevent"])),class:"bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold px-5 py-2 rounded transition"}," Cancel "),e("button",{disabled:s.value=="loading"||s.value=="submitting",type:"submit",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-5 py-2 rounded transition"},x(s.value=="submitting"?"Saving...":"Edit Detail"),9,nt)])])],32),s.value==="loading"||s.value==="submitting"?(l(),D(W,{key:0,class:"z-20 absolute inset-0 flex items-center justify-center bg-opacity-30"})):f("",!0)],512)}}},dt=["rowspan"],ut={class:"text-2xl font-medium"},mt=["rowspan"],pt={class:"text-lg font-semibold mb-2"},bt={class:"mb-5"},ct={class:"text-justify"},vt=["innerHTML"],ft={class:"flex items-end"},xt={class:"flex items-center gap-1 mb-3"},yt={class:"text-blue-400 font-semibold"},gt={class:"ml-auto flex gap-6 items-center"},wt=["rowspan"],kt={class:"border-2 border-gray-700 p-3 text-center"},_t=["title"],ht={class:"border-2 border-gray-700 p-3"},$t={class:"whitespace-nowrap text-center print:whitespace-break-spaces"},qt={key:0},Ct={key:1,class:"text-gray-500"},Dt={key:2,colspan:"2",class:"border-2 border-gray-700 p-3 text-center"},It={__name:"RequirementDetailTableRow",props:{detail:{type:Object},serial:{type:Number}},emits:["editClick","deleteClick","taskCreateClick"],setup(y,{emit:I}){const _=y,v=I,a=h("line-clamp-2");function w(){a.value=a.value?"":"line-clamp-2"}const u=be(()=>{var o,s,g;return((s=(o=_.detail)==null?void 0:o.tasks)==null?void 0:s.length)>0?(g=_.detail)==null?void 0:g.tasks:[{id:0}]});return(o,s)=>{const g=ie("RouterLink");return l(!0),m(R,null,M(u.value,(d,c)=>{var r,b,p,i,q,n;return l(),m("tr",{key:d.id,class:"group/item border text-gray-800 py-4 shadow-sm mb-4 px-4 rounded-md hover:bg-blue-50"},[c===0?(l(),m(R,{key:0},[e("td",{class:"border-2 border-gray-700 p-3 align-top",rowspan:((b=(r=y.detail)==null?void 0:r.tasks)==null?void 0:b.length)||1},[e("span",ut,x(y.serial),1)],8,dt),e("td",{class:"border-2 border-gray-700 p-3",rowspan:((i=(p=y.detail)==null?void 0:p.tasks)==null?void 0:i.length)||1},[e("div",null,[e("div",pt,[e("span",null,x(y.detail.title),1)]),s[4]||(s[4]=e("hr",{class:"mb-4 -mx-4"},null,-1)),e("div",bt,[s[3]||(s[3]=e("div",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Description",-1)),e("div",ct,[e("p",{class:H(["print:line-clamp-none",a.value]),innerHTML:y.detail.description},null,10,vt),e("button",{class:"text-blue-500 group-hover/item:underline hover:text-sky-400 ml-auto text-sm print:hidden",onClick:k(w,["prevent"])},x(a.value?"Show More":"Show Less"),1)])])]),e("div",ft,[e("div",null,[e("div",xt,[s[5]||(s[5]=e("span",{class:"text-gray-400 mr-2 text-xs uppercase font-semibold"},"Supervisor:",-1)),y.detail.supervisor?(l(),D(ke,{key:0,user:y.detail.supervisor},null,8,["user"])):f("",!0)]),e("div",null,[s[6]||(s[6]=e("span",{class:"text-gray-500 mr-2 text-xs uppercase font-semibold"},"Priority:",-1)),e("span",yt,x(y.detail.priority),1)])]),e("div",gt,[e("button",{class:"btn-2",onClick:s[0]||(s[0]=k(t=>v("editClick",y.detail),["prevent"]))},s[7]||(s[7]=[e("i",{class:"fas fa-edit"},null,-1),T("Edit ")])),e("button",{class:"btn-2-red",onClick:s[1]||(s[1]=k(t=>v("deleteClick",y.detail),["prevent"]))},s[8]||(s[8]=[e("i",{class:"fas fa-trash-alt"},null,-1),T("Delete ")]))])])],8,mt),e("td",{class:"border-2 border-gray-700 p-3 whitespace-nowrap print:whitespace-break-spaces print:px-0 text-center",rowspan:((n=(q=y.detail)==null?void 0:q.tasks)==null?void 0:n.length)||1},[e("div",null,x(new Date(y.detail.better_to_complete_on).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",weekday:"short"})),1)],8,wt)],64)):f("",!0),d.id?(l(),m(R,{key:1},[e("td",kt,[C(g,{to:{name:"TaskShow",params:{id:d.id}},class:"hover:underline text-gray-900 hover:text-blue-600 whitespace-nowrap block",target:"_blank"},{default:S(()=>[T(x(d.id)+" ",1),e("i",{title:d.status,class:H(["ml-1",{"fad fa-exclamation-circle text-red-600":d.status=="PENDING","fad fa-exclamation-square text-yellow-600":d.status=="IN_PROGRESS","fad fa-check-circle text-green-600":d.status=="COMPLETED"}])},null,10,_t)]),_:2},1032,["to"])]),e("td",ht,[e("div",$t,[d.deadline?(l(),m("div",qt,x(new Date(d.deadline).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",weekday:"short"})),1)):(l(),m("div",Ct,"-"))])])],64)):(l(),m("td",Dt,[e("button",{onClick:s[2]||(s[2]=k(t=>v("taskCreateClick",y.detail),["prevent"])),class:"print:hidden hover:border-2 group-hover/item:bg-blue-200 hover:border-blue-700 text-blue-500 hover:text-white hover:!bg-blue-500 rounded-md px-4 py-1"}," Create Task ")]))])}),128)}}},St={class:"text-left p-4"},Rt={class:"flex items-center gap-6 justify-center my-10"},Tt={key:0,class:"border rounded-md"},Et={class:"flex flex-col justify-start items-start min-h-28 max-h-[70vh] overflow-y-auto"},Vt=["onClick"],Nt={class:"mt-[1px]"},Ut=["onClick"],Ft={__name:"TaskParentIdSelector",props:{fromDepartmentId:{type:Number}},emits:["parentIdSelect"],setup(y,{emit:I}){const _=y,v=I,a=_e(),w=h(!1);return ce(()=>w.value,u=>{u&&a.fetchTasks({"to-department-id":_.fromDepartmentId})},{immediate:!0}),(u,o)=>(l(),m("div",St,[e("div",Rt,[e("button",{onClick:o[0]||(o[0]=k(s=>v("parentIdSelect",0),["prevent"])),class:"btn-3"},"Add as Main Task"),o[2]||(o[2]=e("span",null,"or",-1)),e("button",{class:H({"btn-3":!w.value,"btn-2":w.value}),onClick:o[1]||(o[1]=k(s=>w.value=!0,["prevent"]))}," Add as Sub Task ",2)]),w.value?(l(),m("div",Tt,[o[4]||(o[4]=e("div",{class:"py-2 px-4 font-bold text-center border-b shadow"}," Click to select task or sub task ",-1)),e("div",Et,[(l(!0),m(R,null,M(ne(a).tasks,s=>(l(),m("div",{key:s.id,class:"w-full mb-2"},[e("button",{type:"button",class:"text-left text-base w-full bg-blue-50 px-2 hover:bg-blue-500 hover:text-white py-4 text-blue-500 font-semibold",onClick:k(g=>v("parentIdSelect",s.id),["prevent"])},x(s.title),9,Vt),e("div",Nt,[(l(!0),m(R,null,M(s.children_tasks||[],g=>(l(),m("div",{key:g.id,class:"border-b"},[e("button",{type:"button",class:"text-left text-sm w-full hover:bg-blue-500 hover:text-white py-2",onClick:k(d=>v("parentIdSelect",g.id),["prevent"])},[o[3]||(o[3]=e("span",{class:"text-gray-400"},"—",-1)),T(x(g.title),1)],8,Ut)]))),128))])]))),128))])])):f("",!0)]))}},Lt={class:"container mx-auto p-6 print:p-0 w-full print:max-w-full"},At={class:"bg-white rounded shadow print:shadow-none p-4 print:p-0 relative"},Mt={class:"flex items-start"},Ot={class:"mb-4 text-lg print:black print:font-bold"},Pt={class:"ml-auto print:hidden flex gap-2 items-center"},jt={class:"mb-4 flex items-center gap-1 print:mb-1"},zt={class:"font-bold print:text-gray-900"},Bt={class:"mb-4 print:flex print:items-center print:gap-3 print:mb-1"},Gt={class:"print:text-gray-900"},Wt={class:"mb-4 print:flex print:items-center print:gap-3 print:mb-1"},Ht={class:"flex items-center gap-2 print:text-gray-900 flex-wrap"},Jt={class:"mb-4 print:flex print:items-center print:gap-3 print:mb-1"},Kt={class:"print:text-gray-900"},Qt={key:0,class:"overflow-x-auto print:overflow-visible"},Xt={class:"w-full table-auto print:table-fixed"},Yt={colspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap px-3 py-1 print:whitespace-normal w-[25%]"},Zt={class:"whitespace-nowrap print:whitespace-break-spaces print:px-0 p-3 text-center border-2 border-gray-800"},es={class:"text-gray-900 text-base"},ts={class:"mt-8 border rounded-md p-8 flex items-center justify-center bg-gray-50"},ks={__name:"RequirementShow",setup(y){const I=ve(),_=fe(),v=h(""),a=h(null),w=j({open:!1}),u=j({detail:null,open:!1}),o=j({detail:null,open:!1});G(async()=>{await s()});async function s(){var n;v.value="loading",a.value=(n=(await J(I.params.id)).data)==null?void 0:n.requirement,v.value=""}function g(n){console.log({detail:n}),p.modalShown=!0,p.from_department_id=a.value.from_department_id,p.to_department_id=a.value.to_department_id,p.taskDefaultValues={title:n.title,description:n.description,from_department_id:a.value.from_department_id,to_department_id:a.value.to_department_id},p.requirementDetail=n}function d(){w.open=!0}function c(n){u.open=!0,u.detail=n}function r(n){o.open=!0,o.detail=n}function b(){window.print()}const p=j({parentId:null,modalShown:!1,requirementId:0,taskDefaultValues:{},requirementDetail:null});async function i(){p.parentId=0,p.parentId=null,p.modalShown=!1,p.requirementDetail=null,v.value="loading",await s()}async function q(){p.parentId=null,p.modalShown=!1,p.requirementDetail=null}return(n,t)=>{var L,A,N,O,K,Q,X,Y,Z,ee,te,se,re;const V=ie("RouterLink");return l(),m("div",Lt,[w.open?(l(),D(z,{key:0,class:"*:max-w-4xl"},{default:S(()=>[C(Ue,{requirementId:a.value.id,onCloseClick:t[0]||(t[0]=$=>w.open=!1),onCreate:t[1]||(t[1]=async()=>{w.open=!1,await s()})},null,8,["requirementId"])]),_:1})):f("",!0),u.open?(l(),D(z,{key:1},{default:S(()=>{var $;return[C(at,{requirementId:a.value.id,detailId:($=u.detail)==null?void 0:$.id,onCloseClick:t[2]||(t[2]=U=>u.open=!1),onUpdate:t[3]||(t[3]=async()=>{u.open=!1,await s()})},null,8,["requirementId","detailId"])]}),_:1})):f("",!0),o.open?(l(),D(z,{key:2},{default:S(()=>{var $;return[C(He,{requirementId:a.value.id,detailId:($=o.detail)==null?void 0:$.id,onCloseClick:t[4]||(t[4]=U=>o.open=!1),onDelete:t[5]||(t[5]=async()=>{o.open=!1,await s()})},null,8,["requirementId","detailId"])]}),_:1})):f("",!0),p.modalShown?(l(),D(z,{key:3,class:"*:relative"},{default:S(()=>{var $,U;return[e("button",{onClick:k(q,["prevent"]),class:"absolute right-3 top-2 text-xl text-red-500 hover:text-red-400"},t[8]||(t[8]=[e("i",{class:"fas fa-times-circle"},null,-1)])),p.parentId===null?(l(),D(Ft,{key:0,"from-department-id":($=a.value)==null?void 0:$.from_department_id,onParentIdSelect:t[6]||(t[6]=P=>p.parentId=P)},null,8,["from-department-id"])):(l(),D(we,{key:1,parentTaskId:p.parentId,requirementDetailId:(U=p==null?void 0:p.requirementDetail)==null?void 0:U.id,requirementId:a.value.id,onClose:q,onTaskCreated:i,defaultValues:p.taskDefaultValues,readonlyFields:{from_department_id:!0,to_department_id:!0}},null,8,["parentTaskId","requirementDetailId","requirementId","defaultValues"]))]}),_:1})):f("",!0),e("div",At,[e("div",Mt,[e("div",Ot,[t[9]||(t[9]=e("div",{class:"text-gray-800 leading-none"},"To",-1)),e("div",null,x((A=(L=a.value)==null?void 0:L.to_department)==null?void 0:A.name),1)]),e("div",Pt,[(((N=a.value)==null?void 0:N.details)||[]).length>0?(l(),m("button",{key:0,class:"btn-3 font-semibold !pl-2 !pr-4",onClick:k(b,["prevent"])},t[10]||(t[10]=[e("i",{class:"fad fa-print text-xl"},null,-1),T("Print ")]))):f("",!0),e("button",{class:"btn-3",onClick:t[7]||(t[7]=k(()=>ne(_).back(),["prevent"]))},"Back"),C(V,{class:"btn-2",to:`/requirements/edit/${(O=a.value)==null?void 0:O.id}`},{default:S(()=>t[11]||(t[11]=[T("Edit")])),_:1,__:[11]},8,["to"])])]),t[24]||(t[24]=e("div",{class:"text-center text-xl font-bold mb-2 underline"},"Requirement Form",-1)),e("div",jt,[t[12]||(t[12]=e("div",{class:"text-gray-800 text-sm"},"Requirement ID:",-1)),e("div",zt,x((K=a.value)==null?void 0:K.id),1)]),e("div",Bt,[t[13]||(t[13]=e("div",{class:"text-gray-800 text-sm"},"From",-1)),e("div",Gt,x((X=(Q=a.value)==null?void 0:Q.from_department)==null?void 0:X.name),1)]),e("div",Wt,[t[14]||(t[14]=e("div",{class:"text-gray-500 text-sm"},"Website",-1)),e("div",Ht,[(l(!0),m(R,null,M(((Y=a.value)==null?void 0:Y.website_tags)||[],$=>(l(),m("div",{key:$.id,class:"border px-2 rounded-md bg-gray-50 shadow-sm whitespace-nowrap"},x($.name),1))),128))])]),e("div",Jt,[t[15]||(t[15]=e("div",{class:"text-gray-500 text-sm"},"Submission Date",-1)),e("div",Kt,x(new Date((Z=a.value)==null?void 0:Z.submission_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),1)]),t[25]||(t[25]=e("hr",{class:"mb-4"},null,-1)),e("div",null,[t[23]||(t[23]=e("div",{class:"flex items-end mb-3"},[e("h2",{class:"text-xl font-semibold"},"Requirements"),e("div",{class:"ml-auto print:hidden flex gap-2 text-sm"})],-1)),(((ee=a.value)==null?void 0:ee.details)||[]).length>0?(l(),m("div",Qt,[e("table",Xt,[e("thead",null,[e("tr",null,[t[16]||(t[16]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-left px-4 text-gray-800 print:text-black text-xl font-semibold whitespace-nowrap w-[15%]"}," SL ",-1)),t[17]||(t[17]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base font-semibold whitespace-nowrap w-[65%]"}," Requirement Details ",-1)),t[18]||(t[18]=e("th",{rowspan:"2",class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-base px-3 font-semibold whitespace-nowrap print:whitespace-normal print:p-0 w-[15%]"}," Better To Complete ",-1)),e("th",Yt," For '"+x(((te=a.value.to_department)==null?void 0:te.short_name)||((se=a.value.to_department)==null?void 0:se.name))+"' Use ",1)]),t[19]||(t[19]=e("tr",null,[e("td",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-sm font-semibold whitespace-nowrap p-3 print:whitespace-normal"}," Issue No "),e("td",{class:"border-2 border-gray-800 text-center text-gray-800 print:text-black text-sm font-semibold whitespace-nowrap p-3 print:whitespace-normal print:p-0"}," Expected Date ")],-1))]),e("tbody",null,[(l(!0),m(R,null,M(((re=a.value)==null?void 0:re.details)||[],($,U)=>{var P,le;return l(),m(R,{key:$.id},[C(It,{detail:$,serial:U+1,onEditClick:c,onDeleteClick:r,onTaskCreateClick:g},null,8,["detail","serial"]),e("tr",null,[e("td",Zt,[e("div",es," For '"+x(((P=a.value.to_department)==null?void 0:P.short_name)||((le=a.value.to_department)==null?void 0:le.name))+"' Use ",1),t[20]||(t[20]=e("div",{class:"text-gray-800 text-xs"},"(Feedback)",-1))]),t[21]||(t[21]=e("td",{class:"whitespace-nowrap p-3 text-center border-2 border-gray-800",colspan:"4"},null,-1))])],64)}),128))])])])):f("",!0),e("div",ts,[e("button",{class:"btn-2 pl-2 text-base",onClick:k(d,["prevent"])},t[22]||(t[22]=[e("i",{class:"fad fa-plus-circle text-2xl mr-2"},null,-1),T("Add Requirement ")]))])]),v.value==="loading"?(l(),D(W,{key:0,class:"absolute inset-0 bg-opacity-90"})):f("",!0)])])}}};export{ks as default};
