const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/LeaveApplicationModal-De8hVucX.js","assets/index-ZA_zyr8Y.js","assets/index-BkhA_2ef.css","assets/ApprovalItem-Cm-MzfV7.js","assets/AcceptAndRejectHandler-CsnajVau.js","assets/LoaderView-C5yHLOUc.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/ShareComponent-Dh6_H_Hf.js","assets/leave-application-mWdPCqHb.js","assets/LeaveApplicationModal-B7WJltA7.css","assets/ShortLeaveDetailsModal-D0LrLMq3.js","assets/ScreenshotCapture-BJEdzIEX.js","assets/short-leave-Fi5zWPlo.js","assets/ShortLeaveDetailsModal-D4avNQ1k.css","assets/ManualAttendanceDetailsModal-iF0EEa5Y.js","assets/manual-attendance-D8fOVIFG.js","assets/ManualAttendanceDetailsModal-MS8n2gFL.css","assets/ShiftExchangeDetailsModal-DigSkrf3.js","assets/exchange-D7KglSgS.js","assets/ShiftExchangeDetailsModal-BlZsJzAI.css","assets/OffdayExchangeDetailsModal-DdREKNuz.js","assets/OffdayExchangeDetailsModal-jTt80Glg.css"])))=>i.map(i=>d[i]);
import{u as Z}from"./user-BeIiZVkB.js";import{s as K,m as le,c as o,o as s,n as h,i as D,a as e,j as k,t as m,k as _,p as re,w as j,q as C,x as U,g as $,F as S,y as B,f as N,R as he,z as ie,r as V,d as de,e as ue,A as ee,h as ke,B as we,C as J,D as $e,_ as Q,u as De,l as Ce}from"./index-ZA_zyr8Y.js";import{L as Me}from"./LoaderView-C5yHLOUc.js";import{m as Le,_ as Se}from"./task-tree-De48V79u.js";import{o as ne,g as te,a as se,b as Ae,c as Te}from"./datetime-l2Vm98rT.js";import{u as Re}from"./useTaskStore-3tjPHlTa.js";import{_ as Oe}from"./CalenderView-BNQMbIS-.js";import{_ as Ne}from"./TaskTreeViewWithSubTable-E1iSkulK.js";import{O as Pe}from"./OverlyModal-C1RQtbLq.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./TaskSupervisorAndEmployee-DdXazWhp.js";import"./UserChip-CBnIrr3R.js";import"./TaskStatus-Cg934fCD.js";import"./url-CePbr-gY.js";const Ee={class:"grid gap-4 md:grid-cols-3 mt-4 container mx-auto"},Be={class:"text-3xl"},je={class:"text-3xl"},Ue={class:"text-3xl"},Ve={class:"text-3xl"},qe={class:"text-3xl"},Ie={class:"text-3xl"},We={class:"text-3xl"},Fe={class:"text-3xl"},ze={class:"text-3xl"},Ye={__name:"DashboardAdminView",setup(g){const u=Z(),{dashboardInfo:d,selectedDate:f}=K(u);return(r,i)=>{const p=le("RouterLink");return s(),o("div",Ee,[h(p,{to:{name:"TodayAttendanceReport",query:{status:"all"}},class:"main-button"},{default:D(()=>{var t;return[e("span",Be,m((t=_(d))==null?void 0:t.totalUsers),1),i[0]||(i[0]=k(" Total Employees "))]}),_:1,__:[0]}),h(p,{to:{name:"TodayAttendanceReport",query:{status:"Present"}},class:"main-button"},{default:D(()=>{var t;return[e("span",je,m((t=_(d))==null?void 0:t.todayPresents),1),i[1]||(i[1]=k(" Today Present "))]}),_:1,__:[1]}),h(p,{to:{name:"TodayAttendanceReport",query:{status:"Absent"}},class:"main-button"},{default:D(()=>{var t;return[e("span",Ue,m((t=_(d))==null?void 0:t.todayAbsents),1),i[2]||(i[2]=k(" Today Absent "))]}),_:1,__:[2]}),h(p,{to:{name:"LeaveApplicationsForDay",query:{applicationType:"today"}},class:"main-button"},{default:D(()=>{var t;return[e("span",Ve,m((t=_(d))==null?void 0:t.todayLeaves),1),i[3]||(i[3]=k(" Today Leave "))]}),_:1,__:[3]}),h(p,{to:{name:"LeaveApplicationsForDay",query:{applicationType:"tomorrow"}},class:"main-button"},{default:D(()=>{var t;return[e("span",qe,m((t=_(d))==null?void 0:t.tomorrowLeaves),1),i[4]||(i[4]=k(" Tomorrow Leave "))]}),_:1,__:[4]}),h(p,{to:{name:"DateWiseShortLeaveList",query:{date:_(f)}},class:"main-button"},{default:D(()=>{var t;return[e("span",Ie,m((t=_(d))==null?void 0:t.todayShortLeaves),1),i[5]||(i[5]=k(" Today Short Leaves "))]}),_:1,__:[5]},8,["to"]),h(p,{to:{name:"DailyLateAttendanceReport",query:{date:_(f)}},class:"main-button"},{default:D(()=>{var t;return[e("span",We,m((t=_(d))==null?void 0:t.todayLateEntries),1),i[6]||(i[6]=k(" Today Late Report "))]}),_:1,__:[6]},8,["to"]),h(p,{to:{name:"PreviousAfterApplicationList",query:{applicationType:"prev",date:_(f)}},class:"main-button"},{default:D(()=>{var t;return[e("span",Fe,m((t=_(d))==null?void 0:t.prevWeekLeaves),1),i[7]||(i[7]=k(" Leave history of previous week "))]}),_:1,__:[7]},8,["to"]),h(p,{to:{name:"PreviousAfterApplicationList",query:{applicationType:"after",date:_(f)}},class:"main-button"},{default:D(()=>{var t;return[e("span",ze,m((t=_(d))==null?void 0:t.nextWeekLeaves),1),i[8]||(i[8]=k(" Upcoming leaves "))]}),_:1,__:[8]},8,["to"])])}}},ae=(g,u,d,f)=>{const r=new Date(f,d-1,u);return g.filter(i=>{const p=i.deadline?new Date(i.deadline):null,t=ne(new Date);if(i.assigned_at){const a=ne(new Date(i.assigned_at));if(r<a)return!1;let l=null;return i.completed_at&&(l=ne(new Date(i.completed_at))),!(l&&l<r||p&&p<r&&r>t)}return!1}).map(i=>{let p=!1;return i.deadline&&(p=new Date(i.deadline)<r),{...i,deadline_crossed:p}})},He={class:"px-4 py-2 flex items-center bg-gray-50 group"},Ke=["disabled"],Ge={class:"ml-4 md:ml-auto flex items-center gap-2"},Je=["value"],Qe=re({__name:"DailyTaskHeading",props:{selectedDay:{type:String,required:!0},loading:{type:Boolean,default:!1}},emits:["change",,"reloadClick","monthWiseButtonClick"],setup(g,{emit:u}){const d=g,f=u;function r(){f("change",te(new Date))}function i(){const t=new Date(d.selectedDay);t.setDate(t.getDate()+1),f("change",te(t))}function p(){const t=new Date(d.selectedDay);t.setDate(t.getDate()-1),f("change",te(t))}return(t,a)=>(s(),o("div",He,[a[4]||(a[4]=e("h2",{class:"leading-none font-semibold text-lg"},"Daily Task",-1)),e("button",{class:"btn-3 mx-4 h-7",onClick:a[0]||(a[0]=j(l=>f("monthWiseButtonClick"),["prevent"]))},"Month Wise"),e("button",{class:"btn-3 mx-4 h-7",onClick:j(r,["prevent"])},"Today"),e("button",{class:C(["btn-3 px-2 py-2 mx-4 size-7 disabled:text-gray-300 disabled:border-gray-300",{"animate-spin text-gray-300 border-gray-300 !bg-opacity-0":g.loading}]),onClick:a[1]||(a[1]=j(l=>f("reloadClick"),["prevent"])),disabled:g.loading},a[3]||(a[3]=[e("i",{class:"fas fa-redo-alt"},null,-1)]),10,Ke),e("div",Ge,[e("button",{class:"btn-2 h-7",onClick:j(p,["prevent"])},"Previous Day"),e("button",{class:"btn-2 h-7",onClick:j(i,["prevent"])},"Next Day"),e("input",{type:"date",value:g.selectedDay,onInput:a[2]||(a[2]=l=>{var y;return f("change",(y=l.target)==null?void 0:y.value)}),class:"border px-2 rounded"},null,40,Je)])]))}}),Xe={class:"px-4 py-2 flex items-center bg-gray-50 group"},Ze=["disabled"],et={class:"ml-4 md:ml-auto flex items-center gap-2"},tt=["value"],st=re({__name:"MonthlyTaskHeading",props:{selectedMonth:{type:String,required:!0},loading:{type:Boolean,default:!1}},emits:["reloadClick","dayWiseButtonClick","change"],setup(g,{emit:u}){const d=g,f=u;function r(){f("change",se(new Date))}function i(){var y;const[t,a]=(y=d.selectedMonth)==null?void 0:y.split("-").map(Number),l=new Date(t,a,1);l.setMonth(l.getMonth()),f("change",se(l))}function p(){var y;const[t,a]=(y=d.selectedMonth)==null?void 0:y.split("-").map(Number),l=new Date(t,a,1);l.setMonth(l.getMonth()-2),f("change",se(l))}return(t,a)=>(s(),o("div",Xe,[a[4]||(a[4]=e("h2",{class:"leading-none font-semibold text-lg"},"Monthly Task",-1)),e("button",{class:"btn-3 mx-4 h-7",onClick:a[0]||(a[0]=j(l=>f("dayWiseButtonClick"),["prevent"]))},"Day Wise"),e("button",{class:"btn-3 mx-4 h-7",onClick:j(r,["prevent"])},"Current Month"),e("button",{class:C(["btn-3 px-2 py-2 mx-4 size-7 disabled:text-gray-300 disabled:border-gray-300",{"animate-spin text-gray-300 border-gray-300 !bg-opacity-0":g.loading}]),onClick:a[1]||(a[1]=j(l=>f("reloadClick"),["prevent"])),disabled:g.loading},a[3]||(a[3]=[e("i",{class:"fas fa-redo-alt"},null,-1)]),10,Ze),e("div",et,[e("button",{class:"btn-2 h-7",onClick:j(p,["prevent"])},"Previous Month"),e("button",{class:"btn-2 h-7",onClick:j(i,["prevent"])},"Next Month"),e("input",{type:"month",value:g.selectedMonth,onInput:a[2]||(a[2]=l=>{var y;return f("change",(y=l.target)==null?void 0:y.value)}),class:"border px-2 rounded"},null,40,tt)])]))}}),nt={key:0,class:"space-y-6 py-2"},at={key:0,class:"fad fa-folder text-xs mr-2"},ot={key:1,class:"fad fa-file-alt text-xs mr-2"},lt={key:2,class:"text-center w-full mt-4 text-xs text-gray-600"},oe={__name:"TaskListOnDay",props:{isCurrentMonth:{type:Boolean,default:!1},tasks:{type:Array,default:()=>[]},limit:{type:Number,default:null},tree:{type:Boolean,default:!1}},emits:["clickOnMore"],setup(g,{emit:u}){const d=g,f=u,r=U(()=>{var i;return d.limit?((i=d==null?void 0:d.tasks)==null?void 0:i.slice(0,d.limit))||[]:[...d.tasks]});return(i,p)=>(s(),o("div",null,[g.tree?(s(),o("div",nt,[(s(!0),o(S,null,B(r.value,(t,a)=>(s(),N(Ne,{"hide-buttons":"","hide-assigned-users":"",task:t,key:t.id,index:a,class:"shadow hover:shadow-md border border-blue-300 rounded-md *:border-none"},null,8,["task","index"]))),128))])):(s(),o("ul",{key:1,class:C({"text-gray-500 group-hover:text-gray-900":!g.isCurrentMonth})},[(s(!0),o(S,null,B(r.value,t=>(s(),o("li",{class:"mb-2",key:t.id},[h(_(he),{to:`/tasks/${t.id}`,target:"_blank",class:"flex items-center hover:underline hover:text-blue-600"},{default:D(()=>[t.children_task_count>0?(s(),o("i",at)):$("",!0),t.children_task_count==0?(s(),o("i",ot)):$("",!0),e("span",{class:C(["line-clamp-1",{"text-red-800":t.deadline_crossed}])},m(t.title),3)]),_:2},1032,["to"])]))),128))],2)),g.tasks.length-r.value.length>0?(s(),o("div",lt,[e("button",{onClick:p[0]||(p[0]=j(t=>f("clickOnMore",t),["prevent"])),class:"text-blue-600 hover:underline"}," +"+m(g.tasks.length-r.value.length)+" More Tasks ",1)])):$("",!0)]))}},rt={class:"relative"},it={class:"ml-auto"},dt=["onClick"],ut={key:0,class:"absolute inset-0 bg-gray-300 bg-opacity-90"},ct={class:"absolute inset-16 bg-white border border-blue-500 rounded-md z-20 overflow-y-auto"},pt={class:"text-lg font-semibold mb-4 sticky top-0 border-b border-blue-200 px-4 z-30 py-3 bg-white flex items-center"},yt={__name:"TaskInMonth",props:{month:{type:String,required:!0,validator:g=>/^\d{4}-(0[1-9]|1[0-2])$/.test(g)},tasks:{type:Array,required:!0,default:()=>[]}},setup(g){const u=ie({day:null,month:null,year:null});function d(t){t.stopPropagation(),u.day=null,u.month=null,u.year=null}function f(t,a,l,y){t.stopPropagation(),u.day=a,u.month=l,u.year=y}const r=(t,a,l)=>{const y=new Date;return t===y.getDate()&&a===y.getMonth()+1&&l===y.getFullYear()},i=(t,a,l)=>t===u.day&&a===u.month&&l===u.year,p=(t,a,l,y)=>{const M=r(t,a,l);return{"bg-green-100 text-green-900 border-blue-500 border-2 scale-105 z-10":M,"border-r border-t hover:border border-blue-200  hover:scale-105 hover:z-20 hover:bg-blue-50":!M,"bg-gray-50":!y}};return(t,a)=>(s(),o("div",rt,[g.month?(s(),N(Oe,{key:0,month:g.month,class:"border-t border-blue-200/50 relative"},{date:D(({day:l,month:y,year:M,isCurrentMonth:I})=>[e("div",{tabindex:"0",class:C(["transition origin-center p-2 outline-blue-600 outline-1 cursor-pointer",p(l,y,M,I)])},[e("div",{class:C(["font-bold w-full flex items-center",{"text-gray-300":!I}])},[e("div",null,m(l),1),e("div",it,[i(l,y,M)?$("",!0):(s(),o("button",{key:0,class:"btn-icon",onClick:j(L=>f(L,l,y,M),["prevent"])},a[0]||(a[0]=[e("i",{class:"fas fa-expand-arrows text-gray-400 hover:text-gray-600"},null,-1)]),8,dt))])],2),h(oe,{"is-current-month":I,tasks:_(ae)(g.tasks,l,y,M),limit:3,class:"text-xs mt-4",onClickOnMore:L=>f(L,l,y,M)},null,8,["is-current-month","tasks","onClickOnMore"])],2)]),"calender-bottom":D(()=>[u.day?(s(),o("div",ut,[e("div",ct,[e("div",pt,[k(" Tasks for "+m(u.day)+"/"+m(u.month)+"/"+m(u.year)+" ",1),e("button",{class:"ml-auto",type:"button",onClick:j(d,["prevent"])},a[1]||(a[1]=[e("i",{class:"fas fa-times"},null,-1)]))]),h(oe,{class:"p-4","is-current-month":t.isCurrentMonth,tasks:_(ae)(g.tasks,u.day,u.month,u.year),tree:!0},null,8,["is-current-month","tasks"])])])):$("",!0)]),_:1},8,["month"])):$("",!0)]))}},mt={class:"bg-opacity-90 relative"},ft={class:"rounded-md z-20"},xt={class:"text-md sticky top-0 border-b px-4 z-30 py-3 bg-white flex items-center shadow"},vt={class:"flex justify-between items-center gap-6 w-full"},gt={key:0,class:"text-blue-800 bg-blue-100 rounded-full border px-4 py-0.5 text-sm"},_t={key:1,class:"text-blue-800 bg-blue-100 rounded-full border px-4 py-0.5 text-sm"},bt={class:"ml-auto flex items-center gap-2"},ht={key:0,class:"w-32 relative h-8"},kt={__name:"DailyTask",setup(g){const u=ie({day:null,month:null,year:null}),d=V(),f=V(),r=V("loading"),i=Re(),p=de(),t=V(""),a=V("day-wise"),l=V("not-completed");ue(()=>{d.value=te(new Date),f.value=se(new Date)}),ee(d,L=>{const[v,w,q]=L.split("-").map(Number);u.day=q,u.month=w,u.year=v}),ee(f,L=>{const[v,w]=L.split("-").map(Number);u.day=1,u.month=w,u.year=v}),ee(()=>u.month,async()=>{r.value="loading",await y(),r.value=""}),ee(a,L=>{if(L=="month-wise"){const[v,w]=d.value.split("-");f.value=`${v}-${w}`}});async function y(){await i.fetchMyTasks()}const M=async()=>{r.value="loading",await y(),r.value=""},I=U(()=>{var w,q;const L=A=>{var P,W;return t.value?(W=A==null?void 0:A.toUpperCase())==null?void 0:W.includes((P=t.value)==null?void 0:P.toUpperCase()):!0},v=a.value=="day-wise"?{"user-ids":(w=p==null?void 0:p.user)==null?void 0:w.id,status:l.value}:{"user-ids":(q=p==null?void 0:p.user)==null?void 0:q.id};return Le(ae(i.tasks,u.day,u.month,u.year),v).filter(A=>{var P;return L(A.title)||((P=A.children_tasks)==null?void 0:P.some(W=>L(W==null?void 0:W.title)))}).map(A=>({...A,children_tasks:A.children_tasks.filter(P=>L(P.title))}))});return(L,v)=>(s(),o("div",null,[a.value=="day-wise"?(s(),N(Qe,{key:0,loading:r.value=="loading","selected-day":d.value,onChange:v[0]||(v[0]=w=>d.value=w),onReloadClick:M,onMonthWiseButtonClick:v[1]||(v[1]=w=>a.value="month-wise")},null,8,["loading","selected-day"])):$("",!0),a.value=="month-wise"?(s(),N(st,{key:1,loading:r.value=="loading","selected-month":f.value,onChange:v[2]||(v[2]=w=>f.value=w),onDayWiseButtonClick:v[3]||(v[3]=w=>a.value="day-wise"),onReloadClick:M},null,8,["loading","selected-month"])):$("",!0),e("div",mt,[e("div",ft,[e("div",xt,[e("div",vt,[a.value=="day-wise"?(s(),o("div",gt,m(_(Ae)(d.value)),1)):$("",!0),a.value=="month-wise"?(s(),o("div",_t,m(_(Te)(f.value)),1)):$("",!0),e("div",bt,[a.value=="day-wise"?(s(),o("div",ht,[v[7]||(v[7]=e("label",{class:"absolute text-xs left-3 -top-1.5 bg-slate-100 text-blue-500"},"Status",-1)),ke(e("select",{"onUpdate:modelValue":v[4]||(v[4]=w=>l.value=w),class:"h-8 text-xs px-2 text-gray-600 border-2 border-gray-400 rounded-md w-full"},v[6]||(v[6]=[e("option",{value:""},"--ALL TASKS--",-1),e("option",{value:"not-completed"},"Not Completed",-1)]),512),[[we,l.value]])])):$("",!0),h(Se,{modelValue:t.value,"onUpdate:modelValue":v[5]||(v[5]=w=>t.value=w),class:"w-full md:w-48 md:ml-auto h-8","debounce-time":0},null,8,["modelValue"])])])]),a.value=="day-wise"?(s(),N(oe,{key:0,class:"p-4 overflow-y-auto",tasks:I.value,tree:!0},null,8,["tasks"])):a.value=="month-wise"?(s(),N(yt,{key:1,tasks:I.value||[],month:f.value,class:"bg-gray-50"},null,8,["tasks","month"])):$("",!0)]),r.value==="loading"?(s(),N(Me,{key:0,class:"absolute inset-0 flex items-center justify-center z-20 bg-opacity-70"})):$("",!0)])]))}},wt={class:"bg-white shadow-md rounded-lg"},$t={class:"overflow-x-auto shadow-md min-h-max"},Dt={class:"min-w-full text-sm text-left text-gray-500 table-fixed"},Ct={class:"text-xs"},Mt={class:"text-sm font-semibold text-blue-800"},Lt={__name:"DashboardLeaveBalance",setup(g){const u=Z(),{userDashboard:d}=K(u);return(f,r)=>{var i,p,t,a;return s(),o("div",wt,[r[4]||(r[4]=e("h2",{class:"text-xl font-semibold py-2 px-4"},"Leave Balance",-1)),e("div",$t,[e("table",Dt,[e("thead",null,[e("tr",Ct,[r[0]||(r[0]=e("th",{class:"px-2 py-1 font-semibold text-gray-900 border bg-gray-50"},null,-1)),(s(!0),o(S,null,B((i=_(d))==null?void 0:i.leave_balance,l=>(s(),o("th",{class:"px-4 text-center py-1 font-semibold text-gray-900 border bg-gray-50 w-40",key:l.id},m(l.name),1))),128))])]),e("tbody",null,[e("tr",null,[r[1]||(r[1]=e("td",{class:"px-4 py-4 font-medium text-gray-900 border text-xs"},"Total",-1)),(s(!0),o(S,null,B((p=_(d))==null?void 0:p.leave_balance,l=>(s(),o("td",{class:"px-4 text-center py-3 font-medium text-gray-900 border",key:l.id},m(l.annual_quota),1))),128))]),e("tr",null,[r[2]||(r[2]=e("td",{class:"px-4 py-3 font-medium text-gray-900 border text-xs"},"Used",-1)),(s(!0),o(S,null,B((t=_(d))==null?void 0:t.leave_balance,l=>(s(),o("td",{class:"px-4 text-center py-4 font-medium text-gray-900 border",key:l.id},m(l.used_days),1))),128))]),e("tr",Mt,[r[3]||(r[3]=e("td",{class:"px-4 py-3 border text-xs"},"Balance",-1)),(s(!0),o(S,null,B((a=_(d))==null?void 0:a.leave_balance,l=>(s(),o("td",{class:"px-4 text-center py-4 border",key:l.id},m(l.remaining_days),1))),128))])])])])])}}},St={class:"bg-white shadow-sm rounded-xl p-4"},At={class:"flex items-center justify-between mb-1"},Tt={key:0,class:"text-xs italic text-center py-4 text-gray-500 mt-2"},Rt={key:1,class:"py-3 divide-y divide-gray-100"},Ot=["onClick"],Nt={class:"flex justify-between items-center py-2 rounded hover:bg-sky-50/60 transition-colors"},Pt={class:"text-sm text-gray-900 min-w-0"},Et={class:"font-medium"},Bt={class:"opacity-70"},jt={key:0,class:"fas fa-clock mr-1.5"},Ut={key:1,class:"fas fa-hourglass-half mr-1.5"},Vt={key:2,class:"fas fa-check-circle mr-1.5"},qt={key:3,class:"fas fa-times-circle mr-1.5"},It={class:"mb-1 text-gray-700 flex flex-wrap items-center gap-x-2.5 gap-y-1"},Wt=["title"],Ft={class:"truncate max-w-[9.5rem] sm:max-w-none"},zt={class:"truncate max-w-[9.5rem] sm:max-w-none"},Yt={key:1,class:"truncate max-w-[10rem] sm:max-w-none"},Ht=["title"],Kt=["title"],Gt={class:"mt-6"},Jt={class:"flex items-center justify-between mb-1"},Qt={key:0,class:"text-xs italic text-center py-4 text-gray-500 mt-2"},Xt={key:1,class:"py-3 divide-y divide-gray-100"},Zt=["onClick"],es={class:"flex justify-between items-center py-2 rounded hover:bg-sky-50/60 transition-colors"},ts={class:"text-sm text-gray-900 min-w-0"},ss={class:"opacity-80"},ns={class:"mt-6"},as={class:"flex items-center justify-between mb-1"},os={class:"flex items-center gap-3"},ls={key:0,class:"text-xs italic text-center py-4 text-gray-500 mt-2"},rs={key:1,class:"py-3 divide-y divide-gray-100"},is=["onClick"],ds={class:"flex justify-between items-center py-2 rounded hover:bg-sky-50/60 transition-colors"},us={class:"text-sm text-gray-900 min-w-0"},cs={class:"opacity-80"},ps={class:"mt-6"},ys={class:"flex items-center justify-between mb-1"},ms={key:0,class:"text-xs italic text-center py-4 text-gray-500 mt-2"},fs={key:1,class:"py-3 divide-y divide-gray-100"},xs=["onClick"],vs={class:"flex justify-between items-center py-2 rounded hover:bg-sky-50/60 transition-colors"},gs={class:"text-sm text-gray-900 min-w-0"},_s={class:"opacity-80"},H="inline-flex items-center rounded-full border px-2 py-0.5 text-[12px]",X="border-gray-300 bg-gray-50 text-gray-800",bs={__name:"DashboardRecentApplications",setup(g){const u=J(()=>Q(()=>import("./LeaveApplicationModal-De8hVucX.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]))),d=J(()=>Q(()=>import("./ShortLeaveDetailsModal-D0LrLMq3.js"),__vite__mapDeps([10,1,2,3,4,5,6,11,7,12,13]))),f=J(()=>Q(()=>import("./ManualAttendanceDetailsModal-iF0EEa5Y.js"),__vite__mapDeps([14,1,2,3,4,5,6,7,15,16]))),r=J(()=>Q(()=>import("./ShiftExchangeDetailsModal-DigSkrf3.js"),__vite__mapDeps([17,1,2,3,4,5,6,11,7,18,19]))),i=J(()=>Q(()=>import("./OffdayExchangeDetailsModal-DdREKNuz.js"),__vite__mapDeps([20,1,2,3,4,5,6,11,7,18,21]))),p=Z(),{userDashboard:t}=K(p),a=U(()=>{var x;return((x=t.value)==null?void 0:x.lists)??{}}),l=U(()=>a.value.current_month_leave??[]),y=U(()=>a.value.short_leave??[]),M=U(()=>a.value.exchange??[]),I=U(()=>a.value.manual_attendance??[]),L={null:{title:"Handover Waiting",cls:"bg-gray-500 text-white"},Pending:{title:"Pending",cls:"bg-yellow-500 text-white"},Approved:{title:"Approved",cls:"bg-green-500 text-white"},Rejected:{title:"Rejected",cls:"bg-red-500 text-white"}},v=x=>L[x??"null"]??{title:String(x||"Unknown"),cls:"bg-gray-400 text-white"},w=x=>Array.isArray(x)?x.filter(n=>n==null?void 0:n.name).map(n=>`${n.name} (${(n==null?void 0:n.days)??0})`).join(", "):"",q=V({open:!1,id:null}),A=V({open:!1,id:null}),P=V({open:!1,id:null}),W=x=>{q.value={open:!0,id:x}},ce=x=>{A.value={open:!0,id:x}},pe=x=>{P.value={open:!0,id:x}},F=V({open:!1,id:null,type:null}),ye=x=>{const n=(x==null?void 0:x.exchange_type)==="offday"?"offday":"shift";F.value={open:!0,id:x.id,type:n}},me=U(()=>F.value.type==="offday"?i:r),fe=U(()=>`${F.value.type||"x"}-${F.value.id||"x"}`);function xe(x){if(!x)return null;const n=String(x).trim();let b=n.match(/^(\d{4})-(\d{2})-(\d{2})$/);return b?new Date(+b[1],+b[2]-1,+b[3],0,0,0):(b=n.match(/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?$/),b?new Date(+b[1],+b[2]-1,+b[3],+b[4],+b[5],+(b[6]||0)):null)}function E(x){const n=xe(x);return n?n.toLocaleDateString(void 0,{day:"2-digit",month:"short",year:"numeric"}):""}function ve(x){const n=String(x||"").match(/^(\d{4})-(\d{2})-(\d{2})$/);return n?new Date(+n[1],+n[2]-1,+n[3],0,0,0):null}function ge(x,n){const b=new Date(x);return b.setDate(b.getDate()+n),b}function _e(x,n){return x&&n&&x.getFullYear()===n.getFullYear()&&x.getMonth()===n.getMonth()&&x.getDate()===n.getDate()}function be(x){const n=Array.isArray(x)?x.slice():[],b=T=>Array.from(new Set(T)).sort(),c=b(n.filter(T=>(T==null?void 0:T.leave_type_id)!=="weekend").map(T=>T.date).filter(Boolean)),R=b(n.filter(T=>(T==null?void 0:T.leave_type_id)==="weekend").map(T=>T.date).filter(Boolean)),O=[];let z=null,Y=null;for(const T of c){const G=ve(T);if(G){if(!z){z=Y=G;continue}_e(ge(Y,1),G)?Y=G:(O.push({from:z.toISOString().slice(0,10),to:Y.toISOString().slice(0,10)}),z=Y=G)}}return z&&Y&&O.push({from:z.toISOString().slice(0,10),to:Y.toISOString().slice(0,10)}),{ranges:O,weekends:R,leaveCount:c.length}}return(x,n)=>{const b=le("RouterLink");return s(),o("div",St,[e("section",null,[e("header",At,[n[5]||(n[5]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-file h-5 w-5 text-gray-600"}),e("h2",{class:"text-lg font-semibold text-gray-900"},[k("Applications "),e("span",{class:"text-xs ml-2 text-green-600 font-medium"},"Latest")])],-1)),h(b,{to:{name:"MyLeaveApplications"},class:"text-xs text-blue-600 hover:underline"},{default:D(()=>n[4]||(n[4]=[k(" See more ")])),_:1,__:[4]})]),n[10]||(n[10]=e("hr",{class:"border-gray-200"},null,-1)),l.value.length===0?(s(),o("div",Tt," No applications ")):(s(),o("div",Rt,[(s(!0),o(S,null,B(l.value,c=>(s(),o("button",{key:c.id,class:"block w-full text-left",onClick:R=>W(c.id)},[e("div",Nt,[e("h3",Pt,[e("span",Et,"#"+m(c.id),1),e("span",Bt," ("+m(w(c.leave_type_counts))+")",1)]),e("span",{class:C(["font-medium flex items-center whitespace-nowrap text-[11px] px-2 py-0.5 rounded-full",v(c.status).cls])},[c.status===null?(s(),o("i",jt)):c.status==="Pending"?(s(),o("i",Ut)):c.status==="Approved"?(s(),o("i",Vt)):(s(),o("i",qt)),k(" "+m(v(c.status).title),1)],2)]),e("div",It,[(s(!0),o(S,null,B([be(c.json_data)],R=>(s(),o(S,{key:"info-"+c.id},[R.leaveCount>1?(s(!0),o(S,{key:0},B(R.ranges,(O,z)=>(s(),o("span",{key:z,class:C([H,X]),title:O.from===O.to?E(O.from):E(O.from)+" – "+E(O.to)},[n[7]||(n[7]=e("i",{class:"far fa-calendar-minus mr-1"},null,-1)),O.from!==O.to?(s(),o(S,{key:0},[e("span",Ft,m(E(O.from)),1),n[6]||(n[6]=e("span",{class:"mx-1"},"–",-1)),e("span",zt,m(E(O.to)),1)],64)):(s(),o("span",Yt,m(E(O.from)),1))],10,Wt))),128)):(s(),o(S,{key:1},[R.ranges[0]?(s(),o("span",{key:0,class:C([H,X]),title:E(R.ranges[0].from)},[n[8]||(n[8]=e("i",{class:"far fa-calendar-day mr-1"},null,-1)),k(" "+m(E(R.ranges[0].from)),1)],10,Ht)):$("",!0)],64)),R.weekends.length?(s(),o("span",{key:2,class:C([H,"border-gray-300 bg-gray-100 text-gray-700"]),title:R.weekends.map(E).join(", ")},[n[9]||(n[9]=e("i",{class:"far fa-calendar mr-1"},null,-1)),k(" + "+m(R.weekends.length)+" wknd ",1)],10,Kt)):$("",!0)],64))),128))])],8,Ot))),128))]))]),e("section",Gt,[e("header",Jt,[n[12]||(n[12]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-walking h-5 w-5 text-gray-600"}),e("h2",{class:"text-base font-semibold text-gray-900"},"Short Leave")],-1)),h(b,{to:{name:"MyShortLeaves"},class:"text-xs text-blue-600 hover:underline"},{default:D(()=>n[11]||(n[11]=[k("See more")])),_:1,__:[11]})]),n[13]||(n[13]=e("hr",{class:"border-gray-200"},null,-1)),y.value.length===0?(s(),o("div",Qt," No short leave ")):(s(),o("div",Xt,[(s(!0),o(S,null,B(y.value,c=>(s(),o("button",{key:c.id,class:"w-full text-left",onClick:R=>ce(c.id)},[e("div",es,[e("h3",ts,[e("span",{class:C([H,X,"text-xs mr-1"])},m(E(c.date)),3),e("span",ss,"("+m(c.type||"—")+")",1)]),e("span",{class:C(["text-[11px] px-2 py-0.5 rounded-full",v(c.status).cls])},m(v(c.status).title),3)])],8,Zt))),128))]))]),e("section",ns,[e("header",as,[n[16]||(n[16]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-exchange-alt h-5 w-5 text-gray-600"}),e("h2",{class:"text-base font-semibold text-gray-900"},"Exchange")],-1)),e("div",os,[h(b,{to:{name:"MyShiftExchangeList"},class:"text-xs text-blue-600 hover:underline"},{default:D(()=>n[14]||(n[14]=[k("Shift")])),_:1,__:[14]}),h(b,{to:{name:"MyOffdayExchangeList"},class:"text-xs text-blue-600 hover:underline"},{default:D(()=>n[15]||(n[15]=[k("Offday")])),_:1,__:[15]})])]),n[17]||(n[17]=e("hr",{class:"border-gray-200"},null,-1)),M.value.length===0?(s(),o("div",ls," No exchange ")):(s(),o("div",rs,[(s(!0),o(S,null,B(M.value,c=>(s(),o("button",{key:c.id,class:"block w-full text-left",onClick:R=>ye(c)},[e("div",ds,[e("h3",us,[e("span",{class:C([H,X,"text-xs mr-1"])},m(E(c.current_date)),3),e("span",cs,"("+m(c.exchange_type||"—")+")",1)]),e("span",{class:C(["text-[11px] px-2 py-0.5 rounded-full",v(c.status).cls])},m(v(c.status).title),3)])],8,is))),128))]))]),e("section",ps,[e("header",ys,[n[19]||(n[19]=e("div",{class:"flex items-center gap-2"},[e("i",{class:"fas fa-user-check h-5 w-5 text-gray-600"}),e("h2",{class:"text-base font-semibold text-gray-900"},"Manual Attendance")],-1)),h(b,{to:{name:"MyManualAttendanceList"},class:"text-xs text-blue-600 hover:underline"},{default:D(()=>n[18]||(n[18]=[k("See more")])),_:1,__:[18]})]),n[20]||(n[20]=e("hr",{class:"border-gray-200"},null,-1)),I.value.length===0?(s(),o("div",ms," No manual application ")):(s(),o("div",fs,[(s(!0),o(S,null,B(I.value,c=>(s(),o("button",{key:c.id,class:"block w-full text-left",onClick:R=>pe(c.id)},[e("div",vs,[e("h3",gs,[e("span",{class:C([H,X,"text-xs mr-1"])},m(c.check_in?E(c.check_in):E(c.check_out)),3),e("span",_s,"("+m(c.type||"—")+")",1)]),e("span",{class:C(["text-[11px] px-2 py-0.5 rounded-full",v(c.status).cls])},m(v(c.status).title),3)])],8,xs))),128))]))]),q.value.open?(s(),N(_(u),{key:0,open:q.value.open,"onUpdate:open":n[0]||(n[0]=c=>q.value.open=c),id:q.value.id},null,8,["open","id"])):$("",!0),A.value.open?(s(),N(_(d),{key:1,open:A.value.open,"onUpdate:open":n[1]||(n[1]=c=>A.value.open=c),id:A.value.id},null,8,["open","id"])):$("",!0),P.value.open?(s(),N(_(f),{key:2,open:P.value.open,"onUpdate:open":n[2]||(n[2]=c=>P.value.open=c),id:P.value.id},null,8,["open","id"])):$("",!0),F.value.open?(s(),N($e(me.value),{key:fe.value,open:F.value.open,"onUpdate:open":n[3]||(n[3]=c=>F.value.open=c),id:F.value.id},null,40,["open","id"])):$("",!0)])}}},hs={class:"bg-white shadow-md rounded-lg p-4"},ks={class:"space-y-3"},ws={key:0,class:"text-xs italic text-center py-4 text-gray-500"},$s={class:"flex items-center space-x-4"},Ds={key:0,class:"h-3 w-3 bg-red-600 rounded-full inline-block"},Cs={key:1,class:"inline-block"},Ms={class:"absolute top-10 left-1/2 -translate-x-1/2 bg-gray-800 text-white text-xs rounded py-1 px-2 opacity-0 group-hover:opacity-100 transition pointer-events-none z-10 whitespace-nowrap"},Ls={class:"text-sm font-medium text-gray-900"},Ss={class:"text-xs text-gray-500 mt-0.5"},As={class:"text-xl font-bold text-gray-800 flex items-center gap-2 p-4"},Ts={class:"space-y-5 px-4 md:px-6 py-4"},Rs={class:"text-sm text-gray-500 flex items-center gap-2"},Os={class:"flex justify-end gap-3 mt-6"},Ns={__name:"DashboardRecentNotices",setup(g){const u=Z(),{userDashboard:d}=K(u),f=De(),r=U(()=>{var p,t;if(d.value&&d.value.notices){const a=(t=(p=d.value)==null?void 0:p.notices)==null?void 0:t.find(l=>!l.user_feedback);if(a)return a}return null}),i=()=>{if(!r.value)return;const p=r.value.type===1?`/notice-details/${r.value.id}`:`/policy-details/${r.value.id}`;f.push(p)};return(p,t)=>{var l;const a=le("RouterLink");return s(),o("div",hs,[t[7]||(t[7]=Ce('<div class="flex justify-between items-start mb-1"><div class="flex items-center"><i class="fas fa-file mr-2 h-5 w-5"></i><h2 class="text-xl font-semibold">Notices</h2></div></div><hr class="mb-3">',2)),e("div",ks,[((l=_(d).notices)==null?void 0:l.length)===0?(s(),o("div",ws," No pending notice found ")):(s(!0),o(S,{key:1},B(_(d).notices,(y,M)=>(s(),o("div",{key:M,class:"flex items-center justify-between p-4 border rounded-lg shadow-sm hover:shadow transition-all bg-white"},[e("div",$s,[e("div",{class:C([["rounded-full",y.user_feedback?"bg-green-100":"bg-red-100"],"h-8 w-8 flex items-center justify-center rounded-full flex-shrink-0"])},[y.user_feedback?(s(),o("span",Cs,t[2]||(t[2]=[e("i",{class:"far fa-check text-green-600"},null,-1)]))):(s(),o("span",Ds)),e("div",Ms,m(y.user_feedback?"Feedback Submitted":"Feedback Pending"),1)],2),e("div",null,[e("p",Ls,m(y.title),1),e("p",Ss,m(y.published_at),1)])]),h(a,{to:y.type===1?`/notice-details/${y.id}`:`/policy-details/${y.id}`,class:"text-blue-600 hover:text-blue-800 font-semibold text-sm"},{default:D(()=>t[3]||(t[3]=[k(" View ")])),_:2,__:[3]},1032,["to"])]))),128)),r.value?(s(),N(Pe,{key:2,show:!0,onClose:t[1]||(t[1]=y=>r.value=null)},{default:D(()=>[e("div",As,[t[4]||(t[4]=e("i",{class:"fas fa-bell text-blue-500"},null,-1)),k(" "+m(r.value.title),1)]),e("div",Ts,[e("p",Rs,[t[5]||(t[5]=e("i",{class:"fas fa-calendar-alt text-gray-400"},null,-1)),k(" Published: "+m(r.value.published_at),1)]),t[6]||(t[6]=e("p",{class:"text-base text-gray-700 leading-relaxed"}," You must read this notice before proceeding. ",-1)),e("div",Os,[e("button",{onClick:t[0]||(t[0]=y=>r.value=null),class:"bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium px-5 py-2 rounded-lg transition"}," Cancel "),e("button",{onClick:i,class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-2.5 rounded-lg shadow transition"}," Read Details ")])])]),_:1})):$("",!0)])])}}},Ps={class:"w-full px-6 py-4"},Es={class:"grid lg:grid-cols-4 gap-6"},Bs={class:"card-bg gap-0 shadow-md border border-gray-300 col-span-full lg:col-span-3 lg:row-span-2"},js={class:"col-span-full lg:col-span-1 grid sm:grid-cols-2 lg:grid-cols-1 gap-6 sticky top-[80px]"},Us={class:"card-bg gap-0 shadow-md border border-gray-300"},Vs={class:"card-bg gap-0 shadow-md border border-gray-300"},qs={class:"card-bg gap-0 shadow-md border border-gray-300"},Is={__name:"DashboardEmployeeView",setup(g){return(u,d)=>(s(),o("div",Ps,[e("div",Es,[e("div",Bs,[h(kt)]),e("div",js,[e("div",Us,[h(bs)]),e("div",Vs,[h(Ns)]),e("div",qs,[h(Lt)])])])]))}},nn={__name:"DashBoard",setup(g){const u=de(),d=Z(),{userDashboard:f}=K(d),{user:r}=K(u),i=U(()=>{var t;return["admin","super_admin","developer"].includes((t=r==null?void 0:r.value)==null?void 0:t.role)}),p=V(null);return ue(async()=>{var a,l;r.value||await u.fetchUser(),await d.fetchUserDashboardData(),i.value&&await d.fetchAdminDashboardData();const t=(l=(a=f.value)==null?void 0:a.notices)==null?void 0:l.find(y=>!y.user_feedback);t&&(p.value=t)}),(t,a)=>i.value&&_(u).isAdminMood?(s(),N(Ye,{key:0})):(s(),N(Is,{key:1}))}};export{nn as default};
