import{O as Me,r as q,A as j,e as ae,m as x,J as We,f as De,o as f,p as v,i as z,c as m,g as te,a as t,a6 as $e,t as l,F as Y,y as H,j as F,h as oe,B as Ne,v as qe,W as Ie,I as Ce,u as Oe,b as Le,s as ee,z as Te,n as Ee,k as L,w as P,x as $}from"./index-C5w6_6Lc.js";import{_ as Be}from"./EmployeeFilter-BiMGmqve.js";import{L as Ke}from"./LoaderView-DG1nSeM0.js";import{d as Ae}from"./dayjs.min-DH7YPJY_.js";import{u as Ue}from"./shift-7AOQR8MV.js";import{S as Re}from"./WeekendAssignModal-C1feAYR6.js";import{C as Pe}from"./CriteriaAssignModal-B4rWvTFC.js";import{u as Fe}from"./company-BbQG1uQq.js";import{u as Ye}from"./department-BQHKxn2R.js";import{u as He}from"./user-BkHiKboC.js";import"./EmployeeDropdownInput-DX2XQ5dV.js";import"./SelectDropdown-C1FAPXai.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./UserChip-Donf__qH.js";import"./monthly-kpi-assignments-yirkEtIC.js";const Qe={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Je={class:"relative w-full max-w-xl rounded-2xl bg-white shadow-xl ring-1 ring-black/5 p-5"},Ge={class:"flex items-start justify-between mb-4"},Xe={class:"flex items-center gap-3"},Ze={class:"h-10 w-10 rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center font-semibold"},et={class:"text-base font-semibold text-gray-900"},tt={class:"text-xs text-gray-500"},st={class:"flex flex-col gap-2"},nt={class:"md:col-span-5"},it={class:"rounded-lg border bg-white p-2"},at={class:"flex items-center justify-between mb-2"},ot={class:"text-xs text-gray-500"},lt={key:0,class:"text-sm text-gray-500"},dt={key:1},rt=["checked"],ct={class:"flex-1"},pt={class:"flex items-center gap-2"},ft={class:"text-sm text-gray-900"},mt={key:0,class:"inline-flex items-center text-xs font-medium rounded-full bg-green-100 text-green-700 px-2 py-0.5"},_t={key:1,class:"inline-flex items-center text-xs font-medium rounded-full bg-gray-100 text-gray-700 px-2 py-0.5"},yt={class:"mt-0.5 text-xs text-gray-600"},ht={key:0,class:"ml-2 text-gray-400"},ut={class:"rounded-lg border bg-white p-4"},gt={class:"grid gap-4 md:grid-cols-12"},bt={class:"md:col-span-12"},vt=["disabled"],xt=["value"],wt={key:0,class:"mt-1 text-xs text-gray-500"},kt={class:"md:col-span-6"},St={class:"mt-4 flex justify-end gap-2"},$t=["disabled"],Ct=["disabled"],At={key:0},qt={key:1},Ut={__name:"ShiftAssignmentModal",props:{modelValue:{type:Boolean,default:!1},isOpen:{type:Boolean,default:!1},employee:{type:Object,default:()=>({id:0,name:""})},shifts:{type:[Array,Object],default:()=>[]},hasShift:{type:Object,default:null},current_shift:{type:Object,default:null},shift_history:{type:[Object,Array,null],default:null}},emits:["update:modelValue","saved","close"],setup(Q,{emit:J}){var K;const d=Q,N=J,w=Me(),V=Ue(),g=q(!1);j(()=>d.modelValue,s=>{s!==g.value&&(g.value=s)}),j(()=>d.isOpen,s=>{s!==g.value&&(g.value=s)}),ae(()=>{g.value=!!(d.modelValue||d.isOpen)});function I(){g.value&&(g.value=!1,N("update:modelValue",!1),N("close",!1))}const y=q({shift_id:"",employee_id:((K=d.employee)==null?void 0:K.id)||0,start_date:"",end_date:""});j(()=>d.employee,s=>{y.value.employee_id=(s==null?void 0:s.id)||0},{immediate:!0,deep:!0});const se=x(()=>{var _,r,u,O;const s=((_=d.employee)==null?void 0:_.name)||String(((r=d.employee)==null?void 0:r.id)||""),o=s.trim().split(/\s+/);return((((u=o[0])==null?void 0:u[0])||"")+(((O=o[1])==null?void 0:O[0])||"")||s[0]||"#").toUpperCase().slice(0,2)});function C(s){return s?typeof s=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(s)?s:Ae(s).isValid()?Ae(s).format("YYYY-MM-DD"):"":""}const T=x(()=>{const s=d.shifts;return Array.isArray(s)?s:s&&typeof s=="object"?Object.values(s).flat().filter(Boolean):[]}),a=x(()=>{const s=d.shift_history;return s&&typeof s=="object"&&Array.isArray(s.history)?s.history:Array.isArray(s)?s:s?[s]:[]}),M=x(()=>a.value.map(s=>{var o,h;return{id:s.id??null,name:((o=s==null?void 0:s.shift)==null?void 0:o.name)||(s==null?void 0:s.name)||`#${(s==null?void 0:s.shift_id)||(s==null?void 0:s.id)||"—"}`,shift_id:((h=s==null?void 0:s.shift)==null?void 0:h.id)??(s==null?void 0:s.shift_id)??null,start_date:C(s.start_date),end_date:C(s.end_date),status:s.status||(s.end_date?"ended":"active"),days:s.days??null,active:!s.end_date||s.status==="active",created_at:s.created_at?new Date(s.created_at).getTime():0}}).sort((s,o)=>s.active!==o.active?s.active?-1:1:(o.start_date||"").localeCompare(s.start_date||""))),ne=x(()=>{const s=d.shift_history;return s&&typeof s=="object"&&typeof s.count=="number"?s.count:M.value.length}),W=x(()=>{var h,_;const s=M.value.find(r=>r.active);if(s)return s;const o=d.current_shift||d.hasShift;return o?{id:o.id??null,name:((h=o==null?void 0:o.shift)==null?void 0:h.name)||(o==null?void 0:o.name)||`#${(o==null?void 0:o.shift_id)||(o==null?void 0:o.id)||"—"}`,shift_id:((_=o==null?void 0:o.shift)==null?void 0:_.id)??(o==null?void 0:o.shift_id)??null,start_date:C(o.start_date),end_date:C(o.end_date),active:!o.end_date}:null});async function E(){const s=W.value;s?(y.value.shift_id=String(s.shift_id||""),y.value.start_date=C(s.start_date)||"",y.value.end_date=C(s.end_date)||""):(y.value.shift_id="",y.value.start_date="",y.value.end_date="")}j(g,(s,o)=>{s&&!o&&Ce(E)}),j([W,()=>d.shift_history],()=>{g.value&&Ce(E)});const D=q(!1),k=x(()=>!!y.value.employee_id&&!!y.value.shift_id&&!!y.value.start_date&&!D.value);async function B(){var s,o;try{if(!k.value){w.error("All required fields must be filled");return}D.value=!0;const h={employee_id:Number(y.value.employee_id),shift_id:Number(y.value.shift_id),start_date:y.value.start_date,end_date:y.value.end_date||null},_=await V.shiftAssign(h);w.success(W.value?"Shift updated":"Shift assigned"),N("saved",_),I()}catch(h){const _=((o=(s=h==null?void 0:h.response)==null?void 0:s.data)==null?void 0:o.message)||"Failed to assign shift";w.error(_)}finally{D.value=!1}}function S(s){g.value&&(s.key==="Escape"&&I(),(s.ctrlKey||s.metaKey)&&s.key.toLowerCase()==="enter"&&k.value&&B())}return ae(()=>window.addEventListener("keydown",S)),We(()=>window.removeEventListener("keydown",S)),(s,o)=>(f(),De(Ie,{to:"body"},[v($e,{name:"fade"},{default:z(()=>[g.value?(f(),m("div",Qe,[t("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:I}),v($e,{name:"pop"},{default:z(()=>{var h,_;return[t("div",Je,[t("div",Ge,[t("div",Xe,[t("div",Ze,l(se.value),1),t("div",null,[t("h3",et,l(W.value?"Update Shift":"Assign Shift"),1),t("p",tt,l(((h=Q.employee)==null?void 0:h.name)||"#"+(((_=Q.employee)==null?void 0:_.id)||"")),1)])]),t("button",{class:"btn-icon",onClick:I,"aria-label":"Close"},"✕")]),t("div",st,[t("div",nt,[t("div",it,[t("div",at,[o[2]||(o[2]=t("h4",{class:"text-sm font-semibold text-gray-800"},"Shift history",-1)),t("span",ot,l(ne.value)+" item(s)",1)]),M.value.length?(f(),m("ul",dt,[(f(!0),m(Y,null,H(M.value,(r,u)=>(f(),m("li",{key:r.id??u,class:"flex items-start gap-3"},[t("input",{type:"checkbox",class:"mt-1 rounded border-gray-300",checked:r.active,disabled:""},null,8,rt),t("div",ct,[t("div",pt,[t("span",ft,l(r.name),1),r.active?(f(),m("span",mt,"Active")):(f(),m("span",_t,"Closed"))]),t("div",yt,[F(" Period: "+l(r.start_date||"—")+" → "+l(r.end_date||"present")+" ",1),r.days?(f(),m("span",ht,"("+l(r.days)+" days)",1)):te("",!0)])])]))),128))])):(f(),m("div",lt," No history found "))])]),t("div",ut,[t("div",gt,[t("div",bt,[o[4]||(o[4]=t("label",{class:"block text-sm font-medium text-gray-700"},"Select Shift",-1)),oe(t("select",{"onUpdate:modelValue":o[0]||(o[0]=r=>y.value.shift_id=r),class:"mt-1 w-full rounded-md border px-3 py-2 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-200",disabled:!T.value.length},[o[3]||(o[3]=t("option",{value:""},"Choose a shift…",-1)),(f(!0),m(Y,null,H(T.value,r=>(f(),m("option",{key:r==null?void 0:r.id,value:r==null?void 0:r.id},l(r==null?void 0:r.name),9,xt))),128))],8,vt),[[Ne,y.value.shift_id]]),T.value.length?te("",!0):(f(),m("p",wt,"No shifts found"))]),t("div",kt,[o[5]||(o[5]=t("label",{class:"block text-sm font-medium text-gray-700"},"Start Date",-1)),oe(t("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>y.value.start_date=r),type:"date",class:"mt-1 w-full rounded-md border px-3 py-2"},null,512),[[qe,y.value.start_date]])])]),t("div",St,[t("button",{class:"btn-3",onClick:I,disabled:D.value},"Cancel",8,$t),t("button",{class:"btn-2",onClick:B,disabled:!k.value},[D.value?(f(),m("span",qt,"Processing…")):(f(),m("span",At,l(W.value?"Update":"Assign"),1))],8,Ct)])])])])]}),_:1})])):te("",!0)]),_:1})]))}},zt={class:"space-y-3 p-5"},jt={class:"flex items-center justify-between gap-2"},Vt={class:"flex gap-3"},Mt={class:"sticky top-14 z-40 -mx-5 px-5 py-3 bg-white/90 supports-[backdrop-filter]:bg-white/70 backdrop-blur border-b border-zinc-200"},Wt={class:"flex flex-col md:flex-row md:items-end gap-2"},Dt={class:"flex items-center gap-1"},Nt={class:"flex items-center gap-2 w-full md:w-auto"},It={class:"mt-2 flex flex-wrap gap-2 text-[12px]"},Ot={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Lt={class:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-700"},Tt={class:"px-2 py-1 rounded-full bg-rose-100 text-rose-700"},Et={class:"px-2 py-1 rounded-full bg-amber-100 text-amber-800"},Bt={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Kt={class:"px-2 py-1 rounded-full bg-emerald-100 text-emerald-800"},Rt={class:"px-2 py-1 rounded-full bg-zinc-100 text-zinc-700"},Pt={key:0,class:"text-center py-6"},Ft={key:1,class:"space-y-4"},Yt={key:0,class:"text-center py-6 text-lg italic text-gray-500"},Ht={class:"flex items-center justify-between"},Qt={class:"title-md"},Jt={class:"grid grid-cols-1 gap-2 md:hidden"},Gt={class:"flex items-start gap-3"},Xt={class:"h-10 w-10 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},Zt={class:"min-w-0"},es={class:"font-medium leading-5 truncate"},ts={class:"text-[12px] text-zinc-500"},ss={class:"mt-1 text-[12px] text-zinc-600"},ns={class:"text-[12px] text-zinc-600"},is={class:"mt-1 text-[12px]"},as=["href"],os=["href"],ls={class:"mt-2 flex gap-1"},ds=["onClick"],rs=["onClick"],cs=["onClick"],ps={class:"overflow-x-auto hidden md:block"},fs={class:"min-w-full table-auto bg-white shadow-md rounded-lg overflow-hidden"},ms={class:"border border-gray-100 px-2 py-2"},_s={class:"border border-gray-100 px-3 py-2"},ys={class:"flex items-start gap-2"},hs={key:0,class:"h-8 w-8 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},us=["src","alt"],gs={key:1,class:"h-8 w-8 shrink-0 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-700 font-bold"},bs={class:"min-w-0"},vs={class:"font-medium truncate max-w-[220px]"},xs={class:"text-[11px] text-zinc-500"},ws={class:"text-[11px] text-zinc-500"},ks={class:"border border-gray-100 px-2 py-2"},Ss={class:"flex items-center gap-2"},$s=["href"],Cs={class:"flex items-center gap-2"},As=["href"],qs={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},Us={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},zs={class:"border border-gray-100 px-2 py-2 whitespace-nowrap"},js={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Vs=["onClick","title"],Ms={class:"ml-1 hidden lg:inline"},Ws={class:"mt-1 text-[11px] text-gray-500"},Ds={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Ns=["onClick","title"],Is={class:"ml-1 hidden lg:inline"},Os={class:"mt-1 text-[11px] text-gray-500"},Ls={class:"border border-gray-100 px-2 py-2"},Ts={class:"border border-gray-100 px-3 py-2 whitespace-nowrap"},Es=["onClick","title"],Bs={class:"ml-1 hidden lg:inline"},Ks={class:"border border-gray-100 px-2 py-2"},Rs={class:"flex gap-2"},ln={__name:"UserList",setup(Q){const J=Oe(),d=Le(),N=Fe(),w=Ye(),V=He(),g=Ue(),{companies:I}=ee(N),{departments:y}=ee(w),{shifts:se}=ee(g),{users:C,isLoading:T}=ee(V),a=Te({company:String(d.query.company??"all"),department:String(d.query.department??"all"),line_type:String(d.query.line_type??"all"),status:String(d.query.status??"active"),employee_id:String(d.query.employee_id??""),q:String(d.query.q??"")});let M=null;const ne=x(()=>{const i={};return a.company&&a.company!=="all"&&(i.company=a.company),a.department&&a.department!=="all"&&(i.department=a.department),a.line_type&&a.line_type!=="all"&&(i.line_type=a.line_type),a.status&&a.status!=="all"&&(i.status=a.status),a.employee_id&&(i.employee_id=a.employee_id),a.q&&(i.q=a.q),i});function W(){clearTimeout(M),M=setTimeout(()=>{J.replace({query:{...ne.value}})},250)}j(a,W,{deep:!0}),ae(async()=>{await N.fetchCompanies(),a.company&&a.company!=="all"&&await w.fetchDepartments(a.company),E()}),j(()=>d.query,()=>E(),{deep:!0});function E(){V.fetchUsers({company_id:d.query.company,department_id:d.query.department,line_type:d.query.line_type,status:d.query.status,user_id:d.query.employee_id,q:d.query.q})}j(()=>a.company,async(i,n)=>{var c;i!==n&&(i&&i!=="all"?await w.fetchDepartments(i):(c=w.$reset)==null||c.call(w))});const D=()=>J.go(-1),k=i=>{var n,c;return!!((c=(n=i==null?void 0:i.current_shift)==null?void 0:n.shift)!=null&&c.name)},B=i=>{var n,c;return((c=(n=i==null?void 0:i.current_shift)==null?void 0:n.shift)==null?void 0:c.name)||"Not Assigned"},S=i=>{var n;return Array.isArray((n=i==null?void 0:i.assign_weekend)==null?void 0:n.weekends)&&i.assign_weekend.weekends.length>0},K=i=>S(i)?i.assign_weekend.weekends.join(", "):"Not Assigned",s=(i,n)=>{var p,U,b;if(!n)return!0;const c=n.toLowerCase();return[i==null?void 0:i.name,i==null?void 0:i.phone,i==null?void 0:i.employee_id,(p=i==null?void 0:i.company)==null?void 0:p.name,(U=i==null?void 0:i.department)==null?void 0:U.name,(b=i==null?void 0:i.designation)==null?void 0:b.title].some(Z=>String(Z||"").toLowerCase().includes(c))},o=i=>{if(a.status==="all")return!0;const n=a.status==="active"?1:0;return Number((i==null?void 0:i.is_active)??0)===n},h=x(()=>(Array.isArray(C.value)?C.value:[]).filter(n=>{var c;return!(a.company!=="all"&&String((c=n==null?void 0:n.company)==null?void 0:c.id)!==String(a.company)||a.line_type!=="all"&&String(n==null?void 0:n.type)!==String(a.line_type)||a.employee_id&&String(n==null?void 0:n.id)!==String(a.employee_id)||!o(n)||!s(n,a.q))})),_=x(()=>{const i=h.value,n=i.length,c=i.filter(b=>Number((b==null?void 0:b.is_active)??0)===1).length,p=i.filter(b=>k(b)).length,U=i.filter(b=>S(b)).length;return{total:n,active:c,inactive:n-c,withShift:p,withoutShift:n-p,withWeekend:U,withoutWeekend:n-U}}),r=x(()=>{var n;const i={};for(const c of h.value){const p=((n=c==null?void 0:c.company)==null?void 0:n.name)||"Unknown Company";(i[p]??(i[p]=[])).push(c)}return i}),u=q(null),O=q(null),le=q(null),G=q(!1),ie=q(!1),X=q(!1);async function de(i){if(u.value=i,i!=null&&i.company_id){const n=await V.fetchUserShifts(i.id);le.value=n,await g.fetchShifts(i.company_id)}G.value=!0}async function re(i){u.value=i,ie.value=!0;try{const n=await V.fetchUserWeekends(i.id);O.value=n}catch{O.value={history:[],current:null}}}function ce(i){u.value=i,X.value=!0}async function ze(){await V.fetchUsersExcelExport({data:{company_id:a.company!=="all"?a.company:void 0,department_id:a.department!=="all"?a.department:void 0,line_type:a.line_type!=="all"?a.line_type:void 0,status:a.status!=="all"?a.status:void 0,employee_id:a.employee_id||void 0,q:a.q||void 0}})}function je(){X.value=!1}function Ve(){a.company="all",a.department="all",a.line_type="all",a.status="active",a.employee_id="",a.q=""}return(i,n)=>{const c=Ee("RouterLink");return f(),m("div",zt,[t("div",jt,[t("button",{class:"btn-3",onClick:D},n[15]||(n[15]=[t("i",{class:"far fa-arrow-left"},null,-1),t("span",{class:"hidden md:flex"},"Back",-1)])),n[18]||(n[18]=t("h1",{class:"title-md md:title-lg flex-wrap text-center"},"Employee List",-1)),t("div",Vt,[v(c,{to:{name:"UserAdd",query:{company:L(d).query.company}},class:"btn-2"},{default:z(()=>n[16]||(n[16]=[t("span",{class:"hidden md:flex"},"Add New",-1),t("i",{class:"far fa-plus"},null,-1)])),_:1,__:[16]},8,["to"]),t("button",{type:"button",onClick:ze,class:"btn-3"},n[17]||(n[17]=[t("i",{class:"far fa-file-excel text-2xl text-green-500"},null,-1),F("Excel ")]))])]),t("div",Mt,[t("div",Wt,[v(Be,{company_id:a.company,"onUpdate:company_id":n[3]||(n[3]=p=>a.company=p),department_id:a.department,"onUpdate:department_id":n[4]||(n[4]=p=>a.department=p),employee_id:a.employee_id,"onUpdate:employee_id":n[5]||(n[5]=p=>a.employee_id=p),line_type:a.line_type,"onUpdate:line_type":n[6]||(n[6]=p=>a.line_type=p),"with-type":!0,"initial-value":i.$route.query,class:"w-full"},{default:z(()=>[t("div",Dt,[t("button",{class:$(["h-8 px-3 text-xs rounded-l-md border transition",a.status==="all"?"bg-zinc-800 text-white border-zinc-800":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:n[0]||(n[0]=P(p=>a.status="all",["prevent"]))},"All",2),t("button",{class:$(["h-8 px-3 text-xs border-y transition",a.status==="active"?"bg-emerald-600 text-white border-emerald-600":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:n[1]||(n[1]=P(p=>a.status="active",["prevent"]))},"Active",2),t("button",{class:$(["h-8 px-3 text-xs rounded-r-md border transition",a.status==="in_active"?"bg-rose-600 text-white border-rose-600":"bg-white border-zinc-300 hover:bg-zinc-50"]),onClick:n[2]||(n[2]=P(p=>a.status="in_active",["prevent"]))},"Inactive",2)])]),_:1},8,["company_id","department_id","employee_id","line_type","initial-value"]),t("div",Nt,[oe(t("input",{"onUpdate:modelValue":n[7]||(n[7]=p=>a.q=p),type:"text",placeholder:"Search name / phone / ID",class:"input-1 h-8 text-sm w-full md:w-64"},null,512),[[qe,a.q,void 0,{trim:!0}]]),t("button",{type:"button",onClick:Ve,class:"inline-flex h-8 items-center rounded-md border border-zinc-300 bg-zinc-50 px-3 text-[12px] font-medium text-zinc-700 hover:bg-white active:scale-[.99]",title:"Reset filters"},n[19]||(n[19]=[t("i",{class:"far fa-undo mr-1"},null,-1),F(" Reset ")]))])]),t("div",It,[t("span",Ot,"Total: "+l(_.value.total),1),t("span",Lt,"Active: "+l(_.value.active),1),t("span",Tt,"Inactive: "+l(_.value.inactive),1),t("span",Et,"With Shift: "+l(_.value.withShift),1),t("span",Bt,"No Shift: "+l(_.value.withoutShift),1),t("span",Kt,"With Weekend: "+l(_.value.withWeekend),1),t("span",Rt,"No Weekend: "+l(_.value.withoutWeekend),1)])]),L(T)?(f(),m("div",Pt,[v(Ke)])):(f(),m("div",Ft,[Object.keys(r.value).length===0?(f(),m("div",Yt," No users found ")):te("",!0),(f(!0),m(Y,null,H(r.value,(p,U)=>{var b,Z,pe,fe,me,_e,ye,he;return f(),m("div",{key:U,class:"space-y-2"},[t("div",Ht,[t("h2",Qt,l(U)+" ("+l(p.length)+")",1)]),t("div",Jt,[(f(!0),m(Y,null,H(p,e=>{var A;return f(),m("div",{key:e.id,class:"rounded-lg border border-zinc-200 bg-white p-3 shadow-sm"},[t("div",Gt,[t("div",Xt,l(((e==null?void 0:e.name)||"?").charAt(0).toUpperCase()),1),t("div",Zt,[t("div",es,l(e==null?void 0:e.name),1),t("div",ts,"ID: "+l(e==null?void 0:e.employee_id)+" • "+l(((A=e==null?void 0:e.designation)==null?void 0:A.title)||"—"),1),t("div",ss,"Shift: "+l(B(e)),1),t("div",ns,"Weekend: "+l(K(e)),1),t("div",is,[t("a",{class:"underline",href:"tel:"+(e==null?void 0:e.phone),onClick:n[8]||(n[8]=P(()=>{},["stop"]))},l((e==null?void 0:e.phone)||"—"),9,as),n[20]||(n[20]=t("span",{class:"mx-1"},"•",-1)),t("a",{class:"underline",href:"mailto:"+((e==null?void 0:e.email)||""),onClick:n[9]||(n[9]=P(()=>{},["stop"]))},l((e==null?void 0:e.email)||"নেই"),9,os)]),t("div",ls,[t("button",{class:"btn-3 !px-2 !py-1",onClick:R=>de(e)},"Shift",8,ds),t("button",{class:"btn-3 !px-2 !py-1",onClick:R=>re(e)},"Weekend",8,rs),t("button",{class:"btn-3 !px-2 !py-1",onClick:R=>ce(e)},"KPI",8,cs),v(c,{to:{name:"UserShow",params:{id:e.id},query:{company:L(d).query.company}},class:"btn-3 !px-2 !py-1"},{default:z(()=>n[21]||(n[21]=[F("View")])),_:2,__:[21]},1032,["to"])])])])])}),128))]),t("div",ps,[t("table",fs,[n[25]||(n[25]=t("thead",null,[t("tr",{class:"bg-gray-100 text-sm font-medium text-gray-700"},[t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"#"),t("th",{class:"border border-gray-200 px-3 py-2 text-left"},"Name"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Phone & Email"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Finger ID"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Joining"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Role"),t("th",{class:"border border-gray-200 px-3 py-2 text-left"},"Shift"),t("th",{class:"border border-gray-200 px-3 py-2 text-left"},"Weekend"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Status"),t("th",{class:"border border-gray-200 px-3 py-2 text-left"},"KPI Criteria"),t("th",{class:"border border-gray-200 px-2 py-2 text-left"},"Action")])],-1)),t("tbody",null,[(f(!0),m(Y,null,H(p,(e,A)=>{var R,ue,ge,be,ve,xe,we,ke;return f(),m("tr",{key:e.id,class:"border-b text-sm border-gray-100 hover:bg-indigo-50/50"},[t("td",ms,l(A+1),1),t("td",_s,[t("div",ys,[e.photo?(f(),m("div",hs,[t("img",{src:e.photo,alt:e==null?void 0:e.name,class:"h-8 w-8 rounded-full object-cover"},null,8,us)])):(f(),m("div",gs,l(((e==null?void 0:e.name)||"?").charAt(0).toUpperCase()),1)),t("div",bs,[t("div",vs,l(e==null?void 0:e.name),1),t("div",xs,l(((R=e==null?void 0:e.designation)==null?void 0:R.title)||"—"),1),t("div",ws,"ID: "+l(e==null?void 0:e.employee_id),1)])])]),t("td",ks,[t("div",Ss,[t("a",{class:"underline",href:"tel:"+(e==null?void 0:e.phone)},l((e==null?void 0:e.phone)||"—"),9,$s)]),t("div",Cs,[t("a",{class:"underline",href:"mailto:"+((e==null?void 0:e.email)||"")},l((e==null?void 0:e.email)||"নেই"),9,As)])]),t("td",qs,l(e==null?void 0:e.device_user_id),1),t("td",Us,l(e==null?void 0:e.joining_date),1),t("td",zs,l(e==null?void 0:e.role),1),t("td",js,[t("button",{onClick:Se=>de(e),title:k(e)?"Manage Shift":"Assign Shift",class:$(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",k(e)?"border-amber-200 bg-amber-50 text-amber-700 hover:bg-amber-100 focus:ring-amber-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"])},[t("span",Ms,l(k(e)?"Manage":"Assign"),1),t("span",{class:$(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",k(e)?"bg-amber-600 text-white":"bg-slate-200 text-slate-700"])},l((e==null?void 0:e.shifts_count)||(k(e)?1:0)),3)],10,Vs),t("div",Ws,l(B(e)),1)]),t("td",Ds,[t("button",{onClick:Se=>re(e),title:S(e)?"Manage Weekend":"Assign Weekend",class:$(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",S(e)?"border-emerald-200 bg-emerald-50 text-emerald-700 hover:bg-emerald-100 focus:ring-emerald-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"])},[t("span",Is,l(S(e)?"Manage":"Assign"),1),t("span",{class:$(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",S(e)?"bg-emerald-600 text-white":"bg-slate-200 text-slate-700"])},l((e==null?void 0:e.assign_weekends_count)||S(e)&&((ge=(ue=e==null?void 0:e.assign_weekend)==null?void 0:ue.weekends)==null?void 0:ge.length)||0),3)],10,Ns),t("div",Os,l(K(e)),1)]),t("td",Ls,[t("span",{class:$(e!=null&&e.is_active?"text-emerald-600":"text-rose-500")},l(e!=null&&e.is_active?"Active":"Inactive"),3)]),t("td",Ts,[t("button",{onClick:Se=>ce(e),title:(((be=e==null?void 0:e.criteria_assignments)==null?void 0:be.length)||0)>0?"Manage KPI criteria":"Assign KPI criteria",class:$(["group inline-flex items-center rounded-full border px-2.5 py-1 text-xs font-medium transition","focus:outline-none focus:ring-2 focus:ring-offset-1",(((ve=e==null?void 0:e.criteria_assignments)==null?void 0:ve.length)||0)>0?"border-indigo-200 bg-indigo-50 text-indigo-700 hover:bg-indigo-100 focus:ring-indigo-300":"border-slate-200 bg-slate-50 text-slate-600 hover:bg-white focus:ring-slate-300"])},[t("span",Bs,l((((xe=e==null?void 0:e.criteria_assignments)==null?void 0:xe.length)||0)>0?"Manage":"Assign"),1),t("span",{class:$(["ml-1 inline-flex h-5 min-w-[20px] items-center justify-center rounded-full px-1 text-[10px] font-semibold",(((we=e==null?void 0:e.criteria_assignments)==null?void 0:we.length)||0)>0?"bg-indigo-600 text-white":"bg-slate-200 text-slate-700"])},l(((ke=e==null?void 0:e.criteria_assignments)==null?void 0:ke.length)||0),3)],10,Es)]),t("td",Ks,[t("div",Rs,[v(c,{to:{name:"UserShow",params:{id:e.id},query:{company:L(d).query.company}},class:"btn-icon",title:"View"},{default:z(()=>n[22]||(n[22]=[t("i",{class:"far fa-eye"},null,-1)])),_:2,__:[22]},1032,["to"]),v(c,{to:{name:"UserEdit",params:{id:e.id},query:{company:L(d).query.company}},class:"btn-icon",title:"Edit"},{default:z(()=>n[23]||(n[23]=[t("i",{class:"far fa-edit"},null,-1)])),_:2,__:[23]},1032,["to"]),v(c,{to:{name:"KpiReview",params:{employeeId:e.id}},class:"btn-icon",title:"KPI"},{default:z(()=>n[24]||(n[24]=[F(" KPI ")])),_:2,__:[24]},1032,["to"])])])])}),128))])])]),v(Pe,{modelValue:X.value,"onUpdate:modelValue":n[10]||(n[10]=e=>X.value=e),"user-id":(b=u.value)==null?void 0:b.id,"user-label":(Z=u.value)==null?void 0:Z.name,criteria_assignments:(pe=u.value)==null?void 0:pe.criteria_assignments,onAssigned:je},null,8,["modelValue","user-id","user-label","criteria_assignments"]),v(Re,{modelValue:ie.value,"onUpdate:modelValue":n[11]||(n[11]=e=>ie.value=e),"user-id":(fe=u.value)==null?void 0:fe.id,"user-label":(me=u.value)==null?void 0:me.name,assign_weekends:O.value,onSaved:n[12]||(n[12]=e=>{const A=e==null?void 0:e.current;A&&u.value&&(u.value.assign_weekend={weekends:A.weekends||[],start_month:A.start_month,end_month:A.end_month})})},null,8,["modelValue","user-id","user-label","assign_weekends"]),v(Ut,{modelValue:G.value,"onUpdate:modelValue":n[13]||(n[13]=e=>G.value=e),shifts:L(se),employee:{id:(_e=u.value)==null?void 0:_e.id,name:(ye=u.value)==null?void 0:ye.name},"has-shift":(he=u.value)==null?void 0:he.current_shift,shift_history:le.value,onClose:n[14]||(n[14]=e=>G.value=!1)},null,8,["modelValue","shifts","employee","has-shift","shift_history"])])}),128))]))])}}};export{ln as default};
